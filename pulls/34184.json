{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184",
    "id": 3138438378,
    "node_id": "PR_kwDOABII5867EMTq",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34184",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34184.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34184.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34184",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34184/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/1ae88d1688958fe567a087ec591015ea832aa8f0",
    "number": 34184,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "mining: add cooldown to createNewBlock() immediately after IBD",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "At startup `isInitialBlockDownload()` stops returning true once there’s less than a day of blocks left to sync. Connected mining clients will receive a flood of new templates as these last blocks are connected.\r\n\r\nFix this by briefly pausing block template creation while the best header chain is ahead of the tip. If no tip update happens for one second, we stop waiting.\r\n\r\nIt's not safe to keep waiting, because a malicious miner could announce a header and delay revealing the block, causing all other miners using this software to stall.\r\n\r\nThe cooldown only applies to `createNewBlock()`, which is typically called once per connected client; `waitNext()` remains unchanged.\r\n\r\nFixes #33994\r\n\r\nBecause the cooldown can take a while, the second commits adds an `interrupt()`. This can stop both `createNewBlock()` and `waitTipChanged()`.\r\n",
    "labels": [
      {
        "id": 118378960,
        "node_id": "MDU6TGFiZWwxMTgzNzg5NjA=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Mining",
        "name": "Mining",
        "color": "c7def8",
        "default": false
      }
    ],
    "created_at": "2025-12-31T05:17:32Z",
    "updated_at": "2026-01-30T20:03:52Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "415d0c7b6f975bde47625bdce429786d1cb948b2",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "Sjors:2025/12/cool-down",
      "ref": "2025/12/cool-down",
      "sha": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 92390696,
        "node_id": "MDEwOlJlcG9zaXRvcnk5MjM5MDY5Ng==",
        "name": "bitcoin",
        "full_name": "Sjors/bitcoin",
        "owner": {
          "login": "Sjors",
          "id": 10217,
          "node_id": "MDQ6VXNlcjEwMjE3",
          "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/Sjors",
          "html_url": "https://github.com/Sjors",
          "followers_url": "https://api.github.com/users/Sjors/followers",
          "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
          "organizations_url": "https://api.github.com/users/Sjors/orgs",
          "repos_url": "https://api.github.com/users/Sjors/repos",
          "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/Sjors/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/Sjors/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/Sjors/bitcoin",
        "archive_url": "https://api.github.com/repos/Sjors/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/Sjors/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/Sjors/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/Sjors/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/Sjors/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/Sjors/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/Sjors/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/Sjors/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/Sjors/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/Sjors/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/Sjors/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/Sjors/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/Sjors/bitcoin/events",
        "forks_url": "https://api.github.com/repos/Sjors/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/Sjors/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/Sjors/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/Sjors/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/Sjors/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/Sjors/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/Sjors/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/Sjors/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/Sjors/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/Sjors/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/Sjors/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/Sjors/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/Sjors/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/Sjors/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/Sjors/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/Sjors/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:Sjors/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/Sjors/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/Sjors/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/Sjors/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/Sjors/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/Sjors/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/Sjors/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/Sjors/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/Sjors/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/Sjors/bitcoin/hooks",
        "svn_url": "https://github.com/Sjors/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 11,
        "stargazers_count": 15,
        "watchers_count": 15,
        "size": 285384,
        "default_branch": "master",
        "open_issues_count": 6,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": false,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-30T11:38:16Z",
        "created_at": "2017-05-25T10:05:54Z",
        "updated_at": "2026-01-22T15:46:43Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "01651324f4e540f6b96cff31e89752c3f9417293",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38816,
        "stargazers_count": 87828,
        "watchers_count": 87828,
        "size": 302817,
        "default_branch": "master",
        "open_issues_count": 750,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-30T11:53:20Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-30T20:39:56Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 146,
    "deletions": 16,
    "changed_files": 8,
    "commits": 2,
    "review_comments": 17,
    "comments": 6
  },
  "events": [
    {
      "event": "renamed",
      "id": 21804681786,
      "node_id": "RTE_lADOABII587g1EbpzwAAAAUTqQo6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21804681786",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T05:23:06Z",
      "rename": {
        "from": "mining: add cooldown to createNewBlock() immediately after IBD ",
        "to": "mining: add cooldown to createNewBlock() immediately after IBD"
      }
    },
    {
      "event": "labeled",
      "id": 21804682005,
      "node_id": "LE_lADOABII587g1EbpzwAAAAUTqQsV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21804682005",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T05:23:08Z",
      "label": {
        "name": "Mining",
        "color": "c7def8"
      }
    },
    {
      "event": "commented",
      "id": 3701469781,
      "node_id": "IC_kwDOABII587cn_JV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3701469781",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T05:23:12Z",
      "updated_at": "2026-01-30T20:03:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34184.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [ryanofsky](https://github.com/bitcoin/bitcoin/pull/34184#issuecomment-3825499142) |\n| Stale ACK | [bensig](https://github.com/bitcoin/bitcoin/pull/34184#issuecomment-3706545897), [w0xlt](https://github.com/bitcoin/bitcoin/pull/34184#pullrequestreview-3712671569) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34452](https://github.com/bitcoin/bitcoin/pull/34452) (test: split interface_ipc.py by Sjors)\n* [#34422](https://github.com/bitcoin/bitcoin/pull/34422) (Update libmultiprocess subtree to be more stable with rust IPC client by ryanofsky)\n* [#34284](https://github.com/bitcoin/bitcoin/pull/34284) (ipc, test: Add tests for unclean disconnect and thread busy behavior by ryanofsky)\n* [#33966](https://github.com/bitcoin/bitcoin/pull/33966) (refactor: disentangle miner startup defaults from runtime options by Sjors)\n* [#33965](https://github.com/bitcoin/bitcoin/pull/33965) (mining: fix -blockreservedweight shadows IPC option by Sjors)\n* [#33936](https://github.com/bitcoin/bitcoin/pull/33936) (mining: pass missing context to createNewBlock() and checkBlock() by Sjors)\n* [#33922](https://github.com/bitcoin/bitcoin/pull/33922) (mining: add getMemoryLoad() and track template non-mempool memory footprint by Sjors)\n* [#32420](https://github.com/bitcoin/bitcoin/pull/32420) (mining, ipc: omit dummy extraNonce from coinbase by Sjors)\n* [#29491](https://github.com/bitcoin/bitcoin/pull/29491) ([EXPERIMENTAL] Schnorr batch verification for blocks by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (✨ experimental)\n\n\n\nPossible typos and grammar issues:\n\n- @retval std::nullptr if the node is shut down or interrupt() is called. -> @retval nullptr if the node is shut down or interrupt() is called. [std::nullptr is not a valid term; the null pointer literal is nullptr]\n\n\n\n<sup>2026-01-30 11:39:28</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#issuecomment-3701469781",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34184"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21805313874,
      "node_id": "HRFPE_lADOABII587g1EbpzwAAAAUTsq9S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21805313874",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a73a5b603f3fbd1796210124c0783766d3a99fff",
      "commit_url": "https://api.github.com/repos/Sjors/bitcoin/commits/a73a5b603f3fbd1796210124c0783766d3a99fff",
      "created_at": "2025-12-31T06:48:24Z"
    },
    {
      "event": "labeled",
      "id": 21805316160,
      "node_id": "LE_lADOABII587g1EbpzwAAAAUTsrhA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21805316160",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T06:48:46Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21805386195,
      "node_id": "HRFPE_lADOABII587g1EbpzwAAAAUTs8nT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21805386195",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "62524ac69c25499c6afb114e4c023d91abc9681c",
      "commit_url": "https://api.github.com/repos/Sjors/bitcoin/commits/62524ac69c25499c6afb114e4c023d91abc9681c",
      "created_at": "2025-12-31T06:59:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21805543133,
      "node_id": "HRFPE_lADOABII587g1EbpzwAAAAUTti7d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21805543133",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "e8b01c43bb05f1a52adf1279280a744111b8dc45",
      "commit_url": "https://api.github.com/repos/Sjors/bitcoin/commits/e8b01c43bb05f1a52adf1279280a744111b8dc45",
      "created_at": "2025-12-31T07:19:10Z"
    },
    {
      "event": "commented",
      "id": 3701624323,
      "node_id": "IC_kwDOABII587cok4D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3701624323",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T07:28:35Z",
      "updated_at": "2025-12-31T07:30:09Z",
      "author_association": "MEMBER",
      "body": "Switched to avoid mock time for the cooldown mechanism (it's possible, but would require additional refactoring).\r\n\r\nAdded a constraint to ignore alternative header branches. This probably doesn't matter in real life, but it does in tests. E.g. the assume_utxo test \"Check importing a snapshot where current chain-tip is not an ancestor of the snapshot block but has less work\" creates an alternative chain of blocks despite having better headers (but not their blocks). In real life this implies a giant block witholding attack.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#issuecomment-3701624323",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34184"
    },
    {
      "event": "unlabeled",
      "id": 21806209700,
      "node_id": "UNLE_lADOABII587g1EbpzwAAAAUTwFqk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21806209700",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T08:35:56Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3706545897,
      "node_id": "IC_kwDOABII587c7Wbp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3706545897",
      "actor": {
        "login": "bensig",
        "id": 1872138,
        "node_id": "MDQ6VXNlcjE4NzIxMzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1872138?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bensig",
        "html_url": "https://github.com/bensig",
        "followers_url": "https://api.github.com/users/bensig/followers",
        "following_url": "https://api.github.com/users/bensig/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bensig/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bensig/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bensig/subscriptions",
        "organizations_url": "https://api.github.com/users/bensig/orgs",
        "repos_url": "https://api.github.com/users/bensig/repos",
        "events_url": "https://api.github.com/users/bensig/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bensig/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-03T00:46:16Z",
      "updated_at": "2026-01-03T00:46:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK e8b01c43bb05f1a52adf1279280a744111b8dc45\r\n\r\nTested on macOS - `interface_ipc.py` passes.\r\n\r\nCode review:\r\n- Using `SteadyClock` for the cooldown (independent of mocktime) is the right call\r\n- `BestHeaderAheadOfActiveTip()` correctly uses ancestor check to ignore competing branches\r\n- 1s timeout prevents DoS from header-only attacks while still allowing catch-up during final IBD\r\n- \r\n\r\nNice fix for #33994 ",
      "user": {
        "login": "bensig",
        "id": 1872138,
        "node_id": "MDQ6VXNlcjE4NzIxMzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1872138?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bensig",
        "html_url": "https://github.com/bensig",
        "followers_url": "https://api.github.com/users/bensig/followers",
        "following_url": "https://api.github.com/users/bensig/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bensig/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bensig/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bensig/subscriptions",
        "organizations_url": "https://api.github.com/users/bensig/orgs",
        "repos_url": "https://api.github.com/users/bensig/repos",
        "events_url": "https://api.github.com/users/bensig/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bensig/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#issuecomment-3706545897",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34184"
    },
    {
      "event": "labeled",
      "id": 22016373847,
      "node_id": "LE_lADOABII587g1EbpzwAAAAUgRzRX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22016373847",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-13T13:12:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22210260386,
      "node_id": "HRFPE_lADOABII587g1EbpzwAAAAUr1a2i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22210260386",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "commit_url": "https://api.github.com/repos/Sjors/bitcoin/commits/c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "created_at": "2026-01-22T09:02:12Z"
    },
    {
      "event": "commented",
      "id": 3783295599,
      "node_id": "IC_kwDOABII587hgIJv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3783295599",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T09:02:58Z",
      "updated_at": "2026-01-22T09:02:58Z",
      "author_association": "MEMBER",
      "body": "Rebased.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#issuecomment-3783295599",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34184"
    },
    {
      "event": "unlabeled",
      "id": 22212110947,
      "node_id": "UNLE_lADOABII587g1EbpzwAAAAUr8epj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22212110947",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T10:23:06Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3709380896,
      "node_id": "PRR_kwDOABII587dGKkg",
      "url": null,
      "actor": null,
      "commit_id": "c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-27T06:44:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#pullrequestreview-3709380896",
      "submitted_at": "2026-01-27T06:44:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22313984204,
      "node_id": "HRFPE_lADOABII587g1EbpzwAAAAUyBGDM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22313984204",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "commit_url": "https://api.github.com/repos/Sjors/bitcoin/commits/9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "created_at": "2026-01-27T10:49:41Z"
    },
    {
      "event": "reviewed",
      "id": 3712671569,
      "node_id": "PRR_kwDOABII587dSt9R",
      "url": null,
      "actor": null,
      "commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-27T17:58:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK https://github.com/bitcoin/bitcoin/pull/34184/commits/9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#pullrequestreview-3712671569",
      "submitted_at": "2026-01-27T17:58:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
    },
    {
      "event": "reviewed",
      "id": 3716923738,
      "node_id": "PRR_kwDOABII587di8Fa",
      "url": null,
      "actor": null,
      "commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-28T15:06:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 9817657d463ff1d8502a5edf0641e88b9b1d4853. This seems like probably the simplest change that can resolve #33994.\n\nI guess I have two lingering concerns about it:\n\n- This can cause the createNewBlock function to block for potentially a very long time when it didn't before and createNewBlock doesn't currently have any cancellation option other than shutting down the node. So it could make it hard for IPC clients to disconnect cleanly, and I suspect we may want to follow up here by adding some timeout or cancellation mechanism.\n\n- I'm not very sure about effectiveness of the cooldown strategy, and wouldn't be surprised if there were cases where it didn't work well but it does seem like a good starting point, and pretty conservative.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#pullrequestreview-3716923738",
      "submitted_at": "2026-01-28T15:06:00Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM0ZTc2OGQ5OTI5OWQyNzU5M2M1MTZhYTQxZWU1OWFjYmZiZGM1Zjk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/34e768d99299d27593c516aa41ee59acbfbdc5f9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/34e768d99299d27593c516aa41ee59acbfbdc5f9",
      "tree": {
        "sha": "aff25d53975d3dfedab2900c9c2e4631c0ccd02a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/aff25d53975d3dfedab2900c9c2e4631c0ccd02a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree aff25d53975d3dfedab2900c9c2e4631c0ccd02a\nparent 5715748333fe41414ce72c3dcdd3420a8e6ec470\nauthor Sjors Provoost <sjors@sprovoost.nl> 1769510971 +0100\ncommitter Sjors Provoost <sjors@sprovoost.nl> 1769698150 +0100\n\nmining: createNewBlock() waits if tip is updating\n\nAt startup isInitialBlockDownload() stops returning true once there’s\nless than a day of blocks left to sync. Connected mining clients will\nreceive a flood of new templates as these last blocks are connected.\n\nFix this by briefly pausing block template creation while the best\nheader chain is ahead of the tip. If no tip update happens for one\nsecond, we stop waiting.\n\nFixes #33994\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7ZvfetalXiMuhFJCV/+b28wwEAkFAml7c2YACgkQV/+b28ww\nEAkhLQ/9H03b9IL0YyAlD825oZwVNuw/21Gy0P6/cenuUc+ZfJsdHcvHF3Cg+u57\nMYRl7KCGXwhGF7RvxLBQsP1Gclkm2Il2rzyAdwboG6m6TTxENMPdGI/dA+9l+pMe\n6K4aYNBqlqHFcdk4604o8fzcV0ykm8bo6y7BwkRTT91dTGaXItICF+KBT7/ZojCN\nZNDqtwrww3nSuEPO5+PDc7OniluWpOzcW4S+Ov+PPJZdb7ECBwrHvd7sK7EnTFFr\nBVOhX4B2rLo+wkf1/x6zk5heMuR4V0OnaLhKpCD4feG1y+b5u7GliikGanHYml8i\nRZGUD2OMmpMT9xieR605cNrxx/JaDk/yzt1BjFgzqQBF0Oxy7igpclguWH7D19RL\nWZVZlKIBink6dqq+ic8Yj0GZx0DurWQatOpQp3BQa2UhK9vktNqzdAVyJs+2eTix\n9WRFPVEO1NIhstTlFXmxX/TMR59BuVBVXRvvAV0uQLbs2fx6MK0LoWiW5iqaXTao\nuoa1xZW68pzE1qU+w7bcMloXWG6q2BZhw4PFw/cw9J4nsjYnBKVQ752U8+6Cwgbs\nJa0FPNAD4A7JMoj9fZowLTCRp++PMrBYIlztOAqn7xjGWg5aszqXZk2P/S/2VLfW\n3GNBrwH2ahGQa250OM6+UUxc1y9KxyAoQokGN7N5OCwHdIc4q3c=\n=HsQO\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5715748333fe41414ce72c3dcdd3420a8e6ec470",
          "sha": "5715748333fe41414ce72c3dcdd3420a8e6ec470",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5715748333fe41414ce72c3dcdd3420a8e6ec470"
        }
      ],
      "message": "mining: createNewBlock() waits if tip is updating\n\nAt startup isInitialBlockDownload() stops returning true once there’s\nless than a day of blocks left to sync. Connected mining clients will\nreceive a flood of new templates as these last blocks are connected.\n\nFix this by briefly pausing block template creation while the best\nheader chain is ahead of the tip. If no tip update happens for one\nsecond, we stop waiting.\n\nFixes #33994",
      "committer": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2026-01-29T14:49:10Z"
      },
      "author": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2026-01-27T10:49:31Z"
      },
      "sha": "34e768d99299d27593c516aa41ee59acbfbdc5f9"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22379488156,
      "node_id": "HRFPE_lADOABII587g1EbpzwAAAAU16-Oc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22379488156",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "commit_url": "https://api.github.com/repos/Sjors/bitcoin/commits/b57da688c21233e852c5afe5c5afafd3cae84e91",
      "created_at": "2026-01-29T14:59:16Z"
    },
    {
      "event": "commented",
      "id": 3818253766,
      "node_id": "IC_kwDOABII587jle3G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3818253766",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-29T15:01:02Z",
      "updated_at": "2026-01-29T15:01:02Z",
      "author_association": "MEMBER",
      "body": "I added a commit that allows interrupting both `createNewBlock()` and `waitTipChanged()`.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#issuecomment-3818253766",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34184"
    },
    {
      "event": "reviewed",
      "id": 3724337519,
      "node_id": "PRR_kwDOABII587d_OFv",
      "url": null,
      "actor": null,
      "commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-29T19:33:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "Code review b57da688c21233e852c5afe5c5afafd3cae84e91. Thanks for the updates! Documentation update and while loop simplification since last review look good. I'm concerned about the new `MinerImpl::m_interrupt` variable, however, since I can see it leading to segfaults if clients destroy the `Mining` interface too early (even if they don't call the `interrupt` method). So I suggested moving the variable to the `KernelNotications` class to avoid this.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#pullrequestreview-3724337519",
      "submitted_at": "2026-01-29T19:33:03Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
    },
    {
      "event": "reviewed",
      "id": 3724930526,
      "node_id": "PRR_kwDOABII587eBe3e",
      "url": null,
      "actor": null,
      "commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-29T21:15:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "Code review b57da688c21233e852c5afe5c5afafd3cae84e91. There's a small thread safety bug in the second commit (see below), but the previous concern I had about crashes isn't really an issue, and the current implementation of cancellation here seems pretty good.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#pullrequestreview-3724930526",
      "submitted_at": "2026-01-29T21:15:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFhZTg4ZDE2ODg5NThmZTU2N2EwODdlYzU5MTAxNWVhODMyYWE4ZjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1ae88d1688958fe567a087ec591015ea832aa8f0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1ae88d1688958fe567a087ec591015ea832aa8f0",
      "tree": {
        "sha": "e6e3bed7dfc134a95d24f6153e5822f176eb97c6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e6e3bed7dfc134a95d24f6153e5822f176eb97c6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e6e3bed7dfc134a95d24f6153e5822f176eb97c6\nparent 34e768d99299d27593c516aa41ee59acbfbdc5f9\nauthor Sjors Provoost <sjors@sprovoost.nl> 1769773057 +0100\ncommitter Sjors Provoost <sjors@sprovoost.nl> 1769773057 +0100\n\nmining: add interrupt()\n\nBoth waitTipChanged() and createNewBlock() can take a long time to\nreturn. Add a way for clients to interrupt them.\n\nThe new m_interrupt is safely accessed with a lock on\nm_tip_block_mutex, but it has no guard annotation. A more thorough\nsolution is discussed here:\nhttps://github.com/bitcoin/bitcoin/pull/34184#discussion_r2743566474\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7ZvfetalXiMuhFJCV/+b28wwEAkFAml8mCAACgkQV/+b28ww\nEAnCMA//R+Hi+3JMsmosxdM2YO1trUuTSwmWdTox9HI8q/FtWi/AtK0VyMhd5/CC\neo+f6JumlTIUURB362itj17xGvZzI59l/o5uIyb/0xB7IScoDAK0yo6UUYIKa1Mp\nX58oD1/gFo90MEPngrceR2hd+Et/1BH0wjcvUwX6wR15kOGyBlQq/HJj9vgNzyXb\nn+QfFcj7Y8toZ6mAwWX5f0Hk8qlwy9U9VXD4aF5kQxadJQEfmWxWBc6vEX8AiX1u\nI0j1idJrwHVB9uJgtbB5hWIK2Yd61obdHKzrHsisuuqK1mFANRtJqTbZJkk2twjq\nVskuNAW2ZfbkBEHkaEzIqlzXQNQJehCPwoimK+aWiHgjVT4wLIAa8CPl1PwVsSFB\ni/Co3zlqESHH1w0K5fdMNfmpwfcuEk1QLV9QgyUPe/oSDQl2s+ehXonnJCy1jzMa\nuc543rss+ypy4EQDP1+ftdU5yQ0dNZlZMQTKRybRmMEXsbI0RdwVZofcgbBryetv\nCbJDr7t9UBbNZxyRvt5h3jF1cjfVA+HvHBtVSQRwWMSIL9zHLzdQv0Bf8+Gnatln\nsrV2W8ms54yj9HX2QILSFg+CelnmeIO+4VONxX8NFxsFE63e6j5QBxqfBVK6WtGu\nKlxvHgqs4WQwE3CRpRNL0N4ojXZHNEDdBdk1bo/3imyHWG4huaA=\n=f467\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/34e768d99299d27593c516aa41ee59acbfbdc5f9",
          "sha": "34e768d99299d27593c516aa41ee59acbfbdc5f9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/34e768d99299d27593c516aa41ee59acbfbdc5f9"
        }
      ],
      "message": "mining: add interrupt()\n\nBoth waitTipChanged() and createNewBlock() can take a long time to\nreturn. Add a way for clients to interrupt them.\n\nThe new m_interrupt is safely accessed with a lock on\nm_tip_block_mutex, but it has no guard annotation. A more thorough\nsolution is discussed here:\nhttps://github.com/bitcoin/bitcoin/pull/34184#discussion_r2743566474",
      "committer": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2026-01-30T11:37:37Z"
      },
      "author": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2026-01-30T11:37:37Z"
      },
      "sha": "1ae88d1688958fe567a087ec591015ea832aa8f0"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22405115378,
      "node_id": "HRFPE_lADOABII587g1EbpzwAAAAU3cu3y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22405115378",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "commit_url": "https://api.github.com/repos/Sjors/bitcoin/commits/1ae88d1688958fe567a087ec591015ea832aa8f0",
      "created_at": "2026-01-30T11:38:17Z"
    },
    {
      "event": "mentioned",
      "id": 22405147596,
      "node_id": "MEE_lADOABII587g1EbpzwAAAAU3c2vM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22405147596",
      "actor": {
        "login": "RetVal",
        "id": 2731831,
        "node_id": "MDQ6VXNlcjI3MzE4MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2731831?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RetVal",
        "html_url": "https://github.com/RetVal",
        "followers_url": "https://api.github.com/users/RetVal/followers",
        "following_url": "https://api.github.com/users/RetVal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RetVal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RetVal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RetVal/subscriptions",
        "organizations_url": "https://api.github.com/users/RetVal/orgs",
        "repos_url": "https://api.github.com/users/RetVal/repos",
        "events_url": "https://api.github.com/users/RetVal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RetVal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-30T11:39:48Z"
    },
    {
      "event": "subscribed",
      "id": 22405147616,
      "node_id": "SE_lADOABII587g1EbpzwAAAAU3c2vg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22405147616",
      "actor": {
        "login": "RetVal",
        "id": 2731831,
        "node_id": "MDQ6VXNlcjI3MzE4MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2731831?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RetVal",
        "html_url": "https://github.com/RetVal",
        "followers_url": "https://api.github.com/users/RetVal/followers",
        "following_url": "https://api.github.com/users/RetVal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RetVal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RetVal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RetVal/subscriptions",
        "organizations_url": "https://api.github.com/users/RetVal/orgs",
        "repos_url": "https://api.github.com/users/RetVal/repos",
        "events_url": "https://api.github.com/users/RetVal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RetVal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-30T11:39:48Z"
    },
    {
      "event": "commented",
      "id": 3825499142,
      "node_id": "IC_kwDOABII587kBHwG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3825499142",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-30T20:03:44Z",
      "updated_at": "2026-01-30T20:03:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 1ae88d1688958fe567a087ec591015ea832aa8f0, just fixing missing lock on the interrupt variable and adding some comments since last review",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#issuecomment-3825499142",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34184"
    },
    {
      "event": "review_requested",
      "id": 22416460208,
      "node_id": "RRE_lADOABII587g1EbpzwAAAAU4IAmw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22416460208",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-30T20:03:52Z",
      "requested_reviewer": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2730496651",
      "pull_request_review_id": 3709380896,
      "id": 2730496651,
      "node_id": "PRRC_kwDOABII586iwBKL",
      "diff_hunk": "@@ -445,6 +445,42 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman)\n     return BlockRef{tip->GetBlockHash(), tip->nHeight};\n }\n \n+bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip)\n+{\n+    constexpr auto COOLDOWN{1s};\n+    // Use a steady clock so cooldown is independent of mocktime.\n+    auto cooldown_deadline{SteadyClock::now() + COOLDOWN};\n+    uint256 last_tip_hash{last_tip.hash};\n+    while (true) {\n+        bool best_header_ahead{false};\n+        {\n+            LOCK(::cs_main);\n+            best_header_ahead = chainman.BestHeaderAheadOfActiveTip();\n+        }\n+        if (!best_header_ahead) break;\n+\n+        WAIT_LOCK(kernel_notifications.m_tip_block_mutex, lock);\n+        kernel_notifications.m_tip_block_cv.wait_until(lock, cooldown_deadline, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\n+            const auto tip_block = kernel_notifications.TipBlock();",
      "path": "src/node/miner.cpp",
      "position": 14,
      "original_position": 20,
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "original_commit_id": "c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "in_reply_to_id": null,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Runtime assertion for consistency with `WaitAndCreateNewBlock` pattern.\r\n\r\n```suggestion\r\n            AssertLockHeld(kernel_notifications.m_tip_block_mutex);\r\n            const auto tip_block = kernel_notifications.TipBlock();\r\n```",
      "created_at": "2026-01-27T06:43:37Z",
      "updated_at": "2026-01-27T06:46:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2730496651",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2730496651"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 457,
      "original_line": 457,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2730498440",
      "pull_request_review_id": 3709380896,
      "id": 2730498440,
      "node_id": "PRRC_kwDOABII586iwBmI",
      "diff_hunk": "@@ -445,6 +445,42 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman)\n     return BlockRef{tip->GetBlockHash(), tip->nHeight};\n }\n \n+bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip)\n+{\n+    constexpr auto COOLDOWN{1s};\n+    // Use a steady clock so cooldown is independent of mocktime.\n+    auto cooldown_deadline{SteadyClock::now() + COOLDOWN};\n+    uint256 last_tip_hash{last_tip.hash};\n+    while (true) {\n+        bool best_header_ahead{false};\n+        {\n+            LOCK(::cs_main);\n+            best_header_ahead = chainman.BestHeaderAheadOfActiveTip();\n+        }\n+        if (!best_header_ahead) break;\n+\n+        WAIT_LOCK(kernel_notifications.m_tip_block_mutex, lock);\n+        kernel_notifications.m_tip_block_cv.wait_until(lock, cooldown_deadline, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\n+            const auto tip_block = kernel_notifications.TipBlock();\n+            return tip_block && *tip_block != last_tip_hash;",
      "path": "src/node/miner.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "original_commit_id": "c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "in_reply_to_id": null,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This makes the wait wakes immediately on shutdown signal.\r\n\r\n```suggestion\r\n            return (tip_block && *tip_block != last_tip_hash) || chainman.m_interrupt;\r\n```",
      "created_at": "2026-01-27T06:44:07Z",
      "updated_at": "2026-01-27T06:48:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2730498440",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2730498440"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 465,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2731376853",
      "pull_request_review_id": 3710430204,
      "id": 2731376853,
      "node_id": "PRRC_kwDOABII586izYDV",
      "diff_hunk": "@@ -445,6 +445,42 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman)\n     return BlockRef{tip->GetBlockHash(), tip->nHeight};\n }\n \n+bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip)\n+{\n+    constexpr auto COOLDOWN{1s};\n+    // Use a steady clock so cooldown is independent of mocktime.\n+    auto cooldown_deadline{SteadyClock::now() + COOLDOWN};\n+    uint256 last_tip_hash{last_tip.hash};\n+    while (true) {\n+        bool best_header_ahead{false};\n+        {\n+            LOCK(::cs_main);\n+            best_header_ahead = chainman.BestHeaderAheadOfActiveTip();\n+        }\n+        if (!best_header_ahead) break;\n+\n+        WAIT_LOCK(kernel_notifications.m_tip_block_mutex, lock);\n+        kernel_notifications.m_tip_block_cv.wait_until(lock, cooldown_deadline, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\n+            const auto tip_block = kernel_notifications.TipBlock();",
      "path": "src/node/miner.cpp",
      "position": 14,
      "original_position": 20,
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "original_commit_id": "c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "in_reply_to_id": 2730496651,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There's other places where we don't bother with `AssertLockHeld` for an inline function.  It seems a bit overkill.",
      "created_at": "2026-01-27T10:41:22Z",
      "updated_at": "2026-01-27T10:41:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2731376853",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2731376853"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 457,
      "original_line": 457,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2731412877",
      "pull_request_review_id": 3710473540,
      "id": 2731412877,
      "node_id": "PRRC_kwDOABII586izg2N",
      "diff_hunk": "@@ -445,6 +445,42 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman)\n     return BlockRef{tip->GetBlockHash(), tip->nHeight};\n }\n \n+bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip)\n+{\n+    constexpr auto COOLDOWN{1s};\n+    // Use a steady clock so cooldown is independent of mocktime.\n+    auto cooldown_deadline{SteadyClock::now() + COOLDOWN};\n+    uint256 last_tip_hash{last_tip.hash};\n+    while (true) {\n+        bool best_header_ahead{false};\n+        {\n+            LOCK(::cs_main);\n+            best_header_ahead = chainman.BestHeaderAheadOfActiveTip();\n+        }\n+        if (!best_header_ahead) break;\n+\n+        WAIT_LOCK(kernel_notifications.m_tip_block_mutex, lock);\n+        kernel_notifications.m_tip_block_cv.wait_until(lock, cooldown_deadline, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\n+            const auto tip_block = kernel_notifications.TipBlock();\n+            return tip_block && *tip_block != last_tip_hash;",
      "path": "src/node/miner.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "original_commit_id": "c02c2832f7b37681b0d79fded875baed26cb6f7d",
      "in_reply_to_id": 2730498440,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Taken.",
      "created_at": "2026-01-27T10:49:47Z",
      "updated_at": "2026-01-27T10:49:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2731412877",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2731412877"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 465,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736820422",
      "pull_request_review_id": 3716923738,
      "id": 2736820422,
      "node_id": "PRRC_kwDOABII586jIJDG",
      "diff_hunk": "@@ -163,6 +163,14 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman);\n  * Returns the current tip, or nullopt if the node is shutting down. */\n std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const uint256& current_tip, MillisecondsDouble& timeout);\n \n+/**\n+ * Pause block template creation when the best header chain is ahead of the tip.",
      "path": "src/node/miner.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "original_commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In commit \"mining: createNewBlock() waits if tip is updating\" (9817657d463ff1d8502a5edf0641e88b9b1d4853)\r\n\r\nThis is a little vague. I think it would be helpful to describe this in terms of observable behavior, maybe:\r\n\r\n```\r\n/**\r\n * Wait while the best known header extends the current chain tip\r\n * AND at least one block per second is being added to the tip.\r\n *\r\n * Returns false if interrupted.\r\n */\r\n```\r\n\r\nMight also be good to add the \"not safe to keep waiting\" info from your commit description, and maybe say something about how we think this is safe to use for createNewBlock since miners should only call it once on startup, but are avoiding it in waitNext.",
      "created_at": "2026-01-28T14:09:26Z",
      "updated_at": "2026-01-28T17:22:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2736820422",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736820422"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736824227",
      "pull_request_review_id": 3716923738,
      "id": 2736824227,
      "node_id": "PRRC_kwDOABII586jIJ-j",
      "diff_hunk": "@@ -6310,6 +6310,16 @@ void ChainstateManager::RecalculateBestHeader()\n     }\n }\n \n+bool ChainstateManager::BestHeaderAheadOfActiveTip() const",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 108,
      "commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "original_commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In commit \"mining: createNewBlock() waits if tip is updating\" (9817657d463ff1d8502a5edf0641e88b9b1d4853)\n\nMaybe s/Active/Current/ here, can also use CurrentChain() below.",
      "created_at": "2026-01-28T14:10:19Z",
      "updated_at": "2026-01-28T15:06:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2736824227",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736824227"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 6313,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736866828",
      "pull_request_review_id": 3716923738,
      "id": 2736866828,
      "node_id": "PRRC_kwDOABII586jIUYM",
      "diff_hunk": "@@ -445,6 +445,42 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman)\n     return BlockRef{tip->GetBlockHash(), tip->nHeight};\n }\n \n+bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip)\n+{\n+    constexpr auto COOLDOWN{1s};\n+    // Use a steady clock so cooldown is independent of mocktime.\n+    auto cooldown_deadline{SteadyClock::now() + COOLDOWN};\n+    uint256 last_tip_hash{last_tip.hash};\n+    while (true) {\n+        bool best_header_ahead{false};\n+        {\n+            LOCK(::cs_main);\n+            best_header_ahead = chainman.BestHeaderAheadOfActiveTip();\n+        }\n+        if (!best_header_ahead) break;",
      "path": "src/node/miner.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "original_commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In commit \"mining: createNewBlock() waits if tip is updating\" (9817657d463ff1d8502a5edf0641e88b9b1d4853)\n\nCould collapse lines 454-460 to just:\n\n```c++\nwhile (WITH_LOCK(::cs_main, return chainman.BestHeaderAheadOfActiveTip())) {\n```\n\nI feel like that would be easier to understand without the bool and break. Or maybe better just lock cs_main inside BestHeaderAheadOfActiveTip so this can be:\n\n\n```c++\nwhile (chainman.BestHeaderAheadOfActiveTip()) {\n```\n",
      "created_at": "2026-01-28T14:20:05Z",
      "updated_at": "2026-01-28T15:06:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2736866828",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736866828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": 454,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 460,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736935556",
      "pull_request_review_id": 3716923738,
      "id": 2736935556,
      "node_id": "PRRC_kwDOABII586jIlKE",
      "diff_hunk": "@@ -265,19 +271,38 @@ async def async_routine():\n             assert_equal(oldblockref.height, newblockref.height)\n \n             async with AsyncExitStack() as stack:\n-                self.log.debug(\"Create a template\")\n                 opts = self.capnp_modules['mining'].BlockCreateOptions()\n                 opts.useMempool = True\n                 opts.blockReservedWeight = 4000\n                 opts.coinbaseOutputMaxAdditionalSigops = 0\n+\n+                self.log.debug(\"createNewBlock() should wait if tip is still updating\")\n+                self.disconnect_nodes(0, 1)\n+                node1_block_hash = self.generate(self.nodes[1], 1, sync_fun=self.no_op)[0]\n+                header = from_hex(CBlockHeader(), self.nodes[1].getblockheader(node1_block_hash, False))\n+                header_only_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n+                header_only_peer.send_and_ping(msg_headers([header]))\n+                start = time.time()\n+                async with destroying((await mining.createNewBlock(opts)).result, ctx):\n+                    pass\n+                # Lower-bound only: a heavily loaded CI host might still exceed 0.9s\n+                # even without the cooldown, so this can miss regressions but avoids\n+                # spurious failures.\n+                assert_greater_than_or_equal(time.time() - start, 0.9)",
      "path": "test/functional/interface_ipc.py",
      "position": 74,
      "original_position": 56,
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "original_commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In commit \"mining: createNewBlock() waits if tip is updating\" (9817657d463ff1d8502a5edf0641e88b9b1d4853)\n\nSince this check uses a delay, if there is a way you could move this test to a separate test function (not `run_mining_test`) i think that would be very good.\n\nI'm concerned about interface_ipc test getting harder to maintain and slower to run, and would like to move towards using separate test methods like #34284, so we can still have fast update/test cycles by being able to run specific tests.",
      "created_at": "2026-01-28T14:35:14Z",
      "updated_at": "2026-01-28T15:06:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2736935556",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736935556"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 299,
      "original_line": 299,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2742088692",
      "pull_request_review_id": 3723273353,
      "id": 2742088692,
      "node_id": "PRRC_kwDOABII586jcPP0",
      "diff_hunk": "@@ -265,19 +271,38 @@ async def async_routine():\n             assert_equal(oldblockref.height, newblockref.height)\n \n             async with AsyncExitStack() as stack:\n-                self.log.debug(\"Create a template\")\n                 opts = self.capnp_modules['mining'].BlockCreateOptions()\n                 opts.useMempool = True\n                 opts.blockReservedWeight = 4000\n                 opts.coinbaseOutputMaxAdditionalSigops = 0\n+\n+                self.log.debug(\"createNewBlock() should wait if tip is still updating\")\n+                self.disconnect_nodes(0, 1)\n+                node1_block_hash = self.generate(self.nodes[1], 1, sync_fun=self.no_op)[0]\n+                header = from_hex(CBlockHeader(), self.nodes[1].getblockheader(node1_block_hash, False))\n+                header_only_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n+                header_only_peer.send_and_ping(msg_headers([header]))\n+                start = time.time()\n+                async with destroying((await mining.createNewBlock(opts)).result, ctx):\n+                    pass\n+                # Lower-bound only: a heavily loaded CI host might still exceed 0.9s\n+                # even without the cooldown, so this can miss regressions but avoids\n+                # spurious failures.\n+                assert_greater_than_or_equal(time.time() - start, 0.9)",
      "path": "test/functional/interface_ipc.py",
      "position": 74,
      "original_position": 56,
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "original_commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "in_reply_to_id": 2736935556,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'm looking into splitting the mining ipc tests out entirely. Will leave this line untouched for now, as one second isn't too bad.",
      "created_at": "2026-01-29T15:00:07Z",
      "updated_at": "2026-01-29T15:00:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2742088692",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2742088692"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 299,
      "original_line": 299,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2742088792",
      "pull_request_review_id": 3723273489,
      "id": 2742088792,
      "node_id": "PRRC_kwDOABII586jcPRY",
      "diff_hunk": "@@ -445,6 +445,42 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman)\n     return BlockRef{tip->GetBlockHash(), tip->nHeight};\n }\n \n+bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip)\n+{\n+    constexpr auto COOLDOWN{1s};\n+    // Use a steady clock so cooldown is independent of mocktime.\n+    auto cooldown_deadline{SteadyClock::now() + COOLDOWN};\n+    uint256 last_tip_hash{last_tip.hash};\n+    while (true) {\n+        bool best_header_ahead{false};\n+        {\n+            LOCK(::cs_main);\n+            best_header_ahead = chainman.BestHeaderAheadOfActiveTip();\n+        }\n+        if (!best_header_ahead) break;",
      "path": "src/node/miner.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "original_commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "in_reply_to_id": 2736866828,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Nice, taken.",
      "created_at": "2026-01-29T15:00:09Z",
      "updated_at": "2026-01-29T15:00:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2742088792",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2742088792"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": 454,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 460,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2742089349",
      "pull_request_review_id": 3723274164,
      "id": 2742089349,
      "node_id": "PRRC_kwDOABII586jcPaF",
      "diff_hunk": "@@ -163,6 +163,14 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman);\n  * Returns the current tip, or nullopt if the node is shutting down. */\n std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const uint256& current_tip, MillisecondsDouble& timeout);\n \n+/**\n+ * Pause block template creation when the best header chain is ahead of the tip.",
      "path": "src/node/miner.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "original_commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "in_reply_to_id": 2736820422,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Taken. I moved some text from the commit message to the comment here.",
      "created_at": "2026-01-29T15:00:18Z",
      "updated_at": "2026-01-29T15:00:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2742089349",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2742089349"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2742950202",
      "pull_request_review_id": 3724337519,
      "id": 2742950202,
      "node_id": "PRRC_kwDOABII586jfhk6",
      "diff_hunk": "@@ -995,6 +1000,7 @@ class MinerImpl : public Mining\n     NodeContext* context() override { return &m_node; }\n     ChainstateManager& chainman() { return *Assert(m_node.chainman); }\n     KernelNotifications& notifications() { return *Assert(m_node.notifications); }\n+    bool m_interrupt{false};",
      "path": "src/node/interfaces.cpp",
      "position": 43,
      "original_position": 33,
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "original_commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In commit \"mining: add interrupt()\" (b57da688c21233e852c5afe5c5afafd3cae84e91)\n\nWould be good to note that `notifications().m_tip_block_mutex` must be held while accessing this variable because it is accessed from multiple threads. Not sure if it would be possible to add a `GUARDED_BY` annotation but that could be nice.\n\nMore importantly, we may want to consider moving this variable somewhere else. A side-effect of adding the variable here is that it makes the MinerImpl class have state, which can be bad because now destroying the `Mining` object while `createNewBlock` or `waitNext` calls are in progress can cause segfaults. This could cause the node to crash with existing IPC clients if they destroy `Mining` objects early, or if they just disconnect during a `waitNext` call and the `Mining` object is garbage collected before it returns.\n\nFor these reasons I think it might be good to move the `MinerImpl::m_interrupt` variable somewhere else like `KernelNotifications::m_blocktemplate_request_interrupted`. This would be hackier than the current solution but I think worth it to avoid node crashes triggered by IPC.\n\n(In the longer term a better solution would be to provide an `interfaces::Interrupt` type that could be passed to `waitNext` and `createBlockTemplate` methods as additional method argument. These methods could then attach a `std::function<void()>` lambda to run whatever code they need when an interrupt is triggered. Clients would then have the ability to cancel individual calls by triggering the `Interrupt` object. Internally, the cancellation could be implemented either by making a separate RPC call or by using Cap'n Proto's native `allowCancellation` mechanism.)\n\n\n",
      "created_at": "2026-01-29T18:23:02Z",
      "updated_at": "2026-01-29T19:33:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2742950202",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2742950202"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1004,
      "original_line": 1004,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2743104032",
      "pull_request_review_id": 3724510717,
      "id": 2743104032,
      "node_id": "PRRC_kwDOABII586jgHIg",
      "diff_hunk": "@@ -265,19 +271,38 @@ async def async_routine():\n             assert_equal(oldblockref.height, newblockref.height)\n \n             async with AsyncExitStack() as stack:\n-                self.log.debug(\"Create a template\")\n                 opts = self.capnp_modules['mining'].BlockCreateOptions()\n                 opts.useMempool = True\n                 opts.blockReservedWeight = 4000\n                 opts.coinbaseOutputMaxAdditionalSigops = 0\n+\n+                self.log.debug(\"createNewBlock() should wait if tip is still updating\")\n+                self.disconnect_nodes(0, 1)\n+                node1_block_hash = self.generate(self.nodes[1], 1, sync_fun=self.no_op)[0]\n+                header = from_hex(CBlockHeader(), self.nodes[1].getblockheader(node1_block_hash, False))\n+                header_only_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n+                header_only_peer.send_and_ping(msg_headers([header]))\n+                start = time.time()\n+                async with destroying((await mining.createNewBlock(opts)).result, ctx):\n+                    pass\n+                # Lower-bound only: a heavily loaded CI host might still exceed 0.9s\n+                # even without the cooldown, so this can miss regressions but avoids\n+                # spurious failures.\n+                assert_greater_than_or_equal(time.time() - start, 0.9)",
      "path": "test/functional/interface_ipc.py",
      "position": 74,
      "original_position": 56,
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "original_commit_id": "9817657d463ff1d8502a5edf0641e88b9b1d4853",
      "in_reply_to_id": 2736935556,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "See #34452. No preference on merge order, either should be easy to rebase.",
      "created_at": "2026-01-29T19:09:30Z",
      "updated_at": "2026-01-29T19:09:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2743104032",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2743104032"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 299,
      "original_line": 299,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2743211728",
      "pull_request_review_id": 3724642323,
      "id": 2743211728,
      "node_id": "PRRC_kwDOABII586jghbQ",
      "diff_hunk": "@@ -995,6 +1000,7 @@ class MinerImpl : public Mining\n     NodeContext* context() override { return &m_node; }\n     ChainstateManager& chainman() { return *Assert(m_node.chainman); }\n     KernelNotifications& notifications() { return *Assert(m_node.notifications); }\n+    bool m_interrupt{false};",
      "path": "src/node/interfaces.cpp",
      "position": 43,
      "original_position": 33,
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "original_commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "in_reply_to_id": 2742950202,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I mostly just cloned the pattern we used for `waitNext()`. Does it have a similar issue?\r\n\r\n---\r\n\r\nWill give it some thought, but if it's too complicated then I'll move the commit to a followup PR.",
      "created_at": "2026-01-29T19:40:23Z",
      "updated_at": "2026-01-29T19:46:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2743211728",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2743211728"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1004,
      "original_line": 1004,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2743442295",
      "pull_request_review_id": 3724930526,
      "id": 2743442295,
      "node_id": "PRRC_kwDOABII586jhZt3",
      "diff_hunk": "@@ -487,16 +490,22 @@ std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifi\n         // always returns valid tip information when possible and only\n         // returns null when shutting down, not when timing out.\n         kernel_notifications.m_tip_block_cv.wait(lock, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\n-            return kernel_notifications.TipBlock() || chainman.m_interrupt;\n+            return kernel_notifications.TipBlock() || chainman.m_interrupt || interrupt;\n         });\n-        if (chainman.m_interrupt) return {};\n+        if (chainman.m_interrupt || interrupt) {\n+            interrupt = false;\n+            return {};\n+        }\n         // At this point TipBlock is set, so continue to wait until it is\n         // different then `current_tip` provided by caller.\n         kernel_notifications.m_tip_block_cv.wait_until(lock, deadline, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\n-            return Assume(kernel_notifications.TipBlock()) != current_tip || chainman.m_interrupt;\n+            return Assume(kernel_notifications.TipBlock()) != current_tip || chainman.m_interrupt || interrupt;\n         });\n     }\n-    if (chainman.m_interrupt) return {};\n+    if (chainman.m_interrupt || interrupt) {\n+        interrupt = false;",
      "path": "src/node/miner.cpp",
      "position": 1,
      "original_position": 54,
      "commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "original_commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In commit \"mining: add interrupt()\" (b57da688c21233e852c5afe5c5afafd3cae84e91)\n\nThere is a thread safety issue here because `interrupt` is accessed without `m_tip_block_mutex` and it could be written by another thread calling the `interrupt` method. Could be fixed by moving these checks one line up into the block above",
      "created_at": "2026-01-29T20:39:38Z",
      "updated_at": "2026-01-29T21:15:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2743442295",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2743442295"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": 505,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 506,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2743566474",
      "pull_request_review_id": 3724930526,
      "id": 2743566474,
      "node_id": "PRRC_kwDOABII586jh4CK",
      "diff_hunk": "@@ -995,6 +1000,7 @@ class MinerImpl : public Mining\n     NodeContext* context() override { return &m_node; }\n     ChainstateManager& chainman() { return *Assert(m_node.chainman); }\n     KernelNotifications& notifications() { return *Assert(m_node.notifications); }\n+    bool m_interrupt{false};",
      "path": "src/node/interfaces.cpp",
      "position": 43,
      "original_position": 33,
      "commit_id": "1ae88d1688958fe567a087ec591015ea832aa8f0",
      "original_commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "in_reply_to_id": 2742950202,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2742950202\r\n\r\n> I mostly just cloned the pattern we used for `waitNext()`. Does it have a similar issue?\r\n\r\nYou are right, I misremembered the way `interruptWait` was implemented and it does follow a similar pattern, and the issue is not as bad as I thought.\r\n\r\nThe issue is actually pretty hard to trigger because the Cap'n Proto's internal reference counting keeps the `BlockTemplate` object alive by default until the `waitNext` call returns. So a client would have to explicitly call destroy on the `BlockTemplate` object in that case or the `Mining` object in this case for there to be a crash.\r\n\r\nSo I think the current implementation of this is ok and unlikely to lead to any accidental crashes.\r\n\r\nI did go ahead and implement my suggestion before realizing the problem was not so bad, so will paste it here for reference, but your current solution seems cleaner and I'd recommend keeping it.\r\n\r\n<details><summary>diff</summary>\r\n<p>\r\n\r\n```diff\r\n--- a/src/node/interfaces.cpp\r\n+++ b/src/node/interfaces.cpp\r\n@@ -929,7 +929,7 @@ public:\r\n \r\n     void interruptWait() override\r\n     {\r\n-        InterruptWait(notifications(), m_interrupt_wait);\r\n+        InterruptWait(notifications(), &m_interrupt_wait);\r\n     }\r\n \r\n     const BlockAssembler::Options m_assemble_options;\r\n@@ -964,7 +964,7 @@ public:\r\n \r\n     std::optional<BlockRef> waitTipChanged(uint256 current_tip, MillisecondsDouble timeout) override\r\n     {\r\n-        return WaitTipChanged(chainman(), notifications(), current_tip, timeout, m_interrupt);\r\n+        return WaitTipChanged(chainman(), notifications(), current_tip, timeout);\r\n     }\r\n \r\n     std::unique_ptr<BlockTemplate> createNewBlock(const BlockCreateOptions& options) override\r\n@@ -976,7 +976,7 @@ public:\r\n         // Avoid generating a new template immediately after connecting a block while\r\n         // our best known header chain still has more work. This prevents a burst of\r\n         // block templates during the final catch-up moments after IBD.\r\n-        if (!CooldownIfHeadersAhead(chainman(), notifications(), *maybe_tip, m_interrupt)) return {};\r\n+        if (!CooldownIfHeadersAhead(chainman(), notifications(), *maybe_tip)) return {};\r\n \r\n         BlockAssembler::Options assemble_options{options};\r\n         ApplyArgsManOptions(*Assert(m_node.args), assemble_options);\r\n@@ -985,7 +985,7 @@ public:\r\n \r\n     void interrupt() override\r\n     {\r\n-        InterruptWait(notifications(), m_interrupt);\r\n+        InterruptWait(notifications());\r\n     }\r\n \r\n     bool checkBlock(const CBlock& block, const node::BlockCheckOptions& options, std::string& reason, std::string& debug) override\r\n@@ -1000,7 +1000,6 @@ public:\r\n     NodeContext* context() override { return &m_node; }\r\n     ChainstateManager& chainman() { return *Assert(m_node.chainman); }\r\n     KernelNotifications& notifications() { return *Assert(m_node.notifications); }\r\n-    bool m_interrupt{false};\r\n     NodeContext& m_node;\r\n };\r\n } // namespace\r\n--- a/src/node/kernel_notifications.h\r\n+++ b/src/node/kernel_notifications.h\r\n@@ -61,6 +61,14 @@ public:\r\n     //! Might be unset during an early shutdown.\r\n     std::optional<uint256> TipBlock() EXCLUSIVE_LOCKS_REQUIRED(m_tip_block_mutex);\r\n \r\n+    //! Whether a createNewBlock() / waitNext() cancellation has been requested.\r\n+    //! Having this variable here hacky, but avoids the problem of\r\n+    //! createNewBlock not being interruptible during IBD by mining clients, and\r\n+    //! avoids memory safety issues that would occur if the variable was\r\n+    //! somewhere else. An idea for getting rid of this is described in\r\n+    //! https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2742950202\r\n+    bool m_blocktemplate_request_interrupted GUARDED_BY(m_tip_block_mutex);\r\n+\r\n private:\r\n     const std::function<bool()>& m_shutdown_request;\r\n     std::atomic<int>& m_exit_status;\r\n--- a/src/node/miner.cpp\r\n+++ b/src/node/miner.cpp\r\n@@ -341,13 +341,27 @@ void AddMerkleRootAndCoinbase(CBlock& block, CTransactionRef coinbase, uint32_t\r\n     block.fChecked = false;\r\n }\r\n \r\n-void InterruptWait(KernelNotifications& kernel_notifications, bool& interrupt_wait)\r\n+void InterruptWait(KernelNotifications& kernel_notifications, bool* interrupt_wait)\r\n {\r\n     LOCK(kernel_notifications.m_tip_block_mutex);\r\n-    interrupt_wait = true;\r\n+    kernel_notifications.m_blocktemplate_request_interrupted = true;\r\n+    if (interrupt_wait) *interrupt_wait = true;\r\n     kernel_notifications.m_tip_block_cv.notify_all();\r\n }\r\n \r\n+static bool Interrupted(const KernelNotifications& kernel_notifications, const bool* interrupt_wait = nullptr) EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex)\r\n+{\r\n+    return kernel_notifications.m_blocktemplate_request_interrupted || (interrupt_wait && *interrupt_wait);\r\n+}\r\n+\r\n+static bool ResetInterrupt(KernelNotifications& kernel_notifications, bool* interrupt_wait = nullptr) EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex)\r\n+{\r\n+    if (!Interrupted(kernel_notifications, interrupt_wait)) return false;\r\n+    kernel_notifications.m_blocktemplate_request_interrupted = false;\r\n+    if (interrupt_wait) *interrupt_wait = false;\r\n+    return true;\r\n+}\r\n+\r\n std::unique_ptr<CBlockTemplate> WaitAndCreateNewBlock(ChainstateManager& chainman,\r\n                                                       KernelNotifications& kernel_notifications,\r\n                                                       CTxMemPool* mempool,\r\n@@ -379,12 +393,9 @@ std::unique_ptr<CBlockTemplate> WaitAndCreateNewBlock(ChainstateManager& chainma\r\n                 // method on BlockTemplate and no template could have been\r\n                 // generated before a tip exists.\r\n                 tip_changed = Assume(tip_block) && tip_block != block_template->block.hashPrevBlock;\r\n-                return tip_changed || chainman.m_interrupt || interrupt_wait;\r\n+                return tip_changed || chainman.m_interrupt || Interrupted(kernel_notifications, &interrupt_wait);\r\n             });\r\n-            if (interrupt_wait) {\r\n-                interrupt_wait = false;\r\n-                return nullptr;\r\n-            }\r\n+            if (ResetInterrupt(kernel_notifications, &interrupt_wait)) return nullptr;\r\n         }\r\n \r\n         if (chainman.m_interrupt) return nullptr;\r\n@@ -445,7 +456,7 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman)\r\n     return BlockRef{tip->GetBlockHash(), tip->nHeight};\r\n }\r\n \r\n-bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip, bool& interrupt)\r\n+bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip)\r\n {\r\n     constexpr auto COOLDOWN{1s};\r\n     // Use a steady clock so cooldown is independent of mocktime.\r\n@@ -455,12 +466,9 @@ bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& ke\r\n         WAIT_LOCK(kernel_notifications.m_tip_block_mutex, lock);\r\n         kernel_notifications.m_tip_block_cv.wait_until(lock, cooldown_deadline, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\r\n             const auto tip_block = kernel_notifications.TipBlock();\r\n-            return chainman.m_interrupt || interrupt || (tip_block && *tip_block != last_tip_hash);\r\n+            return chainman.m_interrupt || Interrupted(kernel_notifications) || (tip_block && *tip_block != last_tip_hash);\r\n         });\r\n-        if (chainman.m_interrupt || interrupt) {\r\n-            interrupt = false;\r\n-            return false;\r\n-        }\r\n+        if (chainman.m_interrupt || ResetInterrupt(kernel_notifications)) return false;\r\n \r\n         // If the tip changed during the wait, extend the deadline\r\n         const auto tip_block = kernel_notifications.TipBlock();\r\n@@ -477,7 +485,7 @@ bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& ke\r\n     return true;\r\n }\r\n \r\n-std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const uint256& current_tip, MillisecondsDouble& timeout, bool& interrupt)\r\n+std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const uint256& current_tip, MillisecondsDouble& timeout)\r\n {\r\n     Assume(timeout >= 0ms); // No internal callers should use a negative timeout\r\n     if (timeout < 0ms) timeout = 0ms;\r\n@@ -490,21 +498,15 @@ std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifi\r\n         // always returns valid tip information when possible and only\r\n         // returns null when shutting down, not when timing out.\r\n         kernel_notifications.m_tip_block_cv.wait(lock, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\r\n-            return kernel_notifications.TipBlock() || chainman.m_interrupt || interrupt;\r\n+            return kernel_notifications.TipBlock() || chainman.m_interrupt || Interrupted(kernel_notifications);\r\n         });\r\n-        if (chainman.m_interrupt || interrupt) {\r\n-            interrupt = false;\r\n-            return {};\r\n-        }\r\n+        if (chainman.m_interrupt || ResetInterrupt(kernel_notifications)) return {};\r\n         // At this point TipBlock is set, so continue to wait until it is\r\n         // different then `current_tip` provided by caller.\r\n         kernel_notifications.m_tip_block_cv.wait_until(lock, deadline, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\r\n-            return Assume(kernel_notifications.TipBlock()) != current_tip || chainman.m_interrupt || interrupt;\r\n+            return Assume(kernel_notifications.TipBlock()) != current_tip || chainman.m_interrupt || Interrupted(kernel_notifications);\r\n         });\r\n-    }\r\n-    if (chainman.m_interrupt || interrupt) {\r\n-        interrupt = false;\r\n-        return {};\r\n+        if (chainman.m_interrupt || ResetInterrupt(kernel_notifications)) return {};\r\n     }\r\n \r\n     // Must release m_tip_block_mutex before getTip() locks cs_main, to\r\n--- a/src/node/miner.h\r\n+++ b/src/node/miner.h\r\n@@ -143,7 +143,7 @@ void AddMerkleRootAndCoinbase(CBlock& block, CTransactionRef coinbase, uint32_t\r\n \r\n \r\n /* Interrupt a blocking call. */\r\n-void InterruptWait(KernelNotifications& kernel_notifications, bool& interrupt_wait);\r\n+void InterruptWait(KernelNotifications& kernel_notifications, bool* interrupt_wait = nullptr);\r\n /**\r\n  * Return a new block template when fees rise to a certain threshold or after a\r\n  * new tip; return nullopt if timeout is reached.\r\n@@ -163,7 +163,7 @@ std::optional<BlockRef> GetTip(ChainstateManager& chainman);\r\n  * Returns the current tip, or nullopt if the node is shutting down or interrupt()\r\n  * is called.\r\n  */\r\n-std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const uint256& current_tip, MillisecondsDouble& timeout, bool& interrupt);\r\n+std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const uint256& current_tip, MillisecondsDouble& timeout);\r\n \r\n /**\r\n  * Wait while the best known header extends the current chain tip AND at least\r\n@@ -177,11 +177,10 @@ std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifi\r\n  * once per connected client. Subsequent templates are provided by waitNext().\r\n  *\r\n  * @param last_tip tip at the start of the cooldown window.\r\n- * @param interrupt set to true to interrupt the cooldown.\r\n  *\r\n  * @returns false if interrupted.\r\n  */\r\n-bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip, bool& interrupt);\r\n+bool CooldownIfHeadersAhead(ChainstateManager& chainman, KernelNotifications& kernel_notifications, const BlockRef& last_tip);\r\n } // namespace node\r\n \r\n #endif // BITCOIN_NODE_MINER_H\r\n```\r\n</p>\r\n</details>\r\n\r\n\r\n\r\n",
      "created_at": "2026-01-29T21:11:56Z",
      "updated_at": "2026-01-29T21:15:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2743566474",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2743566474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1004,
      "original_line": 1004,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2745846683",
      "pull_request_review_id": 3727775186,
      "id": 2745846683,
      "node_id": "PRRC_kwDOABII586jqkub",
      "diff_hunk": "@@ -487,16 +490,22 @@ std::optional<BlockRef> WaitTipChanged(ChainstateManager& chainman, KernelNotifi\n         // always returns valid tip information when possible and only\n         // returns null when shutting down, not when timing out.\n         kernel_notifications.m_tip_block_cv.wait(lock, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\n-            return kernel_notifications.TipBlock() || chainman.m_interrupt;\n+            return kernel_notifications.TipBlock() || chainman.m_interrupt || interrupt;\n         });\n-        if (chainman.m_interrupt) return {};\n+        if (chainman.m_interrupt || interrupt) {\n+            interrupt = false;\n+            return {};\n+        }\n         // At this point TipBlock is set, so continue to wait until it is\n         // different then `current_tip` provided by caller.\n         kernel_notifications.m_tip_block_cv.wait_until(lock, deadline, [&]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {\n-            return Assume(kernel_notifications.TipBlock()) != current_tip || chainman.m_interrupt;\n+            return Assume(kernel_notifications.TipBlock()) != current_tip || chainman.m_interrupt || interrupt;\n         });\n     }\n-    if (chainman.m_interrupt) return {};\n+    if (chainman.m_interrupt || interrupt) {\n+        interrupt = false;",
      "path": "src/node/miner.cpp",
      "position": 1,
      "original_position": 54,
      "commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "original_commit_id": "b57da688c21233e852c5afe5c5afafd3cae84e91",
      "in_reply_to_id": 2743442295,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done, and added a link to your more elaborate solution in the commit message.",
      "created_at": "2026-01-30T11:38:50Z",
      "updated_at": "2026-01-30T11:38:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34184#discussion_r2745846683",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2745846683"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34184"
        }
      },
      "start_line": null,
      "original_start_line": 505,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 506,
      "side": "RIGHT"
    }
  ]
}