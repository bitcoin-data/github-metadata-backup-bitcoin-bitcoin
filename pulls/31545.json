{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545",
    "id": 2246190201,
    "node_id": "PR_kwDOABII586F4iR5",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/31545",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/31545.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/31545.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31545",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31545/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
    "number": 31545,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "ci: optionally use local docker build cache",
    "user": {
      "login": "0xB10C",
      "id": 19157360,
      "node_id": "MDQ6VXNlcjE5MTU3MzYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xB10C",
      "html_url": "https://github.com/0xB10C",
      "followers_url": "https://api.github.com/users/0xB10C/followers",
      "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
      "organizations_url": "https://api.github.com/users/0xB10C/orgs",
      "repos_url": "https://api.github.com/users/0xB10C/repos",
      "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/0xB10C/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "By setting `DOCKER_BUILD_CACHE_HOST_DIR`, the task-specific docker images built during the CI run can be cached. This allows, for example, ephemeral CI runners to reuse the docker images (or layers of it) from earlier runs, by persisting the image cache before the ephemeral CI runner is shut down. The cache keyed by `CONTAINER_NAME`.\r\n\r\nAs `--cache-to` doesn't remove old cache files, the existing cache is removed after a successful `docker build` and the newly cached image is moved to it's location to avoid the cache from growing indefinitely with old, unused layers.\r\n\r\nWhen `--cache-from` doesn't find the directory, the cached version is a cache-miss, or the cache can't be imported for whatever other reason, it warns and `docker build` continues by building the docker image.\r\n\r\nThis feature is opt-in. The documentation for the docker build cache of `type=local` can be found on https://docs.docker.com/build/cache/backends/local/\r\n\r\nThis replaces https://github.com/bitcoin/bitcoin/pull/31377 - some of the discussion there might provide more context. ",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "created_at": "2024-12-20T07:59:56Z",
    "updated_at": "2024-12-20T11:11:19Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "35f1984a1ca93cbba0019581cfd94755e13c6684",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "0xB10C:2024-11-ci-optional-local-docker-build-cache",
      "ref": "2024-11-ci-optional-local-docker-build-cache",
      "sha": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 184896538,
        "node_id": "MDEwOlJlcG9zaXRvcnkxODQ4OTY1Mzg=",
        "name": "bitcoin",
        "full_name": "0xB10C/bitcoin",
        "owner": {
          "login": "0xB10C",
          "id": 19157360,
          "node_id": "MDQ6VXNlcjE5MTU3MzYw",
          "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/0xB10C",
          "html_url": "https://github.com/0xB10C",
          "followers_url": "https://api.github.com/users/0xB10C/followers",
          "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
          "organizations_url": "https://api.github.com/users/0xB10C/orgs",
          "repos_url": "https://api.github.com/users/0xB10C/repos",
          "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/0xB10C/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/0xB10C/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/0xB10C/bitcoin",
        "archive_url": "https://api.github.com/repos/0xB10C/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/0xB10C/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/0xB10C/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/0xB10C/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/0xB10C/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/0xB10C/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/0xB10C/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/0xB10C/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/0xB10C/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/0xB10C/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/0xB10C/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/0xB10C/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/0xB10C/bitcoin/events",
        "forks_url": "https://api.github.com/repos/0xB10C/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/0xB10C/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/0xB10C/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/0xB10C/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/0xB10C/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/0xB10C/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/0xB10C/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/0xB10C/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/0xB10C/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/0xB10C/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/0xB10C/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/0xB10C/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/0xB10C/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/0xB10C/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/0xB10C/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/0xB10C/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:0xB10C/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/0xB10C/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/0xB10C/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/0xB10C/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/0xB10C/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/0xB10C/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/0xB10C/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/0xB10C/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/0xB10C/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/0xB10C/bitcoin/hooks",
        "svn_url": "https://github.com/0xB10C/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 260592,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-12-20T10:23:44Z",
        "created_at": "2019-05-04T13:11:05Z",
        "updated_at": "2024-12-19T14:20:34Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "bb57017b2945d5e0bbd95c7f1a9369a8ab7c6fcd",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36610,
        "stargazers_count": 80898,
        "watchers_count": 80898,
        "size": 273645,
        "default_branch": "master",
        "open_issues_count": 682,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-12-19T15:23:33Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-12-20T11:16:45Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 33,
    "deletions": 0,
    "changed_files": 2,
    "commits": 1,
    "review_comments": 4,
    "comments": 3
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQxNDliMDBhZTVmZGQ1NDQwNjE2M2M3YjZiZWQzMjE5YjllY2JmZDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "tree": {
        "sha": "25bdefce17d4a79e04995bb2c23bcf4cc22f896b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/25bdefce17d4a79e04995bb2c23bcf4cc22f896b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 25bdefce17d4a79e04995bb2c23bcf4cc22f896b\nparent c1252b14d714448295200a595086dd3e78b46c8f\nauthor 0xb10c <b10c@b10c.me> 1732732188 +0100\ncommitter 0xb10c <b10c@b10c.me> 1734680917 +0100\n\nci: optionally use local docker build cache\n\nBy setting DOCKER_BUILD_CACHE_HOST_DIR, the task-specific docker\nimages built during the CI run can be cached. This allows, for\nexample, ephemeral CI runners to reuse the docker images (or\nlayers of it) from earlier runs, by persisting the image cache\nbefore the ephemeral CI runner is shut down. The cache keyed by\n`CONTAINER_NAME`.\n\nAs --cache-to doesn't remove old cache files, the existing cache\nis removed after a successful `docker build` and the newly cached\nimage is moved to it's location to avoid the cache from growing\nindefinitly with old, unused layers.\n\nWhen --cache-from doesn't find the directory, the cached version is\na cache-miss, or the cache can't be imported for whatever other reason,\nit warns and `docker build` continues by building the docker image.\n\nThis feature is opt-in. The documentation for the cache type=local\ncan be found https://docs.docker.com/build/cache/backends/local/\n\nThis replaces https://github.com/bitcoin/bitcoin/pull/31377\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEDMuq/Xai7OLM0xQd4v/VsdiMqX0FAmdlIVsACgkQ4v/VsdiM\nqX3JMA//dhh7AIh9Dg5ithDGg6GL66JZDpHWI92k5qHt523R1ipc8lYKFh54H9ln\nXKpvK8I5vu9Zo7VrjEusXIJ54ub/oonKeN040f0GL7HgMwdLAXzePBiFwxibDLAF\nKLp0ziMR0dFSDVlZftlofjtWLILJG9lfdUFxI0XkH8kuCkK3Be5Gb/HBcDGQ+fRe\n6NkxQkEPMDY24juIWQGvqmhQmvt3NeZFmoLLUupt76gpudH7CzuYBlwLrDZzlUV2\n0C6myF99OYLhUc+FZ0BHALzp9NgkrmlE8ZUo7OjHSo0xv1M+9zNvLy8NQQW469nr\nQGPu+1de+z7UdDgUL3IhPOXj5RpSo0TmLRIyYT2RV1d+lOpsOPlVTub1VhzAU8Eq\nB1AVx8Lx+AHhw4C8WdTBnElAHFkQbqKFlqfnFOeKOcDkgFn4/iHIHggu5OtMHtW7\nmJ7L4Pj2TS6WK+pBZ4dRYutUaZJay0m5mYGq+i0tQBBkY8OQYPiCBCO4Df1y2CdP\nKofNvI1LQ6U/YurdvlyTWrBmOVpwVUVXHKi6H3D0hKFMuCrBQ0He0Me0XFnjhqb4\ndytfk0HhruOJ8JA9cw1LfMBK04DOkjXQfhp0rp+jYWtBreuyVrjhXL06McFI7HKy\ntCCpdZknyuqFWRUXMGcVM881qGwT0mFjQFJCzqUU31Esnj9UMHo=\n=W7tF\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIP2PiHtmX89pvvc0jMpN5wA+H699YcTsAe7Dj11bz9H5CP/wEBQZ9tTOxRmg\nt4c0i/63AAII8CClFfJ79Lj95KGNt+Scxj6MobPlKJU8irpw/HibUkzn4QjxBGdl\nIWTwCKxAcDe4JToRAIPf4w0u+QyOLi1odHRwczovL2FsaWNlLmJ0Yy5jYWxlbmRh\nci5vcGVudGltZXN0YW1wcy5vcmf/8BBMbPbGu77r8s+plZ90vg61CPAgligAey8v\nba8iDPVv9Qdit5LGKaEk1Ierc7ezCLIv0IoI8QRnZSFk8Ahj9VgJM8BCtACD3+MN\nLvkMjikoaHR0cHM6Ly9maW5uZXkuY2FsZW5kYXIuZXRlcm5pdHl3YWxsLmNvbf/w\nEF3kWTQFI7S29VA7v1EjiuYI8QRnZSFk8AiSqkbJPxZFQwCD3+MNLvkMjiwraHR0\ncHM6Ly9ib2IuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZ/AQgFvbM8HO\niOmlghQPcMnbagjxBGdlIWPwCPf53vVDVWGEAIPf4w0u+QyOIyJodHRwczovL2J0\nYy5jYWxlbmRhci5jYXRhbGxheHkuY29t\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c1252b14d714448295200a595086dd3e78b46c8f",
          "sha": "c1252b14d714448295200a595086dd3e78b46c8f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c1252b14d714448295200a595086dd3e78b46c8f"
        }
      ],
      "message": "ci: optionally use local docker build cache\n\nBy setting DOCKER_BUILD_CACHE_HOST_DIR, the task-specific docker\nimages built during the CI run can be cached. This allows, for\nexample, ephemeral CI runners to reuse the docker images (or\nlayers of it) from earlier runs, by persisting the image cache\nbefore the ephemeral CI runner is shut down. The cache keyed by\n`CONTAINER_NAME`.\n\nAs --cache-to doesn't remove old cache files, the existing cache\nis removed after a successful `docker build` and the newly cached\nimage is moved to it's location to avoid the cache from growing\nindefinitly with old, unused layers.\n\nWhen --cache-from doesn't find the directory, the cached version is\na cache-miss, or the cache can't be imported for whatever other reason,\nit warns and `docker build` continues by building the docker image.\n\nThis feature is opt-in. The documentation for the cache type=local\ncan be found https://docs.docker.com/build/cache/backends/local/\n\nThis replaces https://github.com/bitcoin/bitcoin/pull/31377",
      "committer": {
        "name": "0xb10c",
        "email": "b10c@b10c.me",
        "date": "2024-12-20T07:48:37Z"
      },
      "author": {
        "name": "0xb10c",
        "email": "b10c@b10c.me",
        "date": "2024-11-27T18:29:48Z"
      },
      "sha": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4"
    },
    {
      "event": "commented",
      "id": 2556474672,
      "node_id": "IC_kwDOABII586YYLUw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2556474672",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T07:59:58Z",
      "updated_at": "2024-12-20T07:59:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31545.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#issuecomment-2556474672",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31545"
    },
    {
      "event": "labeled",
      "id": 15729458619,
      "node_id": "LE_lADOABII586kCsDrzwAAAAOpjH27",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15729458619",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T08:00:01Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "commented",
      "id": 2556532955,
      "node_id": "IC_kwDOABII586YYZjb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2556532955",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T08:41:35Z",
      "updated_at": "2024-12-20T08:41:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "Some additional context:\r\n\r\nI've been testing and using this with ephemeral cirrus runners I've been working on. See a run of the initial commit of this PR here: https://cirrus-ci.com/build/6017527349772288. If this PR is merged, these could be used on bitcoin/bitcoin after a while - once people have rebased their PRs to include this change. Old branches, for example, 28.x backports won't be able to use this (unless backported) but the docker images on old branches might generally be different and will be needed to rebuild. \r\n\r\nThe cache for all of our self-hosted x86_64 Cirrus tasks (all but the ARM task) is about 5.2 GB. I don't expect this to grow or shrink significantly. \r\n\r\n```console\r\n$ du -h -d1 .\r\n477M\t./ci_macos_cross\r\n837M\t./ci_win64\r\n356M\t./ci_native_nowallet_libbitcoinkernel\r\n205M\t./ci_native_previous_releases\r\n1.4G\t./ci_native_msan\r\n314M\t./ci_i686_centos\r\n338M\t./ci_native_tsan\r\n693M\t./ci_native_tidy\r\n359M\t./ci_i686_multiprocess\r\n351M\t./ci_native_fuzz\r\n5.2G\t.\r\n```\r\n\r\nLoading, extracting and importing the cache artifacts on a cache-hit takes a few seconds. This is slower compared to the current non-ephemeral self-hosted runners if they already have a fitting image in their docker image store. Here's the log output for a cache-hit on [my runner's `macos-cross` task](https://cirrus-ci.com/task/6677788209446912).\r\n\r\n<details>\r\n<summary>\r\n`docker build` log section\r\n\r\n</summary>\r\n\r\n\r\n```\r\n[07:49:56.064] + echo 'Creating docker.io/ubuntu:24.04 container to run in'\r\n[07:49:56.064] Creating docker.io/ubuntu:24.04 container to run in\r\n[07:49:56.064] + DOCKER_BUILD_CACHE_ARG=\r\n[07:49:56.064] + DOCKER_BUILD_CACHE_TEMPDIR=\r\n[07:49:56.064] + DOCKER_BUILD_CACHE_OLD_DIR=\r\n[07:49:56.064] + DOCKER_BUILD_CACHE_NEW_DIR=\r\n[07:49:56.064] + '[' /cache/docker/ci-imgs ']'\r\n[07:49:56.064] + DOCKER_BUILD_CACHE_OLD_DIR=/cache/docker/ci-imgs/ci_macos_cross\r\n[07:49:56.064] ++ mktemp --directory\r\n[07:49:56.074] + DOCKER_BUILD_CACHE_TEMPDIR=/var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh\r\n[07:49:56.074] + DOCKER_BUILD_CACHE_NEW_DIR=/var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh/ci_macos_cross\r\n[07:49:56.074] + DOCKER_BUILD_CACHE_ARG='--cache-from type=local,src=/cache/docker/ci-imgs/ci_macos_cross --cache-to type=local,dest=/var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh/ci_macos_cross,mode=max'\r\n[07:49:56.074] + DOCKER_BUILDKIT=1\r\n[07:49:56.074] + docker build --file /var/lib/cirrus-worker/tmp/cirrus-build/ci/test_imagefile --build-arg CI_IMAGE_NAME_TAG=docker.io/ubuntu:24.04 --build-arg FILE_ENV=./ci/test/00_setup_env_mac_cross.sh --label=bitcoin-ci-test --tag=ci_macos_cross --cache-from type=local,src=/cache/docker/ci-imgs/ci_macos_cross --cache-to type=local,dest=/var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh/ci_macos_cross,mode=max /var/lib/cirrus-worker/tmp/cirrus-build\r\n[07:49:56.738] #0 building with \"default\" instance using docker driver\r\n[07:49:56.738] \r\n[07:49:56.738] #1 [internal] load build definition from test_imagefile\r\n[07:49:56.738] #1 transferring dockerfile: 600B done\r\n[07:49:56.738] #1 WARN: InvalidDefaultArgInFrom: Default value for ARG ${CI_IMAGE_NAME_TAG} results in empty or invalid base image name (line 8)\r\n[07:49:56.738] #1 DONE 0.0s\r\n[07:49:56.738] \r\n[07:49:56.738] #2 [internal] load metadata for docker.io/library/ubuntu:24.04\r\n[07:49:56.738] #2 DONE 0.0s\r\n[07:49:56.738] \r\n[07:49:56.738] #3 [internal] load .dockerignore\r\n[07:49:56.738] #3 transferring context: 2B done\r\n[07:49:56.738] #3 DONE 0.0s\r\n[07:49:56.738] \r\n[07:49:56.738] #4 [internal] load build context\r\n[07:49:56.738] #4 DONE 0.0s\r\n[07:49:56.738] \r\n[07:49:56.738] #5 importing cache manifest from local:13157433447571386053\r\n[07:49:56.738] #5 inferred cache manifest type: application/vnd.oci.image.index.v1+json done\r\n[07:49:56.738] #5 DONE 0.0s\r\n[07:49:56.738] \r\n[07:49:56.738] #6 [1/4] FROM docker.io/library/ubuntu:24.04@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab\r\n[07:49:56.738] #6 resolve docker.io/library/ubuntu:24.04@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab\r\n[07:49:57.299] #6 resolve docker.io/library/ubuntu:24.04@sha256:80dd3c3b9c6cecb9f1667e9290b3bc61b78c2678c02cbdae5f0fea92cc6734ab 0.7s done\r\n[07:49:57.408] #6 DONE 0.7s\r\n[07:49:57.408] \r\n[07:49:57.408] #4 [internal] load build context\r\n[07:49:57.408] #4 transferring context: 12.88kB done\r\n[07:49:57.408] #4 DONE 0.0s\r\n[07:49:57.408] \r\n[07:49:57.408] #7 [2/4] COPY ./ci/retry/retry /usr/bin/retry\r\n[07:49:57.408] #7 CACHED\r\n[07:49:57.408] \r\n[07:49:57.408] #8 [3/4] COPY ./ci/test/00_setup_env.sh ././ci/test/00_setup_env_mac_cross.sh ./ci/test/01_base_install.sh /ci_container_base/ci/test/\r\n[07:49:57.408] #8 CACHED\r\n[07:49:57.408] \r\n[07:49:57.408] #9 [4/4] RUN [\"bash\", \"-c\", \"cd /ci_container_base/ && set -o errexit && source ./ci/test/00_setup_env.sh && ./ci/test/01_base_install.sh\"]\r\n[07:49:57.408] #9 sha256:febe602dc08a9a790bd092b613b049003ba7c75651d565cee664ecbebbe12bfc 1.85kB / 1.85kB 0.0s done\r\n[07:49:57.408] #9 extracting sha256:febe602dc08a9a790bd092b613b049003ba7c75651d565cee664ecbebbe12bfc done\r\n[07:49:57.408] #9 sha256:cfdd814cf5471383f503651cd4c6f1a1bcd432e92911dac06cff317cdbc6b305 3.38kB / 3.38kB 0.0s done\r\n[07:49:57.581] #9 extracting sha256:cfdd814cf5471383f503651cd4c6f1a1bcd432e92911dac06cff317cdbc6b305 0.0s done\r\n[07:49:57.588] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 8.39MB / 470.35MB 0.2s\r\n[07:49:58.038] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 38.80MB / 470.35MB 0.6s\r\n[07:49:58.488] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 70.25MB / 470.35MB 1.1s\r\n[07:49:58.938] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 102.76MB / 470.35MB 1.5s\r\n[07:49:59.388] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 134.22MB / 470.35MB 2.0s\r\n[07:49:59.839] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 164.63MB / 470.35MB 2.4s\r\n[07:50:00.292] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 193.99MB / 470.35MB 2.9s\r\n[07:50:00.738] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 223.35MB / 470.35MB 3.3s\r\n[07:50:01.191] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 254.80MB / 470.35MB 3.8s\r\n[07:50:01.638] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 286.26MB / 470.35MB 4.2s\r\n[07:50:02.089] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 315.62MB / 470.35MB 4.7s\r\n[07:50:02.538] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 346.03MB / 470.35MB 5.1s\r\n[07:50:02.988] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 376.44MB / 470.35MB 5.6s\r\n[07:50:03.438] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 406.85MB / 470.35MB 6.0s\r\n[07:50:03.888] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 436.21MB / 470.35MB 6.5s\r\n[07:50:04.338] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 468.71MB / 470.35MB 6.9s\r\n[07:50:04.811] #9 sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 470.35MB / 470.35MB 7.2s done\r\n[07:50:04.811] #9 extracting sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8\r\n[07:50:30.213] #9 extracting sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 25.6s done\r\n[07:50:30.453] #9 CACHED\r\n[07:50:30.453] \r\n[07:50:30.453] #10 exporting to image\r\n[07:50:30.453] #10 exporting layers done\r\n[07:50:30.453] #10 exporting manifest sha256:35b82073fb170cde1c1f340217048fa5fdca7bf710eb9836e1e75ae8f632c18a done\r\n[07:50:30.453] #10 exporting config sha256:040ba6df0bbe7839075a62de0a03179747c82ddff2a33a9a11d72202cd6ed3c7 done\r\n[07:50:30.453] #10 exporting attestation manifest sha256:b354c939c9e7630028a036a105ea52f56a74b91c54148db376b51477b6e47668 done\r\n[07:50:30.453] #10 exporting manifest list sha256:550407c300a249757f8f145ac481f361b7e7f22de8b62639006b7f2d202369d5 done\r\n[07:50:30.453] #10 naming to docker.io/library/ci_macos_cross:latest done\r\n[07:50:30.453] #10 unpacking to docker.io/library/ci_macos_cross:latest done\r\n[07:50:30.453] #10 DONE 0.1s\r\n[07:50:30.453] \r\n[07:50:30.453] #11 exporting cache to client directory\r\n[07:50:30.453] #11 preparing build cache for export\r\n[07:50:30.453] #11 writing layer sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8\r\n[07:50:37.448] #11 writing layer sha256:357d2c66fb559e3c323ff1fd5acd1db22cc7052af624ac52c48f0f34d1c1d0c8 7.1s done\r\n[07:50:37.448] #11 writing layer sha256:cfdd814cf5471383f503651cd4c6f1a1bcd432e92911dac06cff317cdbc6b305\r\n[07:50:37.624] #11 writing layer sha256:cfdd814cf5471383f503651cd4c6f1a1bcd432e92911dac06cff317cdbc6b305 0.0s done\r\n[07:50:37.624] #11 writing layer sha256:de44b265507ae44b212defcb50694d666f136b35c1090d9709068bc861bb2d64\r\n[07:50:37.963] #11 writing layer sha256:de44b265507ae44b212defcb50694d666f136b35c1090d9709068bc861bb2d64 0.5s done\r\n[07:50:37.963] #11 writing layer sha256:febe602dc08a9a790bd092b613b049003ba7c75651d565cee664ecbebbe12bfc\r\n[07:50:38.044] #11 preparing build cache for export 7.7s done\r\n[07:50:38.044] #11 writing layer sha256:febe602dc08a9a790bd092b613b049003ba7c75651d565cee664ecbebbe12bfc 0.0s done\r\n[07:50:38.044] #11 writing config sha256:16c21cc25bb3008714faa399494f419192dd76aa601d10f5c1216e218acc8d16 done\r\n[07:50:38.044] #11 writing cache manifest sha256:9e819d3419d1888e5ee2d5514592865fe2f9693029640942d852d7e3ae0e347f done\r\n[07:50:38.044] #11 DONE 7.7s\r\n[07:50:38.044] \r\n[07:50:38.044]  \r\n1 warning found (use docker --debug to expand):\r\n[07:50:38.044] \r\n - InvalidDefaultArgInFrom: Default value for ARG ${CI_IMAGE_NAME_TAG} results in empty or invalid base image name (line 8)\r\n[07:51:01.292] + '[' /cache/docker/ci-imgs ']'\r\n[07:51:01.292] + '[' -e /var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh/ci_macos_cross/index.json ']'\r\n[07:51:01.292] + echo 'Removing the existing docker build cache in /cache/docker/ci-imgs/ci_macos_cross'\r\n[07:51:01.292] Removing the existing docker build cache in /cache/docker/ci-imgs/ci_macos_cross\r\n[07:51:01.292] + rm -rf /cache/docker/ci-imgs/ci_macos_cross\r\n[07:51:01.321] + echo 'Moving the contents of /var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh/ci_macos_cross to /cache/docker/ci-imgs/ci_macos_cross'\r\n[07:51:01.321] Moving the contents of /var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh/ci_macos_cross to /cache/docker/ci-imgs/ci_macos_cross\r\n[07:51:01.321] + mv /var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh/ci_macos_cross /cache/docker/ci-imgs/ci_macos_cross\r\n[07:51:02.272] + rm -rf /var/lib/cirrus-worker/tmp/tmp.RYI5XdZ1Eh\r\n```\r\n\r\n</details>\r\n\r\n\r\nIt's important to note that this doesn't cache the base images (i.e. `ubuntu:24.04`, `debian:bookworm`, `centos/amd:stream9`, ...). On an ephemeral runner these can be cached with `docker load` and `docker save`. Otherwise, you might run into docker-hub rate-limits or connectivity problems to the registries.\r\n\r\n\r\nIt would be nice to have, in the medium term, pre-build docker images for the CI tasks that can be pulled (and cached) to avoid building them in CI at all (unless there's a change in the underlying docker image of course). My understanding is, that this needs a bit of restructuring of the current apt package installation and similar. @willcl-ark showed me something in the past that looked promising.\r\n\r\n\r\n\r\n\r\n",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#issuecomment-2556532955",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31545"
    },
    {
      "event": "mentioned",
      "id": 15729830960,
      "node_id": "MEE_lADOABII586kCsDrzwAAAAOpkiww",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15729830960",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T08:41:37Z"
    },
    {
      "event": "subscribed",
      "id": 15729830971,
      "node_id": "SE_lADOABII586kCsDrzwAAAAOpkiw7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15729830971",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T08:41:37Z"
    },
    {
      "event": "reviewed",
      "id": 2517084592,
      "node_id": "PRR_kwDOABII586WB6mw",
      "url": null,
      "actor": null,
      "commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#pullrequestreview-2517084592",
      "submitted_at": "2024-12-20T09:04:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545"
    },
    {
      "event": "commented",
      "id": 2556731379,
      "node_id": "IC_kwDOABII586YZJ_z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2556731379",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T10:37:54Z",
      "updated_at": "2024-12-20T10:38:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "A consideration might also to only specify `--cache-to` when ` CIRRUS_BRANCH=master`. This makes PR runs slightly faster as the cache isn't overwritten.  Also, most PRs don't introduce changes that cause a cache-miss, and if they do we want to not cache it until it's merged. Obviously, someone can fake this by overwriting `CIRRUS_BRANCH` to forcefully overwrite the cache for a while.",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#issuecomment-2556731379",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31545"
    },
    {
      "event": "reviewed",
      "id": 2517328456,
      "node_id": "PRR_kwDOABII586WC2JI",
      "url": null,
      "actor": null,
      "commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#pullrequestreview-2517328456",
      "submitted_at": "2024-12-20T11:09:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1893664120",
      "pull_request_review_id": 2517084592,
      "id": 1893664120,
      "node_id": "PRRC_kwDOABII585w3wV4",
      "diff_hunk": "@@ -68,3 +68,8 @@ export CI_BASE_PACKAGES=${CI_BASE_PACKAGES:-build-essential pkg-config curl ca-c\n export GOAL=${GOAL:-install}\n export DIR_QA_ASSETS=${DIR_QA_ASSETS:-${BASE_SCRATCH_DIR}/qa-assets}\n export CI_RETRY_EXE=${CI_RETRY_EXE:-\"retry --\"}\n+# The (optional) `docker build` cache directory.\n+# If set, the folder exists only on the CI host and is used\n+# as a build cache for the docker build of CI images. This\n+# cache can be multiple GB in size.\n+export DOCKER_BUILD_CACHE_HOST_DIR=${DOCKER_BUILD_CACHE_HOST_DIR:-}",
      "path": "ci/test/00_setup_env.sh",
      "position": 8,
      "original_position": 8,
      "commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "original_commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Is this required? It seems like a no-op, apart from the docs.\r\n\r\nThough, docker is already caching by default, and this is normally not needed. So I think it is fine to omit the docs, or inline them in 02_run_container.\r\n\r\nI am even thinking this should have the `DANGER_` prefix, as it calls `rm -rf` on the host for the folder.",
      "created_at": "2024-12-20T09:04:52Z",
      "updated_at": "2024-12-20T09:04:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#discussion_r1893664120",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1893664120"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 75,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1893769621",
      "pull_request_review_id": 2517262166,
      "id": 1893769621,
      "node_id": "PRRC_kwDOABII585w4KGV",
      "diff_hunk": "@@ -68,3 +68,8 @@ export CI_BASE_PACKAGES=${CI_BASE_PACKAGES:-build-essential pkg-config curl ca-c\n export GOAL=${GOAL:-install}\n export DIR_QA_ASSETS=${DIR_QA_ASSETS:-${BASE_SCRATCH_DIR}/qa-assets}\n export CI_RETRY_EXE=${CI_RETRY_EXE:-\"retry --\"}\n+# The (optional) `docker build` cache directory.\n+# If set, the folder exists only on the CI host and is used\n+# as a build cache for the docker build of CI images. This\n+# cache can be multiple GB in size.\n+export DOCKER_BUILD_CACHE_HOST_DIR=${DOCKER_BUILD_CACHE_HOST_DIR:-}",
      "path": "ci/test/00_setup_env.sh",
      "position": 8,
      "original_position": 8,
      "commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "original_commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "in_reply_to_id": 1893664120,
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good point. Will move docs to 02_run_container and prefix with `DANGER_`.",
      "created_at": "2024-12-20T10:37:51Z",
      "updated_at": "2024-12-20T10:37:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#discussion_r1893769621",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1893769621"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 75,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1893808813",
      "pull_request_review_id": 2517328456,
      "id": 1893808813,
      "node_id": "PRRC_kwDOABII585w4Tqt",
      "diff_hunk": "@@ -33,8 +50,19 @@ if [ -z \"$DANGER_RUN_CI_ON_HOST\" ]; then\n       $MAYBE_CPUSET \\\n       --label=\"${CI_IMAGE_LABEL}\" \\\n       --tag=\"${CONTAINER_NAME}\" \\\n+      $DOCKER_BUILD_CACHE_ARG \\\n       \"${BASE_READ_ONLY_DIR}\"\n \n+  if [ \"$DOCKER_BUILD_CACHE_HOST_DIR\" ]; then\n+    if [ -e \"${DOCKER_BUILD_CACHE_NEW_DIR}/index.json\" ]; then\n+      echo \"Removing the existing docker build cache in ${DOCKER_BUILD_CACHE_OLD_DIR}\"\n+      rm -rf \"${DOCKER_BUILD_CACHE_OLD_DIR}\"\n+      echo \"Moving the contents of ${DOCKER_BUILD_CACHE_NEW_DIR} to ${DOCKER_BUILD_CACHE_OLD_DIR}\"\n+      mv \"${DOCKER_BUILD_CACHE_NEW_DIR}\" \"${DOCKER_BUILD_CACHE_OLD_DIR}\"\n+    fi\n+    rm -rf \"${DOCKER_BUILD_CACHE_TEMPDIR}\"",
      "path": "ci/test/02_run_container.sh",
      "position": 38,
      "original_position": 38,
      "commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "original_commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This will be left dangling and cause out-of-storage, if the build fails?",
      "created_at": "2024-12-20T11:09:44Z",
      "updated_at": "2024-12-20T11:09:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#discussion_r1893808813",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1893808813"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 63,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1893810274",
      "pull_request_review_id": 2517330806,
      "id": 1893810274,
      "node_id": "PRRC_kwDOABII585w4UBi",
      "diff_hunk": "@@ -33,8 +50,19 @@ if [ -z \"$DANGER_RUN_CI_ON_HOST\" ]; then\n       $MAYBE_CPUSET \\\n       --label=\"${CI_IMAGE_LABEL}\" \\\n       --tag=\"${CONTAINER_NAME}\" \\\n+      $DOCKER_BUILD_CACHE_ARG \\\n       \"${BASE_READ_ONLY_DIR}\"\n \n+  if [ \"$DOCKER_BUILD_CACHE_HOST_DIR\" ]; then\n+    if [ -e \"${DOCKER_BUILD_CACHE_NEW_DIR}/index.json\" ]; then\n+      echo \"Removing the existing docker build cache in ${DOCKER_BUILD_CACHE_OLD_DIR}\"\n+      rm -rf \"${DOCKER_BUILD_CACHE_OLD_DIR}\"\n+      echo \"Moving the contents of ${DOCKER_BUILD_CACHE_NEW_DIR} to ${DOCKER_BUILD_CACHE_OLD_DIR}\"\n+      mv \"${DOCKER_BUILD_CACHE_NEW_DIR}\" \"${DOCKER_BUILD_CACHE_OLD_DIR}\"\n+    fi\n+    rm -rf \"${DOCKER_BUILD_CACHE_TEMPDIR}\"",
      "path": "ci/test/02_run_container.sh",
      "position": 38,
      "original_position": 38,
      "commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "original_commit_id": "4149b00ae5fdd54406163c7b6bed3219b9ecbfd4",
      "in_reply_to_id": 1893808813,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "If this is fine, you could just drop the line (and leave it to the host to clean up). If not, I am not sure how to fix it.",
      "created_at": "2024-12-20T11:11:19Z",
      "updated_at": "2024-12-20T11:11:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31545#discussion_r1893810274",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1893810274"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31545"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 63,
      "original_line": 63,
      "side": "RIGHT"
    }
  ]
}