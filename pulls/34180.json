{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34180",
    "id": 3136536474,
    "node_id": "PR_kwDOABII586687-a",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34180",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34180.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34180.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34180",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34180/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34180/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34180/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/4e6d216b931c6df9d3b100fa2e3c46e96d2ec027",
    "number": 34180,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "bench: add `SIGABRT` handler to show failed bench name",
    "user": {
      "login": "l0rinc",
      "id": 1841944,
      "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l0rinc",
      "html_url": "https://github.com/l0rinc",
      "followers_url": "https://api.github.com/users/l0rinc/followers",
      "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
      "organizations_url": "https://api.github.com/users/l0rinc/orgs",
      "repos_url": "https://api.github.com/users/l0rinc/repos",
      "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/l0rinc/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "### Problem\r\nWhen a benchmark triggers an assertion failure or abort deeper down the stack, the output provides no indication of which benchmark failed.\r\n\r\n### Reproducer\r\nTo reproduce, inject a failure outside the benchmarks:\r\n```patch\r\ndiff --git a/src/streams.h b/src/streams.h\r\n--- a/src/streams.h\t(revision aa2eebdb1e8182394d44fd9719e316ea52926cab)\r\n+++ b/src/streams.h\t(date 1767091264182)\r\n@@ -179,6 +179,7 @@\r\n\r\n     bool Rewind(std::optional<size_type> n = std::nullopt)\r\n     {\r\n+        Assert(false);\r\n         // Total rewind if no size is passed\r\n         if (!n) {\r\n             m_read_pos = 0;\r\n```\r\n\r\nand run with a filter matching multiple benchmarks:\r\n```bash\r\nrm -rfd build && cmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_BENCH=ON && cmake --build build -j$(nproc) && ./build/bin/bench_bitcoin -filter='DeserializeAndCheckBlockTest|DeserializeBlockTest|PrevectorDeserialize' -sanity-check\r\n```\r\n\r\nBefore - the outputs provide no indication which benchmark failed:\r\n```bash\r\nstreams.h:182 bool DataStream::Rewind(std::optional<size_type>): Assertion `false' failed.\r\nzsh: abort      ./build/bin/bench_bitcoin  -sanity-check\r\n```\r\n\r\n### Fix\r\nThis PR adds a `SIGABRT` signal handler that prints the currently running benchmark's name before re-raising the signal. The name only appears on failure, not before each benchmark starts, keeping normal output clean.\r\n\r\nAfter - the benchmark name is logged, and the signal re-raised:\r\n```bash\r\nstreams.h:182 bool DataStream::Rewind(std::optional<size_type>): Assertion `false' failed.\r\nBenchmark failed: DeserializeAndCheckBlockTest.\r\nzsh: abort      ./build/bin/bench_bitcoin  -sanity-check\r\n```\r\n\r\n### Considerations\r\nWorks in both debug and release builds since it doesn't rely on stack traces (which would require debug symbols).",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "created_at": "2025-12-30T11:11:51Z",
    "updated_at": "2025-12-30T21:59:15Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "c9c03ea2731773c36c6cc0fb1853399a38baa77e",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "l0rinc:l0rinc/bench-sigabort-handler",
      "ref": "l0rinc/bench-sigabort-handler",
      "sha": "4e6d216b931c6df9d3b100fa2e3c46e96d2ec027",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 674169038,
        "node_id": "R_kgDOKC8Azg",
        "name": "bitcoin",
        "full_name": "l0rinc/bitcoin",
        "owner": {
          "login": "l0rinc",
          "id": 1841944,
          "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/l0rinc",
          "html_url": "https://github.com/l0rinc",
          "followers_url": "https://api.github.com/users/l0rinc/followers",
          "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
          "organizations_url": "https://api.github.com/users/l0rinc/orgs",
          "repos_url": "https://api.github.com/users/l0rinc/repos",
          "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/l0rinc/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/l0rinc/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/l0rinc/bitcoin",
        "archive_url": "https://api.github.com/repos/l0rinc/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/l0rinc/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/l0rinc/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/l0rinc/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/l0rinc/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/l0rinc/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/l0rinc/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/l0rinc/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/l0rinc/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/l0rinc/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/l0rinc/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/l0rinc/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/l0rinc/bitcoin/events",
        "forks_url": "https://api.github.com/repos/l0rinc/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/l0rinc/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/l0rinc/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/l0rinc/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/l0rinc/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/l0rinc/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/l0rinc/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/l0rinc/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/l0rinc/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/l0rinc/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/l0rinc/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/l0rinc/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/l0rinc/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/l0rinc/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/l0rinc/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/l0rinc/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:l0rinc/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/l0rinc/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/l0rinc/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/l0rinc/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/l0rinc/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/l0rinc/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/l0rinc/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/l0rinc/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/l0rinc/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/l0rinc/bitcoin/hooks",
        "svn_url": "https://github.com/l0rinc/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 281004,
        "default_branch": "master",
        "open_issues_count": 26,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-12-30T20:34:25Z",
        "created_at": "2023-08-03T09:49:12Z",
        "updated_at": "2025-12-30T20:34:36Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "2bcb3f64648ad27d4df10013b5bf0441124f1372",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38690,
        "stargazers_count": 87454,
        "watchers_count": 87454,
        "size": 301053,
        "default_branch": "master",
        "open_issues_count": 743,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-12-29T15:16:47Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-12-30T20:59:55Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34180"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 18,
    "deletions": 0,
    "changed_files": 1,
    "commits": 1,
    "review_comments": 0,
    "comments": 4
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRlNmQyMTZiOTMxYzZkZjlkM2IxMDBmYTJlM2M0NmU5NmQyZWMwMjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4e6d216b931c6df9d3b100fa2e3c46e96d2ec027",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4e6d216b931c6df9d3b100fa2e3c46e96d2ec027",
      "tree": {
        "sha": "da8e985b1008c5e1bd35b88109171162b753ad27",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/da8e985b1008c5e1bd35b88109171162b753ad27"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree da8e985b1008c5e1bd35b88109171162b753ad27\nparent 2bcb3f64648ad27d4df10013b5bf0441124f1372\nauthor Lőrinc <pap.lorinc@gmail.com> 1767091830 +0100\ncommitter Lőrinc <pap.lorinc@gmail.com> 1767091901 +0100\n\nbench: add signal handler for SIGABRT to improve error reporting\n\nWhen a benchmark triggers an assertion failure or abort deeper down the stack, the output provides no indication of which benchmark failed.\n\nTo reproduce, inject a failure outside the benchmarks:\n```patch\ndiff --git a/src/streams.h b/src/streams.h\n--- a/src/streams.h\t(revision aa2eebdb1e8182394d44fd9719e316ea52926cab)\n+++ b/src/streams.h\t(date 1767091264182)\n@@ -179,6 +179,7 @@\n\n     bool Rewind(std::optional<size_type> n = std::nullopt)\n     {\n+        Assert(false);\n         // Total rewind if no size is passed\n         if (!n) {\n             m_read_pos = 0;\n```\n\nand run with a filter matching multiple benchmarks:\n```\nrm -rfd build && cmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_BENCH=ON && cmake --build build -j$(nproc) && ./build/bin/bench_bitcoin -filter='DeserializeAndCheckBlockTest|DeserializeBlockTest|PrevectorDeserialize' -sanity-check\n```\n\nBefore - the outputs provide no indication which benchmark failed:\n```\nstreams.h:182 bool DataStream::Rewind(std::optional<size_type>): Assertion `false' failed.\nzsh: abort      ./build/bin/bench_bitcoin  -sanity-check\n```\n\nThis PR adds a `SIGABRT` signal handler that prints the currently running benchmark's name before re-raising the signal.\nThe name only appears on failure, not before each benchmark starts, keeping normal output clean.\n\nAfter - the benchmark name is logged, and the signal re-raised:\n```\nstreams.h:182 bool DataStream::Rewind(std::optional<size_type>): Assertion `false' failed.\nBenchmark failed: DeserializeAndCheckBlockTest.\nzsh: abort      ./build/bin/bench_bitcoin  -sanity-check\n```\n\nWorks in both debug and release builds since it doesn't rely on stack traces (which would require debug symbols).\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqXy8dDLWkKQdUrTAZp//D/pHenYFAmlTrr0ACgkQZp//D/pH\nenYRmQ//TA8veIfaIl2rmfp6NwBiPrlC2YEs0VYxcUiMjVvaU99McLZ3RPFOGvbU\niYwRgxZcUC/ml2XaI5VG18HnATfIBn9FCQKgJz3dWSWZnGIWi/pEZVHfxtlIWcIT\ncISs0bEXATbfJ3NDTxe6T+T2zxQz3Y3jHxFp00bSQIOq991SFmAA/LUfDTQSPfdo\nF/0Aw5SZR2EI9jJcmYlnITCMRCdgTYYWsKudTYy3qHzUBk6vSNdiCtmW/LcmQihX\nJfCApfB+P+ffeWwskckfnZptFvwrxqXjcjZjzjVarhKWYO9dOo6BEsBTTvPwV803\nWxN/Jro6z/zaKHz6vldydG6tqnzeInqUPVMRvoYobYPTVA7Cy76iHyC1PNeXGY92\neZHOr23wjN+kXKbTkVBD78q8Q740H5GAh8MFsyaLTAw3/lpa0C4VyNiZ5cQPa+ci\nLUnST7t03xHagrxNCAEz3QY7bNo6PCvJM4wthWoh5JLz3cWkdEY1U/yLSiKaBQca\nCOv1Zc4QoND81WGhRaWxBcJAHyX3sVHgySSLIg8yXO/1MT/46sQeSCRfnd3Y9Rex\neKByJ4jyeQUgnoMt2yR447OHh4CR9/5ZLEWKaNAHyKkSHBo2mKbyTozlKb8sYR29\nHSIGJbKlu/peDnp8I1A4pZiVTByR6pygL86vMJLe//KCxyA4lxM=\n=A1Rz\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2bcb3f64648ad27d4df10013b5bf0441124f1372",
          "sha": "2bcb3f64648ad27d4df10013b5bf0441124f1372",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2bcb3f64648ad27d4df10013b5bf0441124f1372"
        }
      ],
      "message": "bench: add signal handler for SIGABRT to improve error reporting\n\nWhen a benchmark triggers an assertion failure or abort deeper down the stack, the output provides no indication of which benchmark failed.\n\nTo reproduce, inject a failure outside the benchmarks:\n```patch\ndiff --git a/src/streams.h b/src/streams.h\n--- a/src/streams.h\t(revision aa2eebdb1e8182394d44fd9719e316ea52926cab)\n+++ b/src/streams.h\t(date 1767091264182)\n@@ -179,6 +179,7 @@\n\n     bool Rewind(std::optional<size_type> n = std::nullopt)\n     {\n+        Assert(false);\n         // Total rewind if no size is passed\n         if (!n) {\n             m_read_pos = 0;\n```\n\nand run with a filter matching multiple benchmarks:\n```\nrm -rfd build && cmake -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_BENCH=ON && cmake --build build -j$(nproc) && ./build/bin/bench_bitcoin -filter='DeserializeAndCheckBlockTest|DeserializeBlockTest|PrevectorDeserialize' -sanity-check\n```\n\nBefore - the outputs provide no indication which benchmark failed:\n```\nstreams.h:182 bool DataStream::Rewind(std::optional<size_type>): Assertion `false' failed.\nzsh: abort      ./build/bin/bench_bitcoin  -sanity-check\n```\n\nThis PR adds a `SIGABRT` signal handler that prints the currently running benchmark's name before re-raising the signal.\nThe name only appears on failure, not before each benchmark starts, keeping normal output clean.\n\nAfter - the benchmark name is logged, and the signal re-raised:\n```\nstreams.h:182 bool DataStream::Rewind(std::optional<size_type>): Assertion `false' failed.\nBenchmark failed: DeserializeAndCheckBlockTest.\nzsh: abort      ./build/bin/bench_bitcoin  -sanity-check\n```\n\nWorks in both debug and release builds since it doesn't rely on stack traces (which would require debug symbols).",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-12-30T10:51:41Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-12-30T10:50:30Z"
      },
      "sha": "4e6d216b931c6df9d3b100fa2e3c46e96d2ec027"
    },
    {
      "event": "labeled",
      "id": 21792049364,
      "node_id": "LE_lADOABII587gs1vvzwAAAAUS6EjU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21792049364",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-30T11:11:54Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "commented",
      "id": 3699041644,
      "node_id": "IC_kwDOABII587ceuVs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3699041644",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-30T11:11:58Z",
      "updated_at": "2025-12-30T11:12:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34180.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34180#issuecomment-3699041644",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34180"
    },
    {
      "event": "commented",
      "id": 3699131060,
      "node_id": "IC_kwDOABII587cfEK0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3699131060",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-30T11:56:45Z",
      "updated_at": "2025-12-30T11:56:45Z",
      "author_association": "MEMBER",
      "body": "> This PR adds a `SIGABRT` signal handler that prints the currently running benchmark's name before re-raising the signal. The name only appears on failure, not before each benchmark starts, keeping normal output clean.\r\n\r\nNot sure. This seems to go in the wrong direction. Ideally, each benchmark is run individually and then the test framework just responds with the name of the failing test. This is possible via https://github.com/bitcoin/bitcoin/pull/33142. I don't care if that is written in python of cmake script, but I think we should just pick one solution instead of keeping to write verbose  workarounds that aren't really needed.\r\n\r\n\r\n\r\n> Before - the outputs provide no indication which benchmark failed:\r\n\r\nThis is common in all other  executables that are built? Seems odd to try to fix this in the source code one-by-one. I think the normal way to approach this is to just use a debugger, such as `gdb`, or even just `valgrind --tool=none`, or link a sanitizer, etc. I don't think there is a need to come up with a hand-rolled way for this?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34180#issuecomment-3699131060",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34180"
    },
    {
      "event": "commented",
      "id": 3700601059,
      "node_id": "IC_kwDOABII587ckrDj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3700601059",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-30T21:27:08Z",
      "updated_at": "2025-12-30T21:27:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "The use cases differ: #33142 runs `-sanity-check` to catch crashes, typically in `Debug` or sanitizer builds where debugging tools are available, running every single benchmark:\r\n```\r\n...\r\ntool_bench_sanity_check.py --bench=WalletLoadingDescriptors                      | ✓ Passed  | 1 s                                                                                               \r\ntool_bench_sanity_check.py --bench=WalletMigration                               | ✓ Passed  | 2 s                                                                                               \r\ntool_bench_sanity_check.py --bench=WriteBlockBench                               | ✓ Passed  | 0 s                                                                                               \r\ntool_bench_sanity_check.py --bench=DeserializeAndCheckBlockTest                  | ✖ Failed  | 0 s                                                                                               \r\ntool_bench_sanity_check.py --bench=DeserializeBlockTest                          | ✖ Failed  | 0 s                                                                                               \r\ntool_bench_sanity_check.py --bench=PrevectorDeserializeNontrivial                | ✖ Failed  | 0 s                                                                                               \r\ntool_bench_sanity_check.py --bench=PrevectorDeserializeTrivial                   | ✖ Failed  | 0 s                                                                                               \r\n```\r\n\r\nBut actual benchmarking requires `Release` build for meaningful results, and that's where a crash becomes harder to diagnose - no debug symbols, aggressive inlining obscures stack traces, and re-running with sanitizers changes timing characteristics enough that some bugs may not reproduce.\r\n\r\nWhen `bench_bitcoin -filter='Foo|Bar|Baz'` crashes in `Release`, the signal handler gives you immediate triage: \"it was `Bar`\" - so you know which benchmark to isolate and re-run in `Debug`.\r\n\r\nWe can make it work without this change as well, I just bumped into this a few times, though I'll fix it ...\r\n\r\n",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34180#issuecomment-3700601059",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34180"
    },
    {
      "event": "commented",
      "id": 3700645559,
      "node_id": "IC_kwDOABII587ck163",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3700645559",
      "actor": {
        "login": "bensig",
        "id": 1872138,
        "node_id": "MDQ6VXNlcjE4NzIxMzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1872138?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bensig",
        "html_url": "https://github.com/bensig",
        "followers_url": "https://api.github.com/users/bensig/followers",
        "following_url": "https://api.github.com/users/bensig/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bensig/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bensig/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bensig/subscriptions",
        "organizations_url": "https://api.github.com/users/bensig/orgs",
        "repos_url": "https://api.github.com/users/bensig/repos",
        "events_url": "https://api.github.com/users/bensig/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bensig/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-30T21:59:15Z",
      "updated_at": "2025-12-30T21:59:15Z",
      "author_association": "NONE",
      "body": "Tested on macOS - builds and works as described. Sent SIGABRT during a running benchmark and it correctly printed \"Benchmark failed: AddrManAdd.\"\r\n\r\nI'll leave the concept discussion to more experienced reviewers.",
      "user": {
        "login": "bensig",
        "id": 1872138,
        "node_id": "MDQ6VXNlcjE4NzIxMzg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1872138?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bensig",
        "html_url": "https://github.com/bensig",
        "followers_url": "https://api.github.com/users/bensig/followers",
        "following_url": "https://api.github.com/users/bensig/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bensig/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bensig/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bensig/subscriptions",
        "organizations_url": "https://api.github.com/users/bensig/orgs",
        "repos_url": "https://api.github.com/users/bensig/repos",
        "events_url": "https://api.github.com/users/bensig/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bensig/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34180#issuecomment-3700645559",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34180"
    }
  ],
  "comments": []
}