{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852",
    "id": 358849849,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MzU4ODQ5ODQ5",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17852",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/17852.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/17852.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17852",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17852/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/ed9180fc288e1785aee9aabf18d83b0ce8f15590",
    "number": 17852,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "util: Close txindex LDB before exiting bitcoind",
    "user": {
      "login": "paulyc",
      "id": 107466,
      "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulyc",
      "html_url": "https://github.com/paulyc",
      "followers_url": "https://api.github.com/users/paulyc/followers",
      "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
      "organizations_url": "https://api.github.com/users/paulyc/orgs",
      "repos_url": "https://api.github.com/users/paulyc/repos",
      "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/paulyc/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fix a very longstanding bug wherein the txindex LevelDB was not being closed properly when stopping bitcoind,\r\nwhich is done by leveldb::DB::~DB(), ie., you need to call delete once for every DB* you create.\r\nThis was causing the txindexing progress to have fallen behind to its last random checkpoint the next time\r\nbitcoind was started.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
    "labels": [
      {
        "id": 97470796,
        "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
        "name": "UTXO Db and Indexes",
        "color": "fbca04",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2020-01-03T01:52:31Z",
    "updated_at": "2022-02-15T10:25:32Z",
    "closed_at": "2020-01-03T14:35:00Z",
    "mergeable_state": "unknown",
    "merge_commit_sha": "11317a155497d1e988ebcd51da31bd04c83bfaf3",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "paulyc:util_close_txindex_leveldb",
      "ref": "util_close_txindex_leveldb",
      "sha": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "user": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 114972109,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTQ5NzIxMDk=",
        "name": "bitcoin",
        "full_name": "paulyc/bitcoin",
        "owner": {
          "login": "paulyc",
          "id": 107466,
          "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
          "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/paulyc",
          "html_url": "https://github.com/paulyc",
          "followers_url": "https://api.github.com/users/paulyc/followers",
          "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
          "organizations_url": "https://api.github.com/users/paulyc/orgs",
          "repos_url": "https://api.github.com/users/paulyc/repos",
          "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/paulyc/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/paulyc/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/paulyc/bitcoin",
        "archive_url": "https://api.github.com/repos/paulyc/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/paulyc/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/paulyc/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/paulyc/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/paulyc/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/paulyc/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/paulyc/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/paulyc/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/paulyc/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/paulyc/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/paulyc/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/paulyc/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/paulyc/bitcoin/events",
        "forks_url": "https://api.github.com/repos/paulyc/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/paulyc/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/paulyc/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/paulyc/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/paulyc/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/paulyc/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/paulyc/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/paulyc/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/paulyc/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/paulyc/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/paulyc/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/paulyc/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/paulyc/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/paulyc/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/paulyc/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/paulyc/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:paulyc/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/paulyc/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/paulyc/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/paulyc/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/paulyc/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/paulyc/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/paulyc/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/paulyc/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/paulyc/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/paulyc/bitcoin/hooks",
        "svn_url": "https://github.com/paulyc/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 153070,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2020-01-03T01:52:09Z",
        "created_at": "2017-12-21T06:41:52Z",
        "updated_at": "2019-12-13T02:36:02Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "17e14ac92fced92457945859463eda5d435bdd49",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35476,
        "stargazers_count": 70608,
        "watchers_count": 70608,
        "size": 236222,
        "default_branch": "master",
        "open_issues_count": 672,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-02T19:06:37Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-08-02T18:21:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
      }
    },
    "author_association": "NONE",
    "draft": false,
    "additions": 5,
    "deletions": 2,
    "changed_files": 2,
    "commits": 1,
    "review_comments": 7,
    "comments": 4
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZDkxODBmYzI4OGUxNzg1YWVlOWFhYmYxOGQ4M2IwY2U4ZjE1NTkw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "tree": {
        "sha": "6747989bed057fa80e9b6ad582a7971430cd449c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6747989bed057fa80e9b6ad582a7971430cd449c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/190a4051fde736faf99681d107f0b38dd385e90c",
          "sha": "190a4051fde736faf99681d107f0b38dd385e90c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/190a4051fde736faf99681d107f0b38dd385e90c"
        }
      ],
      "message": "util: Close txindex LDB before exiting bitcoind\n\nFix a very longstanding bug wherein the txindex LevelDB was not being closed properly when stopping bitcoind,\nwhich is done by leveldb::DB::~DB(), ie., you need to call delete once for every DB* you create.\nThis was causing the txindexing progress to have fallen behind to its last random checkpoint the next time\nbitcoind was started.",
      "committer": {
        "name": "Paul Ciarlo",
        "email": "paul.ciarlo@gmail.com",
        "date": "2020-01-03T01:51:36Z"
      },
      "author": {
        "name": "Paul Ciarlo",
        "email": "paul.ciarlo@gmail.com",
        "date": "2020-01-03T01:51:36Z"
      },
      "sha": "ed9180fc288e1785aee9aabf18d83b0ce8f15590"
    },
    {
      "event": "labeled",
      "id": 2919277984,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDI5MTkyNzc5ODQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2919277984",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-03T02:28:07Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "review_requested",
      "id": 2919279069,
      "node_id": "MDIwOlJldmlld1JlcXVlc3RlZEV2ZW50MjkxOTI3OTA2OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2919279069",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-03T02:29:23Z",
      "requested_reviewer": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 338038589,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MDM4NTg5",
      "url": null,
      "actor": null,
      "commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#pullrequestreview-338038589",
      "submitted_at": "2020-01-03T11:18:03Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
    },
    {
      "event": "closed",
      "id": 2920345188,
      "node_id": "MDExOkNsb3NlZEV2ZW50MjkyMDM0NTE4OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2920345188",
      "actor": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-03T14:35:00Z"
    },
    {
      "event": "commented",
      "id": 570790339,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDc5MDMzOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570790339",
      "actor": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-04T14:35:28Z",
      "updated_at": "2020-01-04T14:35:28Z",
      "author_association": "NONE",
      "body": "Whoa i dunno what just happened. Was just adding a comment but i inadvertently hit \"close conversation\" not as if i know what that button does but everything disappeared. Good thing i always write everything in a text editor because I'm so used to Android killing my apps and taking my drafts with them i dont like any ux that just deletes what you were working on because you hit one button. People accidentally hit buttons all the time. Anyway back on subject:\r\n\r\nAh yes, was just able to verify that this patch does not in fact mysteriously fix the issue, so it remains mysterious at the moment.\r\n\r\nWhat happens is, if you interrupt bitcoind in the middle of a sync with txindex on, the next time you run it, the txindexer has suddenly seemed to have fallen many blocks behind where it was when you interrupted the first process, for whatever reason that is yet to be determined, but the chainstate is always properly synced and closed so there must be a hint in comparing how the two are used differently.\r\n\r\n So, when the txindex thread restarts it wastes a bunch of time indexing blocks it has already indexed, which you can tell because no new data is written to the leveldb until it catches back up since the keys and values in the txindex don't change. Will file a bug report if i can't find an existing one. \r\n \r\nI haven't seen any crashes or anything worse than wasting some time and disk i/o, so it's not a real big deal in the grand scheme of the txindexer's overall time, just slows down syncing when you do restart it until the indexer catches back up, so if you're frequently stopping and starting the sync like because you have a magnetic spinning disk and it's your only disk, it can get a little irritating. But then that's always irritating ðŸ˜‚ thanks for the info\r\n\r\n",
      "user": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#issuecomment-570790339",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17852"
    },
    {
      "event": "commented",
      "id": 571323207,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTMyMzIwNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571323207",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-06T21:30:54Z",
      "updated_at": "2020-01-06T21:30:54Z",
      "author_association": "MEMBER",
      "body": "> What happens is, if you interrupt bitcoind in the middle of a sync with txindex on, the next time you run it, the txindexer has suddenly seemed to have fallen many blocks behind where it was when you interrupted the first process\r\n\r\nTxindex is a background thread, so it might fall back arbitrarily. Though it shouldn't lose progress from where it was in normal operation.",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#issuecomment-571323207",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17852"
    },
    {
      "event": "commented",
      "id": 571411047,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTQxMTA0Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571411047",
      "actor": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-07T02:57:17Z",
      "updated_at": "2020-01-07T02:57:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "@paulyc Oh, thank you, very nice catch. This is happening because the txindex (and the other indices) are stopped in `Shutdown` (init.cpp) before `ForceFlushStateToDisk` is called. `ForceFlushStateToDisk` triggers the `ChainStateFlushed` callback on the indices which commits the indexed state to disk. So probably the best solution is to move the index stops after that. Alternately, `BaseIndex::Stop` can just call `Commit` directly. Or do both, because I don't see a downside to either approach.",
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#issuecomment-571411047",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17852"
    },
    {
      "event": "mentioned",
      "id": 2926251130,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MjkyNjI1MTEzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2926251130",
      "actor": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-07T02:57:18Z"
    },
    {
      "event": "subscribed",
      "id": 2926251133,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDI5MjYyNTExMzM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2926251133",
      "actor": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-07T02:57:19Z"
    },
    {
      "event": "commented",
      "id": 571607022,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTYwNzAyMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571607022",
      "actor": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-07T14:23:13Z",
      "updated_at": "2020-01-07T14:23:52Z",
      "author_association": "NONE",
      "body": "Ah, @jimpo thanks for tracking that down as well. Must not have had enough coffee or something when I submitted this, but glad it helped find the issue, which clearly had to be a little more complex. ;) In the immortal words of Samwise Gamgee all's well as ends well, or at least it will be when a working PR is merged. Not sure if I'll have time to do it soon, but it's been there long enough, it can wait a little longer and I can test it properly, (why they do the tests...), unless someone else has time to fit it in somewhere but I wouldn't know",
      "user": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#issuecomment-571607022",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17852"
    },
    {
      "event": "mentioned",
      "id": 2927794726,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MjkyNzc5NDcyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2927794726",
      "actor": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-07T14:23:14Z"
    },
    {
      "event": "subscribed",
      "id": 2927794732,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDI5Mjc3OTQ3MzI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2927794732",
      "actor": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-07T14:23:14Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-01-08T20:12:39Z",
      "updated_at": "2020-01-08T20:12:39Z",
      "source": {
        "issue": {
          "id": 547077914,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MzYwNjM0NDgx",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17897",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17897/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17897/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17897/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/17897",
          "number": 17897,
          "state": "closed",
          "state_reason": null,
          "title": "init: Stop indexes on shutdown after ChainStateFlushed callback.",
          "body": "Replaces https://github.com/bitcoin/bitcoin/pull/17852.\r\n\r\nCurrently, the latest index state may not be committed to disk on shutdown. The state is committed on `ChainStateFlushed` callbacks and the current init order unregisters the indexes as validation interfaces before the final `ChainStateFlushed` callback is called on them.\r\n\r\nIssue identified by paulyc.\r\n\r\nFor review: an alternative or supplemental solution would be to call `Commit` at the end of `BaseIndex::Stop`. I don't see any harm in doing so and it makes the less prone to user error. However, the destructor would have to be modified to not call `Stop` because `Commit` calls a virtual method, so I figured it wasn't worth it. But I'm curious how others feel.",
          "user": {
            "login": "jimpo",
            "id": 881253,
            "node_id": "MDQ6VXNlcjg4MTI1Mw==",
            "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jimpo",
            "html_url": "https://github.com/jimpo",
            "followers_url": "https://api.github.com/users/jimpo/followers",
            "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
            "organizations_url": "https://api.github.com/users/jimpo/orgs",
            "repos_url": "https://api.github.com/users/jimpo/repos",
            "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jimpo/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 11,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17897",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/17897",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/17897.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/17897.patch"
          },
          "closed_at": "2020-01-22T09:43:06Z",
          "created_at": "2020-01-08T20:12:39Z",
          "updated_at": "2022-02-15T10:26:00Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 2969337687,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI5NjkzMzc2ODc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2969337687",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a51aa2880d123fc0bcbc0ccd930dbf98e4d29863",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a51aa2880d123fc0bcbc0ccd930dbf98e4d29863",
      "created_at": "2020-01-22T09:42:54Z"
    },
    {
      "event": "referenced",
      "id": 2976425543,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI5NzY0MjU1NDM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2976425543",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8c909d56ea6969164709350b3537bd91ab4ee95e",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/8c909d56ea6969164709350b3537bd91ab4ee95e",
      "created_at": "2020-01-24T08:25:50Z"
    },
    {
      "event": "referenced",
      "id": 3980858480,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM5ODA4NTg0ODA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3980858480",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6271403c3d0d6543959f6483a595577ef31963f1",
      "commit_url": "https://api.github.com/repos/syscoin-core/syscoin/commits/6271403c3d0d6543959f6483a595577ef31963f1",
      "created_at": "2020-11-10T20:39:46Z"
    },
    {
      "event": "locked",
      "id": 6073749937,
      "node_id": "LOE_lADOABII584geU16zwAAAAFqBhGx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6073749937",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T10:25:32Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362776455",
      "pull_request_review_id": 338038589,
      "id": 362776455,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjc3NjQ1NQ==",
      "diff_hunk": "@@ -228,7 +228,10 @@ TxIndex::TxIndex(size_t n_cache_size, bool f_memory, bool f_wipe)\n     : m_db(MakeUnique<TxIndex::DB>(n_cache_size, f_memory, f_wipe))\n {}\n \n-TxIndex::~TxIndex() {}\n+TxIndex::~TxIndex()\n+{\n+    m_db.reset();",
      "path": "src/index/txindex.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "original_commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why is this needed? The pointer should be reset when the TxIndex is destructed",
      "created_at": "2020-01-03T11:18:02Z",
      "updated_at": "2020-01-03T11:18:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#discussion_r362776455",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362776455"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 233,
      "original_line": 233,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362829332",
      "pull_request_review_id": 338106349,
      "id": 362829332,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjgyOTMzMg==",
      "diff_hunk": "@@ -228,7 +228,10 @@ TxIndex::TxIndex(size_t n_cache_size, bool f_memory, bool f_wipe)\n     : m_db(MakeUnique<TxIndex::DB>(n_cache_size, f_memory, f_wipe))\n {}\n \n-TxIndex::~TxIndex() {}\n+TxIndex::~TxIndex()\n+{\n+    m_db.reset();",
      "path": "src/index/txindex.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "original_commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "in_reply_to_id": 362776455,
      "user": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point, it should, (shouldn't it???) (clearly both C++ and myself are too old for me to be writing it), so it would seem that, at least in some corner case, ~TxIndex isn't getting called at all. So I will close this for now and reopen it if I figure out what's going on further investigation. Thanks",
      "created_at": "2020-01-03T14:34:54Z",
      "updated_at": "2020-01-03T14:34:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#discussion_r362829332",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362829332"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 233,
      "original_line": 233,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362846350",
      "pull_request_review_id": 338127836,
      "id": 362846350,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg0NjM1MA==",
      "diff_hunk": "@@ -228,7 +228,10 @@ TxIndex::TxIndex(size_t n_cache_size, bool f_memory, bool f_wipe)\n     : m_db(MakeUnique<TxIndex::DB>(n_cache_size, f_memory, f_wipe))\n {}\n \n-TxIndex::~TxIndex() {}\n+TxIndex::~TxIndex()\n+{\n+    m_db.reset();",
      "path": "src/index/txindex.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "original_commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "in_reply_to_id": 362776455,
      "user": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I wonder, but wouldn't really know, if the default destructor call isn't somehow ordered, or being reordered, such that it doesn't finish before the process exits, and the explicit call here maybe allows it to finish, but I'd still have to test it more and maybe figure out a way to write an integration test that verifies all the leveldbs are properly closed (or not). Will investigate further",
      "created_at": "2020-01-03T15:20:31Z",
      "updated_at": "2020-01-03T15:47:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#discussion_r362846350",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362846350"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 233,
      "original_line": 233,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362847203",
      "pull_request_review_id": 338128927,
      "id": 362847203,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg0NzIwMw==",
      "diff_hunk": "@@ -228,7 +228,10 @@ TxIndex::TxIndex(size_t n_cache_size, bool f_memory, bool f_wipe)\n     : m_db(MakeUnique<TxIndex::DB>(n_cache_size, f_memory, f_wipe))\n {}\n \n-TxIndex::~TxIndex() {}\n+TxIndex::~TxIndex()\n+{\n+    m_db.reset();",
      "path": "src/index/txindex.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "original_commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "in_reply_to_id": 362776455,
      "user": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Particularly since leveldb is rather poorly designed imo to put some very important closing the database code in the destructor, since, after all, the compiler (and programmer, and OS), don't necessarily know or care that any of those objects still in memory that are about to be wiped out by the OS when the process exits, actually do important things that need to happen before the process does exit! And thus, quite often, do not bother actually destructing any of those objects, since nobody cares, (but this is exactly why they should care), about memory that leaks when the process is about to exit.",
      "created_at": "2020-01-03T15:22:52Z",
      "updated_at": "2020-01-03T15:25:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#discussion_r362847203",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362847203"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 233,
      "original_line": 233,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362853352",
      "pull_request_review_id": 338136670,
      "id": 362853352,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg1MzM1Mg==",
      "diff_hunk": "@@ -228,7 +228,10 @@ TxIndex::TxIndex(size_t n_cache_size, bool f_memory, bool f_wipe)\n     : m_db(MakeUnique<TxIndex::DB>(n_cache_size, f_memory, f_wipe))\n {}\n \n-TxIndex::~TxIndex() {}\n+TxIndex::~TxIndex()\n+{\n+    m_db.reset();",
      "path": "src/index/txindex.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "original_commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "in_reply_to_id": 362776455,
      "user": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It certainly seems like the patch works, but, I can neither explain why nor prove that it does definitively, so, not sure if that quite reaches the merge bar, in light of it being such a minor change to such a minor subsystem that isn't functionally broken, rather just a little bit inconvenient having to wait a while, while it reindexes the same blocks ;) but it's been bugging me (no pun intended) for years..",
      "created_at": "2020-01-03T15:37:51Z",
      "updated_at": "2020-01-03T15:37:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#discussion_r362853352",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362853352"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 233,
      "original_line": 233,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362868171",
      "pull_request_review_id": 338155951,
      "id": 362868171,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg2ODE3MQ==",
      "diff_hunk": "@@ -228,7 +228,10 @@ TxIndex::TxIndex(size_t n_cache_size, bool f_memory, bool f_wipe)\n     : m_db(MakeUnique<TxIndex::DB>(n_cache_size, f_memory, f_wipe))\n {}\n \n-TxIndex::~TxIndex() {}\n+TxIndex::~TxIndex()\n+{\n+    m_db.reset();",
      "path": "src/index/txindex.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "original_commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "in_reply_to_id": 362776455,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What is the issue you are seeing? Any stacktraces or anything?\r\n\r\nReminds me of #13894, #14071, #15410 ",
      "created_at": "2020-01-03T16:18:15Z",
      "updated_at": "2020-01-03T16:18:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#discussion_r362868171",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/362868171"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 233,
      "original_line": 233,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/363038234",
      "pull_request_review_id": 338355830,
      "id": 363038234,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAzODIzNA==",
      "diff_hunk": "@@ -228,7 +228,10 @@ TxIndex::TxIndex(size_t n_cache_size, bool f_memory, bool f_wipe)\n     : m_db(MakeUnique<TxIndex::DB>(n_cache_size, f_memory, f_wipe))\n {}\n \n-TxIndex::~TxIndex() {}\n+TxIndex::~TxIndex()\n+{\n+    m_db.reset();",
      "path": "src/index/txindex.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "original_commit_id": "ed9180fc288e1785aee9aabf18d83b0ce8f15590",
      "in_reply_to_id": 362776455,
      "user": {
        "login": "paulyc",
        "id": 107466,
        "node_id": "MDQ6VXNlcjEwNzQ2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/107466?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paulyc",
        "html_url": "https://github.com/paulyc",
        "followers_url": "https://api.github.com/users/paulyc/followers",
        "following_url": "https://api.github.com/users/paulyc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paulyc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paulyc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paulyc/subscriptions",
        "organizations_url": "https://api.github.com/users/paulyc/orgs",
        "repos_url": "https://api.github.com/users/paulyc/repos",
        "events_url": "https://api.github.com/users/paulyc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paulyc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah yes, was just able to verify that this patch does not in fact mysteriously fix the issue, so it remains mysterious at the moment.\r\n\r\nWhat happens is, if you interrupt bitcoind in the middle of a sync with txindex on, the next time you run it, the txindexer has suddenly seemed to have fallen many blocks behind where it was when you interrupted the first process, for whatever reason that is yet to be determined, but the chainstate is always properly synced and closed so there must be a hint in comparing how the two are used differently.\r\n\r\n So, when the txindex thread restarts it wastes a bunch of time indexing blocks it has already indexed, which you can tell because no new data is written to the leveldb until it catches back up since the keys and values in the txindex don't change. Will file a bug report if i can't find an existing one. \r\n \r\nI haven't seen any crashes or anything worse than wasting some time and disk i/o, so it's not a real big deal in the grand scheme of the txindexer's overall time, just slows down syncing when you do restart it until the indexer catches back up, so if you're frequently stopping and starting the sync like because you have a magnetic spinning disk and it's your only disk, it can get a little irritating. But then that's always irritating ðŸ˜‚ thanks for the info",
      "created_at": "2020-01-04T14:31:45Z",
      "updated_at": "2020-01-04T14:31:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/17852#discussion_r363038234",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/363038234"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17852"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 233,
      "original_line": 233,
      "side": "RIGHT"
    }
  ]
}