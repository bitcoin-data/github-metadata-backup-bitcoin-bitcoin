{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968",
    "id": 2091389962,
    "node_id": "PR_kwDOABII5858qBQK",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/30968",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/30968.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/30968.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/e9d60af9889c12b4d427adefa53fd234e417f8f6",
    "number": 30968,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "init: Remove retry for loop",
    "user": {
      "login": "TheCharlatan",
      "id": 8421793,
      "node_id": "MDQ6VXNlcjg0MjE3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheCharlatan",
      "html_url": "https://github.com/TheCharlatan",
      "followers_url": "https://api.github.com/users/TheCharlatan/followers",
      "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
      "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
      "repos_url": "https://api.github.com/users/TheCharlatan/repos",
      "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The for loop around the chain loading logic in `init.cpp` allows users of the GUI to retry once on failure with reindexing without having to manually set the reindex flag on startup. However this current mechanism has problems:\r\n\r\n* It is badly documented and has led to confusion among developers and bugs making it into master. Examples:\r\n    * https://github.com/bitcoin/bitcoin/pull/28830/files#r1598392660\r\n    * https://github.com/bitcoin/bitcoin/pull/30132#issuecomment-2120741121\r\n* It can only ever iterate once, making the choice of a for loop questionable.\r\n* With its large scope it is easy for re-entry bugs to sneak in. Example:\r\n    * https://github.com/bitcoin/bitcoin/pull/28830#discussion_r1601589963\r\n\r\nAttempt to fix this by moving the bulk of the logic into a separate function and replacing the for loop with a simpler `if` statement.\r\n\r\nThe diff's in this pull request are best reviewed with `--color-moved-ws=ignore-all-space --color-moved=dimmed-zebra`. The error behaviour can be tested by either manually making `LoadChainstate` return a failure, or deleting some of the block index database files.",
    "labels": [],
    "created_at": "2024-09-25T13:16:19Z",
    "updated_at": "2024-09-30T20:50:35Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "1d512d2ba9f99297e3a1001b0f3cf251ed6622a9",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false
      },
      {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "TheCharlatan:removeInitForLoop",
      "ref": "removeInitForLoop",
      "sha": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 94456368,
        "node_id": "MDEwOlJlcG9zaXRvcnk5NDQ1NjM2OA==",
        "name": "bitcoin",
        "full_name": "TheCharlatan/bitcoin",
        "owner": {
          "login": "TheCharlatan",
          "id": 8421793,
          "node_id": "MDQ6VXNlcjg0MjE3OTM=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/TheCharlatan",
          "html_url": "https://github.com/TheCharlatan",
          "followers_url": "https://api.github.com/users/TheCharlatan/followers",
          "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
          "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
          "repos_url": "https://api.github.com/users/TheCharlatan/repos",
          "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/TheCharlatan/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/TheCharlatan/bitcoin",
        "archive_url": "https://api.github.com/repos/TheCharlatan/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/TheCharlatan/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/TheCharlatan/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/TheCharlatan/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/TheCharlatan/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/TheCharlatan/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/TheCharlatan/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/TheCharlatan/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/TheCharlatan/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/TheCharlatan/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/TheCharlatan/bitcoin/events",
        "forks_url": "https://api.github.com/repos/TheCharlatan/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/TheCharlatan/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/TheCharlatan/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/TheCharlatan/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/TheCharlatan/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/TheCharlatan/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/TheCharlatan/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/TheCharlatan/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/TheCharlatan/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/TheCharlatan/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:TheCharlatan/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/TheCharlatan/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/TheCharlatan/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/TheCharlatan/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/TheCharlatan/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/TheCharlatan/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/TheCharlatan/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/TheCharlatan/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/TheCharlatan/bitcoin/hooks",
        "svn_url": "https://github.com/TheCharlatan/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 247681,
        "default_branch": "master",
        "open_issues_count": 3,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-09-25T17:43:15Z",
        "created_at": "2017-06-15T16:03:35Z",
        "updated_at": "2024-09-23T18:20:39Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "39219fe145e5e6e6f079b591e3f4b5fea8e71804",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36221,
        "stargazers_count": 78652,
        "watchers_count": 78652,
        "size": 269209,
        "default_branch": "master",
        "open_issues_count": 668,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-09-30T20:28:06Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-09-30T20:28:30Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 137,
    "deletions": 124,
    "changed_files": 1,
    "commits": 3,
    "review_comments": 7,
    "comments": 9
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc4MWMwMWY1ODA2NmQzNzVjMTRiMWE3MTcxNjBmNTFjMmYyZWJlMjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/781c01f58066d375c14b1a717160f51c2f2ebe20",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/781c01f58066d375c14b1a717160f51c2f2ebe20",
      "tree": {
        "sha": "7b000a40fbcedb4716b2b7978a3197370f86540a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7b000a40fbcedb4716b2b7978a3197370f86540a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 7b000a40fbcedb4716b2b7978a3197370f86540a\nparent 39219fe145e5e6e6f079b591e3f4b5fea8e71804\nauthor TheCharlatan <seb.kung@gmail.com> 1727262602 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1727268354 +0200\n\ninit: Check mempool arguments in AppInitParameterInteractions\n\nThis makes the handling more consistent and reports errors sooner.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmb0BgcACgkQm3m0VpHb\nQXNXbRAAy4+3J3IY9RUg5sJJkU5Du7IkNotfAussmn+7MMm38wAaJRJdmmSK37J+\nx4zTi5A0gDAtwO5bSgqcgvXFQuSeb990orFUKy3nS4AdvN1jvTTiN20DsFpSsBMG\n7JSbHbc31pPl0En6QsSPajUOmbU2dqCdUQ3xeTCgMtcQroGcYQ8XutRzCbg53MD0\nbBCbGj4VQqTGEGcpvGBmXk4432DehbXpBk6mCi1sLzTT5DNbbLM4GgLxV7iUHzcD\n2UAdUfUrvIfNJa9rd83Ny/3uSIe1kr73aD7hBXWieNkd0DkZJNgDqRsI7YZTua66\nwHsVBpKbomCoE35rp2N0Rrc3ZcPJgQ8v7P83FbKUpowoMIW8JcnCM0C8PIvg8gN9\nffF5kqNkEuU6HngvGtMLEIOZodvQxIu5PNbuINSIrMPsOFlAGPD3sHDxT1Mzd2GC\nAEMZo0y+ZKZ5FQbNL6RCmGzlVB7Pfw8Qi8JW3EguioOWr4WVo4fglHV4uQLozFgt\n+iOGwjlYosIPjwHXTnJCgNiQ5ze7g7D1x8sgc4NUBmUWdIHUfjFrN9GN0kxuNEFT\n/kK0bJAr1GZbdLMnE5LRbAnXClKM3thK7QRLT4iR2wAwpGSKYFuKG3xo6RU9rezW\nn9DpN6k1SR6sJYHLcVGK0/jR8oR2xJE0/kOhPxydWyQH/xV1kuM=\n=hyQS\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39219fe145e5e6e6f079b591e3f4b5fea8e71804",
          "sha": "39219fe145e5e6e6f079b591e3f4b5fea8e71804",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/39219fe145e5e6e6f079b591e3f4b5fea8e71804"
        }
      ],
      "message": "init: Check mempool arguments in AppInitParameterInteractions\n\nThis makes the handling more consistent and reports errors sooner.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-09-25T12:45:54Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-09-25T11:10:02Z"
      },
      "sha": "781c01f58066d375c14b1a717160f51c2f2ebe20"
    },
    {
      "event": "commented",
      "id": 2374060944,
      "node_id": "IC_kwDOABII586NgUuQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2374060944",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-25T13:16:23Z",
      "updated_at": "2024-09-30T20:50:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30968).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [ryanofsky](https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2329376198), [maflcko](https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2376345627), [josibake](https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2377504632), [achow101](https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2384121576) |\n| Concept ACK | [theuni](https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2328825567), [ismaelsadeeq](https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2329121486), [kevkevinpal](https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2375355917), [stickies-v](https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2334139707), [mzumsande](https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2334717617) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#30967](https://github.com/bitcoin/bitcoin/pull/30967) (refactor: Replace g_genesis_wait_cv with m_tip_block_cv by maflcko)\n* [#30965](https://github.com/bitcoin/bitcoin/pull/30965) (kernel: Move block tree db open to block manager by TheCharlatan)\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2374060944",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "reviewed",
      "id": 2328680000,
      "node_id": "PRR_kwDOABII586KzNZA",
      "url": null,
      "actor": null,
      "commit_id": "705105de4f84f2ce3bb1d754c88c32349e01bb3b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 705105de4f84f2ce3bb1d754c88c32349e01bb3b\r\n\r\nNice cleanup. Previous for loop was very confusing and new code is straightforward.\r\n\r\nNot important, but I think it would be a little better if `InitAndLoadChainstate` simply returned `ChainstateLoadStatus` instead of `std::tuple</*may_retry*/ bool, /*error*/ bilingual_str>`. This way retry logic would be implemented in one function, not split across two functions. And it would avoid introducing a new way to represent success/interrupted/failure status, and just reuse the status type we already have:\r\n\r\n<details><summary>diff</summary>\r\n<p>\r\n\r\n```diff\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -123,6 +123,7 @@ using node::ApplyArgsManOptions;\r\n using node::BlockManager;\r\n using node::CacheSizes;\r\n using node::CalculateCacheSizes;\r\n+using node::ChainstateLoadStatus;\r\n using node::DEFAULT_PERSIST_MEMPOOL;\r\n using node::DEFAULT_PRINT_MODIFIED_FEE;\r\n using node::DEFAULT_STOPATHEIGHT;\r\n@@ -1185,23 +1186,24 @@ bool CheckHostPortOptions(const ArgsManager& args) {\r\n \r\n // A GUI user may opt to retry once if there is a failure during chainstate initialization.\r\n // The function therefore has to support re-entry.\r\n-static std::tuple</*may_retry*/ bool, /*error*/ bilingual_str> InitAndLoadChainstate(\r\n+static ChainstateLoadStatus InitAndLoadChainstate(\r\n     NodeContext& node,\r\n     bool do_reindex,\r\n     const bool do_reindex_chainstate,\r\n     CacheSizes& cache_sizes,\r\n-    const ArgsManager& args)\r\n+    const ArgsManager& args,\r\n+    bilingual_str& error)\r\n {\r\n+    error.clear();\r\n     const CChainParams& chainparams = Params();\r\n     CTxMemPool::Options mempool_opts{\r\n         .check_ratio = chainparams.DefaultConsistencyChecks() ? 1 : 0,\r\n         .signals = node.validation_signals.get(),\r\n     };\r\n     Assert(ApplyArgsManOptions(args, chainparams, mempool_opts)); // no error can happen, already checked in AppInitParameterInteraction\r\n-    bilingual_str mempool_error;\r\n-    node.mempool = std::make_unique<CTxMemPool>(mempool_opts, mempool_error);\r\n-    if (!mempool_error.empty()) {\r\n-        return {/*may_retry*/ false, /*error*/ mempool_error};\r\n+    node.mempool = std::make_unique<CTxMemPool>(mempool_opts, error);\r\n+    if (!error.empty()) {\r\n+        return ChainstateLoadStatus::FAILURE_FATAL;\r\n     }\r\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\r\n     ChainstateManager::Options chainman_opts{\r\n@@ -1220,7 +1222,8 @@ static std::tuple</*may_retry*/ bool, /*error*/ bilingual_str> InitAndLoadChains\r\n     try {\r\n         node.chainman = std::make_unique<ChainstateManager>(*Assert(node.shutdown), chainman_opts, blockman_opts);\r\n     } catch (std::exception& e) {\r\n-        return {/*may_retry*/ false, /*error*/ strprintf(Untranslated(\"Failed to initialize ChainstateManager: %s\"), e.what())};\r\n+        error = Untranslated(strprintf(\"Failed to initialize ChainstateManager: %s\", e.what()));\r\n+        return ChainstateLoadStatus::FAILURE_FATAL;\r\n     }\r\n     ChainstateManager& chainman = *node.chainman;\r\n     // This is defined and set here instead of inline in validation.h to avoid a hard\r\n@@ -1266,7 +1269,8 @@ static std::tuple</*may_retry*/ bool, /*error*/ bilingual_str> InitAndLoadChains\r\n             return std::make_tuple(node::ChainstateLoadStatus::FAILURE, _(\"Error opening block database\"));\r\n         }\r\n     };\r\n-    auto [status, error] = catch_exceptions([&] { return LoadChainstate(chainman, cache_sizes, options); });\r\n+    ChainstateLoadStatus status;\r\n+    std::tie(status, error) = catch_exceptions([&] { return LoadChainstate(chainman, cache_sizes, options); });\r\n     if (status == node::ChainstateLoadStatus::SUCCESS) {\r\n         uiInterface.InitMessage(_(\"Verifying blocksâ€¦\").translated);\r\n         if (chainman.m_blockman.m_have_pruned && options.check_blocks > MIN_BLOCKS_TO_KEEP) {\r\n@@ -1276,13 +1280,9 @@ static std::tuple</*may_retry*/ bool, /*error*/ bilingual_str> InitAndLoadChains\r\n         std::tie(status, error) = catch_exceptions([&] { return VerifyLoadedChainstate(chainman, options); });\r\n         if (status == node::ChainstateLoadStatus::SUCCESS) {\r\n             LogPrintf(\" block index %15dms\\n\", Ticks<std::chrono::milliseconds>(SteadyClock::now() - load_block_index_start_time));\r\n-            return {/*may_retry*/ false, /*error*/ bilingual_str{}};\r\n         }\r\n     }\r\n-    if (status == node::ChainstateLoadStatus::FAILURE_FATAL || status == node::ChainstateLoadStatus::FAILURE_INCOMPATIBLE_DB || status == node::ChainstateLoadStatus::FAILURE_INSUFFICIENT_DBCACHE) {\r\n-        return {/*may_retry*/ false, /*error*/ error};\r\n-    }\r\n-    return {/*may_retry*/ true, /*error*/ error};\r\n+    return status;\r\n };\r\n \r\n bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n@@ -1638,13 +1638,9 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n     const bool do_reindex_chainstate{args.GetBoolArg(\"-reindex-chainstate\", false)};\r\n \r\n     // Chainstate initialization and loading may be retried once with reindexing by GUI users\r\n-    auto [maybe_retry, error] = InitAndLoadChainstate(\r\n-        node,\r\n-        do_reindex,\r\n-        do_reindex_chainstate,\r\n-        cache_sizes,\r\n-        args);\r\n-    if (maybe_retry && !do_reindex && !ShutdownRequested(node)) {\r\n+    bilingual_str error;\r\n+    ChainstateLoadStatus status = InitAndLoadChainstate(node, do_reindex, do_reindex_chainstate, cache_sizes, args, error);\r\n+    if (status == ChainstateLoadStatus::FAILURE && !do_reindex && !ShutdownRequested(node)) {\r\n         // suggest a reindex\r\n         bool do_retry = uiInterface.ThreadSafeQuestion(\r\n             error + Untranslated(\".\\n\\n\") + _(\"Do you want to rebuild the block database now?\"),\r\n@@ -1658,14 +1654,9 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n         if (!Assert(node.shutdown)->reset()) {\r\n             LogError(\"Internal error: failed to reset shutdown signal.\\n\");\r\n         }\r\n-        std::tie(std::ignore, error) = InitAndLoadChainstate(\r\n-            node,\r\n-            do_reindex,\r\n-            do_reindex_chainstate,\r\n-            cache_sizes,\r\n-            args);\r\n+        status = InitAndLoadChainstate(node, do_reindex, do_reindex_chainstate, cache_sizes, args, error);\r\n     }\r\n-    if (!error.empty()) {\r\n+    if (status != ChainstateLoadStatus::SUCCESS && status != ChainstateLoadStatus::INTERRUPTED) {\r\n         return InitError(error);\r\n     }\r\n \r\n```\r\n</p>\r\n</details>\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2328680000",
      "submitted_at": "2024-09-25T15:42:17Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
    },
    {
      "event": "reviewed",
      "id": 2328825567,
      "node_id": "PRR_kwDOABII586Kzw7f",
      "url": null,
      "actor": null,
      "commit_id": "705105de4f84f2ce3bb1d754c88c32349e01bb3b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK. I've also spent a good amount of time (more than once) scratching my head trying to understand this loop.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2328825567",
      "submitted_at": "2024-09-25T16:34:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGMxZDg4NzBlYTQxNTVjMjc2NmQzMGQzOGZjNWIxYWZjNjNkY2QzNjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c1d8870ea4155c2766d30d38fc5b1afc63dcd364",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c1d8870ea4155c2766d30d38fc5b1afc63dcd364",
      "tree": {
        "sha": "a4728dc1715b419dd3a5ab641afa37ffd5155cce",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a4728dc1715b419dd3a5ab641afa37ffd5155cce"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a4728dc1715b419dd3a5ab641afa37ffd5155cce\nparent 781c01f58066d375c14b1a717160f51c2f2ebe20\nauthor TheCharlatan <seb.kung@gmail.com> 1727263450 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1727285999 +0200\n\nrefactor: Move most of init retry for loop to a function\n\nThis makes it clearer which state is being mutated by the function and\nfacilitates getting rid of the for loop in the following commit. Move\ncreation of the required options into the function too, such that the\nfunction takes fewer arguments and is more self-contained.\n\nCo-Authored-By: Ryan Ofsky <ryan@ofsky.org>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmb0SvUACgkQm3m0VpHb\nQXOoQA/9G6Y15+zolt1fmxdRcCIFZYHwvbbDPu297GB/u7Sck+MTHyqhJlvpy8HQ\nTztzqrt6OJLy3yi7Yd0fE+mY5FrCmmDTiqlICneqQrEoSOeDaZmw9FWlDTZrFUhQ\nfI12YrGABB8cquh8P0KZ67ws+O0nCOK2XI84w+p+TMRrfZU8km2ZW4qoXnrxITRP\naS8AnkZ2ByawamRLQrt4pNnjYk00jd8hF+6Y8I5ccvhIi7sZpTFDIiEhu5LYdwAn\nk+7HyRIeN2u2I37/7jSWRzsX/sM9Kn7kkDrHPmpVjjZT67LBmDhA8PgPulBzuCwp\nnTEPy4Lw9xe0jrtvP/04Lt0tC0slR33xeAWdlzQpq+U2vQLLFmEFfZfprxQ85hF3\nCEwEghtUype3bArVRtA7sM8qd/MUJESJfOr+h9OZM0Xos2yxEekHbrR/bAdPPA5j\nMZU2EtbTuljCyjh3V7XSZhYtqdgo2m+bxhRx+/XodMPM82vkTnOFeBwYczkaCfhp\nu5VTbgxJ+qjn8xx53uUNyUT14EbUD8LHpV/tHlDgqugwoO0llJHTRrqBfUmTumgz\nR11uv7JregYjDFUdpNUDiapiMfxVIwhMuLLt8hNcsF0HwZyVxj8ZcKuCmxpaRjPz\nN4PGXTlU1a3LdPsy+X2r4+AatSPPthMnsyTY6gsRSvbpeKryPxM=\n=pdsh\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/781c01f58066d375c14b1a717160f51c2f2ebe20",
          "sha": "781c01f58066d375c14b1a717160f51c2f2ebe20",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/781c01f58066d375c14b1a717160f51c2f2ebe20"
        }
      ],
      "message": "refactor: Move most of init retry for loop to a function\n\nThis makes it clearer which state is being mutated by the function and\nfacilitates getting rid of the for loop in the following commit. Move\ncreation of the required options into the function too, such that the\nfunction takes fewer arguments and is more self-contained.\n\nCo-Authored-By: Ryan Ofsky <ryan@ofsky.org>",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-09-25T17:39:59Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-09-25T11:24:10Z"
      },
      "sha": "c1d8870ea4155c2766d30d38fc5b1afc63dcd364"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU5ZDYwYWY5ODg5YzEyYjRkNDI3YWRlZmE1M2ZkMjM0ZTQxN2Y4ZjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "tree": {
        "sha": "74b596af3167617d1bc241179d8384b11f2ef8dc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/74b596af3167617d1bc241179d8384b11f2ef8dc"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 74b596af3167617d1bc241179d8384b11f2ef8dc\nparent c1d8870ea4155c2766d30d38fc5b1afc63dcd364\nauthor TheCharlatan <seb.kung@gmail.com> 1727266447 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1727286009 +0200\n\nrefactor: Replace init retry for loop with if statement\n\nThe for loop has been a long standing source of confusion and bugs, both\nbecause its purpose is not clearly documented and because the body of\nthe for loop contains a lot of logic.\n\nCo-Authored-By: Ryan Ofsky <ryan@ofsky.org>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmb0Sv8ACgkQm3m0VpHb\nQXNQfg//SDzaxzKCHivEnzDTee0Zu99rey+aWTV2SgpobqcMwbYofutW9HmFOlgU\n7Ygeje6Kd/9foziTsIvrVJBy3x2TBtHeRHsX7NeQJkZqJfZJYgIKihlG8Ds4fwlH\n5ny+Q94z8zF97Ajn0b1Qz8qjFpkMcISKHLbGi8zZVAUczLMf3a69TNMK8ct+mNtg\n8aUiNp1ZKvlLZrDFxEl5yO69pMdLEwKQzbuOFW7UicUHSTEfvo2/DBbK4vGd3jbw\nVZZ1ak83cFI+zYDSRQ5zbK0DD+NTjiDFz/Pn3UDtTDxbZ3L5Abg/5MLBVPkfFV/D\nTFGCChbAVrb1T2n/S8tQInwnJYif7Z8ntOAJHrRA1ormhscKW6c7917v0cemL26x\nkIfDpRbl+9XsuNSRmPBQ1ZbtEKPkhnVaRnBekNASQxgLslszCwHqis7oAip4WqjO\nNe+cTv5Pa8OtfAshhCXSzFO+NhU/wTB53HaSVrgNJcvr1nBzzm32VIwb2gDatSGo\nhQz+wJfjkYhwYsVez89nuLIq+FV+WKN98rvGcv2ej0kACU92JfS5Io730zXT9SKb\nZcgmZsJk0+4rfF1UIjp5D+qyg+zrEA7wxA+HB40MK10rc4hDa681pj1ldiSQGT69\nm9gReElzmnIe3QHUuQgZcQYQ8omRbF8W3FRA9pzPL5pZKCGGBT8=\n=0aX9\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c1d8870ea4155c2766d30d38fc5b1afc63dcd364",
          "sha": "c1d8870ea4155c2766d30d38fc5b1afc63dcd364",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c1d8870ea4155c2766d30d38fc5b1afc63dcd364"
        }
      ],
      "message": "refactor: Replace init retry for loop with if statement\n\nThe for loop has been a long standing source of confusion and bugs, both\nbecause its purpose is not clearly documented and because the body of\nthe for loop contains a lot of logic.\n\nCo-Authored-By: Ryan Ofsky <ryan@ofsky.org>",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-09-25T17:40:09Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-09-25T12:14:07Z"
      },
      "sha": "e9d60af9889c12b4d427adefa53fd234e417f8f6"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14403224966,
      "node_id": "HRFPE_lADOABII586X3vavzwAAAANaf8WG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14403224966",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-25T17:43:16Z"
    },
    {
      "event": "commented",
      "id": 2374760380,
      "node_id": "IC_kwDOABII586Ni_e8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2374760380",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-25T17:43:39Z",
      "updated_at": "2024-09-25T17:43:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you for your suggestion @ryanofsky,\r\n\r\nUpdated 705105de4f84f2ce3bb1d754c88c32349e01bb3b -> e9d60af9889c12b4d427adefa53fd234e417f8f6 ([removeInitForLoop_0](https://github.com/TheCharlatan/bitcoin/tree/removeInitForLoop_0) -> [removeInitForLoop_1](https://github.com/TheCharlatan/bitcoin/tree/removeInitForLoop_1), [compare](https://github.com/TheCharlatan/bitcoin/compare/removeInitForLoop_0..removeInitForLoop_1))\r\n\r\n* Took @ryanofsky's [suggestion](https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2328680000), making the new `InitLoadChainstate` function return a `ChainstateLoadResult` and using it instead of a `retry` and `error` tuple.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2374760380",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "mentioned",
      "id": 14403229240,
      "node_id": "MEE_lADOABII586X3vavzwAAAANaf9Y4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14403229240",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-25T17:43:40Z"
    },
    {
      "event": "subscribed",
      "id": 14403229259,
      "node_id": "SE_lADOABII586X3vavzwAAAANaf9ZL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14403229259",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-25T17:43:40Z"
    },
    {
      "event": "reviewed",
      "id": 2329121486,
      "node_id": "PRR_kwDOABII586K05LO",
      "url": null,
      "actor": null,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Nice Concept ACK",
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2329121486",
      "submitted_at": "2024-09-25T18:02:06Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
    },
    {
      "event": "reviewed",
      "id": 2329376198,
      "node_id": "PRR_kwDOABII586K13XG",
      "url": null,
      "actor": null,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK e9d60af9889c12b4d427adefa53fd234e417f8f6. Nice change to make AppInitMain shorter and more understandable.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2329376198",
      "submitted_at": "2024-09-25T19:40:25Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
    },
    {
      "event": "review_requested",
      "id": 14405134475,
      "node_id": "RRE_lADOABII586X3vavzwAAAANanOiL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14405134475",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-25T19:40:28Z",
      "requested_reviewer": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 14405134597,
      "node_id": "RRE_lADOABII586X3vavzwAAAANanOkF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14405134597",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-25T19:40:29Z",
      "requested_reviewer": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "commented",
      "id": 2375355917,
      "node_id": "IC_kwDOABII586NlQ4N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2375355917",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-25T22:10:53Z",
      "updated_at": "2024-09-25T22:10:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK the for loop is confusing and refactoring it to something better is a welcomed change",
      "user": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2375355917",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "commented",
      "id": 2376345627,
      "node_id": "IC_kwDOABII586NpCgb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2376345627",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-26T08:51:13Z",
      "updated_at": "2024-09-26T08:51:13Z",
      "author_association": "MEMBER",
      "body": "Reviewed, but did not test the retry flow in the GUI\r\n\r\nreview ACK e9d60af9889c12b4d427adefa53fd234e417f8f6 ðŸš¸\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\nuntrusted comment: signature from minisign secret key on empty file; verify via: minisign -Vm \"${path_to_any_empty_file}\" -P RWTRmVTMeKV5noAMqVlsMugDDCyyTSbA3Re5AkUrhvLVln0tSaFWglOw -x \"${path_to_this_whole_four_line_signature_blob}\"\r\nRUTRmVTMeKV5npGrKx1nqXCw5zeVHdtdYURB/KlyA/LMFgpNCs+SkW9a8N95d+U4AP1RJMi+krxU1A3Yux4bpwZNLvVBKy0wLgM=\r\ntrusted comment: review ACK e9d60af9889c12b4d427adefa53fd234e417f8f6 ðŸš¸\r\niATg595aO+/TUwqgVqt7+bt2dNjd2Ai91/AKhFJ+R83tf9xxI+uDnPy6qo038kgbtoy4KXt7egIDP7XzmzLcDQ==\r\n```\r\n\r\n</details>\r\n",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2376345627",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "commented",
      "id": 2377504632,
      "node_id": "IC_kwDOABII586Ntdd4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2377504632",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-26T17:12:06Z",
      "updated_at": "2024-09-26T17:12:06Z",
      "author_association": "MEMBER",
      "body": "crACK https://github.com/bitcoin/bitcoin/commit/e9d60af9889c12b4d427adefa53fd234e417f8f6\r\n\r\nCame here from reviewing https://github.com/bitcoin/bitcoin/pull/30965#discussion_r1776649353, haven't tested but did review and the code change is relatively straightforward (mostly a move-only change) and definitely improves the readability here.",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2377504632",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "reviewed",
      "id": 2332133732,
      "node_id": "PRR_kwDOABII586LAYlk",
      "url": null,
      "actor": null,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2332133732",
      "submitted_at": "2024-09-26T19:03:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
    },
    {
      "event": "commented",
      "id": 2378624163,
      "node_id": "IC_kwDOABII586Nxuyj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2378624163",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-27T07:43:15Z",
      "updated_at": "2024-09-27T07:43:15Z",
      "author_association": "MEMBER",
      "body": "> The error behaviour can be tested by either manually making `LoadChainstate` return a failure, or deleting some of the block index database files.\r\n\r\nUpgrading my review: I tested using the instructions.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2378624163",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "reviewed",
      "id": 2334139707,
      "node_id": "PRR_kwDOABII586LICU7",
      "url": null,
      "actor": null,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Strong concept ACK!",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2334139707",
      "submitted_at": "2024-09-27T16:32:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
    },
    {
      "event": "reviewed",
      "id": 2334717617,
      "node_id": "PRR_kwDOABII586LKPax",
      "url": null,
      "actor": null,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nI think that one minor change in behavior is that with the old code we could retry many times if, for some reason, we'd repeatedly get `ChainstateLoadStatus::FAILURE` messages (which shouldn't happen normally, but might in some exotic failure scenarios?).\r\nBut even if it was possible to get these messages repeatedly, it doesn't really make sense to retry more than once.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#pullrequestreview-2334717617",
      "submitted_at": "2024-09-27T22:20:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
    },
    {
      "event": "commented",
      "id": 2380253538,
      "node_id": "IC_kwDOABII586N38li",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2380253538",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-27T22:59:37Z",
      "updated_at": "2024-09-27T22:59:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I think that one minor change in behavior is that with the old code we could retry many times if, for some reason, we'd repeatedly get `ChainstateLoadStatus::FAILURE` messages (which shouldn't happen normally, but might in some exotic failure scenarios?)\r\n\r\nI think it wouldn't retry multiple times because the old code sets `do_reindex = true`\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/d812cf11896a2214467b6fa72d7b763bac6077c5/src/init.cpp#L1643\r\n\r\nAt least that was my interpretation reviewing this earlier (could be mistaken)",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2380253538",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "commented",
      "id": 2380328047,
      "node_id": "IC_kwDOABII586N4Oxv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2380328047",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-28T00:59:01Z",
      "updated_at": "2024-09-28T00:59:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "> At least that was my interpretation reviewing this earlier (could be mistaken)\r\n\r\nYes, you are right. I thought that maybe there could be some scenarios where even with `do_reindex == true` we could maybe get `ChainstateLoadStatus::FAILURE` again, but after looking more closely I don't see how this could be the case.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2380328047",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "commented",
      "id": 2384121576,
      "node_id": "IC_kwDOABII586OGs7o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2384121576",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-30T20:50:29Z",
      "updated_at": "2024-09-30T20:50:29Z",
      "author_association": "MEMBER",
      "body": "ACK e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#issuecomment-2384121576",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30968"
    },
    {
      "event": "review_requested",
      "id": 14462192355,
      "node_id": "RRE_lADOABII586X3vavzwAAAANeA4rj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14462192355",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-30T20:50:34Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 14462192658,
      "node_id": "RRE_lADOABII586X3vavzwAAAANeA4wS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14462192658",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-30T20:50:35Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1775897574",
      "pull_request_review_id": 2329376198,
      "id": 1775897574,
      "node_id": "PRRC_kwDOABII585p2gvm",
      "diff_hunk": "@@ -1546,96 +1632,25 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.mempool);\n     assert(!node.chainman);\n \n-    CTxMemPool::Options mempool_opts{\n-        .check_ratio = chainparams.DefaultConsistencyChecks() ? 1 : 0,\n-        .signals = &validation_signals,\n-    };\n-    Assert(ApplyArgsManOptions(args, chainparams, mempool_opts)); // no error can happen, already checked in AppInitParameterInteraction\n-\n     bool do_reindex{args.GetBoolArg(\"-reindex\", false)};\n     const bool do_reindex_chainstate{args.GetBoolArg(\"-reindex-chainstate\", false)};\n \n     for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        bilingual_str mempool_error;\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, mempool_error);\n-        if (!mempool_error.empty()) {\n-            return InitError(mempool_error);\n-        }\n-        LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n-\n-        try {\n-            node.chainman = std::make_unique<ChainstateManager>(*Assert(node.shutdown), chainman_opts, blockman_opts);\n-        } catch (std::exception& e) {\n-            return InitError(strprintf(Untranslated(\"Failed to initialize ChainstateManager: %s\"), e.what()));\n-        }\n-        ChainstateManager& chainman = *node.chainman;\n-\n-        // This is defined and set here instead of inline in validation.h to avoid a hard\n-        // dependency between validation and index/base, since the latter is not in\n-        // libbitcoinkernel.\n-        chainman.snapshot_download_completed = [&node]() {\n-            if (!node.chainman->m_blockman.IsPruneMode()) {\n-                LogPrintf(\"[snapshot] re-enabling NODE_NETWORK services\\n\");\n-                node.connman->AddLocalServices(NODE_NETWORK);\n-            }\n-\n-            LogPrintf(\"[snapshot] restarting indexes\\n\");\n-\n-            // Drain the validation interface queue to ensure that the old indexes\n-            // don't have any pending work.\n-            Assert(node.validation_signals)->SyncWithValidationInterfaceQueue();\n-\n-            for (auto* index : node.indexes) {\n-                index->Interrupt();\n-                index->Stop();\n-                if (!(index->Init() && index->StartBackgroundSync())) {\n-                    LogPrintf(\"[snapshot] WARNING failed to restart index %s on snapshot chain\\n\", index->GetName());\n-                }\n-            }\n-        };\n-\n-        node::ChainstateLoadOptions options;\n-        options.mempool = Assert(node.mempool.get());\n-        options.wipe_block_tree_db = do_reindex;\n-        options.wipe_chainstate_db = do_reindex || do_reindex_chainstate;\n-        options.prune = chainman.m_blockman.IsPruneMode();\n-        options.check_blocks = args.GetIntArg(\"-checkblocks\", DEFAULT_CHECKBLOCKS);\n-        options.check_level = args.GetIntArg(\"-checklevel\", DEFAULT_CHECKLEVEL);\n-        options.require_full_verification = args.IsArgSet(\"-checkblocks\") || args.IsArgSet(\"-checklevel\");\n-        options.coins_error_cb = [] {\n-            uiInterface.ThreadSafeMessageBox(\n-                _(\"Error reading from database, shutting down.\"),\n-                \"\", CClientUIInterface::MSG_ERROR);\n-        };\n-\n-        uiInterface.InitMessage(_(\"Loading block indexâ€¦\").translated);\n-        const auto load_block_index_start_time{SteadyClock::now()};\n-        auto catch_exceptions = [](auto&& f) {\n-            try {\n-                return f();\n-            } catch (const std::exception& e) {\n-                LogError(\"%s\\n\", e.what());\n-                return std::make_tuple(node::ChainstateLoadStatus::FAILURE, _(\"Error opening block database\"));\n-            }\n-        };\n-        auto [status, error] = catch_exceptions([&]{ return LoadChainstate(chainman, cache_sizes, options); });\n-        if (status == node::ChainstateLoadStatus::SUCCESS) {\n-            uiInterface.InitMessage(_(\"Verifying blocksâ€¦\").translated);\n-            if (chainman.m_blockman.m_have_pruned && options.check_blocks > MIN_BLOCKS_TO_KEEP) {\n-                LogWarning(\"pruned datadir may not have more than %d blocks; only checking available blocks\\n\",\n-                                  MIN_BLOCKS_TO_KEEP);\n-            }\n-            std::tie(status, error) = catch_exceptions([&]{ return VerifyLoadedChainstate(chainman, options);});\n-            if (status == node::ChainstateLoadStatus::SUCCESS) {\n-                fLoaded = true;\n-                LogPrintf(\" block index %15dms\\n\", Ticks<std::chrono::milliseconds>(SteadyClock::now() - load_block_index_start_time));\n-            }\n-        }\n+        auto [status, error] = InitAndLoadChainstate(\n+            node,\n+            do_reindex,\n+            do_reindex_chainstate,\n+            cache_sizes,\n+            args);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 242,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "original_commit_id": "c1d8870ea4155c2766d30d38fc5b1afc63dcd364",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not important, for but both of the InitAndLoadChainstate calls in this PR, I'm surprised someone would prefer newline separated arguments over space separated:\r\n\r\n```c++\r\nInitAndLoadChainstate(node, do_reindex, do_reindex_chainstate, cache_sizes, args);\r\n```\r\n\r\nclang-format has a nice \"BinPack\" and \"Align\" options for packing arguments neatly without having to take up large amounts of space",
      "created_at": "2024-09-25T19:35:22Z",
      "updated_at": "2024-09-25T19:40:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#discussion_r1775897574",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1775897574"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
        }
      },
      "start_line": null,
      "original_start_line": 1639,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1644,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1775916783",
      "pull_request_review_id": 2329408241,
      "id": 1775916783,
      "node_id": "PRRC_kwDOABII585p2lbv",
      "diff_hunk": "@@ -1546,96 +1632,25 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.mempool);\n     assert(!node.chainman);\n \n-    CTxMemPool::Options mempool_opts{\n-        .check_ratio = chainparams.DefaultConsistencyChecks() ? 1 : 0,\n-        .signals = &validation_signals,\n-    };\n-    Assert(ApplyArgsManOptions(args, chainparams, mempool_opts)); // no error can happen, already checked in AppInitParameterInteraction\n-\n     bool do_reindex{args.GetBoolArg(\"-reindex\", false)};\n     const bool do_reindex_chainstate{args.GetBoolArg(\"-reindex-chainstate\", false)};\n \n     for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        bilingual_str mempool_error;\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, mempool_error);\n-        if (!mempool_error.empty()) {\n-            return InitError(mempool_error);\n-        }\n-        LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n-\n-        try {\n-            node.chainman = std::make_unique<ChainstateManager>(*Assert(node.shutdown), chainman_opts, blockman_opts);\n-        } catch (std::exception& e) {\n-            return InitError(strprintf(Untranslated(\"Failed to initialize ChainstateManager: %s\"), e.what()));\n-        }\n-        ChainstateManager& chainman = *node.chainman;\n-\n-        // This is defined and set here instead of inline in validation.h to avoid a hard\n-        // dependency between validation and index/base, since the latter is not in\n-        // libbitcoinkernel.\n-        chainman.snapshot_download_completed = [&node]() {\n-            if (!node.chainman->m_blockman.IsPruneMode()) {\n-                LogPrintf(\"[snapshot] re-enabling NODE_NETWORK services\\n\");\n-                node.connman->AddLocalServices(NODE_NETWORK);\n-            }\n-\n-            LogPrintf(\"[snapshot] restarting indexes\\n\");\n-\n-            // Drain the validation interface queue to ensure that the old indexes\n-            // don't have any pending work.\n-            Assert(node.validation_signals)->SyncWithValidationInterfaceQueue();\n-\n-            for (auto* index : node.indexes) {\n-                index->Interrupt();\n-                index->Stop();\n-                if (!(index->Init() && index->StartBackgroundSync())) {\n-                    LogPrintf(\"[snapshot] WARNING failed to restart index %s on snapshot chain\\n\", index->GetName());\n-                }\n-            }\n-        };\n-\n-        node::ChainstateLoadOptions options;\n-        options.mempool = Assert(node.mempool.get());\n-        options.wipe_block_tree_db = do_reindex;\n-        options.wipe_chainstate_db = do_reindex || do_reindex_chainstate;\n-        options.prune = chainman.m_blockman.IsPruneMode();\n-        options.check_blocks = args.GetIntArg(\"-checkblocks\", DEFAULT_CHECKBLOCKS);\n-        options.check_level = args.GetIntArg(\"-checklevel\", DEFAULT_CHECKLEVEL);\n-        options.require_full_verification = args.IsArgSet(\"-checkblocks\") || args.IsArgSet(\"-checklevel\");\n-        options.coins_error_cb = [] {\n-            uiInterface.ThreadSafeMessageBox(\n-                _(\"Error reading from database, shutting down.\"),\n-                \"\", CClientUIInterface::MSG_ERROR);\n-        };\n-\n-        uiInterface.InitMessage(_(\"Loading block indexâ€¦\").translated);\n-        const auto load_block_index_start_time{SteadyClock::now()};\n-        auto catch_exceptions = [](auto&& f) {\n-            try {\n-                return f();\n-            } catch (const std::exception& e) {\n-                LogError(\"%s\\n\", e.what());\n-                return std::make_tuple(node::ChainstateLoadStatus::FAILURE, _(\"Error opening block database\"));\n-            }\n-        };\n-        auto [status, error] = catch_exceptions([&]{ return LoadChainstate(chainman, cache_sizes, options); });\n-        if (status == node::ChainstateLoadStatus::SUCCESS) {\n-            uiInterface.InitMessage(_(\"Verifying blocksâ€¦\").translated);\n-            if (chainman.m_blockman.m_have_pruned && options.check_blocks > MIN_BLOCKS_TO_KEEP) {\n-                LogWarning(\"pruned datadir may not have more than %d blocks; only checking available blocks\\n\",\n-                                  MIN_BLOCKS_TO_KEEP);\n-            }\n-            std::tie(status, error) = catch_exceptions([&]{ return VerifyLoadedChainstate(chainman, options);});\n-            if (status == node::ChainstateLoadStatus::SUCCESS) {\n-                fLoaded = true;\n-                LogPrintf(\" block index %15dms\\n\", Ticks<std::chrono::milliseconds>(SteadyClock::now() - load_block_index_start_time));\n-            }\n-        }\n+        auto [status, error] = InitAndLoadChainstate(\n+            node,\n+            do_reindex,\n+            do_reindex_chainstate,\n+            cache_sizes,\n+            args);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 242,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "original_commit_id": "c1d8870ea4155c2766d30d38fc5b1afc63dcd364",
      "in_reply_to_id": 1775897574,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Mmh, I think this must have been something I did out of old habit. It would be good to have these stricter clang format options documented in the dev notes so we can at least all try to write similarly formatted new code.",
      "created_at": "2024-09-25T19:53:41Z",
      "updated_at": "2024-09-25T19:53:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#discussion_r1775916783",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1775916783"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
        }
      },
      "start_line": null,
      "original_start_line": 1639,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1644,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1776654445",
      "pull_request_review_id": 2330557083,
      "id": 1776654445,
      "node_id": "PRRC_kwDOABII585p5Zht",
      "diff_hunk": "@@ -1546,96 +1632,25 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.mempool);\n     assert(!node.chainman);\n \n-    CTxMemPool::Options mempool_opts{\n-        .check_ratio = chainparams.DefaultConsistencyChecks() ? 1 : 0,\n-        .signals = &validation_signals,\n-    };\n-    Assert(ApplyArgsManOptions(args, chainparams, mempool_opts)); // no error can happen, already checked in AppInitParameterInteraction\n-\n     bool do_reindex{args.GetBoolArg(\"-reindex\", false)};\n     const bool do_reindex_chainstate{args.GetBoolArg(\"-reindex-chainstate\", false)};\n \n     for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        bilingual_str mempool_error;\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, mempool_error);\n-        if (!mempool_error.empty()) {\n-            return InitError(mempool_error);\n-        }\n-        LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n-\n-        try {\n-            node.chainman = std::make_unique<ChainstateManager>(*Assert(node.shutdown), chainman_opts, blockman_opts);\n-        } catch (std::exception& e) {\n-            return InitError(strprintf(Untranslated(\"Failed to initialize ChainstateManager: %s\"), e.what()));\n-        }\n-        ChainstateManager& chainman = *node.chainman;\n-\n-        // This is defined and set here instead of inline in validation.h to avoid a hard\n-        // dependency between validation and index/base, since the latter is not in\n-        // libbitcoinkernel.\n-        chainman.snapshot_download_completed = [&node]() {\n-            if (!node.chainman->m_blockman.IsPruneMode()) {\n-                LogPrintf(\"[snapshot] re-enabling NODE_NETWORK services\\n\");\n-                node.connman->AddLocalServices(NODE_NETWORK);\n-            }\n-\n-            LogPrintf(\"[snapshot] restarting indexes\\n\");\n-\n-            // Drain the validation interface queue to ensure that the old indexes\n-            // don't have any pending work.\n-            Assert(node.validation_signals)->SyncWithValidationInterfaceQueue();\n-\n-            for (auto* index : node.indexes) {\n-                index->Interrupt();\n-                index->Stop();\n-                if (!(index->Init() && index->StartBackgroundSync())) {\n-                    LogPrintf(\"[snapshot] WARNING failed to restart index %s on snapshot chain\\n\", index->GetName());\n-                }\n-            }\n-        };\n-\n-        node::ChainstateLoadOptions options;\n-        options.mempool = Assert(node.mempool.get());\n-        options.wipe_block_tree_db = do_reindex;\n-        options.wipe_chainstate_db = do_reindex || do_reindex_chainstate;\n-        options.prune = chainman.m_blockman.IsPruneMode();\n-        options.check_blocks = args.GetIntArg(\"-checkblocks\", DEFAULT_CHECKBLOCKS);\n-        options.check_level = args.GetIntArg(\"-checklevel\", DEFAULT_CHECKLEVEL);\n-        options.require_full_verification = args.IsArgSet(\"-checkblocks\") || args.IsArgSet(\"-checklevel\");\n-        options.coins_error_cb = [] {\n-            uiInterface.ThreadSafeMessageBox(\n-                _(\"Error reading from database, shutting down.\"),\n-                \"\", CClientUIInterface::MSG_ERROR);\n-        };\n-\n-        uiInterface.InitMessage(_(\"Loading block indexâ€¦\").translated);\n-        const auto load_block_index_start_time{SteadyClock::now()};\n-        auto catch_exceptions = [](auto&& f) {\n-            try {\n-                return f();\n-            } catch (const std::exception& e) {\n-                LogError(\"%s\\n\", e.what());\n-                return std::make_tuple(node::ChainstateLoadStatus::FAILURE, _(\"Error opening block database\"));\n-            }\n-        };\n-        auto [status, error] = catch_exceptions([&]{ return LoadChainstate(chainman, cache_sizes, options); });\n-        if (status == node::ChainstateLoadStatus::SUCCESS) {\n-            uiInterface.InitMessage(_(\"Verifying blocksâ€¦\").translated);\n-            if (chainman.m_blockman.m_have_pruned && options.check_blocks > MIN_BLOCKS_TO_KEEP) {\n-                LogWarning(\"pruned datadir may not have more than %d blocks; only checking available blocks\\n\",\n-                                  MIN_BLOCKS_TO_KEEP);\n-            }\n-            std::tie(status, error) = catch_exceptions([&]{ return VerifyLoadedChainstate(chainman, options);});\n-            if (status == node::ChainstateLoadStatus::SUCCESS) {\n-                fLoaded = true;\n-                LogPrintf(\" block index %15dms\\n\", Ticks<std::chrono::milliseconds>(SteadyClock::now() - load_block_index_start_time));\n-            }\n-        }\n+        auto [status, error] = InitAndLoadChainstate(\n+            node,\n+            do_reindex,\n+            do_reindex_chainstate,\n+            cache_sizes,\n+            args);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 242,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "original_commit_id": "c1d8870ea4155c2766d30d38fc5b1afc63dcd364",
      "in_reply_to_id": 1775897574,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> clang-format has a nice \"BinPack\" and \"Align\" options\r\n\r\nLast time I checked they wouldn't take any effect with `ColumnLimit:     0`, but maybe I am wrong, or this may have changed. However, once there is a line break, I think using a line break for all is cleaner (`cargo fmt` agrees with me and consistently either uses a line-separator or space-separator, but never mixes them [1]). It would be nice if there was a clang-format config that did what `cargo fmt` does by default.\r\n\r\n\r\n[1] https://github.com/bitcoin/bitcoin/blob/65f6e7078b17e6e73d74dfeb00159878099fee1e/test/lint/test_runner/src/main.rs#L350 and https://github.com/bitcoin/bitcoin/blob/65f6e7078b17e6e73d74dfeb00159878099fee1e/test/lint/test_runner/src/main.rs#L272-L278",
      "created_at": "2024-09-26T08:50:37Z",
      "updated_at": "2024-09-26T08:50:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#discussion_r1776654445",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1776654445"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
        }
      },
      "start_line": null,
      "original_start_line": 1639,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1644,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1777604226",
      "pull_request_review_id": 2332133732,
      "id": 1777604226,
      "node_id": "PRRC_kwDOABII585p9BaC",
      "diff_hunk": "@@ -1539,119 +1632,39 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.mempool);\n     assert(!node.chainman);\n \n-    CTxMemPool::Options mempool_opts{\n-        .check_ratio = chainparams.DefaultConsistencyChecks() ? 1 : 0,\n-        .signals = &validation_signals,\n-    };\n-    auto result{ApplyArgsManOptions(args, chainparams, mempool_opts)};\n-    if (!result) {\n-        return InitError(util::ErrorString(result));\n-    }\n-\n     bool do_reindex{args.GetBoolArg(\"-reindex\", false)};\n     const bool do_reindex_chainstate{args.GetBoolArg(\"-reindex-chainstate\", false)};\n \n-    for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        bilingual_str mempool_error;\n-        node.mempool = std::make_unique<CTxMemPool>(mempool_opts, mempool_error);\n-        if (!mempool_error.empty()) {\n-            return InitError(mempool_error);\n-        }\n-        LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));\n-\n-        try {\n-            node.chainman = std::make_unique<ChainstateManager>(*Assert(node.shutdown), chainman_opts, blockman_opts);\n-        } catch (std::exception& e) {\n-            return InitError(strprintf(Untranslated(\"Failed to initialize ChainstateManager: %s\"), e.what()));\n-        }\n-        ChainstateManager& chainman = *node.chainman;\n-\n-        // This is defined and set here instead of inline in validation.h to avoid a hard\n-        // dependency between validation and index/base, since the latter is not in\n-        // libbitcoinkernel.\n-        chainman.snapshot_download_completed = [&node]() {\n-            if (!node.chainman->m_blockman.IsPruneMode()) {\n-                LogPrintf(\"[snapshot] re-enabling NODE_NETWORK services\\n\");\n-                node.connman->AddLocalServices(NODE_NETWORK);\n-            }\n-\n-            LogPrintf(\"[snapshot] restarting indexes\\n\");\n-\n-            // Drain the validation interface queue to ensure that the old indexes\n-            // don't have any pending work.\n-            Assert(node.validation_signals)->SyncWithValidationInterfaceQueue();\n-\n-            for (auto* index : node.indexes) {\n-                index->Interrupt();\n-                index->Stop();\n-                if (!(index->Init() && index->StartBackgroundSync())) {\n-                    LogPrintf(\"[snapshot] WARNING failed to restart index %s on snapshot chain\\n\", index->GetName());\n-                }\n-            }\n-        };\n-\n-        node::ChainstateLoadOptions options;\n-        options.mempool = Assert(node.mempool.get());\n-        options.wipe_block_tree_db = do_reindex;\n-        options.wipe_chainstate_db = do_reindex || do_reindex_chainstate;\n-        options.prune = chainman.m_blockman.IsPruneMode();\n-        options.check_blocks = args.GetIntArg(\"-checkblocks\", DEFAULT_CHECKBLOCKS);\n-        options.check_level = args.GetIntArg(\"-checklevel\", DEFAULT_CHECKLEVEL);\n-        options.require_full_verification = args.IsArgSet(\"-checkblocks\") || args.IsArgSet(\"-checklevel\");\n-        options.coins_error_cb = [] {\n-            uiInterface.ThreadSafeMessageBox(\n-                _(\"Error reading from database, shutting down.\"),\n-                \"\", CClientUIInterface::MSG_ERROR);\n-        };\n-\n-        uiInterface.InitMessage(_(\"Loading block indexâ€¦\").translated);\n-        const auto load_block_index_start_time{SteadyClock::now()};\n-        auto catch_exceptions = [](auto&& f) {\n-            try {\n-                return f();\n-            } catch (const std::exception& e) {\n-                LogError(\"%s\\n\", e.what());\n-                return std::make_tuple(node::ChainstateLoadStatus::FAILURE, _(\"Error opening block database\"));\n-            }\n-        };\n-        auto [status, error] = catch_exceptions([&]{ return LoadChainstate(chainman, cache_sizes, options); });\n-        if (status == node::ChainstateLoadStatus::SUCCESS) {\n-            uiInterface.InitMessage(_(\"Verifying blocksâ€¦\").translated);\n-            if (chainman.m_blockman.m_have_pruned && options.check_blocks > MIN_BLOCKS_TO_KEEP) {\n-                LogWarning(\"pruned datadir may not have more than %d blocks; only checking available blocks\\n\",\n-                                  MIN_BLOCKS_TO_KEEP);\n-            }\n-            std::tie(status, error) = catch_exceptions([&]{ return VerifyLoadedChainstate(chainman, options);});\n-            if (status == node::ChainstateLoadStatus::SUCCESS) {\n-                fLoaded = true;\n-                LogPrintf(\" block index %15dms\\n\", Ticks<std::chrono::milliseconds>(SteadyClock::now() - load_block_index_start_time));\n-            }\n-        }\n-\n-        if (status == node::ChainstateLoadStatus::FAILURE_FATAL || status == node::ChainstateLoadStatus::FAILURE_INCOMPATIBLE_DB || status == node::ChainstateLoadStatus::FAILURE_INSUFFICIENT_DBCACHE) {\n-            return InitError(error);\n+    // Chainstate initialization and loading may be retried once with reindexing by GUI users\n+    auto [status, error] = InitAndLoadChainstate(\n+        node,\n+        do_reindex,\n+        do_reindex_chainstate,\n+        cache_sizes,\n+        args);\n+    if (status == ChainstateLoadStatus::FAILURE && !do_reindex && !ShutdownRequested(node)) {\n+        // suggest a reindex\n+        bool do_retry = uiInterface.ThreadSafeQuestion(\n+            error + Untranslated(\".\\n\\n\") + _(\"Do you want to rebuild the block database now?\"),\n+            error.original + \".\\nPlease restart with -reindex or -reindex-chainstate to recover.\",\n+            \"\", CClientUIInterface::MSG_ERROR | CClientUIInterface::BTN_ABORT);\n+        if (!do_retry) {\n+            LogError(\"Aborted block database rebuild. Exiting.\\n\");\n+            return false;\n         }\n-\n-        if (!fLoaded && !ShutdownRequested(node)) {\n-            // first suggest a reindex\n-            if (!do_reindex) {\n-                bool fRet = uiInterface.ThreadSafeQuestion(\n-                    error + Untranslated(\".\\n\\n\") + _(\"Do you want to rebuild the block database now?\"),\n-                    error.original + \".\\nPlease restart with -reindex or -reindex-chainstate to recover.\",\n-                    \"\", CClientUIInterface::MSG_ERROR | CClientUIInterface::BTN_ABORT);\n-                if (fRet) {\n-                    do_reindex = true;\n-                    if (!Assert(node.shutdown)->reset()) {\n-                        LogError(\"Internal error: failed to reset shutdown signal.\\n\");\n-                    }\n-                } else {\n-                    LogError(\"Aborted block database rebuild. Exiting.\\n\");\n-                    return false;\n-                }\n-            } else {\n-                return InitError(error);\n-            }\n+        do_reindex = true;\n+        if (!Assert(node.shutdown)->reset()) {\n+            LogError(\"Internal error: failed to reset shutdown signal.\\n\");\n         }\n+        std::tie(status, error) = InitAndLoadChainstate(\n+            node,\n+            do_reindex,\n+            do_reindex_chainstate,\n+            cache_sizes,\n+            args);\n+    }\n+    if (status != ChainstateLoadStatus::SUCCESS && status != ChainstateLoadStatus::INTERRUPTED) {\n+        return InitError(error);\n     }\n \n     // As LoadBlockIndex can take several minutes, it's possible the user",
      "path": "src/init.cpp",
      "position": 309,
      "original_position": 309,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "original_commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Unrelated to this pull, the comment is wrong. `Shutdown()` *is* called. So it would be good (in a follow-up), or if you re-touch, to remove the incorrect and confusing comment:\r\n\r\n\r\n```diff\r\ndiff --git a/src/init.cpp b/src/init.cpp\r\nindex ebe48dc307..5f786fd4df 100644\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -1649,7 +1649,6 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n \r\n     // As LoadBlockIndex can take several minutes, it's possible the user\r\n     // requested to kill the GUI during the last operation. If so, exit.\r\n-    // As the program has not fully started yet, Shutdown() is possibly overkill.\r\n     if (ShutdownRequested(node)) {\r\n         LogPrintf(\"Shutdown requested. Exiting.\\n\");\r\n         return false;\r\n",
      "created_at": "2024-09-26T19:03:09Z",
      "updated_at": "2024-09-26T19:03:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#discussion_r1777604226",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1777604226"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1670,
      "original_line": 1670,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1778860008",
      "pull_request_review_id": 2334139707,
      "id": 1778860008,
      "node_id": "PRRC_kwDOABII585qBz_o",
      "diff_hunk": "@@ -1072,6 +1074,13 @@ bool AppInitParameterInteraction(const ArgsManager& args)\n         if (!blockman_result) {\n             return InitError(util::ErrorString(blockman_result));\n         }\n+        CTxMemPool::Options mempool_opts{\n+            .check_ratio = chainparams.DefaultConsistencyChecks() ? 1 : 0,\n+        };",
      "path": "src/init.cpp",
      "position": 28,
      "original_position": 28,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "original_commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is there a reason to set `check_ratio`? It doesn't seem necessary?\r\n\r\n```suggestion\r\n        CTxMemPool::Options mempool_opts{};\r\n```",
      "created_at": "2024-09-27T16:09:52Z",
      "updated_at": "2024-09-27T16:32:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#discussion_r1778860008",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1778860008"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
        }
      },
      "start_line": 1077,
      "original_start_line": 1077,
      "start_side": "RIGHT",
      "line": 1079,
      "original_line": 1079,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1779222847",
      "pull_request_review_id": 2334717617,
      "id": 1779222847,
      "node_id": "PRRC_kwDOABII585qDMk_",
      "diff_hunk": "@@ -1183,6 +1185,104 @@ bool CheckHostPortOptions(const ArgsManager& args) {\n     return true;\n }\n \n+// A GUI user may opt to retry once if there is a failure during chainstate initialization.",
      "path": "src/init.cpp",
      "position": 40,
      "original_position": 26,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "original_commit_id": "c1d8870ea4155c2766d30d38fc5b1afc63dcd364",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: might use \"retry with do_reindex set\". Otherwise it might sounds a bit like \"try turning it off and on again\".",
      "created_at": "2024-09-27T21:59:18Z",
      "updated_at": "2024-09-27T22:20:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#discussion_r1779222847",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1779222847"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1188,
      "original_line": 1188,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1779260055",
      "pull_request_review_id": 2334717617,
      "id": 1779260055,
      "node_id": "PRRC_kwDOABII585qDVqX",
      "diff_hunk": "@@ -1635,42 +1635,36 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     bool do_reindex{args.GetBoolArg(\"-reindex\", false)};\n     const bool do_reindex_chainstate{args.GetBoolArg(\"-reindex-chainstate\", false)};\n \n-    for (bool fLoaded = false; !fLoaded && !ShutdownRequested(node);) {\n-        auto [status, error] = InitAndLoadChainstate(\n+    // Chainstate initialization and loading may be retried once with reindexing by GUI users\n+    auto [status, error] = InitAndLoadChainstate(\n+        node,\n+        do_reindex,\n+        do_reindex_chainstate,\n+        cache_sizes,\n+        args);\n+    if (status == ChainstateLoadStatus::FAILURE && !do_reindex && !ShutdownRequested(node)) {\n+        // suggest a reindex\n+        bool do_retry = uiInterface.ThreadSafeQuestion(\n+            error + Untranslated(\".\\n\\n\") + _(\"Do you want to rebuild the block database now?\"),\n+            error.original + \".\\nPlease restart with -reindex or -reindex-chainstate to recover.\",\n+            \"\", CClientUIInterface::MSG_ERROR | CClientUIInterface::BTN_ABORT);\n+        if (!do_retry) {\n+            LogError(\"Aborted block database rebuild. Exiting.\\n\");",
      "path": "src/init.cpp",
      "position": 20,
      "original_position": 20,
      "commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "original_commit_id": "e9d60af9889c12b4d427adefa53fd234e417f8f6",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This log error is also shown in the non-GUI case, where it doesn't make any sense because the user didn't get the option to rebuild the block database. Also, to be pedantic, it's misleading in the GUI because we didn't abort a rebuild, but aborted instead of trying it. Maybe it's not necessary at all?",
      "created_at": "2024-09-27T22:16:34Z",
      "updated_at": "2024-09-27T22:20:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30968#discussion_r1779260055",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1779260055"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30968"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1652,
      "original_line": 1652,
      "side": "RIGHT"
    }
  ]
}