{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736",
    "id": 715062329,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NzE1MDYyMzI5",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22736",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/22736.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/22736.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/7e698732836121912f179b7c743a72dd6fdffa72",
    "number": 22736,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "log, sync: change lock contention from preprocessor directive to log category",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "To enable lock contention logging, `DEBUG_LOCKCONTENTION` has to be defined at compilation. Once built, the logging is not limited to a category and is high frequency, verbose and in all-caps. With these factors combined, it seems likely to be rarely used.\r\n\r\nThis patch:\r\n- adds a `lock` logging category\r\n- adds a timing macro in microseconds, `LOG_TIME_MICROS_WITH_CATEGORY`\r\n- updates `BCLog::LogMsg()` to omit irrelevant decimals for microseconds and skip unneeded code and math\r\n- improves the lock contention logging, drops the all-caps, and displays the duration in microseconds\r\n- removes the conditional compilation directives\r\n- allows lock contentions to be logged on startup with `-debug=lock` or at run time with `bitcoin-cli logging '[\"lock\"]'`\r\n\r\n```\r\n$ bitcoind -signet -debug=lock\r\n2021-09-01T12:40:01Z LockContention: cs_vNodes, net.cpp:1920 started\r\n2021-09-01T12:40:01Z LockContention: cs_vNodes, net.cpp:1920 completed (4μs)\r\n2021-09-01T12:40:01Z LockContention: cs_vNodes, net.cpp:1302 started\r\n2021-09-01T12:40:01Z LockContention: cs_vNodes, net.cpp:1302 completed (4μs)\r\n2021-09-01T12:40:02Z LockContention: cs_vNodes, net.cpp:2242 started\r\n2021-09-01T12:40:02Z LockContention: cs_vNodes, net.cpp:2242 completed (20μs)\r\n2021-09-01T12:43:04Z LockContention: ::cs_main, validation.cpp:4980 started\r\n2021-09-01T12:43:04Z LockContention: ::cs_main, validation.cpp:4980 completed (3μs)\r\n\r\n$ bitcoin-cli -signet logging\r\n  \"lock\": true,\r\n\r\n$ bitcoin-cli -signet logging [] '[\"lock\"]'\r\n  \"lock\": false,\r\n\r\n$ bitcoin-cli -signet logging '[\"lock\"]'\r\n  \"lock\": true,\r\n```\r\n\r\nI've tested this with Clang 13 and GCC 10.2.1, on Debian, with and without `--enable-debug`.",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2021-08-18T13:05:38Z",
    "updated_at": "2022-09-06T23:16:13Z",
    "closed_at": "2021-09-06T08:32:41Z",
    "mergeable_state": "unknown",
    "merged_at": "2021-09-06T08:32:41Z",
    "merge_commit_sha": "fa92777448239f52fb04579304095bd34c4d2bf8",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "jonatack:lockcontention-log-instead-of-define",
      "ref": "lockcontention-log-instead-of-define",
      "sha": "7e698732836121912f179b7c743a72dd6fdffa72",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 173103842,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNzMxMDM4NDI=",
        "name": "bitcoin",
        "full_name": "jonatack/bitcoin",
        "owner": {
          "login": "jonatack",
          "id": 2415484,
          "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/jonatack",
          "html_url": "https://github.com/jonatack",
          "followers_url": "https://api.github.com/users/jonatack/followers",
          "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
          "organizations_url": "https://api.github.com/users/jonatack/orgs",
          "repos_url": "https://api.github.com/users/jonatack/repos",
          "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/jonatack/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/jonatack/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/jonatack/bitcoin",
        "archive_url": "https://api.github.com/repos/jonatack/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/jonatack/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/jonatack/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/jonatack/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/jonatack/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/jonatack/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/jonatack/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/jonatack/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/jonatack/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/jonatack/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/jonatack/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/jonatack/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/jonatack/bitcoin/events",
        "forks_url": "https://api.github.com/repos/jonatack/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/jonatack/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/jonatack/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/jonatack/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/jonatack/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/jonatack/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/jonatack/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/jonatack/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/jonatack/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/jonatack/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/jonatack/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/jonatack/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/jonatack/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/jonatack/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/jonatack/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/jonatack/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:jonatack/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/jonatack/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/jonatack/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/jonatack/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/jonatack/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/jonatack/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/jonatack/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/jonatack/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/jonatack/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/jonatack/bitcoin/hooks",
        "svn_url": "https://github.com/jonatack/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 217428,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-05-31T14:39:25Z",
        "created_at": "2019-02-28T11:57:18Z",
        "updated_at": "2023-01-03T22:00:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "b3a2b8c29fda5d924726d3087535bd34af7012b6",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34348,
        "stargazers_count": 69855,
        "watchers_count": 69855,
        "size": 234261,
        "default_branch": "master",
        "open_issues_count": 631,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-09T10:08:42Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-09T10:24:12Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 22,
    "deletions": 26,
    "changed_files": 7,
    "commits": 4,
    "review_comments": 17,
    "comments": 25
  },
  "events": [
    {
      "event": "convert_to_draft",
      "id": 5175084536,
      "node_id": "MDE5OkNvbnZlcnRUb0RyYWZ0RXZlbnQ1MTc1MDg0NTM2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5175084536",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-18T14:05:31Z"
    },
    {
      "event": "reviewed",
      "id": 732919180,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzMyOTE5MTgw",
      "url": null,
      "actor": null,
      "commit_id": "6f6abbe7d735b5a2622df9b5c971cccbca93b886",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-732919180",
      "submitted_at": "2021-08-18T14:11:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "labeled",
      "id": 5175310832,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDUxNzUzMTA4MzI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5175310832",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-18T14:40:39Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiN2ExNzQ0NGUwNzQ2YzU2MmFlOTdiMjZlYmE0MzE1Nzc5NDdiMDZh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b7a17444e0746c562ae97b26eba431577947b06a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b7a17444e0746c562ae97b26eba431577947b06a",
      "tree": {
        "sha": "b2995987513a07c104ebf9944da9a5ee91892dd4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b2995987513a07c104ebf9944da9a5ee91892dd4"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b2995987513a07c104ebf9944da9a5ee91892dd4\nparent bb9f76a7194a665effab169d228bb8cbc66ccf86\nauthor Jon Atack <jon@atack.com> 1629282576 +0200\ncommitter Jon Atack <jon@atack.com> 1629309435 +0200\n\nlog, sync: add LOCK logging category, apply it to lock contention\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmEdSiwACgkQT1chs9Dj\nkh3lNBAAhExvtK/n879XCRp0Cct2p50OZzQHZjbbyWqQfTpK3w9X6tznxClnwQV0\naBkn9ktcF6a0NN4Ud9SHj0m1PKXxqfqB7IMFWHkA0VA5mwPcIDTHoMj28Wcsqxhv\nFSpuKC5yCRo2xjG1XNuBkA3TYxDz6JfvAEVpV8FruMf6GL/dOp40D+XvY+blYLok\nLevcvUyO5WHUkYsb0+BpCGP6ihcTP+r49MSf3fgnna7Se5nVMe6NogHYUmWuqLrX\ndXZRZDunVBwzqpgq8MKpCoZF6o0c8JvyOSWqvvGVBj81DIV1atyQNQnuC8J9BF/G\noCwUfR4/wwqzb/bK3tC9cyy9qhI08UIXtEztEObscqwvBIV577pVNDcP05M74OKP\n/C6nqsnOq5GcuuSc0zTvp75JwfOETEk5N/UEvJ8ctQRn8ZbMPQL573tNI6ckkXWU\nMw/E7e8RBPGROwpgII3F9/y77WG2pYS/r4Hfm+S1Lako8whgiHBBz6UcTMD69E1b\nNvdr49MvRV6jEdnjrsFFqhK64emoSR0mlreJdVxRzcHyUG3Gg6UmwYCf6HwHz7PW\nTIC7Ax84/xMhrn1yfMEidJifZnW7aRAeyc0lGz7purBxrkoo6AvyPe84dIla/GQ9\nESrdTo6CDRjXrw/HfBGBbsCipnHMo7WhIe5uJqLAlW2oHI+XF5Q=\n=WzQz\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIDnULFRLYtQiDymooa47z6ZUBAf5RBvUl81u1tGEEJq7CP/wEDeGUEfFryJ3\nvJ7JH6mP+0UI8CBB/mA9VvBE9uA7vEnzcQySjlRggdYhX0sfLZaugInZfQjwIEdV\nfCUpeY3lgJs45n06yZpu9YIC9GeD0G8vDozehJ6oCPAgdWZmm4IzwQJn1fSdvwtz\n+FuLcR3JJD3H09+19F31QXsI8QRhHUov8AhM9tqts8+CrQCD3+MNLvkMjikoaHR0\ncHM6Ly9maW5uZXkuY2FsZW5kYXIuZXRlcm5pdHl3YWxsLmNvbf/wEEm5m2KFLlCM\nRwCKA0fFOZMI8CCq3/4YGYVd3yZSfujNHEVVDWFva6nWVvM1jV3xyuDEHQjwIGYM\nclDZU01ETnSNcF9Mxcrknx+ukJ3MlUQwzj1iY7nDCPAgHFhbPxGQxM84x3aKLaJh\n95MxIM1UC1RUqQchnoF7qsYI8QRhHUou8Ahnbh9T1MCrwgCD3+MNLvkMjiwraHR0\ncHM6Ly9ib2IuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZ//wEEqxClYc\nXbKIb4WmQYevDRAI8QRhHUou8AgauXdro5/0ogCD3+MNLvkMjiMiaHR0cHM6Ly9i\ndGMuY2FsZW5kYXIuY2F0YWxsYXh5LmNvbfAQrWhmKHonhiT0jwDiddoQTgjwIEIv\nsndMzm5526zFv3ayjiQO9UXfdIwhtRVMpmXl1IAgCPAg92+7NtueqlLlJDtk1PuL\nllPS7gcRw2t3W3O5Zm1VOZ0I8CBSrHlBJ8nJqVXnrNfUko4EqjX6WJ9sKcneSS+C\nndlljQjxBGEdSi7wCB7D+a8nYuoOAIPf4w0u+QyOLi1odHRwczovL2FsaWNlLmJ0\nYy5jYWxlbmRhci5vcGVudGltZXN0YW1wcy5vcmc=\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bb9f76a7194a665effab169d228bb8cbc66ccf86",
          "sha": "bb9f76a7194a665effab169d228bb8cbc66ccf86",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bb9f76a7194a665effab169d228bb8cbc66ccf86"
        }
      ],
      "message": "log, sync: add LOCK logging category, apply it to lock contention",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-08-18T17:57:15Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-08-18T10:29:36Z"
      },
      "sha": "b7a17444e0746c562ae97b26eba431577947b06a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5176376930,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTE3NjM3NjkzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5176376930",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-18T18:02:30Z"
    },
    {
      "event": "commented",
      "id": 901400935,
      "node_id": "IC_kwDOABII5841ukln",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901400935",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-18T20:15:15Z",
      "updated_at": "2021-08-18T20:15:15Z",
      "author_association": "MEMBER",
      "body": "Moving this out of draft now, ready for review.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-901400935",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "ready_for_review",
      "id": 5176956012,
      "node_id": "MDE5OlJlYWR5Rm9yUmV2aWV3RXZlbnQ1MTc2OTU2MDEy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5176956012",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-18T20:15:18Z"
    },
    {
      "event": "commented",
      "id": 901721006,
      "node_id": "IC_kwDOABII5841vyuu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901721006",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-19T08:35:27Z",
      "updated_at": "2021-08-19T08:35:27Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#20487](https://github.com/bitcoin/bitcoin/pull/20487) (Add syscall sandboxing using seccomp-bpf (Linux secure computing mode) by practicalswift)\n* [#16365](https://github.com/bitcoin/bitcoin/pull/16365) (Log RPC parameters (arguments) if -debug=rpcparams by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-901721006",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 901980815,
      "node_id": "IC_kwDOABII5841wyKP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901980815",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-19T14:50:46Z",
      "updated_at": "2021-08-19T14:50:46Z",
      "author_association": "MEMBER",
      "body": "Code review ACK ccd73de1dd969097d34634c2be2fc32b03fbd09e",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-901980815",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "reviewed",
      "id": 734334313,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzM0MzM0MzEz",
      "url": null,
      "actor": null,
      "commit_id": "ccd73de1dd969097d34634c2be2fc32b03fbd09e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "cr ACK ccd73de1dd969097d34634c2be2fc32b03fbd09e",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-734334313",
      "submitted_at": "2021-08-19T18:37:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "commented",
      "id": 902262386,
      "node_id": "IC_kwDOABII5841x25y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902262386",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-19T21:32:09Z",
      "updated_at": "2021-08-19T21:32:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nNice idea. I've used something similar in my local tree when analysing lock contention locally.\r\n\r\nNon-blocking suggestions:\r\n* In my version I printed the duration too to make it clear from the log entry if the lock contention was significant or not. Perhaps worth adding here too?\r\n* In addition to `__FILE__` and `__LINE__` it would be nice to have `__FUNCTION__` printed as part of the log message too.\r\n\r\nTo rule out any accidental performance regressions: would it be possible to benchmark before vs after this PR (with and without `-debug=lock`) in some intelligent way?\r\n\r\n",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-902262386",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5183997001,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTE4Mzk5NzAwMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5183997001",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-19T23:11:49Z"
    },
    {
      "event": "commented",
      "id": 902315324,
      "node_id": "IC_kwDOABII5841yD08",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902315324",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-19T23:20:40Z",
      "updated_at": "2021-08-20T10:05:58Z",
      "author_association": "MEMBER",
      "body": "> In my version I printed the duration too to make it clear from the log entry if the lock contention was significant or not. Perhaps worth adding here too?\r\n> \r\n> In addition to `__FILE__` and `__LINE__` it would be nice to have `__FUNCTION__` printed as part of the log message too.\r\n\r\nI think I'd need your help (propose a commit to pull in?) or you could do it as a follow-up.\r\n \r\n> To rule out any accidental performance regressions: would it be possible to benchmark before vs after this PR (with and without `-debug=lock`) in some intelligent way?\r\n\r\nI'll look.  Without `-debug=lock` it should be the same, and I'm not sure anyone besides developers would use the lock logging; it's still fairly verbose. In the worst case I suppose we could add a warning in the RPC logging help.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-902315324",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 902316418,
      "node_id": "IC_kwDOABII5841yEGC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902316418",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-19T23:23:37Z",
      "updated_at": "2021-08-19T23:23:37Z",
      "author_association": "MEMBER",
      "body": "@laanwj: following up on our IRC convo in `#bitcoin-core-builds`, as a test just pushed a version with the `HAVE_THREAD_LOCAL` conditional compilation directives removed to see what happens...",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-902316418",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "mentioned",
      "id": 5184026463,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTE4NDAyNjQ2Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5184026463",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-19T23:23:37Z"
    },
    {
      "event": "subscribed",
      "id": 5184026468,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUxODQwMjY0Njg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5184026468",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-19T23:23:37Z"
    },
    {
      "event": "commented",
      "id": 902567823,
      "node_id": "IC_kwDOABII5841zBeP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902567823",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-20T09:35:57Z",
      "updated_at": "2021-08-22T17:03:32Z",
      "author_association": "MEMBER",
      "body": "To-do:\r\n- <strike>add a smoke test with -debug=lock</strike>\r\n- <strike>do some invocation frequency checks and research</strike>\r\n- try benchmarking Mutex::UniqueLock `lock()` versus `try_lock()` and the overhead of `LogAcceptCategory(BCLog::LOCK)`, which evaluates to `m_categories.load(std::memory_order_relaxed) & category) != 0`",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-902567823",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 902594037,
      "node_id": "IC_kwDOABII5841zH31",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902594037",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-20T10:22:09Z",
      "updated_at": "2021-08-20T10:22:09Z",
      "author_association": "MEMBER",
      "body": "> add a smoke test with -debug=lock\r\n\r\nShouldn't this be enabled in the functional test already by default?",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-902594037",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 902672708,
      "node_id": "IC_kwDOABII5841zbFE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902672708",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-20T12:55:25Z",
      "updated_at": "2021-08-20T12:55:25Z",
      "author_association": "MEMBER",
      "body": "> Shouldn't this be enabled in the functional test already by default?\r\n\r\nYou're right, TIL.  I was thinking of adding something like this assertion but probably not worth it or reliable enough:\r\n\r\n```python3\r\n        with node.assert_debug_log(expected_msgs=[\"Lock contention: cs_main\"]):\r\n            node.generate(COINBASE_MATURITY)\r\n```\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-902672708",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 902815225,
      "node_id": "IC_kwDOABII5841z935",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902815225",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-20T16:33:26Z",
      "updated_at": "2021-08-20T16:33:26Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-902815225",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 902851054,
      "node_id": "IC_kwDOABII58410Gnu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902851054",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-20T17:38:09Z",
      "updated_at": "2021-08-20T22:33:20Z",
      "author_association": "MEMBER",
      "body": "Observations\r\n\r\n- `void Mutex::UniqueLock::lock()` acquires the mutex and blocks until it gains access to it\r\n\r\n- `bool Mutex::UniqueLock::try_lock()` doesn't block but instead immediately returns whether it acquired the mutex; it may be used by `lock()` internally as part of the deadlock-avoidance algorithm\r\n\r\n- IIUC the test-and-set logic of these calls is ~constant time, optimised and light/quick if used carefully (i.e. no mutex convoying), compared to system calls, memory/cache coherency and fences, wait queues, lock contentions\r\n\r\n- added the following patch and tested a regular, non-debug clang 13 build of bitcoind synced on mainnet\r\n```diff\r\n        if (LogAcceptCategory(BCLog::LOCK)) {\r\n             if (!Base::try_lock()) {\r\n                 LogPrintf(\"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\r\n                 Base::lock();\r\n+            } else {\r\n+                LogPrintf(\"No lock contention\\n\");\r\n             }\r\n```\r\n \r\n- with this, I'm seeing `src/sync.h::UniqueLock::Enter()` invoked 2500-5000 times per minute, sampled roughly an hour after startup\r\n\r\n- of those, `try_lock()` returns true 99.26% to 99.91% of the time. In the true case the lock logging should have essentially the same performance as when the lock logging is off\r\n\r\n- thus 0.09% to 0.74% of the time `try_lock()` returns false, the contention is logged and `lock()` is then called, in which case the additional overhead compared to `lock()` alone, if any (~depending on how long the mutex was blocked), is of trying the lock and initially returning false\r\n\r\n- Overall, lock contention seems to be relatively infrequent as a percentage of locks. I'm seeing a few per minute. The most common one I see is `cs_vNodes` in `net.cpp::2242/2277::ThreadMessageHandler`.\r\n\r\nEdit: recalculated the numbers and updated.\r\n\r\nSome resources:\r\n- https://preshing.com/20111118/locks-arent-slow-lock-contention-is/\r\n- https://travisdowns.github.io/blog/2020/07/06/concurrency-costs.html\r\n- https://probablydance.com/2019/12/30/measuring-mutexes-spinlocks-and-how-bad-the-linux-scheduler-really-is/\r\n- https://stackoverflow.com/questions/3652056/how-efficient-is-locking-an-unlocked-mutex-what-is-the-cost-of-a-mutex\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-902851054",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "reviewed",
      "id": 743284394,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQzMjg0Mzk0",
      "url": null,
      "actor": null,
      "commit_id": "6e7b6bfee377cdb1ea700af8084b08f79cbe5ee5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code-review ACK 6e7b6bfee377cdb1ea700af8084b08f79cbe5ee5",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-743284394",
      "submitted_at": "2021-08-31T23:53:26Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "commented",
      "id": 910035766,
      "node_id": "IC_kwDOABII5842Pgs2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910035766",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T07:57:14Z",
      "updated_at": "2021-09-01T07:57:14Z",
      "author_association": "MEMBER",
      "body": "Concept ACK.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910035766",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "reviewed",
      "id": 743622555,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQzNjIyNTU1",
      "url": null,
      "actor": null,
      "commit_id": "6e7b6bfee377cdb1ea700af8084b08f79cbe5ee5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-743622555",
      "submitted_at": "2021-09-01T08:19:06Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "commented",
      "id": 910063200,
      "node_id": "IC_kwDOABII5842PnZg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910063200",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T08:31:22Z",
      "updated_at": "2021-09-01T08:32:07Z",
      "author_association": "MEMBER",
      "body": ">     * benchmarking ... the overhead of `LogAcceptCategory(BCLog::LOCK)`, which evaluates to `m_categories.load(std::memory_order_relaxed) & category) != 0`\r\n\r\nI think the benchmarking results could depend on a platform.\r\n\r\nCould we sacrifice the ability to turn \"lock\" debugging on/off at runtime, and use just a const?\r\n\r\n",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910063200",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 910102088,
      "node_id": "IC_kwDOABII5842Pw5I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910102088",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:23:36Z",
      "updated_at": "2021-09-01T09:23:36Z",
      "author_association": "MEMBER",
      "body": "> Could we sacrifice the ability to turn \"lock\" debugging on/off at runtime, and use just a const?\r\n\r\nI could be wrong, and this goes way beyond my competence, but readings suggest that these options are low-level, fast, and near constant time compared to system calls, memory/cache coherency and fences, wait queues and (particularly) lock contentions.  (Would a difference be apparent in, say, https://bitcoinperf.com? I don't know, but if this helps us reduce contentions, that may be a win. @jamesob, @0xB10C, @martinus thoughts?)",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910102088",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "mentioned",
      "id": 5238214008,
      "node_id": "MEE_lADOABII5846CKiJzwAAAAE4OM14",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238214008",
      "actor": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:23:36Z"
    },
    {
      "event": "subscribed",
      "id": 5238214012,
      "node_id": "SE_lADOABII5846CKiJzwAAAAE4OM18",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238214012",
      "actor": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:23:36Z"
    },
    {
      "event": "mentioned",
      "id": 5238214018,
      "node_id": "MEE_lADOABII5846CKiJzwAAAAE4OM2C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238214018",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:23:36Z"
    },
    {
      "event": "subscribed",
      "id": 5238214026,
      "node_id": "SE_lADOABII5846CKiJzwAAAAE4OM2K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238214026",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:23:36Z"
    },
    {
      "event": "mentioned",
      "id": 5238214031,
      "node_id": "MEE_lADOABII5846CKiJzwAAAAE4OM2P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238214031",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:23:36Z"
    },
    {
      "event": "subscribed",
      "id": 5238214033,
      "node_id": "SE_lADOABII5846CKiJzwAAAAE4OM2R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238214033",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:23:36Z"
    },
    {
      "event": "commented",
      "id": 910102353,
      "node_id": "IC_kwDOABII5842Pw9R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910102353",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:23:55Z",
      "updated_at": "2021-09-01T09:23:55Z",
      "author_association": "MEMBER",
      "body": "> > Could we sacrifice the ability to turn \"lock\" debugging on/off at runtime, and use just a const?\r\n> \r\n> I could be wrong, and this goes way beyond my competence, but readings suggest that these options are low-level, fast, and near constant time compared to system calls, memory/cache coherency and fences, wait queues and (particularly) lock contentions. Would a difference be apparent in, say, https://bitcoinperf.com? I don't know, but if this helps us reduce contentions, that may be a win.\r\n\r\nAnd `m_categories.load(std::memory_order_relaxed)` could cause cache lines switching, no?",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910102353",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 910110140,
      "node_id": "IC_kwDOABII5842Py28",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910110140",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:33:23Z",
      "updated_at": "2021-09-01T09:36:41Z",
      "author_association": "MEMBER",
      "body": "> And `m_categories.load(std::memory_order_relaxed)` could cause cache lines switching, no?\r\n\r\nAlternative version:\r\n```cpp\r\n    void Enter(const char* pszName, const char* pszFile, int nLine)\r\n    {\r\n        EnterCritical(pszName, pszFile, nLine, Base::mutex());\r\n        if (Base::try_lock()) return;\r\n        Base::lock();\r\n        LogPrint(BCLog::LOCK, \"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\r\n    }\r\n```\r\n\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910110140",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 910114980,
      "node_id": "IC_kwDOABII5842P0Ck",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910114980",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T09:40:20Z",
      "updated_at": "2021-09-01T09:54:35Z",
      "author_association": "MEMBER",
      "body": "> > And `m_categories.load(std::memory_order_relaxed)` could cause cache lines switching, no?\r\n> \r\n> Alternative version:\r\n> \r\n> ```c++\r\n>     void Enter(const char* pszName, const char* pszFile, int nLine)\r\n>     {\r\n>         EnterCritical(pszName, pszFile, nLine, Base::mutex());\r\n>         if (Base::try_lock()) return;\r\n>         Base::lock();\r\n>         LogPrint(BCLog::LOCK, \"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\r\n>     }\r\n> ```\r\n\r\nNice!\r\n\r\nMaybe put logging before the blocking call `Base::lock();` as it is now? The `LogPrint` call takes some time, and it could increase probability of releasing a mutex by another thread before the `Base::lock()` call.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910114980",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 910149515,
      "node_id": "IC_kwDOABII5842P8eL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910149515",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T10:25:50Z",
      "updated_at": "2021-09-01T10:25:50Z",
      "author_association": "MEMBER",
      "body": "> And `m_categories.load(std::memory_order_relaxed)` could cause cache lines switching, no?\r\n\r\nI don't know.\r\n\r\n> Maybe put logging before the blocking call `Base::lock();` as it is now? The `LogPrint` call takes some time, and it could increase probability of releasing a mutex by another thread before the `Base::lock()` call.\r\n\r\nSeems like a good idea--done.\r\n\r\n\r\n\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910149515",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5238576654,
      "node_id": "HRFPE_lADOABII5846CKiJzwAAAAE4PlYO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238576654",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T10:26:20Z"
    },
    {
      "event": "reviewed",
      "id": 743764606,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQzNzY0NjA2",
      "url": null,
      "actor": null,
      "commit_id": "df149f89dcd0c457c61d463e36c057bb064783b8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK df149f89dcd0c457c61d463e36c057bb064783b8, tested on Linux Mint 20.2 (x86_64).\r\n\r\n> > In my version I printed the duration too to make it clear from the log entry if the lock contention was significant or not. Perhaps worth adding here too?\r\n> \r\n> I think I'd need your help (propose a commit to pull in?) or you could do it as a follow-up.\r\n\r\n```diff\r\n--- a/src/sync.h\r\n+++ b/src/sync.h\r\n@@ -7,6 +7,7 @@\r\n #define BITCOIN_SYNC_H\r\n \r\n #include <logging.h>\r\n+#include <logging/timer.h>\r\n #include <threadsafety.h>\r\n #include <util/macros.h>\r\n \r\n@@ -136,7 +137,7 @@ private:\r\n     {\r\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\r\n         if (Base::try_lock()) return;\r\n-        LogPrint(BCLog::LOCK, \"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\r\n+        LOG_TIME_MILLIS_WITH_CATEGORY(strprintf(\"Lock contention: %s, %s:%d\", pszName, pszFile, nLine), BCLog::LOCK);\r\n         Base::lock();\r\n     }\r\n \r\n```\r\n\r\nas a follow up?\r\n",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-743764606",
      "submitted_at": "2021-09-01T10:41:49Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "commented",
      "id": 910162337,
      "node_id": "IC_kwDOABII5842P_mh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910162337",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T10:46:05Z",
      "updated_at": "2021-09-01T10:46:05Z",
      "author_association": "MEMBER",
      "body": "> as a follow up?\r\n\r\nThanks--was about to re-push to drop the third commit. Will try your suggestion before re-pushing.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910162337",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 910163668,
      "node_id": "IC_kwDOABII5842P_7U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910163668",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T10:48:13Z",
      "updated_at": "2021-09-01T10:48:13Z",
      "author_association": "MEMBER",
      "body": "> > as a follow up?\r\n> \r\n> Thanks--was about to re-push to drop the third commit. Will try your suggestion before re-pushing.\r\n\r\nMy only concerns are about wording -- \"Enter: Lock contention: cs_vNodes, net.cpp:2242 completed (0.07ms)\" -- \"contention completed\"?",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910163668",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 910176459,
      "node_id": "IC_kwDOABII5842QDDL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910176459",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T11:06:42Z",
      "updated_at": "2021-09-01T11:39:26Z",
      "author_association": "MEMBER",
      "body": "> My only concerns are about wording -- \"Enter: Lock contention: cs_vNodes, net.cpp:2242 completed (0.07ms)\" -- \"contention completed\"?\r\n\r\nI'm seeing the following (all of the times are 0.00ms or 0.01ms so far, and seems I should remove \"PrintLockContention\" or \"Lock Contention\" from the log output now)\r\n```\r\n2021-09-01T11:03:59Z PrintLockContention: Lock contention: cs_main, net_processing.cpp:1476 started\r\n2021-09-01T11:03:59Z PrintLockContention: Lock contention: cs_main, net_processing.cpp:1476 completed (0.00ms)\r\n2021-09-01T11:03:59Z PrintLockContention: Lock contention: cs_vNodes, net.cpp:2242 started\r\n2021-09-01T11:03:59Z PrintLockContention: Lock contention: cs_vNodes, net.cpp:2242 completed (0.01ms)\r\n```\r\n\r\n`timer.h::LOG_TIME_MILLIS_WITH_CATEGORY` times the execution of the whole Enter() function, the placement of `Base::lock();` doesn't matter for it?",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910176459",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "comment_deleted",
      "id": 5238821911,
      "node_id": "CDE_lADOABII5846CKiJzwAAAAE4QhQX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238821911",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T11:13:15Z"
    },
    {
      "event": "comment_deleted",
      "id": 5238829924,
      "node_id": "CDE_lADOABII5846CKiJzwAAAAE4QjNk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5238829924",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T11:14:43Z"
    },
    {
      "event": "commented",
      "id": 910198774,
      "node_id": "IC_kwDOABII5842QIf2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910198774",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T11:34:29Z",
      "updated_at": "2021-09-01T12:59:19Z",
      "author_association": "MEMBER",
      "body": "<details><summary>How about microseconds?</summary><p>\r\n\r\n```diff\r\ndiff --git a/src/logging/timer.h b/src/logging/timer.h\r\nindex 159920e397..cadfe395ee 100644\r\n--- a/src/logging/timer.h\r\n+++ b/src/logging/timer.h\r\n@@ -93,6 +93,8 @@ private:\r\n } // namespace BCLog\r\n \r\n \r\n+#define LOG_TIME_MICROS_WITH_CATEGORY(end_msg, log_category) \\\r\n+    BCLog::Timer<std::chrono::microseconds> PASTE2(logging_timer, __COUNTER__)(__func__, end_msg, log_category)\r\n #define LOG_TIME_MILLIS_WITH_CATEGORY(end_msg, log_category) \\\r\n     BCLog::Timer<std::chrono::milliseconds> PASTE2(logging_timer, __COUNTER__)(__func__, end_msg, log_category)\r\n #define LOG_TIME_SECONDS(end_msg) \\\r\ndiff --git a/src/sync.cpp b/src/sync.cpp\r\nindex a7b63ea986..eace86d9dd 100644\r\n--- a/src/sync.cpp\r\n+++ b/src/sync.cpp\r\n@@ -24,9 +24,9 @@\r\n #include <utility>\r\n #include <vector>\r\n \r\n-void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\r\n+void LockContention(const char* pszName, const char* pszFile, int nLine)\r\n {\r\n-    LOG_TIME_MILLIS_WITH_CATEGORY(strprintf(\"%s, %s:%d\", pszName, pszFile, nLine), BCLog::LOCK);\r\n+    LOG_TIME_MICROS_WITH_CATEGORY(strprintf(\"%s, %s:%d\", pszName, pszFile, nLine), BCLog::LOCK);\r\n }\r\n \r\n #ifdef DEBUG_LOCKORDER\r\ndiff --git a/src/sync.h b/src/sync.h\r\nindex 252dc95845..0a8ec9e58f 100644\r\n--- a/src/sync.h\r\n+++ b/src/sync.h\r\n@@ -126,7 +126,8 @@ using RecursiveMutex = AnnotatedMixin<std::recursive_mutex>;\r\n /** Wrapped mutex: supports waiting but not recursive locking */\r\n typedef AnnotatedMixin<std::mutex> Mutex;\r\n \r\n-void PrintLockContention(const char* pszName, const char* pszFile, int nLine);\r\n+/** Print a lock contention to the log */\r\n+void LockContention(const char* pszName, const char* pszFile, int nLine);\r\n \r\n /** Wrapper around std::unique_lock style lock for Mutex. */\r\n template <typename Mutex, typename Base = typename Mutex::UniqueLock>\r\n@@ -137,7 +138,7 @@ private:\r\n     {\r\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\r\n         if (Base::try_lock()) return;\r\n-        PrintLockContention(pszName, pszFile, nLine);\r\n+        LockContention(pszName, pszFile, nLine);\r\n         Base::lock();\r\n     }\r\n```\r\n</p></details>\r\n\r\n```\r\n2021-09-01T11:29:03Z LockContention: cs_vNodes, net.cpp:1251 started\r\n2021-09-01T11:29:03Z LockContention: cs_vNodes, net.cpp:1251 completed (5μs)\r\n2021-09-01T11:29:03Z LockContention: pnode->cs_vSend, net.cpp:1373 started\r\n2021-09-01T11:29:03Z LockContention: pnode->cs_vSend, net.cpp:1373 completed (31μs)\r\n2021-09-01T11:29:03Z LockContention: cs_vNodes, net.cpp:2277 started\r\n2021-09-01T11:29:03Z LockContention: cs_vNodes, net.cpp:2277 completed (6μs)\r\n2021-09-01T11:29:04Z LockContention: cs_vNodes, net.cpp:2242 started\r\n2021-09-01T11:29:04Z LockContention: cs_vNodes, net.cpp:2242 completed (3μs)\r\n```\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910198774",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "commented",
      "id": 910206514,
      "node_id": "IC_kwDOABII5842QKYy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910206514",
      "actor": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T11:47:07Z",
      "updated_at": "2021-09-01T11:47:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "> And `m_categories.load(std::memory_order_relaxed)` could cause cache lines switching, no?\r\n\r\nyes, the only guarantee with `memory_order_relaxed` is that the operation itself is atomic, but other operations are allowed to be  shuffled that by the compiler. I personally try to avoid using any of the memory order stuff. It's too easy to get wrong. \r\n\r\nBy the way, I think that in that patch: \r\n\r\n```patch\r\n        if (LogAcceptCategory(BCLog::LOCK)) {\r\n             if (!Base::try_lock()) {\r\n                 LogPrintf(\"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\r\n                 Base::lock();\r\n+            } else {\r\n+                LogPrintf(\"No lock contention\\n\");\r\n             }\r\n```\r\n\r\nIf `Base::try_lock()` fails strictly speaking that does not necessarily mean that there's a lock contention. `std::mutex`'s `try_lock()` can also spuriously fail even when no other thread is currently holding a lock: https://en.cppreference.com/w/cpp/thread/mutex/try_lock I have no idea though how often that can happen.",
      "user": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910206514",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5239227953,
      "node_id": "HRFPE_lADOABII5846CKiJzwAAAAE4SEYx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5239227953",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T12:29:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5239399797,
      "node_id": "HRFPE_lADOABII5846CKiJzwAAAAE4SuV1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5239399797",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T12:59:07Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzozZjRjNmI4N2YxMDk4NDM2NjkzYzQ5OTBmMjA4MjUxNWVjMGVjZTI2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3f4c6b87f1098436693c4990f2082515ec0ece26",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3f4c6b87f1098436693c4990f2082515ec0ece26",
      "tree": {
        "sha": "2b5d15b9d43c63a277ce66b816de1ce397353ee1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2b5d15b9d43c63a277ce66b816de1ce397353ee1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2b5d15b9d43c63a277ce66b816de1ce397353ee1\nparent b7a17444e0746c562ae97b26eba431577947b06a\nauthor Jon Atack <jon@atack.com> 1630497465 +0200\ncommitter Jon Atack <jon@atack.com> 1630501972 +0200\n\nlog, timer: add timing macro in usec LOG_TIME_MICROS_WITH_CATEGORY\n\nand update BCLog::LogMsg() to omit irrelevant decimals for microseconds\nand skip unneeded code and math.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmEvfFQACgkQT1chs9Dj\nkh3Gog/6Ak2rq2lkAHRxUVYsR8+JXmwJOTbLuAv5HYx85PL9plovKUl+a5zwXf6L\np9tSxu81VJk09GdsREq5SWE4wm6qiiLtbiuRSwcPaXyWqIRGCkNjF1iIsUCvmB59\nr9UfnR0cXOUdHLCRwi9wpyUSXe+ocDEy+iJ6yktaQIGXZyNAhM9i58722dwJ+I6a\nIXrmeWv30pJG1g9fPcYZbY0uXngmfR14OcfFTLgMOThJKV9XlggXVd9qRdCRnhTB\nwfKumlC7DcltrCRQsOseGwPIjsH+oZzH7qC+9svchqxDvCTEOi+79gvfkT0EJUfm\n5MM79Wfkfykv65iInE7RpTD83PMRgDs43+zPyX8YavpXZ5iu3i8CJRxdx58t5Mhp\nsY7FgAAomc+qkgPlfJDJ9kMa2hnnhHOSM60kcNdXJfP9gJz28tZMptWohpi4nVvj\ne5FzcYggRlBtHY220LopqH0Z79v5c4S/gd1OW6ZzFX4PNFj4K0xloEyxxP0QXO/T\nvWBlcDvAjjwV9JnUb2HPPiCpjY6HOlixLQJF83J1d0lFS5q0H7X4LWsBobekgx+0\nNrcbYwV3e9MbcleWsb1qxeejoZtq6Th8DSvwnpmA4O98i3tKKbu4Ryplhtx+MH7T\nWdE3N3qnF/9757gAFM47iSbWgF166JEIXfhIEWLPN7hnPNs0Opg=\n=woQy\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIHRg+SnmRVr+MXi8f0kyQYzPE1SudquOd8r2f/YDOGmMCP/wEAdCIBy1Awb/\n/d5f9XacZCII8QRhL3xW8AhmyzrxCZDgUgCD3+MNLvkMjiMiaHR0cHM6Ly9idGMu\nY2FsZW5kYXIuY2F0YWxsYXh5LmNvbf/wEESWEr09UhhDgh+7LhtSe80I8QRhL3xW\n8AjVxMqrfQ4ycQCD3+MNLvkMji4taHR0cHM6Ly9hbGljZS5idGMuY2FsZW5kYXIu\nb3BlbnRpbWVzdGFtcHMub3Jn//AQtOkxTa07whzMmv8gRUCdEwjwIO0fHi9zh/7x\nNWfjGQPcHwa+pqWcYagefTzL1U0dTp83CPAg4Gyhovk1acJskYSrTBHzzgfkM6px\nGSfriRPEwSf3RxoI8QRhL3xX8Ag6oPj0O/5cCwCD3+MNLvkMjikoaHR0cHM6Ly9m\naW5uZXkuY2FsZW5kYXIuZXRlcm5pdHl3YWxsLmNvbfAQ+Ddso0FEqMY9HZG3QHXG\nQgjxIAsmiO2aldzjqMGjWMU5kVumRW6ix1h8A/SE+AFU7/M1CPEEYS98VvAI9tSl\nZ/2QyFcAg9/jDS75DI4sK2h0dHBzOi8vYm9iLmJ0Yy5jYWxlbmRhci5vcGVudGlt\nZXN0YW1wcy5vcmc=\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b7a17444e0746c562ae97b26eba431577947b06a",
          "sha": "b7a17444e0746c562ae97b26eba431577947b06a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b7a17444e0746c562ae97b26eba431577947b06a"
        }
      ],
      "message": "log, timer: add timing macro in usec LOG_TIME_MICROS_WITH_CATEGORY\n\nand update BCLog::LogMsg() to omit irrelevant decimals for microseconds\nand skip unneeded code and math.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-09-01T13:12:52Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-09-01T11:57:45Z"
      },
      "sha": "3f4c6b87f1098436693c4990f2082515ec0ece26"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5239505610,
      "node_id": "HRFPE_lADOABII5846CKiJzwAAAAE4TILK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5239505610",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T13:15:02Z"
    },
    {
      "event": "commented",
      "id": 910280351,
      "node_id": "IC_kwDOABII5842Qcaf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910280351",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T13:21:24Z",
      "updated_at": "2021-09-01T14:51:20Z",
      "author_association": "MEMBER",
      "body": "Thanks for the ideas and feedback. Updates:\r\n\r\n- added a timing macro in microseconds, `LOG_TIME_MICROS_WITH_CATEGORY`\r\n- improved `BCLog::LogMsg()` to omit irrelevant decimals for microseconds and skip unnecessary code/math\r\n- added time duration in microseconds to the lock contention logging\r\n\r\n> If `Base::try_lock()` fails strictly speaking that does not necessarily mean that there's a lock contention. `std::mutex`'s `try_lock()` can also spuriously fail even when no other thread is currently holding a lock: [en.cppreference.com/w/cpp/thread/mutex/try_lock](https://en.cppreference.com/w/cpp/thread/mutex/try_lock). I have no idea though how often that can happen.\r\n\r\nGood point. I read that doc previously and admit to discounting the spurious failures a little, as we don't know the frequency.  It seems to be an additional reason to log the contention duration.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910280351",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5YjA4MDA2YmM1MDJlNjc5NTZkNmFiNTE4Mzg4ZmFkNjM5N2NhYzhk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b08006bc502e67956d6ab518388fad6397cac8d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9b08006bc502e67956d6ab518388fad6397cac8d",
      "tree": {
        "sha": "c91ff6a05c64c14fe7b6085ec9a5008c37061871",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c91ff6a05c64c14fe7b6085ec9a5008c37061871"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c91ff6a05c64c14fe7b6085ec9a5008c37061871\nparent 3f4c6b87f1098436693c4990f2082515ec0ece26\nauthor Jon Atack <jon@atack.com> 1629309222 +0200\ncommitter Jon Atack <jon@atack.com> 1630502738 +0200\n\nlog, sync: improve lock contention logging and add time duration\n\nin microseconds.\n\nChange the function name in order to print \"LockContention\" instead\nof \"PrintLockContention\" to the log.  Add Doxygen documentation.\n\nWith this change, the lock contention log prints:\n\n2021-09-01T11:29:03Z LockContention: pnode->cs_vSend, net.cpp:1373 started\n2021-09-01T11:29:03Z LockContention: pnode->cs_vSend, net.cpp:1373 completed (31μs)\n2021-09-01T11:29:03Z LockContention: cs_vNodes, net.cpp:2277 started\n2021-09-01T11:29:03Z LockContention: cs_vNodes, net.cpp:2277 completed (6μs)\n2021-09-01T11:29:04Z LockContention: cs_vNodes, net.cpp:2242 started\n2021-09-01T11:29:04Z LockContention: cs_vNodes, net.cpp:2242 completed (3μs)\n\nCo-authored-by: Hennadii Stepanov <32963518+hebasto@users.noreply.github.com>\nCo-authored-by: practicalswift <practicalswift@users.noreply.github.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmEvf4kACgkQT1chs9Dj\nkh1aFw//b4fjHEhbu1ZNQ/AR5OEpI08ccrL1XW0WDDXCQQiSPExxCkndCsae6ZUR\nwIfIeZE+PjY0QLBEDp7X6yBAYsqcvNPVIaakHLVviJiGvyTgxbcydT+Ukiwc6fyl\nbEUhco3Kkw7R4cG+rdUcPZQf7S/YHMVX32J0d+Q7LlbFdSSMRnRLDMSG9Kd2gtiU\n4KnqMa0sZnGpGJTnG8fdMwlPSDR9VwgvYVLjCmc6nRxJOWGkjArJWoGhGcW6xFkD\n6wrB8LrHwE92wCaLrncUJfJbRIA56FQXnMkJQ3nlye2pj0ZnuPtd5MGEix8cvabG\nRhmRmOcYmJS52p4kWrDGPNzJF7dXCLszzNMyCDpQ3fM5G6ptboZ543dg/xWPjkK7\nAFyzvNzJWmM3WAqLpgucZpChw7rff4Y14L9vlSAliaFex4OqfVejcZ4UxGLw6S4p\nknG846jTHBRcXwOiy1Kb0iRqnIHk+2Q8eb2KEhFVuNuXVaC5jfuEdOfUUKfWM7GR\nShJZRPJPulS/4+Kj4i8xDU88iVyqH3aCvMZDasZi6xsOqEeknhb/kf5dGcJsPygm\nSAD2HdmNOU/ol5gok3cW2DFP2yI9ur4tHOOEGLS97N2YkDeFh95z52fQ/PHYQih/\nZekLo/Pe479wzsDkchDIkcPNN6xVo8Ug3cQTZfxUYCH7bXjqjo8=\n=Qo/8\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIAchpTuO30xrF1mnEHnTRTfqI8EAm7wilQjROUXbiPDICP/wEK6ZxMcnLZZX\njlTPm+tJaJwI8QRhL3+L8AjcaetN//XQtgCD3+MNLvkMjiwraHR0cHM6Ly9ib2Iu\nYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZ//wEMRM8SSYCzl80FyV0Pb1\nH8YI8QRhL3+L8AhPBnSjnYR/ywCD3+MNLvkMjiMiaHR0cHM6Ly9idGMuY2FsZW5k\nYXIuY2F0YWxsYXh5LmNvbf/wEMW9h7OyMYMMW9Vn+JEMcAkI8SCClCJtkrDGMcfT\nVvEKwIXreQQExWZ9KVKA6zi/Jh8bBAjxBGEvf4vwCKZRPt4dt+DhAIPf4w0u+QyO\nKShodHRwczovL2Zpbm5leS5jYWxlbmRhci5ldGVybml0eXdhbGwuY29t8BDWlJ/f\nclz0FNSI4kk97ZHXCPEEYS9/i/AIPakNLLWAJzIAg9/jDS75DI4uLWh0dHBzOi8v\nYWxpY2UuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZw==\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3f4c6b87f1098436693c4990f2082515ec0ece26",
          "sha": "3f4c6b87f1098436693c4990f2082515ec0ece26",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3f4c6b87f1098436693c4990f2082515ec0ece26"
        }
      ],
      "message": "log, sync: improve lock contention logging and add time duration\n\nin microseconds.\n\nChange the function name in order to print \"LockContention\" instead\nof \"PrintLockContention\" to the log.  Add Doxygen documentation.\n\nWith this change, the lock contention log prints:\n\n2021-09-01T11:29:03Z LockContention: pnode->cs_vSend, net.cpp:1373 started\n2021-09-01T11:29:03Z LockContention: pnode->cs_vSend, net.cpp:1373 completed (31μs)\n2021-09-01T11:29:03Z LockContention: cs_vNodes, net.cpp:2277 started\n2021-09-01T11:29:03Z LockContention: cs_vNodes, net.cpp:2277 completed (6μs)\n2021-09-01T11:29:04Z LockContention: cs_vNodes, net.cpp:2242 started\n2021-09-01T11:29:04Z LockContention: cs_vNodes, net.cpp:2242 completed (3μs)\n\nCo-authored-by: Hennadii Stepanov <32963518+hebasto@users.noreply.github.com>\nCo-authored-by: practicalswift <practicalswift@users.noreply.github.com>",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-09-01T13:25:38Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-08-18T17:53:42Z"
      },
      "sha": "9b08006bc502e67956d6ab518388fad6397cac8d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZTY5ODczMjgzNjEyMTkxMmYxNzliN2M3NDNhNzJkZDZmZGZmYTcy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e698732836121912f179b7c743a72dd6fdffa72",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7e698732836121912f179b7c743a72dd6fdffa72",
      "tree": {
        "sha": "d0f5d9b5a1408287b70258aa10218172b758be30",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d0f5d9b5a1408287b70258aa10218172b758be30"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d0f5d9b5a1408287b70258aa10218172b758be30\nparent 9b08006bc502e67956d6ab518388fad6397cac8d\nauthor Jon Atack <jon@atack.com> 1629282858 +0200\ncommitter Jon Atack <jon@atack.com> 1630502795 +0200\n\nsync: remove DEBUG_LOCKCONTENTION preprocessor directives\n\nto allow logging the lock contentions without the need to define\nDEBUG_LOCKCONTENTION at compile time.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmEvf4sACgkQT1chs9Dj\nkh2S/Q/7BtozHBjBewQg6is7Pzrt9IJ18lZhLMRWLN9EofyrTfbaKBluY7PxBoHK\n/ZPpe5hgVf3LOGOrc61/4uB79K8v1VuM4QcqxH1CQTiDyCQriYlTxiW6ttco/0/d\nZ0wNThbqkHsD60yWd9Pw1OsJeetOwhXVV+UdZWdTU4cgrrY/AfoS5gsRAKPKdnBJ\n+0x8/GwsPFDHqasqNgcZEE4Mf1V7N7iACZCntNVS/5ZH9G8lTHCwcQEBpnjEr+CN\n/xuoHj2+7l00fPnRmPpl9NyIV6mqNAhZFzhATcjfZgnTwKmBvPMOWaNSXBaX+tjN\n9pZZ8D6TLUCQd8i+M84F0GZNAkoIer82nBPduR+yYhWqFiAOg+PsIsrVBTBQdDGT\nHb0lWwyTKUMO016R+4HvObL8ypwVgZLBLTPxsFVcJHxk+o7AYFq291OPeAKgfX/l\nqyZMdmbjZarh/O95HPLcQrZ72z/QqK9MdtMB0S/sOcfUNRpn047CzXG3wL7Nqmqm\ngwlhbbx5cHE+VzfiJi2NDB0pdjJpe7xF2D2c3+VLSsPXLl7irCCNsOuCWHTpgYvi\n1YQ0iDMNVNH0G9MX9DysJq0BGDuLOO68t5DA6g4EpXyUfY8h7nHCTfCOl3ZO64dT\nrU6H8iFvydd1i18Lyq+v5JRdUI+mAfnym5uMgkC0jnPINdG1528=\n=Dc64\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIIWNewI6GfHxSPqFHU4pDVCOOhKkXd0h0W37jP1dskv2CP/wEFU8dnefuz+P\nE9uI5KFq7kgI8QRhL3+N8Ai8X/vDEBrRvgCD3+MNLvkMjiwraHR0cHM6Ly9ib2Iu\nYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZ//wEFyNXyU2qxgMv6uEYZAW\n+8QI8QRhL3+N8AgzwCgTS0VpYwCD3+MNLvkMjiMiaHR0cHM6Ly9idGMuY2FsZW5k\nYXIuY2F0YWxsYXh5LmNvbf/wEIh6/8O2aN4yVXj4yY/J+LEI8QRhL3+N8AiIUesY\nvmSHBwCD3+MNLvkMjikoaHR0cHM6Ly9maW5uZXkuY2FsZW5kYXIuZXRlcm5pdHl3\nYWxsLmNvbfAQxNob9Kie4/kNLm5+pyhSSwjwIA1J+22OZGBrMescoiA8Qr4Ny5bp\nswjqmzNhlPEkB+sOCPAgWx0yxsl8ZLbbN7zioQ/TpOtJIlEIYVlHJxPyU3sN5VEI\n8QRhL3+N8AjNmcx1kFjS0ACD3+MNLvkMji4taHR0cHM6Ly9hbGljZS5idGMuY2Fs\nZW5kYXIub3BlbnRpbWVzdGFtcHMub3Jn\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b08006bc502e67956d6ab518388fad6397cac8d",
          "sha": "9b08006bc502e67956d6ab518388fad6397cac8d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9b08006bc502e67956d6ab518388fad6397cac8d"
        }
      ],
      "message": "sync: remove DEBUG_LOCKCONTENTION preprocessor directives\n\nto allow logging the lock contentions without the need to define\nDEBUG_LOCKCONTENTION at compile time.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-09-01T13:26:35Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-08-18T10:34:18Z"
      },
      "sha": "7e698732836121912f179b7c743a72dd6fdffa72"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5239583873,
      "node_id": "HRFPE_lADOABII5846CKiJzwAAAAE4TbSB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5239583873",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-01T13:27:04Z"
    },
    {
      "event": "reviewed",
      "id": 745514800,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQ1NTE0ODAw",
      "url": null,
      "actor": null,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "re-ACK 7e698732836121912f179b7c743a72dd6fdffa72, added a contention duration to the log message since my [previous](https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-743764606) review.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-745514800",
      "submitted_at": "2021-09-02T20:59:47Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "reviewed",
      "id": 746602940,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQ2NjAyOTQw",
      "url": null,
      "actor": null,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "re-ACK 7e698732836121912f179b7c743a72dd6fdffa72 🔏 ⏲️ \r\n\r\nSince my last ACK, the lock contention logging was improved by also showing the duration in micro-seconds, and an alternate (more elegant) version of `UniqueLock::Enter` is now used that doesn't need to check whether the `lock` category is on if there is no contention (https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-910110140).\r\n\r\nTested by building with clang 10.0.1 on OpenBSD 6.9 and running `./src/bitcoind -signet -debug=lock` on an empty signet datadir.\r\n\r\nOn my system, during IBD the vast majority of lock contentions happen in\r\n* cs_main, net_processing.cpp:1476\r\n* m_mutex, ./checkqueue.h:168\r\n* m_mutex, ./checkqueue.h:77\r\n\r\nAfter IBD is finished, _all_ lock contentions are in\r\n* cs_vNodes, net.cpp (different lines)\r\n\r\nMost contentions are in the range of 5-10us. (Note that these results are not based on deeper analysis, but on what I saw scrolling through the logs after a few minutes).",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-746602940",
      "submitted_at": "2021-09-05T00:28:48Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "commented",
      "id": 913133555,
      "node_id": "IC_kwDOABII5842bU_z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/913133555",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-05T11:14:24Z",
      "updated_at": "2021-09-05T11:14:24Z",
      "author_association": "MEMBER",
      "body": "Thanks for testing! For me, there seems to be a higher frequency of contention and occuring in more places on mainnet than on signet, presumably as the scale/numbers are larger. Also, a big difference in contention durations between a regular build and a debug build, which makes sense.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#issuecomment-913133555",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22736"
    },
    {
      "event": "merged",
      "id": 5259683929,
      "node_id": "ME_lADOABII5846CKiJzwAAAAE5gGhZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5259683929",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "fa92777448239f52fb04579304095bd34c4d2bf8",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa92777448239f52fb04579304095bd34c4d2bf8",
      "created_at": "2021-09-06T08:32:41Z"
    },
    {
      "event": "closed",
      "id": 5259683945,
      "node_id": "CE_lADOABII5846CKiJzwAAAAE5gGhp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5259683945",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-06T08:32:41Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 5259711169,
      "node_id": "HRDE_lADOABII5846CKiJzwAAAAE5gNLB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5259711169",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-06T08:38:00Z"
    },
    {
      "event": "reviewed",
      "id": 747015764,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQ3MDE1NzY0",
      "url": null,
      "actor": null,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-747015764",
      "submitted_at": "2021-09-06T09:23:30Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "reviewed",
      "id": 747369877,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzQ3MzY5ODc3",
      "url": null,
      "actor": null,
      "commit_id": "9b08006bc502e67956d6ab518388fad6397cac8d",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#pullrequestreview-747369877",
      "submitted_at": "2021-09-06T17:21:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
    },
    {
      "event": "referenced",
      "id": 5267366136,
      "node_id": "REFE_lADOABII5846CKiJzwAAAAE59aD4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5267366136",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "cac636697a097838b2b417660ea53680c62c7e34",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/cac636697a097838b2b417660ea53680c62c7e34",
      "created_at": "2021-09-07T18:17:50Z"
    },
    {
      "event": "referenced",
      "id": 5278718768,
      "node_id": "REFE_lADOABII5846CKiJzwAAAAE6otsw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5278718768",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "d2dd1697cee9d6d0f13f9cb351bce84eaa4a72b4",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/d2dd1697cee9d6d0f13f9cb351bce84eaa4a72b4",
      "created_at": "2021-09-09T13:56:02Z"
    },
    {
      "event": "referenced",
      "id": 5287190450,
      "node_id": "REFE_lADOABII5846CKiJzwAAAAE7JB-y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5287190450",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "388bc0e0cccc6d969441be3602f190f7cddd89a4",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/388bc0e0cccc6d969441be3602f190f7cddd89a4",
      "created_at": "2021-09-11T04:34:24Z"
    },
    {
      "event": "referenced",
      "id": 6396108707,
      "node_id": "REFE_lADOABII5846CKiJzwAAAAF9PN-j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6396108707",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "c1059c9fef188e1d025458fdf33eb992af4376e2",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/c1059c9fef188e1d025458fdf33eb992af4376e2",
      "created_at": "2022-04-08T12:30:31Z"
    },
    {
      "event": "locked",
      "id": 7334340010,
      "node_id": "LOE_lADOABII5846CKiJzwAAAAG1KSWq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7334340010",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-06T23:16:13Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691277896",
      "pull_request_review_id": 732919180,
      "id": 691277896,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTI3Nzg5Ng==",
      "diff_hunk": "@@ -138,14 +137,10 @@ class SCOPED_LOCKABLE UniqueLock : public Base\n     void Enter(const char* pszName, const char* pszFile, int nLine)\n     {\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\n-#ifdef DEBUG_LOCKCONTENTION\n         if (!Base::try_lock()) {",
      "path": "src/sync.h",
      "position": null,
      "original_position": 27,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "6f6abbe7d735b5a2622df9b5c971cccbca93b886",
      "in_reply_to_id": null,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I am somewhat worried that the extra calls to `Base::try_lock` cause performance overhead in the non-lock contention debugging case. It's unnecessary. We might want to gate *that too* on the log category being enabled.",
      "created_at": "2021-08-18T14:11:34Z",
      "updated_at": "2021-08-18T14:13:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r691277896",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691277896"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691280693",
      "pull_request_review_id": 732923029,
      "id": 691280693,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTI4MDY5Mw==",
      "diff_hunk": "@@ -138,14 +137,10 @@ class SCOPED_LOCKABLE UniqueLock : public Base\n     void Enter(const char* pszName, const char* pszFile, int nLine)\n     {\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\n-#ifdef DEBUG_LOCKCONTENTION\n         if (!Base::try_lock()) {",
      "path": "src/sync.h",
      "position": null,
      "original_position": 27,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "6f6abbe7d735b5a2622df9b5c971cccbca93b886",
      "in_reply_to_id": 691277896,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks, wondering that as well (or alternatively, leave the directives in place and just improve the logging experience when `DEBUG_LOCKCONTENTION` is defined).",
      "created_at": "2021-08-18T14:14:42Z",
      "updated_at": "2021-08-18T14:14:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r691280693",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691280693"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691487999",
      "pull_request_review_id": 733201598,
      "id": 691487999,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTQ4Nzk5OQ==",
      "diff_hunk": "@@ -138,14 +137,10 @@ class SCOPED_LOCKABLE UniqueLock : public Base\n     void Enter(const char* pszName, const char* pszFile, int nLine)\n     {\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\n-#ifdef DEBUG_LOCKCONTENTION\n         if (!Base::try_lock()) {",
      "path": "src/sync.h",
      "position": null,
      "original_position": 27,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "6f6abbe7d735b5a2622df9b5c971cccbca93b886",
      "in_reply_to_id": 691277896,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Implemented your suggestion (thanks!)\r\n\r\n(Behind the gate it could now be just `LogPrintf` if anyone prefers.)",
      "created_at": "2021-08-18T18:03:48Z",
      "updated_at": "2021-08-18T18:18:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r691487999",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691487999"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692383717",
      "pull_request_review_id": 734334313,
      "id": 692383717,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjM4MzcxNw==",
      "diff_hunk": "@@ -6,7 +6,10 @@\n #ifndef BITCOIN_SYNC_H\n #define BITCOIN_SYNC_H\n \n+#include <logging.h>\n #include <threadsafety.h>\n+#include <tinyformat.h>\n+#include <util/strencodings.h>",
      "path": "src/sync.h",
      "position": null,
      "original_position": 7,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "ccd73de1dd969097d34634c2be2fc32b03fbd09e",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "why are those includes needed?",
      "created_at": "2021-08-19T18:29:56Z",
      "updated_at": "2021-08-19T18:37:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r692383717",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692383717"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 12,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692388102",
      "pull_request_review_id": 734334313,
      "id": 692388102,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjM4ODEwMg==",
      "diff_hunk": "@@ -6,7 +6,10 @@\n #ifndef BITCOIN_SYNC_H\n #define BITCOIN_SYNC_H\n \n+#include <logging.h>",
      "path": "src/sync.h",
      "position": null,
      "original_position": 4,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "ccd73de1dd969097d34634c2be2fc32b03fbd09e",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: If `PrintLockContention` stayed in the cpp file, this include can be avoided (it indirectly includes the heavy filesystem header).",
      "created_at": "2021-08-19T18:36:38Z",
      "updated_at": "2021-08-19T18:37:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r692388102",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692388102"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 9,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692550022",
      "pull_request_review_id": 734543340,
      "id": 692550022,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjU1MDAyMg==",
      "diff_hunk": "@@ -6,7 +6,10 @@\n #ifndef BITCOIN_SYNC_H\n #define BITCOIN_SYNC_H\n \n+#include <logging.h>\n #include <threadsafety.h>\n+#include <tinyformat.h>\n+#include <util/strencodings.h>",
      "path": "src/sync.h",
      "position": null,
      "original_position": 7,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "ccd73de1dd969097d34634c2be2fc32b03fbd09e",
      "in_reply_to_id": 692383717,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "dropped",
      "created_at": "2021-08-19T23:11:47Z",
      "updated_at": "2021-08-19T23:11:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r692550022",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692550022"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 12,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692550796",
      "pull_request_review_id": 734544299,
      "id": 692550796,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjU1MDc5Ng==",
      "diff_hunk": "@@ -6,7 +6,10 @@\n #ifndef BITCOIN_SYNC_H\n #define BITCOIN_SYNC_H\n \n+#include <logging.h>",
      "path": "src/sync.h",
      "position": null,
      "original_position": 4,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "ccd73de1dd969097d34634c2be2fc32b03fbd09e",
      "in_reply_to_id": 692388102,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point, though we would have to essentially move `UniqueLock::Enter()` to the cpp file, due to calling `LogAcceptCategory(BCLog::LOCK)`. Punting on this for now.",
      "created_at": "2021-08-19T23:14:07Z",
      "updated_at": "2021-08-19T23:14:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r692550796",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692550796"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 9,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/699989239",
      "pull_request_review_id": 743622555,
      "id": 699989239,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5OTk4OTIzOQ==",
      "diff_hunk": "@@ -138,14 +135,14 @@ class SCOPED_LOCKABLE UniqueLock : public Base\n     void Enter(const char* pszName, const char* pszFile, int nLine)\n     {\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\n-#ifdef DEBUG_LOCKCONTENTION\n-        if (!Base::try_lock()) {\n-            PrintLockContention(pszName, pszFile, nLine);\n-#endif\n+        if (LogAcceptCategory(BCLog::LOCK)) {\n+            if (!Base::try_lock()) {\n+                LogPrintf(\"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\n+                Base::lock();\n+            }\n+        } else {",
      "path": "src/sync.h",
      "position": null,
      "original_position": 32,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "6e7b6bfee377cdb1ea700af8084b08f79cbe5ee5",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        if (LogAcceptCategory(BCLog::LOCK) && !Base::try_lock()) {\r\n            LogPrintf(\"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\r\n        }\r\n```\r\n\r\n?",
      "created_at": "2021-09-01T08:19:05Z",
      "updated_at": "2021-09-01T08:19:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r699989239",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/699989239"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": 138,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/700028085",
      "pull_request_review_id": 743674807,
      "id": 700028085,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMDAyODA4NQ==",
      "diff_hunk": "@@ -138,14 +135,14 @@ class SCOPED_LOCKABLE UniqueLock : public Base\n     void Enter(const char* pszName, const char* pszFile, int nLine)\n     {\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\n-#ifdef DEBUG_LOCKCONTENTION\n-        if (!Base::try_lock()) {\n-            PrintLockContention(pszName, pszFile, nLine);\n-#endif\n+        if (LogAcceptCategory(BCLog::LOCK)) {\n+            if (!Base::try_lock()) {\n+                LogPrintf(\"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\n+                Base::lock();\n+            }\n+        } else {",
      "path": "src/sync.h",
      "position": null,
      "original_position": 32,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "6e7b6bfee377cdb1ea700af8084b08f79cbe5ee5",
      "in_reply_to_id": 699989239,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks. If I understand the suggestion, this would only lock if the lock logging is on and `try_lock()` succeeds.",
      "created_at": "2021-09-01T09:09:23Z",
      "updated_at": "2021-09-01T09:09:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r700028085",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/700028085"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": 138,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/700030470",
      "pull_request_review_id": 743677963,
      "id": 700030470,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMDAzMDQ3MA==",
      "diff_hunk": "@@ -138,14 +135,14 @@ class SCOPED_LOCKABLE UniqueLock : public Base\n     void Enter(const char* pszName, const char* pszFile, int nLine)\n     {\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\n-#ifdef DEBUG_LOCKCONTENTION\n-        if (!Base::try_lock()) {\n-            PrintLockContention(pszName, pszFile, nLine);\n-#endif\n+        if (LogAcceptCategory(BCLog::LOCK)) {\n+            if (!Base::try_lock()) {\n+                LogPrintf(\"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\n+                Base::lock();\n+            }\n+        } else {",
      "path": "src/sync.h",
      "position": null,
      "original_position": 32,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "6e7b6bfee377cdb1ea700af8084b08f79cbe5ee5",
      "in_reply_to_id": 699989239,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```cpp\r\n    void Enter(const char* pszName, const char* pszFile, int nLine)\r\n    {\r\n        EnterCritical(pszName, pszFile, nLine, Base::mutex());\r\n        if (LogAcceptCategory(BCLog::LOCK) && !Base::try_lock()) {\r\n            LogPrintf(\"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\r\n        }\r\n        Base::lock();\r\n    }\r\n```",
      "created_at": "2021-09-01T09:12:27Z",
      "updated_at": "2021-09-01T09:12:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r700030470",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/700030470"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": 138,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/700035169",
      "pull_request_review_id": 743684310,
      "id": 700035169,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMDAzNTE2OQ==",
      "diff_hunk": "@@ -138,14 +135,14 @@ class SCOPED_LOCKABLE UniqueLock : public Base\n     void Enter(const char* pszName, const char* pszFile, int nLine)\n     {\n         EnterCritical(pszName, pszFile, nLine, Base::mutex());\n-#ifdef DEBUG_LOCKCONTENTION\n-        if (!Base::try_lock()) {\n-            PrintLockContention(pszName, pszFile, nLine);\n-#endif\n+        if (LogAcceptCategory(BCLog::LOCK)) {\n+            if (!Base::try_lock()) {\n+                LogPrintf(\"Lock contention: %s, %s:%d\\n\", pszName, pszFile, nLine);\n+                Base::lock();\n+            }\n+        } else {",
      "path": "src/sync.h",
      "position": null,
      "original_position": 32,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "6e7b6bfee377cdb1ea700af8084b08f79cbe5ee5",
      "in_reply_to_id": 699989239,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nm, my suggestion is wrong.",
      "created_at": "2021-09-01T09:18:47Z",
      "updated_at": "2021-09-01T09:18:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r700035169",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/700035169"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": 138,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/700095417",
      "pull_request_review_id": 743766642,
      "id": 700095417,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMDA5NTQxNw==",
      "diff_hunk": "@@ -6,7 +6,10 @@\n #ifndef BITCOIN_SYNC_H\n #define BITCOIN_SYNC_H\n \n+#include <logging.h>",
      "path": "src/sync.h",
      "position": null,
      "original_position": 4,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "ccd73de1dd969097d34634c2be2fc32b03fbd09e",
      "in_reply_to_id": 692388102,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> nit: If `PrintLockContention` stayed in the cpp file, this include can be avoided (it indirectly includes the heavy filesystem header).\r\n\r\nagree, dropped the commit changing this",
      "created_at": "2021-09-01T10:44:14Z",
      "updated_at": "2021-09-01T10:44:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r700095417",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/700095417"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 9,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/702747920",
      "pull_request_review_id": 747015764,
      "id": 702747920,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMjc0NzkyMA==",
      "diff_hunk": "@@ -58,12 +58,14 @@ class Timer\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n \n-        std::string units = \"\";\n+        if (std::is_same<TimeType, std::chrono::microseconds>::value) {\n+            return strprintf(\"%s: %s (%iμs)\", m_prefix, msg, end_time.count());\n+        }\n+\n+        std::string units;\n         float divisor = 1;\n \n-        if (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            units = \"μs\";\n-        } else if (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n+        if (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n             units = \"ms\";\n             divisor = 1000.;",
      "path": "src/logging/timer.h",
      "position": 17,
      "original_position": 17,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "unrelated: Could make sense to inline those as well to avoid the heterogeneous code flow? ",
      "created_at": "2021-09-06T09:23:30Z",
      "updated_at": "2021-09-06T09:23:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r702747920",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/702747920"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 70,
      "original_line": 70,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/703019629",
      "pull_request_review_id": 747369877,
      "id": 703019629,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMzAxOTYyOQ==",
      "diff_hunk": "@@ -27,10 +28,9 @@\n #if !defined(HAVE_THREAD_LOCAL)\n static_assert(false, \"thread_local is not supported\");\n #endif\n-void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n+void LockContention(const char* pszName, const char* pszFile, int nLine)\n {\n-    LogPrint(BCLog::LOCK, \"LOCKCONTENTION: %s\\n\", pszName);\n-    LogPrint(BCLog::LOCK, \"Locker: %s:%d\\n\", pszFile, nLine);\n+    LOG_TIME_MICROS_WITH_CATEGORY(strprintf(\"%s, %s:%d\", pszName, pszFile, nLine), BCLog::LOCK);",
      "path": "src/sync.cpp",
      "position": 21,
      "original_position": 17,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "9b08006bc502e67956d6ab518388fad6397cac8d",
      "in_reply_to_id": null,
      "user": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think `LockContention` doesn't do what it is supposed to do. At least it doesn't log the time that the contention actually takes: the macro creates an `BCLog::Timer` instance where constructor measures start time, and destructor prints finished. But since all that is done inside the `LockContention` function, this happens instantly and doesn't measure the actual lock contention.\r\n\r\nI've verified that in https://github.com/bitcoin/bitcoin/pull/21006 because I wanted to see how long the contentions are, but it always prints 0µs or 1µs. When I move the macro into `sync.h` and replace \r\n\r\n```cpp\r\nLockContention(pszName, pszFile, nLine); // log the contention\r\n```\r\nwith\r\n```cpp\r\nLOG_TIME_MICROS_WITH_CATEGORY(strprintf(\"%s, %s:%d\", pszName, pszFile, nLine), BCLog::LOCK);\r\n```\r\nI get reasonable contention times, like so:\r\n\r\n```\r\n2021-09-06T17:18:23Z Enter: cs_main, rest.cpp:281 completed (65406μs)\r\n2021-09-06T17:18:23Z Enter: cs_main, rest.cpp:281 completed (65331μs)\r\n2021-09-06T17:18:23Z Enter: cs_main, rest.cpp:281 completed (65074μs)\r\n2021-09-06T17:18:23Z Enter: cs_main, rest.cpp:281 completed (65103μs)\r\n2021-09-06T17:18:23Z Enter: cs_main, net_processing.cpp:4051 completed (67687μs)\r\n```",
      "created_at": "2021-09-06T17:21:54Z",
      "updated_at": "2021-09-06T17:22:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r703019629",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/703019629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 29,
      "original_line": 33,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/703028343",
      "pull_request_review_id": 747378858,
      "id": 703028343,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMzAyODM0Mw==",
      "diff_hunk": "@@ -27,10 +28,9 @@\n #if !defined(HAVE_THREAD_LOCAL)\n static_assert(false, \"thread_local is not supported\");\n #endif\n-void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n+void LockContention(const char* pszName, const char* pszFile, int nLine)\n {\n-    LogPrint(BCLog::LOCK, \"LOCKCONTENTION: %s\\n\", pszName);\n-    LogPrint(BCLog::LOCK, \"Locker: %s:%d\\n\", pszFile, nLine);\n+    LOG_TIME_MICROS_WITH_CATEGORY(strprintf(\"%s, %s:%d\", pszName, pszFile, nLine), BCLog::LOCK);",
      "path": "src/sync.cpp",
      "position": 21,
      "original_position": 17,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "9b08006bc502e67956d6ab518388fad6397cac8d",
      "in_reply_to_id": 703019629,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Interesting, makes sense that it would only be timing the `LockContention()` function. Right now on mainnet with a non-debug clang 13 build running since 6 hours (2 cores x 2.50GHz), I see varying durations of 1-50 usec, most often 2-30.  I suspect your machine is much faster than mine (and that I may be only seeing the time of the macro function as you suggest). Will try your suggestion.",
      "created_at": "2021-09-06T17:53:55Z",
      "updated_at": "2021-09-06T18:17:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r703028343",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/703028343"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 29,
      "original_line": 33,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/703090529",
      "pull_request_review_id": 747441422,
      "id": 703090529,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMzA5MDUyOQ==",
      "diff_hunk": "@@ -27,10 +28,9 @@\n #if !defined(HAVE_THREAD_LOCAL)\n static_assert(false, \"thread_local is not supported\");\n #endif\n-void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n+void LockContention(const char* pszName, const char* pszFile, int nLine)\n {\n-    LogPrint(BCLog::LOCK, \"LOCKCONTENTION: %s\\n\", pszName);\n-    LogPrint(BCLog::LOCK, \"Locker: %s:%d\\n\", pszFile, nLine);\n+    LOG_TIME_MICROS_WITH_CATEGORY(strprintf(\"%s, %s:%d\", pszName, pszFile, nLine), BCLog::LOCK);",
      "path": "src/sync.cpp",
      "position": 21,
      "original_position": 17,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "9b08006bc502e67956d6ab518388fad6397cac8d",
      "in_reply_to_id": 703019629,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@martinus This does seem better, now seeing durations of 1 to several million usec (mainnet, non-debug build). Thanks for reporting. Proposed fix in #22904.\r\n",
      "created_at": "2021-09-06T23:08:46Z",
      "updated_at": "2021-09-06T23:08:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r703090529",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/703090529"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 29,
      "original_line": 33,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/703090666",
      "pull_request_review_id": 747441534,
      "id": 703090666,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMzA5MDY2Ng==",
      "diff_hunk": "@@ -58,12 +58,14 @@ class Timer\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n \n-        std::string units = \"\";\n+        if (std::is_same<TimeType, std::chrono::microseconds>::value) {\n+            return strprintf(\"%s: %s (%iμs)\", m_prefix, msg, end_time.count());\n+        }\n+\n+        std::string units;\n         float divisor = 1;\n \n-        if (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            units = \"μs\";\n-        } else if (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n+        if (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n             units = \"ms\";\n             divisor = 1000.;",
      "path": "src/logging/timer.h",
      "position": 17,
      "original_position": 17,
      "commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "original_commit_id": "7e698732836121912f179b7c743a72dd6fdffa72",
      "in_reply_to_id": 702747920,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "good idea, done (and more) in #22904",
      "created_at": "2021-09-06T23:09:29Z",
      "updated_at": "2021-09-06T23:09:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/22736#discussion_r703090666",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/703090666"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22736"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 70,
      "original_line": 70,
      "side": "RIGHT"
    }
  ]
}