{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742",
    "id": 1175571290,
    "node_id": "PR_kwDOABII585GEcta",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/26742",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/26742.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/26742.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/60978c8080ec13ff4571c8a89e742517b2aca692",
    "number": 26742,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "http: Track active requests and wait for last to finish - 2nd attempt",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This revives #19420. Since promag is not so active at the moment, I can support this to finally get it merged.\r\n\r\nThe PR is rebased and comments by jonatack have been addressed.\r\n\r\nOnce this is merged, I will also reopen #19434.\r\n",
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "created_at": "2022-12-22T18:48:58Z",
    "updated_at": "2024-03-06T12:37:05Z",
    "closed_at": "2023-03-07T00:36:20Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merged_at": "2023-03-07T00:36:20Z",
    "merge_commit_sha": "86bacd75e76eff207ef8f7bdb897365f5b6e7b6b",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      {
        "login": "john-moffett",
        "id": 116917595,
        "node_id": "U_kgDOBvgFWw",
        "avatar_url": "https://avatars.githubusercontent.com/u/116917595?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-moffett",
        "html_url": "https://github.com/john-moffett",
        "followers_url": "https://api.github.com/users/john-moffett/followers",
        "following_url": "https://api.github.com/users/john-moffett/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/john-moffett/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/john-moffett/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/john-moffett/subscriptions",
        "organizations_url": "https://api.github.com/users/john-moffett/orgs",
        "repos_url": "https://api.github.com/users/john-moffett/repos",
        "events_url": "https://api.github.com/users/john-moffett/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/john-moffett/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "fjahr:202212-pr19420",
      "ref": "202212-pr19420",
      "sha": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 196253948,
        "node_id": "MDEwOlJlcG9zaXRvcnkxOTYyNTM5NDg=",
        "name": "bitcoin",
        "full_name": "fjahr/bitcoin",
        "owner": {
          "login": "fjahr",
          "id": 1322187,
          "node_id": "MDQ6VXNlcjEzMjIxODc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/fjahr",
          "html_url": "https://github.com/fjahr",
          "followers_url": "https://api.github.com/users/fjahr/followers",
          "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
          "organizations_url": "https://api.github.com/users/fjahr/orgs",
          "repos_url": "https://api.github.com/users/fjahr/repos",
          "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/fjahr/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/fjahr/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/fjahr/bitcoin",
        "archive_url": "https://api.github.com/repos/fjahr/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/fjahr/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/fjahr/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/fjahr/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/fjahr/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/fjahr/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/fjahr/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/fjahr/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/fjahr/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/fjahr/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/fjahr/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/fjahr/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/fjahr/bitcoin/events",
        "forks_url": "https://api.github.com/repos/fjahr/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/fjahr/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/fjahr/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/fjahr/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/fjahr/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/fjahr/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/fjahr/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/fjahr/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/fjahr/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/fjahr/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/fjahr/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/fjahr/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/fjahr/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/fjahr/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/fjahr/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/fjahr/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:fjahr/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/fjahr/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/fjahr/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/fjahr/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/fjahr/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/fjahr/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/fjahr/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/fjahr/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/fjahr/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/fjahr/bitcoin/hooks",
        "svn_url": "https://github.com/fjahr/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 239200,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-03-04T15:49:19Z",
        "created_at": "2019-07-10T18:11:06Z",
        "updated_at": "2022-02-24T18:41:19Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "b92d609fb25637ccda000e182da854d4b762eee9",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34748,
        "stargazers_count": 74506,
        "watchers_count": 74506,
        "size": 252397,
        "default_branch": "master",
        "open_issues_count": 708,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-03-06T12:58:26Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-03-06T12:33:05Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 36,
    "deletions": 7,
    "changed_files": 2,
    "commits": 3,
    "review_comments": 51,
    "comments": 11
  },
  "events": [
    {
      "event": "commented",
      "id": 1363227894,
      "node_id": "IC_kwDOABII585RQTT2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1363227894",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-22T18:49:01Z",
      "updated_at": "2023-03-06T12:49:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1294521747), [hebasto](https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1319862109) |\n| Concept ACK | [brunoerg](https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1228858150), [promag](https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1240762906) |\n| Stale ACK | [kevkevinpal](https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1365549010) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1363227894",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "labeled",
      "id": 8098328984,
      "node_id": "LE_lADOABII585Z6EGgzwAAAAHisrGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8098328984",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-22T18:49:03Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-22T18:50:13Z",
      "updated_at": "2022-12-22T18:50:13Z",
      "source": {
        "issue": {
          "id": 648067169,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQxOTM5NzUy",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19420",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19420/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19420/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19420/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19420",
          "number": 19420,
          "state": "closed",
          "state_reason": null,
          "title": "http: Track active requests and wait for last to finish",
          "body": "This PR calls `evhttp_free` before releasing event base. But according to `evhttp_free` [docs](https://github.com/libevent/libevent/blob/1cea01d6d5c84337dac663e5464059ccd2d6a8dd/include/event2/http.h#L208-L217):\r\n> Works only if no requests are currently being served.\r\n\r\nSo this PR also tracks active requests with libevent and waits for last request to finish. This requires libevent 2.1 due to `evhttp_request_set_on_complete_cb` (https://github.com/libevent/libevent/blob/master/whatsnew-2.1.txt).\r\n\r\nFinally, the call to `evhttp_free` is done in the event base loop to avoid concurrency issues.\r\n\r\nNow test/functional/feature_abortnode.py quits normally, not due to socket timeouts.",
          "user": {
            "login": "promag",
            "id": 3534524,
            "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/promag",
            "html_url": "https://github.com/promag",
            "followers_url": "https://api.github.com/users/promag/followers",
            "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
            "organizations_url": "https://api.github.com/users/promag/orgs",
            "repos_url": "https://api.github.com/users/promag/repos",
            "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/promag/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 13,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19420",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19420",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19420.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19420.patch"
          },
          "closed_at": "2022-11-10T17:12:29Z",
          "created_at": "2020-06-30T10:38:41Z",
          "updated_at": "2023-12-22T12:22:56Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1363612871,
      "node_id": "IC_kwDOABII585RRxTH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1363612871",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-23T04:50:20Z",
      "updated_at": "2022-12-23T04:50:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "Running `test/functional/feature_abortnode.py` before and after change we get a significant performance gain\r\n\r\nrunning before changes f3bc1a72825fe2b51f4bc20e004cef464f05b965\r\n```\r\ntest/functional/feature_abortnode.py\r\n2022-12-23T04:47:19.826000Z TestFramework (INFO): Initializing test directory /var/folders/9g/cvx014yx4dq5lwl_x5zvn_j80000gn/T/bitcoin_func_test_k3_6xric\r\n2022-12-23T04:47:21.229000Z TestFramework (INFO): Waiting for crash\r\n2022-12-23T04:47:51.429000Z TestFramework (INFO): Node crashed - now verifying restart fails\r\n2022-12-23T04:47:52.086000Z TestFramework (INFO): Stopping nodes\r\n2022-12-23T04:47:52.300000Z TestFramework (INFO): Cleaning up /var/folders/9g/cvx014yx4dq5lwl_x5zvn_j80000gn/T/bitcoin_func_test_k3_6xric on exit\r\n2022-12-23T04:47:52.300000Z TestFramework (INFO): Tests successful\r\n```\r\n32.50 seconds to run test\r\n\r\n-------\r\n\r\nrunning test with these changes applied [40528e7](https://github.com/bitcoin/bitcoin/pull/26742/commits/40528e777fbad0512bb657fb067ea8dc2389c02e)\r\n```\r\ntest/functional/feature_abortnode.py\r\n2022-12-23T04:44:30.075000Z TestFramework (INFO): Initializing test directory /var/folders/9g/cvx014yx4dq5lwl_x5zvn_j80000gn/T/bitcoin_func_test_0h3w_rbx\r\n2022-12-23T04:44:31.516000Z TestFramework (INFO): Waiting for crash\r\n2022-12-23T04:44:31.837000Z TestFramework (INFO): Node crashed - now verifying restart fails\r\n2022-12-23T04:44:32.452000Z TestFramework (INFO): Stopping nodes\r\n2022-12-23T04:44:32.727000Z TestFramework (INFO): Cleaning up /var/folders/9g/cvx014yx4dq5lwl_x5zvn_j80000gn/T/bitcoin_func_test_0h3w_rbx on exit\r\n2022-12-23T04:44:32.727000Z TestFramework (INFO): Tests successful\r\n```\r\n1.2 seconds to run test",
      "user": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1363612871",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "reviewed",
      "id": 1228777906,
      "node_id": "PRR_kwDOABII585JPamy",
      "url": null,
      "actor": null,
      "commit_id": "40528e777fbad0512bb657fb067ea8dc2389c02e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK - thanks for reviving this!",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1228777906",
      "submitted_at": "2022-12-23T10:15:49Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "reviewed",
      "id": 1228858150,
      "node_id": "PRR_kwDOABII585JPuMm",
      "url": null,
      "actor": null,
      "commit_id": "40528e777fbad0512bb657fb067ea8dc2389c02e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1228858150",
      "submitted_at": "2022-12-23T11:30:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "reviewed",
      "id": 1228890565,
      "node_id": "PRR_kwDOABII585JP2HF",
      "url": null,
      "actor": null,
      "commit_id": "40528e777fbad0512bb657fb067ea8dc2389c02e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1228890565",
      "submitted_at": "2022-12-23T11:59:11Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "commented",
      "id": 1364031297,
      "node_id": "IC_kwDOABII585RTXdB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1364031297",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-23T15:12:10Z",
      "updated_at": "2022-12-23T15:12:10Z",
      "author_association": "MEMBER",
      "body": "Concept ACK :trollface: ",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1364031297",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8106141971,
      "node_id": "HRFPE_lADOABII585Z6EGgzwAAAAHjKekT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8106141971",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-23T23:06:14Z"
    },
    {
      "event": "reviewed",
      "id": 1229452700,
      "node_id": "PRR_kwDOABII585JR_Wc",
      "url": null,
      "actor": null,
      "commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1229452700",
      "submitted_at": "2022-12-23T23:15:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "reviewed",
      "id": 1229452951,
      "node_id": "PRR_kwDOABII585JR_aX",
      "url": null,
      "actor": null,
      "commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1229452951",
      "submitted_at": "2022-12-23T23:23:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8108674897,
      "node_id": "HRFPE_lADOABII585Z6EGgzwAAAAHjUI9R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8108674897",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-25T18:47:48Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8108680008,
      "node_id": "HRFPE_lADOABII585Z6EGgzwAAAAHjUKNI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8108680008",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-25T18:56:14Z"
    },
    {
      "event": "reviewed",
      "id": 1230240081,
      "node_id": "PRR_kwDOABII585JU_lR",
      "url": null,
      "actor": null,
      "commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1230240081",
      "submitted_at": "2022-12-26T22:16:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "commented",
      "id": 1365549010,
      "node_id": "IC_kwDOABII585RZJ_S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1365549010",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-27T01:57:09Z",
      "updated_at": "2022-12-27T01:57:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "retACK [f95063e](https://github.com/bitcoin/bitcoin/pull/26742/commits/f95063efb9c23765671f72a1f14eb66634cb3988) with `test/functional/feature_abortnode.py`",
      "user": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1365549010",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "commented",
      "id": 1366026611,
      "node_id": "IC_kwDOABII585Ra-lz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1366026611",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-27T16:24:13Z",
      "updated_at": "2022-12-27T16:24:13Z",
      "author_association": "MEMBER",
      "body": "From https://github.com/bitcoin/bitcoin/pull/15363#issuecomment-461921981:\r\n> The libevent HTTP interface is kind of crazy, so I don't think it's surprising that fixing this requires some trial and error. But it would be good to have tests for each issue that gets fixed to avoid going in circles.\r\n\r\nSuggesting to add a test which will prevent any regressions in the future.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1366026611",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "reviewed",
      "id": 1230825822,
      "node_id": "PRR_kwDOABII585JXOle",
      "url": null,
      "actor": null,
      "commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1230825822",
      "submitted_at": "2022-12-27T17:06:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "reviewed",
      "id": 1230889827,
      "node_id": "PRR_kwDOABII585JXeNj",
      "url": null,
      "actor": null,
      "commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1230889827",
      "submitted_at": "2022-12-27T18:00:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "commented",
      "id": 1370056781,
      "node_id": "IC_kwDOABII585RqWhN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1370056781",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-03T17:48:01Z",
      "updated_at": "2023-01-03T17:48:01Z",
      "author_association": "MEMBER",
      "body": "> From [#15363 (comment)](https://github.com/bitcoin/bitcoin/pull/15363#issuecomment-461921981):\r\n> \r\n> > The libevent HTTP interface is kind of crazy, so I don't think it's surprising that fixing this requires some trial and error. But it would be good to have tests for each issue that gets fixed to avoid going in circles.\r\n> \r\n> Suggesting to add a test which will prevent any regressions in the future.\r\n\r\n@hebasto like https://github.com/bitcoin/bitcoin/blob/7bb07bf8bd8e240562714f9cc4b7696868cb6c26/test/functional/feature_abortnode.py#L44 should take less than 5s or so?",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1370056781",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "mentioned",
      "id": 8144927549,
      "node_id": "MEE_lADOABII585Z6EGgzwAAAAHlebs9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8144927549",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-03T17:48:01Z"
    },
    {
      "event": "subscribed",
      "id": 8144927554,
      "node_id": "SE_lADOABII585Z6EGgzwAAAAHlebtC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8144927554",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-03T17:48:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8159939766,
      "node_id": "HRFPE_lADOABII585Z6EGgzwAAAAHmXsy2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8159939766",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-05T12:44:39Z"
    },
    {
      "event": "commented",
      "id": 1372172010,
      "node_id": "IC_kwDOABII585Rya7q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1372172010",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-05T12:47:09Z",
      "updated_at": "2023-01-05T12:47:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > From [#15363 (comment)](https://github.com/bitcoin/bitcoin/pull/15363#issuecomment-461921981):\r\n> > > The libevent HTTP interface is kind of crazy, so I don't think it's surprising that fixing this requires some trial and error. But it would be good to have tests for each issue that gets fixed to avoid going in circles.\r\n> > \r\n> > \r\n> > Suggesting to add a test which will prevent any regressions in the future.\r\n> \r\n> @hebasto like\r\n> \r\n> https://github.com/bitcoin/bitcoin/blob/7bb07bf8bd8e240562714f9cc4b7696868cb6c26/test/functional/feature_abortnode.py#L44\r\n> \r\n> should take less than 5s or so?\r\n\r\nI have updated the test and it seems to be reliably failing on master, so I think this is a good enough regression test @hebasto ?\r\n\r\nAlso addressed other comments by @hebasto .",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1372172010",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "mentioned",
      "id": 8159957049,
      "node_id": "MEE_lADOABII585Z6EGgzwAAAAHmXxA5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8159957049",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-05T12:47:09Z"
    },
    {
      "event": "subscribed",
      "id": 8159957061,
      "node_id": "SE_lADOABII585Z6EGgzwAAAAHmXxBF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8159957061",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-05T12:47:10Z"
    },
    {
      "event": "reviewed",
      "id": 1237467909,
      "node_id": "PRR_kwDOABII585JwkMF",
      "url": null,
      "actor": null,
      "commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Approach ACK 6d3a848fc76f76af2b2b262011f37be952325b44.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1237467909",
      "submitted_at": "2023-01-05T14:24:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "reviewed",
      "id": 1237698918,
      "node_id": "PRR_kwDOABII585Jxclm",
      "url": null,
      "actor": null,
      "commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK 6d3a848fc\r\n\r\nCan anyone please confirm or correct my understanding of why this so much faster?\r\n\r\nMy current understanding is that even when all of the workers in `g_thread_http_workers` have terminated (i.e. the entire queue is processed and `running==false`), the http server thread `g_thread_http` does not return (when joining) immediately because there are still some idle connections _(with whom?)_ open, preventing the server from shutting down. By first (instead of afterwards) calling `evhttp_free(eventHTTP)`, we can safely destroy the server even if connections are still open (but all requests are handled), causing `g_thread_http.join()` to return immediately in `StopHTTPServer()` as opposed to waiting for a timeout.\r\n\r\nI think the commit and PR message would benefit from a more clear reason why this works.\r\n",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1237698918",
      "submitted_at": "2023-01-06T18:17:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8181270197,
      "node_id": "HRFPE_lADOABII585Z6EGgzwAAAAHnpEa1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8181270197",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T12:25:25Z"
    },
    {
      "event": "commented",
      "id": 1375580720,
      "node_id": "IC_kwDOABII585R_bIw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1375580720",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T12:52:18Z",
      "updated_at": "2023-01-09T12:52:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Can anyone please confirm or correct my understanding of why this so much faster?\r\n> \r\n> My current understanding is that even when all of the workers in `g_thread_http_workers` have terminated (i.e. the entire queue is processed and `running==false`), the http server thread `g_thread_http` does not return (when joining) immediately because there are still some idle connections _(with whom?)_ open, preventing the server from shutting down. By first (instead of afterwards) calling `evhttp_free(eventHTTP)`, we can safely destroy the server even if connections are still open (but all requests are handled), causing `g_thread_http.join()` to return immediately in `StopHTTPServer()` as opposed to waiting for a timeout.\r\n\r\nSounds good to me. I guess libevent doesn't close the idle connection as an optimization (less overhead if the client wants to send more requests) and if the client doesn't close them then we are seeing this issue. I would add that the overhead that we see in the functional test is the timeout we have configured on the http server ourselves [here](https://github.com/bitcoin/bitcoin/blob/master/src/httpserver.h#L14).\r\n",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1375580720",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "commented",
      "id": 1375705311,
      "node_id": "IC_kwDOABII585R_5jf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1375705311",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T14:27:30Z",
      "updated_at": "2023-01-09T14:27:30Z",
      "author_association": "MEMBER",
      "body": "> I guess libevent doesn't close the idle connection as an optimization (less overhead if the client wants to send more requests) and if the client doesn't close them then we are seeing this issue.\r\n\r\nNot really an optimization of libevent, `AuthServiceProxy` used in the test framework creates a persistent connection (to reuse the same connection for consecutive HTTP requests, as @fjahr says).",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1375705311",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "mentioned",
      "id": 8182347326,
      "node_id": "MEE_lADOABII585Z6EGgzwAAAAHntLY-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8182347326",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T14:27:30Z"
    },
    {
      "event": "subscribed",
      "id": 8182347341,
      "node_id": "SE_lADOABII585Z6EGgzwAAAAHntLZN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8182347341",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-09T14:27:31Z"
    },
    {
      "event": "reviewed",
      "id": 1240762906,
      "node_id": "PRR_kwDOABII585J9Ioa",
      "url": null,
      "actor": null,
      "commit_id": "55bbf04adc4879dcacd135f40aa053e60032af4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK. With this change `evhttp_free` is called after all requests are completed. Calling `evhttp_free` at this point will cause all active connections to close and nothing remains on the event base, and all RPC threads are ready to be joined. As mentioned above, this is useful to avoid hitting the idle timeout.\r\n\r\nNote that shutdown still hangs while a request is in-flight.",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1240762906",
      "submitted_at": "2023-01-09T16:12:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "reviewed",
      "id": 1243146112,
      "node_id": "PRR_kwDOABII585KGOeA",
      "url": null,
      "actor": null,
      "commit_id": "55bbf04adc4879dcacd135f40aa053e60032af4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1243146112",
      "submitted_at": "2023-01-11T00:29:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "reviewed",
      "id": 1243713404,
      "node_id": "PRR_kwDOABII585KIY98",
      "url": null,
      "actor": null,
      "commit_id": "55bbf04adc4879dcacd135f40aa053e60032af4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK https://github.com/bitcoin/bitcoin/commit/55bbf04adc4879dcacd135f40aa053e60032af4b\r\n\r\nI have some open suggestions, but I'm happy with the PR as it is.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1243713404",
      "submitted_at": "2023-01-11T11:46:42Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhjNmQwMDdjODBkYzNmZWM1Y2U2YzAxOTYzODE0NDRhNWVkN2U0MjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8c6d007c80dc3fec5ce6c0196381444a5ed7e424",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8c6d007c80dc3fec5ce6c0196381444a5ed7e424",
      "tree": {
        "sha": "a1d505fd7bfc57ddc2acbfecf51a64e531c7ce7d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a1d505fd7bfc57ddc2acbfecf51a64e531c7ce7d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a1d505fd7bfc57ddc2acbfecf51a64e531c7ce7d\nparent f3bc1a72825fe2b51f4bc20e004cef464f05b965\nauthor JoÃ£o Barbosa <joao.paulo.barbosa@gmail.com> 1593471947 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1676057698 +0100\n\nhttp: Track active requests and wait for last to finish\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmPmnGUVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNAwsQAIEZ/4hupQ8dreq9E/4K9hsyEuIT\ntrY7k8WI10P3k1np0NV111vzWf3gQj7I7TcdpogL2ghYDCDJtKoxFXjlujsz8B7s\nHTcVf1XyOG1crkREYQuFghcbbKkWUb4ME4AgHItEX2WsZfqkXZHeWq7t6mivpI1m\n8J8f456AOArV8/Iw/Q2PWun8LZJdNfSXKA5LWYPaj+XknvkRF6JqkFw2iPDFvLT3\nEJ+miRRd319Up69v4JbboMXknI4k88YcNr6ozIOpKHwTAHopFFHczrBKmSiWzyK0\ncaeqrczYVoRPLb10UUZigUCA3b6GvESgcdmm04GDjf9/VTYrCYx5IHbK1SaZCU8l\n2TiVWs8Qi4JgBQDeykXxC0thmB5U7kMejjdR3SqjKw7IGxs4QussPPtGIF3k0LzU\nOev7rGlhtUaj83j4cQMUGnO4Zgs/UcegxZ9DW/qp7OoUtifVIbdU+qds2Zz6YMJT\nZygwVvJF8JSnn/75vEzq8Vy+rsVKY48rx1hGLCCm0W63x5o3xokxMAnVPPkye52v\nlkBQgxHhCzUayjaNZ5E09ePxBXEtzxgeht5y87oho0ISk0/DbrCVcPESOHFSJw+K\nlAzaqyhStudvwoHi7NdX5u8XlFo4aza2se9PmJ9n/oIyd9YsbpIN2qA9rEtFL8Ll\ncpdpm8DSGII75oiI\n=MUzr\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f3bc1a72825fe2b51f4bc20e004cef464f05b965",
          "sha": "f3bc1a72825fe2b51f4bc20e004cef464f05b965",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f3bc1a72825fe2b51f4bc20e004cef464f05b965"
        }
      ],
      "message": "http: Track active requests and wait for last to finish",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2023-02-10T19:34:58Z"
      },
      "author": {
        "name": "JoÃ£o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2020-06-29T23:05:47Z"
      },
      "sha": "8c6d007c80dc3fec5ce6c0196381444a5ed7e424"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY2MGJkYmY3ODVhMzIwMjRmMDY5NDkxNWZhMDQzOTY4YTBhZmI1NzM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/660bdbf785a32024f0694915fa043968a0afb573",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/660bdbf785a32024f0694915fa043968a0afb573",
      "tree": {
        "sha": "5cb241d765f1705a93c8d6fe19f4f3afb69e6368",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5cb241d765f1705a93c8d6fe19f4f3afb69e6368"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5cb241d765f1705a93c8d6fe19f4f3afb69e6368\nparent 8c6d007c80dc3fec5ce6c0196381444a5ed7e424\nauthor JoÃ£o Barbosa <joao.paulo.barbosa@gmail.com> 1564797173 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1676057701 +0100\n\nhttp: Release server before waiting for event base loop exit\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmPmnGUVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNBuIP/2xGoJibgWlDr4gmAJVK0Q9zPWRz\nohh1LHuvwLPyco/SPnZXjSFykgiD9xUITdoG7ZdLDIsXu4C4NLMtL1venzGKV1oT\nc0wQLnOZ49xQjlZ9ljbS6LLasFERNGAZbFmb9gGPYOyGF+do0nXIslJH8V54rzJv\n/kddfg3Q+ysL+vLzu4VEJq/AOJpKuhAfi+NVnoPyjvKrcbSAMBhYvX76XdfaRDnI\n4gnlCD4O4iaQnTrQLJd/POYWlV2Qcq1u7bLY3+9vJZ6q8/zIxyabhQtffJ910Kb9\nbOt3nRKExQEe51XNMR0xfzVXXtPs2JuYUusDKMPM5bscQZgSPQAvm6YztT7i8gRx\nQwjrZiMcbje5EUaDtJn0K+VdwLOC9E6gbH+h85x2RSgeqYPHzklsRFkFHLi+FcmS\n4zTRYB67zjopxtpF9dAFeyhgQvzy2WWldBPGNuklXPP4JwDSUwDRLQqF7KZUM3YN\nTJ/IWtqr93inbjmzabGOzSUYtlw3Xi6skPB6RmyyZogAIiI0UdUZzqDgt6SC+IwA\nAmxK9AfDVaba/NF/Kk/M8R1lj1vm/m1L4v/x2NV/scNSCv9iQfmsOVXDLYJ+L0W2\n6meQaTUDyN1YvazlqpwWkcMwXVLgG4kLLB4a8qYF2DC3JpIYWrDK1+Utpq/USun0\nlxqyH4U+YG/3Ccte\n=vMej\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8c6d007c80dc3fec5ce6c0196381444a5ed7e424",
          "sha": "8c6d007c80dc3fec5ce6c0196381444a5ed7e424",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8c6d007c80dc3fec5ce6c0196381444a5ed7e424"
        }
      ],
      "message": "http: Release server before waiting for event base loop exit",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2023-02-10T19:35:01Z"
      },
      "author": {
        "name": "JoÃ£o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-08-03T01:52:53Z"
      },
      "sha": "660bdbf785a32024f0694915fa043968a0afb573"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYwOTc4YzgwODBlYzEzZmY0NTcxYzhhODllNzQyNTE3YjJhY2E2OTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60978c8080ec13ff4571c8a89e742517b2aca692",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/60978c8080ec13ff4571c8a89e742517b2aca692",
      "tree": {
        "sha": "29be8ca412c607d85f7b62de022a0acf0586bceb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/29be8ca412c607d85f7b62de022a0acf0586bceb"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 29be8ca412c607d85f7b62de022a0acf0586bceb\nparent 660bdbf785a32024f0694915fa043968a0afb573\nauthor Fabian Jahr <fjahr@protonmail.com> 1672919779 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1676057702 +0100\n\ntest: Reduce extended timeout on abortnode test\n\nThis was made obsolete by tracking the active requests and explicitly waiting for them to finish before shutdown.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmPmnGYVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNrikP/1iDkLbWD65vTdsctRTiFEMVxLi6\n6D9gWXxxteztXieynCPm8D2Y+bdputG2T0fw8o3UfRyP8+UCtq+bUMIFKVVlWj2E\nT7dvOXE+fk96bLp4ISpzfENcIPxDB6ohnrtJXuW9xscgegW2OQ4dbfeCEfv4j7pm\n/iAhi5dy0h193HWjCHhTXVWXTNn5/PUuHoito0YfeDLYNUBqHgED/AYz7s5i1gUh\nf/LDvxdfJZO6Cn3huWDsxKWx/ervP4dl3R3pxWKe24zF+GUSHQ2+LgntAo9Q8R4R\n0RK7abFHHGgX5dA1mHZncTpXckZmy5jeWAqcUxKigKpNfOY8kzdIJiYOaLcfS0Ue\nd3Mv7x7joA+Mnt8SyhMs/TIs1RZHdEvfH8H6MGKDftAOvbnu0XZdV+prss6p39XS\nEwZ6jr56KKMOSoDAyDjAq5ymyidS3nVsilpSBPQbjokyLtM94ZbSObsDvb++IOOB\nxiI7m/u1GTDU7QHhOkhVB6+Qk1xDJ/GgZompOSHfELhA3kEI8TV4IAP7ZOasnu9M\nfzPgeUN5MJXlP30ajTORQh2zyUBKu9GlgXXIibMz0qOzbd9ayEUTutoYpOW3jEfK\nEwBJJef5jWDTiGnCQfaNMQiGHrF0vEhOIJ66R27l3GOhCPjHxs3CxWMl4xjUoQc4\n16H5SxbDEp75yRQd\n=1kIF\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/660bdbf785a32024f0694915fa043968a0afb573",
          "sha": "660bdbf785a32024f0694915fa043968a0afb573",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/660bdbf785a32024f0694915fa043968a0afb573"
        }
      ],
      "message": "test: Reduce extended timeout on abortnode test\n\nThis was made obsolete by tracking the active requests and explicitly waiting for them to finish before shutdown.",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2023-02-10T19:35:02Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2023-01-05T11:56:19Z"
      },
      "sha": "60978c8080ec13ff4571c8a89e742517b2aca692"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8493196749,
      "node_id": "HRFPE_lADOABII585Z6EGgzwAAAAH6O-XN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8493196749",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T19:45:24Z"
    },
    {
      "event": "commented",
      "id": 1426261216,
      "node_id": "IC_kwDOABII585VAwTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1426261216",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T19:47:13Z",
      "updated_at": "2023-02-10T19:47:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "Addressed comments by @promag and @stickies-v ",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1426261216",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "mentioned",
      "id": 8493208501,
      "node_id": "MEE_lADOABII585Z6EGgzwAAAAH6PBO1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8493208501",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T19:47:13Z"
    },
    {
      "event": "subscribed",
      "id": 8493208526,
      "node_id": "SE_lADOABII585Z6EGgzwAAAAH6PBPO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8493208526",
      "actor": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T19:47:13Z"
    },
    {
      "event": "mentioned",
      "id": 8493208539,
      "node_id": "MEE_lADOABII585Z6EGgzwAAAAH6PBPb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8493208539",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T19:47:13Z"
    },
    {
      "event": "subscribed",
      "id": 8493208550,
      "node_id": "SE_lADOABII585Z6EGgzwAAAAH6PBPm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8493208550",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T19:47:13Z"
    },
    {
      "event": "reviewed",
      "id": 1294521747,
      "node_id": "PRR_kwDOABII585NKNWT",
      "url": null,
      "actor": null,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK [60978c8](https://github.com/bitcoin/bitcoin/commit/60978c8080ec13ff4571c8a89e742517b2aca692)",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1294521747",
      "submitted_at": "2023-02-11T12:36:04Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "review_requested",
      "id": 8496389866,
      "node_id": "RRE_lADOABII585Z6EGgzwAAAAH6bJ7q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8496389866",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-11T12:36:08Z",
      "requested_reviewer": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1319862109,
      "node_id": "PRR_kwDOABII585Oq39d",
      "url": null,
      "actor": null,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK 60978c8080ec13ff4571c8a89e742517b2aca692",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#pullrequestreview-1319862109",
      "submitted_at": "2023-03-01T13:40:54Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
    },
    {
      "event": "comment_deleted",
      "id": 8666660300,
      "node_id": "CDE_lADOABII585Z6EGgzwAAAAIEkr3M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8666660300",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-04T19:48:18Z"
    },
    {
      "event": "review_request_removed",
      "id": 8667635888,
      "node_id": "RRRE_lADOABII585Z6EGgzwAAAAIEoaCw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8667635888",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-05T09:45:41Z",
      "requested_reviewer": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 8667635890,
      "node_id": "RRE_lADOABII585Z6EGgzwAAAAIEoaCy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8667635890",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-05T09:45:41Z",
      "requested_reviewer": {
        "login": "john-moffett",
        "id": 116917595,
        "node_id": "U_kgDOBvgFWw",
        "avatar_url": "https://avatars.githubusercontent.com/u/116917595?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-moffett",
        "html_url": "https://github.com/john-moffett",
        "followers_url": "https://api.github.com/users/john-moffett/followers",
        "following_url": "https://api.github.com/users/john-moffett/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/john-moffett/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/john-moffett/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/john-moffett/subscriptions",
        "organizations_url": "https://api.github.com/users/john-moffett/orgs",
        "repos_url": "https://api.github.com/users/john-moffett/repos",
        "events_url": "https://api.github.com/users/john-moffett/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/john-moffett/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 8673931328,
      "node_id": "RRE_lADOABII585Z6EGgzwAAAAIFAbBA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8673931328",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-06T12:49:48Z",
      "requested_reviewer": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "commented",
      "id": 1457271622,
      "node_id": "IC_kwDOABII585W3DNG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1457271622",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-07T00:29:49Z",
      "updated_at": "2023-03-07T00:29:49Z",
      "author_association": "MEMBER",
      "body": "ACK 60978c8080ec13ff4571c8a89e742517b2aca692",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#issuecomment-1457271622",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26742"
    },
    {
      "event": "merged",
      "id": 8680298023,
      "node_id": "ME_lADOABII585Z6EGgzwAAAAIFYtYn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8680298023",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "86bacd75e76eff207ef8f7bdb897365f5b6e7b6b",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/86bacd75e76eff207ef8f7bdb897365f5b6e7b6b",
      "created_at": "2023-03-07T00:36:20Z"
    },
    {
      "event": "closed",
      "id": 8680298053,
      "node_id": "CE_lADOABII585Z6EGgzwAAAAIFYtZF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8680298053",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-07T00:36:21Z"
    },
    {
      "event": "referenced",
      "id": 8681605111,
      "node_id": "REFE_lADOABII585Z6EGgzwAAAAIFdsf3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8681605111",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "61edeffbd5e580056865e45ce476b89f463e9059",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/61edeffbd5e580056865e45ce476b89f463e9059",
      "created_at": "2023-03-07T05:02:29Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-22T23:06:28Z",
      "updated_at": "2023-05-22T23:06:28Z",
      "source": {
        "issue": {
          "id": 1720770400,
          "node_id": "I_kwDOABII585mkN9g",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27722",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27722/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27722/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27722/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/27722",
          "number": 27722,
          "state": "closed",
          "state_reason": "completed",
          "title": "bitcoind hangs waiting for `g_requests.empty()`",
          "body": "### Is there an existing issue for this?\r\n\r\n- [X] I have searched the existing issues\r\n\r\n### Current behaviour\r\n\r\nbitcoind hangs \r\n\r\n### Expected behaviour\r\n\r\nbitcoind shouldn't hang\r\n\r\nI was able to dump the running threads and it was stuck waiting for `g_requests` to be empty. The issue seems to be that this callback may not actually be called in case of error: https://github.com/bitcoin/bitcoin/blob/22139f6e83a2bedd2dad9f280567d2c76c54252f/src/httpserver.cpp#L222-L227\r\n\r\nSee this issue https://github.com/libevent/libevent/issues/589 for more details. I think what happens is that interrupting `bitcoin-cli` before it has received the reply calls the error callback and then the success callback is never called.\r\n\r\nI think this is also a memory leak since `g_requests` won't get cleaned up. Whether it's severe or not probably depends on the caller and what type of requests they are making. This new code was introduced here https://github.com/bitcoin/bitcoin/pull/26742\r\n\r\n### Steps to reproduce\r\n\r\nI was running a simple shell script in 4 terminal windows for fun:\r\n\r\n```\r\n#!/bin/bash\r\n\r\nfor i in {1..50000}\r\ndo\r\n\t./src/bitcoin-cli -rpcuser=admin -rpcpassword=pass getrawtransaction 217819875434324c412d5e938f7f3c1670fb60814974cf7958f1fac90ee5afb7\r\ndone\r\n```\r\n\r\nI was messing around with this script and randomly Ctrl-C'd each terminal window in rapid succession and then when I waited up to a minute and Ctrl-C'd bitcoind, it didn't shutdown. I can reproduce it pretty reliably as well.\r\n\r\nCompilation commands:\r\n```\r\n./autogen.sh; ./configure --without-wallet --with-gui=no --disable-zmq; make -j4\r\n```\r\n\r\nRun-time options (note that I was able to reproduce this with the default number of rpcthreads as well):\r\n```\r\n./src/bitcoind -txindex -rpcthreads=1 -debug\r\n```\r\n\r\nOutput of `gcc --version`:\r\n```\r\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/c++/4.2.1\r\nApple clang version 11.0.3 (clang-1103.0.32.62)\r\nTarget: x86_64-apple-darwin21.6.0\r\nThread model: posix\r\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\r\n```\r\n\r\nOutput of `g++ --version`:\r\n```\r\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/c++/4.2.1\r\nApple clang version 11.0.3 (clang-1103.0.32.62)\r\nTarget: x86_64-apple-darwin21.6.0\r\nThread model: posix\r\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\r\n```\r\n\r\nMy libevent version is 2.1.12\r\n\r\n### Relevant log output\r\n\r\n```\r\n^C2023-05-22T20:56:10Z [http] Interrupting HTTP server\r\n2023-05-22T20:56:10Z [rpc] Interrupting HTTP RPC server\r\n2023-05-22T20:56:10Z [rpc] Interrupting RPC\r\n2023-05-22T20:56:10Z tor: Thread interrupt\r\n2023-05-22T20:56:10Z Shutdown: In progress...\r\n2023-05-22T20:56:10Z [rpc] Stopping HTTP RPC server\r\n2023-05-22T20:56:10Z torcontrol thread exit\r\n2023-05-22T20:56:10Z [http] Unregistering HTTP handler for / (exactmatch 1)\r\n2023-05-22T20:56:10Z addcon thread exit\r\n2023-05-22T20:56:10Z [http] Unregistering HTTP handler for /wallet/ (exactmatch 0)\r\n2023-05-22T20:56:10Z [rpc] Stopping RPC\r\n2023-05-22T20:56:10Z net thread exit\r\n2023-05-22T20:56:10Z [rpc] RPC stopped.\r\n2023-05-22T20:56:10Z [http] Stopping HTTP server\r\n2023-05-22T20:56:10Z [http] Waiting for HTTP worker threads to exit\r\n2023-05-22T20:56:10Z [http] Exited http event loop\r\n2023-05-22T20:56:10Z [http] Waiting for 1 requests to stop HTTP server\r\n```\r\n\r\nThe important bit is the very last log line. bitcoind was still alive and periodically printed log lines about feeding dynamic environment data into the RNG.\r\n\r\n### How did you obtain Bitcoin Core\r\n\r\nCompiled from source\r\n\r\n### What version of Bitcoin Core are you using?\r\n\r\n17acb2782a66f033238340e4fb81009e7f79e97a\r\n\r\n### Operating system and version\r\n\r\nmacOS intel\r\n\r\n### Machine specifications\r\n\r\n_No response_",
          "user": {
            "login": "Crypt-iQ",
            "id": 15145615,
            "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Crypt-iQ",
            "html_url": "https://github.com/Crypt-iQ",
            "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
            "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
            "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
            "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
            "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64585,
              "node_id": "MDU6TGFiZWw2NDU4NQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
              "name": "Bug",
              "color": "FBBAAB",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/62",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/62",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/62/labels",
            "id": 9441433,
            "node_id": "MI_kwDOABII584AkBCZ",
            "number": 62,
            "state": "closed",
            "title": "25.1",
            "description": "",
            "creator": {
              "login": "fanquake",
              "id": 863730,
              "node_id": "MDQ6VXNlcjg2MzczMA==",
              "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/fanquake",
              "html_url": "https://github.com/fanquake",
              "followers_url": "https://api.github.com/users/fanquake/followers",
              "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
              "organizations_url": "https://api.github.com/users/fanquake/orgs",
              "repos_url": "https://api.github.com/users/fanquake/repos",
              "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/fanquake/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 14,
            "created_at": "2023-05-25T10:17:04Z",
            "updated_at": "2023-10-23T11:55:54Z",
            "closed_at": "2023-10-23T11:55:54Z"
          },
          "locked": false,
          "comments": 21,
          "closed_at": "2023-10-04T09:09:12Z",
          "created_at": "2023-05-22T23:05:42Z",
          "updated_at": "2023-10-26T05:19:50Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-29T16:15:58Z",
      "updated_at": "2023-09-29T16:15:58Z",
      "source": {
        "issue": {
          "id": 1919564625,
          "node_id": "PR_kwDOABII585bjZS-",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28551",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28551/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28551/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28551/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28551",
          "number": 28551,
          "state": "closed",
          "state_reason": null,
          "title": "http: bugfix: allow server shutdown in case of remote client disconnection",
          "body": "#26742 significantly increased the http server shutdown speed, but also introduced a bug (#27722 - see https://github.com/bitcoin/bitcoin/issues/27722#issuecomment-1559453982 for steps to reproduce on master) that causes http server shutdown to halt in case of a remote client disconnection. This happens because `evhttp_request_set_on_complete_cb` is never called and thus the request is never removed from `g_requests`.\r\n\r\nThis PR fixes that bug, and improves robustness of the code by encapsulating the request tracking logic. Earlier approaches (#27909, #27245, #19434) attempted to resolve this but [imo are fundamentally unsafe](https://github.com/bitcoin/bitcoin/pull/27909#discussion_r1265614783) because of differences in lifetime between an `evhttp_request` and `evhttp_connection`.\r\n\r\nWe don't need to keep track of open requests or connections, we just [need to ensure](https://github.com/bitcoin/bitcoin/pull/19420#issue-648067169) that there are no active requests on server shutdown. Because a connection can have multiple requests, and a request can be completed in various ways (the request actually being handled, or the client performing a remote disconnect), keeping a counter per connection seems like the approach with the least overhead to me.\r\n\r\nFixes #27722\r\n\r\n",
          "user": {
            "login": "stickies-v",
            "id": 69010457,
            "node_id": "MDQ6VXNlcjY5MDEwNDU3",
            "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/stickies-v",
            "html_url": "https://github.com/stickies-v",
            "followers_url": "https://api.github.com/users/stickies-v/followers",
            "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
            "organizations_url": "https://api.github.com/users/stickies-v/orgs",
            "repos_url": "https://api.github.com/users/stickies-v/repos",
            "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/stickies-v/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/60",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60/labels",
            "id": 9286970,
            "node_id": "MI_kwDOABII584AjbU6",
            "number": 60,
            "state": "closed",
            "title": "26.0",
            "description": "",
            "creator": {
              "login": "fanquake",
              "id": 863730,
              "node_id": "MDQ6VXNlcjg2MzczMA==",
              "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/fanquake",
              "html_url": "https://github.com/fanquake",
              "followers_url": "https://api.github.com/users/fanquake/followers",
              "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
              "organizations_url": "https://api.github.com/users/fanquake/orgs",
              "repos_url": "https://api.github.com/users/fanquake/repos",
              "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/fanquake/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 116,
            "created_at": "2023-04-15T11:36:05Z",
            "updated_at": "2023-12-08T10:41:40Z",
            "closed_at": "2023-12-04T13:27:46Z"
          },
          "locked": false,
          "comments": 14,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28551",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28551",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28551.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28551.patch"
          },
          "closed_at": "2023-10-04T09:09:12Z",
          "created_at": "2023-09-29T16:15:58Z",
          "updated_at": "2023-10-04T10:23:14Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 10548264383,
      "node_id": "REFE_lADOABII585Z6EGgzwAAAAJ0ub2_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10548264383",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "db7b5dfcc502a8a81c51f56fe753990ae8b3a202",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/db7b5dfcc502a8a81c51f56fe753990ae8b3a202",
      "created_at": "2023-10-04T09:09:12Z"
    },
    {
      "event": "referenced",
      "id": 10646524778,
      "node_id": "REFE_lADOABII585Z6EGgzwAAAAJ6lRNq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10646524778",
      "actor": {
        "login": "Frank-GER",
        "id": 87550788,
        "node_id": "MDQ6VXNlcjg3NTUwNzg4",
        "avatar_url": "https://avatars.githubusercontent.com/u/87550788?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Frank-GER",
        "html_url": "https://github.com/Frank-GER",
        "followers_url": "https://api.github.com/users/Frank-GER/followers",
        "following_url": "https://api.github.com/users/Frank-GER/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Frank-GER/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Frank-GER/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Frank-GER/subscriptions",
        "organizations_url": "https://api.github.com/users/Frank-GER/orgs",
        "repos_url": "https://api.github.com/users/Frank-GER/repos",
        "events_url": "https://api.github.com/users/Frank-GER/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Frank-GER/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "b0fea097051981bab6e615dc9b17b897b4dcc4fa",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/b0fea097051981bab6e615dc9b17b897b4dcc4fa",
      "created_at": "2023-10-13T17:03:36Z"
    },
    {
      "event": "locked",
      "id": 12027314886,
      "node_id": "LOE_lADOABII585Z6EGgzwAAAALM4kLG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12027314886",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-06T12:37:05Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056290646",
      "pull_request_review_id": 1228890565,
      "id": 1056290646,
      "node_id": "PRRC_kwDOABII584-9bdW",
      "diff_hunk": "@@ -146,6 +148,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static Mutex g_requests_mutex;",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "40528e777fbad0512bb657fb067ea8dc2389c02e",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe a `GlobalMutex` would be more appropriate here?\r\n\r\n```suggestion\r\nstatic GlobalMutex g_requests_mutex;\r\n```",
      "created_at": "2022-12-23T11:59:10Z",
      "updated_at": "2022-12-23T11:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056290646",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056290646"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 152,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056417241",
      "pull_request_review_id": 1229085018,
      "id": 1056417241,
      "node_id": "PRRC_kwDOABII584-96XZ",
      "diff_hunk": "@@ -146,6 +148,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static Mutex g_requests_mutex;",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "40528e777fbad0512bb657fb067ea8dc2389c02e",
      "in_reply_to_id": 1056290646,
      "user": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm still newish to the repo, is there a convention on when we should use `Mutex` vs `GlobalMutex`?",
      "created_at": "2022-12-23T15:21:47Z",
      "updated_at": "2022-12-23T15:21:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056417241",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056417241"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 152,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056453597",
      "pull_request_review_id": 1229150643,
      "id": 1056453597,
      "node_id": "PRRC_kwDOABII584--DPd",
      "diff_hunk": "@@ -146,6 +148,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static Mutex g_requests_mutex;",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "40528e777fbad0512bb657fb067ea8dc2389c02e",
      "in_reply_to_id": 1056290646,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> I'm still newish to the repo, is there a convention on when we should use `Mutex` vs `GlobalMutex`?\r\n\r\nIt depends on a scope. For the global namespace the `GlobalMutex` is an appropriate option: https://github.com/bitcoin/bitcoin/blob/f3bc1a72825fe2b51f4bc20e004cef464f05b965/src/sync.h#L132-L141",
      "created_at": "2022-12-23T16:07:21Z",
      "updated_at": "2022-12-23T16:15:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056453597",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056453597"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 152,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056466553",
      "pull_request_review_id": 1229159987,
      "id": 1056466553,
      "node_id": "PRRC_kwDOABII584--GZ5",
      "diff_hunk": "@@ -146,6 +148,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static Mutex g_requests_mutex;",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "40528e777fbad0512bb657fb067ea8dc2389c02e",
      "in_reply_to_id": 1056290646,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Maybe a `GlobalMutex` would be more appropriate here?\r\n\r\nThis suggestion must fix the following [errors](https://api.cirrus-ci.com/v1/task/5176219491106816/logs/ci.log):\r\n```\r\nhttpserver.cpp:221:13: error: calling function 'MaybeCheckNotHeld' requires negative capability '!g_requests_mutex' [-Werror,-Wthread-safety-analysis]\r\n            LOCK(g_requests_mutex);\r\n            ^\r\n./sync.h:258:56: note: expanded from macro 'LOCK'\r\n#define LOCK(cs) UniqueLock UNIQUE_NAME(criticalblock)(MaybeCheckNotHeld(cs), #cs, __FILE__, __LINE__)\r\n                                                       ^\r\nhttpserver.cpp:218:9: error: calling function 'MaybeCheckNotHeld' requires negative capability '!g_requests_mutex' [-Werror,-Wthread-safety-analysis]\r\n        LOCK(g_requests_mutex);\r\n        ^\r\n./sync.h:258:56: note: expanded from macro 'LOCK'\r\n#define LOCK(cs) UniqueLock UNIQUE_NAME(criticalblock)(MaybeCheckNotHeld(cs), #cs, __FILE__, __LINE__)\r\n                                                       ^\r\nhttpserver.cpp:481:9: error: calling function 'MaybeCheckNotHeld' requires negative capability '!g_requests_mutex' [-Werror,-Wthread-safety-analysis]\r\n        WAIT_LOCK(g_requests_mutex, lock);\r\n        ^\r\n./sync.h:263:45: note: expanded from macro 'WAIT_LOCK'\r\n#define WAIT_LOCK(cs, name) UniqueLock name(MaybeCheckNotHeld(cs), #cs, __FILE__, __LINE__)\r\n                                            ^\r\n3 errors generated.\r\n```",
      "created_at": "2022-12-23T16:14:16Z",
      "updated_at": "2022-12-23T16:14:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056466553",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056466553"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 152,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056684955",
      "pull_request_review_id": 1229452700,
      "id": 1056684955,
      "node_id": "PRRC_kwDOABII584--7ub",
      "diff_hunk": "@@ -459,14 +477,22 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);\n+        }\n+    }\n+    if (eventHTTP) {\n+        event_base_once(eventBase, -1, EV_TIMEOUT, [](evutil_socket_t, short, void*) {",
      "path": "src/httpserver.cpp",
      "position": 74,
      "original_position": 54,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "in_reply_to_id": null,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "maybe include a comment explaining this, see https://github.com/bitcoin/bitcoin/pull/19420#discussion_r833476744. At this point, it is possible that on`g_thread_http` the `eventHTTP` struct is being used.",
      "created_at": "2022-12-23T23:15:38Z",
      "updated_at": "2022-12-23T23:22:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056684955",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056684955"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 493,
      "original_line": 493,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056685160",
      "pull_request_review_id": 1229452951,
      "id": 1056685160,
      "node_id": "PRRC_kwDOABII584--7xo",
      "diff_hunk": "@@ -207,6 +213,18 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when last active request is completed.\n+    {\n+        LOCK(g_requests_mutex);\n+        g_requests.insert(req);\n+        evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\n+            LOCK(g_requests_mutex);\n+            auto n = g_requests.erase(req);\n+            assert(n == 1);\n+            if (g_requests.empty()) g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "in_reply_to_id": null,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "maybe always call `g_requests_cv.notify_all()` and update comment above.",
      "created_at": "2022-12-23T23:17:07Z",
      "updated_at": "2022-12-23T23:23:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056685160",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056685160"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 224,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056685560",
      "pull_request_review_id": 1229452951,
      "id": 1056685560,
      "node_id": "PRRC_kwDOABII584--734",
      "diff_hunk": "@@ -459,14 +477,22 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 50,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "in_reply_to_id": null,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "maybe log \"Waiting for %d requests to stop HTTP server\" or something like that.",
      "created_at": "2022-12-23T23:19:05Z",
      "updated_at": "2022-12-23T23:23:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056685560",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056685560"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 487,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056843393",
      "pull_request_review_id": 1229663708,
      "id": 1056843393,
      "node_id": "PRRC_kwDOABII584-_iaB",
      "diff_hunk": "@@ -207,6 +213,18 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when last active request is completed.\n+    {\n+        LOCK(g_requests_mutex);\n+        g_requests.insert(req);\n+        evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\n+            LOCK(g_requests_mutex);\n+            auto n = g_requests.erase(req);\n+            assert(n == 1);\n+            if (g_requests.empty()) g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "in_reply_to_id": 1056685160,
      "user": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "why would we want to always call `.notify_all()` if we are waiting for all the http requests to finish?",
      "created_at": "2022-12-24T15:54:44Z",
      "updated_at": "2022-12-24T15:54:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056843393",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056843393"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 224,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056847000",
      "pull_request_review_id": 1229667937,
      "id": 1056847000,
      "node_id": "PRRC_kwDOABII584-_jSY",
      "diff_hunk": "@@ -207,6 +213,18 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when last active request is completed.\n+    {\n+        LOCK(g_requests_mutex);\n+        g_requests.insert(req);\n+        evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\n+            LOCK(g_requests_mutex);\n+            auto n = g_requests.erase(req);\n+            assert(n == 1);\n+            if (g_requests.empty()) g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "in_reply_to_id": 1056685160,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "because that way you would get a log every time a connection closes. Otherwise `g_requests_cv` should be renamed to `g_requests_empty_cv`.\r\n\r\nIf `g_requests_cv` is used to signal changes to `g_requests` then also add call `.notify_all()` after `g_requests.insert(req)`.",
      "created_at": "2022-12-24T16:14:22Z",
      "updated_at": "2022-12-24T16:14:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056847000",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056847000"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 224,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056946375",
      "pull_request_review_id": 1229739963,
      "id": 1056946375,
      "node_id": "PRRC_kwDOABII584-_7jH",
      "diff_hunk": "@@ -146,6 +148,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static Mutex g_requests_mutex;",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "40528e777fbad0512bb657fb067ea8dc2389c02e",
      "in_reply_to_id": 1056290646,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done, errors are fixed. Thanks!",
      "created_at": "2022-12-25T12:33:00Z",
      "updated_at": "2022-12-25T12:33:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056946375",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056946375"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 152,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056987595",
      "pull_request_review_id": 1229770200,
      "id": 1056987595,
      "node_id": "PRRC_kwDOABII584_AFnL",
      "diff_hunk": "@@ -459,14 +477,22 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 50,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "in_reply_to_id": 1056685560,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2022-12-25T18:56:17Z",
      "updated_at": "2022-12-25T18:56:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056987595",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056987595"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 487,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056987708",
      "pull_request_review_id": 1229770232,
      "id": 1056987708,
      "node_id": "PRRC_kwDOABII584_AFo8",
      "diff_hunk": "@@ -207,6 +213,18 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when last active request is completed.\n+    {\n+        LOCK(g_requests_mutex);\n+        g_requests.insert(req);\n+        evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\n+            LOCK(g_requests_mutex);\n+            auto n = g_requests.erase(req);\n+            assert(n == 1);\n+            if (g_requests.empty()) g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "in_reply_to_id": 1056685160,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done, I have opted for always calling it",
      "created_at": "2022-12-25T18:56:50Z",
      "updated_at": "2022-12-25T18:56:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056987708",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056987708"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 224,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056987813",
      "pull_request_review_id": 1229770283,
      "id": 1056987813,
      "node_id": "PRRC_kwDOABII584_AFql",
      "diff_hunk": "@@ -459,14 +477,22 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);\n+        }\n+    }\n+    if (eventHTTP) {\n+        event_base_once(eventBase, -1, EV_TIMEOUT, [](evutil_socket_t, short, void*) {",
      "path": "src/httpserver.cpp",
      "position": 74,
      "original_position": 54,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "b9b8b5d2ca9fe43a777f4756e9399dcdb967c22c",
      "in_reply_to_id": 1056684955,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done, I hope that covers it.",
      "created_at": "2022-12-25T18:57:53Z",
      "updated_at": "2022-12-25T18:57:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056987813",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1056987813"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 493,
      "original_line": 493,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057353934",
      "pull_request_review_id": 1230240081,
      "id": 1057353934,
      "node_id": "PRRC_kwDOABII584_BfDO",
      "diff_hunk": "@@ -459,14 +478,28 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        if (!g_requests.empty()) {\n+            LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\n+        }\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": null,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "my suggestion was to add the log here in the loop.",
      "created_at": "2022-12-26T22:16:15Z",
      "updated_at": "2022-12-26T22:16:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1057353934",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057353934"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 487,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057781251",
      "pull_request_review_id": 1230825822,
      "id": 1057781251,
      "node_id": "PRRC_kwDOABII584_DHYD",
      "diff_hunk": "@@ -207,6 +213,19 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        LOCK(g_requests_mutex);\n+        g_requests.insert(req);\n+        g_requests_cv.notify_all();\n+        evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\n+            LOCK(g_requests_mutex);\n+            auto n = g_requests.erase(req);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Calling `notify_all()` while holding a mutex is a pessimization. Suggesting to apply a diff:\r\n```suggestion\r\n            auto n = WITH_LOCK(g_requests_mutex, return g_requests.erase(req));\r\n```",
      "created_at": "2022-12-27T16:40:00Z",
      "updated_at": "2022-12-27T17:06:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1057781251",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057781251"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 222,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 223,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057781323",
      "pull_request_review_id": 1230825822,
      "id": 1057781323,
      "node_id": "PRRC_kwDOABII584_DHZL",
      "diff_hunk": "@@ -207,6 +213,19 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        LOCK(g_requests_mutex);\n+        g_requests.insert(req);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 31,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Calling `notify_all()` while holding a mutex is a pessimization. Suggesting to apply a diff:\r\n```suggestion\r\n        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\r\n```\r\nor to introduce a new scope.",
      "created_at": "2022-12-27T16:40:11Z",
      "updated_at": "2022-12-27T17:06:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1057781323",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057781323"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 218,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 219,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057794988",
      "pull_request_review_id": 1230825822,
      "id": 1057794988,
      "node_id": "PRRC_kwDOABII584_DKus",
      "diff_hunk": "@@ -459,14 +478,28 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        if (!g_requests.empty()) {\n+            LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\n+        }\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);\n+        }",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 55,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "While this code snippet is used across the current codebase, for new code I'd prefer another `wait()` overload with an \"inlined\" `stop_waiting` condition:\r\n```suggestion\r\n        g_requests_cv.wait(lock, []() EXCLUSIVE_LOCKS_REQUIRED(g_requests_mutex) { return g_requests.empty(); });\r\n```",
      "created_at": "2022-12-27T16:59:24Z",
      "updated_at": "2022-12-27T17:06:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1057794988",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057794988"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 486,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 488,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057798365",
      "pull_request_review_id": 1230825822,
      "id": 1057798365,
      "node_id": "PRRC_kwDOABII584_DLjd",
      "diff_hunk": "@@ -146,6 +148,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is any particular reason for not using `std::unordered_set` which has more efficient `insert()` and `erase()` methods?",
      "created_at": "2022-12-27T17:06:11Z",
      "updated_at": "2022-12-27T17:06:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1057798365",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057798365"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057827695",
      "pull_request_review_id": 1230889827,
      "id": 1057827695,
      "node_id": "PRRC_kwDOABII584_DStv",
      "diff_hunk": "@@ -459,14 +478,28 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        if (!g_requests.empty()) {\n+            LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\n+        }\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);\n+        }\n+    }\n+    if (eventHTTP) {\n+        // Schedule a callback to call evhttp_free in the event base thread, so\n+        // that evhttp_free does not need to be called again after the handling\n+        // of unfinished request connections that follows.\n+        event_base_once(eventBase, -1, EV_TIMEOUT, [](evutil_socket_t, short, void*) {\n+            evhttp_free(eventHTTP);\n+            eventHTTP = nullptr;\n+        }, nullptr, nullptr);\n+    }\n     if (eventBase) {\n         LogPrint(BCLog::HTTP, \"Waiting for HTTP event thread to exit\\n\");\n         if (g_thread_http.joinable()) g_thread_http.join();\n     }\n-    if (eventHTTP) {\n-        evhttp_free(eventHTTP);\n-        eventHTTP = nullptr;\n-    }\n     if (eventBase) {",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 74,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Combine two `if (eventBase)` blocks into a single one?",
      "created_at": "2022-12-27T18:00:27Z",
      "updated_at": "2022-12-27T18:00:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1057827695",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1057827695"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 499,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 503,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1060815427",
      "pull_request_review_id": 1234903247,
      "id": 1060815427,
      "node_id": "PRRC_kwDOABII584_OsJD",
      "diff_hunk": "@@ -146,6 +148,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": 1057798365,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No reason, should be a small set anyway, both are fine IMHO.",
      "created_at": "2023-01-03T17:45:00Z",
      "updated_at": "2023-01-03T17:45:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1060815427",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1060815427"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062432864",
      "pull_request_review_id": 1237333989,
      "id": 1062432864,
      "node_id": "PRRC_kwDOABII584_U3Bg",
      "diff_hunk": "@@ -459,14 +478,28 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        if (!g_requests.empty()) {\n+            LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\n+        }\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);\n+        }\n+    }\n+    if (eventHTTP) {\n+        // Schedule a callback to call evhttp_free in the event base thread, so\n+        // that evhttp_free does not need to be called again after the handling\n+        // of unfinished request connections that follows.\n+        event_base_once(eventBase, -1, EV_TIMEOUT, [](evutil_socket_t, short, void*) {\n+            evhttp_free(eventHTTP);\n+            eventHTTP = nullptr;\n+        }, nullptr, nullptr);\n+    }\n     if (eventBase) {\n         LogPrint(BCLog::HTTP, \"Waiting for HTTP event thread to exit\\n\");\n         if (g_thread_http.joinable()) g_thread_http.join();\n     }\n-    if (eventHTTP) {\n-        evhttp_free(eventHTTP);\n-        eventHTTP = nullptr;\n-    }\n     if (eventBase) {",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 74,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": 1057827695,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2023-01-05T12:43:59Z",
      "updated_at": "2023-01-05T12:44:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062432864",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062432864"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 499,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 503,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062432926",
      "pull_request_review_id": 1237334064,
      "id": 1062432926,
      "node_id": "PRRC_kwDOABII584_U3Ce",
      "diff_hunk": "@@ -146,6 +148,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": 1057798365,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2023-01-05T12:44:03Z",
      "updated_at": "2023-01-05T12:44:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062432926",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062432926"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062433014",
      "pull_request_review_id": 1237334154,
      "id": 1062433014,
      "node_id": "PRRC_kwDOABII584_U3D2",
      "diff_hunk": "@@ -459,14 +478,28 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        if (!g_requests.empty()) {\n+            LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\n+        }\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);\n+        }",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 55,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": 1057794988,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2023-01-05T12:44:08Z",
      "updated_at": "2023-01-05T12:44:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062433014",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062433014"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 486,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 488,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062433112",
      "pull_request_review_id": 1237334247,
      "id": 1062433112,
      "node_id": "PRRC_kwDOABII584_U3FY",
      "diff_hunk": "@@ -207,6 +213,19 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        LOCK(g_requests_mutex);\n+        g_requests.insert(req);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 31,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": 1057781323,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2023-01-05T12:44:12Z",
      "updated_at": "2023-01-05T12:44:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062433112",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062433112"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 218,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 219,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062433226",
      "pull_request_review_id": 1237334348,
      "id": 1062433226,
      "node_id": "PRRC_kwDOABII584_U3HK",
      "diff_hunk": "@@ -207,6 +213,19 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        LOCK(g_requests_mutex);\n+        g_requests.insert(req);\n+        g_requests_cv.notify_all();\n+        evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\n+            LOCK(g_requests_mutex);\n+            auto n = g_requests.erase(req);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": 1057781251,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2023-01-05T12:44:18Z",
      "updated_at": "2023-01-05T12:44:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062433226",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062433226"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 222,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 223,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062434858",
      "pull_request_review_id": 1237336008,
      "id": 1062434858,
      "node_id": "PRRC_kwDOABII584_U3gq",
      "diff_hunk": "@@ -459,14 +478,28 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        if (!g_requests.empty()) {\n+            LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\n+        }\n+        while (!g_requests.empty()) {\n+            g_requests_cv.wait(lock);",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "f95063efb9c23765671f72a1f14eb66634cb3988",
      "in_reply_to_id": 1057353934,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah, I think doing it in the loop essentially creates a countdown that I didn't think was necessary. But I am kind of indifferent on this, so I have changed it now.",
      "created_at": "2023-01-05T12:45:41Z",
      "updated_at": "2023-01-05T12:45:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062434858",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062434858"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 487,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062524049",
      "pull_request_review_id": 1237467909,
      "id": 1062524049,
      "node_id": "PRRC_kwDOABII584_VNSR",
      "diff_hunk": "@@ -459,15 +477,27 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n-    if (eventBase) {\n-        LogPrint(BCLog::HTTP, \"Waiting for HTTP event thread to exit\\n\");\n-        if (g_thread_http.joinable()) g_thread_http.join();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        g_requests_cv.wait(lock, []() EXCLUSIVE_LOCKS_REQUIRED(g_requests_mutex) {\n+                if (!g_requests.empty()) {\n+                    LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\n+                }\n+                return g_requests.empty();",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: Isn't indentation too big?",
      "created_at": "2023-01-05T14:20:00Z",
      "updated_at": "2023-01-05T14:24:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062524049",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062524049"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 483,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 486,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062528172",
      "pull_request_review_id": 1237467909,
      "id": 1062528172,
      "node_id": "PRRC_kwDOABII584_VOSs",
      "diff_hunk": "@@ -459,15 +477,27 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n-    if (eventBase) {\n-        LogPrint(BCLog::HTTP, \"Waiting for HTTP event thread to exit\\n\");\n-        if (g_thread_http.joinable()) g_thread_http.join();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        g_requests_cv.wait(lock, []() EXCLUSIVE_LOCKS_REQUIRED(g_requests_mutex) {\n+                if (!g_requests.empty()) {\n+                    LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 56,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Having side effects in the predicate seems a bad idea due to spurious wakeups. It should be a pure function.",
      "created_at": "2023-01-05T14:23:57Z",
      "updated_at": "2023-01-05T14:24:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062528172",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062528172"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 484,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062671091",
      "pull_request_review_id": 1237698918,
      "id": 1062671091,
      "node_id": "PRRC_kwDOABII584_VxLz",
      "diff_hunk": "@@ -207,6 +214,17 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\n+        g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": 41,
      "original_position": 34,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What's the purpose of this notification? I think we (currently) only need to monitor for completed requests, not new ones?",
      "created_at": "2023-01-05T16:36:56Z",
      "updated_at": "2023-01-06T18:17:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1062671091",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1062671091"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 220,
      "original_line": 220,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1063664153",
      "pull_request_review_id": 1237698918,
      "id": 1063664153,
      "node_id": "PRRC_kwDOABII584_ZjoZ",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think this can also be a simple atomic counter which doesn't require a lock?\r\n\r\n<details>\r\n<summary>git diff on 6d3a848fc</summary>\r\n\r\n```diff\r\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\r\nindex 346c6d5cb..a058a9c49 100644\r\n--- a/src/httpserver.cpp\r\n+++ b/src/httpserver.cpp\r\n@@ -152,7 +152,7 @@ static std::vector<evhttp_bound_socket *> boundSockets;\r\n //! Track active requests\r\n static GlobalMutex g_requests_mutex;\r\n static std::condition_variable g_requests_cv;\r\n-static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);\r\n+static std::atomic<size_t> g_requests_count;\r\n \r\n /** Check if a network address is allowed to access the HTTP server */\r\n static bool ClientAllowed(const CNetAddr& netaddr)\r\n@@ -216,11 +216,9 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\r\n {\r\n     // Track requests and notify when a request is completed.\r\n     {\r\n-        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\r\n-        g_requests_cv.notify_all();\r\n+        ++g_requests_count;\r\n         evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\r\n-            auto n = WITH_LOCK(g_requests_mutex, return g_requests.erase(req));\r\n-            assert(n == 1);\r\n+            --g_requests_count;\r\n             g_requests_cv.notify_all();\r\n         }, nullptr);\r\n     }\r\n@@ -480,10 +478,10 @@ void StopHTTPServer()\r\n     {\r\n         WAIT_LOCK(g_requests_mutex, lock);\r\n         g_requests_cv.wait(lock, []() EXCLUSIVE_LOCKS_REQUIRED(g_requests_mutex) {\r\n-                if (!g_requests.empty()) {\r\n-                    LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\r\n-                }\r\n-                return g_requests.empty();\r\n+            if (g_requests_count > 0) {\r\n+                LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests_count);\r\n+            }\r\n+            return g_requests_count == 0;\r\n         });\r\n     }\r\n     if (eventHTTP) {\r\n```\r\n</details>\r\n\r\n(cc @hebasto - I think this is a similar but less \"controversial\" approach than what I proposed offline)",
      "created_at": "2023-01-06T18:06:43Z",
      "updated_at": "2023-01-06T18:17:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1063664153",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1063664153"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064585334",
      "pull_request_review_id": 1240403260,
      "id": 1064585334,
      "node_id": "PRRC_kwDOABII584_dEh2",
      "diff_hunk": "@@ -459,15 +477,27 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n-    if (eventBase) {\n-        LogPrint(BCLog::HTTP, \"Waiting for HTTP event thread to exit\\n\");\n-        if (g_thread_http.joinable()) g_thread_http.join();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        g_requests_cv.wait(lock, []() EXCLUSIVE_LOCKS_REQUIRED(g_requests_mutex) {\n+                if (!g_requests.empty()) {\n+                    LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\n+                }\n+                return g_requests.empty();",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1062524049,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed",
      "created_at": "2023-01-09T12:25:23Z",
      "updated_at": "2023-01-09T12:25:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064585334",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064585334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": 483,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 486,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064585371",
      "pull_request_review_id": 1240403319,
      "id": 1064585371,
      "node_id": "PRRC_kwDOABII584_dEib",
      "diff_hunk": "@@ -459,15 +477,27 @@ void StopHTTPServer()\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n-    if (eventBase) {\n-        LogPrint(BCLog::HTTP, \"Waiting for HTTP event thread to exit\\n\");\n-        if (g_thread_http.joinable()) g_thread_http.join();\n+    {\n+        WAIT_LOCK(g_requests_mutex, lock);\n+        g_requests_cv.wait(lock, []() EXCLUSIVE_LOCKS_REQUIRED(g_requests_mutex) {\n+                if (!g_requests.empty()) {\n+                    LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 56,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1062528172,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sure, then I think [this](https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1057353934) isn't possible anymore so I am reverting back to how I did it before. I think that's fine though.",
      "created_at": "2023-01-09T12:25:25Z",
      "updated_at": "2023-01-09T12:25:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064585371",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064585371"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 484,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064585466",
      "pull_request_review_id": 1240403458,
      "id": 1064585466,
      "node_id": "PRRC_kwDOABII584_dEj6",
      "diff_hunk": "@@ -207,6 +214,17 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\n+        g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": 41,
      "original_position": 34,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1062671091,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Did you see https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1056847000 ?",
      "created_at": "2023-01-09T12:25:32Z",
      "updated_at": "2023-01-09T12:25:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064585466",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064585466"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 220,
      "original_line": 220,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064585841",
      "pull_request_review_id": 1240403973,
      "id": 1064585841,
      "node_id": "PRRC_kwDOABII584_dEpx",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1063664153,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, for this change alone it would be possible with a count I think but not for the follow-up change in [#19434](https://github.com/bitcoin/bitcoin/pull/19434) where the explicit requests are removed in a callback.",
      "created_at": "2023-01-09T12:25:58Z",
      "updated_at": "2023-01-09T12:25:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064585841",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064585841"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064702034",
      "pull_request_review_id": 1240584139,
      "id": 1064702034,
      "node_id": "PRRC_kwDOABII584_dhBS",
      "diff_hunk": "@@ -207,6 +214,17 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\n+        g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": 41,
      "original_position": 34,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1062671091,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I hadn't seen that, thanks for linking. \r\n\r\nIt's a minor concern, but I'm a bit worried that we're creating a very general contract (\"`g_requests_cv` will always notify for any changes to the `g_requests`\") on a global variable when it's enforced outside of `g_requests`, when in the future we might easily introduce mutations on `g_requests` without notifying the cv. A more scoped cv, such as `g_requests_cv_handled` largely mitigates that.\r\n\r\nBut, again, no big concern, and it's not likely to cause any major problems should we miss something there. As you see fit.",
      "created_at": "2023-01-09T14:30:17Z",
      "updated_at": "2023-01-09T14:30:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064702034",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064702034"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 220,
      "original_line": 220,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064707663",
      "pull_request_review_id": 1240593034,
      "id": 1064707663,
      "node_id": "PRRC_kwDOABII584_diZP",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1063664153,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Okay, makes sense. I'm not sure how controversial #19434 is, need to take a closer look. Would it make sense to use the atomic counter in this PR and then use a set in the follow-up? In case we can't get that merged, that would leave master in a better state, and I think the code churn is manageable?",
      "created_at": "2023-01-09T14:35:39Z",
      "updated_at": "2023-01-09T14:35:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064707663",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064707663"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064808284",
      "pull_request_review_id": 1240747932,
      "id": 1064808284,
      "node_id": "PRRC_kwDOABII584_d69c",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1063664153,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "You still need a lock, otherwise, how would you wait for the count to be zero?",
      "created_at": "2023-01-09T16:03:39Z",
      "updated_at": "2023-01-09T16:03:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064808284",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064808284"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064818694",
      "pull_request_review_id": 1240764314,
      "id": 1064818694,
      "node_id": "PRRC_kwDOABII584_d9gG",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1063664153,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm not sure I understand your comment - my diff (https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1063664153) does not involve removing the lock, although it reduces reliance on it since a counter can be encapsulated with a more efficient `std::atomic<size_t>` as opposed to set mutations which require acquiring a lock. If I'm misunderstanding you, could you please clarify?",
      "created_at": "2023-01-09T16:13:40Z",
      "updated_at": "2023-01-09T16:13:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064818694",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064818694"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064823506",
      "pull_request_review_id": 1240771586,
      "id": 1064823506,
      "node_id": "PRRC_kwDOABII584_d-rS",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1063664153,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah neverming, we could use `std::atomic<T>::wait`",
      "created_at": "2023-01-09T16:18:07Z",
      "updated_at": "2023-01-09T16:18:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064823506",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064823506"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064826454",
      "pull_request_review_id": 1240775975,
      "id": 1064826454,
      "node_id": "PRRC_kwDOABII584_d_ZW",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1063664153,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Anyway, I think having a set of connections is required for upcoming changes (like #19434) but you are right that for this branch the count is enough. I still tend to prefer as is but I would ACK a version with the counter.",
      "created_at": "2023-01-09T16:20:44Z",
      "updated_at": "2023-01-09T16:20:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064826454",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064826454"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064889295",
      "pull_request_review_id": 1240871737,
      "id": 1064889295,
      "node_id": "PRRC_kwDOABII584_eOvP",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1063664153,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I prefer to keep it as is as well. I don't think #19434 will be controversial because it's not conceptually different, just an improvement. And using the count is just a minor simplification, the code works the same either way. We have put stranger things into the code base, like unused functions for example, as long as there were follow-ups where they would be used and the these follow-ups were following the same concept that was already ACKed.",
      "created_at": "2023-01-09T17:23:23Z",
      "updated_at": "2023-01-09T17:23:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1064889295",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1064889295"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066468897",
      "pull_request_review_id": 1243146112,
      "id": 1066468897,
      "node_id": "PRRC_kwDOABII584_kQYh",
      "diff_hunk": "@@ -21,12 +21,15 @@\n #include <util/threadnames.h>\n #include <util/translation.h>\n \n+#include <condition_variable>\n #include <cstdio>\n #include <cstdlib>\n #include <deque>\n #include <memory>\n+#include <mutex>",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "55bbf04adc4879dcacd135f40aa053e60032af4b",
      "in_reply_to_id": null,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "can be removed.",
      "created_at": "2023-01-11T00:29:57Z",
      "updated_at": "2023-01-11T00:29:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1066468897",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066468897"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066864359",
      "pull_request_review_id": 1243713404,
      "id": 1066864359,
      "node_id": "PRRC_kwDOABII584_lw7n",
      "diff_hunk": "@@ -21,12 +21,15 @@\n #include <util/threadnames.h>\n #include <util/translation.h>\n \n+#include <condition_variable>\n #include <cstdio>\n #include <cstdlib>\n #include <deque>\n #include <memory>\n+#include <mutex>",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "55bbf04adc4879dcacd135f40aa053e60032af4b",
      "in_reply_to_id": 1066468897,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "+1, and we're missing `#include <event2/http_struct.h>` (for `evhttp_request`)",
      "created_at": "2023-01-11T11:08:00Z",
      "updated_at": "2023-01-11T11:47:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1066864359",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066864359"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066864853",
      "pull_request_review_id": 1243713404,
      "id": 1066864853,
      "node_id": "PRRC_kwDOABII584_lxDV",
      "diff_hunk": "@@ -207,6 +214,17 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\n+        g_requests_cv.notify_all();\n+        evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\n+            auto n = WITH_LOCK(g_requests_mutex, return g_requests.erase(req));",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "55bbf04adc4879dcacd135f40aa053e60032af4b",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit - think I'd prefer removing the `n` var altogether, the temp var doesn't really make it more readable imo\r\n```suggestion\r\n            auto n{WITH_LOCK(g_requests_mutex, return g_requests.erase(req))};\r\n```",
      "created_at": "2023-01-11T11:08:33Z",
      "updated_at": "2023-01-11T11:46:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1066864853",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066864853"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 222,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066894976",
      "pull_request_review_id": 1243713404,
      "id": 1066894976,
      "node_id": "PRRC_kwDOABII584_l4aA",
      "diff_hunk": "@@ -207,6 +214,17 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\n+        g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": 41,
      "original_position": 34,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1062671091,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "FYI I think one approach to improve on this contract (and as a nice benefit, also encapsulate code a bit better - I think this improves readability) in the below diff.\r\n\r\n(`WaitUntilEmpty()` needs improvement because it shouldn't directly be logging about the HTTP server like that. I guess we also don't need a `GlobalMutex` here.)\r\n\r\n<details>\r\n<summary>git diff on 55bbf04ad</summary>\r\n\r\n```diff\r\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\r\nindex b481ef093..90ef37bd5 100644\r\n--- a/src/httpserver.cpp\r\n+++ b/src/httpserver.cpp\r\n@@ -134,6 +134,40 @@ struct HTTPPathHandler\r\n     HTTPRequestHandler handler;\r\n };\r\n \r\n+class RequestTracker\r\n+{\r\n+public:\r\n+    typedef std::unordered_set<evhttp_request*> requests_t;\r\n+private:\r\n+    GlobalMutex m_requests_mutex;\r\n+    std::condition_variable m_requests_cv;\r\n+    requests_t m_requests GUARDED_BY(m_requests_mutex);\r\n+public:\r\n+    void Register(struct evhttp_request* req)\r\n+    {\r\n+        WITH_LOCK(m_requests_mutex, m_requests.insert(req));\r\n+        m_requests_cv.notify_all();\r\n+    }\r\n+\r\n+    size_t Remove(struct evhttp_request* req)\r\n+    {\r\n+        auto n{WITH_LOCK(m_requests_mutex, return m_requests.erase(req))};\r\n+        m_requests_cv.notify_all();\r\n+        return n;\r\n+    }\r\n+\r\n+    void WaitUntilEmpty()\r\n+    {\r\n+        WAIT_LOCK(m_requests_mutex, lock);\r\n+        if (!m_requests.empty()) {\r\n+            LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", m_requests.size());\r\n+        }\r\n+        m_requests_cv.wait(lock, [this]() EXCLUSIVE_LOCKS_REQUIRED(m_requests_mutex) {\r\n+            return m_requests.empty();\r\n+        });\r\n+    }\r\n+};\r\n+\r\n /** HTTP module state */\r\n \r\n //! libevent event loop\r\n@@ -149,10 +183,8 @@ static GlobalMutex g_httppathhandlers_mutex;\r\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\r\n //! Bound listening sockets\r\n static std::vector<evhttp_bound_socket *> boundSockets;\r\n-//! Track active requests\r\n-static GlobalMutex g_requests_mutex;\r\n-static std::condition_variable g_requests_cv;\r\n-static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);\r\n+static RequestTracker g_request_tracker;\r\n+\r\n \r\n /** Check if a network address is allowed to access the HTTP server */\r\n static bool ClientAllowed(const CNetAddr& netaddr)\r\n@@ -216,12 +248,9 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\r\n {\r\n     // Track requests and notify when a request is completed.\r\n     {\r\n-        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\r\n-        g_requests_cv.notify_all();\r\n+        g_request_tracker.Register(req);\r\n         evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\r\n-            auto n = WITH_LOCK(g_requests_mutex, return g_requests.erase(req));\r\n-            assert(n == 1);\r\n-            g_requests_cv.notify_all();\r\n+            assert(g_request_tracker.Remove(req) == 1);\r\n         }, nullptr);\r\n     }\r\n \r\n@@ -477,15 +506,7 @@ void StopHTTPServer()\r\n         evhttp_del_accept_socket(eventHTTP, socket);\r\n     }\r\n     boundSockets.clear();\r\n-    {\r\n-        WAIT_LOCK(g_requests_mutex, lock);\r\n-        if (!g_requests.empty()) {\r\n-            LogPrint(BCLog::HTTP, \"Waiting for %d requests to stop HTTP server\\n\", g_requests.size());\r\n-        }\r\n-        g_requests_cv.wait(lock, []() EXCLUSIVE_LOCKS_REQUIRED(g_requests_mutex) {\r\n-            return g_requests.empty();\r\n-        });\r\n-    }\r\n+    g_request_tracker.WaitUntilEmpty();\r\n     if (eventHTTP) {\r\n         // Schedule a callback to call evhttp_free in the event base thread, so\r\n         // that evhttp_free does not need to be called again after the handling\r\n```\r\n</details>",
      "created_at": "2023-01-11T11:43:08Z",
      "updated_at": "2023-01-11T11:46:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1066894976",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066894976"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 220,
      "original_line": 220,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066896174",
      "pull_request_review_id": 1243713404,
      "id": 1066896174,
      "node_id": "PRRC_kwDOABII584_l4su",
      "diff_hunk": "@@ -146,6 +149,10 @@ static GlobalMutex g_httppathhandlers_mutex;\n static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_mutex);\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n+//! Track active requests\n+static GlobalMutex g_requests_mutex;\n+static std::condition_variable g_requests_cv;\n+static std::unordered_set<evhttp_request*> g_requests GUARDED_BY(g_requests_mutex);",
      "path": "src/httpserver.cpp",
      "position": 30,
      "original_position": 23,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1063664153,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Alright, it's not my ideal approach but let's be pragmatic and keep it as is. Can be marked as resolved for me.",
      "created_at": "2023-01-11T11:44:36Z",
      "updated_at": "2023-01-11T11:46:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1066896174",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1066896174"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 155,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103167272",
      "pull_request_review_id": 1293893628,
      "id": 1103167272,
      "node_id": "PRRC_kwDOABII585BwP8o",
      "diff_hunk": "@@ -21,12 +21,15 @@\n #include <util/threadnames.h>\n #include <util/translation.h>\n \n+#include <condition_variable>\n #include <cstdio>\n #include <cstdlib>\n #include <deque>\n #include <memory>\n+#include <mutex>",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "55bbf04adc4879dcacd135f40aa053e60032af4b",
      "in_reply_to_id": 1066468897,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Both done",
      "created_at": "2023-02-10T19:45:49Z",
      "updated_at": "2023-02-10T19:45:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1103167272",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103167272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103167917",
      "pull_request_review_id": 1293895284,
      "id": 1103167917,
      "node_id": "PRRC_kwDOABII585BwQGt",
      "diff_hunk": "@@ -207,6 +214,17 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\n+        g_requests_cv.notify_all();",
      "path": "src/httpserver.cpp",
      "position": 41,
      "original_position": 34,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "6d3a848fc76f76af2b2b262011f37be952325b44",
      "in_reply_to_id": 1062671091,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sorry but it's a significant change and this PR already has a pretty long history and several ACKs for the current approach. I would suggest you open a follow-up PR with this as an additional improvement.",
      "created_at": "2023-02-10T19:46:28Z",
      "updated_at": "2023-02-10T19:46:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1103167917",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103167917"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 220,
      "original_line": 220,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103168195",
      "pull_request_review_id": 1293896071,
      "id": 1103168195,
      "node_id": "PRRC_kwDOABII585BwQLD",
      "diff_hunk": "@@ -207,6 +214,17 @@ std::string RequestMethodString(HTTPRequest::RequestMethod m)\n /** HTTP request callback */\n static void http_request_cb(struct evhttp_request* req, void* arg)\n {\n+    // Track requests and notify when a request is completed.\n+    {\n+        WITH_LOCK(g_requests_mutex, g_requests.insert(req));\n+        g_requests_cv.notify_all();\n+        evhttp_request_set_on_complete_cb(req, [](struct evhttp_request* req, void*) {\n+            auto n = WITH_LOCK(g_requests_mutex, return g_requests.erase(req));",
      "path": "src/httpserver.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "55bbf04adc4879dcacd135f40aa053e60032af4b",
      "in_reply_to_id": 1066864853,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-02-10T19:46:51Z",
      "updated_at": "2023-02-10T19:46:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1103168195",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103168195"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 222,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1121744890",
      "pull_request_review_id": 1319862109,
      "id": 1121744890,
      "node_id": "PRRC_kwDOABII585C3Hf6",
      "diff_hunk": "@@ -21,19 +21,22 @@\n #include <util/threadnames.h>\n #include <util/translation.h>\n \n+#include <condition_variable>\n #include <cstdio>\n #include <cstdlib>\n #include <deque>\n #include <memory>\n #include <optional>\n #include <string>\n+#include <unordered_set>\n \n #include <sys/types.h>\n #include <sys/stat.h>\n \n #include <event2/buffer.h>\n #include <event2/bufferevent.h>\n #include <event2/http.h>\n+#include <event2/http_struct.h>",
      "path": "src/httpserver.cpp",
      "position": 19,
      "original_position": 19,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: IWYU suggests to s/`#include <event2/http_struct.h>`/`#include <event2/event.h>`/.",
      "created_at": "2023-03-01T13:39:04Z",
      "updated_at": "2023-03-01T13:40:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1121744890",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1121744890"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 39,
      "original_line": 39,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1125511981",
      "pull_request_review_id": 1325078200,
      "id": 1125511981,
      "node_id": "PRRC_kwDOABII585DFfMt",
      "diff_hunk": "@@ -21,19 +21,22 @@\n #include <util/threadnames.h>\n #include <util/translation.h>\n \n+#include <condition_variable>\n #include <cstdio>\n #include <cstdlib>\n #include <deque>\n #include <memory>\n #include <optional>\n #include <string>\n+#include <unordered_set>\n \n #include <sys/types.h>\n #include <sys/stat.h>\n \n #include <event2/buffer.h>\n #include <event2/bufferevent.h>\n #include <event2/http.h>\n+#include <event2/http_struct.h>",
      "path": "src/httpserver.cpp",
      "position": 19,
      "original_position": 19,
      "commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "original_commit_id": "60978c8080ec13ff4571c8a89e742517b2aca692",
      "in_reply_to_id": 1121744890,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks! I will fix this in the follow-up that will pick up #19434.",
      "created_at": "2023-03-04T18:28:28Z",
      "updated_at": "2023-03-04T18:28:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/26742#discussion_r1125511981",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1125511981"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26742"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 39,
      "original_line": 39,
      "side": "RIGHT"
    }
  ]
}