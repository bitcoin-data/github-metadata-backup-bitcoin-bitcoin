{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219",
    "id": 3152436690,
    "node_id": "PR_kwDOABII58675l3S",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34219",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34219.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34219.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34219",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34219/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/f51665bee72c26d3f3cc6813b6c02adad5f0af6a",
    "number": 34219,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "psbt: validate pubkeys in MuSig2 pubnonce/partial sig deserialization",
    "user": {
      "login": "tboy1337",
      "id": 30571311,
      "node_id": "MDQ6VXNlcjMwNTcxMzEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tboy1337",
      "html_url": "https://github.com/tboy1337",
      "followers_url": "https://api.github.com/users/tboy1337/followers",
      "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
      "organizations_url": "https://api.github.com/users/tboy1337/orgs",
      "repos_url": "https://api.github.com/users/tboy1337/repos",
      "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/tboy1337/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "The previous fix for invalid MuSig2 pubkeys (bitcoin/bitcoin#34010) only\r\naddressed the PSBT_IN_MUSIG2_PARTICIPANT_PUBKEYS field. However, the\r\nPSBT_IN_MUSIG2_PUB_NONCE and PSBT_IN_MUSIG2_PARTIAL_SIG fields also\r\ndeserialize pubkeys without validation, which could lead to crashes when\r\ninvalid pubkeys are processed.\r\n\r\nThis commit adds validation to the DeserializeMuSig2ParticipantDataIdentifier\r\nfunction to ensure all pubkeys in MuSig2 pubnonce and partial signature\r\nfields are fully valid elliptic curve points.\r\n\r\nThe fix:\r\n- Validates both aggregate and participant pubkeys in MuSig2 pubnonce and\r\n  partial signature deserialization\r\n- Throws std::ios_base::failure with descriptive error messages for invalid\r\n  pubkeys\r\n- Prevents potential crashes from invalid elliptic curve points\r\n- Maintains backward compatibility for valid PSBTs\r\n\r\nThis completes the fix for issues [#33999](https://github.com/bitcoin/bitcoin/issues/33999) and [#34201](https://github.com/bitcoin/bitcoin/issues/34201).",
    "labels": [
      {
        "id": 1618202877,
        "node_id": "MDU6TGFiZWwxNjE4MjAyODc3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/PSBT",
        "name": "PSBT",
        "description": "",
        "color": "39c6b4",
        "default": false
      }
    ],
    "created_at": "2026-01-07T12:41:30Z",
    "updated_at": "2026-01-20T17:41:28Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "37793e7f59e1526a99a055d960f2081b4fca20b5",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "tboy1337:fix-musig2-validation-incomplete",
      "ref": "fix-musig2-validation-incomplete",
      "sha": "f51665bee72c26d3f3cc6813b6c02adad5f0af6a",
      "user": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1129520734,
        "node_id": "R_kgDOQ1MeXg",
        "name": "bitcoin",
        "full_name": "tboy1337/bitcoin",
        "owner": {
          "login": "tboy1337",
          "id": 30571311,
          "node_id": "MDQ6VXNlcjMwNTcxMzEx",
          "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/tboy1337",
          "html_url": "https://github.com/tboy1337",
          "followers_url": "https://api.github.com/users/tboy1337/followers",
          "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
          "organizations_url": "https://api.github.com/users/tboy1337/orgs",
          "repos_url": "https://api.github.com/users/tboy1337/repos",
          "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/tboy1337/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/tboy1337/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/tboy1337/bitcoin",
        "archive_url": "https://api.github.com/repos/tboy1337/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/tboy1337/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/tboy1337/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/tboy1337/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/tboy1337/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/tboy1337/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/tboy1337/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/tboy1337/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/tboy1337/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/tboy1337/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/tboy1337/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/tboy1337/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/tboy1337/bitcoin/events",
        "forks_url": "https://api.github.com/repos/tboy1337/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/tboy1337/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/tboy1337/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/tboy1337/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/tboy1337/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/tboy1337/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/tboy1337/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/tboy1337/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/tboy1337/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/tboy1337/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/tboy1337/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/tboy1337/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/tboy1337/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/tboy1337/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/tboy1337/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/tboy1337/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:tboy1337/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/tboy1337/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/tboy1337/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/tboy1337/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/tboy1337/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/tboy1337/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/tboy1337/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/tboy1337/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/tboy1337/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/tboy1337/bitcoin/hooks",
        "svn_url": "https://github.com/tboy1337/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 258352,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-20T13:35:39Z",
        "created_at": "2026-01-07T07:53:15Z",
        "updated_at": "2026-01-17T12:03:57Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "abc6a3a4eb9814a7f17e40f7a4d330cbef86bff0",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38745,
        "stargazers_count": 87723,
        "watchers_count": 87723,
        "size": 302044,
        "default_branch": "master",
        "open_issues_count": 753,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-20T15:46:17Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-20T17:14:20Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
      }
    },
    "author_association": "NONE",
    "draft": false,
    "additions": 23,
    "deletions": 0,
    "changed_files": 2,
    "commits": 1,
    "review_comments": 8,
    "comments": 3
  },
  "events": [
    {
      "event": "labeled",
      "id": 21897333415,
      "node_id": "LE_lADOABII587h0XsOzwAAAAUZLsqn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21897333415",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-07T12:41:34Z",
      "label": {
        "name": "PSBT",
        "color": "39c6b4"
      }
    },
    {
      "event": "commented",
      "id": 3718685496,
      "node_id": "IC_kwDOABII587dpqM4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3718685496",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-07T12:41:39Z",
      "updated_at": "2026-01-20T14:30:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34219.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [rkrux](https://github.com/bitcoin/bitcoin/pull/34219#pullrequestreview-3682481414) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#issuecomment-3718685496",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34219"
    },
    {
      "event": "commented",
      "id": 3719455935,
      "node_id": "IC_kwDOABII587dsmS_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3719455935",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-07T15:34:00Z",
      "updated_at": "2026-01-07T15:34:00Z",
      "author_association": "MEMBER",
      "body": "Please squash your commits according to https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#squashing-commits\r\n\r\nAlso, you'll have to add tests",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#issuecomment-3719455935",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34219"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21905101119,
      "node_id": "HRFPE_lADOABII587h0XsOzwAAAAUZpVE_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21905101119",
      "actor": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "2676633e2b1d1b0e7b0c5878a64ace5689db75ce",
      "commit_url": "https://api.github.com/repos/tboy1337/bitcoin/commits/2676633e2b1d1b0e7b0c5878a64ace5689db75ce",
      "created_at": "2026-01-07T18:25:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21908410355,
      "node_id": "HRFPE_lADOABII587h0XsOzwAAAAUZ18_z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21908410355",
      "actor": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "commit_url": "https://api.github.com/repos/tboy1337/bitcoin/commits/8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "created_at": "2026-01-07T21:22:09Z"
    },
    {
      "event": "reviewed",
      "id": 3636868577,
      "node_id": "PRR_kwDOABII587YxjXh",
      "url": null,
      "actor": null,
      "commit_id": "8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-07T21:28:22Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#pullrequestreview-3636868577",
      "submitted_at": "2026-01-07T21:28:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
    },
    {
      "event": "reviewed",
      "id": 3636889523,
      "node_id": "PRR_kwDOABII587Yxoez",
      "url": null,
      "actor": null,
      "commit_id": "8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-07T21:36:20Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#pullrequestreview-3636889523",
      "submitted_at": "2026-01-07T21:36:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
    },
    {
      "event": "reviewed",
      "id": 3636909333,
      "node_id": "PRR_kwDOABII587YxtUV",
      "url": null,
      "actor": null,
      "commit_id": "8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-07T21:43:42Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#pullrequestreview-3636909333",
      "submitted_at": "2026-01-07T21:43:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21908921881,
      "node_id": "HRFPE_lADOABII587h0XsOzwAAAAUZ354Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21908921881",
      "actor": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d8f711da133f3fa0df1376b0919221dc048df675",
      "commit_url": "https://api.github.com/repos/tboy1337/bitcoin/commits/d8f711da133f3fa0df1376b0919221dc048df675",
      "created_at": "2026-01-07T21:52:55Z"
    },
    {
      "event": "review_requested",
      "id": 21908934930,
      "node_id": "RRE_lADOABII587h0XsOzwAAAAUZ39ES",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21908934930",
      "actor": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-07T21:53:50Z",
      "requested_reviewer": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 3723635655,
      "node_id": "IC_kwDOABII587d8ivH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3723635655",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-08T12:23:54Z",
      "updated_at": "2026-01-08T12:23:54Z",
      "author_association": "MEMBER",
      "body": "Your added function test passes even before your changes, so this is not a regression test for the code change. Likely, it doesn't add any test coverage. All of this looks LLM generated.\r\n\r\nIf you want to add tests, that is fine, but you'll have to explain *and show* what coverage they are adding.\r\n\r\nIf you want to fix something, this is fine, but you'll have to add a regression test that fails before the changes, and passes after them: https://en.wikipedia.org/wiki/Regression_testing",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#issuecomment-3723635655",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34219"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21929587374,
      "node_id": "HRFPE_lADOABII587h0XsOzwAAAAUbGvKu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21929587374",
      "actor": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "commit_url": "https://api.github.com/repos/tboy1337/bitcoin/commits/6a1e3620aff758eee82840790e0f748474287558",
      "created_at": "2026-01-08T18:14:28Z"
    },
    {
      "event": "reviewed",
      "id": 3643667173,
      "node_id": "PRR_kwDOABII587ZLfLl",
      "url": null,
      "actor": null,
      "commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-09T12:29:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK 6a1e3620aff758eee82840790e0f748474287558\n\nThanks for raising this PR, these checks for the aggregate and participant pubkeys in the MuSig2 pubnonce and partial signatures PSBT keys seem fine to me. \nBIP Reference: https://github.com/bitcoin/bips/blob/master/bip-0373.mediawiki\n\nIn the absence of this fix, such invalid PSBTs get parsed successfully with empty participant and aggregate pubkeys that might later cause some flow (eg: signing) to crash like the earlier fuzz crashes found out.\n\nI used the following code to generate cases that I have suggested in the inline comments.\n\n<details>\n<summary>Makeshift code to generate invalid PSBTs</summary>\n\n```diff\ndiff --git a/test/functional/rpc_psbt.py b/test/functional/rpc_psbt.py\nindex cc443f6a7c..9d30d571ff 100755\n--- a/test/functional/rpc_psbt.py\n+++ b/test/functional/rpc_psbt.py\n@@ -407,6 +407,31 @@ class PSBTTest(BitcoinTestFramework):\n         self.log.info(\"PSBT parameter handling test completed successfully\")\n \n     def run_test(self):\n+        encoded_psbts = [\n+            \"\",\n+        ]\n+        old_key = None\n+        value = None\n+        new_key = None\n+        for encoded in encoded_psbts:\n+            decoded = PSBT.from_base64(encoded)\n+            for k, v in decoded.i[0].map.items():\n+                if type(k) == bytes and k.hex().startswith('1b'):\n+                    old_key = k\n+                    value = v\n+\n+                if old_key:\n+                    hex = old_key.hex()\n+                    new_hex = hex[0:2] + randbytes(33).hex() + hex[68:]\n+                    new_key = bytes.fromhex(new_hex)\n+                    break\n+\n+            del decoded.i[0].map[old_key]\n+            decoded.i[0].map[new_key] = value\n+            invalid_psbt = decoded.to_base64()\n+            print(invalid_psbt)\n+        return\n+\n         # Create and fund a raw tx for sending 10 BTC\n         psbtx1 = self.nodes[0].walletcreatefundedpsbt([], {self.nodes[2].getnewaddress():10})['psbt']\n```\n</details>",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#pullrequestreview-3643667173",
      "submitted_at": "2026-01-09T12:29:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
    },
    {
      "event": "labeled",
      "id": 21970441477,
      "node_id": "LE_lADOABII587h0XsOzwAAAAUdilUF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21970441477",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T13:46:05Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY1MTY2NWJlZTcyYzI2ZDNmM2NjNjgxM2I2YzAyYWRhZDVmMGFmNmE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f51665bee72c26d3f3cc6813b6c02adad5f0af6a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f51665bee72c26d3f3cc6813b6c02adad5f0af6a",
      "tree": {
        "sha": "cd515d96955380f33516cbfcabc64e709d2bcb3f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cd515d96955380f33516cbfcabc64e709d2bcb3f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6c3fb719d1a8f34352e6518e28eda0f46ce54ce7",
          "sha": "6c3fb719d1a8f34352e6518e28eda0f46ce54ce7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6c3fb719d1a8f34352e6518e28eda0f46ce54ce7"
        }
      ],
      "message": "psbt: validate pubkeys in MuSig2 pubnonce/partial sig deserialization\n\nAdd validation for pubkeys in MuSig2 pubnonce and partial signature deserialization to prevent crashes with invalid curve points.\n\n- Validate aggregate and participant pubkeys in PSBT MuSig2 fields\n\n- Add comprehensive test coverage for invalid pubkey rejection\n\n- Ensure proper error handling during PSBT deserialization",
      "committer": {
        "name": "tboy1337",
        "email": "tboy1337@proton.me",
        "date": "2026-01-12T12:49:41Z"
      },
      "author": {
        "name": "tboy1337",
        "email": "tboy1337@proton.me",
        "date": "2026-01-12T12:47:30Z"
      },
      "sha": "f51665bee72c26d3f3cc6813b6c02adad5f0af6a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21988797081,
      "node_id": "HRFPE_lADOABII587h0XsOzwAAAAUeomqZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21988797081",
      "actor": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "f51665bee72c26d3f3cc6813b6c02adad5f0af6a",
      "commit_url": "https://api.github.com/repos/tboy1337/bitcoin/commits/f51665bee72c26d3f3cc6813b6c02adad5f0af6a",
      "created_at": "2026-01-12T12:51:00Z"
    },
    {
      "event": "review_requested",
      "id": 21988821516,
      "node_id": "RRE_lADOABII587h0XsOzwAAAAUeosoM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21988821516",
      "actor": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-12T12:52:05Z",
      "requested_reviewer": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "tboy1337",
        "id": 30571311,
        "node_id": "MDQ6VXNlcjMwNTcxMzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/30571311?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tboy1337",
        "html_url": "https://github.com/tboy1337",
        "followers_url": "https://api.github.com/users/tboy1337/followers",
        "following_url": "https://api.github.com/users/tboy1337/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tboy1337/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tboy1337/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tboy1337/subscriptions",
        "organizations_url": "https://api.github.com/users/tboy1337/orgs",
        "repos_url": "https://api.github.com/users/tboy1337/repos",
        "events_url": "https://api.github.com/users/tboy1337/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tboy1337/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "unlabeled",
      "id": 22016338233,
      "node_id": "UNLE_lADOABII587h0XsOzwAAAAUgRqk5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22016338233",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-13T13:10:38Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3682481414,
      "node_id": "PRR_kwDOABII587bfjUG",
      "url": null,
      "actor": null,
      "commit_id": "f51665bee72c26d3f3cc6813b6c02adad5f0af6a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-20T17:41:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "lgtm ACK f51665bee72c26d3f3cc6813b6c02adad5f0af6a\r\n\r\nThanks for incorporating the suggestions, I verified the added `rpc_psbt.json` test cases are indeed those that I suggested in https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2675977449.",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#pullrequestreview-3682481414",
      "submitted_at": "2026-01-20T14:30:17Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2670129437",
      "pull_request_review_id": 3636868577,
      "id": 2670129437,
      "node_id": "PRRC_kwDOABII586fJvEd",
      "diff_hunk": "@@ -274,6 +274,86 @@ def test_decodepsbt_musig2_input_output_types(self):\n         assert \"participant_pubkeys\" in out_participant_pks\n         assert_equal(out_participant_pks[\"participant_pubkeys\"], [out_pubkey1.hex(), out_pubkey2.hex()])\n \n+    def test_musig2_invalid_pubkey_validation(self):\n+        self.log.info(\"Test MuSig2 pubkey validation prevents crashes with invalid pubkeys\")\n+\n+        # Create a basic transaction for the PSBT\n+        tx = CTransaction()\n+        tx.vin = [CTxIn(outpoint=COutPoint(hash=int('ee' * 32, 16), n=0), scriptSig=b\"\")]\n+        tx.vout = [CTxOut(nValue=0, scriptPubKey=b\"\")]\n+        psbt = PSBT()\n+        psbt.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+\n+        # Generate some valid keys for comparison\n+        _, valid_pubkey1 = generate_keypair()\n+        _, valid_pubkey2 = generate_keypair()\n+        _, valid_agg_pubkey = generate_keypair()\n+        fake_leaf_hash = randbytes(32)\n+\n+        # Create invalid pubkeys (random bytes that are not valid curve points)\n+        invalid_pubkey_compressed = randbytes(33)  # 33 bytes for compressed pubkey\n+        invalid_agg_pubkey_compressed = randbytes(33)\n+\n+        # Test 1: Invalid aggregate pubkey in MuSig2 pubnonce field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 pubnonce field\")\n+        participant1_keydata_invalid_agg = invalid_pubkey_compressed + invalid_agg_pubkey_compressed + fake_leaf_hash\n+        psbt_invalid_agg = PSBT()\n+        psbt_invalid_agg.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_invalid_agg: randbytes(66),  # fake pubnonce\n+        })]",
      "path": "test/functional/rpc_psbt.py",
      "position": 1,
      "original_position": 31,
      "commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "original_commit_id": "8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "in_reply_to_id": null,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The PSBT serialization requires the number of output maps to match the number of transaction outputs (1 in this case). \r\nThis needs to be done to all 5 PSBT creations in `test_musig2_invalid_pubkey_validation()`.\r\n```suggestion\r\n        })]\r\n        psbt_invalid_part_sig.o = [PSBTMap()]\r\n```",
      "created_at": "2026-01-07T21:28:15Z",
      "updated_at": "2026-01-07T21:30:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2670129437",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2670129437"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 307,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2670147951",
      "pull_request_review_id": 3636889523,
      "id": 2670147951,
      "node_id": "PRRC_kwDOABII586fJzlv",
      "diff_hunk": "@@ -242,8 +242,17 @@ void DeserializeMuSig2ParticipantDataIdentifier(Stream& skey, CPubKey& agg_pub,\n     std::array<unsigned char, CPubKey::COMPRESSED_SIZE> agg_pubkey_bytes;\n \n     skey >> std::as_writable_bytes(std::span{part_pubkey_bytes}) >> std::as_writable_bytes(std::span{agg_pubkey_bytes});\n-    agg_pub.Set(agg_pubkey_bytes.begin(), agg_pubkey_bytes.end());\n-    part_pub.Set(part_pubkey_bytes.begin(), part_pubkey_bytes.end());\n+    CPubKey agg_pub_candidate(agg_pubkey_bytes);",
      "path": "src/psbt.h",
      "position": 1,
      "original_position": 6,
      "commit_id": "8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "original_commit_id": "8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "in_reply_to_id": null,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It's not necessary to create new objects (`agg_pub_candidate` and `part_pub_candidate`).\r\n\r\n```suggestion\r\n    if (!agg_pub.IsFullyValid()) {\r\n        throw std::ios_base::failure(\"musig2 aggregate pubkey is invalid\");\r\n    }\r\n\r\n    if (!part_pub.IsFullyValid()) {\r\n        throw std::ios_base::failure(\"musig2 participant pubkey is invalid\");\r\n    }\r\n```",
      "created_at": "2026-01-07T21:35:52Z",
      "updated_at": "2026-01-07T21:36:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2670147951",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2670147951"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2670165747",
      "pull_request_review_id": 3636909333,
      "id": 2670165747,
      "node_id": "PRRC_kwDOABII586fJ37z",
      "diff_hunk": "@@ -0,0 +1,127 @@\n+// Copyright (c) 2019-present The Bitcoin Core developers",
      "path": "src/test/psbt_tests.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "bbfedad50c6f59efcb8e459251c0912fdf117f85",
      "original_commit_id": "8fde87be2c92a65341d9c12eba42e6b7f23d77dc",
      "in_reply_to_id": null,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There are already PSBT tests in `src/wallet/test/psbt_wallet_tests.cpp`, so itd be preferable to add the new ones there instead of introducing a new file.",
      "created_at": "2026-01-07T21:43:39Z",
      "updated_at": "2026-01-07T21:43:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2670165747",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2670165747"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675963162",
      "pull_request_review_id": 3643667173,
      "id": 2675963162,
      "node_id": "PRRC_kwDOABII586ff_Ua",
      "diff_hunk": "@@ -274,6 +274,137 @@ def test_decodepsbt_musig2_input_output_types(self):\n         assert \"participant_pubkeys\" in out_participant_pks\n         assert_equal(out_participant_pks[\"participant_pubkeys\"], [out_pubkey1.hex(), out_pubkey2.hex()])\n \n+    def test_musig2_invalid_pubkey_validation(self):\n+        self.log.info(\"Test MuSig2 pubkey validation prevents acceptance of invalid pubkeys in PSBT deserialization\")\n+        self.log.info(\"This is a regression test ensuring that invalid pubkeys in MuSig2 fields are properly rejected\")\n+        self.log.info(\"rather than being accepted and potentially causing crashes or invalid behavior later\")\n+\n+        # Create a basic transaction for the PSBT\n+        tx = CTransaction()\n+        tx.vin = [CTxIn(outpoint=COutPoint(hash=int('ee' * 32, 16), n=0), scriptSig=b\"\")]\n+        tx.vout = [CTxOut(nValue=0, scriptPubKey=b\"\")]\n+        psbt = PSBT()\n+        psbt.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+\n+        # Generate some valid keys for comparison\n+        _, valid_pubkey1 = generate_keypair()\n+        _, valid_pubkey2 = generate_keypair()\n+        _, valid_agg_pubkey = generate_keypair()\n+        fake_leaf_hash = randbytes(32)\n+\n+        # Create invalid pubkeys (random bytes that are not valid curve points)\n+        invalid_pubkey_compressed = randbytes(33)  # 33 bytes for compressed pubkey\n+        invalid_agg_pubkey_compressed = randbytes(33)\n+\n+        # Test 1: Invalid aggregate pubkey in MuSig2 pubnonce field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 pubnonce field\")\n+        participant1_keydata_invalid_agg = invalid_pubkey_compressed + invalid_agg_pubkey_compressed + fake_leaf_hash\n+        psbt_invalid_agg = PSBT()\n+        psbt_invalid_agg.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg.o = [PSBTMap()]\n+        psbt_invalid_agg.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_invalid_agg: randbytes(66),  # fake pubnonce\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 aggregate pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_agg.to_base64())\n+\n+        # Test 2: Invalid participant pubkey in MuSig2 pubnonce field\n+        self.log.info(\"Testing invalid participant pubkey in MuSig2 pubnonce field\")\n+        participant1_keydata_invalid_part = invalid_pubkey_compressed + valid_agg_pubkey + fake_leaf_hash\n+        psbt_invalid_part = PSBT()\n+        psbt_invalid_part.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_part.o = [PSBTMap()]\n+        psbt_invalid_part.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_invalid_part: randbytes(66),  # fake pubnonce\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 participant pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_part.to_base64())\n+\n+        # Test 3: Invalid aggregate pubkey in MuSig2 partial signature field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 partial signature field\")\n+        participant1_keydata_invalid_agg_sig = invalid_pubkey_compressed + invalid_agg_pubkey_compressed + fake_leaf_hash\n+        psbt_invalid_agg_sig = PSBT()\n+        psbt_invalid_agg_sig.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg_sig.o = [PSBTMap()]\n+        psbt_invalid_agg_sig.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PARTIAL_SIG]) + participant1_keydata_invalid_agg_sig: randbytes(32),  # fake partial sig\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 aggregate pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_agg_sig.to_base64())\n+\n+        # Test 4: Invalid participant pubkey in MuSig2 partial signature field\n+        self.log.info(\"Testing invalid participant pubkey in MuSig2 partial signature field\")\n+        participant1_keydata_invalid_part_sig = invalid_pubkey_compressed + valid_agg_pubkey + fake_leaf_hash\n+        psbt_invalid_part_sig = PSBT()\n+        psbt_invalid_part_sig.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_part_sig.o = [PSBTMap()]\n+        psbt_invalid_part_sig.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PARTIAL_SIG]) + participant1_keydata_invalid_part_sig: randbytes(32),  # fake partial sig\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 participant pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_part_sig.to_base64())\n+\n+        # Test 5: Test with valid keys to ensure the fix doesn't break normal operation\n+        self.log.info(\"Testing valid MuSig2 data still works\")\n+        participant1_keydata_valid = valid_pubkey1 + valid_agg_pubkey + fake_leaf_hash\n+        psbt_valid = PSBT()\n+        psbt_valid.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_valid.o = [PSBTMap()]\n+        psbt_valid.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_valid: randbytes(66),  # fake pubnonce\n+            bytes([PSBT_IN_MUSIG2_PARTIAL_SIG]) + participant1_keydata_valid: randbytes(32),  # fake partial sig\n+        })]\n+\n+        # This should not raise an error\n+        result = self.nodes[0].decodepsbt(psbt_valid.to_base64())\n+        assert_equal(len(result[\"inputs\"]), 1)\n+        assert \"musig2_pubnonces\" in result[\"inputs\"][0]\n+        assert \"musig2_partial_sigs\" in result[\"inputs\"][0]\n+\n+        # Test 6: Invalid participant pubkey in MuSig2 participant pubkeys field\n+        self.log.info(\"Testing invalid participant pubkey in MuSig2 participant pubkeys field\")\n+        psbt_invalid_participant = PSBT()\n+        psbt_invalid_participant.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_participant.o = [PSBTMap()]\n+        psbt_invalid_participant.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PARTICIPANT_PUBKEYS]) + valid_agg_pubkey: [invalid_pubkey_compressed, valid_pubkey1],\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 participant pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_participant.to_base64())\n+\n+        # Test 7: Invalid aggregate pubkey in MuSig2 participant pubkeys field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 participant pubkeys field\")\n+        psbt_invalid_agg_participant = PSBT()\n+        psbt_invalid_agg_participant.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg_participant.o = [PSBTMap()]\n+        psbt_invalid_agg_participant.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PARTICIPANT_PUBKEYS]) + invalid_agg_pubkey_compressed: [valid_pubkey1, valid_pubkey2],\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 aggregate pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_agg_participant.to_base64())\n+\n+        # Test 8: Invalid participant pubkey in MuSig2 output participant pubkeys field\n+        self.log.info(\"Testing invalid participant pubkey in MuSig2 output participant pubkeys field\")\n+        psbt_invalid_output_participant = PSBT()\n+        psbt_invalid_output_participant.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_output_participant.i = [PSBTMap()]\n+        psbt_invalid_output_participant.o = [PSBTMap({\n+            bytes([PSBT_OUT_MUSIG2_PARTICIPANT_PUBKEYS]) + valid_agg_pubkey: [invalid_pubkey_compressed, valid_pubkey1],\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 participant pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_output_participant.to_base64())\n+\n+        # Test 9: Invalid aggregate pubkey in MuSig2 output participant pubkeys field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 output participant pubkeys field\")\n+        psbt_invalid_agg_output = PSBT()\n+        psbt_invalid_agg_output.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg_output.i = [PSBTMap()]\n+        psbt_invalid_agg_output.o = [PSBTMap({\n+            bytes([PSBT_OUT_MUSIG2_PARTICIPANT_PUBKEYS]) + invalid_agg_pubkey_compressed: [valid_pubkey1, valid_pubkey2],\n+        })]",
      "path": "test/functional/rpc_psbt.py",
      "position": 1,
      "original_position": 131,
      "commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "original_commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "These 4 tests are not related to this fix and such errors were tested in PR #34010.",
      "created_at": "2026-01-09T12:09:36Z",
      "updated_at": "2026-01-09T12:29:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2675963162",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675963162"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
        }
      },
      "start_line": null,
      "original_start_line": 364,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 404,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675966473",
      "pull_request_review_id": 3643667173,
      "id": 2675966473,
      "node_id": "PRRC_kwDOABII586fgAIJ",
      "diff_hunk": "@@ -274,6 +274,137 @@ def test_decodepsbt_musig2_input_output_types(self):\n         assert \"participant_pubkeys\" in out_participant_pks\n         assert_equal(out_participant_pks[\"participant_pubkeys\"], [out_pubkey1.hex(), out_pubkey2.hex()])\n \n+    def test_musig2_invalid_pubkey_validation(self):\n+        self.log.info(\"Test MuSig2 pubkey validation prevents acceptance of invalid pubkeys in PSBT deserialization\")\n+        self.log.info(\"This is a regression test ensuring that invalid pubkeys in MuSig2 fields are properly rejected\")\n+        self.log.info(\"rather than being accepted and potentially causing crashes or invalid behavior later\")\n+\n+        # Create a basic transaction for the PSBT\n+        tx = CTransaction()\n+        tx.vin = [CTxIn(outpoint=COutPoint(hash=int('ee' * 32, 16), n=0), scriptSig=b\"\")]\n+        tx.vout = [CTxOut(nValue=0, scriptPubKey=b\"\")]\n+        psbt = PSBT()\n+        psbt.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+\n+        # Generate some valid keys for comparison\n+        _, valid_pubkey1 = generate_keypair()\n+        _, valid_pubkey2 = generate_keypair()\n+        _, valid_agg_pubkey = generate_keypair()\n+        fake_leaf_hash = randbytes(32)\n+\n+        # Create invalid pubkeys (random bytes that are not valid curve points)\n+        invalid_pubkey_compressed = randbytes(33)  # 33 bytes for compressed pubkey\n+        invalid_agg_pubkey_compressed = randbytes(33)\n+\n+        # Test 1: Invalid aggregate pubkey in MuSig2 pubnonce field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 pubnonce field\")\n+        participant1_keydata_invalid_agg = invalid_pubkey_compressed + invalid_agg_pubkey_compressed + fake_leaf_hash\n+        psbt_invalid_agg = PSBT()\n+        psbt_invalid_agg.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg.o = [PSBTMap()]\n+        psbt_invalid_agg.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_invalid_agg: randbytes(66),  # fake pubnonce\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 aggregate pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_agg.to_base64())\n+\n+        # Test 2: Invalid participant pubkey in MuSig2 pubnonce field\n+        self.log.info(\"Testing invalid participant pubkey in MuSig2 pubnonce field\")\n+        participant1_keydata_invalid_part = invalid_pubkey_compressed + valid_agg_pubkey + fake_leaf_hash\n+        psbt_invalid_part = PSBT()\n+        psbt_invalid_part.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_part.o = [PSBTMap()]\n+        psbt_invalid_part.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_invalid_part: randbytes(66),  # fake pubnonce\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 participant pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_part.to_base64())\n+\n+        # Test 3: Invalid aggregate pubkey in MuSig2 partial signature field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 partial signature field\")\n+        participant1_keydata_invalid_agg_sig = invalid_pubkey_compressed + invalid_agg_pubkey_compressed + fake_leaf_hash\n+        psbt_invalid_agg_sig = PSBT()\n+        psbt_invalid_agg_sig.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg_sig.o = [PSBTMap()]\n+        psbt_invalid_agg_sig.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PARTIAL_SIG]) + participant1_keydata_invalid_agg_sig: randbytes(32),  # fake partial sig\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 aggregate pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_agg_sig.to_base64())\n+\n+        # Test 4: Invalid participant pubkey in MuSig2 partial signature field\n+        self.log.info(\"Testing invalid participant pubkey in MuSig2 partial signature field\")\n+        participant1_keydata_invalid_part_sig = invalid_pubkey_compressed + valid_agg_pubkey + fake_leaf_hash\n+        psbt_invalid_part_sig = PSBT()\n+        psbt_invalid_part_sig.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_part_sig.o = [PSBTMap()]\n+        psbt_invalid_part_sig.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PARTIAL_SIG]) + participant1_keydata_invalid_part_sig: randbytes(32),  # fake partial sig\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 participant pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_part_sig.to_base64())\n+\n+        # Test 5: Test with valid keys to ensure the fix doesn't break normal operation\n+        self.log.info(\"Testing valid MuSig2 data still works\")\n+        participant1_keydata_valid = valid_pubkey1 + valid_agg_pubkey + fake_leaf_hash\n+        psbt_valid = PSBT()\n+        psbt_valid.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_valid.o = [PSBTMap()]\n+        psbt_valid.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_valid: randbytes(66),  # fake pubnonce\n+            bytes([PSBT_IN_MUSIG2_PARTIAL_SIG]) + participant1_keydata_valid: randbytes(32),  # fake partial sig\n+        })]\n+\n+        # This should not raise an error\n+        result = self.nodes[0].decodepsbt(psbt_valid.to_base64())\n+        assert_equal(len(result[\"inputs\"]), 1)\n+        assert \"musig2_pubnonces\" in result[\"inputs\"][0]\n+        assert \"musig2_partial_sigs\" in result[\"inputs\"][0]",
      "path": "test/functional/rpc_psbt.py",
      "position": 1,
      "original_position": 89,
      "commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "original_commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Adding this test is not needed because the several existing cases for the valid PSBTs should suffice.",
      "created_at": "2026-01-09T12:10:52Z",
      "updated_at": "2026-01-09T12:29:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2675966473",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675966473"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
        }
      },
      "start_line": null,
      "original_start_line": 347,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 362,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675977449",
      "pull_request_review_id": 3643667173,
      "id": 2675977449,
      "node_id": "PRRC_kwDOABII586fgCzp",
      "diff_hunk": "@@ -274,6 +274,137 @@ def test_decodepsbt_musig2_input_output_types(self):\n         assert \"participant_pubkeys\" in out_participant_pks\n         assert_equal(out_participant_pks[\"participant_pubkeys\"], [out_pubkey1.hex(), out_pubkey2.hex()])\n \n+    def test_musig2_invalid_pubkey_validation(self):\n+        self.log.info(\"Test MuSig2 pubkey validation prevents acceptance of invalid pubkeys in PSBT deserialization\")\n+        self.log.info(\"This is a regression test ensuring that invalid pubkeys in MuSig2 fields are properly rejected\")\n+        self.log.info(\"rather than being accepted and potentially causing crashes or invalid behavior later\")\n+\n+        # Create a basic transaction for the PSBT\n+        tx = CTransaction()\n+        tx.vin = [CTxIn(outpoint=COutPoint(hash=int('ee' * 32, 16), n=0), scriptSig=b\"\")]\n+        tx.vout = [CTxOut(nValue=0, scriptPubKey=b\"\")]\n+        psbt = PSBT()\n+        psbt.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+\n+        # Generate some valid keys for comparison\n+        _, valid_pubkey1 = generate_keypair()\n+        _, valid_pubkey2 = generate_keypair()\n+        _, valid_agg_pubkey = generate_keypair()\n+        fake_leaf_hash = randbytes(32)\n+\n+        # Create invalid pubkeys (random bytes that are not valid curve points)\n+        invalid_pubkey_compressed = randbytes(33)  # 33 bytes for compressed pubkey\n+        invalid_agg_pubkey_compressed = randbytes(33)\n+\n+        # Test 1: Invalid aggregate pubkey in MuSig2 pubnonce field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 pubnonce field\")\n+        participant1_keydata_invalid_agg = invalid_pubkey_compressed + invalid_agg_pubkey_compressed + fake_leaf_hash\n+        psbt_invalid_agg = PSBT()\n+        psbt_invalid_agg.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg.o = [PSBTMap()]\n+        psbt_invalid_agg.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_invalid_agg: randbytes(66),  # fake pubnonce\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 aggregate pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_agg.to_base64())\n+\n+        # Test 2: Invalid participant pubkey in MuSig2 pubnonce field\n+        self.log.info(\"Testing invalid participant pubkey in MuSig2 pubnonce field\")\n+        participant1_keydata_invalid_part = invalid_pubkey_compressed + valid_agg_pubkey + fake_leaf_hash\n+        psbt_invalid_part = PSBT()\n+        psbt_invalid_part.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_part.o = [PSBTMap()]\n+        psbt_invalid_part.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PUB_NONCE]) + participant1_keydata_invalid_part: randbytes(66),  # fake pubnonce\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 participant pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_part.to_base64())\n+\n+        # Test 3: Invalid aggregate pubkey in MuSig2 partial signature field\n+        self.log.info(\"Testing invalid aggregate pubkey in MuSig2 partial signature field\")\n+        participant1_keydata_invalid_agg_sig = invalid_pubkey_compressed + invalid_agg_pubkey_compressed + fake_leaf_hash\n+        psbt_invalid_agg_sig = PSBT()\n+        psbt_invalid_agg_sig.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_agg_sig.o = [PSBTMap()]\n+        psbt_invalid_agg_sig.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PARTIAL_SIG]) + participant1_keydata_invalid_agg_sig: randbytes(32),  # fake partial sig\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 aggregate pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_agg_sig.to_base64())\n+\n+        # Test 4: Invalid participant pubkey in MuSig2 partial signature field\n+        self.log.info(\"Testing invalid participant pubkey in MuSig2 partial signature field\")\n+        participant1_keydata_invalid_part_sig = invalid_pubkey_compressed + valid_agg_pubkey + fake_leaf_hash\n+        psbt_invalid_part_sig = PSBT()\n+        psbt_invalid_part_sig.g = PSBTMap({PSBT_GLOBAL_UNSIGNED_TX: tx.serialize()})\n+        psbt_invalid_part_sig.o = [PSBTMap()]\n+        psbt_invalid_part_sig.i = [PSBTMap({\n+            bytes([PSBT_IN_MUSIG2_PARTIAL_SIG]) + participant1_keydata_invalid_part_sig: randbytes(32),  # fake partial sig\n+        })]\n+\n+        assert_raises_rpc_error(-22, \"musig2 participant pubkey is invalid\", self.nodes[0].decodepsbt, psbt_invalid_part_sig.to_base64())",
      "path": "test/functional/rpc_psbt.py",
      "position": 1,
      "original_position": 72,
      "commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "original_commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "While these 4 tests do indeed check the newly added fix, but I think these cases are too customised and also increases the diff a bit. I created 4 invalid PSBTs from a valid PSBT that contain the invalid pubkeys:\n1. invalid aggregate pubkey in PSBT pubnonce key\n2. invalid participant pubkey in PSBT partial signature key\n3. invalid aggregate pubkey in PSBT pubnonce key\n4. invalid participant pubkey in PSBT partial signature key\n\nConsider adding this diff that passes with this fix:\n```diff\ndiff --git a/test/functional/data/rpc_psbt.json b/test/functional/data/rpc_psbt.json\nindex 752fce558f..abc09d523a 100644\n--- a/test/functional/data/rpc_psbt.json\n+++ b/test/functional/data/rpc_psbt.json\n@@ -106,6 +106,22 @@\n         [\n             \"cHNidP8BAFICAAAAAZqLSlB5a5YAmQ9/4R36ALxw79KWBIr8hnGa8PsfqRk3AQAAAAD9////ARjd9QUAAAAAFgAUyRI+BujX8JZsXRzQ+TMALU63V80AAAAAAAEBKwDh9QUAAAAAIlEgVr20gbTWcQP21d6oqar9NoSmp5tKLiR3mduNSxqG4fhBFAtY4zeqTThSqMKTh8QkCNjPvjphOl45fgqfAaX7cQfUsR/tqmOglWUBpzCMk7Vjc3HnYT2bit4Xg9SeJsBs+ixAJmfVL2zAf+BtsxsaX37+gZA/nL7vQPpk2vygHSyx1WQDvHUEiY5VhyVX0W0sp5vFX+8QlzhBoz7AMtiEdYyf5iIVwFCSm3TBoElUt4tLYDXpel4HiloPKOyW1Ue/7prOgDrAIyALWOM3qk04UqjCk4fEJAjYz746YTpeOX4KnwGl+3EH1KzAIRYLWOM3qk04UqjCk4fEJAjYz746YTpeOX4KnwGl+3EH1CUBsR/tqmOglWUBpzCMk7Vjc3HnYT2bit4Xg9SeJsBs+iwmgN1uIRY0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNACUBsR/tqmOglWUBpzCMk7Vjc3HnYT2bit4Xg9SeJsBs+ixYCwiHIRZPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLCUBsR/tqmOglWUBpzCMk7Vjc3HnYT2bit4Xg9SeJsBs+izDJJqCIRZQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wAUAfEYeXSEW+TCKAZJYwxBJNE+F+J1SKbUxyEWDb5mwhgHxE7zgNvklAbEf7apjoJVlAacwjJO1Y3Nx52E9m4reF4PUnibAbPosfdZVkgEXIFCSm3TBoElUt4tLYDXpel4HiloPKOyW1Ue/7prOgDrAARggsR/tqmOglWUBpzCMk7Vjc3HnYT2bit4Xg9SeJsBs+iwiGgMLWOM3qk04UqjCk4fEJAjYz746YTpeOX4KnwGl+3EH1GMCNGuZWTNXEHydNFnp3rqNPq9E5mNshcf4U+uQulLozQACT6/WX4FpGG/Cv9siM8d+Yw0QvigKJMcWXAmidhF3XCwC+TCKAZJYwxBJNE+F+J1SKbUxyEWDb5mwhgHxE7zgNvljGwI0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNAAMLWOM3qk04UqjCk4fEJAjYz746YTpeOX4KnwGl+3EH1LEf7apjoJVlAacwjJO1Y3Nx52E9m4reF4PUnibAbPosQgLZnnyHGbOtCFZrDLnH1e2jEnyegRkYW31YTZObFzkV9QJA3yKqt4Myzw8lMp0QPcDSBgoDdC6USAJuc2vPPbmPPGMbAk+v1l+BaRhvwr/bIjPHfmMNEL4oCiTHFlwJonYRd1wsAwtY4zeqTThSqMKTh8QkCNjPvjphOl45fgqfAaX7cQfUsR/tqmOglWUBpzCMk7Vjc3HnYT2bit4Xg9SeJsBs+ixCAucCpwdSJqDZMTp35tsQuOdC1M/9yUig7cm4VsE7QS5UAzhqApjzCPswmRVXcuRbKqjncPQ1vt/iBB0cxNPTdTjGYxsC+TCKAZJYwxBJNE+F+J1SKbUxyEWDb5mwhgHxE7zgNvkDC1jjN6pNOFKowpOHxCQI2M++OmE6Xjl+Cp8BpftxB9SxH+2qY6CVZQGnMIyTtWNzcedhPZuK3heD1J4mwGz6LEICsdkS1F11PO7QlUQXupgmVtKuxT+GOL1vKX2uO3Q9cbADL0JFN9WZ0o8U1Z/goRuC/qKqImopgP/aytX9qyD4BoNjHAI0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNAAMLWOM3qk04UqjCk4fEJAjYz746YTpeOX4KnwGl+3EH1LEf7apjoJVlAacwjJO1Y3Nx52E9m4reF4PUnibAbPosH6eLcK+M/6TFCGOu9RWsWKMnzVjFW60poWLmfZxBMyJjHAJPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLAMLWOM3qk04UqjCk4fEJAjYz746YTpeOX4KnwGl+3EH1LEf7apjoJVlAacwjJO1Y3Nx52E9m4reF4PUnibAbPosIB+ot+Z0HCHrjZsPZSad+eQjNp/DkK0ukYQgxX/rKhthYxwC+TCKAZJYwxBJNE+F+J1SKbUxyEWDb5mwhgHxE7zgNvkDC1jjN6pNOFKowpOHxCQI2M++OmE6Xjl+Cp8BpftxB9SxH+2qY6CVZQGnMIyTtWNzcedhPZuK3heD1J4mwGz6LCA2bDGtZeUz9tK0XlkQ8/WHVD+AYZGBZ79agYsTvleSpAAA\",\n             \"Size of value was not the stated size\"\n+        ],\n+        [\n+            \"cHNidP8BAFICAAAAASWJ53Z5WLoVT5AYzM8N7ephR7tgzRoZS241kKmWVpDWAQAAAAD9////ARjd9QUAAAAAFgAUyRI+BujX8JZsXRzQ+TMALU63V80AAAAAAAEBKwDh9QUAAAAAIlEg0LImxlmfJzh034/mhKtsMCgIG+6KLL7TGhNvWGX2z6QhFjRrmVkzVxB8nTRZ6d66jT6vROZjbIXH+FPrkLpS6M0ABQBYCwiHIRZPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLAUAwySagiEWjdlquFiyWcUYIYwBSkbrTmrImeUcZ173dPu2ioeZzi8NACaA3W4BAAAAAgAAACEW+TCKAZJYwxBJNE+F+J1SKbUxyEWDb5mwhgHxE7zgNvkFAH3WVZIBFyCN2Wq4WLJZxRghjAFKRutOasiZ5RxnXvd0+7aKh5nOLyIaAwtY4zeqTThSqMKTh8QkCNjPvjphOl45fgqfAaX7cQfUYwI0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNAAJPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLAL5MIoBkljDEEk0T4X4nVIptTHIRYNvmbCGAfETvOA2+UMbAk+v1l+BaRhvwr/bIjPHfmMNEL4oCiTHFlwJonYRd1wsAtCyJsZZnyc4dN+P5oSrbDAoCBvuiiy+0xoTb1hl9s+kQgOjJKP0Ihv6srb6B4anBI8zRc40TxRY4VG6GHtZqrSYywKjY4JZukzMRv552NeaTZ5wTsD3cBteZk1NhzODivSRlkMbAvkwigGSWMMQSTRPhfidUim1MchFg2+ZsIYB8RO84Db5AtCyJsZZnyc4dN+P5oSrbDAoCBvuiiy+0xoTb1hl9s+kQgLBLrTvh2AyHAcqUdj7ZcNO6LRSoUgYVX9h3wYShaWAkQOgjkGyYpQsblky/R+12ZI2iXmJ9ukS3CFHbSdxh0EUk0Mb0kSzWjtpjQM5dsRU2Eg/PTsX6bcFgeuZWOqYfPkzyBX2AtCyJsZZnyc4dN+P5oSrbDAoCBvuiiy+0xoTb1hl9s+kQgJO78n90SvnR0ZIXGeLgmiUnMkjbp/OgiQTlVI68EJivwOMJ26DKq1L+56QSFFi9XTIsmGd9b0Z24/6LrAFlJO/GwAA\",\n+            \"musig2 participant pubkey is invalid\"\n+        ],\n+        [\n+            \"cHNidP8BAFICAAAAASWJ53Z5WLoVT5AYzM8N7ephR7tgzRoZS241kKmWVpDWAQAAAAD9////ARjd9QUAAAAAFgAUyRI+BujX8JZsXRzQ+TMALU63V80AAAAAAAEBKwDh9QUAAAAAIlEg0LImxlmfJzh034/mhKtsMCgIG+6KLL7TGhNvWGX2z6QBE0CeOYl6wv/idSXcRg+FhP3dEf6al84uUMFIm4waTpL8wH5I22OhpMy50pdTfQwDiDg3i78njeeqGhKJldFiXMXNIRY0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNAAUAWAsIhyEWT6/WX4FpGG/Cv9siM8d+Yw0QvigKJMcWXAmidhF3XCwFAMMkmoIhFo3ZarhYslnFGCGMAUpG605qyJnlHGde93T7toqHmc4vDQAmgN1uAQAAAAIAAAAhFvkwigGSWMMQSTRPhfidUim1MchFg2+ZsIYB8RO84Db5BQB91lWSARcgjdlquFiyWcUYIYwBSkbrTmrImeUcZ173dPu2ioeZzi8iGgMLWOM3qk04UqjCk4fEJAjYz746YTpeOX4KnwGl+3EH1GMCNGuZWTNXEHydNFnp3rqNPq9E5mNshcf4U+uQulLozQACT6/WX4FpGG/Cv9siM8d+Yw0QvigKJMcWXAmidhF3XCwC+TCKAZJYwxBJNE+F+J1SKbUxyEWDb5mwhgHxE7zgNvlDGwI0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNAALQsibGWZ8nOHTfj+aEq2wwKAgb7oosvtMaE29YZfbPpEICTu/J/dEr50dGSFxni4JolJzJI26fzoIkE5VSOvBCYr8DjCdugyqtS/uekEhRYvV0yLJhnfW9GduP+i6wBZSTvxtDGwJPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLALQsibGWZ8nOHTfj+aEq2wwKAgb7oosvtMaE29YZfbPpEIDoySj9CIb+rK2+geGpwSPM0XONE8UWOFRuhh7Waq0mMsCo2OCWbpMzEb+edjXmk2ecE7A93AbXmZNTYczg4r0kZZDGwL5MIoBkljDEEk0T4X4nVIptTHIRYNvmbCGAfETvOA2+QLQsibGWZ8nOHTfj+aEq2wwKAgb7oosvtMaE29YZfbPpEICwS6074dgMhwHKlHY+2XDTui0UqFIGFV/Yd8GEoWlgJEDoI5BsmKULG5ZMv0ftdmSNol5ifbpEtwhR20ncYdBFJNDHAJPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLALQsibGWZ8nOHTfj+aEq2wwKAgb7oosvtMaE29YZfbPpCDnhVL7TOmy0A4e0OLLmOCHGZEnR36PGhxoGgC5xM5wmEMcAvkwigGSWMMQSTRPhfidUim1MchFg2+ZsIYB8RO84Db5AtCyJsZZnyc4dN+P5oSrbDAoCBvuiiy+0xoTb1hl9s+kIMvMlXhqHGdNSNisUuMi3Xxuq6w7/Evnm3UN4o34Li9zQxy9GBUQ2ZeszqyEQK2COnd79TGhILEsdA0ocnS0vqs9z/IC0LImxlmfJzh034/mhKtsMCgIG+6KLL7TGhNvWGX2z6QgZX2yhr4U6A7ODdhLTRfE3EFMPla8jO8IJ7BhtN0sj0MAAA==\",\n+            \"musig2 participant pubkey is invalid\"\n+        ],\n+        [\n+            \"cHNidP8BAFICAAAAASWJ53Z5WLoVT5AYzM8N7ephR7tgzRoZS241kKmWVpDWAQAAAAD9////ARjd9QUAAAAAFgAUyRI+BujX8JZsXRzQ+TMALU63V80AAAAAAAEBKwDh9QUAAAAAIlEg0LImxlmfJzh034/mhKtsMCgIG+6KLL7TGhNvWGX2z6QhFjRrmVkzVxB8nTRZ6d66jT6vROZjbIXH+FPrkLpS6M0ABQBYCwiHIRZPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLAUAwySagiEWjdlquFiyWcUYIYwBSkbrTmrImeUcZ173dPu2ioeZzi8NACaA3W4BAAAAAgAAACEW+TCKAZJYwxBJNE+F+J1SKbUxyEWDb5mwhgHxE7zgNvkFAH3WVZIBFyCN2Wq4WLJZxRghjAFKRutOasiZ5RxnXvd0+7aKh5nOLyIaAwtY4zeqTThSqMKTh8QkCNjPvjphOl45fgqfAaX7cQfUYwI0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNAAJPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLAL5MIoBkljDEEk0T4X4nVIptTHIRYNvmbCGAfETvOA2+UMbAk+v1l+BaRhvwr/bIjPHfmMNEL4oCiTHFlwJonYRd1wsAtCyJsZZnyc4dN+P5oSrbDAoCBvuiiy+0xoTb1hl9s+kQgOjJKP0Ihv6srb6B4anBI8zRc40TxRY4VG6GHtZqrSYywKjY4JZukzMRv552NeaTZ5wTsD3cBteZk1NhzODivSRlkMbAvkwigGSWMMQSTRPhfidUim1MchFg2+ZsIYB8RO84Db5AtCyJsZZnyc4dN+P5oSrbDAoCBvuiiy+0xoTb1hl9s+kQgLBLrTvh2AyHAcqUdj7ZcNO6LRSoUgYVX9h3wYShaWAkQOgjkGyYpQsblky/R+12ZI2iXmJ9ukS3CFHbSdxh0EUk0MbAjRrmVkzVxB8nTRZ6d66jT6vROZjbIXH+FPrkLpS6M0A24oIbe9JQsYZIdUKU0vvOQHc/23mGL2R5js8lN/JmLWHQgJO78n90SvnR0ZIXGeLgmiUnMkjbp/OgiQTlVI68EJivwOMJ26DKq1L+56QSFFi9XTIsmGd9b0Z24/6LrAFlJO/GwAA\",\n+            \"musig2 aggregate pubkey is invalid\"\n+        ],\n+        [\n+            \"cHNidP8BAFICAAAAASWJ53Z5WLoVT5AYzM8N7ephR7tgzRoZS241kKmWVpDWAQAAAAD9////ARjd9QUAAAAAFgAUyRI+BujX8JZsXRzQ+TMALU63V80AAAAAAAEBKwDh9QUAAAAAIlEg0LImxlmfJzh034/mhKtsMCgIG+6KLL7TGhNvWGX2z6QBE0CeOYl6wv/idSXcRg+FhP3dEf6al84uUMFIm4waTpL8wH5I22OhpMy50pdTfQwDiDg3i78njeeqGhKJldFiXMXNIRY0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNAAUAWAsIhyEWT6/WX4FpGG/Cv9siM8d+Yw0QvigKJMcWXAmidhF3XCwFAMMkmoIhFo3ZarhYslnFGCGMAUpG605qyJnlHGde93T7toqHmc4vDQAmgN1uAQAAAAIAAAAhFvkwigGSWMMQSTRPhfidUim1MchFg2+ZsIYB8RO84Db5BQB91lWSARcgjdlquFiyWcUYIYwBSkbrTmrImeUcZ173dPu2ioeZzi8iGgMLWOM3qk04UqjCk4fEJAjYz746YTpeOX4KnwGl+3EH1GMCNGuZWTNXEHydNFnp3rqNPq9E5mNshcf4U+uQulLozQACT6/WX4FpGG/Cv9siM8d+Yw0QvigKJMcWXAmidhF3XCwC+TCKAZJYwxBJNE+F+J1SKbUxyEWDb5mwhgHxE7zgNvlDGwI0a5lZM1cQfJ00Weneuo0+r0TmY2yFx/hT65C6UujNAALQsibGWZ8nOHTfj+aEq2wwKAgb7oosvtMaE29YZfbPpEICTu/J/dEr50dGSFxni4JolJzJI26fzoIkE5VSOvBCYr8DjCdugyqtS/uekEhRYvV0yLJhnfW9GduP+i6wBZSTvxtDGwJPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLALQsibGWZ8nOHTfj+aEq2wwKAgb7oosvtMaE29YZfbPpEIDoySj9CIb+rK2+geGpwSPM0XONE8UWOFRuhh7Waq0mMsCo2OCWbpMzEb+edjXmk2ecE7A93AbXmZNTYczg4r0kZZDGwL5MIoBkljDEEk0T4X4nVIptTHIRYNvmbCGAfETvOA2+QLQsibGWZ8nOHTfj+aEq2wwKAgb7oosvtMaE29YZfbPpEICwS6074dgMhwHKlHY+2XDTui0UqFIGFV/Yd8GEoWlgJEDoI5BsmKULG5ZMv0ftdmSNol5ifbpEtwhR20ncYdBFJNDHAJPr9ZfgWkYb8K/2yIzx35jDRC+KAokxxZcCaJ2EXdcLALQsibGWZ8nOHTfj+aEq2wwKAgb7oosvtMaE29YZfbPpCDnhVL7TOmy0A4e0OLLmOCHGZEnR36PGhxoGgC5xM5wmEMcAvkwigGSWMMQSTRPhfidUim1MchFg2+ZsIYB8RO84Db5AtCyJsZZnyc4dN+P5oSrbDAoCBvuiiy+0xoTb1hl9s+kIMvMlXhqHGdNSNisUuMi3Xxuq6w7/Evnm3UN4o34Li9zQxwCNGuZWTNXEHydNFnp3rqNPq9E5mNshcf4U+uQulLozQBq5voHDYXyLgYYDZRwd2Cemo5Lf+nNM2aIGiiZxmFnVU8gZX2yhr4U6A7ODdhLTRfE3EFMPla8jO8IJ7BhtN0sj0MAAA==\",\n+            \"musig2 aggregate pubkey is invalid\"\n         ]\n     ],\n     \"valid\" : [\n\n```",
      "created_at": "2026-01-09T12:14:47Z",
      "updated_at": "2026-01-09T12:29:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2675977449",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675977449"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
        }
      },
      "start_line": null,
      "original_start_line": 299,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 345,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675980201",
      "pull_request_review_id": 3643667173,
      "id": 2675980201,
      "node_id": "PRRC_kwDOABII586fgDep",
      "diff_hunk": "@@ -274,6 +274,137 @@ def test_decodepsbt_musig2_input_output_types(self):\n         assert \"participant_pubkeys\" in out_participant_pks\n         assert_equal(out_participant_pks[\"participant_pubkeys\"], [out_pubkey1.hex(), out_pubkey2.hex()])\n \n+    def test_musig2_invalid_pubkey_validation(self):\n+        self.log.info(\"Test MuSig2 pubkey validation prevents acceptance of invalid pubkeys in PSBT deserialization\")\n+        self.log.info(\"This is a regression test ensuring that invalid pubkeys in MuSig2 fields are properly rejected\")\n+        self.log.info(\"rather than being accepted and potentially causing crashes or invalid behavior later\")",
      "path": "test/functional/rpc_psbt.py",
      "position": 1,
      "original_position": 7,
      "commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "original_commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Such comments are not needed. In light of the previously mentioned comments in this file, I suggest to remove the tests in this file in favour of adding in the rpc_psbt.json like suggested in another comment.",
      "created_at": "2026-01-09T12:15:49Z",
      "updated_at": "2026-01-09T12:29:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2675980201",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675980201"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
        }
      },
      "start_line": null,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 280,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675982593",
      "pull_request_review_id": 3643667173,
      "id": 2675982593,
      "node_id": "PRRC_kwDOABII586fgEEB",
      "diff_hunk": "",
      "path": "src/wallet/test/psbt_wallet_tests.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "original_commit_id": "6a1e3620aff758eee82840790e0f748474287558",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't think these unit tests are needed when we can add more functional tests easily.",
      "created_at": "2026-01-09T12:16:39Z",
      "updated_at": "2026-01-09T12:29:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34219#discussion_r2675982593",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675982593"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34219"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    }
  ]
}