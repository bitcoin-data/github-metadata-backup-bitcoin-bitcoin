{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286",
    "id": 1283294415,
    "node_id": "PR_kwDOABII585MfYTP",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/27286",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/27286.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/27286.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
    "number": 27286,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet: Keep track of the wallet's own transaction outputs in memory",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Currently, the wallet is not actually aware about its own transaction outputs. Instead, it will iterate all of the transactions stored in `mapWallet`, and then all of the outputs of those transactions, in order to figure out what belongs to it for the purposes of coin selection and balance calculation. For balance calculation, there is caching that results in it only iterating all of the transactions, but not all of the outputs. However when the cache is dirty, everything is iterated. This is especially problematic for wallets that have a lot of transactions, or transactions that have a lot of unrelated outputs (as may occur with coinjoins or batched payments).\r\n\r\nThis PR helps to resolve this issue by making the wallet track all of the outputs that belong to it in a new member `m_txos`. Note that this includes outputs that may have already been spent. Both balance calculation (`GetBalance`) and coin selection (`AvailableCoins`) are updated to iterate `m_txos`. This is generally faster since it ignores all of the unrelated outputs, and it is not slower as in the worst case of wallets containing only single output transactions, it's exactly the same number of outputs iterated.\r\n\r\n`m_txos` is memory only, and it is populated during wallet loading. When each transaction is loaded, all of its outputs are checked to see if it is `IsMine`, and if so, an entry added to `m_txos`. When new transactions are received, the same procedure is done.\r\n\r\nSince imports can change the `IsMine` status of a transaction (although they can only be \"promoted\" from watchonly to spendable), all of the import RPCs will be a bit slower as they re-iterate all transactions and all outputs to update `m_txos`.\r\n\r\nEach output in `m_txos` is stored in a new `WalletTXO` class. This class contains references to the parent `CWalletTx` and the `CTxOut` itself. It also caches the `IsMine` value of the txout. This should be safe as `IsMine` should not change unless there are imports. This allows us to have additional performance improvements in places that use these `WalletTXO`s as they can use the cached `IsMine` rather than repeatedly calling `IsMine` which can be expensive.\r\n\r\nThe existing `WalletBalance` benchmark demonstrates the performance improvement that this PR makes. The existing `WalletAvailableCoins` benchmark doesn't as all of the outputs used in that benchmark belong to the test wallet. I've updated that benchmark to have a bunch of unrelated outputs in each transaction so that the difference is demonstrated.\r\n\r\nThis is part of a larger project to have the wallet actually track and store a set of its UTXOs.\r\n\r\nBuilt on #24914 as it requires loading the txs last in order for `m_txos` to be built correctly.\r\n\r\n***\r\n\r\n## Benchmarks:\r\n\r\nMaster:\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|---------------:|--------:|----------:|:----------\r\n|       92,245,141.50 |               10.84 |    0.1% |  988,823,975.00 |  66,803,340.50 |    0.0% |      2.04 | `WalletAvailableCoins`\r\n|            5,709.90 |          175,134.50 |    0.5% |       80,968.24 |      25,539.15 |    0.1% |      0.01 | `WalletBalanceClean`\r\n|          139,396.17 |            7,173.80 |    0.6% |    1,383,390.50 |     430,276.86 |    0.0% |      0.01 | `WalletBalanceDirty`\r\n|            5,055.80 |          197,792.47 |    0.3% |       80,968.10 |      25,539.02 |    0.1% |      0.01 | `WalletBalanceMine`\r\n|                9.79 |      102,152,396.19 |    0.1% |          161.00 |          37.00 |    0.0% |      0.01 | `WalletBalanceWatch`\r\n|        1,552,736.00 |              644.02 |    1.5% |   20,316,315.80 |     618,545.80 |    0.6% |      0.08 | `WalletCreateTxUseOnlyPresetInputs`\r\n|      114,114,732.00 |                8.76 |    0.5% |1,291,047,717.60 | 320,244,602.00 |    0.0% |      6.30 | `WalletCreateTxUsePresetInputsAndCoinSelection`\r\n|      359,315,754.00 |                2.78 |    0.1% |4,339,447,818.00 | 136,619,757.00 |    0.7% |      1.80 | `WalletLoadingDescriptors`\r\n|       98,230,601.00 |               10.18 |    0.1% |  537,688,964.00 |  97,332,266.00 |    0.3% |      0.49 | `WalletLoadingLegacy`\r\n\r\nPR:\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|---------------:|--------:|----------:|:----------\r\n|       75,319,868.50 |               13.28 |    0.2% |  863,758,229.00 |  30,892,593.00 |    0.2% |      1.66 | `WalletAvailableCoins`\r\n|            2,367.62 |          422,364.95 |    1.0% |       35,785.05 |       9,893.01 |    0.2% |      0.01 | `WalletBalanceClean`\r\n|            2,685.58 |          372,359.55 |    0.2% |       36,501.05 |      10,027.01 |    0.1% |      0.01 | `WalletBalanceDirty`\r\n|            3,462.24 |          288,830.68 |    2.7% |       35,785.06 |       9,893.01 |    0.3% |      0.01 | `WalletBalanceMine`\r\n|               11.65 |       85,838,176.97 |    0.1% |          180.00 |          42.00 |    0.0% |      0.01 | `WalletBalanceWatch`\r\n|        1,563,092.60 |              639.76 |    1.5% |   20,426,154.40 |     649,953.80 |    0.6% |      0.09 | `WalletCreateTxUseOnlyPresetInputs`\r\n|       58,367,804.40 |               17.13 |    0.9% |  587,164,005.00 | 107,905,843.80 |    0.1% |      3.21 | `WalletCreateTxUsePresetInputsAndCoinSelection`\r\n|      365,302,636.00 |                2.74 |    0.2% |4,349,345,147.00 | 138,730,668.00 |    0.8% |      1.83 | `WalletLoadingDescriptors`\r\n|      124,995,585.00 |                8.00 |    1.2% |  801,998,316.00 | 103,210,721.00 |    0.3% |      0.63 | `WalletLoadingLegacy`\r\n",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2023-03-20T21:02:45Z",
    "updated_at": "2024-08-30T04:35:52Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "66ad3f3e016c00175bbdb2853b7d4cdb75258a21",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "achow101:wallet-txos",
      "ref": "wallet-txos",
      "sha": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 45006379,
        "node_id": "MDEwOlJlcG9zaXRvcnk0NTAwNjM3OQ==",
        "name": "bitcoin",
        "full_name": "achow101/bitcoin",
        "owner": {
          "login": "achow101",
          "id": 3782274,
          "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/achow101",
          "html_url": "https://github.com/achow101",
          "followers_url": "https://api.github.com/users/achow101/followers",
          "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
          "organizations_url": "https://api.github.com/users/achow101/orgs",
          "repos_url": "https://api.github.com/users/achow101/repos",
          "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/achow101/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/achow101/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/achow101/bitcoin",
        "archive_url": "https://api.github.com/repos/achow101/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/achow101/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/achow101/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/achow101/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/achow101/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/achow101/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/achow101/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/achow101/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/achow101/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/achow101/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/achow101/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/achow101/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/achow101/bitcoin/events",
        "forks_url": "https://api.github.com/repos/achow101/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/achow101/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/achow101/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/achow101/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/achow101/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/achow101/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/achow101/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/achow101/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/achow101/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/achow101/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/achow101/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/achow101/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/achow101/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/achow101/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/achow101/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/achow101/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:achow101/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/achow101/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/achow101/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/achow101/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/achow101/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/achow101/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/achow101/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/achow101/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/achow101/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/achow101/bitcoin/hooks",
        "svn_url": "https://github.com/achow101/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 8,
        "stargazers_count": 35,
        "watchers_count": 35,
        "size": 281159,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-08-29T20:56:21Z",
        "created_at": "2015-10-27T00:20:28Z",
        "updated_at": "2024-07-23T18:16:03Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "1e4823870054c3af53619173389376e03174c283",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35796,
        "stargazers_count": 77744,
        "watchers_count": 77744,
        "size": 266978,
        "default_branch": "master",
        "open_issues_count": 660,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-08-29T16:34:39Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-08-30T04:58:07Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 324,
    "deletions": 303,
    "changed_files": 13,
    "commits": 12,
    "review_comments": 62,
    "comments": 8
  },
  "events": [
    {
      "event": "commented",
      "id": 1476930328,
      "node_id": "IC_kwDOABII585YCCsY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476930328",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T21:02:48Z",
      "updated_at": "2024-08-30T04:35:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/27286).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [remyers](https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-1721009982) |\n| Stale ACK | [ishaanam](https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1657907650), [murchandamus](https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-2225335817) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29062](https://github.com/bitcoin/bitcoin/pull/29062) (Wallet: (Refactor) GetBalance to calculate used balance by BrandonOdiwuor)\n* [#28574](https://github.com/bitcoin/bitcoin/pull/28574) (wallet: optimize migration process, batch db transactions by furszy)\n* [#27792](https://github.com/bitcoin/bitcoin/pull/27792) (wallet: Deniability API (Unilateral Transaction Meta-Privacy) by denavila)\n* [#26732](https://github.com/bitcoin/bitcoin/pull/26732) ([WIP] wallet: tx creation, don't select outputs from txes that are being replaced by furszy)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-1476930328",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286"
    },
    {
      "event": "labeled",
      "id": 8799205482,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAIMeThq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8799205482",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-20T21:02:50Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "labeled",
      "id": 8913283218,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAITReiS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8913283218",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-03T13:53:09Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8964360991,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIWUUsf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8964360991",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-10T14:45:18Z"
    },
    {
      "event": "unlabeled",
      "id": 8964546125,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIWVB5N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8964546125",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-10T15:06:52Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8964909964,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIWWauM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8964909964",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-10T15:58:18Z"
    },
    {
      "event": "labeled",
      "id": 8977151682,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAIXFHbC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8977151682",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-11T18:50:14Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8977672228,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIXHGgk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8977672228",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-11T19:58:49Z"
    },
    {
      "event": "unlabeled",
      "id": 8978106678,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIXIwk2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8978106678",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-11T20:55:52Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 8984506953,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAIXhLJJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8984506953",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-12T11:26:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8986356725,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIXoOv1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8986356725",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-12T14:25:22Z"
    },
    {
      "event": "unlabeled",
      "id": 8987168967,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIXrVDH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8987168967",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-12T15:39:01Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9136374703,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAIgkgOv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9136374703",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-01T12:51:22Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9136869059,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIgmY7D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9136869059",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-01T14:12:34Z"
    },
    {
      "event": "unlabeled",
      "id": 9137166885,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIgnhol",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9137166885",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-01T14:56:27Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9195864599,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAIkHcIX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9195864599",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-09T02:14:21Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9245688598,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAInFgMW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9245688598",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-15T11:52:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9251094818,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAInaIEi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9251094818",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-15T21:04:38Z"
    },
    {
      "event": "unlabeled",
      "id": 9251711476,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIncen0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9251711476",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-15T22:38:37Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 9252650429,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIngD29",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9252650429",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T02:22:22Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9256718801,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAInvlHR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9256718801",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T11:07:11Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9261559639,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIoCC9X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9261559639",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T19:01:36Z"
    },
    {
      "event": "unlabeled",
      "id": 9262090607,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIoEElv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9262090607",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T20:06:31Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9281636068,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAIpOobk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9281636068",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-18T16:26:25Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9291327326,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIpzmde",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9291327326",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-19T17:20:32Z"
    },
    {
      "event": "unlabeled",
      "id": 9291684634,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIp09sa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9291684634",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-19T18:10:42Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9292194429,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIp26J9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9292194429",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-19T19:28:42Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9355564874,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAItopdK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9355564874",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-27T01:49:31Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9358094453,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAItyTB1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9358094453",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-27T17:57:47Z"
    },
    {
      "event": "labeled",
      "id": 9416434693,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAIxQ2QF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9416434693",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-02T17:07:25Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9416692430,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAIxR1LO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9416692430",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-02T17:43:28Z"
    },
    {
      "event": "unlabeled",
      "id": 9417311554,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAIxUMVC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9417311554",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-02T19:11:01Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9505244518,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAI2joVm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9505244518",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-12T17:02:53Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9505475636,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAI2kgw0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9505475636",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-12T17:24:29Z"
    },
    {
      "event": "unlabeled",
      "id": 9506693819,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAI2pKK7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9506693819",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-12T19:10:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9658528364,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAI_sXJs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9658528364",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-28T01:11:06Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9667674248,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAJAPQCI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9667674248",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-28T17:53:04Z"
    },
    {
      "event": "unlabeled",
      "id": 9667893504,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAJAQFkA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9667893504",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-28T18:20:37Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1624254517,
      "node_id": "IC_kwDOABII585g0Cg1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1624254517",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-06T20:13:51Z",
      "updated_at": "2023-07-06T20:13:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-1624254517",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286"
    },
    {
      "event": "ready_for_review",
      "id": 9779962846,
      "node_id": "RFRE_lADOABII585hU2-ZzwAAAAJG7mPe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9779962846",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-10T21:20:32Z"
    },
    {
      "event": "reviewed",
      "id": 1527016849,
      "node_id": "PRR_kwDOABII585bBG2R",
      "url": null,
      "actor": null,
      "commit_id": "0d93f58e2e09d1e4551123ec4e968398a2c371c1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nStill working on reviewing this, but here are some initial things. Thanks for breaking it up into twelve commits, it makes it easy to review.",
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1527016849",
      "submitted_at": "2023-07-13T19:54:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "commented",
      "id": 1644753444,
      "node_id": "IC_kwDOABII585iCPIk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1644753444",
      "actor": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-20T22:57:58Z",
      "updated_at": "2023-07-20T22:57:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "The commit message for 68bb1463dc1f995fbfdb75d3acef625bde104275 should be updated because now that #27145 has gotten merged, the described issue has already been fixed.",
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-1644753444",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286"
    },
    {
      "event": "labeled",
      "id": 10299621111,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAJl5773",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10299621111",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-06T19:09:38Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10310785813,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAJmkhsV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10310785813",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-07T18:57:25Z"
    },
    {
      "event": "unlabeled",
      "id": 10311443660,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAJmnCTM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10311443660",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-07T20:28:39Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 10377015907,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAJqhLJj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10377015907",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T21:22:52Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10377262378,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAJqiHUq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10377262378",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T22:04:46Z"
    },
    {
      "event": "unlabeled",
      "id": 10377647778,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAJqjlai",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10377647778",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T23:27:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 10378352928,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAJqmRkg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10378352928",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T02:22:47Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1721009982,
      "node_id": "IC_kwDOABII585mlIc-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1721009982",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T10:01:16Z",
      "updated_at": "2023-09-15T10:01:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nMy preliminary testing confirmed that this PR will significantly speed up common operations like `fundrawtransaction` on wallets with many years of transaction history. A single `fundrawtransaction` RPC call that took 5 sec on a simulated large wallet now takes 50ms. Services providers with large wallets that need to make many RPC calls per minute will benefit from reduced lock contention on `cs_wallet`; for example, LSPs using bitcoin core wallets like Eclair.\r\n\r\nCaching the wallet's tx outputs in memory seems like a straight forward solution as long as the cache of tx outs in `m_txos` are always updated (or regenerated) if the underlying set of wallet txs in `mapWallet` or the `m_spk_managers` change. ",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-1721009982",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286"
    },
    {
      "event": "commented",
      "id": 1721070639,
      "node_id": "IC_kwDOABII585mlXQv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1721070639",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T10:50:54Z",
      "updated_at": "2023-09-15T10:50:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "Exposing `RefreshWalletTXOs()` as a public method puts the responsibility of knowing when it should be called outside of the `CWallet` scope. What do you think about making it private and clearing `m_txos` (or adding a new flag) to trigger `RefreshWalletTXOs()` at query time?\r\n\r\nThis alternate approach would require `GetTXO(const COutPoint& outpoint)` and `GetTXOs()` to first call `RefreshWalletTXOs()` if `m_txos` is empty.  There are only a few methods that change `m_spk_managers` that would need to clear `m_txos` to trigger a one time `RefreshWalletTXOs()`:\r\n - `ImportPrivKeys`\r\n - `ImportPublicKeys`\r\n - `ImportScriptPubKeys`\r\n - `AddScriptPubKeyMan`\r\n\r\nIt's also only a small set of places where keys are imported in `backup.cpp`, so the question of leaving `RefreshWalletTXOs()` public might just be a matter of which approach would be less foot-gunny in the future and if there are disadvantages to delaying the regeneration of txos.\r\n\r\nI think you can safely make `RefreshWalletTxTXOs(const CWalletTx& wtx)` a private method now though because it is only called by wallet methods that add a wtx to `mapWallet` like `LoadToWallet` and `AddToWallet`.",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-1721070639",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286"
    },
    {
      "event": "commented",
      "id": 1721562368,
      "node_id": "IC_kwDOABII585mnPUA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1721562368",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T16:40:12Z",
      "updated_at": "2023-09-15T16:40:12Z",
      "author_association": "MEMBER",
      "body": "> Exposing `RefreshWalletTXOs()` as a public method puts the responsibility of knowing when it should be called outside of the `CWallet` scope. What do you think about making it private and clearing `m_txos` (or adding a new flag) to trigger `RefreshWalletTXOs()` at query time?\r\n\r\nI'm not sure that's meaningfully different. The caller still needs to know when to clear `m_txos` in order to trigger a future `RefreshWalletTXOs()`. The way it is now also provides a better UX as the slow part of refreshing the TXOs occurs during slow import operations rather than the first time those TXOs are needed after the import.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-1721562368",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10386411407,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAJrFA-P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10386411407",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T18:35:35Z"
    },
    {
      "event": "unlabeled",
      "id": 10387022483,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAJrHWKT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10387022483",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T20:05:31Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1722178128,
      "node_id": "IC_kwDOABII585mplpQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1722178128",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-16T08:38:49Z",
      "updated_at": "2023-09-16T08:38:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I'm not sure that's meaningfully different. The caller still needs to know when to clear `m_txos` in order to trigger a future `RefreshWalletTXOs()`. The way it is now also provides a better UX as the slow part of refreshing the TXOs occurs during slow import operations rather than the first time those TXOs are needed after the import.\r\n\r\nJust to clarify, I mean that a reviewer, but not method caller, would need to make sure every method in CWallet that invalidates `m_txos` also clears it. I agree with your point though that forcing the refresh at import time makes sense. I also notice that there are a number of places where a `ScriptPubKeyMan` gets added or updated outside of CWallet, so I understand now why it's not really possible to make `RefreshWalletTXOs()` something internal to `CWallet`.",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-1722178128",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286"
    },
    {
      "event": "reviewed",
      "id": 1657907650,
      "node_id": "PRR_kwDOABII585i0anC",
      "url": null,
      "actor": null,
      "commit_id": "9199832d4440a875a150aa3ba3bc1bc201d3fd72",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 9199832d4440a875a150aa3ba3bc1bc201d3fd72\r\n\r\nI've reviewed everything but the tests and benchmarks. ",
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1657907650",
      "submitted_at": "2023-10-16T12:06:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "review_requested",
      "id": 10664439715,
      "node_id": "RRE_lADOABII585hU2-ZzwAAAAJ7pm-j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10664439715",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-16T12:06:33Z",
      "requested_reviewer": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "labeled",
      "id": 10667807799,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAJ72dQ3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10667807799",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-16T16:18:07Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10670581598,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAJ8BCde",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10670581598",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-16T20:55:18Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10671201068,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAJ8DZss",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10671201068",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-16T22:14:51Z"
    },
    {
      "event": "labeled",
      "id": 10671202969,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAJ8DaKZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10671202969",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-16T22:15:11Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 10671326566,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAJ8D4Vm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10671326566",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-16T22:35:06Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10747391537,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAKAmC4x",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10747391537",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T23:53:46Z"
    },
    {
      "event": "reviewed",
      "id": 1694219823,
      "node_id": "PRR_kwDOABII585k-74v",
      "url": null,
      "actor": null,
      "commit_id": "9292951f0c2a05a79280e4feb8c1557586681105",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1694219823",
      "submitted_at": "2023-10-24T07:51:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10755864105,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAKBGXYp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10755864105",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T15:35:53Z"
    },
    {
      "event": "unlabeled",
      "id": 10772802152,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAKCG-po",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10772802152",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-25T22:07:52Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 10799600391,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAKDtNMH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10799600391",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-29T11:02:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1705025510,
      "node_id": "PRR_kwDOABII585loJ_m",
      "url": null,
      "actor": null,
      "commit_id": "dd411d9d209fe1eacfcb21baba178aa31809f7cf",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1705025510",
      "submitted_at": "2023-10-30T21:04:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10946116434,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAKMcHtS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10946116434",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-13T19:30:36Z"
    },
    {
      "event": "unlabeled",
      "id": 10947134841,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAKMgAV5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10947134841",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-13T21:10:58Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 11058139889,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAKTHdLx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11058139889",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-24T16:47:48Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11085670188,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAKUwecs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11085670188",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T16:03:08Z"
    },
    {
      "event": "unlabeled",
      "id": 11086370268,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAKUzJXc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11086370268",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T17:01:27Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 11192875612,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAKbJbpc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11192875612",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-08T12:12:40Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11197629999,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAKbbkYv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11197629999",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-08T20:50:57Z"
    },
    {
      "event": "unlabeled",
      "id": 11198222047,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAKbd07f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11198222047",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-08T22:35:34Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 11213437023,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAKcX3hf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11213437023",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-11T17:20:02Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11216472025,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAKcjcfZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11216472025",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-11T22:19:28Z"
    },
    {
      "event": "unlabeled",
      "id": 11216970520,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAKclWMY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11216970520",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-11T23:32:56Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 11222641672,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAKc6-wI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11222641672",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-12T12:06:52Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11292617865,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAKhF6yJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11292617865",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-19T17:16:13Z"
    },
    {
      "event": "unlabeled",
      "id": 11293391221,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAKhI3l1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11293391221",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-19T18:30:09Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1798367193,
      "node_id": "PRR_kwDOABII585rMOfZ",
      "url": null,
      "actor": null,
      "commit_id": "0c0022311a0cffc4c03b3763c9b60f93ede13687",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 0c0022311a0cffc4c03b3763c9b60f93ede13687\r\n\r\nWhile I am pretty sure that the reorg logic should handle any transactions getting added or removed from the wallet, it might be useful to add a test that the `m_txos` set would be correct after a reorg, if thatâ€™s not obvious.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1798367193",
      "submitted_at": "2023-12-28T19:38:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "review_requested",
      "id": 11352885424,
      "node_id": "RRE_lADOABII585hU2-ZzwAAAAKkr0iw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11352885424",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-28T19:38:38Z",
      "requested_reviewer": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1801381790,
      "node_id": "PRR_kwDOABII585rXuee",
      "url": null,
      "actor": null,
      "commit_id": "0c0022311a0cffc4c03b3763c9b60f93ede13687",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1801381790",
      "submitted_at": "2024-01-03T05:26:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11394899160,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAKnMFzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11394899160",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-04T21:05:02Z"
    },
    {
      "event": "labeled",
      "id": 11477929892,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAKsI0-k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11477929892",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-13T12:30:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1841667091,
      "node_id": "PRR_kwDOABII585txZwT",
      "url": null,
      "actor": null,
      "commit_id": "39f0ab3e126704b30f7ed2b86690f60b631d2ec4",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ReACK https://github.com/bitcoin/bitcoin/commit/39f0ab3e126704b30f7ed2b86690f60b631d2ec4 compared to my prior review, there are only the changes mentioned in response to @aureleoules.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1841667091",
      "submitted_at": "2024-01-24T15:26:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "labeled",
      "id": 11691586928,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAK433Vw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11691586928",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-03T04:54:14Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11752092325,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAK8erKl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11752092325",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T22:50:15Z"
    },
    {
      "event": "unlabeled",
      "id": 11752346551,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAK8fpO3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11752346551",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T23:34:12Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 11753584915,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAK8kXkT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11753584915",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T03:59:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 11860704730,
      "node_id": "LE_lADOABII585hU2-ZzwAAAALC8_3a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11860704730",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-20T11:55:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11864779659,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAALDMiuL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11864779659",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-20T16:59:02Z"
    },
    {
      "event": "unlabeled",
      "id": 11865632384,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAALDPy6A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11865632384",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-20T18:13:06Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1928856157,
      "node_id": "PRR_kwDOABII585y-AJd",
      "url": null,
      "actor": null,
      "commit_id": "26484ad2340c76570ce4a06abaf422ad66f6ef97",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-1928856157",
      "submitted_at": "2024-03-11T21:05:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12090602377,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAALQp_OJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12090602377",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-12T14:51:27Z"
    },
    {
      "event": "labeled",
      "id": 12124367418,
      "node_id": "LE_lADOABII585hU2-ZzwAAAALSqyo6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12124367418",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T22:03:18Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 12177385220,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAALV1CcE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12177385220",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-19T23:51:35Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 12269184867,
      "node_id": "LE_lADOABII585hU2-ZzwAAAALbTOdj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12269184867",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-27T17:15:31Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12296729847,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAALc8TT3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12296729847",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-29T16:54:03Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12296734672,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAALc8UfQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12296734672",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-29T16:54:40Z"
    },
    {
      "event": "unlabeled",
      "id": 12297033172,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAALc9dXU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12297033172",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-29T17:31:18Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13073303723,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAMLOsir",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13073303723",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-06T23:43:25Z"
    },
    {
      "event": "labeled",
      "id": 13399807467,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAMesNXr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13399807467",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-05T02:45:40Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13447861300,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAMhjhQ0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13447861300",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-09T23:37:29Z"
    },
    {
      "event": "commented",
      "id": 2218998406,
      "node_id": "IC_kwDOABII586EQzqG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2218998406",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-09T23:37:32Z",
      "updated_at": "2024-07-09T23:37:32Z",
      "author_association": "MEMBER",
      "body": "Rebased for silent merge conflict.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#issuecomment-2218998406",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27286"
    },
    {
      "event": "unlabeled",
      "id": 13448575748,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAMhmPsE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13448575748",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-10T01:44:34Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 13478020694,
      "node_id": "LE_lADOABII585hU2-ZzwAAAAMjWkZW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13478020694",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-11T21:00:31Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13606799852,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAAMrB0ns",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13606799852",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T20:58:43Z"
    },
    {
      "event": "unlabeled",
      "id": 13606964077,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAAMrCctt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13606964077",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T21:17:22Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2225335817,
      "node_id": "PRR_kwDOABII586Eo-4J",
      "url": null,
      "actor": null,
      "commit_id": "3b6ac646ffea930ae7d8c5d93acaba3587cc9dcd",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ReACK 3b6ac646ffea930ae7d8c5d93acaba3587cc9dcd",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#pullrequestreview-2225335817",
      "submitted_at": "2024-08-08T18:06:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
    },
    {
      "event": "labeled",
      "id": 14032398078,
      "node_id": "LE_lADOABII585hU2-ZzwAAAANEZWb-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14032398078",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-27T17:15:19Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM4ZDE0MDllZjMyZTczNWE1MTg1YjFhYjE1NTc1ODk5ZmQ2YWQ3NGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c8d1409ef32e735a5185b1ab15575899fd6ad74e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c8d1409ef32e735a5185b1ab15575899fd6ad74e",
      "tree": {
        "sha": "c36c7110d3fdf3a21842c25a8a57887b141dd5d6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c36c7110d3fdf3a21842c25a8a57887b141dd5d6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1e4823870054c3af53619173389376e03174c283",
          "sha": "1e4823870054c3af53619173389376e03174c283",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1e4823870054c3af53619173389376e03174c283"
        }
      ],
      "message": "walletdb: Load Txs last\n\nNeed to load txs last so that IsMine works.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:13:39Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:49:51Z"
      },
      "sha": "c8d1409ef32e735a5185b1ab15575899fd6ad74e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDAxNjhjZjUxYjljZWFlNDg4MWJhOGNjMDJiYzc4YTM5YWJhZTM0NjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0168cf51b9ceae4881ba8cc02bc78a39abae3461",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0168cf51b9ceae4881ba8cc02bc78a39abae3461",
      "tree": {
        "sha": "d1c80f7c27a99e88253f5e97074be49cfb74ed73",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d1c80f7c27a99e88253f5e97074be49cfb74ed73"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c8d1409ef32e735a5185b1ab15575899fd6ad74e",
          "sha": "c8d1409ef32e735a5185b1ab15575899fd6ad74e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c8d1409ef32e735a5185b1ab15575899fd6ad74e"
        }
      ],
      "message": "wallet: Keep track of transaction outputs owned by the wallet\n\nWhen loading transactions to the wallet, check the outputs, and keep\ntrack of the ones that are IsMine.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:13:39Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:49:53Z"
      },
      "sha": "0168cf51b9ceae4881ba8cc02bc78a39abae3461"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBiODRmYzkwNDk2NzA3MzcxZjAwMjE1MzQ1ZTE5NTIyZjU0MTRhYWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0b84fc90496707371f00215345e19522f5414aad",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0b84fc90496707371f00215345e19522f5414aad",
      "tree": {
        "sha": "28332b65cdb18a209f521f382fa2319ad81941f7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/28332b65cdb18a209f521f382fa2319ad81941f7"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0168cf51b9ceae4881ba8cc02bc78a39abae3461",
          "sha": "0168cf51b9ceae4881ba8cc02bc78a39abae3461",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0168cf51b9ceae4881ba8cc02bc78a39abae3461"
        }
      ],
      "message": "wallet: Exit IsTrustedTx early if wtx is already in trusted_parents",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:13:39Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:49:56Z"
      },
      "sha": "0b84fc90496707371f00215345e19522f5414aad"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDlkNjI4MTE2YTBkYTcyODRkNTZmNWE5MTIxMzliYzkxMTAxNDA4NTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9d628116a0da7284d56f5a912139bc9110140851",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9d628116a0da7284d56f5a912139bc9110140851",
      "tree": {
        "sha": "fa9bae22f349fbd9787a12629b4009fdc29c6c6b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fa9bae22f349fbd9787a12629b4009fdc29c6c6b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0b84fc90496707371f00215345e19522f5414aad",
          "sha": "0b84fc90496707371f00215345e19522f5414aad",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0b84fc90496707371f00215345e19522f5414aad"
        }
      ],
      "message": "wallet: Change balance calculation to use m_txos\n\nSince we track the outputs owned by the wallet with m_txos, we can now\ncalculate the balance of the wallet by iterating m_txos and summing up\nthe amounts of the unspent txos.\n\nAs ISMINE_USED is not an actual isminetype that we attach to outputs and\nwas just passed into `CachedTxGetAvailableCredit` for convenience, we\npull the same determining logic from that function into `GetBalances` in\norder to preserve existing behavior.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:13:39Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:49:58Z"
      },
      "sha": "9d628116a0da7284d56f5a912139bc9110140851"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRkNmQ2OWNhNTY2MDhiMmIxZjFiOWRlN2U0ODVhMjRhNGRjYWM1MDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4d6d69ca56608b2b1f1b9de7e485a24a4dcac504",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4d6d69ca56608b2b1f1b9de7e485a24a4dcac504",
      "tree": {
        "sha": "517bceab74c2c54fa422f8a7528ae2abb9904510",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/517bceab74c2c54fa422f8a7528ae2abb9904510"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9d628116a0da7284d56f5a912139bc9110140851",
          "sha": "9d628116a0da7284d56f5a912139bc9110140851",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9d628116a0da7284d56f5a912139bc9110140851"
        }
      ],
      "message": "wallet: Recalculate the wallet's txos after any imports",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:15:15Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:50:00Z"
      },
      "sha": "4d6d69ca56608b2b1f1b9de7e485a24a4dcac504"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNhZjhjMDk0MDEwZmI0Y2NmM2Q4ZDk5M2QyZmMxZTFhNTQwMDE0NjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/caf8c094010fb4ccf3d8d993d2fc1e1a54001460",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/caf8c094010fb4ccf3d8d993d2fc1e1a54001460",
      "tree": {
        "sha": "2900c72e521253895728f4a8793cfb10f56d6266",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2900c72e521253895728f4a8793cfb10f56d6266"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4d6d69ca56608b2b1f1b9de7e485a24a4dcac504",
          "sha": "4d6d69ca56608b2b1f1b9de7e485a24a4dcac504",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4d6d69ca56608b2b1f1b9de7e485a24a4dcac504"
        }
      ],
      "message": "test: Test for balance update due to watchonly becoming spendable",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:15:16Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:50:02Z"
      },
      "sha": "caf8c094010fb4ccf3d8d993d2fc1e1a54001460"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRiZDZiYTcyMTdlMWJkMmMxNWY0MDBiZmM5ZWNhOTMwZjE1OTcyMDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dbd6ba7217e1bd2c15f400bfc9eca930f1597200",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/dbd6ba7217e1bd2c15f400bfc9eca930f1597200",
      "tree": {
        "sha": "658f996608d9b0ba1b59eb9f6a37730c073566a3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/658f996608d9b0ba1b59eb9f6a37730c073566a3"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/caf8c094010fb4ccf3d8d993d2fc1e1a54001460",
          "sha": "caf8c094010fb4ccf3d8d993d2fc1e1a54001460",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/caf8c094010fb4ccf3d8d993d2fc1e1a54001460"
        }
      ],
      "message": "wallet: Use wallet's TXO set in AvailableCoins\n\nInstead of iterating every transaction and every output stored in wallet\nwhen trying to figure out what outputs can be spent, iterate the TXO set\nwhich should be a lot smaller.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:15:16Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:50:07Z"
      },
      "sha": "dbd6ba7217e1bd2c15f400bfc9eca930f1597200"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM2YTY4YjYxZjFhNjEyZjhiZjNmOWUzNjAxMTRlMTE0Njc5Y2UzYTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c6a68b61f1a612f8bf3f9e360114e114679ce3a1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c6a68b61f1a612f8bf3f9e360114e114679ce3a1",
      "tree": {
        "sha": "748c2db92cb292287897d360e0ea444636e855eb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/748c2db92cb292287897d360e0ea444636e855eb"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dbd6ba7217e1bd2c15f400bfc9eca930f1597200",
          "sha": "dbd6ba7217e1bd2c15f400bfc9eca930f1597200",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/dbd6ba7217e1bd2c15f400bfc9eca930f1597200"
        }
      ],
      "message": "wallet: Retrieve TXO directly in FetchSelectedInputs\n\nInstead of searching mapWallet for the preselected inputs, search\nm_txos.\n\nwallet_fundrawtransaction.py spends external inputs and needs the change\noutput to also belong to the test wallet for the oversized tx test.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:15:16Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:50:09Z"
      },
      "sha": "c6a68b61f1a612f8bf3f9e360114e114679ce3a1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM2MDRiMzIyN2EzNzAxZWNkMGZlMDZmMTJiNjIxOWIwZmM5ZDMwODc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c604b3227a3701ecd0fe06f12b6219b0fc9d3087",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c604b3227a3701ecd0fe06f12b6219b0fc9d3087",
      "tree": {
        "sha": "8f579c75b08ced5c7d22172188640fbce5dc7554",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8f579c75b08ced5c7d22172188640fbce5dc7554"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c6a68b61f1a612f8bf3f9e360114e114679ce3a1",
          "sha": "c6a68b61f1a612f8bf3f9e360114e114679ce3a1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c6a68b61f1a612f8bf3f9e360114e114679ce3a1"
        }
      ],
      "message": "wallet: Recompute wallet TXOs after descriptor migration\n\nWhen a legacy wallet has been migrated to contain descriptors, but\nbefore the transactions have been updated to match, we need to recompute\nthe wallet TXOs so that the transaction update will work correctly.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:15:16Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:50:11Z"
      },
      "sha": "c604b3227a3701ecd0fe06f12b6219b0fc9d3087"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGEzYjZjZjMwNjU4MzhhNDBkOTFhYjgxYzhhOGI2MDI3MWM4NzZjOTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a3b6cf3065838a40d91ab81c8a8b60271c876c94",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a3b6cf3065838a40d91ab81c8a8b60271c876c94",
      "tree": {
        "sha": "8a69b0ef10c80d94362899906c8a5b090d02ae9b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8a69b0ef10c80d94362899906c8a5b090d02ae9b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c604b3227a3701ecd0fe06f12b6219b0fc9d3087",
          "sha": "c604b3227a3701ecd0fe06f12b6219b0fc9d3087",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c604b3227a3701ecd0fe06f12b6219b0fc9d3087"
        }
      ],
      "message": "wallet: Have GetDebit use the wallet's TXO set\n\nInstead of looking up the previous tx in mapWallet, and then calling\nIsMine on the specified output, use the TXO set and its cached IsMine\nvalue.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:15:16Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:50:13Z"
      },
      "sha": "a3b6cf3065838a40d91ab81c8a8b60271c876c94"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZmZjNjNjJjMjE0ZWMzYjMyOWVlYTA2OWZjMTZkYmEwZDNlZTI3MmE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ff3c62c214ec3b329eea069fc16dba0d3ee272a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6ff3c62c214ec3b329eea069fc16dba0d3ee272a",
      "tree": {
        "sha": "61f7a0f1977337c62c2b139828a12d91e51c8903",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/61f7a0f1977337c62c2b139828a12d91e51c8903"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a3b6cf3065838a40d91ab81c8a8b60271c876c94",
          "sha": "a3b6cf3065838a40d91ab81c8a8b60271c876c94",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a3b6cf3065838a40d91ab81c8a8b60271c876c94"
        }
      ],
      "message": "wallet: Remove unused CachedTxGet{Available,Immature}Credit\n\nThese two functions are no longer used as GetBalances now uses the TXO\nset rather than per-tx cached balances",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:16:15Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:50:15Z"
      },
      "sha": "6ff3c62c214ec3b329eea069fc16dba0d3ee272a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGIwYzVjZGMwZDc2ZWY4MDljNmY4OGExMmM3MWI4Nzg5ZTg2MGE5NmQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "tree": {
        "sha": "7aecd8b00c8c986326d8cbab6f4a77f3ff0a669a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7aecd8b00c8c986326d8cbab6f4a77f3ff0a669a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ff3c62c214ec3b329eea069fc16dba0d3ee272a",
          "sha": "6ff3c62c214ec3b329eea069fc16dba0d3ee272a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6ff3c62c214ec3b329eea069fc16dba0d3ee272a"
        }
      ],
      "message": "bench: Have AvailableCoins benchmark include a lot of unrelated utxos\n\nOne of the main issues with AvailableCoins is its performance when txs\nhave unrelated outputs, so update the benchmark to check the performance\nof that.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-08-29T16:16:17Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-02-20T16:50:17Z"
      },
      "sha": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14066295562,
      "node_id": "HRFPE_lADOABII585hU2-ZzwAAAANGaqMK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14066295562",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-29T16:28:36Z"
    },
    {
      "event": "unlabeled",
      "id": 14070035241,
      "node_id": "UNLE_lADOABII585hU2-ZzwAAAANGo7Mp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14070035241",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-29T20:32:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1261601507",
      "pull_request_review_id": 1527016849,
      "id": 1261601507,
      "node_id": "PRRC_kwDOABII585LMoLj",
      "diff_hunk": "@@ -297,27 +298,41 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n         std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx(), trusted_parents)};",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "68bb1463dc1f995fbfdb75d3acef625bde104275",
      "in_reply_to_id": null,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 68bb1463dc1f995fbfdb75d3acef625bde104275 \"wallet: Change balance calculation to use m_txos \"\r\n\r\nnit: \r\n```suggestion\r\n            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\r\n```\r\n& also remove the unused `trusted_parents` from above. (for `GetAddressBalances` as well)",
      "created_at": "2023-07-12T18:51:47Z",
      "updated_at": "2023-07-13T19:54:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1261601507",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1261601507"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262844660",
      "pull_request_review_id": 1527016849,
      "id": 1262844660,
      "node_id": "PRRC_kwDOABII585LRXr0",
      "diff_hunk": "@@ -297,27 +298,41 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n         std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx(), trusted_parents)};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {\n+                // Get the amounts for mine and watchonly\n+                CAmount credit_mine = 0;\n+                CAmount credit_watchonly = 0;\n+                if (txo.GetIsMine() == ISMINE_SPENDABLE) {\n+                    credit_mine = txo.GetTxOut().nValue;\n+                } else if (txo.GetIsMine() == ISMINE_WATCH_ONLY) {\n+                    credit_watchonly = txo.GetTxOut().nValue;\n+                } else {\n+                    // We shouldn't see any other isminetypes\n+                    Assume(false);\n+                }\n+\n+                // Set the amounts in the return object\n+                if (wallet.IsTxImmatureCoinBase(txo.GetWalletTx()) && wallet.IsTxInMainChain(txo.GetWalletTx())) {\n+                    ret.m_mine_immature += credit_mine;\n+                    ret.m_watchonly_immature += credit_watchonly;\n+                } else if (is_trusted && tx_depth >= min_depth) {\n+                    ret.m_mine_trusted += credit_mine;\n+                    ret.m_watchonly_trusted += credit_watchonly;\n+                } if (!is_trusted && tx_depth == 0 && txo.GetWalletTx().InMempool()) {",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 57,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "68bb1463dc1f995fbfdb75d3acef625bde104275",
      "in_reply_to_id": null,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 68bb1463dc1f995fbfdb75d3acef625bde104275 \" wallet: Change balance calculation to use m_txos \"\r\n\r\nnit: checking the tx depth is redundant here because if the transaction is `TxStateMempool` then `GetTxDepthInMainChain` will always return 0.\r\n```suggestion\r\n                } if (!is_trusted && txo.GetWalletTx().InMempool()) {\r\n```",
      "created_at": "2023-07-13T17:10:37Z",
      "updated_at": "2023-07-13T19:54:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1262844660",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262844660"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262864895",
      "pull_request_review_id": 1527016849,
      "id": 1262864895,
      "node_id": "PRRC_kwDOABII585LRcn_",
      "diff_hunk": "@@ -480,6 +480,7 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     const std::unordered_map<COutPoint, WalletTXO, SaltedOutpointHasher>& GetTXOs() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet) { AssertLockHeld(cs_wallet); return m_txos; };\n \n     void RefreshWalletTxTXOs(const CWalletTx& wtx) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n+    void RefreshWalletTXOs() EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
      "path": "src/wallet/wallet.h",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "3f3246efe299552e450362a03c61c602a168f7de",
      "in_reply_to_id": null,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 3f3246efe299552e450362a03c61c602a168f7de \"wallet: Recalculate the wallet's txos after any imports \"\r\n\r\nDoes this also need to be called during `sethdseed` and `keypoolrefill`.",
      "created_at": "2023-07-13T17:27:37Z",
      "updated_at": "2023-07-13T19:54:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1262864895",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262864895"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 508,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262869959",
      "pull_request_review_id": 1527016849,
      "id": 1262869959,
      "node_id": "PRRC_kwDOABII585LRd3H",
      "diff_hunk": "@@ -627,6 +631,7 @@ RPCHelpMan importwallet()\n \n             progress++;\n         }\n+        pwallet->RefreshWalletTXOs();",
      "path": "src/wallet/rpc/backup.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "3f3246efe299552e450362a03c61c602a168f7de",
      "in_reply_to_id": null,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/3f3246efe299552e450362a03c61c602a168f7de \"wallet: Recalculate the wallet's txos after any imports \"\r\n\r\nIs this needed if the wallet will rescan anyways? ",
      "created_at": "2023-07-13T17:32:55Z",
      "updated_at": "2023-07-13T19:54:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1262869959",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262869959"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 634,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262884442",
      "pull_request_review_id": 1527016849,
      "id": 1262884442,
      "node_id": "PRRC_kwDOABII585LRhZa",
      "diff_hunk": "@@ -217,133 +217,141 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     const bool can_grind_r = wallet.CanGrindR();\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& wtxid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;\n \n-        // Similarly, we should not consider coins from transactions that\n-        // have been replaced. In the example above, we would want to prevent\n-        // creation of a transaction A' spending an output of A, because if\n-        // transaction B were initially confirmed, conflicting with A and\n-        // A', we wouldn't want to the user to create a transaction D\n-        // intending to replace A', but potentially resulting in a scenario\n-        // where A, A', and D could all be accepted (instead of just B and\n-        // D, or just A and A' like the user would want).\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n-            safeTx = false;\n-        }\n+        if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n+            continue;\n \n-        if (only_safe && !safeTx) {\n+        if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n             continue;\n         }\n \n-        if (nDepth < min_depth || nDepth > max_depth) {\n+        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n             continue;\n-        }\n \n-        bool tx_from_me = CachedTxIsFromMe(wallet, wtx, ISMINE_ALL);\n+        isminetype mine = wallet.IsMine(output);\n \n-        for (unsigned int i = 0; i < wtx.tx->vout.size(); i++) {\n-            const CTxOut& output = wtx.tx->vout[i];\n-            const COutPoint outpoint(wtxid, i);\n+        if (mine == ISMINE_NO) {\n+            continue;\n+        }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 86,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "881650ed319c6ed74e66ae56c34cdee93125231b",
      "in_reply_to_id": null,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 881650ed319c6ed74e66ae56c34cdee93125231b \" wallet: Use wallet's TXO set in AvailableCoins \"\r\n\r\nShouldn't txos in `m_txos` never be `ISMINE_NO`?\r\n\r\n```suggestion\r\n        assert(mine != ISMINE_NO);\r\n```",
      "created_at": "2023-07-13T17:47:05Z",
      "updated_at": "2023-07-13T19:54:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1262884442",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262884442"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": 252,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 352,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262959018",
      "pull_request_review_id": 1527016849,
      "id": 1262959018,
      "node_id": "PRRC_kwDOABII585LRzmq",
      "diff_hunk": "@@ -217,133 +217,141 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     const bool can_grind_r = wallet.CanGrindR();\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& wtxid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;\n \n-        // Similarly, we should not consider coins from transactions that\n-        // have been replaced. In the example above, we would want to prevent\n-        // creation of a transaction A' spending an output of A, because if\n-        // transaction B were initially confirmed, conflicting with A and\n-        // A', we wouldn't want to the user to create a transaction D\n-        // intending to replace A', but potentially resulting in a scenario\n-        // where A, A', and D could all be accepted (instead of just B and\n-        // D, or just A and A' like the user would want).\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n-            safeTx = false;\n-        }\n+        if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n+            continue;\n \n-        if (only_safe && !safeTx) {\n+        if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n             continue;\n         }\n \n-        if (nDepth < min_depth || nDepth > max_depth) {\n+        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n             continue;\n-        }\n \n-        bool tx_from_me = CachedTxIsFromMe(wallet, wtx, ISMINE_ALL);\n+        isminetype mine = wallet.IsMine(output);\n \n-        for (unsigned int i = 0; i < wtx.tx->vout.size(); i++) {\n-            const CTxOut& output = wtx.tx->vout[i];\n-            const COutPoint outpoint(wtxid, i);\n+        if (mine == ISMINE_NO) {\n+            continue;\n+        }\n \n-            if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n-                continue;\n+        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n+        if (nDepth < 0)\n+            continue;\n \n-            // Skip manually selected coins (the caller can fetch them directly)\n-            if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n-                continue;\n+        if (tx_safe_cache.count(outpoint.hash) == 0 ) {\n+            tx_safe_cache[outpoint.hash] = {false, false};\n \n-            if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n+            // We should not consider coins which aren't at least in our mempool\n+            // It's possible for these to be conflicted via ancestors which we may never be able to detect\n+            if (nDepth == 0 && !wtx.InMempool())\n                 continue;\n \n-            if (wallet.IsSpent(outpoint))\n-                continue;\n+            bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n+\n+            // We should not consider coins from transactions that are replacing\n+            // other transactions.\n+            //\n+            // Example: There is a transaction A which is replaced by bumpfee\n+            // transaction B. In this case, we want to prevent creation of\n+            // a transaction B' which spends an output of B.\n+            //\n+            // Reason: If transaction A were initially confirmed, transactions B\n+            // and B' would no longer be valid, so the user would have to create\n+            // a new transaction C to replace B'. However, in the case of a\n+            // one-block reorg, transactions B' and C might BOTH be accepted,\n+            // when the user only wanted one of them. Specifically, there could\n+            // be a 1-block reorg away from the chain where transactions A and C\n+            // were accepted to another chain where B, B', and C were all\n+            // accepted.\n+            if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n+                safeTx = false;\n+            }\n \n-            isminetype mine = wallet.IsMine(output);\n+            // Similarly, we should not consider coins from transactions that\n+            // have been replaced. In the example above, we would want to prevent\n+            // creation of a transaction A' spending an output of A, because if\n+            // transaction B were initially confirmed, conflicting with A and\n+            // A', we wouldn't want to the user to create a transaction D\n+            // intending to replace A', but potentially resulting in a scenario\n+            // where A, A', and D could all be accepted (instead of just B and\n+            // D, or just A and A' like the user would want).\n+            if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n+                safeTx = false;\n+            }\n \n-            if (mine == ISMINE_NO) {\n+            if (only_safe && !safeTx) {\n                 continue;\n             }\n \n-            if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n+            if (nDepth < min_depth || nDepth > max_depth) {\n                 continue;\n             }\n \n-            std::unique_ptr<SigningProvider> provider = wallet.GetSolvingProvider(output.scriptPubKey);\n-\n-            int input_bytes = CalculateMaximumSignedInputSize(output, COutPoint(), provider.get(), can_grind_r, coinControl);\n-            bool solvable = provider ? InferDescriptor(output.scriptPubKey, *provider)->IsSolvable() : false;\n-            bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n-\n-            // Filter by spendable outputs only\n-            if (!spendable && params.only_spendable) continue;\n-\n-            // Obtain script type\n-            std::vector<std::vector<uint8_t>> script_solutions;\n-            TxoutType type = Solver(output.scriptPubKey, script_solutions);\n-\n-            // If the output is P2SH and solvable, we want to know if it is\n-            // a P2SH (legacy) or one of P2SH-P2WPKH, P2SH-P2WSH (P2SH-Segwit). We can determine\n-            // this from the redeemScript. If the output is not solvable, it will be classified\n-            // as a P2SH (legacy), since we have no way of knowing otherwise without the redeemScript\n-            bool is_from_p2sh{false};\n-            if (type == TxoutType::SCRIPTHASH && solvable) {\n-                CScript script;\n-                if (!provider->GetCScript(CScriptID(uint160(script_solutions[0])), script)) continue;\n-                type = Solver(script, script_solutions);\n-                is_from_p2sh = true;\n-            }\n+            tx_safe_cache[outpoint.hash] = {true, safeTx};\n+        }\n+        const auto& [tx_ok, tx_safe] = tx_safe_cache.at(outpoint.hash);\n+        Assert(tx_ok);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 179,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "881650ed319c6ed74e66ae56c34cdee93125231b",
      "in_reply_to_id": null,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/881650ed319c6ed74e66ae56c34cdee93125231b \" wallet: Use wallet's TXO set in AvailableCoins \"\r\n\r\nCan't `tx_ok` still be false at this point if a transaction that has a depth of 0 and is not in the mempool has two txos that belong to the wallet? Since then when the first txo is evaluated, a `{false, false}` entry will be created for that transaction hash, and then when the second txo is evaluated, that entry will be used because the mempool check will be skipped?",
      "created_at": "2023-07-13T19:09:48Z",
      "updated_at": "2023-07-13T19:54:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1262959018",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1262959018"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 410,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327654362",
      "pull_request_review_id": 1629521706,
      "id": 1327654362,
      "node_id": "PRRC_kwDOABII585PImXa",
      "diff_hunk": "@@ -297,27 +298,41 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n         std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx(), trusted_parents)};",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "68bb1463dc1f995fbfdb75d3acef625bde104275",
      "in_reply_to_id": 1261601507,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-09-15T18:35:37Z",
      "updated_at": "2023-09-15T18:35:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1327654362",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327654362"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327654424",
      "pull_request_review_id": 1629521785,
      "id": 1327654424,
      "node_id": "PRRC_kwDOABII585PImYY",
      "diff_hunk": "@@ -297,27 +298,41 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n         std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx(), trusted_parents)};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {\n+                // Get the amounts for mine and watchonly\n+                CAmount credit_mine = 0;\n+                CAmount credit_watchonly = 0;\n+                if (txo.GetIsMine() == ISMINE_SPENDABLE) {\n+                    credit_mine = txo.GetTxOut().nValue;\n+                } else if (txo.GetIsMine() == ISMINE_WATCH_ONLY) {\n+                    credit_watchonly = txo.GetTxOut().nValue;\n+                } else {\n+                    // We shouldn't see any other isminetypes\n+                    Assume(false);\n+                }\n+\n+                // Set the amounts in the return object\n+                if (wallet.IsTxImmatureCoinBase(txo.GetWalletTx()) && wallet.IsTxInMainChain(txo.GetWalletTx())) {\n+                    ret.m_mine_immature += credit_mine;\n+                    ret.m_watchonly_immature += credit_watchonly;\n+                } else if (is_trusted && tx_depth >= min_depth) {\n+                    ret.m_mine_trusted += credit_mine;\n+                    ret.m_watchonly_trusted += credit_watchonly;\n+                } if (!is_trusted && tx_depth == 0 && txo.GetWalletTx().InMempool()) {",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 57,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "68bb1463dc1f995fbfdb75d3acef625bde104275",
      "in_reply_to_id": 1262844660,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-09-15T18:35:41Z",
      "updated_at": "2023-09-15T18:35:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1327654424",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327654424"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327656315",
      "pull_request_review_id": 1629524562,
      "id": 1327656315,
      "node_id": "PRRC_kwDOABII585PIm17",
      "diff_hunk": "@@ -480,6 +480,7 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     const std::unordered_map<COutPoint, WalletTXO, SaltedOutpointHasher>& GetTXOs() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet) { AssertLockHeld(cs_wallet); return m_txos; };\n \n     void RefreshWalletTxTXOs(const CWalletTx& wtx) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n+    void RefreshWalletTXOs() EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
      "path": "src/wallet/wallet.h",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "3f3246efe299552e450362a03c61c602a168f7de",
      "in_reply_to_id": 1262864895,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Hmm, good point. The expected usage of these is that only new keys will be generated/added, so it shouldn't have any effect on the existing transactions in the wallet. However, I suppose they could be used in a way that does result in existing txs having their IsMine changed. I've also added this to `addmultisigaddress` and `newkeypool` since they could be used in the same way.",
      "created_at": "2023-09-15T18:38:01Z",
      "updated_at": "2023-09-15T18:38:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1327656315",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327656315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 508,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327656948",
      "pull_request_review_id": 1629525521,
      "id": 1327656948,
      "node_id": "PRRC_kwDOABII585PIm_0",
      "diff_hunk": "@@ -627,6 +631,7 @@ RPCHelpMan importwallet()\n \n             progress++;\n         }\n+        pwallet->RefreshWalletTXOs();",
      "path": "src/wallet/rpc/backup.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "3f3246efe299552e450362a03c61c602a168f7de",
      "in_reply_to_id": 1262869959,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The wallet may not rescan every transaction in the wallet since it does look at the given key birthdays.",
      "created_at": "2023-09-15T18:38:46Z",
      "updated_at": "2023-09-15T18:38:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1327656948",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327656948"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 634,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327657164",
      "pull_request_review_id": 1629525867,
      "id": 1327657164,
      "node_id": "PRRC_kwDOABII585PInDM",
      "diff_hunk": "@@ -217,133 +217,141 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     const bool can_grind_r = wallet.CanGrindR();\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& wtxid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;\n \n-        // Similarly, we should not consider coins from transactions that\n-        // have been replaced. In the example above, we would want to prevent\n-        // creation of a transaction A' spending an output of A, because if\n-        // transaction B were initially confirmed, conflicting with A and\n-        // A', we wouldn't want to the user to create a transaction D\n-        // intending to replace A', but potentially resulting in a scenario\n-        // where A, A', and D could all be accepted (instead of just B and\n-        // D, or just A and A' like the user would want).\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n-            safeTx = false;\n-        }\n+        if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n+            continue;\n \n-        if (only_safe && !safeTx) {\n+        if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n             continue;\n         }\n \n-        if (nDepth < min_depth || nDepth > max_depth) {\n+        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n             continue;\n-        }\n \n-        bool tx_from_me = CachedTxIsFromMe(wallet, wtx, ISMINE_ALL);\n+        isminetype mine = wallet.IsMine(output);\n \n-        for (unsigned int i = 0; i < wtx.tx->vout.size(); i++) {\n-            const CTxOut& output = wtx.tx->vout[i];\n-            const COutPoint outpoint(wtxid, i);\n+        if (mine == ISMINE_NO) {\n+            continue;\n+        }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 86,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "881650ed319c6ed74e66ae56c34cdee93125231b",
      "in_reply_to_id": 1262884442,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-09-15T18:39:01Z",
      "updated_at": "2023-09-15T18:39:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1327657164",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327657164"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": 252,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 352,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327657382",
      "pull_request_review_id": 1629526153,
      "id": 1327657382,
      "node_id": "PRRC_kwDOABII585PInGm",
      "diff_hunk": "@@ -217,133 +217,141 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     const bool can_grind_r = wallet.CanGrindR();\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& wtxid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;\n \n-        // Similarly, we should not consider coins from transactions that\n-        // have been replaced. In the example above, we would want to prevent\n-        // creation of a transaction A' spending an output of A, because if\n-        // transaction B were initially confirmed, conflicting with A and\n-        // A', we wouldn't want to the user to create a transaction D\n-        // intending to replace A', but potentially resulting in a scenario\n-        // where A, A', and D could all be accepted (instead of just B and\n-        // D, or just A and A' like the user would want).\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n-            safeTx = false;\n-        }\n+        if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n+            continue;\n \n-        if (only_safe && !safeTx) {\n+        if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n             continue;\n         }\n \n-        if (nDepth < min_depth || nDepth > max_depth) {\n+        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n             continue;\n-        }\n \n-        bool tx_from_me = CachedTxIsFromMe(wallet, wtx, ISMINE_ALL);\n+        isminetype mine = wallet.IsMine(output);\n \n-        for (unsigned int i = 0; i < wtx.tx->vout.size(); i++) {\n-            const CTxOut& output = wtx.tx->vout[i];\n-            const COutPoint outpoint(wtxid, i);\n+        if (mine == ISMINE_NO) {\n+            continue;\n+        }\n \n-            if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n-                continue;\n+        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n+        if (nDepth < 0)\n+            continue;\n \n-            // Skip manually selected coins (the caller can fetch them directly)\n-            if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n-                continue;\n+        if (tx_safe_cache.count(outpoint.hash) == 0 ) {\n+            tx_safe_cache[outpoint.hash] = {false, false};\n \n-            if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n+            // We should not consider coins which aren't at least in our mempool\n+            // It's possible for these to be conflicted via ancestors which we may never be able to detect\n+            if (nDepth == 0 && !wtx.InMempool())\n                 continue;\n \n-            if (wallet.IsSpent(outpoint))\n-                continue;\n+            bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n+\n+            // We should not consider coins from transactions that are replacing\n+            // other transactions.\n+            //\n+            // Example: There is a transaction A which is replaced by bumpfee\n+            // transaction B. In this case, we want to prevent creation of\n+            // a transaction B' which spends an output of B.\n+            //\n+            // Reason: If transaction A were initially confirmed, transactions B\n+            // and B' would no longer be valid, so the user would have to create\n+            // a new transaction C to replace B'. However, in the case of a\n+            // one-block reorg, transactions B' and C might BOTH be accepted,\n+            // when the user only wanted one of them. Specifically, there could\n+            // be a 1-block reorg away from the chain where transactions A and C\n+            // were accepted to another chain where B, B', and C were all\n+            // accepted.\n+            if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n+                safeTx = false;\n+            }\n \n-            isminetype mine = wallet.IsMine(output);\n+            // Similarly, we should not consider coins from transactions that\n+            // have been replaced. In the example above, we would want to prevent\n+            // creation of a transaction A' spending an output of A, because if\n+            // transaction B were initially confirmed, conflicting with A and\n+            // A', we wouldn't want to the user to create a transaction D\n+            // intending to replace A', but potentially resulting in a scenario\n+            // where A, A', and D could all be accepted (instead of just B and\n+            // D, or just A and A' like the user would want).\n+            if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n+                safeTx = false;\n+            }\n \n-            if (mine == ISMINE_NO) {\n+            if (only_safe && !safeTx) {\n                 continue;\n             }\n \n-            if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n+            if (nDepth < min_depth || nDepth > max_depth) {\n                 continue;\n             }\n \n-            std::unique_ptr<SigningProvider> provider = wallet.GetSolvingProvider(output.scriptPubKey);\n-\n-            int input_bytes = CalculateMaximumSignedInputSize(output, COutPoint(), provider.get(), can_grind_r, coinControl);\n-            bool solvable = provider ? InferDescriptor(output.scriptPubKey, *provider)->IsSolvable() : false;\n-            bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n-\n-            // Filter by spendable outputs only\n-            if (!spendable && params.only_spendable) continue;\n-\n-            // Obtain script type\n-            std::vector<std::vector<uint8_t>> script_solutions;\n-            TxoutType type = Solver(output.scriptPubKey, script_solutions);\n-\n-            // If the output is P2SH and solvable, we want to know if it is\n-            // a P2SH (legacy) or one of P2SH-P2WPKH, P2SH-P2WSH (P2SH-Segwit). We can determine\n-            // this from the redeemScript. If the output is not solvable, it will be classified\n-            // as a P2SH (legacy), since we have no way of knowing otherwise without the redeemScript\n-            bool is_from_p2sh{false};\n-            if (type == TxoutType::SCRIPTHASH && solvable) {\n-                CScript script;\n-                if (!provider->GetCScript(CScriptID(uint160(script_solutions[0])), script)) continue;\n-                type = Solver(script, script_solutions);\n-                is_from_p2sh = true;\n-            }\n+            tx_safe_cache[outpoint.hash] = {true, safeTx};\n+        }\n+        const auto& [tx_ok, tx_safe] = tx_safe_cache.at(outpoint.hash);\n+        Assert(tx_ok);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 179,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "881650ed319c6ed74e66ae56c34cdee93125231b",
      "in_reply_to_id": 1262959018,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good point, changed to an `if`.",
      "created_at": "2023-09-15T18:39:15Z",
      "updated_at": "2023-09-15T18:39:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1327657382",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327657382"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 410,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359995170",
      "pull_request_review_id": 1657907650,
      "id": 1359995170,
      "node_id": "PRRC_kwDOABII585RD-Ei",
      "diff_hunk": "@@ -231,7 +231,8 @@ def run_test(self):\n         assert_equal(newbalance, balance + Decimal(\"20\"))\n         balance = newbalance\n \n-        # Invalidate the block with the double spend. B & C's 10 BTC outputs should no longer be available\n+        # Invalidate the block with the double spend and both B and C's 10 BTC output should no longer be available\n+        # AB1 and ABC2's outputs are also not available since neither of those txs are in the mempool",
      "path": "test/functional/wallet_abandonconflict.py",
      "position": null,
      "original_position": 6,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "fdf3ab0579be6d6f2be31907e3451a830e25291e",
      "in_reply_to_id": null,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In fdf3ab0579be6d6f2be31907e3451a830e25291e \"wallet: Change balance calculation to use m_txos \":\r\n\r\nnit: This no longer needs to be changed in this commit. ",
      "created_at": "2023-10-16T00:44:18Z",
      "updated_at": "2023-10-16T12:06:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1359995170",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359995170"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": 234,
      "start_side": "LEFT",
      "line": null,
      "original_line": 235,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359998074",
      "pull_request_review_id": 1657907650,
      "id": 1359998074,
      "node_id": "PRRC_kwDOABII585RD-x6",
      "diff_hunk": "@@ -504,6 +504,7 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     const std::unordered_map<COutPoint, WalletTXO, SaltedOutpointHasher>& GetTXOs() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet) { AssertLockHeld(cs_wallet); return m_txos; };\n \n     void RefreshWalletTxTXOs(const CWalletTx& wtx) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n+    void RefreshWalletTXOs() EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
      "path": "src/wallet/wallet.h",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "d7b3603822663fbc713970bf37dc010904aaa583",
      "in_reply_to_id": null,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In d7b3603822663fbc713970bf37dc010904aaa583 \"wallet: Recalculate the wallet's txos after any imports \":\r\n\r\n`RefreshWalletTXOs` looks similar to `RefreshWalletTxTXOs` and it is not immediately clear what the distinction is without actually reading the functions. I would suggest s/RefreshWalletTXOs/RefreshAllTXOs (putting \"Wallet\" seems redundant here because the method belongs to wallet anyways, and `GetTXOs` doesn't mention \"Wallet\" in the function name).",
      "created_at": "2023-10-16T00:54:34Z",
      "updated_at": "2023-10-16T12:06:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1359998074",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1359998074"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": 506,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 508,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1360011012",
      "pull_request_review_id": 1657907650,
      "id": 1360011012,
      "node_id": "PRRC_kwDOABII585REB8E",
      "diff_hunk": "@@ -217,133 +217,141 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     const bool can_grind_r = wallet.CanGrindR();\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& wtxid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;\n \n-        // Similarly, we should not consider coins from transactions that\n-        // have been replaced. In the example above, we would want to prevent\n-        // creation of a transaction A' spending an output of A, because if\n-        // transaction B were initially confirmed, conflicting with A and\n-        // A', we wouldn't want to the user to create a transaction D\n-        // intending to replace A', but potentially resulting in a scenario\n-        // where A, A', and D could all be accepted (instead of just B and\n-        // D, or just A and A' like the user would want).\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n-            safeTx = false;\n-        }\n+        if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n+            continue;\n \n-        if (only_safe && !safeTx) {\n+        if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n             continue;\n         }\n \n-        if (nDepth < min_depth || nDepth > max_depth) {\n+        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n             continue;\n-        }\n \n-        bool tx_from_me = CachedTxIsFromMe(wallet, wtx, ISMINE_ALL);\n+        isminetype mine = wallet.IsMine(output);\n \n-        for (unsigned int i = 0; i < wtx.tx->vout.size(); i++) {\n-            const CTxOut& output = wtx.tx->vout[i];\n-            const COutPoint outpoint(wtxid, i);\n+        if (mine == ISMINE_NO) {\n+            continue;\n+        }\n \n-            if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n-                continue;\n+        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n+        if (nDepth < 0)\n+            continue;\n \n-            // Skip manually selected coins (the caller can fetch them directly)\n-            if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n-                continue;\n+        if (tx_safe_cache.count(outpoint.hash) == 0 ) {\n+            tx_safe_cache[outpoint.hash] = {false, false};\n \n-            if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n+            // We should not consider coins which aren't at least in our mempool\n+            // It's possible for these to be conflicted via ancestors which we may never be able to detect\n+            if (nDepth == 0 && !wtx.InMempool())\n                 continue;\n \n-            if (wallet.IsSpent(outpoint))\n-                continue;\n+            bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n+\n+            // We should not consider coins from transactions that are replacing\n+            // other transactions.\n+            //\n+            // Example: There is a transaction A which is replaced by bumpfee\n+            // transaction B. In this case, we want to prevent creation of\n+            // a transaction B' which spends an output of B.\n+            //\n+            // Reason: If transaction A were initially confirmed, transactions B\n+            // and B' would no longer be valid, so the user would have to create\n+            // a new transaction C to replace B'. However, in the case of a\n+            // one-block reorg, transactions B' and C might BOTH be accepted,\n+            // when the user only wanted one of them. Specifically, there could\n+            // be a 1-block reorg away from the chain where transactions A and C\n+            // were accepted to another chain where B, B', and C were all\n+            // accepted.\n+            if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n+                safeTx = false;\n+            }\n \n-            isminetype mine = wallet.IsMine(output);\n+            // Similarly, we should not consider coins from transactions that\n+            // have been replaced. In the example above, we would want to prevent\n+            // creation of a transaction A' spending an output of A, because if\n+            // transaction B were initially confirmed, conflicting with A and\n+            // A', we wouldn't want to the user to create a transaction D\n+            // intending to replace A', but potentially resulting in a scenario\n+            // where A, A', and D could all be accepted (instead of just B and\n+            // D, or just A and A' like the user would want).\n+            if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n+                safeTx = false;\n+            }\n \n-            if (mine == ISMINE_NO) {\n+            if (only_safe && !safeTx) {\n                 continue;\n             }\n \n-            if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n+            if (nDepth < min_depth || nDepth > max_depth) {\n                 continue;\n             }\n \n-            std::unique_ptr<SigningProvider> provider = wallet.GetSolvingProvider(output.scriptPubKey);\n-\n-            int input_bytes = CalculateMaximumSignedInputSize(output, COutPoint(), provider.get(), can_grind_r, coinControl);\n-            bool solvable = provider ? InferDescriptor(output.scriptPubKey, *provider)->IsSolvable() : false;\n-            bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n-\n-            // Filter by spendable outputs only\n-            if (!spendable && params.only_spendable) continue;\n-\n-            // Obtain script type\n-            std::vector<std::vector<uint8_t>> script_solutions;\n-            TxoutType type = Solver(output.scriptPubKey, script_solutions);\n-\n-            // If the output is P2SH and solvable, we want to know if it is\n-            // a P2SH (legacy) or one of P2SH-P2WPKH, P2SH-P2WSH (P2SH-Segwit). We can determine\n-            // this from the redeemScript. If the output is not solvable, it will be classified\n-            // as a P2SH (legacy), since we have no way of knowing otherwise without the redeemScript\n-            bool is_from_p2sh{false};\n-            if (type == TxoutType::SCRIPTHASH && solvable) {\n-                CScript script;\n-                if (!provider->GetCScript(CScriptID(uint160(script_solutions[0])), script)) continue;\n-                type = Solver(script, script_solutions);\n-                is_from_p2sh = true;\n-            }\n+            tx_safe_cache[outpoint.hash] = {true, safeTx};\n+        }\n+        const auto& [tx_ok, tx_safe] = tx_safe_cache.at(outpoint.hash);\n+        Assert(tx_ok);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 179,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "881650ed319c6ed74e66ae56c34cdee93125231b",
      "in_reply_to_id": 1262959018,
      "user": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Looking at this again, I think I mislead you here. In the scenario I described above, `tx_ok` won't be false at this point, because if a `{false, false}` entry has already been created for a txid, then it would not reach this point because it would already get removed here (https://github.com/bitcoin/bitcoin/pull/27286/commits/9315bb7872210dc767dfd7ea01febb13fca5525b#diff-6e06b309cd494ef5da4e78aa0929a980767edd12342137f268b9219167064d13R328-R329)",
      "created_at": "2023-10-16T01:38:50Z",
      "updated_at": "2023-10-16T12:06:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1360011012",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1360011012"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 410,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361317075",
      "pull_request_review_id": 1681041652,
      "id": 1361317075,
      "node_id": "PRRC_kwDOABII585RJAzT",
      "diff_hunk": "@@ -231,7 +231,8 @@ def run_test(self):\n         assert_equal(newbalance, balance + Decimal(\"20\"))\n         balance = newbalance\n \n-        # Invalidate the block with the double spend. B & C's 10 BTC outputs should no longer be available\n+        # Invalidate the block with the double spend and both B and C's 10 BTC output should no longer be available\n+        # AB1 and ABC2's outputs are also not available since neither of those txs are in the mempool",
      "path": "test/functional/wallet_abandonconflict.py",
      "position": null,
      "original_position": 6,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "fdf3ab0579be6d6f2be31907e3451a830e25291e",
      "in_reply_to_id": 1359995170,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-10-16T22:14:49Z",
      "updated_at": "2023-10-16T22:14:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1361317075",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361317075"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": 234,
      "start_side": "LEFT",
      "line": null,
      "original_line": 235,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361317158",
      "pull_request_review_id": 1681041766,
      "id": 1361317158,
      "node_id": "PRRC_kwDOABII585RJA0m",
      "diff_hunk": "@@ -504,6 +504,7 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     const std::unordered_map<COutPoint, WalletTXO, SaltedOutpointHasher>& GetTXOs() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet) { AssertLockHeld(cs_wallet); return m_txos; };\n \n     void RefreshWalletTxTXOs(const CWalletTx& wtx) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n+    void RefreshWalletTXOs() EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
      "path": "src/wallet/wallet.h",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "d7b3603822663fbc713970bf37dc010904aaa583",
      "in_reply_to_id": 1359998074,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Renamed as suggested.",
      "created_at": "2023-10-16T22:14:56Z",
      "updated_at": "2023-10-16T22:14:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1361317158",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361317158"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": 506,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 508,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361317356",
      "pull_request_review_id": 1681042072,
      "id": 1361317356,
      "node_id": "PRRC_kwDOABII585RJA3s",
      "diff_hunk": "@@ -217,133 +217,141 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     const bool can_grind_r = wallet.CanGrindR();\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& wtxid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;\n \n-        // Similarly, we should not consider coins from transactions that\n-        // have been replaced. In the example above, we would want to prevent\n-        // creation of a transaction A' spending an output of A, because if\n-        // transaction B were initially confirmed, conflicting with A and\n-        // A', we wouldn't want to the user to create a transaction D\n-        // intending to replace A', but potentially resulting in a scenario\n-        // where A, A', and D could all be accepted (instead of just B and\n-        // D, or just A and A' like the user would want).\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n-            safeTx = false;\n-        }\n+        if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n+            continue;\n \n-        if (only_safe && !safeTx) {\n+        if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n             continue;\n         }\n \n-        if (nDepth < min_depth || nDepth > max_depth) {\n+        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n             continue;\n-        }\n \n-        bool tx_from_me = CachedTxIsFromMe(wallet, wtx, ISMINE_ALL);\n+        isminetype mine = wallet.IsMine(output);\n \n-        for (unsigned int i = 0; i < wtx.tx->vout.size(); i++) {\n-            const CTxOut& output = wtx.tx->vout[i];\n-            const COutPoint outpoint(wtxid, i);\n+        if (mine == ISMINE_NO) {\n+            continue;\n+        }\n \n-            if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n-                continue;\n+        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n+        if (nDepth < 0)\n+            continue;\n \n-            // Skip manually selected coins (the caller can fetch them directly)\n-            if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n-                continue;\n+        if (tx_safe_cache.count(outpoint.hash) == 0 ) {\n+            tx_safe_cache[outpoint.hash] = {false, false};\n \n-            if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n+            // We should not consider coins which aren't at least in our mempool\n+            // It's possible for these to be conflicted via ancestors which we may never be able to detect\n+            if (nDepth == 0 && !wtx.InMempool())\n                 continue;\n \n-            if (wallet.IsSpent(outpoint))\n-                continue;\n+            bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n+\n+            // We should not consider coins from transactions that are replacing\n+            // other transactions.\n+            //\n+            // Example: There is a transaction A which is replaced by bumpfee\n+            // transaction B. In this case, we want to prevent creation of\n+            // a transaction B' which spends an output of B.\n+            //\n+            // Reason: If transaction A were initially confirmed, transactions B\n+            // and B' would no longer be valid, so the user would have to create\n+            // a new transaction C to replace B'. However, in the case of a\n+            // one-block reorg, transactions B' and C might BOTH be accepted,\n+            // when the user only wanted one of them. Specifically, there could\n+            // be a 1-block reorg away from the chain where transactions A and C\n+            // were accepted to another chain where B, B', and C were all\n+            // accepted.\n+            if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n+                safeTx = false;\n+            }\n \n-            isminetype mine = wallet.IsMine(output);\n+            // Similarly, we should not consider coins from transactions that\n+            // have been replaced. In the example above, we would want to prevent\n+            // creation of a transaction A' spending an output of A, because if\n+            // transaction B were initially confirmed, conflicting with A and\n+            // A', we wouldn't want to the user to create a transaction D\n+            // intending to replace A', but potentially resulting in a scenario\n+            // where A, A', and D could all be accepted (instead of just B and\n+            // D, or just A and A' like the user would want).\n+            if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n+                safeTx = false;\n+            }\n \n-            if (mine == ISMINE_NO) {\n+            if (only_safe && !safeTx) {\n                 continue;\n             }\n \n-            if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n+            if (nDepth < min_depth || nDepth > max_depth) {\n                 continue;\n             }\n \n-            std::unique_ptr<SigningProvider> provider = wallet.GetSolvingProvider(output.scriptPubKey);\n-\n-            int input_bytes = CalculateMaximumSignedInputSize(output, COutPoint(), provider.get(), can_grind_r, coinControl);\n-            bool solvable = provider ? InferDescriptor(output.scriptPubKey, *provider)->IsSolvable() : false;\n-            bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n-\n-            // Filter by spendable outputs only\n-            if (!spendable && params.only_spendable) continue;\n-\n-            // Obtain script type\n-            std::vector<std::vector<uint8_t>> script_solutions;\n-            TxoutType type = Solver(output.scriptPubKey, script_solutions);\n-\n-            // If the output is P2SH and solvable, we want to know if it is\n-            // a P2SH (legacy) or one of P2SH-P2WPKH, P2SH-P2WSH (P2SH-Segwit). We can determine\n-            // this from the redeemScript. If the output is not solvable, it will be classified\n-            // as a P2SH (legacy), since we have no way of knowing otherwise without the redeemScript\n-            bool is_from_p2sh{false};\n-            if (type == TxoutType::SCRIPTHASH && solvable) {\n-                CScript script;\n-                if (!provider->GetCScript(CScriptID(uint160(script_solutions[0])), script)) continue;\n-                type = Solver(script, script_solutions);\n-                is_from_p2sh = true;\n-            }\n+            tx_safe_cache[outpoint.hash] = {true, safeTx};\n+        }\n+        const auto& [tx_ok, tx_safe] = tx_safe_cache.at(outpoint.hash);\n+        Assert(tx_ok);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 179,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "881650ed319c6ed74e66ae56c34cdee93125231b",
      "in_reply_to_id": 1262959018,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Indeed. I've left the `if` there anyways as a belt-and-suspenders, and changed it to also `Assume`.",
      "created_at": "2023-10-16T22:15:19Z",
      "updated_at": "2023-10-16T22:15:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1361317356",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361317356"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 410,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1369755368",
      "pull_request_review_id": 1694219823,
      "id": 1369755368,
      "node_id": "PRRC_kwDOABII585RpM7o",
      "diff_hunk": "@@ -47,10 +47,17 @@ void generateFakeBlock(const CChainParams& params,\n     coinbase_tx.vin[0].prevout.SetNull();\n     coinbase_tx.vout.resize(2);\n     coinbase_tx.vout[0].scriptPubKey = coinbase_out_script;\n-    coinbase_tx.vout[0].nValue = 49 * COIN;\n+    coinbase_tx.vout[0].nValue = 48 * COIN;\n     coinbase_tx.vin[0].scriptSig = CScript() << ++tip.tip_height << OP_0;\n     coinbase_tx.vout[1].scriptPubKey = coinbase_out_script; // extra output\n     coinbase_tx.vout[1].nValue = 1 * COIN;\n+\n+    // Fill the coinbase with outputs that don't belong to the wallet in order to benchmark\n+    // AvailableCoins' behavior with unnecessary TXOs\n+    for (int i = 0; i < 50; ++i) {\n+        coinbase_tx.vout.push_back(CTxOut(1 * COIN / 50, CScript(OP_TRUE)));",
      "path": "src/bench/wallet_create_tx.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "9292951f0c2a05a79280e4feb8c1557586681105",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```\r\nbench/wallet_create_tx.cpp:58:26: error: use emplace_back instead of push_back [modernize-use-emplace,-warnings-as-errors]\r\n   58 |         coinbase_tx.vout.push_back(CTxOut(1 * COIN / 50, CScript(OP_TRUE)));\r\n      |                          ^~~~~~~~~~~~~~~~~                               ~\r\n      |                          emplace_back(",
      "created_at": "2023-10-24T07:51:16Z",
      "updated_at": "2023-10-24T07:51:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1369755368",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1369755368"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370428946",
      "pull_request_review_id": 1695267006,
      "id": 1370428946,
      "node_id": "PRRC_kwDOABII585RrxYS",
      "diff_hunk": "@@ -47,10 +47,17 @@ void generateFakeBlock(const CChainParams& params,\n     coinbase_tx.vin[0].prevout.SetNull();\n     coinbase_tx.vout.resize(2);\n     coinbase_tx.vout[0].scriptPubKey = coinbase_out_script;\n-    coinbase_tx.vout[0].nValue = 49 * COIN;\n+    coinbase_tx.vout[0].nValue = 48 * COIN;\n     coinbase_tx.vin[0].scriptSig = CScript() << ++tip.tip_height << OP_0;\n     coinbase_tx.vout[1].scriptPubKey = coinbase_out_script; // extra output\n     coinbase_tx.vout[1].nValue = 1 * COIN;\n+\n+    // Fill the coinbase with outputs that don't belong to the wallet in order to benchmark\n+    // AvailableCoins' behavior with unnecessary TXOs\n+    for (int i = 0; i < 50; ++i) {\n+        coinbase_tx.vout.push_back(CTxOut(1 * COIN / 50, CScript(OP_TRUE)));",
      "path": "src/bench/wallet_create_tx.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "9292951f0c2a05a79280e4feb8c1557586681105",
      "in_reply_to_id": 1369755368,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-10-24T15:41:43Z",
      "updated_at": "2023-10-24T15:41:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1370428946",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370428946"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376775944",
      "pull_request_review_id": 1705025510,
      "id": 1376775944,
      "node_id": "PRRC_kwDOABII585SD-8I",
      "diff_hunk": "@@ -256,6 +256,10 @@ bool CachedTxIsFromMe(const CWallet& wallet, const CWalletTx& wtx, const isminef\n bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx, std::set<uint256>& trusted_parents)\n {\n     AssertLockHeld(wallet.cs_wallet);\n+\n+    // This wtx is already trusted\n+    if (trusted_parents.count(wtx.GetHash()) > 0) return true;",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b2790645e9d8a4db8919f14a04b83b6ac4d61015",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "How would that ever happen? Wouldnâ€™t we only have seen a trusted_parent before if we received two outputs from the same transaction?",
      "created_at": "2023-10-30T20:39:45Z",
      "updated_at": "2023-10-30T21:04:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1376775944",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376775944"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376784576",
      "pull_request_review_id": 1705025510,
      "id": 1376784576,
      "node_id": "PRRC_kwDOABII585SEBDA",
      "diff_hunk": "@@ -329,32 +343,19 @@ std::map<CTxDestination, CAmount> GetAddressBalances(const CWallet& wallet)\n \n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& walletEntry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = walletEntry.second;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            if (!CachedTxIsTrusted(wallet, txo.GetWalletTx())) continue;\n+            if (wallet.IsTxImmatureCoinBase(txo.GetWalletTx())) continue;\n \n-            if (!CachedTxIsTrusted(wallet, wtx, trusted_parents))\n-                continue;\n+            int nDepth = wallet.GetTxDepthInMainChain(txo.GetWalletTx());\n+            if (nDepth < (CachedTxIsFromMe(wallet, txo.GetWalletTx(), ISMINE_ALL) ? 0 : 1)) continue;\n \n-            if (wallet.IsTxImmatureCoinBase(wtx))\n-                continue;\n+            CTxDestination addr;\n+            Assume(wallet.IsMine(txo.GetTxOut()));\n+            if(!ExtractDestination(txo.GetTxOut().scriptPubKey, addr)) continue;",
      "path": "src/wallet/receive.cpp",
      "position": 164,
      "original_position": 88,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "73bff03d1f641d11f2cd4d2da099b39c64fcf69d",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Wouldnâ€™t this mean that we donâ€™t count P2PK outputs to our balance in combination with the changes to \"Destinations\" for Silent Payments?",
      "created_at": "2023-10-30T20:49:17Z",
      "updated_at": "2023-10-30T21:04:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1376784576",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376784576"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 309,
      "original_line": 309,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376793667",
      "pull_request_review_id": 1705025510,
      "id": 1376793667,
      "node_id": "PRRC_kwDOABII585SEDRD",
      "diff_hunk": "@@ -1555,16 +1555,10 @@ void CWallet::BlockUntilSyncedToCurrentChain() const {\n // and a not-\"is mine\" (according to the filter) input.\n CAmount CWallet::GetDebit(const CTxIn &txin, const isminefilter& filter) const",
      "path": "src/wallet/wallet.cpp",
      "position": 21,
      "original_position": 2,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "c91b1de21821f924e34980aef1f8da2ae6571774",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What does `GetDebit` do? The explanation in `wallet.h` is also self-referential:  \r\n\r\n```\r\n 769     /**\r\n 770      * Returns amount of debit if the input matches the\r\n 771      * filter, otherwise returns 0\r\n 772      */\r\n```\r\n\r\nDoes this just get the amount for an input that matches the filter criteria?",
      "created_at": "2023-10-30T20:58:46Z",
      "updated_at": "2023-10-30T21:04:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1376793667",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376793667"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1594,
      "original_line": 1594,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376825609",
      "pull_request_review_id": 1705110720,
      "id": 1376825609,
      "node_id": "PRRC_kwDOABII585SELEJ",
      "diff_hunk": "@@ -329,32 +343,19 @@ std::map<CTxDestination, CAmount> GetAddressBalances(const CWallet& wallet)\n \n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& walletEntry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = walletEntry.second;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            if (!CachedTxIsTrusted(wallet, txo.GetWalletTx())) continue;\n+            if (wallet.IsTxImmatureCoinBase(txo.GetWalletTx())) continue;\n \n-            if (!CachedTxIsTrusted(wallet, wtx, trusted_parents))\n-                continue;\n+            int nDepth = wallet.GetTxDepthInMainChain(txo.GetWalletTx());\n+            if (nDepth < (CachedTxIsFromMe(wallet, txo.GetWalletTx(), ISMINE_ALL) ? 0 : 1)) continue;\n \n-            if (wallet.IsTxImmatureCoinBase(wtx))\n-                continue;\n+            CTxDestination addr;\n+            Assume(wallet.IsMine(txo.GetTxOut()));\n+            if(!ExtractDestination(txo.GetTxOut().scriptPubKey, addr)) continue;",
      "path": "src/wallet/receive.cpp",
      "position": 164,
      "original_position": 88,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "73bff03d1f641d11f2cd4d2da099b39c64fcf69d",
      "in_reply_to_id": 1376784576,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, P2PK is not an address type.",
      "created_at": "2023-10-30T21:33:01Z",
      "updated_at": "2023-10-30T21:33:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1376825609",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376825609"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 309,
      "original_line": 309,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376828067",
      "pull_request_review_id": 1705114428,
      "id": 1376828067,
      "node_id": "PRRC_kwDOABII585SELqj",
      "diff_hunk": "@@ -1555,16 +1555,10 @@ void CWallet::BlockUntilSyncedToCurrentChain() const {\n // and a not-\"is mine\" (according to the filter) input.\n CAmount CWallet::GetDebit(const CTxIn &txin, const isminefilter& filter) const",
      "path": "src/wallet/wallet.cpp",
      "position": 21,
      "original_position": 2,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "c91b1de21821f924e34980aef1f8da2ae6571774",
      "in_reply_to_id": 1376793667,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "\"Debit\" refers to the amount leaving the wallet, assuming the UTXO spent by the input matches the filter. \"Debit\" operates on a transaction's inputs, while \"credit\" operates on the outputs.",
      "created_at": "2023-10-30T21:36:03Z",
      "updated_at": "2023-10-30T21:36:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1376828067",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376828067"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1594,
      "original_line": 1594,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376896229",
      "pull_request_review_id": 1705219601,
      "id": 1376896229,
      "node_id": "PRRC_kwDOABII585SEcTl",
      "diff_hunk": "@@ -256,6 +256,10 @@ bool CachedTxIsFromMe(const CWallet& wallet, const CWalletTx& wtx, const isminef\n bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx, std::set<uint256>& trusted_parents)\n {\n     AssertLockHeld(wallet.cs_wallet);\n+\n+    // This wtx is already trusted\n+    if (trusted_parents.count(wtx.GetHash()) > 0) return true;",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b2790645e9d8a4db8919f14a04b83b6ac4d61015",
      "in_reply_to_id": 1376775944,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, and that does happen, e.g. send to self transactions. The tests also do this a lot.",
      "created_at": "2023-10-30T23:21:26Z",
      "updated_at": "2023-10-30T23:21:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1376896229",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376896229"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437849004",
      "pull_request_review_id": 1798367193,
      "id": 1437849004,
      "node_id": "PRRC_kwDOABII585Vs9Ws",
      "diff_hunk": "@@ -320,137 +320,145 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     std::vector<COutPoint> outpoints;\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& txid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;",
      "path": "src/wallet/spend.cpp",
      "position": 67,
      "original_position": 52,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "91e4f19f66c5e2078aa8372d93aa7d5e027c40e5",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I have the impression that `m_txos` is also used to look up information on old transactions and we therefore want to keep all transaction outputs the wallet ever had.\r\n\r\nWould it perhaps make sense to also have a reduced set that only keeps the potentially _unspent_ TXOs? I could see a wallet that participates in a few dozen transactions every day have magnitudes more TXOs than UTXOs. So perhaps the work the wallet has to perform every time it builds a transaction could be shortcut by storing e.g. `m_is_mature_spent` on `WalletTXO` which could be set to true when the transaction spending an output has 100 confirmations, and then either separately keeping a list of all TXOs that are not `m_is_mature_spent` or at least iterate over them more quickly directly on the basis of that member, without needing to have complex reorg handling to keep this collection up to date.",
      "created_at": "2023-12-28T19:32:35Z",
      "updated_at": "2023-12-28T19:38:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1437849004",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437849004"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": 340,
      "original_start_line": 340,
      "start_side": "RIGHT",
      "line": 341,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437851827",
      "pull_request_review_id": 1798371244,
      "id": 1437851827,
      "node_id": "PRRC_kwDOABII585Vs-Cz",
      "diff_hunk": "@@ -320,137 +320,145 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     std::vector<COutPoint> outpoints;\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& txid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;",
      "path": "src/wallet/spend.cpp",
      "position": 67,
      "original_position": 52,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "91e4f19f66c5e2078aa8372d93aa7d5e027c40e5",
      "in_reply_to_id": 1437849004,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah, nevermind, I just saw https://github.com/bitcoin/bitcoin/pull/27865",
      "created_at": "2023-12-28T19:39:45Z",
      "updated_at": "2023-12-28T19:39:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1437851827",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437851827"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": 340,
      "original_start_line": 340,
      "start_side": "RIGHT",
      "line": 341,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440077502",
      "pull_request_review_id": 1801381790,
      "id": 1440077502,
      "node_id": "PRRC_kwDOABII585V1da-",
      "diff_hunk": "@@ -293,27 +252,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {\n+                // Get the amounts for mine and watchonly\n+                CAmount credit_mine = 0;\n+                CAmount credit_watchonly = 0;\n+                if (txo.GetIsMine() == ISMINE_SPENDABLE) {\n+                    credit_mine = txo.GetTxOut().nValue;\n+                } else if (txo.GetIsMine() == ISMINE_WATCH_ONLY) {\n+                    credit_watchonly = txo.GetTxOut().nValue;\n+                } else {\n+                    // We shouldn't see any other isminetypes\n+                    Assume(false);\n+                }\n+\n+                // Set the amounts in the return object\n+                if (wallet.IsTxImmatureCoinBase(txo.GetWalletTx()) && wallet.IsTxInMainChain(txo.GetWalletTx())) {\n+                    ret.m_mine_immature += credit_mine;\n+                    ret.m_watchonly_immature += credit_watchonly;\n+                } else if (is_trusted && tx_depth >= min_depth) {\n+                    ret.m_mine_trusted += credit_mine;\n+                    ret.m_watchonly_trusted += credit_watchonly;\n+                } if (!is_trusted && txo.GetWalletTx().InMempool()) {",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 117,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "0c0022311a0cffc4c03b3763c9b60f93ede13687",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Seems like a hazard\r\n```suggestion\r\n                } else if (!is_trusted && txo.GetWalletTx().InMempool()) {\r\n```",
      "created_at": "2024-01-03T05:02:43Z",
      "updated_at": "2024-01-03T05:26:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1440077502",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440077502"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440086373",
      "pull_request_review_id": 1801381790,
      "id": 1440086373,
      "node_id": "PRRC_kwDOABII585V1fll",
      "diff_hunk": "@@ -320,137 +316,145 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     std::vector<COutPoint> outpoints;\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& txid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;\n \n-        // Similarly, we should not consider coins from transactions that\n-        // have been replaced. In the example above, we would want to prevent\n-        // creation of a transaction A' spending an output of A, because if\n-        // transaction B were initially confirmed, conflicting with A and\n-        // A', we wouldn't want to the user to create a transaction D\n-        // intending to replace A', but potentially resulting in a scenario\n-        // where A, A', and D could all be accepted (instead of just B and\n-        // D, or just A and A' like the user would want).\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n-            safeTx = false;\n-        }\n+        if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n+            continue;\n \n-        if (only_safe && !safeTx) {\n+        if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n             continue;\n         }\n \n-        if (nDepth < min_depth || nDepth > max_depth) {\n+        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n             continue;\n-        }\n \n-        bool tx_from_me = CachedTxIsFromMe(wallet, wtx, ISMINE_ALL);\n+        isminetype mine = wallet.IsMine(output);\n \n-        for (unsigned int i = 0; i < wtx.tx->vout.size(); i++) {\n-            const CTxOut& output = wtx.tx->vout[i];\n-            const COutPoint outpoint(Txid::FromUint256(txid), i);\n+        assert(mine != ISMINE_NO);\n \n-            if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n-                continue;\n+        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n+        if (nDepth < 0)\n+            continue;\n \n-            // Skip manually selected coins (the caller can fetch them directly)\n-            if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n-                continue;\n+        if (tx_safe_cache.count(outpoint.hash) == 0 ) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 110,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "0c0022311a0cffc4c03b3763c9b60f93ede13687",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: Could use `contains` (and other places too)\r\n```suggestion\r\n        if (!tx_safe_cache.contains(outpoint.hash)) {\r\n```",
      "created_at": "2024-01-03T05:25:23Z",
      "updated_at": "2024-01-03T05:26:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1440086373",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440086373"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1442251493",
      "pull_request_review_id": 1804970818,
      "id": 1442251493,
      "node_id": "PRRC_kwDOABII585V9wLl",
      "diff_hunk": "@@ -293,27 +252,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {\n+                // Get the amounts for mine and watchonly\n+                CAmount credit_mine = 0;\n+                CAmount credit_watchonly = 0;\n+                if (txo.GetIsMine() == ISMINE_SPENDABLE) {\n+                    credit_mine = txo.GetTxOut().nValue;\n+                } else if (txo.GetIsMine() == ISMINE_WATCH_ONLY) {\n+                    credit_watchonly = txo.GetTxOut().nValue;\n+                } else {\n+                    // We shouldn't see any other isminetypes\n+                    Assume(false);\n+                }\n+\n+                // Set the amounts in the return object\n+                if (wallet.IsTxImmatureCoinBase(txo.GetWalletTx()) && wallet.IsTxInMainChain(txo.GetWalletTx())) {\n+                    ret.m_mine_immature += credit_mine;\n+                    ret.m_watchonly_immature += credit_watchonly;\n+                } else if (is_trusted && tx_depth >= min_depth) {\n+                    ret.m_mine_trusted += credit_mine;\n+                    ret.m_watchonly_trusted += credit_watchonly;\n+                } if (!is_trusted && txo.GetWalletTx().InMempool()) {",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 117,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "0c0022311a0cffc4c03b3763c9b60f93ede13687",
      "in_reply_to_id": 1440077502,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good catch, fixed.",
      "created_at": "2024-01-04T21:05:07Z",
      "updated_at": "2024-01-04T21:05:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1442251493",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1442251493"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1442251567",
      "pull_request_review_id": 1804970933,
      "id": 1442251567,
      "node_id": "PRRC_kwDOABII585V9wMv",
      "diff_hunk": "@@ -320,137 +316,145 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     std::vector<COutPoint> outpoints;\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& txid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)\n+    std::unordered_map<uint256, std::pair<bool, bool>, SaltedTxidHasher> tx_safe_cache;\n+    for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+        const CWalletTx& wtx = txo.GetWalletTx();\n+        const CTxOut& output = txo.GetTxOut();\n \n-        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n+        if (tx_safe_cache.count(outpoint.hash) > 0 && !tx_safe_cache.at(outpoint.hash).first) {\n             continue;\n+        }\n \n-        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n-        if (nDepth < 0)\n+        // Skip manually selected coins (the caller can fetch them directly)\n+        if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n             continue;\n \n-        // We should not consider coins which aren't at least in our mempool\n-        // It's possible for these to be conflicted via ancestors which we may never be able to detect\n-        if (nDepth == 0 && !wtx.InMempool())\n+        if (wallet.IsLockedCoin(outpoint) && params.skip_locked)\n             continue;\n \n-        bool safeTx = CachedTxIsTrusted(wallet, wtx, trusted_parents);\n-\n-        // We should not consider coins from transactions that are replacing\n-        // other transactions.\n-        //\n-        // Example: There is a transaction A which is replaced by bumpfee\n-        // transaction B. In this case, we want to prevent creation of\n-        // a transaction B' which spends an output of B.\n-        //\n-        // Reason: If transaction A were initially confirmed, transactions B\n-        // and B' would no longer be valid, so the user would have to create\n-        // a new transaction C to replace B'. However, in the case of a\n-        // one-block reorg, transactions B' and C might BOTH be accepted,\n-        // when the user only wanted one of them. Specifically, there could\n-        // be a 1-block reorg away from the chain where transactions A and C\n-        // were accepted to another chain where B, B', and C were all\n-        // accepted.\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaces_txid\")) {\n-            safeTx = false;\n-        }\n+        if (wallet.IsSpent(outpoint))\n+            continue;\n \n-        // Similarly, we should not consider coins from transactions that\n-        // have been replaced. In the example above, we would want to prevent\n-        // creation of a transaction A' spending an output of A, because if\n-        // transaction B were initially confirmed, conflicting with A and\n-        // A', we wouldn't want to the user to create a transaction D\n-        // intending to replace A', but potentially resulting in a scenario\n-        // where A, A', and D could all be accepted (instead of just B and\n-        // D, or just A and A' like the user would want).\n-        if (nDepth == 0 && wtx.mapValue.count(\"replaced_by_txid\")) {\n-            safeTx = false;\n-        }\n+        if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n+            continue;\n \n-        if (only_safe && !safeTx) {\n+        if (!allow_used_addresses && wallet.IsSpentKey(output.scriptPubKey)) {\n             continue;\n         }\n \n-        if (nDepth < min_depth || nDepth > max_depth) {\n+        if (wallet.IsTxImmatureCoinBase(wtx) && !params.include_immature_coinbase)\n             continue;\n-        }\n \n-        bool tx_from_me = CachedTxIsFromMe(wallet, wtx, ISMINE_ALL);\n+        isminetype mine = wallet.IsMine(output);\n \n-        for (unsigned int i = 0; i < wtx.tx->vout.size(); i++) {\n-            const CTxOut& output = wtx.tx->vout[i];\n-            const COutPoint outpoint(Txid::FromUint256(txid), i);\n+        assert(mine != ISMINE_NO);\n \n-            if (output.nValue < params.min_amount || output.nValue > params.max_amount)\n-                continue;\n+        int nDepth = wallet.GetTxDepthInMainChain(wtx);\n+        if (nDepth < 0)\n+            continue;\n \n-            // Skip manually selected coins (the caller can fetch them directly)\n-            if (coinControl && coinControl->HasSelected() && coinControl->IsSelected(outpoint))\n-                continue;\n+        if (tx_safe_cache.count(outpoint.hash) == 0 ) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 110,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "0c0022311a0cffc4c03b3763c9b60f93ede13687",
      "in_reply_to_id": 1440086373,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2024-01-04T21:05:13Z",
      "updated_at": "2024-01-04T21:05:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1442251567",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1442251567"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520283962",
      "pull_request_review_id": 1928856157,
      "id": 1520283962,
      "node_id": "PRRC_kwDOABII585anbE6",
      "diff_hunk": "@@ -1143,6 +1143,9 @@ CWalletTx* CWallet::AddToWallet(CTransactionRef tx, const TxState& state, const\n     // Break debit/credit balance caches:\n     wtx.MarkDirty();\n \n+    // Get the outputs that belong to the wallet",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e (wallet: Keep track of transaction outputs owned by the wallet):\r\n\r\n```suggestion\r\n    // Cache the outputs that belong to the wallet on the walletâ€™s transactions\r\n```",
      "created_at": "2024-03-11T19:00:03Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520283962",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520283962"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1146,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520287400",
      "pull_request_review_id": 1928856157,
      "id": 1520287400,
      "node_id": "PRRC_kwDOABII585anb6o",
      "diff_hunk": "@@ -4467,4 +4475,22 @@ void CWallet::TopUpCallback(const std::set<CScript>& spks, ScriptPubKeyMan* spkm\n     // Update scriptPubKey cache\n     CacheNewScriptPubKeys(spks, spkm);\n }\n+\n+void CWallet::RefreshWalletTxTXOs(const CWalletTx& wtx)\n+{\n+    AssertLockHeld(cs_wallet);\n+    for (uint32_t i = 0; i < wtx.tx->vout.size(); ++i) {\n+        const CTxOut& txout = wtx.tx->vout.at(i);\n+        isminetype ismine = IsMine(txout);\n+        if (ismine == ISMINE_NO) {\n+            continue;\n+        }\n+        COutPoint outpoint(wtx.GetHash(), i);\n+        if (m_txos.count(outpoint) > 0) {",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e (wallet: Keep track of transaction outputs owned by the wallet):\r\n\r\n\r\n```suggestion\r\n        if (m_txos.contains(outpoint)) {\r\n```",
      "created_at": "2024-03-11T19:03:15Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520287400",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520287400"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4489,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520290111",
      "pull_request_review_id": 1928856157,
      "id": 1520290111,
      "node_id": "PRRC_kwDOABII585anck_",
      "diff_hunk": "@@ -425,6 +425,9 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     //! Cache of descriptor ScriptPubKeys used for IsMine. Maps ScriptPubKey to set of spkms\n     std::unordered_map<CScript, std::vector<ScriptPubKeyMan*>, SaltedSipHasher> m_cached_spks;\n \n+    //! Set of transaction outputs owned by this wallet",
      "path": "src/wallet/wallet.h",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e (wallet: Keep track of transaction outputs owned by the wallet):\r\n```suggestion\r\n    //! Set of spent and unspent transaction outputs owned by this wallet\r\n```",
      "created_at": "2024-03-11T19:05:59Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520290111",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520290111"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520295185",
      "pull_request_review_id": 1928856157,
      "id": 1520295185,
      "node_id": "PRRC_kwDOABII585and0R",
      "diff_hunk": "@@ -256,6 +256,10 @@ bool CachedTxIsFromMe(const CWallet& wallet, const CWalletTx& wtx, const isminef\n bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx, std::set<uint256>& trusted_parents)\n {\n     AssertLockHeld(wallet.cs_wallet);\n+\n+    // This wtx is already trusted\n+    if (trusted_parents.count(wtx.GetHash()) > 0) return true;",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "0283525d64a28c79f4588ef0a71bd280b2fc7768",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 0283525d64a28c79f4588ef0a71bd280b2fc7768 (wallet: Exit IsTrustedTx early if wtx is already in trusted_parents):\r\n\r\n```suggestion\r\n    if (trusted_parents.contains(wtx.GetHash())) return true;\r\n```",
      "created_at": "2024-03-11T19:09:35Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520295185",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520295185"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 261,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520330141",
      "pull_request_review_id": 1928856157,
      "id": 1520330141,
      "node_id": "PRRC_kwDOABII585anmWd",
      "diff_hunk": "@@ -297,27 +298,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);",
      "path": "src/wallet/receive.cpp",
      "position": 77,
      "original_position": 13,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b217f576a5f284ac7261986ee6ec9334bbbdbbc6",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In b217f576a5f284ac7261986ee6ec9334bbbdbbc6 (wallet: Change balance calculation to use m_txos):\r\n\r\nI dug into this line, because I was wondering whether this line changed the behavior, but found that in `src/wallet/receive.cpp` in `CachedTxGetAvailableCredit(â€¦)` the `reuse_filter` was used to derive the same resulting `allow_used_addresses` on basis of the filter and `WALLET_FLAG_AVOID_REUSE`. So, Iâ€™m thinking now that this change is not a change in behavior. It would perhaps help future reviewers if the commit message mentioned why this change is valid and doesnâ€™t change the behavior.",
      "created_at": "2024-03-11T19:37:04Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520330141",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520330141"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 255,
      "original_line": 255,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520345314",
      "pull_request_review_id": 1928856157,
      "id": 1520345314,
      "node_id": "PRRC_kwDOABII585anqDi",
      "diff_hunk": "@@ -4467,4 +4475,22 @@ void CWallet::TopUpCallback(const std::set<CScript>& spks, ScriptPubKeyMan* spkm\n     // Update scriptPubKey cache\n     CacheNewScriptPubKeys(spks, spkm);\n }\n+\n+void CWallet::RefreshWalletTxTXOs(const CWalletTx& wtx)\n+{\n+    AssertLockHeld(cs_wallet);\n+    for (uint32_t i = 0; i < wtx.tx->vout.size(); ++i) {\n+        const CTxOut& txout = wtx.tx->vout.at(i);\n+        isminetype ismine = IsMine(txout);\n+        if (ismine == ISMINE_NO) {\n+            continue;\n+        }\n+        COutPoint outpoint(wtx.GetHash(), i);\n+        if (m_txos.count(outpoint) > 0) {\n+            m_txos.at(outpoint).SetIsMine(ismine);\n+        } else {\n+            m_txos.emplace(outpoint, WalletTXO{wtx, txout, ismine});\n+        }",
      "path": "src/wallet/wallet.cpp",
      "position": 80,
      "original_position": 48,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e (wallet: Keep track of transaction outputs owned by the wallet):\r\n\r\nA few commits later, you use `wallet.IsSpent(outpoint)` to check whether a TXO is still available for spending. Why canâ€™t we just do store the outcome of `wallet.IsSpent(outpoint)` here as well?",
      "created_at": "2024-03-11T19:47:30Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520345314",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520345314"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4639,
      "original_line": 4639,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520349129",
      "pull_request_review_id": 1928856157,
      "id": 1520349129,
      "node_id": "PRRC_kwDOABII585anq_J",
      "diff_hunk": "@@ -297,27 +298,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {",
      "path": "src/wallet/receive.cpp",
      "position": 97,
      "original_position": 37,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b217f576a5f284ac7261986ee6ec9334bbbdbbc6",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In b217f576a5f284ac7261986ee6ec9334bbbdbbc6 (wallet: Change balance calculation to use m_txos):\r\n\r\nInstead of `wallet.IsSpentKey(â€¦)` couldnâ€™t you just check here if `txo.GetIsMine()` has the `ISMINE_USED` bit set?",
      "created_at": "2024-03-11T19:51:00Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520349129",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520349129"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 264,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520352559",
      "pull_request_review_id": 1928856157,
      "id": 1520352559,
      "node_id": "PRRC_kwDOABII585anr0v",
      "diff_hunk": "@@ -297,27 +298,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {\n+                // Get the amounts for mine and watchonly\n+                CAmount credit_mine = 0;\n+                CAmount credit_watchonly = 0;\n+                if (txo.GetIsMine() == ISMINE_SPENDABLE) {\n+                    credit_mine = txo.GetTxOut().nValue;\n+                } else if (txo.GetIsMine() == ISMINE_WATCH_ONLY) {\n+                    credit_watchonly = txo.GetTxOut().nValue;\n+                } else {\n+                    // We shouldn't see any other isminetypes\n+                    Assume(false);",
      "path": "src/wallet/receive.cpp",
      "position": 107,
      "original_position": 47,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b217f576a5f284ac7261986ee6ec9334bbbdbbc6",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In b217f576a5f284ac7261986ee6ec9334bbbdbbc6 (wallet: Change balance calculation to use m_txos):\r\n\r\nI was wondering if we could see `ISMINE_SPENDABLEâ€¯|â€¯ISMINE_USED` or `ISMINE_WATCH_ONLYâ€¯|â€¯ISMINE_USED` here.",
      "created_at": "2024-03-11T19:54:12Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520352559",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520352559"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": 273,
      "original_start_line": 319,
      "start_side": "RIGHT",
      "line": 274,
      "original_line": 274,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520373556",
      "pull_request_review_id": 1928856157,
      "id": 1520373556,
      "node_id": "PRRC_kwDOABII585anw80",
      "diff_hunk": "@@ -297,27 +298,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {\n+                // Get the amounts for mine and watchonly\n+                CAmount credit_mine = 0;\n+                CAmount credit_watchonly = 0;\n+                if (txo.GetIsMine() == ISMINE_SPENDABLE) {\n+                    credit_mine = txo.GetTxOut().nValue;\n+                } else if (txo.GetIsMine() == ISMINE_WATCH_ONLY) {\n+                    credit_watchonly = txo.GetTxOut().nValue;\n+                } else {\n+                    // We shouldn't see any other isminetypes\n+                    Assume(false);\n+                }\n+\n+                // Set the amounts in the return object",
      "path": "src/wallet/receive.cpp",
      "position": 110,
      "original_position": 50,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b217f576a5f284ac7261986ee6ec9334bbbdbbc6",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In b217f576a5f284ac7261986ee6ec9334bbbdbbc6 (wallet: Change balance calculation to use m_txos):\r\n\r\nIt seems to me that the below should be matching replacements here, but previously every TXO in this loop got added to `â€¦_untrusted_pending`, and now only TXOs of unconfirmed untrusted transactions, and immature coinbase transactions get added to `â€¦_untrusted_pending`. Doesnâ€™t this commit change the balances we would be returning?\r\n\r\n```diff\r\n- if (is_trusted && tx_depth >= min_depth) {\r\n-     ret.m_mine_trusted += tx_credit_mine;\r\n-     ret.m_watchonly_trusted += tx_credit_watchonly;\r\n- if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\r\n-     ret.m_mine_untrusted_pending += tx_credit_mine;\r\n-     ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\r\n- }\r\n- ret.m_mine_immature += CachedTxGetImmatureCredit(wallet, wtx, ISMINE_SPENDABLE);\r\n- ret.m_watchonly_immature += CachedTxGetImmatureCredit(wallet, wtx, ISMINE_WATCH_ONLY);\r\n+ // Set the amounts in the return object\r\n+ if (wallet.IsTxImmatureCoinBase(txo.GetWalletTx()) && wallet.IsTxInMainChain(txo.GetWalletTx())) {\r\n+     ret.m_mine_immature += credit_mine;\r\n+     ret.m_watchonly_immature += credit_watchonly;\r\n+ } else if (is_trusted && tx_depth >= min_depth) {\r\n+     ret.m_mine_trusted += credit_mine;\r\n+     ret.m_watchonly_trusted += credit_watchonly;\r\n+ } else if (!is_trusted && txo.GetWalletTx().InMempool()) {\r\n+     ret.m_mine_untrusted_pending += credit_mine;\r\n+     ret.m_watchonly_untrusted_pending += credit_watchonly;\r\n+ }\r\n```",
      "created_at": "2024-03-11T20:13:02Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520373556",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520373556"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 277,
      "original_line": 277,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520381857",
      "pull_request_review_id": 1928856157,
      "id": 1520381857,
      "node_id": "PRRC_kwDOABII585any-h",
      "diff_hunk": "@@ -340,5 +375,30 @@ def test_balances(*, fee_node_1=0):\n         assert_equal(tx_info['lastprocessedblock']['height'], prev_height)\n         assert_equal(tx_info['lastprocessedblock']['hash'], prev_hash)\n \n+        self.log.info(\"Test that the balance is updated by an import that makes an untracked output in an existing tx \\\"mine\\\"\")\n+        default = self.nodes[0].get_wallet_rpc(self.default_wallet_name)\n+        self.nodes[0].createwallet(\"importupdate\")\n+        wallet = self.nodes[0].get_wallet_rpc(\"importupdate\")\n+\n+        import_key1 = get_generate_key()\n+        import_key2 = get_generate_key()\n+        wallet.importprivkey(import_key1.privkey)\n+\n+        amount = 15\n+        default.send([{import_key1.p2wpkh_addr: amount},{import_key2.p2wpkh_addr: amount}])\n+        self.generate(self.nodes[0], 1)\n+        # Mock the time forward by 1 day so that \"now\" will exclude the block we just mined\n+        self.nodes[0].setmocktime(int(time.time()) + 86400)\n+        # Mine 11 blocks to move the MTP past the block we just mined\n+        self.generate(self.nodes[0], 11, sync_fun=self.no_op)\n+\n+        balances = wallet.getbalances()\n+        assert_equal(balances[\"mine\"][\"trusted\"], amount)\n+\n+        # Don't rescan to make sure that the import updates the wallet txos\n+        wallet.importprivkey(privkey=import_key2.privkey, rescan=False)\n+        balances = wallet.getbalances()\n+        assert_equal(balances[\"mine\"][\"trusted\"], amount * 2)",
      "path": "test/functional/wallet_balance.py",
      "position": 85,
      "original_position": 85,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "900f95cd56951f5e0f0d0f3a93c09d1fb0bc5787",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 900f95cd56951f5e0f0d0f3a93c09d1fb0bc5787 (test: Test for balance update due to watchonly becoming spendable):\r\n\r\nDo I understand right that discovering this TXO without a rescan only works because the transaction was already in our `mapWallet`?",
      "created_at": "2024-03-11T20:20:03Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520381857",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520381857"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": 396,
      "original_start_line": 398,
      "start_side": "RIGHT",
      "line": 399,
      "original_line": 399,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520393226",
      "pull_request_review_id": 1928856157,
      "id": 1520393226,
      "node_id": "PRRC_kwDOABII585an1wK",
      "diff_hunk": "@@ -320,137 +320,145 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     std::vector<COutPoint> outpoints;\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& txid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "c88832eca5df0a391a4a68c73b6fc123f9af2f4b",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In c88832eca5df0a391a4a68c73b6fc123f9af2f4b (wallet: Use wallet's TXO set in AvailableCoins):\r\n\r\nWhat are the \"tx checks\" that are being passed? It seems to me me that it refers to TXs either having been sent by ourselves that are not involved in an RBF process or TXs with sufficient confirmations that we rely on them. Either way, it would be nice if this comment were a bit more elaborate than just mentioning \"tx checks\". Also, the relationship to `safe_tx` could be made a bit clearer in this code block.\r\n\r\nPerhaps something along the lines of:\r\n\r\n```suggestion\r\n    // Cache for each transaction whether we consider its outputs acceptable for spending (first bool), and whether the transaction is considered \"safe\" (second bool).\r\n    // A transactionâ€™s outputs are considered acceptable for spending when <elaborate>\r\n    // A transaction is considered safe when <elaborate>\r\n```\r\n\r\nAlternatively or additionally if the `CachedTxIsTrusted(â€¦)` functions had a bit more documentation in either `src/wallet/receive.h` or  `src/wallet/receive.cpp`.\r\n",
      "created_at": "2024-03-11T20:29:01Z",
      "updated_at": "2024-03-11T21:05:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1520393226",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520393226"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 323,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521569610",
      "pull_request_review_id": 1931234103,
      "id": 1521569610,
      "node_id": "PRRC_kwDOABII585asU9K",
      "diff_hunk": "@@ -4467,4 +4475,22 @@ void CWallet::TopUpCallback(const std::set<CScript>& spks, ScriptPubKeyMan* spkm\n     // Update scriptPubKey cache\n     CacheNewScriptPubKeys(spks, spkm);\n }\n+\n+void CWallet::RefreshWalletTxTXOs(const CWalletTx& wtx)\n+{\n+    AssertLockHeld(cs_wallet);\n+    for (uint32_t i = 0; i < wtx.tx->vout.size(); ++i) {\n+        const CTxOut& txout = wtx.tx->vout.at(i);\n+        isminetype ismine = IsMine(txout);\n+        if (ismine == ISMINE_NO) {\n+            continue;\n+        }\n+        COutPoint outpoint(wtx.GetHash(), i);\n+        if (m_txos.count(outpoint) > 0) {\n+            m_txos.at(outpoint).SetIsMine(ismine);\n+        } else {\n+            m_txos.emplace(outpoint, WalletTXO{wtx, txout, ismine});\n+        }",
      "path": "src/wallet/wallet.cpp",
      "position": 80,
      "original_position": 48,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": 1520345314,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Outputs don't always stay spent. Replacements, reorgs, and eviction could all make a transaction no longer be \"IsSpent\", so checking that here would require a lot of other structural changes to ensure that it is correct.\r\n\r\nStoring the value of `IsSpent` could be an alternative to #27865, however I would still leave that for a followup. Any change that tries to actually have a proper UTXO set for the wallet can have unexpected side effects and/or things we didn't notice so I want to keep that separate for now. This PR is to setup for that by making the wallet operate on a TXO set.",
      "created_at": "2024-03-12T14:27:05Z",
      "updated_at": "2024-03-12T14:27:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521569610",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521569610"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4639,
      "original_line": 4639,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521586912",
      "pull_request_review_id": 1931262672,
      "id": 1521586912,
      "node_id": "PRRC_kwDOABII585asZLg",
      "diff_hunk": "@@ -297,27 +298,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {",
      "path": "src/wallet/receive.cpp",
      "position": 97,
      "original_position": 37,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b217f576a5f284ac7261986ee6ec9334bbbdbbc6",
      "in_reply_to_id": 1520349129,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`ISMINE_USED` is not actually an isminetype that is returned by `IsMine`, so it will not be set in the `txo.GetIsMine()`'s result. It's really just a hack for it to be an isminetype so it can be passed as part of various ismine filters, but these always check that separately from the actual `IsMine` result.",
      "created_at": "2024-03-12T14:37:19Z",
      "updated_at": "2024-03-12T14:37:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521586912",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521586912"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 264,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521587788",
      "pull_request_review_id": 1931264076,
      "id": 1521587788,
      "node_id": "PRRC_kwDOABII585asZZM",
      "diff_hunk": "@@ -297,27 +298,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {\n+                // Get the amounts for mine and watchonly\n+                CAmount credit_mine = 0;\n+                CAmount credit_watchonly = 0;\n+                if (txo.GetIsMine() == ISMINE_SPENDABLE) {\n+                    credit_mine = txo.GetTxOut().nValue;\n+                } else if (txo.GetIsMine() == ISMINE_WATCH_ONLY) {\n+                    credit_watchonly = txo.GetTxOut().nValue;\n+                } else {\n+                    // We shouldn't see any other isminetypes\n+                    Assume(false);",
      "path": "src/wallet/receive.cpp",
      "position": 107,
      "original_position": 47,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b217f576a5f284ac7261986ee6ec9334bbbdbbc6",
      "in_reply_to_id": 1520352559,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No. `ISMINE_USED` is never actually returned from `IsMine`.",
      "created_at": "2024-03-12T14:37:48Z",
      "updated_at": "2024-03-12T14:37:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521587788",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521587788"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": 273,
      "original_start_line": 319,
      "start_side": "RIGHT",
      "line": 274,
      "original_line": 274,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521599391",
      "pull_request_review_id": 1931282586,
      "id": 1521599391,
      "node_id": "PRRC_kwDOABII585ascOf",
      "diff_hunk": "@@ -297,27 +298,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);\n     {\n         LOCK(wallet.cs_wallet);\n-        std::set<uint256> trusted_parents;\n-        for (const auto& entry : wallet.mapWallet)\n-        {\n-            const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{CachedTxIsTrusted(wallet, wtx, trusted_parents)};\n-            const int tx_depth{wallet.GetTxDepthInMainChain(wtx)};\n-            const CAmount tx_credit_mine{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_SPENDABLE | reuse_filter)};\n-            const CAmount tx_credit_watchonly{CachedTxGetAvailableCredit(wallet, wtx, ISMINE_WATCH_ONLY | reuse_filter)};\n-            if (is_trusted && tx_depth >= min_depth) {\n-                ret.m_mine_trusted += tx_credit_mine;\n-                ret.m_watchonly_trusted += tx_credit_watchonly;\n-            }\n-            if (!is_trusted && tx_depth == 0 && wtx.InMempool()) {\n-                ret.m_mine_untrusted_pending += tx_credit_mine;\n-                ret.m_watchonly_untrusted_pending += tx_credit_watchonly;\n+        for (const auto& [outpoint, txo] : wallet.GetTXOs()) {\n+            Assert(MoneyRange(txo.GetTxOut().nValue));\n+\n+            const bool is_trusted{CachedTxIsTrusted(wallet, txo.GetWalletTx())};\n+            const int tx_depth{wallet.GetTxDepthInMainChain(txo.GetWalletTx())};\n+\n+            if (!wallet.IsSpent(outpoint) && (allow_used_addresses || !wallet.IsSpentKey(txo.GetTxOut().scriptPubKey))) {\n+                // Get the amounts for mine and watchonly\n+                CAmount credit_mine = 0;\n+                CAmount credit_watchonly = 0;\n+                if (txo.GetIsMine() == ISMINE_SPENDABLE) {\n+                    credit_mine = txo.GetTxOut().nValue;\n+                } else if (txo.GetIsMine() == ISMINE_WATCH_ONLY) {\n+                    credit_watchonly = txo.GetTxOut().nValue;\n+                } else {\n+                    // We shouldn't see any other isminetypes\n+                    Assume(false);\n+                }\n+\n+                // Set the amounts in the return object",
      "path": "src/wallet/receive.cpp",
      "position": 110,
      "original_position": 50,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b217f576a5f284ac7261986ee6ec9334bbbdbbc6",
      "in_reply_to_id": 1520373556,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can you be more specific as to what kind of transaction you think would result in a different balance? Nothing in this PR should change behavior.",
      "created_at": "2024-03-12T14:44:31Z",
      "updated_at": "2024-03-12T14:44:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521599391",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521599391"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 277,
      "original_line": 277,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521601155",
      "pull_request_review_id": 1931285496,
      "id": 1521601155,
      "node_id": "PRRC_kwDOABII585ascqD",
      "diff_hunk": "@@ -340,5 +375,30 @@ def test_balances(*, fee_node_1=0):\n         assert_equal(tx_info['lastprocessedblock']['height'], prev_height)\n         assert_equal(tx_info['lastprocessedblock']['hash'], prev_hash)\n \n+        self.log.info(\"Test that the balance is updated by an import that makes an untracked output in an existing tx \\\"mine\\\"\")\n+        default = self.nodes[0].get_wallet_rpc(self.default_wallet_name)\n+        self.nodes[0].createwallet(\"importupdate\")\n+        wallet = self.nodes[0].get_wallet_rpc(\"importupdate\")\n+\n+        import_key1 = get_generate_key()\n+        import_key2 = get_generate_key()\n+        wallet.importprivkey(import_key1.privkey)\n+\n+        amount = 15\n+        default.send([{import_key1.p2wpkh_addr: amount},{import_key2.p2wpkh_addr: amount}])\n+        self.generate(self.nodes[0], 1)\n+        # Mock the time forward by 1 day so that \"now\" will exclude the block we just mined\n+        self.nodes[0].setmocktime(int(time.time()) + 86400)\n+        # Mine 11 blocks to move the MTP past the block we just mined\n+        self.generate(self.nodes[0], 11, sync_fun=self.no_op)\n+\n+        balances = wallet.getbalances()\n+        assert_equal(balances[\"mine\"][\"trusted\"], amount)\n+\n+        # Don't rescan to make sure that the import updates the wallet txos\n+        wallet.importprivkey(privkey=import_key2.privkey, rescan=False)\n+        balances = wallet.getbalances()\n+        assert_equal(balances[\"mine\"][\"trusted\"], amount * 2)",
      "path": "test/functional/wallet_balance.py",
      "position": 85,
      "original_position": 85,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "900f95cd56951f5e0f0d0f3a93c09d1fb0bc5787",
      "in_reply_to_id": 1520381857,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That is correct.",
      "created_at": "2024-03-12T14:45:36Z",
      "updated_at": "2024-03-12T14:45:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521601155",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521601155"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": 396,
      "original_start_line": 398,
      "start_side": "RIGHT",
      "line": 399,
      "original_line": 399,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521612789",
      "pull_request_review_id": 1931304324,
      "id": 1521612789,
      "node_id": "PRRC_kwDOABII585asff1",
      "diff_hunk": "@@ -320,137 +320,145 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n     std::vector<COutPoint> outpoints;\n \n     std::set<uint256> trusted_parents;\n-    for (const auto& entry : wallet.mapWallet)\n-    {\n-        const uint256& txid = entry.first;\n-        const CWalletTx& wtx = entry.second;\n+    // Cache for whether each tx passes the tx checks (first bool), and whether the transaction is \"safe\" (second bool)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "c88832eca5df0a391a4a68c73b6fc123f9af2f4b",
      "in_reply_to_id": 1520393226,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The checks are already explained in detail below where they are actually checked. \"tx checks\" just refers to the checks that occur per tx rather than per output. I don't think it is useful to duplicate the explanations here as well.\r\n\r\nI've added a comment that should make it easier to find where the tx checks are performed so you can read the comments that already exist.",
      "created_at": "2024-03-12T14:51:05Z",
      "updated_at": "2024-03-12T14:51:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521612789",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521612789"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 323,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521615589",
      "pull_request_review_id": 1931308853,
      "id": 1521615589,
      "node_id": "PRRC_kwDOABII585asgLl",
      "diff_hunk": "@@ -1143,6 +1143,9 @@ CWalletTx* CWallet::AddToWallet(CTransactionRef tx, const TxState& state, const\n     // Break debit/credit balance caches:\n     wtx.MarkDirty();\n \n+    // Get the outputs that belong to the wallet",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": 1520283962,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed to \"cache\".\r\n\r\n\"on the wallet's transactions\" does not make the comment a valid English sentence, so I'm not sure what meaning you were trying to get across.",
      "created_at": "2024-03-12T14:52:42Z",
      "updated_at": "2024-03-12T14:52:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521615589",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521615589"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1146,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521616092",
      "pull_request_review_id": 1931309762,
      "id": 1521616092,
      "node_id": "PRRC_kwDOABII585asgTc",
      "diff_hunk": "@@ -4467,4 +4475,22 @@ void CWallet::TopUpCallback(const std::set<CScript>& spks, ScriptPubKeyMan* spkm\n     // Update scriptPubKey cache\n     CacheNewScriptPubKeys(spks, spkm);\n }\n+\n+void CWallet::RefreshWalletTxTXOs(const CWalletTx& wtx)\n+{\n+    AssertLockHeld(cs_wallet);\n+    for (uint32_t i = 0; i < wtx.tx->vout.size(); ++i) {\n+        const CTxOut& txout = wtx.tx->vout.at(i);\n+        isminetype ismine = IsMine(txout);\n+        if (ismine == ISMINE_NO) {\n+            continue;\n+        }\n+        COutPoint outpoint(wtx.GetHash(), i);\n+        if (m_txos.count(outpoint) > 0) {",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": 1520287400,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2024-03-12T14:52:57Z",
      "updated_at": "2024-03-12T14:52:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521616092",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521616092"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4489,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521616290",
      "pull_request_review_id": 1931310092,
      "id": 1521616290,
      "node_id": "PRRC_kwDOABII585asgWi",
      "diff_hunk": "@@ -425,6 +425,9 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     //! Cache of descriptor ScriptPubKeys used for IsMine. Maps ScriptPubKey to set of spkms\n     std::unordered_map<CScript, std::vector<ScriptPubKeyMan*>, SaltedSipHasher> m_cached_spks;\n \n+    //! Set of transaction outputs owned by this wallet",
      "path": "src/wallet/wallet.h",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": 1520290111,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2024-03-12T14:53:04Z",
      "updated_at": "2024-03-12T14:53:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521616290",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521616290"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521616466",
      "pull_request_review_id": 1931310381,
      "id": 1521616466,
      "node_id": "PRRC_kwDOABII585asgZS",
      "diff_hunk": "@@ -256,6 +256,10 @@ bool CachedTxIsFromMe(const CWallet& wallet, const CWalletTx& wtx, const isminef\n bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx, std::set<uint256>& trusted_parents)\n {\n     AssertLockHeld(wallet.cs_wallet);\n+\n+    // This wtx is already trusted\n+    if (trusted_parents.count(wtx.GetHash()) > 0) return true;",
      "path": "src/wallet/receive.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "0283525d64a28c79f4588ef0a71bd280b2fc7768",
      "in_reply_to_id": 1520295185,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2024-03-12T14:53:10Z",
      "updated_at": "2024-03-12T14:53:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521616466",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521616466"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 261,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521616919",
      "pull_request_review_id": 1931311146,
      "id": 1521616919,
      "node_id": "PRRC_kwDOABII585asggX",
      "diff_hunk": "@@ -297,27 +298,40 @@ bool CachedTxIsTrusted(const CWallet& wallet, const CWalletTx& wtx)\n Balance GetBalance(const CWallet& wallet, const int min_depth, bool avoid_reuse)\n {\n     Balance ret;\n-    isminefilter reuse_filter = avoid_reuse ? ISMINE_NO : ISMINE_USED;\n+    bool allow_used_addresses = !avoid_reuse || !wallet.IsWalletFlagSet(WALLET_FLAG_AVOID_REUSE);",
      "path": "src/wallet/receive.cpp",
      "position": 77,
      "original_position": 13,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "b217f576a5f284ac7261986ee6ec9334bbbdbbc6",
      "in_reply_to_id": 1520330141,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Mentioned in the commit message.",
      "created_at": "2024-03-12T14:53:26Z",
      "updated_at": "2024-03-12T14:53:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1521616919",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521616919"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 255,
      "original_line": 255,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1532522219",
      "pull_request_review_id": 1949605766,
      "id": 1532522219,
      "node_id": "PRRC_kwDOABII585bWG7r",
      "diff_hunk": "@@ -1143,6 +1143,9 @@ CWalletTx* CWallet::AddToWallet(CTransactionRef tx, const TxState& state, const\n     // Break debit/credit balance caches:\n     wtx.MarkDirty();\n \n+    // Get the outputs that belong to the wallet",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "20cec0c84bbe783ddfc0c9b6c3ce1cb45f93385e",
      "in_reply_to_id": 1520283962,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think I wanted to express that this function operates only on the transactions that the wallet tracks already.",
      "created_at": "2024-03-20T17:33:25Z",
      "updated_at": "2024-03-20T17:33:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1532522219",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1532522219"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1146,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1707091091",
      "pull_request_review_id": 2225335817,
      "id": 1707091091,
      "node_id": "PRRC_kwDOABII585lwCST",
      "diff_hunk": "@@ -507,6 +510,8 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n \n     std::set<uint256> GetTxConflicts(const CWalletTx& wtx) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n \n+    void RefreshWalletTxTXOs(const CWalletTx& wtx) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
      "path": "src/wallet/wallet.h",
      "position": 17,
      "original_position": 14,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "d6f67e97b7ec0b5fdc39e5ad52e0c03dd0e03fd1",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In d6f67e97b7ec0b5fdc39e5ad52e0c03dd0e03fd1 wallet: Keep track of transaction outputs owned by the wallet:\r\n\r\nIt would have helped me if this function had some documentation. Also, \"Wallet transaction transaction outputs\" feels a bit redundant, and the name `RefreshWalletTxTXOs(â€¦)` is extremely similar to `RefreshAllTXOs()` that gets introduced in the later commit \"wallet: Recalculate the wallet's txos after any imports\". If you have to touch this again, perhaps consider calling this function `CacheWalletTXOs`?\r\n\r\n```suggestion\r\n    /** Processes one wallet transaction and caches outputs that belong to our wallet. */\r\n    void RefreshWalletTxTXOs(const CWalletTx& wtx) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n```",
      "created_at": "2024-08-07T14:16:04Z",
      "updated_at": "2024-08-08T18:06:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1707091091",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1707091091"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 513,
      "original_line": 513,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1707520564",
      "pull_request_review_id": 2225335817,
      "id": 1707520564,
      "node_id": "PRRC_kwDOABII585lxrI0",
      "diff_hunk": "@@ -513,6 +513,7 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     const std::unordered_map<COutPoint, WalletTXO, SaltedOutpointHasher>& GetTXOs() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet) { AssertLockHeld(cs_wallet); return m_txos; };\n \n     void RefreshWalletTxTXOs(const CWalletTx& wtx) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n+    void RefreshAllTXOs() EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
      "path": "src/wallet/wallet.h",
      "position": 18,
      "original_position": 4,
      "commit_id": "b0c5cdc0d76ef809c6f88a12c71b8789e860a96d",
      "original_commit_id": "9d3762913ba02d1f6cd3b42889c2c3b31f03e90c",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 9d3762913ba02d1f6cd3b42889c2c3b31f03e90c \"wallet: Recalculate the wallet's txos after any imports\":\r\n\r\nPerhaps add a documentation comment here along the lines of:\r\n\r\n```suggestion\r\n    /** Inspects every wallet transaction and caches all outputs that belong to our wallet. */\r\n    void RefreshAllTXOs() EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n```",
      "created_at": "2024-08-07T17:30:48Z",
      "updated_at": "2024-08-08T18:06:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27286#discussion_r1707520564",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1707520564"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27286"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 514,
      "original_line": 514,
      "side": "RIGHT"
    }
  ]
}