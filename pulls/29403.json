{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403",
    "id": 1715711302,
    "node_id": "PR_kwDOABII585mQ61G",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29403",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29403.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29403.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29403",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29403/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/757d6516db56e2732ea77624e66025446cb816a4",
    "number": 29403,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet: batch erase procedures and improve 'EraseRecords' performance",
    "user": {
      "login": "furszy",
      "id": 5377650,
      "node_id": "MDQ6VXNlcjUzNzc2NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/furszy",
      "html_url": "https://github.com/furszy",
      "followers_url": "https://api.github.com/users/furszy/followers",
      "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
      "organizations_url": "https://api.github.com/users/furszy/orgs",
      "repos_url": "https://api.github.com/users/furszy/repos",
      "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/furszy/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The first two commits are coming from #26836. They are required for these changes.\r\nFound this while working on #28987.\r\n\r\nSeeks to optimize and simplify `WalletBatch::EraseRecords`. Currently, this process opens a cursor to iterate over the entire database, searching for records that match the type prefixes, to then call the `WalletBatch::Erase` function for each of the matching records.\r\nThis PR rewrites this 40-line manual process into a single line; instead of performing all of those actions manually, we can simply utilize the `ErasePrefix()` functionality. The result is 06216b344dea6ad6c385fda0b37808ff9ae5273b.\r\n\r\nMoreover, it expands the test coverage for the `ErasePrefix` functionality and documents the db txn requirement for `BerkeleyBatch::ErasePrefix` .",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2024-02-07T13:42:56Z",
    "updated_at": "2024-02-08T16:16:55Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "8a828c5cb11909cd8697d07cdd439b683a5f2f29",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "furszy:2024_wallet_simplify_EraseRecords",
      "ref": "2024_wallet_simplify_EraseRecords",
      "sha": "757d6516db56e2732ea77624e66025446cb816a4",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 143624913,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDM2MjQ5MTM=",
        "name": "bitcoin-core",
        "full_name": "furszy/bitcoin-core",
        "owner": {
          "login": "furszy",
          "id": 5377650,
          "node_id": "MDQ6VXNlcjUzNzc2NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/furszy",
          "html_url": "https://github.com/furszy",
          "followers_url": "https://api.github.com/users/furszy/followers",
          "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
          "organizations_url": "https://api.github.com/users/furszy/orgs",
          "repos_url": "https://api.github.com/users/furszy/repos",
          "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/furszy/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/furszy/bitcoin-core",
        "description": "Bitcoin-Core",
        "fork": true,
        "url": "https://api.github.com/repos/furszy/bitcoin-core",
        "archive_url": "https://api.github.com/repos/furszy/bitcoin-core/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/furszy/bitcoin-core/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/furszy/bitcoin-core/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/furszy/bitcoin-core/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/furszy/bitcoin-core/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/furszy/bitcoin-core/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/furszy/bitcoin-core/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/furszy/bitcoin-core/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/furszy/bitcoin-core/contributors",
        "deployments_url": "https://api.github.com/repos/furszy/bitcoin-core/deployments",
        "downloads_url": "https://api.github.com/repos/furszy/bitcoin-core/downloads",
        "events_url": "https://api.github.com/repos/furszy/bitcoin-core/events",
        "forks_url": "https://api.github.com/repos/furszy/bitcoin-core/forks",
        "git_commits_url": "https://api.github.com/repos/furszy/bitcoin-core/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/furszy/bitcoin-core/git/tags%7B/sha%7D",
        "git_url": "git://github.com/furszy/bitcoin-core.git",
        "issue_comment_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/furszy/bitcoin-core/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/furszy/bitcoin-core/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/furszy/bitcoin-core/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/furszy/bitcoin-core/languages",
        "merges_url": "https://api.github.com/repos/furszy/bitcoin-core/merges",
        "milestones_url": "https://api.github.com/repos/furszy/bitcoin-core/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/furszy/bitcoin-core/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/furszy/bitcoin-core/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/furszy/bitcoin-core/releases%7B/id%7D",
        "ssh_url": "git@github.com:furszy/bitcoin-core.git",
        "stargazers_url": "https://api.github.com/repos/furszy/bitcoin-core/stargazers",
        "statuses_url": "https://api.github.com/repos/furszy/bitcoin-core/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/furszy/bitcoin-core/subscribers",
        "subscription_url": "https://api.github.com/repos/furszy/bitcoin-core/subscription",
        "tags_url": "https://api.github.com/repos/furszy/bitcoin-core/tags",
        "teams_url": "https://api.github.com/repos/furszy/bitcoin-core/teams",
        "trees_url": "https://api.github.com/repos/furszy/bitcoin-core/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/furszy/bitcoin-core.git",
        "hooks_url": "https://api.github.com/repos/furszy/bitcoin-core/hooks",
        "svn_url": "https://github.com/furszy/bitcoin-core",
        "homepage": "",
        "language": "C++",
        "forks_count": 4,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 391813,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-02-08T16:16:53Z",
        "created_at": "2018-08-05T15:28:43Z",
        "updated_at": "2023-08-30T13:12:58Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "0471aee5077fef81a0e2e032f3c16bdc948a70f2",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36735,
        "stargazers_count": 73775,
        "watchers_count": 73775,
        "size": 248404,
        "default_branch": "master",
        "open_issues_count": 691,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-02-08T16:47:27Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-02-08T16:58:36Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 91,
    "deletions": 45,
    "changed_files": 6,
    "commits": 3,
    "review_comments": 8,
    "comments": 4
  },
  "events": [
    {
      "event": "commented",
      "id": 1932079274,
      "node_id": "IC_kwDOABII585zKTCq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932079274",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T13:42:59Z",
      "updated_at": "2024-02-07T22:37:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29403).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [achow101](https://github.com/bitcoin/bitcoin/pull/29403#pullrequestreview-1868639990) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26836](https://github.com/bitcoin/bitcoin/pull/26836) (wallet: batch and simplify addressbook migration process by furszy)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#issuecomment-1932079274",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29403"
    },
    {
      "event": "labeled",
      "id": 11732630908,
      "node_id": "LE_lADOABII585-i32ezwAAAAK7Ub18",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11732630908",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T13:43:01Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "reviewed",
      "id": 1867863458,
      "node_id": "PRR_kwDOABII585vVVWi",
      "url": null,
      "actor": null,
      "commit_id": "da103ecf4a7a341e7376c6ef31af11aed05aed5c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#pullrequestreview-1867863458",
      "submitted_at": "2024-02-07T13:50:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T14:13:25Z",
      "updated_at": "2024-02-07T14:13:25Z",
      "source": {
        "issue": {
          "id": 1522557576,
          "node_id": "PR_kwDOABII585G0Yzm",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26836",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26836/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26836/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26836/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26836",
          "number": 26836,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: batch and simplify addressbook migration process",
          "body": "Commits decoupled from #28574, focused on the address book cloning process\r\n\r\nIncludes:\r\n\r\n1) DB batch operations and flow simplification for the address book migration process.\r\n2) Code improvements to `CWallet::DelAddressBook` and `Wallet::SetAddrBookWithDB` methods.\r\n\r\nThese changes will let us consolidate all individual write operations that take place during the wallet migration process into a single db txn in the future.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 14,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26836",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26836",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26836.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26836.patch"
          },
          "closed_at": "2024-02-08T14:35:56Z",
          "created_at": "2023-01-06T13:05:27Z",
          "updated_at": "2024-02-08T15:30:12Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11733059221,
      "node_id": "HRFPE_lADOABII585-i32ezwAAAAK7WEaV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11733059221",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T14:15:33Z"
    },
    {
      "event": "commented",
      "id": 1932141334,
      "node_id": "IC_kwDOABII585zKiMW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932141334",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T14:16:21Z",
      "updated_at": "2024-02-07T14:16:21Z",
      "author_association": "MEMBER",
      "body": "Updated per feedback. Thanks Marko.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#issuecomment-1932141334",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29403"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11733098359,
      "node_id": "HRFPE_lADOABII585-i32ezwAAAAK7WN93",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11733098359",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T14:18:29Z"
    },
    {
      "event": "labeled",
      "id": 11733099584,
      "node_id": "LE_lADOABII585-i32ezwAAAAK7WORA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11733099584",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T14:18:35Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1932145648,
      "node_id": "IC_kwDOABII585zKjPw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932145648",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T14:18:36Z",
      "updated_at": "2024-02-07T14:18:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\nðŸš§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/21321086502</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#issuecomment-1932145648",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29403"
    },
    {
      "event": "commented",
      "id": 1932273984,
      "node_id": "IC_kwDOABII585zLClA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932273984",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T15:21:23Z",
      "updated_at": "2024-02-07T15:21:31Z",
      "author_association": "MEMBER",
      "body": "Green CI. Ready.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#issuecomment-1932273984",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29403"
    },
    {
      "event": "unlabeled",
      "id": 11734630150,
      "node_id": "UNLE_lADOABII585-i32ezwAAAAK7cD8G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11734630150",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T16:10:09Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1868639990,
      "node_id": "PRR_kwDOABII585vYS72",
      "url": null,
      "actor": null,
      "commit_id": "69c5bb5c3ad3da508541a3ef6c29a0bad21f2fc0",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK 69c5bb5c3ad3da508541a3ef6c29a0bad21f2fc0",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#pullrequestreview-1868639990",
      "submitted_at": "2024-02-07T19:46:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T20:38:23Z",
      "updated_at": "2024-02-07T20:38:23Z",
      "source": {
        "issue": {
          "id": 722711719,
          "node_id": "MDU6SXNzdWU3MjI3MTE3MTk=",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20160",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20160/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20160/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20160/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/20160",
          "number": 20160,
          "state": "open",
          "state_reason": null,
          "title": "Proposed Timeline for Legacy Wallet and BDB removal",
          "body": "Here is a proposed timeline for the move from legacy wallets to descriptor wallets, and at the same time, bdb to sqlite, culminating with the removal of both legacy wallets and bdb. Even though the wallet type and the wallet storage format are orthogonal to each other, as noted in #19077, I would like to tie them together for the sake of simplicity when it comes to how we make new wallets and the migration of one type to another.\r\n\r\nThe 4 combinations of type and format are: legacy-bdb, legacy-sqlite, descriptor-bdb, and descriptor-sqlite. While all 4 types will be supported, we will primarily deal with legacy-bdb and descriptor-sqlite. Setting `descriptors=True` in `createwallet` (or checking the Descriptors option in the GUI) will always make a descriptor-sqlite. Setting that to `False` will always make a legacy-bdb.\r\n\r\n- [x] 0.21 (late 2020)\r\n  - [x] Initial release of descriptor type and sqlite format. (#16528, #19077)\r\n  - [x] Descriptor type is experimental with a warning as such (#16528)\r\n  - [x] Only legacy-bdb and descriptor-sqlite will be created (#19077)\r\n- [x] 22.0 (mid 2021)\r\n  - [x] Implement descriptor exports (#20226)\r\n  - [x] Legacy type remains default (no pr needed)\r\n  - [x] Introduce `dump` and `createfromdump` wallet tool commands with an additional `-format` option to specify the wallet type (#19137)\r\n    * Users may use `dump` and then `createfromdump` in order to make legacy-sqlite from legacy-bdb\r\n    * Users may use `dump` and then `createfromdump` in order to make descriptor-bdb from descriptor-sqlite\r\n  - [x] If a wallet specified in conf or command line doesn't exist, don't make a wallet and instead warn (#15454)\r\n- [x] 23.0 (early 2022)\r\n  - [x] Change descriptor type to non-experimental (#23002)\r\n  - [x] Change `createwallet` `descriptors` default to `True` (#23002)\r\n  - [x] Change wallet tool `create` `-descriptors` default to `True` (#23002)\r\n- [x] 24.0 (late 2022)\r\n  - [x] Introduce `migratewallet` command to migrate a legacy-bdb to descriptor-sqlite (#19602)\r\n  - [x] For newly created legacy-bdb wallets, warn that they are deprecated and will soon be unsupported (#24505)\r\n- [x] 26.0 (late 2023)\r\n  - [x] When loading legacy-bdb, descriptor-bdb, or legacy-sqlite wallets, warn that the legacy type and bdb format will soon be unsupported, as applicable. (#27869)\r\n  - [x] Deprecate creating new legacy-bdb wallets #28597 \r\n  - [x] `migratewallet` bug fixes\r\n    - [x] #28609\r\n    - [x] #28546\r\n- [ ] 27.0 (early 2024)\r\n  - [ ] Improve performance of migratewallet #28574\r\n    - [x] address book performance improvement #26836\r\n    - [ ] bulk deletion of txs performance improvement #28987\r\n    - [ ] bulk deletion of records performance improvement #29403\r\n  - [ ] Caching to improve performance of migrated non-HD descriptor wallets (also perf improvement in general) #26008\r\n  - [ ] Remove `migratewallet` experimental warning #28037 \r\n- [ ] 28.0 (late 2024)\r\n  - [ ] Reimplement legacy-bdb to descriptor-sqlite migration (maybe as a separate command or in the wallet tool) to be independent of `LegacyScriptPubKeyMan` and BDB (#26596)\r\n  - [ ] For `dump`, implement an independent BDB file loader (this should probably be shared with the previous) (#26606)\r\n  - [ ] Stop creating new legacy-bdb wallets (not yet started)\r\n  - [ ] GUI: Migrate wallets that are not loaded (not yet started)\r\n- [ ] 29.0 (early 2025)\r\n  - [ ] Stop loading legacy-bdb, descriptor-bdb, legacy-sqlite wallet entirely. Inform users how to migrate (not yet started)\r\n  - [ ] Remove `LegacyScriptPubKeyMan` except for the independent migration stuff (#28710)\r\n  - [ ] Remove BDB except for independent loading for migration stuff (#28710)\r\n\r\nAdditional improvements that have no target deadline:\r\n\r\n- [x] Backwards compatibility tests fixes for descriptor wallets #28027\r\n\r\nThe migration code will probably be around for a long time/forever.\r\n\r\nNote that we expect users who go through the effort to make a legacy-sqlite or descriptor-bdb wallet to suck it up and deal with the consequences of doing something that isn't really supported. Such users should be able to figure out for themselves how to migrate their wallets. (Maybe `migratewallet` can migrate legacy-sqlite to descriptor-sqlite. bdb to sqlite is way easier than legacy to descriptor).",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64583,
              "node_id": "MDU6TGFiZWw2NDU4Mw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
              "name": "Feature",
              "color": "7cf575",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 36,
          "created_at": "2020-10-15T22:17:41Z",
          "updated_at": "2024-02-08T14:36:27Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11738637527,
      "node_id": "HRFPE_lADOABII585-i32ezwAAAAK7rWTX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11738637527",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-07T22:37:47Z"
    },
    {
      "event": "reviewed",
      "id": 1868847059,
      "node_id": "PRR_kwDOABII585vZFfT",
      "url": null,
      "actor": null,
      "commit_id": "0fd7b0dafa980a5dbcee8658d18a83f4eff57085",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Updated per feedback. Thanks achow!",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#pullrequestreview-1868847059",
      "submitted_at": "2024-02-07T22:38:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11746338678,
      "node_id": "HRFPE_lADOABII585-i32ezwAAAAK8Iud2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11746338678",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T14:11:30Z"
    },
    {
      "event": "reviewed",
      "id": 1870335464,
      "node_id": "PRR_kwDOABII585vew3o",
      "url": null,
      "actor": null,
      "commit_id": "784034f8a17d46de9eab7de6fdec673a3a3d79d8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Updated per feedback. Thanks achow.\r\n[Small diff](https://github.com/bitcoin/bitcoin/compare/0fd7b0dafa980a5dbcee8658d18a83f4eff57085..784034f8a17d46de9eab7de6fdec673a3a3d79d8), only changed `assert` for `Assume`.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#pullrequestreview-1870335464",
      "submitted_at": "2024-02-08T14:16:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGE4YTI0Y2IyMDk3NGNiOGVhZWM4Y2I0MzhmNmIyMjQ4OTcxOWQ2MDU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a8a24cb20974cb8eaec8cb438f6b22489719d605",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a8a24cb20974cb8eaec8cb438f6b22489719d605",
      "tree": {
        "sha": "835c9bf476ee1042fb9106a7290a014732a90636",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/835c9bf476ee1042fb9106a7290a014732a90636"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 835c9bf476ee1042fb9106a7290a014732a90636\nparent 835948d44bca664901057c37ed5b1d0e7e658786\nauthor furszy <matiasfurszyfer@protonmail.com> 1707406466 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1707407643 -0300\n\nwallet: db, introduce 'RunWithinTxn()' helper function\n\n'RunWithinTxn()' provides a way to execute db operations within a\ntransactional context. It avoids writing repetitive boilerplate code for\nstarting and committing the database transaction.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmXE+RsACgkQXdI8zGhq\npiMxzg//eSANNDuBXzgDPp6uCwfd0XF28DteM2T96Yi1p383+ZQ63tRHKLbOcyjW\nzgNEwjQ1s9IKmU4qNA3s7cijK+LsYsilxNG69Ix0ZtOZf+ehErcOJXyf8qoJqydp\nvtRAzFpKNOEmGVTkVV4U+RjbWflRugP7iqbw7/OBy9DYin2GbBcCKcPtC5n17Wpz\n6dIuCPrhUY4V3VY4FhCV70rr/z2aaMRTGlXyH8kM8cGu440Cd8Jfio5tbvTV/CZr\nuqca+euIACi2LOETj7AuHKm9x4XVOjMsL/pSdGypG97L9WZ/cE2+1ZMR+3w3u88u\nrLmm0+1ll0GcahO/WthQpu7vgPiywyIzoNCJ5yEe8sov5iAqhzyHeaxVi12nkgfp\nINhS+Ir2LrJGymXrEycMgyVT0/pLc7N91OAxgUqhiEo4zcvSp1LH4/Phz6yKFOIq\nzj/unlsdUz9B/p/sOd4EkGXAsaLMpALtJAENCEkHMF6/JFZ75DV+0EbRxBCoPNfl\ns8MrWwbBFWEC8EB661Yz/y3LP3Y8PX35qgnnXGdm80RzblHtsAk1jiKqYp1VFQNB\nBylovhrjmwnlFV9biYugqawSV884k8gIq21Uqr93twzWIoAla0/v3M+veVOJ5JNS\nz7NfIKOV17q9AMTc/io6AZVDIBkOM62HyAfL43ACtx++h4vn4cM=\n=unui\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/835948d44bca664901057c37ed5b1d0e7e658786",
          "sha": "835948d44bca664901057c37ed5b1d0e7e658786",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/835948d44bca664901057c37ed5b1d0e7e658786"
        }
      ],
      "message": "wallet: db, introduce 'RunWithinTxn()' helper function\n\n'RunWithinTxn()' provides a way to execute db operations within a\ntransactional context. It avoids writing repetitive boilerplate code for\nstarting and committing the database transaction.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2024-02-08T15:54:03Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2024-02-08T15:34:26Z"
      },
      "sha": "a8a24cb20974cb8eaec8cb438f6b22489719d605"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDUyMzUyNTcwNzc0MmZjNjIwMDM5Y2Q2N2U4ZjE0MzdmN2Y2MTNhMDE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/523525707742fc620039cd67e8f1437f7f613a01",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/523525707742fc620039cd67e8f1437f7f613a01",
      "tree": {
        "sha": "cc1591952f0e87e05903c47cdad08a704cc31c0b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cc1591952f0e87e05903c47cdad08a704cc31c0b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree cc1591952f0e87e05903c47cdad08a704cc31c0b\nparent a8a24cb20974cb8eaec8cb438f6b22489719d605\nauthor furszy <matiasfurszyfer@protonmail.com> 1707247703 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1707407644 -0300\n\nwallet: bdb batch 'ErasePrefix', do not create txn internally\n\nTransactions are intended to be started on upper layers rather than\ninternally by the bdb batch object. This enables us to consolidate\ndifferent write operations within a procedure in the same db txn,\nimproving consistency due to the atomic property of the transaction,\nas well as its performance due to the reduction of disk write\noperations.\n\nImportant Note:\nThis approach also ensures that the BerkeleyBatch::ErasePrefix\nfunction behaves exactly as the SQLiteBatch::ErasePrefix function,\nwhich does not create a db txn internally.\n\nFurthermore, because the `BerkeleyBatch::ErasePrefix' implementation\nerases records one by one (traversing the db), this change ensures\nthat the function is always called within a txn context. This is\nbecause, otherwise, consistency could be at risk; it's possible that\ncertain records are removed while others remain due to an internal\nfailure throughout the procedure.\n\nFurthermore, since the `BerkeleyBatch::ErasePrefix' implementation\nerases records one by one (by traversing the db), this change\nensures that the function is always called within an active txn\ncontext. Without this measure, there's a potential risk to consistency;\ncertain records may be removed while others could persist due to an\ninternal failure during the procedure.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmXE+RwACgkQXdI8zGhq\npiOWsw//RpFJZQBPkswIDg96iogHYJHfmR0K1OWeDVwV8UClvBCEkg2r8JhBvuKs\nRheqii1uNy+ysHqXVzokhcH5wGpEINX+4YoSTLKxR/2vyoyPvp41kka1Rvn2oSKM\n38lcGCdkdmSGylODpvetRI717dUwFmBkSqFecUOH0ytdIol5OQ0GHQe8TaX43L+Q\nMR7EIn1wWAL7MvMjPRV/RWH9/wE2C7DqmQSydz0/PUXLNfGjiJ+nmF1q2F6ExSMG\nupy5YI+rzrZL2GIfjeu2OmxlH6mr+9V1AoDuIBcXC8ADpXz38G9b/RVTsN4Ox8zE\n8nmAcVezBiQOwCYyI4NGXhgnTujNQyEoTXh3KAqDrSByRapmBU1AtWWW+7X8yEO6\nl50RsbZck+8IW9oUP3jRboHu1oeRYZer1adRIjWYi9sZGYg5c2FAsKrk8ybZ0Q0U\nnxkUkmCm4PCzblWdEsVF67M1TJI/1bRy4jW24jXhYu0g69lFCdY0xcxlu6cBwNY6\nW1uEEGOjy2+FrhZoun5zE4mQE2s541C91MqtARwG+aty3Yl9bwU4gZ2gmIBa4Vss\nyZt78/lLxle/u2alpx9Pny3uCILV/IVtOHW9MY2rJk7ETv/8pouuN8PDbh+vBKu/\nNX9l7YqWehva5XMh8UEQV5iq2gZt749By158qy9RQ53ArFpRIF4=\n=q5EA\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a8a24cb20974cb8eaec8cb438f6b22489719d605",
          "sha": "a8a24cb20974cb8eaec8cb438f6b22489719d605",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a8a24cb20974cb8eaec8cb438f6b22489719d605"
        }
      ],
      "message": "wallet: bdb batch 'ErasePrefix', do not create txn internally\n\nTransactions are intended to be started on upper layers rather than\ninternally by the bdb batch object. This enables us to consolidate\ndifferent write operations within a procedure in the same db txn,\nimproving consistency due to the atomic property of the transaction,\nas well as its performance due to the reduction of disk write\noperations.\n\nImportant Note:\nThis approach also ensures that the BerkeleyBatch::ErasePrefix\nfunction behaves exactly as the SQLiteBatch::ErasePrefix function,\nwhich does not create a db txn internally.\n\nFurthermore, because the `BerkeleyBatch::ErasePrefix' implementation\nerases records one by one (traversing the db), this change ensures\nthat the function is always called within a txn context. This is\nbecause, otherwise, consistency could be at risk; it's possible that\ncertain records are removed while others remain due to an internal\nfailure throughout the procedure.\n\nFurthermore, since the `BerkeleyBatch::ErasePrefix' implementation\nerases records one by one (by traversing the db), this change\nensures that the function is always called within an active txn\ncontext. Without this measure, there's a potential risk to consistency;\ncertain records may be removed while others could persist due to an\ninternal failure during the procedure.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2024-02-08T15:54:04Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2024-02-06T19:28:23Z"
      },
      "sha": "523525707742fc620039cd67e8f1437f7f613a01"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11747889667,
      "node_id": "HRFPE_lADOABII585-i32ezwAAAAK8OpID",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11747889667",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T15:56:46Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc1N2Q2NTE2ZGI1NmUyNzMyZWE3NzYyNGU2NjAyNTQ0NmNiODE2YTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/757d6516db56e2732ea77624e66025446cb816a4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/757d6516db56e2732ea77624e66025446cb816a4",
      "tree": {
        "sha": "5ab80cfc356b5fd91ac8300777e9fe0fbbd57301",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5ab80cfc356b5fd91ac8300777e9fe0fbbd57301"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5ab80cfc356b5fd91ac8300777e9fe0fbbd57301\nparent 523525707742fc620039cd67e8f1437f7f613a01\nauthor furszy <matiasfurszyfer@protonmail.com> 1707225948 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1707408954 -0300\n\nwallet: simplify EraseRecords by using 'ErasePrefix'\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmXE/joACgkQXdI8zGhq\npiMjYBAAxSoaBAkndL75x1PdIpeG90Yd8YjHlGkS7W/eN9ecxp7sAHGZpvz62AvM\nRU/hy+94aoDJfNXZ/4DpUzZcZCV27zW82knvc2WBHO461hnVut1i2C2nBsyHAL6p\n/N7ylbocr72MsBqNDLx3XfNbXaorP8vuDdbGeZTk5msNbN+QlMOqOOD0yGaoX6bK\nrbVR8SshaiYRkJykMltd+qz3OVW78Ov6lRGKGwW1/nHo0laFBvrDHYzFonKAPZ3A\nqwLmZS5Gan0xEJL7uii5zdeS6ysxHN64nEeluGSkb3jcFbjqSDIgxewwju8Wju9i\nvdx/rGiAdTPVGaNDRq0hlKE/Gwk4nMOCsbX5LLvOMVxoFDTV9fz43kdkWYYZ7hHv\n611sNgJCGzVywfO6CQOcE01NyBx3P2LASx5mSWEdS52tRboeoAmR6cpQgpOYvkUd\nOJb1iWiYmKZuzV/QBJ93Gu2W0bh0HZX6zP1hnfUgtTbBEZO6JjnD6VIyLM9onj5o\nAg8IE05N7fQd8xZG06l66CSCagTiVEAoKCyg1wn2u+pFYwFiEI8kPgONxQvbrFi+\nYivxQrNpqjD+k3mopv+6GXMaZ1RcNQX8I9c3xYbG//z5kms+06DXAIa+QZRvKnY6\nBdbG26Ma394VPRf6NB7ok3iVY0de+fJoSgxtT86Gu7ltLN8k1gk=\n=6j6i\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/523525707742fc620039cd67e8f1437f7f613a01",
          "sha": "523525707742fc620039cd67e8f1437f7f613a01",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/523525707742fc620039cd67e8f1437f7f613a01"
        }
      ],
      "message": "wallet: simplify EraseRecords by using 'ErasePrefix'",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2024-02-08T16:15:54Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2024-02-06T13:25:48Z"
      },
      "sha": "757d6516db56e2732ea77624e66025446cb816a4"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11748184644,
      "node_id": "HRFPE_lADOABII585-i32ezwAAAAK8PxJE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11748184644",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T16:16:55Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481506563",
      "pull_request_review_id": 1867863458,
      "id": 1481506563,
      "node_id": "PRRC_kwDOABII585YTf8D",
      "diff_hunk": "@@ -2395,15 +2395,37 @@ bool CWallet::DelAddressBook(const CTxDestination& address)\n             WalletLogPrintf(\"%s called with IsMine address, NOT SUPPORTED. Please report this bug! %s\\n\", __func__, PACKAGE_BUGREPORT);\n             return false;\n         }\n+\n+        WalletBatch batch(GetDatabase());\n+        if (!batch.TxnBegin()) {\n+            WalletLogPrintf(\"Error: cannot create db txn for address book entry removal\\n\");\n+            return false;\n+        }\n+\n         // Delete data rows associated with this address\n-        batch.EraseAddressData(address);\n+        if (!batch.EraseAddressData(address)) {\n+            WalletLogPrintf(\"Error: cannot erase address book entry data\\n\");\n+            return false;\n+        }\n+\n+        // Delete purpose and name\n+        if (!batch.ErasePurpose(dest) || !batch.EraseName(dest)) {\n+            WalletLogPrintf(\"%s error erasing purpose/name\\n\", __func__);",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "757d6516db56e2732ea77624e66025446cb816a4",
      "original_commit_id": "da103ecf4a7a341e7376c6ef31af11aed05aed5c",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, feel free to ignore: Any reason to add `__func__` to this log, when none of the other logs have it here? If someone is interested in the exact source location, they can enable the corresponding log option. If this is needed for context, it could make more sense to clarify the log message itself, so that it is unique and clear without requiring the source code as context.\r\n",
      "created_at": "2024-02-07T13:50:54Z",
      "updated_at": "2024-02-07T13:50:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481506563",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481506563"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481525685",
      "pull_request_review_id": 1867895148,
      "id": 1481525685,
      "node_id": "PRRC_kwDOABII585YTkm1",
      "diff_hunk": "@@ -2395,15 +2395,37 @@ bool CWallet::DelAddressBook(const CTxDestination& address)\n             WalletLogPrintf(\"%s called with IsMine address, NOT SUPPORTED. Please report this bug! %s\\n\", __func__, PACKAGE_BUGREPORT);\n             return false;\n         }\n+\n+        WalletBatch batch(GetDatabase());\n+        if (!batch.TxnBegin()) {\n+            WalletLogPrintf(\"Error: cannot create db txn for address book entry removal\\n\");\n+            return false;\n+        }\n+\n         // Delete data rows associated with this address\n-        batch.EraseAddressData(address);\n+        if (!batch.EraseAddressData(address)) {\n+            WalletLogPrintf(\"Error: cannot erase address book entry data\\n\");\n+            return false;\n+        }\n+\n+        // Delete purpose and name\n+        if (!batch.ErasePurpose(dest) || !batch.EraseName(dest)) {\n+            WalletLogPrintf(\"%s error erasing purpose/name\\n\", __func__);",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "757d6516db56e2732ea77624e66025446cb816a4",
      "original_commit_id": "da103ecf4a7a341e7376c6ef31af11aed05aed5c",
      "in_reply_to_id": 1481506563,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Any reason to add `__func__` to this log, when none of the other logs have it here?\r\n\r\nNot really. It is just a bad habit. I pulled 9a4e1f5 from #26836 because it is required for this changes. Will change it there.",
      "created_at": "2024-02-07T14:04:31Z",
      "updated_at": "2024-02-07T14:04:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481525685",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481525685"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481997602",
      "pull_request_review_id": 1868639990,
      "id": 1481997602,
      "node_id": "PRRC_kwDOABII585YVX0i",
      "diff_hunk": "@@ -2396,14 +2397,24 @@ bool CWallet::DelAddressBook(const CTxDestination& address)\n             return false;\n         }\n         // Delete data rows associated with this address\n-        batch.EraseAddressData(address);\n+        if (!batch.EraseAddressData(address)) {\n+            WalletLogPrintf(\"Error: cannot erase address book entry data\\n\");\n+            return false;\n+        }\n+\n+        // Delete purpose and name\n+        if (!batch.ErasePurpose(dest) || !batch.EraseName(dest)) {",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "757d6516db56e2732ea77624e66025446cb816a4",
      "original_commit_id": "2d770f6ae88d9ee6f1775e011f241274059fe275",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 2d770f6ae88d9ee6f1775e011f241274059fe275 \"wallet: clean redundancies in DelAddressBook\"\r\n\r\nI'd prefer to have these occur separately so that a distinct error can be logged for each, that way we can discover which operation failed.",
      "created_at": "2024-02-07T19:43:17Z",
      "updated_at": "2024-02-07T19:46:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481997602",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481997602"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482000338",
      "pull_request_review_id": 1868639990,
      "id": 1482000338,
      "node_id": "PRRC_kwDOABII585YVYfS",
      "diff_hunk": "@@ -887,7 +887,7 @@ bool BerkeleyBatch::HasKey(DataStream&& key)\n \n bool BerkeleyBatch::ErasePrefix(Span<const std::byte> prefix)\n {\n-    if (!TxnBegin()) return false;\n+    assert(activeTxn); // because this is a read-write operation, the current db config requires a txn context.",
      "path": "src/wallet/bdb.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "757d6516db56e2732ea77624e66025446cb816a4",
      "original_commit_id": "0dba0b6de03c0c79bb09296b913729ec8eb75aca",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 0dba0b6de03c0c79bb09296b913729ec8eb75aca \"wallet: bdb batch 'ErasePrefix', do not create txn internally\"\r\n\r\nInstead of `assert`ing, I would prefer if this did `if (!Assume(activeTxn)) return false` so we didn't cause nodes to crash if a transaction were missing for whatever reason. `Assume` should still catch this for developers.",
      "created_at": "2024-02-07T19:46:01Z",
      "updated_at": "2024-02-07T19:46:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1482000338",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482000338"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 890,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482126505",
      "pull_request_review_id": 1868847059,
      "id": 1482126505,
      "node_id": "PRRC_kwDOABII585YV3Sp",
      "diff_hunk": "@@ -2396,14 +2397,24 @@ bool CWallet::DelAddressBook(const CTxDestination& address)\n             return false;\n         }\n         // Delete data rows associated with this address\n-        batch.EraseAddressData(address);\n+        if (!batch.EraseAddressData(address)) {\n+            WalletLogPrintf(\"Error: cannot erase address book entry data\\n\");\n+            return false;\n+        }\n+\n+        // Delete purpose and name\n+        if (!batch.ErasePurpose(dest) || !batch.EraseName(dest)) {",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "757d6516db56e2732ea77624e66025446cb816a4",
      "original_commit_id": "2d770f6ae88d9ee6f1775e011f241274059fe275",
      "in_reply_to_id": 1481997602,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> I'd prefer to have these occur separately so that a distinct error can be logged for each, that way we can discover which operation failed.\r\n\r\nSure. Also decoupled it in #26836.",
      "created_at": "2024-02-07T21:35:29Z",
      "updated_at": "2024-02-07T22:38:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1482126505",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482126505"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482179514",
      "pull_request_review_id": 1868847059,
      "id": 1482179514,
      "node_id": "PRRC_kwDOABII585YWEO6",
      "diff_hunk": "@@ -887,7 +887,7 @@ bool BerkeleyBatch::HasKey(DataStream&& key)\n \n bool BerkeleyBatch::ErasePrefix(Span<const std::byte> prefix)\n {\n-    if (!TxnBegin()) return false;\n+    assert(activeTxn); // because this is a read-write operation, the current db config requires a txn context.",
      "path": "src/wallet/bdb.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "757d6516db56e2732ea77624e66025446cb816a4",
      "original_commit_id": "0dba0b6de03c0c79bb09296b913729ec8eb75aca",
      "in_reply_to_id": 1482000338,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Instead of `assert`ing, I would prefer if this did `if (!Assume(activeTxn)) return false` so we didn't cause nodes to crash if a transaction were missing for whatever reason. `Assume` should still catch this for developers.\r\n\r\nThat would be risky in terms of consistency. `BerkeleyBatch::ErasePrefix` traverses the entire db, reading entries one by one, erasing the ones that match the key prefix. If we don't execute this function within a txn context, it's possible that certain records are removed while others remain due to an internal failure during the procedure.\r\n\r\nCurrently, the only function that uses `ErasePrefix()` is `WalletBatch::EraseAddressData`, which is exclusively called from `CWallet::DelAddressBook`, which is modified in the first two commits (thats one of the reasons behind taking those commits from #26836). This prevents any crashing risk.",
      "created_at": "2024-02-07T22:36:08Z",
      "updated_at": "2024-02-07T22:39:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1482179514",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482179514"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 890,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482191573",
      "pull_request_review_id": 1868946380,
      "id": 1482191573,
      "node_id": "PRRC_kwDOABII585YWHLV",
      "diff_hunk": "@@ -887,7 +887,7 @@ bool BerkeleyBatch::HasKey(DataStream&& key)\n \n bool BerkeleyBatch::ErasePrefix(Span<const std::byte> prefix)\n {\n-    if (!TxnBegin()) return false;\n+    assert(activeTxn); // because this is a read-write operation, the current db config requires a txn context.",
      "path": "src/wallet/bdb.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "757d6516db56e2732ea77624e66025446cb816a4",
      "original_commit_id": "0dba0b6de03c0c79bb09296b913729ec8eb75aca",
      "in_reply_to_id": 1482000338,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sure, that's why I suggest using `Assume`, and `return false` if there is no `activeTxn`. The callers of this should already be checking the return value to know whether the records were actually erased from the database.",
      "created_at": "2024-02-07T22:52:30Z",
      "updated_at": "2024-02-07T22:52:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1482191573",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482191573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 890,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1483038171",
      "pull_request_review_id": 1870328563,
      "id": 1483038171,
      "node_id": "PRRC_kwDOABII585YZV3b",
      "diff_hunk": "@@ -887,7 +887,7 @@ bool BerkeleyBatch::HasKey(DataStream&& key)\n \n bool BerkeleyBatch::ErasePrefix(Span<const std::byte> prefix)\n {\n-    if (!TxnBegin()) return false;\n+    assert(activeTxn); // because this is a read-write operation, the current db config requires a txn context.",
      "path": "src/wallet/bdb.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "757d6516db56e2732ea77624e66025446cb816a4",
      "original_commit_id": "0dba0b6de03c0c79bb09296b913729ec8eb75aca",
      "in_reply_to_id": 1482000338,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Sure, that's why I suggest using `Assume`, and `return false` if there is no `activeTxn`. The callers of this should already be checking the return value to know whether the records were actually erased from the database.\r\n\r\nah, I completely skipped the `return false` last night.. sorry. All good, pushed.",
      "created_at": "2024-02-08T14:13:45Z",
      "updated_at": "2024-02-08T14:13:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1483038171",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1483038171"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 890,
      "side": "RIGHT"
    }
  ]
}