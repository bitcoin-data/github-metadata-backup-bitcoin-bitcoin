{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532",
    "id": 2524620285,
    "node_id": "PR_kwDOABII586WeqX9",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32532",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32532.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32532.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/0819a34565d01e241e5a3f884a508472861c96e1",
    "number": 32532,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "refactor,test: extract `DecodePushData` from `GetScriptOp` and `GetLegacySigOpCount`",
    "user": {
      "login": "l0rinc",
      "id": 1841944,
      "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l0rinc",
      "html_url": "https://github.com/l0rinc",
      "followers_url": "https://api.github.com/users/l0rinc/followers",
      "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
      "organizations_url": "https://api.github.com/users/l0rinc/orgs",
      "repos_url": "https://api.github.com/users/l0rinc/repos",
      "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/l0rinc/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "This was originally an optimization PR for `GetSigOpCount` - kept only the refactorings, tests and benchmarks, without any block relaying optimization yet.\r\nThe goal of the PR now is to document the actual behavior better (more descriptive names, parameters, tests, benchmarks, split out sub-functionality).\r\n\r\n### Context\r\n\r\nTest coverage was thin for this code path that suddenly became popular for different reasons (https://github.com/bitcoin/bitcoin/pull/31624 and https://github.com/bitcoin/bitcoin/pull/32521 and https://github.com/bitcoin/bitcoin/pull/32533) highlighting the need for better code coverage.\r\n\r\nThe PR now splits out the common `PUSHDATA` length/bounds reads and error checks and covers its corner cases with unit tests and benchmarks.\r\n\r\n### Testing\r\n\r\n* added unit tests covering every standard script type (and a historical `OP_RETURN ‚Ä¶ OP_CHECKSIG` oddity);\r\n* added fuzz-style test that compares the refactored implementation against the *exact* legacy algorithm on random scripts - also ran it continuously for 25 hours without divergence;\r\n* reindexed to height 897,000 [comparing the outputs of the old and the new implementation](https://gist.github.com/l0rinc/ff6347164b3c502a9643ba7be171860e) without incidents.",
    "labels": [
      {
        "id": 192202000,
        "node_id": "MDU6TGFiZWwxOTIyMDIwMDA=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Consensus",
        "name": "Consensus",
        "color": "009800",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2025-05-16T13:59:35Z",
    "updated_at": "2025-06-06T17:45:07Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "c830a254eed61d9a9de6e8c4b98af9352f4af703",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "l0rinc:l0rinc/short-circuit-known-script-types",
      "ref": "l0rinc/short-circuit-known-script-types",
      "sha": "0819a34565d01e241e5a3f884a508472861c96e1",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 674169038,
        "node_id": "R_kgDOKC8Azg",
        "name": "bitcoin",
        "full_name": "l0rinc/bitcoin",
        "owner": {
          "login": "l0rinc",
          "id": 1841944,
          "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/l0rinc",
          "html_url": "https://github.com/l0rinc",
          "followers_url": "https://api.github.com/users/l0rinc/followers",
          "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
          "organizations_url": "https://api.github.com/users/l0rinc/orgs",
          "repos_url": "https://api.github.com/users/l0rinc/repos",
          "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/l0rinc/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/l0rinc/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/l0rinc/bitcoin",
        "archive_url": "https://api.github.com/repos/l0rinc/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/l0rinc/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/l0rinc/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/l0rinc/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/l0rinc/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/l0rinc/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/l0rinc/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/l0rinc/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/l0rinc/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/l0rinc/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/l0rinc/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/l0rinc/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/l0rinc/bitcoin/events",
        "forks_url": "https://api.github.com/repos/l0rinc/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/l0rinc/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/l0rinc/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/l0rinc/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/l0rinc/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/l0rinc/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/l0rinc/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/l0rinc/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/l0rinc/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/l0rinc/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/l0rinc/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/l0rinc/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/l0rinc/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/l0rinc/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/l0rinc/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/l0rinc/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:l0rinc/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/l0rinc/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/l0rinc/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/l0rinc/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/l0rinc/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/l0rinc/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/l0rinc/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/l0rinc/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/l0rinc/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/l0rinc/bitcoin/hooks",
        "svn_url": "https://github.com/l0rinc/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 262925,
        "default_branch": "master",
        "open_issues_count": 3,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-06-06T17:37:48Z",
        "created_at": "2023-08-03T09:49:12Z",
        "updated_at": "2025-05-28T12:26:34Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "ae024137bda9fe189f4e7ccf26dbaffd44cbbeb6",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37312,
        "stargazers_count": 83999,
        "watchers_count": 83999,
        "size": 283337,
        "default_branch": "master",
        "open_issues_count": 746,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-06-05T13:36:24Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-06-06T16:49:31Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 508,
    "deletions": 201,
    "changed_files": 19,
    "commits": 14,
    "review_comments": 26,
    "comments": 7
  },
  "events": [
    {
      "event": "commented",
      "id": 2886809136,
      "node_id": "IC_kwDOABII586sETYw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2886809136",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-16T13:59:39Z",
      "updated_at": "2025-06-04T18:32:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32532.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [darosior](https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2851775828) |\n| Concept ACK | [tapcrafter](https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2849025458), [ryanofsky](https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2897452412) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32554](https://github.com/bitcoin/bitcoin/pull/32554) (bench: replace embedded raw block with configurable block generator by l0rinc)\n* [#32521](https://github.com/bitcoin/bitcoin/pull/32521) (policy: make pathological transactions packed with legacy sigops non-standard by darosior)\n* [#31989](https://github.com/bitcoin/bitcoin/pull/31989) (BIP-119 (OP_CHECKTEMPLATEVERIFY) (regtest only) by jamesob)\n* [#31682](https://github.com/bitcoin/bitcoin/pull/31682) ([IBD] specialize CheckBlock's input & coinbase checks by l0rinc)\n* [#29060](https://github.com/bitcoin/bitcoin/pull/29060) (Policy: Report reason inputs are non standard by ismaelsadeeq)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2886809136",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17695141109,
      "node_id": "HRFPE_lADOABII58627qjKzwAAAAQetmz1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17695141109",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "432ff7e736942c6dd6fc923300b5fa5f0f94c287",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/432ff7e736942c6dd6fc923300b5fa5f0f94c287",
      "created_at": "2025-05-16T22:37:44Z"
    },
    {
      "event": "reviewed",
      "id": 2849025458,
      "node_id": "PRR_kwDOABII586p0K2y",
      "url": null,
      "actor": null,
      "commit_id": "432ff7e736942c6dd6fc923300b5fa5f0f94c287",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "Concept ACK 432ff7e736942c6dd6fc923300b5fa5f0f94c287.\r\n\r\nCan't fully speak to the correctness of the refactor itself, still brushing up on my C++. So can't give a full ACK but left some questions instead.\r\n\r\n<details>\r\n\r\n<summay>Test protocol</summary>\r\n\r\nNew benchmark test on 2e8a9e17 (first commit of PR, before refactor):\r\n\r\n```\r\n|           ns/sigops |            sigops/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|               50.76 |       19,700,534.44 |    0.5% |      0.01 | `SigOpsBlockBench`\r\n```\r\n\r\n\r\nOn 432ff7e736942c6dd6fc923300b5fa5f0f94c287 (last commit):\r\n\r\n```\r\n|           ns/sigops |            sigops/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|               18.87 |       53,002,534.31 |    0.4% |      0.01 | `SigOpsBlockBench`\r\n```\r\n\r\nI also ran the unit tests a couple of times to excercise the randomized tests in `src/test/sigopcount_tests.cpp`.\r\nNo failures to report.\r\n\r\n</details>",
      "user": {
        "login": "tapcrafter",
        "id": 207358173,
        "node_id": "U_kgDODFwI3Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/207358173?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tapcrafter",
        "html_url": "https://github.com/tapcrafter",
        "followers_url": "https://api.github.com/users/tapcrafter/followers",
        "following_url": "https://api.github.com/users/tapcrafter/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tapcrafter/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tapcrafter/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tapcrafter/subscriptions",
        "organizations_url": "https://api.github.com/users/tapcrafter/orgs",
        "repos_url": "https://api.github.com/users/tapcrafter/repos",
        "events_url": "https://api.github.com/users/tapcrafter/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tapcrafter/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2849025458",
      "submitted_at": "2025-05-18T18:45:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
    },
    {
      "event": "commented",
      "id": 2889730573,
      "node_id": "IC_kwDOABII586sPcoN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2889730573",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T06:08:19Z",
      "updated_at": "2025-05-19T06:08:19Z",
      "author_association": "MEMBER",
      "body": "I can't tell from the pull description, but is there a end-user visible performance difference? If yes, how much?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2889730573",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17711015624,
      "node_id": "HRFPE_lADOABII58627qjKzwAAAAQfqKbI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17711015624",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "bde1fc1289443785e4538c757631d2fa19d5ecd8",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/bde1fc1289443785e4538c757631d2fa19d5ecd8",
      "created_at": "2025-05-19T09:19:01Z"
    },
    {
      "event": "commented",
      "id": 2890294507,
      "node_id": "IC_kwDOABII586sRmTr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2890294507",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T09:25:40Z",
      "updated_at": "2025-05-19T09:25:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the observations @tapcrafter, addressed your concerns in the latest push, adding you as a co-author in one of the commits.\r\n\r\n@maflcko, to clarify the effect on the overall behavior, I slimmed down the `DeserializeAndCheckBlockTest` similarly to https://github.com/bitcoin/bitcoin/pull/32457 and added the results to the PR's description.\r\n\r\n---\r\n\r\nI ran\r\n\r\n```bash\r\ncmake -B build -DBUILD_BENCH=ON -DCMAKE_BUILD_TYPE=Release\r\ncmake --build build -j$(nproc)\r\nbuild/bin/bench_bitcoin -filter='CheckBlockBench' --min-time=10000\r\n```\r\nseveral times before and after the SigOp fast-path.\r\n\r\nTo isolate the remaining hot-spots I also:\r\n* split the former `DeserializeAndCheckBlockTest` into a pure‚Äêserialization (optimized independetly) and a pure `CheckBlock` benchmark;\r\n* switched to block 784,588 (contains every modern script type) - see https://github.com/bitcoin/bitcoin/pull/32457;\r\n* included another related optimization (special-cases the coinbase & duplicate-input checks - https://github.com/bitcoin/bitcoin/pull/31682).\r\n\r\nBefore (ef73758d5bd0ef32749d2cefc475bb84e4e6d11e - bench: measure behavior of a more representative block):\r\n```\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        1,077,514.54 |              928.06 |    0.0% |    8,231,717.91 |    3,867,061.18 |  2.129 |   1,234,943.74 |    2.5% |     11.00 | `CheckBlockBench`\r\n|        1,077,039.60 |              928.47 |    0.1% |    8,231,717.76 |    3,865,853.67 |  2.129 |   1,234,943.80 |    2.5% |     11.01 | `CheckBlockBench`\r\n|        1,077,973.36 |              927.67 |    0.1% |    8,231,717.62 |    3,869,437.50 |  2.127 |   1,234,943.75 |    2.5% |     11.01 | `CheckBlockBench`\r\n```\r\n\r\nBefore (9d719108bef902590aa55bf61f979dbcfa152020 - specialize CheckBlock's input & coinbase checks):\r\n```\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          836,899.54 |            1,194.89 |    0.1% |    6,618,933.87 |    3,003,330.32 |  2.204 |     847,006.84 |    2.4% |     10.77 | `CheckBlockBench`\r\n|          838,135.14 |            1,193.13 |    0.0% |    6,618,933.87 |    3,008,503.94 |  2.200 |     847,006.84 |    2.4% |     10.78 | `CheckBlockBench`\r\n|          835,303.73 |            1,197.17 |    0.1% |    6,618,933.87 |    2,997,539.89 |  2.208 |     847,006.84 |    2.4% |     10.77 | `CheckBlockBench`\r\n```\r\n\r\nAfter (ddc82fdb6fae77ba299104ed03c33ea9dd0e2e05 - script: short-circuit `GetLegacySigOpCount` for known scripts):\r\n```\r\n|            ns/block |             block/s |    err% |       ins/block |       cyc/block |    IPC |      bra/block |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|          753,774.48 |            1,326.66 |    0.0% |    5,224,278.78 |    2,705,172.05 |  1.931 |     597,353.76 |    3.4% |     10.70 | `CheckBlockBench`\r\n|          753,337.59 |            1,327.43 |    0.0% |    5,224,278.78 |    2,704,108.71 |  1.932 |     597,353.76 |    3.4% |     10.70 | `CheckBlockBench`\r\n|          749,374.04 |            1,334.45 |    0.0% |    5,224,278.78 |    2,690,235.39 |  1.942 |     597,353.75 |    3.4% |     10.69 | `CheckBlockBench`\r\n```\r\n\r\n~11.4% additional validation speed-up thanks to short-circuit SigOp counting (the two changes together result in a ~43.7% validation speedup for the given block).\r\nNote that instruction count also dropped from 6,6M to 5.2M, branch executions from 0.8M to 0.6M.\r\n",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2890294507",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532"
    },
    {
      "event": "mentioned",
      "id": 17711133799,
      "node_id": "MEE_lADOABII58627qjKzwAAAAQfqnRn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17711133799",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T09:25:41Z"
    },
    {
      "event": "subscribed",
      "id": 17711133844,
      "node_id": "SE_lADOABII58627qjKzwAAAAQfqnSU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17711133844",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T09:25:41Z"
    },
    {
      "event": "mentioned",
      "id": 17711133873,
      "node_id": "MEE_lADOABII58627qjKzwAAAAQfqnSx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17711133873",
      "actor": {
        "login": "tapcrafter",
        "id": 207358173,
        "node_id": "U_kgDODFwI3Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/207358173?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tapcrafter",
        "html_url": "https://github.com/tapcrafter",
        "followers_url": "https://api.github.com/users/tapcrafter/followers",
        "following_url": "https://api.github.com/users/tapcrafter/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tapcrafter/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tapcrafter/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tapcrafter/subscriptions",
        "organizations_url": "https://api.github.com/users/tapcrafter/orgs",
        "repos_url": "https://api.github.com/users/tapcrafter/repos",
        "events_url": "https://api.github.com/users/tapcrafter/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tapcrafter/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T09:25:41Z"
    },
    {
      "event": "subscribed",
      "id": 17711133888,
      "node_id": "SE_lADOABII58627qjKzwAAAAQfqnTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17711133888",
      "actor": {
        "login": "tapcrafter",
        "id": 207358173,
        "node_id": "U_kgDODFwI3Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/207358173?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tapcrafter",
        "html_url": "https://github.com/tapcrafter",
        "followers_url": "https://api.github.com/users/tapcrafter/followers",
        "following_url": "https://api.github.com/users/tapcrafter/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tapcrafter/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tapcrafter/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tapcrafter/subscriptions",
        "organizations_url": "https://api.github.com/users/tapcrafter/orgs",
        "repos_url": "https://api.github.com/users/tapcrafter/repos",
        "events_url": "https://api.github.com/users/tapcrafter/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tapcrafter/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T09:25:41Z"
    },
    {
      "event": "commented",
      "id": 2890357028,
      "node_id": "IC_kwDOABII586sR1kk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2890357028",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T09:41:57Z",
      "updated_at": "2025-05-19T09:41:57Z",
      "author_association": "MEMBER",
      "body": "Ah, ok. So from extrapolating the previous comment and https://github.com/bitcoin/bitcoin/pull/31682#issuecomment-2606765689, the IBD speedup should be around 1%?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2890357028",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532"
    },
    {
      "event": "reviewed",
      "id": 2850988140,
      "node_id": "PRR_kwDOABII586p7qBs",
      "url": null,
      "actor": null,
      "commit_id": "9e6e6a2ba4efc132810ffae8469334538acd0eb7",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK bde1fc1289443785e4538c757631d2fa19d5ecd8. Seems like this makes code clearer and faster without changing complexity, and adds tests.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2850988140",
      "submitted_at": "2025-05-19T14:30:28Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
    },
    {
      "event": "renamed",
      "id": 17717091425,
      "node_id": "RTE_lADOABII58627qjKzwAAAAQgBVxh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17717091425",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T15:08:13Z",
      "rename": {
        "from": "RFC: script: short-circuit `GetLegacySigOpCount` for known scripts",
        "to": "script: short-circuit `GetLegacySigOpCount` for known scripts"
      }
    },
    {
      "event": "labeled",
      "id": 17717092503,
      "node_id": "LE_lADOABII58627qjKzwAAAAQgBWCX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17717092503",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T15:08:17Z",
      "label": {
        "name": "Consensus",
        "color": "009800"
      }
    },
    {
      "event": "ready_for_review",
      "id": 17717097104,
      "node_id": "RFRE_lADOABII58627qjKzwAAAAQgBXKQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17717097104",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T15:08:31Z"
    },
    {
      "event": "reviewed",
      "id": 2851775828,
      "node_id": "PRR_kwDOABII586p-qVU",
      "url": null,
      "actor": null,
      "commit_id": "bde1fc1289443785e4538c757631d2fa19d5ecd8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "This is a significant refactoring of tricky consensus critical routines that have essentially never been modified since Satoshi wrote them 15 years ago. The exploration is interesting but it seems ill-advised to completely overhaul this critical code for a marginal IBD speedup.\r\n\r\nI feel bad for being stop energy here, but since i have been an advocate for us voicing our opinion instead of just ignoring PRs i'll go and own it. Concept NACK: i don't think the risk-benefit ratio of this change is worth it.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2851775828",
      "submitted_at": "2025-05-19T19:22:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
    },
    {
      "event": "commented",
      "id": 2892128673,
      "node_id": "IC_kwDOABII586sYmGh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2892128673",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-19T19:58:05Z",
      "updated_at": "2025-05-19T19:58:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Might also help to add all the benchmark and test changes and simpler improvements like inlining in a separate PR, so it's a more clear how tricky the sensitive changes here are, and if the sensitive changes are really worth making.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2892128673",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532"
    },
    {
      "event": "convert_to_draft",
      "id": 17734283902,
      "node_id": "CTDE_lADOABII58627qjKzwAAAAQhC7J-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17734283902",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-20T13:15:28Z"
    },
    {
      "event": "labeled",
      "id": 17749911614,
      "node_id": "LE_lADOABII58627qjKzwAAAAQh-ig-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17749911614",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T09:28:30Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17753816052,
      "node_id": "HRFPE_lADOABII58627qjKzwAAAAQiNbv0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17753816052",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "560eed6c6f4dbccb1c6f780663b28f017c31dc13",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/560eed6c6f4dbccb1c6f780663b28f017c31dc13",
      "created_at": "2025-05-21T13:21:50Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17753947152,
      "node_id": "HRFPE_lADOABII58627qjKzwAAAAQiN7wQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17753947152",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "5b11b8706f14e0545f7e07c7c029e24811dc6c9d",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/5b11b8706f14e0545f7e07c7c029e24811dc6c9d",
      "created_at": "2025-05-21T13:28:53Z"
    },
    {
      "event": "renamed",
      "id": 17753966225,
      "node_id": "RTE_lADOABII58627qjKzwAAAAQiOAaR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17753966225",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:29:56Z",
      "rename": {
        "from": "script: short-circuit `GetLegacySigOpCount` for known scripts",
        "to": "refactor: extract `DecodePushData` from `GetScriptOp` and `GetLegacySigOpCount`"
      }
    },
    {
      "event": "review_requested",
      "id": 17754079356,
      "node_id": "RRE_lADOABII58627qjKzwAAAAQiOcB8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754079356",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:36:05Z",
      "requested_reviewer": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 17754080190,
      "node_id": "RRE_lADOABII58627qjKzwAAAAQiOcO-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754080190",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:36:08Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 2898016052,
      "node_id": "IC_kwDOABII586svDc0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2898016052",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:40:45Z",
      "updated_at": "2025-05-21T13:40:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "@ryanofsky, @darosior, thank you for expressing your concerns.\r\nI have removed the optimization part, I understand why that can be considered risky. The new rebase only contains extraction of the common script parts to avoid some work duplication and to help with understanding this part of the codebase better. It's also covered extensively with deterministic and random tests, comparing against fixed values, non-standard scripts, and completely random ones compared against the original implementation. We can reconsider the optimizations if this gets accepted.\r\n\r\nAlso note that the optimizations weren't there for IBD necessarily, but as the `checkblock` bench states:\r\n```\r\n// These are the two major time-sinks which happen after we have fully received\r\n// a block off the wire, but before we can relay the block on to peers using\r\n// compact block relay.\r\n```\r\n",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2898016052",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532"
    },
    {
      "event": "mentioned",
      "id": 17754166491,
      "node_id": "MEE_lADOABII58627qjKzwAAAAQiOxTb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754166491",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:40:46Z"
    },
    {
      "event": "subscribed",
      "id": 17754166520,
      "node_id": "SE_lADOABII58627qjKzwAAAAQiOxT4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754166520",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:40:46Z"
    },
    {
      "event": "mentioned",
      "id": 17754166552,
      "node_id": "MEE_lADOABII58627qjKzwAAAAQiOxUY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754166552",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:40:46Z"
    },
    {
      "event": "subscribed",
      "id": 17754166566,
      "node_id": "SE_lADOABII58627qjKzwAAAAQiOxUm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754166566",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:40:47Z"
    },
    {
      "event": "ready_for_review",
      "id": 17754175966,
      "node_id": "RFRE_lADOABII58627qjKzwAAAAQiOzne",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754175966",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T13:41:17Z"
    },
    {
      "event": "unlabeled",
      "id": 17754714534,
      "node_id": "UNLE_lADOABII58627qjKzwAAAAQiQ3Gm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754714534",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T14:09:31Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unsubscribed",
      "id": 17795020907,
      "node_id": "UE_lADOABII58627qjKzwAAAAQkqnhr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17795020907",
      "actor": {
        "login": "deehochberg",
        "id": 185879065,
        "node_id": "U_kgDOCxRKGQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/185879065?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deehochberg",
        "html_url": "https://github.com/deehochberg",
        "followers_url": "https://api.github.com/users/deehochberg/followers",
        "following_url": "https://api.github.com/users/deehochberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deehochberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deehochberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deehochberg/subscriptions",
        "organizations_url": "https://api.github.com/users/deehochberg/orgs",
        "repos_url": "https://api.github.com/users/deehochberg/repos",
        "events_url": "https://api.github.com/users/deehochberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deehochberg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-23T18:59:28Z"
    },
    {
      "event": "reviewed",
      "id": 2897452412,
      "node_id": "PRR_kwDOABII586ss518",
      "url": null,
      "actor": null,
      "commit_id": "5b11b8706f14e0545f7e07c7c029e24811dc6c9d",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK 5b11b8706f14e0545f7e07c7c029e24811dc6c9d. I haven't finished reviewing but these changes seem very straightforward and the new test and benchmark coverage seems nice. Left some review comments below\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2897452412",
      "submitted_at": "2025-06-04T18:32:11Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
    },
    {
      "event": "convert_to_draft",
      "id": 17988258499,
      "node_id": "CTDE_lADOABII58627qjKzwAAAAQwLwrD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17988258499",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-04T19:42:36Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRmNzVjNWE5NGRlYzM4MjNkZTk1N2VkYWY4ZmRkYzkyNDA0MmNkYjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4f75c5a94dec3823de957edaf8fddc924042cdb6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4f75c5a94dec3823de957edaf8fddc924042cdb6",
      "tree": {
        "sha": "9ab660d83010c82101ee3ecbae2e737ecd6144bd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9ab660d83010c82101ee3ecbae2e737ecd6144bd"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/87ec923d3a7af7b30613174b41c6fb11671df466",
          "sha": "87ec923d3a7af7b30613174b41c6fb11671df466",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/87ec923d3a7af7b30613174b41c6fb11671df466"
        }
      ],
      "message": "bench: measure `CheckBlock` speed separately from serialization\n\nTo make sure the blocks keep their original state, a ResetChecked() was introduced which will reenable all relevant calculations",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T15:08:00Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-01-18T10:43:26Z"
      },
      "sha": "4f75c5a94dec3823de957edaf8fddc924042cdb6"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18026471983,
      "node_id": "HRFPE_lADOABII58627qjKzwAAAAQydiIv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18026471983",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "efb5179d0f02ad2842ebcb074fa71e2fb165c498",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/efb5179d0f02ad2842ebcb074fa71e2fb165c498",
      "created_at": "2025-06-06T17:35:14Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFmNDA3MWViNDg5NTgyNWI1ODYyOGUyNmY3MmY1Njk5NmFhZTY2MjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/af4071eb4895825b58628e26f72f56996aae6621",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/af4071eb4895825b58628e26f72f56996aae6621",
      "tree": {
        "sha": "5fc3c47237ebf984646afb876feb5677976a24a8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5fc3c47237ebf984646afb876feb5677976a24a8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4f75c5a94dec3823de957edaf8fddc924042cdb6",
          "sha": "4f75c5a94dec3823de957edaf8fddc924042cdb6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4f75c5a94dec3823de957edaf8fddc924042cdb6"
        }
      ],
      "message": "bench: measure `SigOpsBlock` speeds separately",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:52Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-01-18T10:43:26Z"
      },
      "sha": "af4071eb4895825b58628e26f72f56996aae6621"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA1YzA2NDUyMTM1NGIwNDRhMjYwYTc4ZmNlZDc0ZTY2ZGZmNzZlNzE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/05c064521354b044a260a78fced74e66dff76e71",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/05c064521354b044a260a78fced74e66dff76e71",
      "tree": {
        "sha": "e88f9f70a89eadc594abdf44ffa3bb7c56d57c78",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e88f9f70a89eadc594abdf44ffa3bb7c56d57c78"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/af4071eb4895825b58628e26f72f56996aae6621",
          "sha": "af4071eb4895825b58628e26f72f56996aae6621",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/af4071eb4895825b58628e26f72f56996aae6621"
        }
      ],
      "message": "refactor: rename `GetSigOpCount` to `GetLegacySigOpCount`\n\nAlso added primitive argument name reminder to the call sites to highlight the meaning of the call.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-05-14T14:05:05Z"
      },
      "sha": "05c064521354b044a260a78fced74e66dff76e71"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU4MDA0YThjYWEyYTk2YzMzMWIwOGM0MDExNTJhMDUyNjcyYjZkYWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/58004a8caa2a96c331b08c401152a052672b6dad",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/58004a8caa2a96c331b08c401152a052672b6dad",
      "tree": {
        "sha": "3da345ad99511c617b756b92e0af1887af9d9bdf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3da345ad99511c617b756b92e0af1887af9d9bdf"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/05c064521354b044a260a78fced74e66dff76e71",
          "sha": "05c064521354b044a260a78fced74e66dff76e71",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/05c064521354b044a260a78fced74e66dff76e71"
        }
      ],
      "message": "refactor: moved the script-hash-size constants to `script.h`\n\nThis will be needed in upcoming commit, to be able to use previously defined constants in `script.h`.\nI made sure to check that there were no other constants with the same names.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:15:17Z"
      },
      "sha": "58004a8caa2a96c331b08c401152a052672b6dad"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM1YjE5Y2M0MzU1OWE2YjMwOThlYzNmY2UyMmYxYTM0M2ZlOGY2YzQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/35b19cc43559a6b3098ec3fce22f1a343fe8f6c4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/35b19cc43559a6b3098ec3fce22f1a343fe8f6c4",
      "tree": {
        "sha": "37da32d4e9117835451d02f88ff91db1e123df6e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/37da32d4e9117835451d02f88ff91db1e123df6e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/58004a8caa2a96c331b08c401152a052672b6dad",
          "sha": "58004a8caa2a96c331b08c401152a052672b6dad",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/58004a8caa2a96c331b08c401152a052672b6dad"
        }
      ],
      "message": "refactor: pull `IsPayToScriptHash` to header\n\nMoved the implementation to the header (implicitly inline + noexcept), removed redundant `this` and parenthesis, used descriptive `front()`/`back()` methods and changed the `0x14` magic constant to descriptive `WITNESS_V0_KEYHASH_SIZE`.\nSee: https://learnmeabitcoin.com/technical/script/p2sh/#scriptpubkey",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:25:30Z"
      },
      "sha": "35b19cc43559a6b3098ec3fce22f1a343fe8f6c4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE3NmM5ZDA1YmE3NDQwYzIwMTkzOGY1MTM0OGNkMDAxOTZjNGZhMmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/176c9d05ba7440c201938f51348cd00196c4fa2e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/176c9d05ba7440c201938f51348cd00196c4fa2e",
      "tree": {
        "sha": "41aae9667554afba5c7c52248090465b2beeee8f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/41aae9667554afba5c7c52248090465b2beeee8f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/35b19cc43559a6b3098ec3fce22f1a343fe8f6c4",
          "sha": "35b19cc43559a6b3098ec3fce22f1a343fe8f6c4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/35b19cc43559a6b3098ec3fce22f1a343fe8f6c4"
        }
      ],
      "message": "refactor: pull `IsPayToWitnessScriptHash` to header\n\nMoved the implementation to the header (implicitly inline + noexcept), removed redundant `this` and parenthesis, used descriptive `front()` method and changed the `0x20` magic constant to descriptive `WITNESS_V0_SCRIPTHASH_SIZE`.\nSee: https://learnmeabitcoin.com/technical/script/p2wsh/#scriptpubkey",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:26:16Z"
      },
      "sha": "176c9d05ba7440c201938f51348cd00196c4fa2e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYyNWEwOWVkNjJmYzhlODUyNzlmMjE4OWViNTIyZGQ4NWMwZGY1MjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/625a09ed62fc8e85279f2189eb522dd85c0df521",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/625a09ed62fc8e85279f2189eb522dd85c0df521",
      "tree": {
        "sha": "a6879daa9cb88538d9afb2aa6d567be8a598757a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a6879daa9cb88538d9afb2aa6d567be8a598757a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/176c9d05ba7440c201938f51348cd00196c4fa2e",
          "sha": "176c9d05ba7440c201938f51348cd00196c4fa2e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/176c9d05ba7440c201938f51348cd00196c4fa2e"
        }
      ],
      "message": "refactor: pull `IsPayToAnchor` to header\n\nMoved the implementation to the header (implicitly inline + noexcept), removed redundant `this` and parenthesis, used descriptive `front()`/`back() methods.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:30:35Z"
      },
      "sha": "625a09ed62fc8e85279f2189eb522dd85c0df521"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDcyMjE3MGUwYjQ4NTgzNzY3MDg3NjVhMmZiMjBlZGE5MjdhZTQ1ZWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/722170e0b4858376708765a2fb20eda927ae45eb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/722170e0b4858376708765a2fb20eda927ae45eb",
      "tree": {
        "sha": "76b11730c66942e21bfe7105b31ad5f8b31dcdee",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/76b11730c66942e21bfe7105b31ad5f8b31dcdee"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/625a09ed62fc8e85279f2189eb522dd85c0df521",
          "sha": "625a09ed62fc8e85279f2189eb522dd85c0df521",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/625a09ed62fc8e85279f2189eb522dd85c0df521"
        }
      ],
      "message": "refactor: pull `IsPayToTaproot` to header\n\nMoved the implementation to the header (implicitly inline + noexcept), removed redundant `this` and parenthesis, used descriptive `front()` method and changed the `0x20` magic constant to descriptive `WITNESS_V1_TAPROOT_SIZE`.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:31:25Z"
      },
      "sha": "722170e0b4858376708765a2fb20eda927ae45eb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYxZjhkYTczMjlmMTFlY2NlNzAxZmE1OTQ2MThiZDYzNTRjMzY4Yjg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f1f8da7329f11ecce701fa594618bd6354c368b8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f1f8da7329f11ecce701fa594618bd6354c368b8",
      "tree": {
        "sha": "e2a581c9afecbc323e7c34a16b3b8f2c838ec028",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e2a581c9afecbc323e7c34a16b3b8f2c838ec028"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/722170e0b4858376708765a2fb20eda927ae45eb",
          "sha": "722170e0b4858376708765a2fb20eda927ae45eb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/722170e0b4858376708765a2fb20eda927ae45eb"
        }
      ],
      "message": "refactor: add `IsPayToPubKeyHash` helper to script.h\n\nThe usages in `compressor.cpp` and `solver.cpp` were also updated to use the new methods.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:16:19Z"
      },
      "sha": "f1f8da7329f11ecce701fa594618bd6354c368b8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ2MDJlYjc0M2U4YzRiNDBiYjUxYjc3YzcxMGFiYWM2YzQ2ZmMyOTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4602eb743e8c4b40bb51b77c710abac6c46fc292",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4602eb743e8c4b40bb51b77c710abac6c46fc292",
      "tree": {
        "sha": "eb9ee29080f0522ec8552ec18aac78c1dbfc42f3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/eb9ee29080f0522ec8552ec18aac78c1dbfc42f3"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f1f8da7329f11ecce701fa594618bd6354c368b8",
          "sha": "f1f8da7329f11ecce701fa594618bd6354c368b8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f1f8da7329f11ecce701fa594618bd6354c368b8"
        }
      ],
      "message": "refactor: add `IsCompressedPayToPubKey` helper to script.h\n\nThe usages in `compressor.cpp` and `solver.cpp` were also updated to use the new methods.\nNote that compressor has additional checks as well, which are not properly exercised by the `compressed_p2pk` unit test.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:19:53Z"
      },
      "sha": "4602eb743e8c4b40bb51b77c710abac6c46fc292"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDMwYzY5OGM5MTJhOWQ4N2M3MmQ1NmJiZjE1N2NmNzZhZmY1NzcxMWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/30c698c912a9d87c72d56bbf157cf76aff57711e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/30c698c912a9d87c72d56bbf157cf76aff57711e",
      "tree": {
        "sha": "921641dbfbe585ad04abac1efc5e73a547300a87",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/921641dbfbe585ad04abac1efc5e73a547300a87"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4602eb743e8c4b40bb51b77c710abac6c46fc292",
          "sha": "4602eb743e8c4b40bb51b77c710abac6c46fc292",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4602eb743e8c4b40bb51b77c710abac6c46fc292"
        }
      ],
      "message": "refactor: add `IsUncompressedPayToPubKey` helper to script.h\n\nThe usages in `compressor.cpp` and `solver.cpp` were also updated to use the new methods.\nNote that compressor has additional checks as well, which are not properly exercised by the `compressed_p2pk` unit test.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:20:02Z"
      },
      "sha": "30c698c912a9d87c72d56bbf157cf76aff57711e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGIzZDAyODY5MWUxZTNmZDY0NGM2NTdjZWQxZjcxMThlMGFkNTUyNGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b3d028691e1e3fd644c657ced1f7118e0ad5524a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b3d028691e1e3fd644c657ced1f7118e0ad5524a",
      "tree": {
        "sha": "987dea0bac9a69050f1305218b0cce02b4ae3d9d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/987dea0bac9a69050f1305218b0cce02b4ae3d9d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/30c698c912a9d87c72d56bbf157cf76aff57711e",
          "sha": "30c698c912a9d87c72d56bbf157cf76aff57711e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/30c698c912a9d87c72d56bbf157cf76aff57711e"
        }
      ],
      "message": "refactor: add `IsPayToWitnessPubKeyHash` helper to script.h\n\nThe usages in `compressor.cpp` were also updated to use the new methods.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:21:43Z"
      },
      "sha": "b3d028691e1e3fd644c657ced1f7118e0ad5524a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNiZGQ1NjE1MWUzODQ5ZDFmNjY5NDFkOTI0YmFlMTkwY2QzOGIzMjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cbdd56151e3849d1f66941d924bae190cd38b322",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cbdd56151e3849d1f66941d924bae190cd38b322",
      "tree": {
        "sha": "b3b18002b0777fcd642403c3bdf0cb5b508efde3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b3b18002b0777fcd642403c3bdf0cb5b508efde3"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b3d028691e1e3fd644c657ced1f7118e0ad5524a",
          "sha": "b3d028691e1e3fd644c657ced1f7118e0ad5524a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b3d028691e1e3fd644c657ced1f7118e0ad5524a"
        }
      ],
      "message": "test: add `SigOpCount` edge‚Äëcases & known‚Äëtemplate coverage\n\n* `GetLegacySigOpCountErrors` feeds malformed PUSHDATA sequences to confirm the parser never crashes and still counts sig‚Äëops that appear before the error.\n* `GetLegacySigOpCountKnownTemplates` asserts the expected legacy/accurate sig‚Äëop totals for all common known script templates (P2PKH, P2SH, P2WPKH/WSH, P2TR, compressed & uncompressed P2PK, OP_RETURN, multisig).",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-05-14T14:41:02Z"
      },
      "sha": "cbdd56151e3849d1f66941d924bae190cd38b322"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA4MTlhMzQ1NjVkMDFlMjQxZTVhM2Y4ODRhNTA4NDcyODYxYzk2ZTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0819a34565d01e241e5a3f884a508472861c96e1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0819a34565d01e241e5a3f884a508472861c96e1",
      "tree": {
        "sha": "b795f3e93cf43c6e09b05ccea02a651a5ad7be34",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b795f3e93cf43c6e09b05ccea02a651a5ad7be34"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cbdd56151e3849d1f66941d924bae190cd38b322",
          "sha": "cbdd56151e3849d1f66941d924bae190cd38b322",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cbdd56151e3849d1f66941d924bae190cd38b322"
        }
      ],
      "message": "refactor: extract `DecodePushData` from `GetScriptOp` and use it in `GetLegacySigOpCount` as well\n\nIntroduce helper `DecodePushData` that parses the size prefixes, checks bounds, and returns size_bytes & data_bytes - or error on truncation.\n\nTo make absolutely sure it's just a refactor, a new unit test was added which asserts the refactored `GetLegacySigOpCount` exactly matches the previous algorithm.",
      "committer": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-06T17:36:54Z"
      },
      "author": {
        "name": "L≈ërinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-05-14T16:36:22Z"
      },
      "sha": "0819a34565d01e241e5a3f884a508472861c96e1"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18026503835,
      "node_id": "HRFPE_lADOABII58627qjKzwAAAAQydp6b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18026503835",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/0819a34565d01e241e5a3f884a508472861c96e1",
      "created_at": "2025-06-06T17:37:49Z"
    },
    {
      "event": "labeled",
      "id": 18026508335,
      "node_id": "LE_lADOABII58627qjKzwAAAAQydrAv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18026508335",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-06T17:38:11Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2949978349,
      "node_id": "IC_kwDOABII586v1Rjt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2949978349",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-06T17:38:13Z",
      "updated_at": "2025-06-06T17:38:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nüöß At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/43633911782</sub>\n<sub>LLM reason (‚ú® experimental): The CI failure is due to a lint check failure caused by improper include syntax in source files.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2949978349",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32532"
    },
    {
      "event": "reviewed",
      "id": 2904289512,
      "node_id": "PRR_kwDOABII586tG_Do",
      "url": null,
      "actor": null,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the reviews, addressed more of the concerns in smaller commits, even more tests: https://github.com/bitcoin/bitcoin/compare/5b11b8706f14e0545f7e07c7c029e24811dc6c9d..0819a34565d01e241e5a3f884a508472861c96e1\r\n\r\n@darosior, this change isn't about IBD, it was mostly about block connect time optimization originally - now it's rather meant as a cleanup and flooding it with tests and benchmarks to enable optimizations in follow-ups.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2904289512",
      "submitted_at": "2025-06-06T17:39:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
    },
    {
      "event": "reviewed",
      "id": 2905610204,
      "node_id": "PRR_kwDOABII586tMBfc",
      "url": null,
      "actor": null,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the reviews, addressed more of the concerns in smaller commits, even more tests: https://github.com/bitcoin/bitcoin/compare/5b11b8706f14e0545f7e07c7c029e24811dc6c9d..0819a34565d01e241e5a3f884a508472861c96e1\r\n\r\n@darosior, this change isn't about IBD, it was mostly about block connect time optimization originally - now it's rather meant as a cleanup and flooding it with tests and benchmarks to enable optimizations in follow-ups.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#pullrequestreview-2905610204",
      "submitted_at": "2025-06-06T17:39:49Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
    },
    {
      "event": "renamed",
      "id": 18026573014,
      "node_id": "RTE_lADOABII58627qjKzwAAAAQyd6zW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18026573014",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-06T17:43:40Z",
      "rename": {
        "from": "refactor: extract `DecodePushData` from `GetScriptOp` and `GetLegacySigOpCount`",
        "to": "refactor,test: extract `DecodePushData` from `GetScriptOp` and `GetLegacySigOpCount`"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094559241",
      "pull_request_review_id": 2849025458,
      "id": 2094559241,
      "node_id": "PRRC_kwDOABII58582HAJ",
      "diff_hunk": "@@ -30,17 +30,16 @@ BOOST_FIXTURE_TEST_SUITE(sigopcount_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(GetSigOpCount)\n {\n-    // Test CScript::GetSigOpCount()\n     CScript s1;\n-    BOOST_CHECK_EQUAL(s1.GetSigOpCount(false), 0U);\n-    BOOST_CHECK_EQUAL(s1.GetSigOpCount(true), 0U);\n+    BOOST_CHECK_EQUAL(s1.GetLegacySigOpCount(/*fAccurate=*/false), 0U);",
      "path": "src/test/sigopcount_tests.cpp",
      "position": 175,
      "original_position": 8,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "3248d025cc66e367aba0e00c122926fe694d8dc1",
      "in_reply_to_id": null,
      "user": {
        "login": "tapcrafter",
        "id": 207358173,
        "node_id": "U_kgDODFwI3Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/207358173?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tapcrafter",
        "html_url": "https://github.com/tapcrafter",
        "followers_url": "https://api.github.com/users/tapcrafter/followers",
        "following_url": "https://api.github.com/users/tapcrafter/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tapcrafter/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tapcrafter/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tapcrafter/subscriptions",
        "organizations_url": "https://api.github.com/users/tapcrafter/orgs",
        "repos_url": "https://api.github.com/users/tapcrafter/repos",
        "events_url": "https://api.github.com/users/tapcrafter/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tapcrafter/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Should the test case (`BOOST_AUTO_TEST_CASE(GetSigOpCount)`) also be renamed?",
      "created_at": "2025-05-18T15:32:50Z",
      "updated_at": "2025-05-18T18:45:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2094559241",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094559241"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 192,
      "original_line": 192,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094560461",
      "pull_request_review_id": 2849025458,
      "id": 2094560461,
      "node_id": "PRRC_kwDOABII58582HTN",
      "diff_hunk": "@@ -1501,7 +1501,7 @@ def test_spenders(self, node, spenders, input_counts):\n                     tx.vout[-1].nValue = random.randint(DUST_LIMIT, in_value)\n                 in_value -= tx.vout[-1].nValue\n                 tx.vout[-1].scriptPubKey = random.choice(host_spks)\n-                sigops_weight += CScript(tx.vout[-1].scriptPubKey).GetSigOpCount(False) * WITNESS_SCALE_FACTOR\n+                sigops_weight += CScript(tx.vout[-1].scriptPubKey).GetLegacySigOpCount(False) * WITNESS_SCALE_FACTOR",
      "path": "test/functional/feature_taproot.py",
      "position": null,
      "original_position": 5,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "3248d025cc66e367aba0e00c122926fe694d8dc1",
      "in_reply_to_id": null,
      "user": {
        "login": "tapcrafter",
        "id": 207358173,
        "node_id": "U_kgDODFwI3Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/207358173?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tapcrafter",
        "html_url": "https://github.com/tapcrafter",
        "followers_url": "https://api.github.com/users/tapcrafter/followers",
        "following_url": "https://api.github.com/users/tapcrafter/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tapcrafter/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tapcrafter/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tapcrafter/subscriptions",
        "organizations_url": "https://api.github.com/users/tapcrafter/orgs",
        "repos_url": "https://api.github.com/users/tapcrafter/repos",
        "events_url": "https://api.github.com/users/tapcrafter/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tapcrafter/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Can we add `fAccurate=False` here?",
      "created_at": "2025-05-18T15:39:23Z",
      "updated_at": "2025-05-18T18:45:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2094560461",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094560461"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1504,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094593425",
      "pull_request_review_id": 2849025458,
      "id": 2094593425,
      "node_id": "PRRC_kwDOABII58582PWR",
      "diff_hunk": "@@ -552,8 +553,59 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == 0x14 &&",
      "path": "src/script/script.h",
      "position": null,
      "original_position": 19,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "fcc418de426f32e8c366c182950d4acbb9e7556b",
      "in_reply_to_id": null,
      "user": {
        "login": "tapcrafter",
        "id": 207358173,
        "node_id": "U_kgDODFwI3Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/207358173?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tapcrafter",
        "html_url": "https://github.com/tapcrafter",
        "followers_url": "https://api.github.com/users/tapcrafter/followers",
        "following_url": "https://api.github.com/users/tapcrafter/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tapcrafter/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tapcrafter/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tapcrafter/subscriptions",
        "organizations_url": "https://api.github.com/users/tapcrafter/orgs",
        "repos_url": "https://api.github.com/users/tapcrafter/repos",
        "events_url": "https://api.github.com/users/tapcrafter/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tapcrafter/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Not sure if we can include `interpreter.h` here, but if yes, we could use `WITNESS_V0_KEYHASH_SIZE`. And the other constants too, for extra clarity (`WITNESS_V0_SCRIPTHASH_SIZE = 32`, `WITNESS_V1_TAPROOT_SIZE = 32`).",
      "created_at": "2025-05-18T18:17:21Z",
      "updated_at": "2025-05-18T18:45:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2094593425",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094593425"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 561,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094594352",
      "pull_request_review_id": 2849025458,
      "id": 2094594352,
      "node_id": "PRRC_kwDOABII58582Pkw",
      "diff_hunk": "@@ -552,8 +553,59 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == 0x14 &&\n+               (*this)[23] == OP_EQUALVERIFY &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsPayToScriptHash() const noexcept\n+    {\n+        return size() == 23 &&\n+               front() == OP_HASH160 &&\n+               (*this)[1] == 0x14 &&\n+               back() == OP_EQUAL;\n+    }\n+\n+    bool IsPayToWitnessPubKeyHash() const noexcept\n+    {\n+        return size() == 22 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x14;\n+    }\n+\n+    bool IsPayToTaproot() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_1 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsPayToWitnessScriptHash() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsCompressedPayToPubKey() const noexcept",
      "path": "src/script/script.h",
      "position": 107,
      "original_position": 53,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "fcc418de426f32e8c366c182950d4acbb9e7556b",
      "in_reply_to_id": null,
      "user": {
        "login": "tapcrafter",
        "id": 207358173,
        "node_id": "U_kgDODFwI3Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/207358173?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tapcrafter",
        "html_url": "https://github.com/tapcrafter",
        "followers_url": "https://api.github.com/users/tapcrafter/followers",
        "following_url": "https://api.github.com/users/tapcrafter/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tapcrafter/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tapcrafter/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tapcrafter/subscriptions",
        "organizations_url": "https://api.github.com/users/tapcrafter/orgs",
        "repos_url": "https://api.github.com/users/tapcrafter/repos",
        "events_url": "https://api.github.com/users/tapcrafter/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tapcrafter/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Looks like this check omits the `&& (script[1] == 0x02 || script[1] == 0x03)` part that was in the original `IsToPubKey` function. Not sure if this is on purpose?",
      "created_at": "2025-05-18T18:21:58Z",
      "updated_at": "2025-05-18T18:45:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2094594352",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094594352"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 612,
      "original_line": 612,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094594388",
      "pull_request_review_id": 2849025458,
      "id": 2094594388,
      "node_id": "PRRC_kwDOABII58582PlU",
      "diff_hunk": "@@ -552,8 +553,59 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == 0x14 &&\n+               (*this)[23] == OP_EQUALVERIFY &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsPayToScriptHash() const noexcept\n+    {\n+        return size() == 23 &&\n+               front() == OP_HASH160 &&\n+               (*this)[1] == 0x14 &&\n+               back() == OP_EQUAL;\n+    }\n+\n+    bool IsPayToWitnessPubKeyHash() const noexcept\n+    {\n+        return size() == 22 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x14;\n+    }\n+\n+    bool IsPayToTaproot() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_1 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsPayToWitnessScriptHash() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsCompressedPayToPubKey() const noexcept\n+    {\n+        return size() == CPubKey::COMPRESSED_SIZE + 2 &&\n+               front() == CPubKey::COMPRESSED_SIZE &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsUncompressedPayToPubKey() const noexcept",
      "path": "src/script/script.h",
      "position": 114,
      "original_position": 60,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "fcc418de426f32e8c366c182950d4acbb9e7556b",
      "in_reply_to_id": null,
      "user": {
        "login": "tapcrafter",
        "id": 207358173,
        "node_id": "U_kgDODFwI3Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/207358173?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tapcrafter",
        "html_url": "https://github.com/tapcrafter",
        "followers_url": "https://api.github.com/users/tapcrafter/followers",
        "following_url": "https://api.github.com/users/tapcrafter/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tapcrafter/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tapcrafter/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tapcrafter/subscriptions",
        "organizations_url": "https://api.github.com/users/tapcrafter/orgs",
        "repos_url": "https://api.github.com/users/tapcrafter/repos",
        "events_url": "https://api.github.com/users/tapcrafter/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tapcrafter/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Same here, the original had the additional condition `&& script[1] == 0x04`.",
      "created_at": "2025-05-18T18:22:12Z",
      "updated_at": "2025-05-18T18:45:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2094594388",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2094594388"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 619,
      "original_line": 619,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258063",
      "pull_request_review_id": 2850050345,
      "id": 2095258063,
      "node_id": "PRRC_kwDOABII58584xnP",
      "diff_hunk": "@@ -30,17 +30,16 @@ BOOST_FIXTURE_TEST_SUITE(sigopcount_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(GetSigOpCount)\n {\n-    // Test CScript::GetSigOpCount()\n     CScript s1;\n-    BOOST_CHECK_EQUAL(s1.GetSigOpCount(false), 0U);\n-    BOOST_CHECK_EQUAL(s1.GetSigOpCount(true), 0U);\n+    BOOST_CHECK_EQUAL(s1.GetLegacySigOpCount(/*fAccurate=*/false), 0U);",
      "path": "src/test/sigopcount_tests.cpp",
      "position": 175,
      "original_position": 8,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "3248d025cc66e367aba0e00c122926fe694d8dc1",
      "in_reply_to_id": 2094559241,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It exercises both `GetSigOpCount` and `GetLegacySigOpCount`, so I kept it.\r\nBut the new tests can indeed be renamed, thanks!",
      "created_at": "2025-05-19T09:19:01Z",
      "updated_at": "2025-05-19T09:19:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2095258063",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258063"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 192,
      "original_line": 192,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258155",
      "pull_request_review_id": 2850050500,
      "id": 2095258155,
      "node_id": "PRRC_kwDOABII58584xor",
      "diff_hunk": "@@ -1501,7 +1501,7 @@ def test_spenders(self, node, spenders, input_counts):\n                     tx.vout[-1].nValue = random.randint(DUST_LIMIT, in_value)\n                 in_value -= tx.vout[-1].nValue\n                 tx.vout[-1].scriptPubKey = random.choice(host_spks)\n-                sigops_weight += CScript(tx.vout[-1].scriptPubKey).GetSigOpCount(False) * WITNESS_SCALE_FACTOR\n+                sigops_weight += CScript(tx.vout[-1].scriptPubKey).GetLegacySigOpCount(False) * WITNESS_SCALE_FACTOR",
      "path": "test/functional/feature_taproot.py",
      "position": null,
      "original_position": 5,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "3248d025cc66e367aba0e00c122926fe694d8dc1",
      "in_reply_to_id": 2094560461,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Indeed, added, thanks.",
      "created_at": "2025-05-19T09:19:04Z",
      "updated_at": "2025-05-19T09:19:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2095258155",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258155"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1504,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258344",
      "pull_request_review_id": 2850050808,
      "id": 2095258344,
      "node_id": "PRRC_kwDOABII58584xro",
      "diff_hunk": "@@ -552,8 +553,59 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == 0x14 &&",
      "path": "src/script/script.h",
      "position": null,
      "original_position": 19,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "fcc418de426f32e8c366c182950d4acbb9e7556b",
      "in_reply_to_id": 2094593425,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I have tried including `interpreter.h` before, but it results in ugly weird compiler mess.\r\nBut it seems we can move those constant over to `script.h` instead - done, added you as a co-author.",
      "created_at": "2025-05-19T09:19:10Z",
      "updated_at": "2025-05-19T09:19:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2095258344",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258344"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 561,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258456",
      "pull_request_review_id": 2850050969,
      "id": 2095258456,
      "node_id": "PRRC_kwDOABII58584xtY",
      "diff_hunk": "@@ -552,8 +553,59 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == 0x14 &&\n+               (*this)[23] == OP_EQUALVERIFY &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsPayToScriptHash() const noexcept\n+    {\n+        return size() == 23 &&\n+               front() == OP_HASH160 &&\n+               (*this)[1] == 0x14 &&\n+               back() == OP_EQUAL;\n+    }\n+\n+    bool IsPayToWitnessPubKeyHash() const noexcept\n+    {\n+        return size() == 22 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x14;\n+    }\n+\n+    bool IsPayToTaproot() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_1 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsPayToWitnessScriptHash() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsCompressedPayToPubKey() const noexcept",
      "path": "src/script/script.h",
      "position": 107,
      "original_position": 53,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "fcc418de426f32e8c366c182950d4acbb9e7556b",
      "in_reply_to_id": 2094594352,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I took these definitions from `solver.cpp` - the point here is not necessarily to fully validate the internal structure of the script templates, but rather to check if it follows a general template's layout (opcode, followed by a version, followed by a hash, etc). Validating the existing versions is done in other places, it's not important for e.g. SigOp count. If you think I'm mistaken here, please let me know.",
      "created_at": "2025-05-19T09:19:13Z",
      "updated_at": "2025-05-19T09:19:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2095258456",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258456"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 612,
      "original_line": 612,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258535",
      "pull_request_review_id": 2850051137,
      "id": 2095258535,
      "node_id": "PRRC_kwDOABII58584xun",
      "diff_hunk": "@@ -552,8 +553,59 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == 0x14 &&\n+               (*this)[23] == OP_EQUALVERIFY &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsPayToScriptHash() const noexcept\n+    {\n+        return size() == 23 &&\n+               front() == OP_HASH160 &&\n+               (*this)[1] == 0x14 &&\n+               back() == OP_EQUAL;\n+    }\n+\n+    bool IsPayToWitnessPubKeyHash() const noexcept\n+    {\n+        return size() == 22 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x14;\n+    }\n+\n+    bool IsPayToTaproot() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_1 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsPayToWitnessScriptHash() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsCompressedPayToPubKey() const noexcept\n+    {\n+        return size() == CPubKey::COMPRESSED_SIZE + 2 &&\n+               front() == CPubKey::COMPRESSED_SIZE &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsUncompressedPayToPubKey() const noexcept",
      "path": "src/script/script.h",
      "position": 114,
      "original_position": 60,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "fcc418de426f32e8c366c182950d4acbb9e7556b",
      "in_reply_to_id": 2094594388,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This wasn't checked in `MatchPayToPubkey` either.",
      "created_at": "2025-05-19T09:19:17Z",
      "updated_at": "2025-05-19T09:19:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2095258535",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2095258535"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 619,
      "original_line": 619,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127041222",
      "pull_request_review_id": 2897452412,
      "id": 2127041222,
      "node_id": "PRRC_kwDOABII585-yBLG",
      "diff_hunk": "@@ -39,26 +39,18 @@ static void DeserializeBlockTest(benchmark::Bench& bench)\n     });\n }\n \n-static void DeserializeAndCheckBlockTest(benchmark::Bench& bench)\n+static void CheckBlockBench(benchmark::Bench& bench)\n {\n-    DataStream stream(benchmark::data::block413567);\n-    std::byte a{0};\n-    stream.write({&a, 1}); // Prevent compaction\n-\n-    ArgsManager bench_args;\n-    const auto chainParams = CreateChainParams(bench_args, ChainType::MAIN);\n-\n+    CBlock block;\n+    DataStream(benchmark::data::block413567) >> TX_WITH_WITNESS(block);\n+    const auto chainParams = CreateChainParams(ArgsManager{}, ChainType::MAIN);\n     bench.unit(\"block\").run([&] {\n-        CBlock block; // Note that CBlock caches its checked state, so we need to recreate it here\n-        stream >> TX_WITH_WITNESS(block);\n-        bool rewound = stream.Rewind(benchmark::data::block413567.size());\n-        assert(rewound);\n-\n+        block.fChecked = block.m_checked_witness_commitment = block.m_checked_merkle_root = false; // Reset the cached state",
      "path": "src/bench/checkblock.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "f7b161ba72ee4b219f9ccae50ee350eb1092cd07",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"bench: measure `CheckBlock` speed separately from serialization\" (f7b161ba72ee4b219f9ccae50ee350eb1092cd07)\r\n\r\nIt seem a bit fragile to set these flags individually far away from the CBlock definition, because more flags could be added and the benchmark could show results that are not meaningful. Might be good to to add a `ResetChecked` or similar method to the class definition and call it here instead.",
      "created_at": "2025-06-04T16:50:58Z",
      "updated_at": "2025-06-04T18:32:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2127041222",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127041222"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 48,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127057166",
      "pull_request_review_id": 2897452412,
      "id": 2127057166,
      "node_id": "PRRC_kwDOABII585-yFEO",
      "diff_hunk": "@@ -52,5 +52,32 @@ static void CheckBlockBench(benchmark::Bench& bench)\n     });\n }\n \n+static void SigOpsBlockBench(benchmark::Bench& bench)\n+{\n+    CBlock block;\n+    DataStream(benchmark::data::block413567) >> TX_WITH_WITNESS(block);\n+\n+    auto GetLegacySigOpCount{[](const CTransaction& tx) {\n+        unsigned int nSigOps{0};\n+        for (const auto& txin : tx.vin) {\n+            nSigOps += txin.scriptSig.GetSigOpCount(/*fAccurate=*/false);\n+        }\n+        for (const auto& txout : tx.vout) {\n+            nSigOps += txout.scriptPubKey.GetSigOpCount(/*fAccurate=*/false);\n+        }\n+        return nSigOps;\n+    }};\n+\n+    auto expected_sigops{0};\n+    for (const auto& tx : block.vtx) expected_sigops += GetLegacySigOpCount(*tx);",
      "path": "src/bench/checkblock.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "1e614fb9daa1baf1cef37d66ff30179a174ced99",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"bench: measure `SigOpsBlock` speeds separately\" (1e614fb9daa1baf1cef37d66ff30179a174ced99)\r\n\r\nNot sure but would it maybe make sense for the GetLegacySigOpCount to take a block instead of transaction to deduplicate code running before and during the benchmark and make sure it is consistent?\r\n\r\nAlso it seems like this duplicating the [tx_verify](https://github.com/bitcoin/bitcoin/blob/a5e98dc3ae63fe8ee689917db440954206893a9f/src/consensus/tx_verify.cpp#L112) function. Might be good to explain in the commit message if this intentional.",
      "created_at": "2025-06-04T17:00:47Z",
      "updated_at": "2025-06-04T18:32:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2127057166",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127057166"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 72,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127115488",
      "pull_request_review_id": 2897452412,
      "id": 2127115488,
      "node_id": "PRRC_kwDOABII585-yTTg",
      "diff_hunk": "@@ -552,11 +558,60 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n-    bool IsWitnessProgram(int& version, std::vector<unsigned char>& program) const;\n+    bool IsPayToPubKeyHash() const noexcept",
      "path": "src/script/script.h",
      "position": 67,
      "original_position": 27,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "c87c7b02796d83f5c4d8a7472a2cd13df30e6a05",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"refactor: add extra-fast checks for all standard script types\" (c87c7b02796d83f5c4d8a7472a2cd13df30e6a05)\r\n\r\nThis change seems all right but I'd find it much easier to review if it could be split up to move just one `CScript::Is*` method per-commit. Otherwise it is easy to confuse the different method names and bodies because they look very similar, and verifying the c87c7b02796d83f5c4d8a7472a2cd13df30e6a05 diff requires jumping around and searching for one method at a time instead of being able to read sequentially.",
      "created_at": "2025-06-04T17:38:21Z",
      "updated_at": "2025-06-04T18:32:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2127115488",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127115488"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 572,
      "original_line": 572,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127176949",
      "pull_request_review_id": 2897452412,
      "id": 2127176949,
      "node_id": "PRRC_kwDOABII585-yiT1",
      "diff_hunk": "@@ -28,6 +30,160 @@ Serialize(const CScript& s)\n \n BOOST_FIXTURE_TEST_SUITE(sigopcount_tests, BasicTestingSetup)\n \n+BOOST_AUTO_TEST_CASE(GetLegacySigOpCountErrors)",
      "path": "src/test/sigopcount_tests.cpp",
      "position": 14,
      "original_position": 13,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "461779ae4903d8e86500fe5ef4d73009d80ee311",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"test: add `SigOpCount` edge‚Äëcases & known‚Äëtemplate coverage\" (461779ae4903d8e86500fe5ef4d73009d80ee311)\r\n\r\nCould consider expanding commit message a bit to say how the new tests compare to existing tests. I think: \r\n\r\n- GetLegacySigOpCountErrors is adding new coverage for malformed scripts that weren't checked before?\r\n- GetLegacySigOpCountStandardScripts is adding more organized and complete coverage, but not really new coverage?\r\n\r\nAnd I know you tend to push back against adding code comments, so ignore this suggestion if you don't think it is a good idea, but I'd consider moving test descriptions from the commit message:\r\n\r\n>* `GetLegacySigOpCountErrors` feeds malformed PUSHDATA sequences to confirm the parser never crashes and still counts sig‚Äëops that appear before the error.\r\n>* `GetLegacySigOpCountStandardScripts` asserts the expected legacy/accurate sig‚Äëop totals for all common known script templates (P2PKH, P2SH, P2WPKH/WSH, P2TR, compressed & uncompressed P2PK, OP_RETURN, multisig).\r\n\r\ninto the test code itself, because IMO is useful to have 1-2 line descriptions of tests like these to help navigate and understand them.",
      "created_at": "2025-06-04T18:15:36Z",
      "updated_at": "2025-06-04T18:32:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2127176949",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127176949"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 34,
      "original_line": 34,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127193014",
      "pull_request_review_id": 2897452412,
      "id": 2127193014,
      "node_id": "PRRC_kwDOABII585-ymO2",
      "diff_hunk": "@@ -552,11 +558,60 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n-    bool IsWitnessProgram(int& version, std::vector<unsigned char>& program) const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == WITNESS_V0_KEYHASH_SIZE &&\n+               (*this)[23] == OP_EQUALVERIFY &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsPayToScriptHash() const noexcept\n+    {\n+        return size() == 23 &&\n+               front() == OP_HASH160 &&\n+               (*this)[1] == WITNESS_V0_KEYHASH_SIZE &&\n+               back() == OP_EQUAL;\n+    }\n+\n+    bool IsPayToWitnessPubKeyHash() const noexcept\n+    {\n+        return size() == 22 &&\n+               front() == OP_0 &&\n+               (*this)[1] == WITNESS_V0_KEYHASH_SIZE;\n+    }\n \n-    bool IsPayToTaproot() const;\n+    bool IsPayToTaproot() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_1 &&\n+               (*this)[1] == WITNESS_V1_TAPROOT_SIZE;\n+    }\n+\n+    bool IsPayToWitnessScriptHash() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_0 &&\n+               (*this)[1] == WITNESS_V0_SCRIPTHASH_SIZE;\n+    }\n+\n+    bool IsCompressedPayToPubKey() const noexcept\n+    {\n+        return size() == 35 &&",
      "path": "src/script/script.h",
      "position": 109,
      "original_position": 69,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "c87c7b02796d83f5c4d8a7472a2cd13df30e6a05",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"refactor: add extra-fast checks for all standard script types\" (c87c7b02796d83f5c4d8a7472a2cd13df30e6a05)\r\n\r\nAny particular reason for writing 35 instead of CPubKey::COMPRESSED_SIZE + 2 like previous code?",
      "created_at": "2025-06-04T18:25:16Z",
      "updated_at": "2025-06-04T18:32:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2127193014",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127193014"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 614,
      "original_line": 614,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127196120",
      "pull_request_review_id": 2897452412,
      "id": 2127196120,
      "node_id": "PRRC_kwDOABII585-ym_Y",
      "diff_hunk": "@@ -16,36 +16,27 @@\n  * form).\n  */\n \n-static bool IsToKeyID(const CScript& script, CKeyID &hash)\n+static bool IsToKeyID(const CScript& script, CKeyID& hash)\n {\n-    if (script.size() == 25 && script[0] == OP_DUP && script[1] == OP_HASH160\n-                            && script[2] == 20 && script[23] == OP_EQUALVERIFY\n-                            && script[24] == OP_CHECKSIG) {\n-        memcpy(&hash, &script[3], 20);\n-        return true;\n-    }\n-    return false;\n+    if (!script.IsPayToPubKeyHash()) return false;\n+    memcpy(&hash, &script[3], 20);\n+    return true;\n }\n \n-static bool IsToScriptID(const CScript& script, CScriptID &hash)\n+static bool IsToScriptID(const CScript& script, CScriptID& hash)\n {\n-    if (script.size() == 23 && script[0] == OP_HASH160 && script[1] == 20\n-                            && script[22] == OP_EQUAL) {\n-        memcpy(&hash, &script[2], 20);\n-        return true;\n-    }\n-    return false;\n+    if (!script.IsPayToScriptHash()) return false;\n+    memcpy(&hash, &script[2], 20);\n+    return true;\n }\n \n-static bool IsToPubKey(const CScript& script, CPubKey &pubkey)\n+static bool IsToPubKey(const CScript& script, CPubKey& pubkey)\n {\n-    if (script.size() == 35 && script[0] == 33 && script[34] == OP_CHECKSIG\n-                            && (script[1] == 0x02 || script[1] == 0x03)) {\n+    if (script.IsCompressedPayToPubKey()) {",
      "path": "src/compressor.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "c87c7b02796d83f5c4d8a7472a2cd13df30e6a05",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"refactor: add extra-fast checks for all standard script types\" (c87c7b02796d83f5c4d8a7472a2cd13df30e6a05)\r\n\r\nThis is dropping the `script[1] == 0x02 || script[1] == 0x03))` check?",
      "created_at": "2025-06-04T18:27:19Z",
      "updated_at": "2025-06-04T18:32:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2127196120",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127196120"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 35,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127198025",
      "pull_request_review_id": 2897452412,
      "id": 2127198025,
      "node_id": "PRRC_kwDOABII585-yndJ",
      "diff_hunk": "@@ -16,36 +16,27 @@\n  * form).\n  */\n \n-static bool IsToKeyID(const CScript& script, CKeyID &hash)\n+static bool IsToKeyID(const CScript& script, CKeyID& hash)\n {\n-    if (script.size() == 25 && script[0] == OP_DUP && script[1] == OP_HASH160\n-                            && script[2] == 20 && script[23] == OP_EQUALVERIFY\n-                            && script[24] == OP_CHECKSIG) {\n-        memcpy(&hash, &script[3], 20);\n-        return true;\n-    }\n-    return false;\n+    if (!script.IsPayToPubKeyHash()) return false;\n+    memcpy(&hash, &script[3], 20);\n+    return true;\n }\n \n-static bool IsToScriptID(const CScript& script, CScriptID &hash)\n+static bool IsToScriptID(const CScript& script, CScriptID& hash)\n {\n-    if (script.size() == 23 && script[0] == OP_HASH160 && script[1] == 20\n-                            && script[22] == OP_EQUAL) {\n-        memcpy(&hash, &script[2], 20);\n-        return true;\n-    }\n-    return false;\n+    if (!script.IsPayToScriptHash()) return false;\n+    memcpy(&hash, &script[2], 20);\n+    return true;\n }\n \n-static bool IsToPubKey(const CScript& script, CPubKey &pubkey)\n+static bool IsToPubKey(const CScript& script, CPubKey& pubkey)\n {\n-    if (script.size() == 35 && script[0] == 33 && script[34] == OP_CHECKSIG\n-                            && (script[1] == 0x02 || script[1] == 0x03)) {\n+    if (script.IsCompressedPayToPubKey()) {\n         pubkey.Set(&script[1], &script[34]);\n         return true;\n     }\n-    if (script.size() == 67 && script[0] == 65 && script[66] == OP_CHECKSIG\n-                            && script[1] == 0x04) {\n+    if (script.IsUncompressedPayToPubKey()) {",
      "path": "src/compressor.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "c87c7b02796d83f5c4d8a7472a2cd13df30e6a05",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"refactor: add extra-fast checks for all standard script types\" (c87c7b02796d83f5c4d8a7472a2cd13df30e6a05)\r\n\r\nThis is dropping the `script[1] == 0x04` check?",
      "created_at": "2025-06-04T18:28:33Z",
      "updated_at": "2025-06-04T18:32:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2127198025",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127198025"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 39,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2131814130",
      "pull_request_review_id": 2904289512,
      "id": 2131814130,
      "node_id": "PRRC_kwDOABII585_EOby",
      "diff_hunk": "@@ -16,36 +16,27 @@\n  * form).\n  */\n \n-static bool IsToKeyID(const CScript& script, CKeyID &hash)\n+static bool IsToKeyID(const CScript& script, CKeyID& hash)\n {\n-    if (script.size() == 25 && script[0] == OP_DUP && script[1] == OP_HASH160\n-                            && script[2] == 20 && script[23] == OP_EQUALVERIFY\n-                            && script[24] == OP_CHECKSIG) {\n-        memcpy(&hash, &script[3], 20);\n-        return true;\n-    }\n-    return false;\n+    if (!script.IsPayToPubKeyHash()) return false;\n+    memcpy(&hash, &script[3], 20);\n+    return true;\n }\n \n-static bool IsToScriptID(const CScript& script, CScriptID &hash)\n+static bool IsToScriptID(const CScript& script, CScriptID& hash)\n {\n-    if (script.size() == 23 && script[0] == OP_HASH160 && script[1] == 20\n-                            && script[22] == OP_EQUAL) {\n-        memcpy(&hash, &script[2], 20);\n-        return true;\n-    }\n-    return false;\n+    if (!script.IsPayToScriptHash()) return false;\n+    memcpy(&hash, &script[2], 20);\n+    return true;\n }\n \n-static bool IsToPubKey(const CScript& script, CPubKey &pubkey)\n+static bool IsToPubKey(const CScript& script, CPubKey& pubkey)\n {\n-    if (script.size() == 35 && script[0] == 33 && script[34] == OP_CHECKSIG\n-                            && (script[1] == 0x02 || script[1] == 0x03)) {\n+    if (script.IsCompressedPayToPubKey()) {",
      "path": "src/compressor.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "c87c7b02796d83f5c4d8a7472a2cd13df30e6a05",
      "in_reply_to_id": 2127196120,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Some of these are rechecked later, but it looks like we need some unit tests for this area - thanks for the detailed review, I have incorrectly removed it [during a rebase](https://github.com/bitcoin/bitcoin/compare/ff835469baef8f048c44608c6d6a1a376bba87b7..432ff7e736942c6dd6fc923300b5fa5f0f94c287#diff-93c5ddf703879287802d651b68c9c6199644afe23db0dd3ff77e8d1ce3c20045) - since I got confused of the different ways of checking the same.\r\n\r\nIt was also noticed by https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2094594352 (seems I misunderstood his comment)",
      "created_at": "2025-06-06T09:01:21Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2131814130",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2131814130"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 35,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2131814823",
      "pull_request_review_id": 2904289512,
      "id": 2131814823,
      "node_id": "PRRC_kwDOABII585_EOmn",
      "diff_hunk": "@@ -16,36 +16,27 @@\n  * form).\n  */\n \n-static bool IsToKeyID(const CScript& script, CKeyID &hash)\n+static bool IsToKeyID(const CScript& script, CKeyID& hash)\n {\n-    if (script.size() == 25 && script[0] == OP_DUP && script[1] == OP_HASH160\n-                            && script[2] == 20 && script[23] == OP_EQUALVERIFY\n-                            && script[24] == OP_CHECKSIG) {\n-        memcpy(&hash, &script[3], 20);\n-        return true;\n-    }\n-    return false;\n+    if (!script.IsPayToPubKeyHash()) return false;\n+    memcpy(&hash, &script[3], 20);\n+    return true;\n }\n \n-static bool IsToScriptID(const CScript& script, CScriptID &hash)\n+static bool IsToScriptID(const CScript& script, CScriptID& hash)\n {\n-    if (script.size() == 23 && script[0] == OP_HASH160 && script[1] == 20\n-                            && script[22] == OP_EQUAL) {\n-        memcpy(&hash, &script[2], 20);\n-        return true;\n-    }\n-    return false;\n+    if (!script.IsPayToScriptHash()) return false;\n+    memcpy(&hash, &script[2], 20);\n+    return true;\n }\n \n-static bool IsToPubKey(const CScript& script, CPubKey &pubkey)\n+static bool IsToPubKey(const CScript& script, CPubKey& pubkey)\n {\n-    if (script.size() == 35 && script[0] == 33 && script[34] == OP_CHECKSIG\n-                            && (script[1] == 0x02 || script[1] == 0x03)) {\n+    if (script.IsCompressedPayToPubKey()) {\n         pubkey.Set(&script[1], &script[34]);\n         return true;\n     }\n-    if (script.size() == 67 && script[0] == 65 && script[66] == OP_CHECKSIG\n-                            && script[1] == 0x04) {\n+    if (script.IsUncompressedPayToPubKey()) {",
      "path": "src/compressor.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "c87c7b02796d83f5c4d8a7472a2cd13df30e6a05",
      "in_reply_to_id": 2127198025,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thank you, split these into smaller commits to make sure we don't miss these anymore",
      "created_at": "2025-06-06T09:01:45Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2131814823",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2131814823"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 39,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2131816504",
      "pull_request_review_id": 2904289512,
      "id": 2131816504,
      "node_id": "PRRC_kwDOABII585_EPA4",
      "diff_hunk": "@@ -552,11 +558,60 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n-    bool IsWitnessProgram(int& version, std::vector<unsigned char>& program) const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == WITNESS_V0_KEYHASH_SIZE &&\n+               (*this)[23] == OP_EQUALVERIFY &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsPayToScriptHash() const noexcept\n+    {\n+        return size() == 23 &&\n+               front() == OP_HASH160 &&\n+               (*this)[1] == WITNESS_V0_KEYHASH_SIZE &&\n+               back() == OP_EQUAL;\n+    }\n+\n+    bool IsPayToWitnessPubKeyHash() const noexcept\n+    {\n+        return size() == 22 &&\n+               front() == OP_0 &&\n+               (*this)[1] == WITNESS_V0_KEYHASH_SIZE;\n+    }\n \n-    bool IsPayToTaproot() const;\n+    bool IsPayToTaproot() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_1 &&\n+               (*this)[1] == WITNESS_V1_TAPROOT_SIZE;\n+    }\n+\n+    bool IsPayToWitnessScriptHash() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_0 &&\n+               (*this)[1] == WITNESS_V0_SCRIPTHASH_SIZE;\n+    }\n+\n+    bool IsCompressedPayToPubKey() const noexcept\n+    {\n+        return size() == 35 &&",
      "path": "src/script/script.h",
      "position": 109,
      "original_position": 69,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "c87c7b02796d83f5c4d8a7472a2cd13df30e6a05",
      "in_reply_to_id": 2127193014,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "thought about it, it seems more redundant (which I think could be safer for legacy code) if we state the sizes explicitly, otherwise changing the `CPubKey::COMPRESSED_SIZE` value might not fail immediately. Every other helper here has fixed size - and I couldn't find a reasonable value for all of them, decided to hard-code the sizes instead.\r\nDo you have an idea that we could apply to all of these?",
      "created_at": "2025-06-06T09:02:39Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2131816504",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2131816504"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 614,
      "original_line": 614,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2131817342",
      "pull_request_review_id": 2904289512,
      "id": 2131817342,
      "node_id": "PRRC_kwDOABII585_EPN-",
      "diff_hunk": "@@ -552,8 +553,59 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == 0x14 &&\n+               (*this)[23] == OP_EQUALVERIFY &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsPayToScriptHash() const noexcept\n+    {\n+        return size() == 23 &&\n+               front() == OP_HASH160 &&\n+               (*this)[1] == 0x14 &&\n+               back() == OP_EQUAL;\n+    }\n+\n+    bool IsPayToWitnessPubKeyHash() const noexcept\n+    {\n+        return size() == 22 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x14;\n+    }\n+\n+    bool IsPayToTaproot() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_1 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsPayToWitnessScriptHash() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsCompressedPayToPubKey() const noexcept\n+    {\n+        return size() == CPubKey::COMPRESSED_SIZE + 2 &&\n+               front() == CPubKey::COMPRESSED_SIZE &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsUncompressedPayToPubKey() const noexcept",
      "path": "src/script/script.h",
      "position": 114,
      "original_position": 60,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "fcc418de426f32e8c366c182950d4acbb9e7556b",
      "in_reply_to_id": 2094594388,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Update: same, those checks need to be on use site, in compressor only",
      "created_at": "2025-06-06T09:03:14Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2131817342",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2131817342"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 619,
      "original_line": 619,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132373283",
      "pull_request_review_id": 2904289512,
      "id": 2132373283,
      "node_id": "PRRC_kwDOABII585_GW8j",
      "diff_hunk": "@@ -39,26 +39,18 @@ static void DeserializeBlockTest(benchmark::Bench& bench)\n     });\n }\n \n-static void DeserializeAndCheckBlockTest(benchmark::Bench& bench)\n+static void CheckBlockBench(benchmark::Bench& bench)\n {\n-    DataStream stream(benchmark::data::block413567);\n-    std::byte a{0};\n-    stream.write({&a, 1}); // Prevent compaction\n-\n-    ArgsManager bench_args;\n-    const auto chainParams = CreateChainParams(bench_args, ChainType::MAIN);\n-\n+    CBlock block;\n+    DataStream(benchmark::data::block413567) >> TX_WITH_WITNESS(block);\n+    const auto chainParams = CreateChainParams(ArgsManager{}, ChainType::MAIN);\n     bench.unit(\"block\").run([&] {\n-        CBlock block; // Note that CBlock caches its checked state, so we need to recreate it here\n-        stream >> TX_WITH_WITNESS(block);\n-        bool rewound = stream.Rewind(benchmark::data::block413567.size());\n-        assert(rewound);\n-\n+        block.fChecked = block.m_checked_witness_commitment = block.m_checked_merkle_root = false; // Reset the cached state",
      "path": "src/bench/checkblock.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "f7b161ba72ee4b219f9ccae50ee350eb1092cd07",
      "in_reply_to_id": 2127041222,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Excellent, we can even split `ResetChecked` out of `CBlock::SetNull`",
      "created_at": "2025-06-06T15:07:24Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2132373283",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132373283"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 48,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132400987",
      "pull_request_review_id": 2904289512,
      "id": 2132400987,
      "node_id": "PRRC_kwDOABII585_Gdtb",
      "diff_hunk": "@@ -52,5 +52,32 @@ static void CheckBlockBench(benchmark::Bench& bench)\n     });\n }\n \n+static void SigOpsBlockBench(benchmark::Bench& bench)\n+{\n+    CBlock block;\n+    DataStream(benchmark::data::block413567) >> TX_WITH_WITNESS(block);\n+\n+    auto GetLegacySigOpCount{[](const CTransaction& tx) {\n+        unsigned int nSigOps{0};\n+        for (const auto& txin : tx.vin) {\n+            nSigOps += txin.scriptSig.GetSigOpCount(/*fAccurate=*/false);\n+        }\n+        for (const auto& txout : tx.vout) {\n+            nSigOps += txout.scriptPubKey.GetSigOpCount(/*fAccurate=*/false);\n+        }\n+        return nSigOps;\n+    }};\n+\n+    auto expected_sigops{0};\n+    for (const auto& tx : block.vtx) expected_sigops += GetLegacySigOpCount(*tx);",
      "path": "src/bench/checkblock.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "1e614fb9daa1baf1cef37d66ff30179a174ced99",
      "in_reply_to_id": 2127057166,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> this duplicating the tx_verify function\r\n\r\nAt the moment it seemed simpler to copy it over, but you're right that I can now just call it directly - thanks.\r\nWe can also hard-code the `expected_sigops` to have more redundancy here, since it's legacy code.",
      "created_at": "2025-06-06T15:24:45Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2132400987",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132400987"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 72,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132579545",
      "pull_request_review_id": 2904289512,
      "id": 2132579545,
      "node_id": "PRRC_kwDOABII585_HJTZ",
      "diff_hunk": "@@ -552,11 +558,60 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n-    bool IsWitnessProgram(int& version, std::vector<unsigned char>& program) const;\n+    bool IsPayToPubKeyHash() const noexcept",
      "path": "src/script/script.h",
      "position": 67,
      "original_position": 27,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "c87c7b02796d83f5c4d8a7472a2cd13df30e6a05",
      "in_reply_to_id": 2127115488,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Indeed!",
      "created_at": "2025-06-06T17:21:05Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2132579545",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132579545"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 572,
      "original_line": 572,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132580473",
      "pull_request_review_id": 2904289512,
      "id": 2132580473,
      "node_id": "PRRC_kwDOABII585_HJh5",
      "diff_hunk": "@@ -552,8 +553,59 @@ class CScript : public CScriptBase\n      */\n     static bool IsPayToAnchor(int version, const std::vector<unsigned char>& program);\n \n-    bool IsPayToScriptHash() const;\n-    bool IsPayToWitnessScriptHash() const;\n+    bool IsPayToPubKeyHash() const noexcept\n+    {\n+        return size() == 25 &&\n+               front() == OP_DUP &&\n+               (*this)[1] == OP_HASH160 &&\n+               (*this)[2] == 0x14 &&\n+               (*this)[23] == OP_EQUALVERIFY &&\n+               back() == OP_CHECKSIG;\n+    }\n+\n+    bool IsPayToScriptHash() const noexcept\n+    {\n+        return size() == 23 &&\n+               front() == OP_HASH160 &&\n+               (*this)[1] == 0x14 &&\n+               back() == OP_EQUAL;\n+    }\n+\n+    bool IsPayToWitnessPubKeyHash() const noexcept\n+    {\n+        return size() == 22 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x14;\n+    }\n+\n+    bool IsPayToTaproot() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_1 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsPayToWitnessScriptHash() const noexcept\n+    {\n+        return size() == 34 &&\n+               front() == OP_0 &&\n+               (*this)[1] == 0x20;\n+    }\n+\n+    bool IsCompressedPayToPubKey() const noexcept",
      "path": "src/script/script.h",
      "position": 107,
      "original_position": 53,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "fcc418de426f32e8c366c182950d4acbb9e7556b",
      "in_reply_to_id": 2094594352,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Update: we do need those, but only for the compressor, not for the solver or other uses",
      "created_at": "2025-06-06T17:21:50Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2132580473",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132580473"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 612,
      "original_line": 612,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132590229",
      "pull_request_review_id": 2904289512,
      "id": 2132590229,
      "node_id": "PRRC_kwDOABII585_HL6V",
      "diff_hunk": "@@ -28,6 +30,160 @@ Serialize(const CScript& s)\n \n BOOST_FIXTURE_TEST_SUITE(sigopcount_tests, BasicTestingSetup)\n \n+BOOST_AUTO_TEST_CASE(GetLegacySigOpCountErrors)",
      "path": "src/test/sigopcount_tests.cpp",
      "position": 14,
      "original_position": 13,
      "commit_id": "0819a34565d01e241e5a3f884a508472861c96e1",
      "original_commit_id": "461779ae4903d8e86500fe5ef4d73009d80ee311",
      "in_reply_to_id": 2127176949,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> is adding new coverage\r\n> but not really new coverage\r\n\r\nNot sure, many of these branches were never covered - based on https://maflcko.github.io/b-c-cov/total.coverage/src/script/script.cpp.gcov.html\r\nAnd based on https://corecheck.dev/bitcoin/bitcoin/pulls/32532 many more are covered now\r\n\r\nAdded comments to the tests, please let me know what I'm still missing.",
      "created_at": "2025-06-06T17:28:41Z",
      "updated_at": "2025-06-06T17:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32532#discussion_r2132590229",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2132590229"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32532"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 34,
      "original_line": 34,
      "side": "RIGHT"
    }
  ]
}