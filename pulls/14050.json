{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050",
    "id": 210769466,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MjEwNzY5NDY2",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14050",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/14050.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/14050.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
    "number": 14050,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "Add chacha20/poly1305 and chacha20poly1305_AEAD from openssh",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This adds **ChaCha20** and **Poly1305** and the openSSH form of the AEAD.\r\n\r\nThe implementations of **ChaCha20** are from DJB himself and directly taken (unchanged as much as possible) from the openSSH source code: https://github.com/openssh/openssh-portable/blob/master/chacha.c\r\n\r\n**Poly1305** is written by Andrew Moon is also directly taken (unchanged as much as possible) from the openSSH source code: https://github.com/openssh/openssh-portable/blob/master/poly1305.c\r\n\r\nThe code for the **ChaCha20/Poly1305@openssh** AEAD is taken from https://github.com/openssh/openssh-portable/blob/master/cipher-chachapoly.c with minimal changes.\r\n\r\nMore details on the AEAD construction:\r\nhttps://github.com/openssh/openssh-portable/blob/master/PROTOCOL.chacha20poly1305\r\nhttps://gist.github.com/jonasschnelli/c530ea8421b8d0e80c51486325587c52\r\n\r\nTest vectors are taken from the RFC draft:\r\nhttps://tools.ietf.org/html/draft-agl-tls-chacha20poly1305-04#section-7\r\n\r\nTaking existing implementations should reduce risks of screwing up at the implementation level.\r\n\r\n**OUT OF SCOPE**:\r\n* AVX,SSE acceleration (possible, see libsodium a.s.o.)\r\n* To Bitcoin Core adjusted C++ implementations\r\n* Combining with the existing ChaCha20 RNG\r\n (can all be done later, after verification of the correctness)\r\n\r\nThis is a subset of #14032 and a pre-requirement for BIP151.",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2018-08-24T15:11:35Z",
    "updated_at": "2021-12-16T14:06:52Z",
    "closed_at": "2019-03-24T19:43:49Z",
    "mergeable_state": "unknown",
    "merge_commit_sha": "0fea4b03e9915ce3e239fd435a2bd13810f65b6b",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "jonasschnelli:2018/08/bip151_chachapoly1305",
      "ref": "2018/08/bip151_chachapoly1305",
      "sha": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 9264454,
        "node_id": "MDEwOlJlcG9zaXRvcnk5MjY0NDU0",
        "name": "bitcoin",
        "full_name": "jonasschnelli/bitcoin",
        "owner": {
          "login": "jonasschnelli",
          "id": 178464,
          "node_id": "MDQ6VXNlcjE3ODQ2NA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/jonasschnelli",
          "html_url": "https://github.com/jonasschnelli",
          "followers_url": "https://api.github.com/users/jonasschnelli/followers",
          "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
          "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
          "repos_url": "https://api.github.com/users/jonasschnelli/repos",
          "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/jonasschnelli/bitcoin",
        "fork": true,
        "url": "https://api.github.com/repos/jonasschnelli/bitcoin",
        "archive_url": "https://api.github.com/repos/jonasschnelli/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/jonasschnelli/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/jonasschnelli/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/jonasschnelli/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/jonasschnelli/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/jonasschnelli/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/jonasschnelli/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/jonasschnelli/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/jonasschnelli/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/jonasschnelli/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/jonasschnelli/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/jonasschnelli/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/jonasschnelli/bitcoin/events",
        "forks_url": "https://api.github.com/repos/jonasschnelli/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/jonasschnelli/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/jonasschnelli/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/jonasschnelli/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/jonasschnelli/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/jonasschnelli/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/jonasschnelli/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/jonasschnelli/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/jonasschnelli/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/jonasschnelli/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/jonasschnelli/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/jonasschnelli/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/jonasschnelli/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/jonasschnelli/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/jonasschnelli/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/jonasschnelli/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:jonasschnelli/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/jonasschnelli/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/jonasschnelli/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/jonasschnelli/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/jonasschnelli/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/jonasschnelli/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/jonasschnelli/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/jonasschnelli/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/jonasschnelli/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/jonasschnelli/bitcoin/hooks",
        "svn_url": "https://github.com/jonasschnelli/bitcoin",
        "homepage": "http://www.bitcoin.org",
        "language": "C++",
        "forks_count": 5,
        "stargazers_count": 10,
        "watchers_count": 10,
        "size": 194164,
        "default_branch": "master",
        "open_issues_count": 5,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2022-08-07T18:33:53Z",
        "created_at": "2013-04-06T18:21:51Z",
        "updated_at": "2023-05-19T06:34:35Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "1e8f88e071019907785b260477bd359bef6f9a8f",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35475,
        "stargazers_count": 70607,
        "watchers_count": 70607,
        "size": 236222,
        "default_branch": "master",
        "open_issues_count": 670,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-02T17:47:04Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-08-02T16:22:48Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 873,
    "deletions": 1,
    "changed_files": 10,
    "commits": 3,
    "review_comments": 21,
    "comments": 11
  },
  "events": [
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-24T15:13:04Z",
      "updated_at": "2018-08-24T15:13:04Z",
      "source": {
        "issue": {
          "id": 353427896,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MjEwNDgyNTI1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14032",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14032/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14032/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14032/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/14032",
          "number": 14032,
          "state": "closed",
          "state_reason": null,
          "title": "Add p2p layer encryption with ECDH/ChaCha20Poly1305",
          "body": "This PR adds encryption to the p2p communication after a slightly overhauled version of BIP151 defined [here](https://gist.github.com/jonasschnelli/c530ea8421b8d0e80c51486325587c52) (there is the plan to change BIP151 or to propose this protocol in a new BIP)\r\n\r\nThe encryption is optional and by default disabled (`-netencryption`).\r\n\r\nIf enabled, a peer connecting to another peer signalling `NODE_ENCRYPTED` (or added via `-connect=`) will try to do the proposed key handshake and continue with encrypted communication.\r\n\r\nIf enabled, peers can request (and perform) encrypted communications by sending a handshake request.\r\n\r\nPeers not supporting encryption are still accepted (no option to enforce encrypted communication).\r\n\r\nThere is a plan to make the handshake quantum resistance by adding NewHope to the key handshake (https://newhopecrypto.org). But since this PR is already very large, it's unclear wether this should be an independent patch (probably another ~600 lines of code).\r\n\r\n**Out of scope:**\r\n* optimized ChaCha20 implementation (for review and security reasons, the implementation is extracted from openssh)\r\n* benchmarks added to bench (I have done comparison against the v1 protocol with dbl-SHA256 the performance seems very similar)\r\n* Please no discussion about the used crypto scheme or the [proposal](https://gist.github.com/jonasschnelli/c530ea8421b8d0e80c51486325587c52) itself (better place would be the mailing list)\r\n\r\n**TODO:**\r\n* [ ] add option to `-connect=` RPC `addnode` where it is possible to specify the expected service flags (currently `-connect=` will always try for encrypted coms).",
          "user": {
            "login": "jonasschnelli",
            "id": 178464,
            "node_id": "MDQ6VXNlcjE3ODQ2NA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonasschnelli",
            "html_url": "https://github.com/jonasschnelli",
            "followers_url": "https://api.github.com/users/jonasschnelli/followers",
            "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
            "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
            "repos_url": "https://api.github.com/users/jonasschnelli/repos",
            "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 13,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14032",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/14032",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/14032.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/14032.patch"
          },
          "closed_at": "2021-08-18T12:25:27Z",
          "created_at": "2018-08-23T15:11:14Z",
          "updated_at": "2022-08-24T09:46:33Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 415800611,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTgwMDYxMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415800611",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-24T15:49:32Z",
      "updated_at": "2019-03-22T23:37:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15649](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15649.html) (Add ChaCha20Poly1305@Bitcoin AEAD by jonasschnelli)\n* [#15519](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15519.html) (Add Poly1305 implementation by jonasschnelli)\n* [#15512](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15512.html) (Add ChaCha20 encryption option (XOR) by jonasschnelli)\n* [#14047](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14047.html) (Add HKDF_HMAC256_L32 and method to negate a private key by jonasschnelli)\n* [#14032](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14032.html) (Add p2p layer encryption with ECDH/ChaCha20Poly1305 by jonasschnelli)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-415800611",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-24T15:50:48Z",
      "updated_at": "2018-08-24T15:50:48Z",
      "source": {
        "issue": {
          "id": 353708006,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MjEwNjg0OTUw",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14047",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14047/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14047/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14047/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/14047",
          "number": 14047,
          "state": "closed",
          "state_reason": null,
          "title": "Add HKDF_HMAC256_L32 and method to negate a private key",
          "body": "This adds a limited implementation of `HKDF` (defined by rfc5869) that supports only HMAC-SHA256  and length output of 32 bytes (will be required for v2 transport protocol).\r\n\r\nThis PR also includes a method to negate a private key which is useful to enforce public keys starting with 0x02 (or 0x03) (a requirement for the v2 transport protocol). The new `CKey::Negate()` method is pretty much a wrapper around `secp256k1_ec_privkey_negate()`.\r\n\r\nIncluding tests.\r\n\r\nThis is a subset of #14032 and a pre-requirement for the v2 transport protocol.",
          "user": {
            "login": "jonasschnelli",
            "id": 178464,
            "node_id": "MDQ6VXNlcjE3ODQ2NA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonasschnelli",
            "html_url": "https://github.com/jonasschnelli",
            "followers_url": "https://api.github.com/users/jonasschnelli/followers",
            "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
            "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
            "repos_url": "https://api.github.com/users/jonasschnelli/repos",
            "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 61889416,
              "node_id": "MDU6TGFiZWw2MTg4OTQxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system",
              "name": "Build system",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            },
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/14047",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/14047.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/14047.patch"
          },
          "closed_at": "2019-05-16T17:25:45Z",
          "created_at": "2018-08-24T09:20:37Z",
          "updated_at": "2021-12-16T14:08:33Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 415947069,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTk0NzA2OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415947069",
      "actor": {
        "login": "DesWurstes",
        "id": 23437045,
        "node_id": "MDQ6VXNlcjIzNDM3MDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23437045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DesWurstes",
        "html_url": "https://github.com/DesWurstes",
        "followers_url": "https://api.github.com/users/DesWurstes/followers",
        "following_url": "https://api.github.com/users/DesWurstes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DesWurstes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DesWurstes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DesWurstes/subscriptions",
        "organizations_url": "https://api.github.com/users/DesWurstes/orgs",
        "repos_url": "https://api.github.com/users/DesWurstes/repos",
        "events_url": "https://api.github.com/users/DesWurstes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DesWurstes/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-25T07:09:02Z",
      "updated_at": "2018-08-25T07:09:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "Why not [reuse the existing ChaCha20](https://github.com/bitcoin/bitcoin/compare/master...DesWurstes:master)?",
      "user": {
        "login": "DesWurstes",
        "id": 23437045,
        "node_id": "MDQ6VXNlcjIzNDM3MDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23437045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DesWurstes",
        "html_url": "https://github.com/DesWurstes",
        "followers_url": "https://api.github.com/users/DesWurstes/followers",
        "following_url": "https://api.github.com/users/DesWurstes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DesWurstes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DesWurstes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DesWurstes/subscriptions",
        "organizations_url": "https://api.github.com/users/DesWurstes/orgs",
        "repos_url": "https://api.github.com/users/DesWurstes/repos",
        "events_url": "https://api.github.com/users/DesWurstes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DesWurstes/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-415947069",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "labeled",
      "id": 1809017655,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDE4MDkwMTc2NTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1809017655",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-25T14:47:08Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 416203421,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjIwMzQyMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416203421",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-27T11:59:23Z",
      "updated_at": "2018-08-27T11:59:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "@DesWurstes: see PR description (out of scope).",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-416203421",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "mentioned",
      "id": 1810418906,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTgxMDQxODkwNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1810418906",
      "actor": {
        "login": "DesWurstes",
        "id": 23437045,
        "node_id": "MDQ6VXNlcjIzNDM3MDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23437045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DesWurstes",
        "html_url": "https://github.com/DesWurstes",
        "followers_url": "https://api.github.com/users/DesWurstes/followers",
        "following_url": "https://api.github.com/users/DesWurstes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DesWurstes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DesWurstes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DesWurstes/subscriptions",
        "organizations_url": "https://api.github.com/users/DesWurstes/orgs",
        "repos_url": "https://api.github.com/users/DesWurstes/repos",
        "events_url": "https://api.github.com/users/DesWurstes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DesWurstes/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-27T11:59:23Z"
    },
    {
      "event": "subscribed",
      "id": 1810418907,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE4MTA0MTg5MDc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1810418907",
      "actor": {
        "login": "DesWurstes",
        "id": 23437045,
        "node_id": "MDQ6VXNlcjIzNDM3MDQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23437045?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DesWurstes",
        "html_url": "https://github.com/DesWurstes",
        "followers_url": "https://api.github.com/users/DesWurstes/followers",
        "following_url": "https://api.github.com/users/DesWurstes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DesWurstes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DesWurstes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DesWurstes/subscriptions",
        "organizations_url": "https://api.github.com/users/DesWurstes/orgs",
        "repos_url": "https://api.github.com/users/DesWurstes/repos",
        "events_url": "https://api.github.com/users/DesWurstes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DesWurstes/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-27T11:59:23Z"
    },
    {
      "event": "commented",
      "id": 416342883,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjM0Mjg4Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416342883",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-27T19:37:51Z",
      "updated_at": "2018-08-27T19:37:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "Added benchmark for the AEAD (and for direct comparison also added the dbl-SHA (HASH) benchmark).\r\nBenchmarking 1MB data as well as 256bytes.\r\n\r\nMy system reports (!we compare SSE4 SHA256 vs non-optimized chacha20):\r\n```\r\n# Benchmark, evals, iterations, total, min, max, median\r\nCHACHA20POLY1305AEAD_BIG, 5, 340, 3.68279, 0.00215035, 0.00219169, 0.00216025\r\nCHACHA20POLY1305AEAD_SMALL, 5, 250000, 1.08673, 8.51516e-07, 8.93585e-07, 8.61119e-07\r\nHASH256_BIG, 5, 340, 3.81384, 0.00222589, 0.00226436, 0.00224086\r\nHASH256_SMALL, 5, 250000, 1.1305, 8.96669e-07, 9.15482e-07, 9.03866e-07\r\n```",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-416342883",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1812582466,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgxMjU4MjQ2Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1812582466",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-28T09:29:55Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1812879513,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgxMjg3OTUxMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1812879513",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-28T12:01:40Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1812951934,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgxMjk1MTkzNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1812951934",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-28T12:37:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1812986247,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgxMjk4NjI0Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1812986247",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-28T12:53:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1813925876,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgxMzkyNTg3Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1813925876",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-28T19:14:05Z"
    },
    {
      "event": "referenced",
      "id": 1815108734,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDE4MTUxMDg3MzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1815108734",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "955ac1d876ea293e74669dc21297e03b8b61bd37",
      "commit_url": "https://api.github.com/repos/jonasschnelli/bitcoin/commits/955ac1d876ea293e74669dc21297e03b8b61bd37",
      "created_at": "2018-08-29T09:10:13Z"
    },
    {
      "event": "reviewed",
      "id": 150667667,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTUwNjY3NjY3",
      "url": null,
      "actor": null,
      "commit_id": "90702f472e5c9e3370db2b51c8c5942e570ff83a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ken2812221",
        "id": 11154118,
        "node_id": "MDQ6VXNlcjExMTU0MTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ken2812221",
        "html_url": "https://github.com/ken2812221",
        "followers_url": "https://api.github.com/users/ken2812221/followers",
        "following_url": "https://api.github.com/users/ken2812221/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ken2812221/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ken2812221/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
        "organizations_url": "https://api.github.com/users/ken2812221/orgs",
        "repos_url": "https://api.github.com/users/ken2812221/repos",
        "events_url": "https://api.github.com/users/ken2812221/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ken2812221/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-150667667",
      "submitted_at": "2018-08-29T17:17:56Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1819130463,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgxOTEzMDQ2Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1819130463",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-30T20:07:53Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1819922368,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgxOTkyMjM2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1819922368",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-31T07:29:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1820238408,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgyMDIzODQwOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1820238408",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-31T10:12:26Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1821366714,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgyMTM2NjcxNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1821366714",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-08-31T19:49:35Z"
    },
    {
      "event": "reviewed",
      "id": 151603370,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTUxNjAzMzcw",
      "url": null,
      "actor": null,
      "commit_id": "ac477bcf8bf37d0a49692161ed058fe3db884e50",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-151603370",
      "submitted_at": "2018-09-01T21:05:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1822151901,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTgyMjE1MTkwMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1822151901",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-02T08:02:24Z"
    },
    {
      "event": "reviewed",
      "id": 151616192,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTUxNjE2MTky",
      "url": null,
      "actor": null,
      "commit_id": "995c41af1b11116db32fb64325308276e6c9615c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Re out of scope \"Combining with the existing ChaCha20 RNG\": perhaps you can add some tests to show they're identical?",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-151616192",
      "submitted_at": "2018-09-02T10:53:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "commented",
      "id": 417921804,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzkyMTgwNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/417921804",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-02T10:59:33Z",
      "updated_at": "2018-09-02T10:59:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "@Sjors The existing ChaCha20 implementation doesn't do the XORing and can therefore only be used for the RNG.",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-417921804",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "mentioned",
      "id": 1822201837,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTgyMjIwMTgzNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1822201837",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-02T10:59:33Z"
    },
    {
      "event": "subscribed",
      "id": 1822201838,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE4MjIyMDE4Mzg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1822201838",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-02T10:59:33Z"
    },
    {
      "event": "commented",
      "id": 417924355,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzkyNDM1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/417924355",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-02T11:34:21Z",
      "updated_at": "2018-09-02T11:34:21Z",
      "author_association": "MEMBER",
      "body": "Instead of those U8TOU32_LE macros you can use our own function (ReadLE32,\nWriteLE32).\n\n>\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-417924355",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "commented",
      "id": 417924839,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzkyNDgzOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/417924839",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-02T11:44:09Z",
      "updated_at": "2018-09-02T11:44:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "@sipa: agree. Though as written in the PR description. I'd like to keep the code (extracted from openSSH) as identical as possible. I think (or hope) we can do refactoring after this has been merged.",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-417924839",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "mentioned",
      "id": 1822216169,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTgyMjIxNjE2OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1822216169",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-02T11:44:09Z"
    },
    {
      "event": "subscribed",
      "id": 1822216170,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE4MjIyMTYxNzA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1822216170",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-02T11:44:09Z"
    },
    {
      "event": "reviewed",
      "id": 154567852,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTU0NTY3ODUy",
      "url": null,
      "actor": null,
      "commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-154567852",
      "submitted_at": "2018-09-12T09:49:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "reviewed",
      "id": 154568860,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTU0NTY4ODYw",
      "url": null,
      "actor": null,
      "commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-154568860",
      "submitted_at": "2018-09-12T09:52:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "reviewed",
      "id": 154698661,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTU0Njk4NjYx",
      "url": null,
      "actor": null,
      "commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-154698661",
      "submitted_at": "2018-09-12T15:08:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "reviewed",
      "id": 160119097,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMTE5MDk3",
      "url": null,
      "actor": null,
      "commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-160119097",
      "submitted_at": "2018-09-30T15:50:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "reviewed",
      "id": 160119178,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMTE5MTc4",
      "url": null,
      "actor": null,
      "commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-160119178",
      "submitted_at": "2018-09-30T15:53:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "reviewed",
      "id": 160119209,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMTE5MjA5",
      "url": null,
      "actor": null,
      "commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-160119209",
      "submitted_at": "2018-09-30T15:54:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "reviewed",
      "id": 160119217,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMTE5MjE3",
      "url": null,
      "actor": null,
      "commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-160119217",
      "submitted_at": "2018-09-30T15:54:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "reviewed",
      "id": 160119222,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMTE5MjIy",
      "url": null,
      "actor": null,
      "commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#pullrequestreview-160119222",
      "submitted_at": "2018-09-30T15:54:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxMjRhMTRmMDJlZjExMmJkNDVjMzgzMDVhNmY0NTNkYTZkMjU1N2Fi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/124a14f02ef112bd45c38305a6f453da6d2557ab",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/124a14f02ef112bd45c38305a6f453da6d2557ab",
      "tree": {
        "sha": "c017d7998d88f9954ba6467b228f8fd7d989ee04",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c017d7998d88f9954ba6467b228f8fd7d989ee04"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c017d7998d88f9954ba6467b228f8fd7d989ee04\nparent c9327306b580bb161d1732c0a0260b46c0df015c\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1535122447 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1538398714 +0200\n\nAdd chacha20/poly1305 and chacha20poly1305_AEAD from openssh\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAluyGfsACgkQHrd2uwPH\nki1MGg/+MmAhIC6GKLOxxpJU4FY8A/R47H6MLA5vnYtE5OMWOlUPzbXa7fdc2rPg\nSSNjwc5Y/WzDiyn2VaH5XpdpOJnuZMSyXQkWH9q5UDmc08qtB9O0aGlFnCx+RNQD\nQFmVH+CIjHI9FLESKQ0smGYzvhlVvbloKMGqu7eS88t9WoBJmfbsA8RVxpuxikUk\ndY3yOnb6290Q36zZMBIP2StDSizHY5M+i6RAX58xdqoBJd7i8s65PV795kMsM5sp\nR4vviDnuOUCZbw76gRymKS0F0IKXd/K3bDW+u4hqXZYB4LL+bIIuntLVlwnQpFla\nnIkA74Zh2gY8IJt3ZU4SClFWcJ5vnWN2b9kow1SUmlsWKG70hoUzlVYGIdcaAN6D\nApNQ6qdOXqcvA/pyF1xAZ5x/Cgs9OE7lp5LZPOVJGgu7NwFgbt+yMudSny+ZKVUM\nKQxHvHz2LPEt7Hbwv0wdpFtzFvI0NBK5nEBOpiA5odFXUjOSzAeAloMy4E07Fj1O\n46xqogGLvFXtqXuNCnmTxcd1L2fS8ZI81jBepPWL2AxY6KIKF/cI6QuoAHr4PPT+\nC0I3AGIHNXbeeh3xRIK8VnnUZSmQ6P5kuLVoecfRYbc3iYt/QZSjzB6VopbiQ4fS\n5L2dEMvqbioz+l5ByP/ImBvSih5jl6j5QS94UnbHtrrW8tcdts0=\n=rgur\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c9327306b580bb161d1732c0a0260b46c0df015c",
          "sha": "c9327306b580bb161d1732c0a0260b46c0df015c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c9327306b580bb161d1732c0a0260b46c0df015c"
        }
      ],
      "message": "Add chacha20/poly1305 and chacha20poly1305_AEAD from openssh",
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-10-01T12:58:34Z"
      },
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-08-24T14:54:07Z"
      },
      "sha": "124a14f02ef112bd45c38305a6f453da6d2557ab"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZTY4YmFhOTAyNjJiNzhmNDAwZmQwZDRlZjdiMDdiNWIyZDg5NDM1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ae68baa90262b78f400fd0d4ef7b07b5b2d89435",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ae68baa90262b78f400fd0d4ef7b07b5b2d89435",
      "tree": {
        "sha": "ddf8ae412a8cf6e490f47065ee8bd63b4db41228",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ddf8ae412a8cf6e490f47065ee8bd63b4db41228"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree ddf8ae412a8cf6e490f47065ee8bd63b4db41228\nparent 124a14f02ef112bd45c38305a6f453da6d2557ab\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1535122466 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1538398830 +0200\n\nQA: add ChaCha20/Poly1305 test vectors from the RFC draft\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAluyGm8ACgkQHrd2uwPH\nki0QYA//c9Go02STQHQBstPudbbMO9EkEZH7YeP+KmLb84N96yrGT3rOjr93jwdg\nzH4cAb/D/Yg/Q6c69UBXGxMmYQt4+C/3INTbyvbFoJaezggvnwmy38gozCYXeDqX\nA8JjJoHfAQi40yf3xg/+SPMVnWMDt3OF4g9Gs/44l8Yga9nY67uqLUDA+vFkpayG\nVqudl0qusFdat6P5rIlc2434dhmJnJw6cCEReevaMYb11fnFHQ4X6hCP9p/wFFKs\nynS88KdRl1dJ/ACFfkbwQw3PYTz4UOGltyYaCBQQ1Stn7LQnI9HHLffin58fQwiN\n8VSreRYEkNKI7/YAxI+QBPaz1qxm9w+ItPOvsEl2abFS6Dwp7rgUxaAzuRedrF4f\nRuO4j7HDme45CIU4wp6pXh+LNK1AmDou8m171GcP8OBgyOien5AQZEqFKlwo+hH3\nyL2pB8W51/XgaQAL4ZcJkRbdXyf9kZkTYDO5nlQYuVzHTqQa/bkM+yeIhBthHgES\nEi9KlzG0XF7p9Q7ml5ksxiDwCo6zRSTB/s9FEaiwLfFBJZDMAECy0OCPI9ZxyvoS\neyUFumkTSuvjTD6XBrT5zsqkbzcvq3UtAnW9qanSvovWhfBQEGcSX7/QZcbaecU4\nbb3fucmRzXg7+reWPS1ewAYOGAva68EU/MvjbySrsPXE3z+U9K0=\n=DRcp\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/124a14f02ef112bd45c38305a6f453da6d2557ab",
          "sha": "124a14f02ef112bd45c38305a6f453da6d2557ab",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/124a14f02ef112bd45c38305a6f453da6d2557ab"
        }
      ],
      "message": "QA: add ChaCha20/Poly1305 test vectors from the RFC draft",
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-10-01T13:00:30Z"
      },
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-08-24T14:54:26Z"
      },
      "sha": "ae68baa90262b78f400fd0d4ef7b07b5b2d89435"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzplNjVhNDE4NTNkY2MxYmE5NjhlNDdhNWU4ZDQwZTM2ZDFmMzQ2YTA4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "tree": {
        "sha": "99194cfa4284b89189756bebdd0dc1a77c1278ab",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/99194cfa4284b89189756bebdd0dc1a77c1278ab"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 99194cfa4284b89189756bebdd0dc1a77c1278ab\nparent ae68baa90262b78f400fd0d4ef7b07b5b2d89435\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1535397762 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1538399824 +0200\n\nAdd benchmark for ChaCha20Poly1305-openssh AEAD and dbl-SHA256\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAluyHlEACgkQHrd2uwPH\nki2KAg//aODzT8RGSWOYQ1f5Q85BpQ0CsGQtOqICwb+9zT05FzAClJ5ZUeDQfThh\nudaXayqvuIWzSf91JMLFLPEA/kbBeQVDPR3bo6jw825ZF8DbA+FpnfC9cOIiOHf+\nY/owPhjskM1T5tHTRtZRoaeAd7MmWa4uYVrZ/eXSDVPNdaombBr94lcG2iefG/vm\nhqawiOcam9AqMWEL0jvWvfSm6oPNWwSNwh5eOXAB9IZryVwePT6pQ80SHDTsoDso\ny4RBTP5dhlU7FacV4XLwLo8Fys+oGMdK6ooScUYqIZfKUSLw8OK9+l+vdeKA1ZGY\nnJmMLD/kVZTdFKaEMKoEnAnCCTzk7q83tsEDg3DYEIWI3dyr4zgvVkXbxI/NobpP\nR1tQp3sJ9ojmZbe2FbNnzSwsS2SniY76ijy5hAeMAy7gliMyo2W2nOuc/+do7T3J\nrSSRRur0uyd98QKsaPSDc5zVELb3kKqgtV9QjvWeSlhC87j0PdNA+4IW6iCuDGlm\ni3EdAlR4DG172vITMPoOzidLUUxN/005h1eiaCDQc8XvFK0GQl3ebkhC9R/zVUP1\nMO3/XXGzZxYo5ZuBuTe1oTF6lV983lSz/nmlkn00m0PKrR7OGsWeCdE76Imx8wr6\nt9g6zRSne5wR78Dk9NknCa+xScsntE5hR7uqcP2OTCLx4HbyzKQ=\n=MWkq\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ae68baa90262b78f400fd0d4ef7b07b5b2d89435",
          "sha": "ae68baa90262b78f400fd0d4ef7b07b5b2d89435",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ae68baa90262b78f400fd0d4ef7b07b5b2d89435"
        }
      ],
      "message": "Add benchmark for ChaCha20Poly1305-openssh AEAD and dbl-SHA256",
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-10-01T13:17:04Z"
      },
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-08-27T19:22:42Z"
      },
      "sha": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1876669567,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3NjY2OTU2Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1876669567",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-01T13:17:25Z"
    },
    {
      "event": "commented",
      "id": 425904074,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTkwNDA3NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425904074",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-01T13:18:19Z",
      "updated_at": "2018-10-01T13:18:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "Fixed points reported by @practicalswift",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-425904074",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "mentioned",
      "id": 1876671799,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTg3NjY3MTc5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1876671799",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-01T13:18:19Z"
    },
    {
      "event": "subscribed",
      "id": 1876671801,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE4NzY2NzE4MDE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1876671801",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-01T13:18:19Z"
    },
    {
      "event": "commented",
      "id": 445161061,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NTE2MTA2MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/445161061",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-12-07T08:37:11Z",
      "updated_at": "2018-12-07T08:37:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "I'm afraid this PR doesn't compile when rebased on `master`",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-445161061",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "commented",
      "id": 468718860,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ2ODcxODg2MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/468718860",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-03-01T16:14:20Z",
      "updated_at": "2019-03-01T16:14:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "Partially superseded by #15512 (the ChaCha20 part)",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-468718860",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "commented",
      "id": 475992747,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTk5Mjc0Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/475992747",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-03-24T19:43:49Z",
      "updated_at": "2019-03-24T19:43:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "Closing...\r\nIt's now replaced with #15512,  #15519 and  #15649.",
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#issuecomment-475992747",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14050"
    },
    {
      "event": "closed",
      "id": 2225037917,
      "node_id": "MDExOkNsb3NlZEV2ZW50MjIyNTAzNzkxNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2225037917",
      "actor": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-03-24T19:43:49Z"
    },
    {
      "event": "locked",
      "id": 5778590184,
      "node_id": "LOE_lADOABII584VFurrzwAAAAFYbkno",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5778590184",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-12-16T14:06:52Z",
      "lock_reason": "resolved"
    },
    {
      "event": "added_to_project",
      "id": 6310141027,
      "node_id": "ATPE_lADOABII584VFurrzwAAAAF4HRxj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6310141027",
      "actor": {
        "login": "dhruv",
        "id": 856960,
        "node_id": "MDQ6VXNlcjg1Njk2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhruv",
        "html_url": "https://github.com/dhruv",
        "followers_url": "https://api.github.com/users/dhruv/followers",
        "following_url": "https://api.github.com/users/dhruv/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dhruv/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dhruv/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
        "organizations_url": "https://api.github.com/users/dhruv/orgs",
        "repos_url": "https://api.github.com/users/dhruv/repos",
        "events_url": "https://api.github.com/users/dhruv/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dhruv/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-25T21:30:40Z",
      "project_card": {
        "id": 79694104,
        "url": "https://api.github.com/projects/columns/cards/79694104",
        "project_id": 13452186,
        "project_url": "https://api.github.com/projects/13452186",
        "column_name": "Closed unmerged"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213763831",
      "pull_request_review_id": 150667667,
      "id": 213763831,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMzc2MzgzMQ==",
      "diff_hunk": "@@ -0,0 +1,104 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+void _memory_cleanse(void *ptr, size_t len)\n+{\n+    memset(ptr, 0, len);\n+\n+    /* As best as we can tell, this is sufficient to break any optimisations that\n+       might try to eliminate \"superfluous\" memsets. If there's an easy way to\n+       detect memset_s, it would be better to use that. */\n+#if defined(_MSC_VER)\n+    SecureZeroMemory(ptr, len);",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": null,
      "original_position": 30,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "90702f472e5c9e3370db2b51c8c5942e570ff83a",
      "in_reply_to_id": null,
      "user": {
        "login": "ken2812221",
        "id": 11154118,
        "node_id": "MDQ6VXNlcjExMTU0MTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ken2812221",
        "html_url": "https://github.com/ken2812221",
        "followers_url": "https://api.github.com/users/ken2812221/followers",
        "following_url": "https://api.github.com/users/ken2812221/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ken2812221/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ken2812221/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
        "organizations_url": "https://api.github.com/users/ken2812221/orgs",
        "repos_url": "https://api.github.com/users/ken2812221/repos",
        "events_url": "https://api.github.com/users/ken2812221/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ken2812221/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Seems this should include windows.h",
      "created_at": "2018-08-29T17:17:56Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r213763831",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213763831"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214523031",
      "pull_request_review_id": 151603370,
      "id": 214523031,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUyMzAzMQ==",
      "diff_hunk": "@@ -0,0 +1,22 @@\n+#ifndef BITCOIN_CRYPTO_CHACHAPOLY_AEAD_H\n+#define BITCOIN_CRYPTO_CHACHAPOLY_AEAD_H\n+\n+#include <crypto/chacha.h>\n+\n+#define CHACHA_KEYLEN 32 /* 2 x 256 bit keys */\n+\n+struct chachapolyaead_ctx {\n+  struct chacha_ctx main_ctx, header_ctx;\n+};\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *cpctx, const uint8_t *key,\n+                          int keylen);\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt);\n+\n+// extracts the LE 24bit (3byte) length from the AAD and puts it into a uint32_t (host endiannes)",
      "path": "src/crypto/chachapoly_aead.h",
      "position": null,
      "original_position": 18,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "ac477bcf8bf37d0a49692161ed058fe3db884e50",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Typo found by `codespell`: endiannes",
      "created_at": "2018-09-01T21:05:50Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r214523031",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214523031"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 18,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214533236",
      "pull_request_review_id": 151613678,
      "id": 214533236,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUzMzIzNg==",
      "diff_hunk": "@@ -0,0 +1,22 @@\n+#ifndef BITCOIN_CRYPTO_CHACHAPOLY_AEAD_H\n+#define BITCOIN_CRYPTO_CHACHAPOLY_AEAD_H\n+\n+#include <crypto/chacha.h>\n+\n+#define CHACHA_KEYLEN 32 /* 2 x 256 bit keys */\n+\n+struct chachapolyaead_ctx {\n+  struct chacha_ctx main_ctx, header_ctx;\n+};\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *cpctx, const uint8_t *key,\n+                          int keylen);\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt);\n+\n+// extracts the LE 24bit (3byte) length from the AAD and puts it into a uint32_t (host endiannes)",
      "path": "src/crypto/chachapoly_aead.h",
      "position": null,
      "original_position": 18,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "ac477bcf8bf37d0a49692161ed058fe3db884e50",
      "in_reply_to_id": 214523031,
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2018-09-02T08:47:05Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r214533236",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214533236"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 18,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214535827",
      "pull_request_review_id": 151616192,
      "id": 214535827,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUzNTgyNw==",
      "diff_hunk": "@@ -562,4 +564,198 @@ BOOST_AUTO_TEST_CASE(sha256d64)\n     }\n }\n \n+\n+BOOST_AUTO_TEST_CASE(chacha20poly1305_openssh)\n+{\n+    struct chacha20_testvector {\n+        uint8_t key[32];\n+        uint8_t nonce[8];\n+        uint8_t resulting_keystream[512];\n+        int keystream_check_size;\n+    };\n+\n+    struct poly1305_testvector {\n+        uint8_t input[64];\n+        int inputlen;\n+        uint8_t key[64];\n+        uint8_t resulting_tag[16];\n+    };\n+\n+    /*\n+       Testvectors have been taken from the draft RFC\n+       https://tools.ietf.org/html/draft-agl-tls-chacha20poly1305-04#section-7\n+    */\n+\n+    static const struct chacha20_testvector chacha20_testvectors[] = {\n+        {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,",
      "path": "src/test/crypto_tests.cpp",
      "position": 46,
      "original_position": 46,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "995c41af1b11116db32fb64325308276e6c9615c",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This would be much easier to verify against the RFC document if you parse a hex string. ",
      "created_at": "2018-09-02T10:33:08Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r214535827",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214535827"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 590,
      "original_line": 590,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214536074",
      "pull_request_review_id": 151616192,
      "id": 214536074,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUzNjA3NA==",
      "diff_hunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Public Domain poly1305 from Andrew Moon\n+ * poly1305-donna-unrolled.c from https://github.com/floodyberry/poly1305-donna\n+ */\n+\n+/* $OpenBSD: poly1305.c,v 1.3 2013/12/19 22:57:13 djm Exp $ */\n+\n+#include <crypto/poly1305.h>\n+\n+#define mul32x32_64(a, b) ((uint64_t)(a) * (b))\n+\n+#define U8TO32_LE(p)                                                           \\\n+  (((uint32_t)((p)[0])) | ((uint32_t)((p)[1]) << 8) |                          \\\n+   ((uint32_t)((p)[2]) << 16) | ((uint32_t)((p)[3]) << 24))\n+\n+#define U32TO8_LE(p, v)                                                        \\\n+  do {                                                                         \\\n+    (p)[0] = (uint8_t)((v));                                                   \\\n+    (p)[1] = (uint8_t)((v) >> 8);                                              \\\n+    (p)[2] = (uint8_t)((v) >> 16);                                             \\\n+    (p)[3] = (uint8_t)((v) >> 24);                                             \\\n+  } while (0)\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m,",
      "path": "src/crypto/poly1305.cpp",
      "position": 24,
      "original_position": 24,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "09ec49ba31867187cecd631593d37bcc5f3ca72f",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why did you remove the [poly1305_init](https://github.com/floodyberry/poly1305-donna/blob/master/poly1305-donna-32.h), [poly1305_update](https://github.com/floodyberry/poly1305-donna/blob/master/poly1305-donna.c#L27), [poly1305_finish](https://github.com/floodyberry/poly1305-donna/blob/master/poly1305-donna-32.h#L134) separation?",
      "created_at": "2018-09-02T10:44:38Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r214536074",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214536074"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214536163",
      "pull_request_review_id": 151616192,
      "id": 214536163,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUzNjE2Mw==",
      "diff_hunk": "@@ -0,0 +1,215 @@\n+/*\n+chacha-merged.c version 20080118\n+D. J. Bernstein\n+Public domain.\n+*/\n+\n+#include <crypto/chacha.h>\n+\n+/* $OpenBSD: chacha.c,v 1.1 2013/11/21 00:45:44 djm Exp $ */\n+\n+typedef unsigned char u8;\n+typedef unsigned int u32;\n+\n+typedef struct chacha_ctx chacha_ctx;\n+\n+#define U8C(v) (v##U)\n+#define U32C(v) (v##U)\n+\n+#define U8V(v) ((u8)(v)&U8C(0xFF))\n+#define U32V(v) ((u32)(v)&U32C(0xFFFFFFFF))\n+\n+#define ROTL32(v, n) (U32V((v) << (n)) | ((v) >> (32 - (n))))\n+\n+#define U8TO32_LITTLE(p)                                                       \\\n+  (((u32)((p)[0])) | ((u32)((p)[1]) << 8) | ((u32)((p)[2]) << 16) |            \\\n+   ((u32)((p)[3]) << 24))\n+\n+#define U32TO8_LITTLE(p, v)                                                    \\\n+  do {                                                                         \\\n+    (p)[0] = U8V((v));                                                         \\\n+    (p)[1] = U8V((v) >> 8);                                                    \\\n+    (p)[2] = U8V((v) >> 16);                                                   \\\n+    (p)[3] = U8V((v) >> 24);                                                   \\\n+  } while (0)\n+\n+#define ROTATE(v, c) (ROTL32(v, c))\n+#define XOR(v, w) ((v) ^ (w))\n+#define PLUS(v, w) (U32V((v) + (w)))\n+#define PLUSONE(v) (PLUS((v), 1))\n+\n+#define QUARTERROUND(a, b, c, d)                                               \\\n+  a = PLUS(a, b);                                                              \\\n+  d = ROTATE(XOR(d, a), 16);                                                   \\\n+  c = PLUS(c, d);                                                              \\\n+  b = ROTATE(XOR(b, c), 12);                                                   \\\n+  a = PLUS(a, b);                                                              \\\n+  d = ROTATE(XOR(d, a), 8);                                                    \\\n+  c = PLUS(c, d);                                                              \\\n+  b = ROTATE(XOR(b, c), 7);\n+\n+static const char sigma[] = \"expand 32-byte k\";\n+static const char tau[] = \"expand 16-byte k\";\n+\n+void chacha_keysetup(chacha_ctx *x, const u8 *k, u32 kbits) {\n+  const char *constants;\n+\n+  x->input[4] = U8TO32_LITTLE(k + 0);\n+  x->input[5] = U8TO32_LITTLE(k + 4);\n+  x->input[6] = U8TO32_LITTLE(k + 8);\n+  x->input[7] = U8TO32_LITTLE(k + 12);\n+  if (kbits == 256) { /* recommended */\n+    k += 16;\n+    constants = sigma;\n+  } else { /* kbits == 128 */\n+    constants = tau;\n+  }\n+  x->input[8] = U8TO32_LITTLE(k + 0);\n+  x->input[9] = U8TO32_LITTLE(k + 4);\n+  x->input[10] = U8TO32_LITTLE(k + 8);\n+  x->input[11] = U8TO32_LITTLE(k + 12);\n+  x->input[0] = U8TO32_LITTLE(constants + 0);\n+  x->input[1] = U8TO32_LITTLE(constants + 4);\n+  x->input[2] = U8TO32_LITTLE(constants + 8);\n+  x->input[3] = U8TO32_LITTLE(constants + 12);\n+}\n+\n+void chacha_ivsetup(chacha_ctx *x, const u8 *iv, const u8 *counter) {",
      "path": "src/crypto/chacha.cpp",
      "position": 77,
      "original_position": 77,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "09ec49ba31867187cecd631593d37bcc5f3ca72f",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I can confirm this function in 09ec49ba31867187cecd631593d37bcc5f3ca72f is identical to the original at de624c626ea081929df000b09932dbc804eda51d, modulo some whitespace.",
      "created_at": "2018-09-02T10:48:24Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r214536163",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214536163"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 77,
      "original_line": 77,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214536423",
      "pull_request_review_id": 151616778,
      "id": 214536423,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUzNjQyMw==",
      "diff_hunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Public Domain poly1305 from Andrew Moon\n+ * poly1305-donna-unrolled.c from https://github.com/floodyberry/poly1305-donna\n+ */\n+\n+/* $OpenBSD: poly1305.c,v 1.3 2013/12/19 22:57:13 djm Exp $ */\n+\n+#include <crypto/poly1305.h>\n+\n+#define mul32x32_64(a, b) ((uint64_t)(a) * (b))\n+\n+#define U8TO32_LE(p)                                                           \\\n+  (((uint32_t)((p)[0])) | ((uint32_t)((p)[1]) << 8) |                          \\\n+   ((uint32_t)((p)[2]) << 16) | ((uint32_t)((p)[3]) << 24))\n+\n+#define U32TO8_LE(p, v)                                                        \\\n+  do {                                                                         \\\n+    (p)[0] = (uint8_t)((v));                                                   \\\n+    (p)[1] = (uint8_t)((v) >> 8);                                              \\\n+    (p)[2] = (uint8_t)((v) >> 16);                                             \\\n+    (p)[3] = (uint8_t)((v) >> 24);                                             \\\n+  } while (0)\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m,",
      "path": "src/crypto/poly1305.cpp",
      "position": 24,
      "original_position": 24,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "09ec49ba31867187cecd631593d37bcc5f3ca72f",
      "in_reply_to_id": 214536074,
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Which separation? I took Andrew Moons implementation found at https://github.com/openssh/openssh-portable/blob/90e51d672711c19a36573be1785caf35019ae7a8/poly1305.c",
      "created_at": "2018-09-02T10:58:55Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r214536423",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214536423"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214536689",
      "pull_request_review_id": 151617053,
      "id": 214536689,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUzNjY4OQ==",
      "diff_hunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Public Domain poly1305 from Andrew Moon\n+ * poly1305-donna-unrolled.c from https://github.com/floodyberry/poly1305-donna\n+ */\n+\n+/* $OpenBSD: poly1305.c,v 1.3 2013/12/19 22:57:13 djm Exp $ */\n+\n+#include <crypto/poly1305.h>\n+\n+#define mul32x32_64(a, b) ((uint64_t)(a) * (b))\n+\n+#define U8TO32_LE(p)                                                           \\\n+  (((uint32_t)((p)[0])) | ((uint32_t)((p)[1]) << 8) |                          \\\n+   ((uint32_t)((p)[2]) << 16) | ((uint32_t)((p)[3]) << 24))\n+\n+#define U32TO8_LE(p, v)                                                        \\\n+  do {                                                                         \\\n+    (p)[0] = (uint8_t)((v));                                                   \\\n+    (p)[1] = (uint8_t)((v) >> 8);                                              \\\n+    (p)[2] = (uint8_t)((v) >> 16);                                             \\\n+    (p)[3] = (uint8_t)((v) >> 24);                                             \\\n+  } while (0)\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m,",
      "path": "src/crypto/poly1305.cpp",
      "position": 24,
      "original_position": 24,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "09ec49ba31867187cecd631593d37bcc5f3ca72f",
      "in_reply_to_id": 214536074,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah, I see, in that case the source code URL at the top of the file is confusing; probably should add a link to Moons' implementation instead / in addition.",
      "created_at": "2018-09-02T11:09:49Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r214536689",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214536689"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216966077",
      "pull_request_review_id": 154567852,
      "id": 216966077,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNjk2NjA3Nw==",
      "diff_hunk": "@@ -0,0 +1,90 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+#include <support/cleanse.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *ctx, const uint8_t *key,\n+                          int keylen) {\n+  if (keylen != (32 + 32)) /* 2 x 256 bit keys */\n+    return -1;\n+  chacha_keysetup(&ctx->main_ctx, key, 256);\n+  chacha_keysetup(&ctx->header_ctx, key + 32, 256);\n+  return 0;\n+}\n+\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt) {\n+  const uint8_t one[8] = {1, 0, 0, 0, 0, 0, 0, 0}; /* NB little-endian */\n+  uint8_t expected_tag[POLY1305_TAGLEN], poly_key[POLY1305_KEYLEN];\n+  int r = -1;\n+\n+  uint64_t seqnr64 = seqnr;\n+  uint64_t chacha_iv = htole64(seqnr64);\n+  memset(poly_key, 0, sizeof(poly_key));\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, NULL);\n+  chacha_encrypt_bytes(&ctx->main_ctx, poly_key, poly_key, sizeof(poly_key));\n+\n+  if (!is_encrypt) {\n+    const uint8_t *tag = src + aadlen + len;\n+\n+    poly1305_auth(expected_tag, src, aadlen + len, poly_key);\n+    if (timingsafe_bcmp(expected_tag, tag, POLY1305_TAGLEN) != 0) {\n+      r = -1;\n+      goto out;\n+    }\n+  }\n+\n+  if (aadlen) {\n+    chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&chacha_iv, NULL);\n+    chacha_encrypt_bytes(&ctx->header_ctx, src, dest, aadlen);\n+  }\n+\n+  /* Set Chacha's block counter to 1 */\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, one);\n+  chacha_encrypt_bytes(&ctx->main_ctx, src + aadlen, dest + aadlen, len);\n+\n+  /* If encrypting, calculate and append tag */\n+  if (is_encrypt) {\n+    poly1305_auth(dest + aadlen + len, dest, aadlen + len, poly_key);\n+  }\n+  r = 0;\n+out:\n+  memory_cleanse(expected_tag, sizeof(expected_tag));\n+  memory_cleanse(&chacha_iv, sizeof(chacha_iv));\n+  memory_cleanse(poly_key, sizeof(poly_key));\n+  return r;\n+}\n+\n+int chacha20poly1305_get_length24(struct chachapolyaead_ctx *ctx,\n+                                uint32_t *len24_out, uint32_t seqnr,\n+                                const uint8_t *ciphertext) {\n+  uint8_t buf[3];\n+\n+  uint64_t seqnr64 = htole64(seqnr); //use LE for the nonce\n+  chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&seqnr64, NULL);\n+  chacha_encrypt_bytes(&ctx->header_ctx, ciphertext, buf, 3);\n+  *len24_out = 0;\n+  *len24_out = buf[0] | (buf[1] << 8) | (buf[2] << 16);",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": 88,
      "original_position": 85,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This seems like a mistake? `*len24_out` is assigned twice? `*len24_out = 0;` should be removed? :-)",
      "created_at": "2018-09-12T09:49:35Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r216966077",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216966077"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216966884",
      "pull_request_review_id": 154568860,
      "id": 216966884,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNjk2Njg4NA==",
      "diff_hunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Public Domain poly1305 from Andrew Moon\n+ * poly1305-donna-unrolled.c from https://github.com/floodyberry/poly1305-donna\n+ */\n+\n+/* $OpenBSD: poly1305.c,v 1.3 2013/12/19 22:57:13 djm Exp $ */\n+\n+#include <crypto/poly1305.h>\n+\n+#define mul32x32_64(a, b) ((uint64_t)(a) * (b))\n+\n+#define U8TO32_LE(p)                                                           \\\n+  (((uint32_t)((p)[0])) | ((uint32_t)((p)[1]) << 8) |                          \\\n+   ((uint32_t)((p)[2]) << 16) | ((uint32_t)((p)[3]) << 24))\n+\n+#define U32TO8_LE(p, v)                                                        \\\n+  do {                                                                         \\\n+    (p)[0] = (uint8_t)((v));                                                   \\\n+    (p)[1] = (uint8_t)((v) >> 8);                                              \\\n+    (p)[2] = (uint8_t)((v) >> 16);                                             \\\n+    (p)[3] = (uint8_t)((v) >> 24);                                             \\\n+  } while (0)\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m,\n+                   size_t inlen, const unsigned char key[POLY1305_KEYLEN]) {\n+  uint32_t t0, t1, t2, t3;\n+  uint32_t h0, h1, h2, h3, h4;\n+  uint32_t r0, r1, r2, r3, r4;\n+  uint32_t s1, s2, s3, s4;\n+  uint32_t b, nb;\n+  size_t j;\n+  uint64_t t[5];\n+  uint64_t f0, f1, f2, f3;\n+  uint32_t g0, g1, g2, g3, g4;\n+  uint64_t c;\n+  unsigned char mp[16];\n+\n+  /* clamp key */\n+  t0 = U8TO32_LE(key + 0);\n+  t1 = U8TO32_LE(key + 4);\n+  t2 = U8TO32_LE(key + 8);\n+  t3 = U8TO32_LE(key + 12);\n+\n+  /* precompute multipliers */\n+  r0 = t0 & 0x3ffffff;\n+  t0 >>= 26;\n+  t0 |= t1 << 6;\n+  r1 = t0 & 0x3ffff03;\n+  t1 >>= 20;\n+  t1 |= t2 << 12;\n+  r2 = t1 & 0x3ffc0ff;\n+  t2 >>= 14;\n+  t2 |= t3 << 18;\n+  r3 = t2 & 0x3f03fff;\n+  t3 >>= 8;\n+  r4 = t3 & 0x00fffff;\n+\n+  s1 = r1 * 5;\n+  s2 = r2 * 5;\n+  s3 = r3 * 5;\n+  s4 = r4 * 5;\n+\n+  /* init state */\n+  h0 = 0;\n+  h1 = 0;\n+  h2 = 0;\n+  h3 = 0;\n+  h4 = 0;\n+\n+  /* full blocks */\n+  if (inlen < 16)\n+    goto poly1305_donna_atmost15bytes;\n+poly1305_donna_16bytes:\n+  m += 16;\n+  inlen -= 16;\n+\n+  t0 = U8TO32_LE(m - 16);\n+  t1 = U8TO32_LE(m - 12);\n+  t2 = U8TO32_LE(m - 8);\n+  t3 = U8TO32_LE(m - 4);\n+\n+  h0 += t0 & 0x3ffffff;\n+  h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+  h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+  h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+  h4 += (t3 >> 8) | (1 << 24);\n+\n+poly1305_donna_mul:\n+  t[0] = mul32x32_64(h0, r0) + mul32x32_64(h1, s4) + mul32x32_64(h2, s3) +\n+         mul32x32_64(h3, s2) + mul32x32_64(h4, s1);\n+  t[1] = mul32x32_64(h0, r1) + mul32x32_64(h1, r0) + mul32x32_64(h2, s4) +\n+         mul32x32_64(h3, s3) + mul32x32_64(h4, s2);\n+  t[2] = mul32x32_64(h0, r2) + mul32x32_64(h1, r1) + mul32x32_64(h2, r0) +\n+         mul32x32_64(h3, s4) + mul32x32_64(h4, s3);\n+  t[3] = mul32x32_64(h0, r3) + mul32x32_64(h1, r2) + mul32x32_64(h2, r1) +\n+         mul32x32_64(h3, r0) + mul32x32_64(h4, s4);\n+  t[4] = mul32x32_64(h0, r4) + mul32x32_64(h1, r3) + mul32x32_64(h2, r2) +\n+         mul32x32_64(h3, r1) + mul32x32_64(h4, r0);\n+\n+  h0 = (uint32_t)t[0] & 0x3ffffff;\n+  c = (t[0] >> 26);\n+  t[1] += c;\n+  h1 = (uint32_t)t[1] & 0x3ffffff;\n+  b = (uint32_t)(t[1] >> 26);\n+  t[2] += b;\n+  h2 = (uint32_t)t[2] & 0x3ffffff;\n+  b = (uint32_t)(t[2] >> 26);\n+  t[3] += b;\n+  h3 = (uint32_t)t[3] & 0x3ffffff;\n+  b = (uint32_t)(t[3] >> 26);\n+  t[4] += b;\n+  h4 = (uint32_t)t[4] & 0x3ffffff;\n+  b = (uint32_t)(t[4] >> 26);\n+  h0 += b * 5;\n+\n+  if (inlen >= 16)\n+    goto poly1305_donna_16bytes;\n+\n+/* final bytes */\n+poly1305_donna_atmost15bytes:\n+  if (!inlen)\n+    goto poly1305_donna_finish;\n+\n+  for (j = 0; j < inlen; j++)\n+    mp[j] = m[j];\n+  mp[j++] = 1;\n+  for (; j < 16; j++)\n+    mp[j] = 0;\n+  inlen = 0;\n+\n+  t0 = U8TO32_LE(mp + 0);\n+  t1 = U8TO32_LE(mp + 4);\n+  t2 = U8TO32_LE(mp + 8);\n+  t3 = U8TO32_LE(mp + 12);\n+\n+  h0 += t0 & 0x3ffffff;\n+  h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+  h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+  h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+  h4 += (t3 >> 8);\n+\n+  goto poly1305_donna_mul;\n+\n+poly1305_donna_finish:\n+  b = h0 >> 26;\n+  h0 = h0 & 0x3ffffff;\n+  h1 += b;\n+  b = h1 >> 26;\n+  h1 = h1 & 0x3ffffff;\n+  h2 += b;\n+  b = h2 >> 26;\n+  h2 = h2 & 0x3ffffff;\n+  h3 += b;\n+  b = h3 >> 26;\n+  h3 = h3 & 0x3ffffff;\n+  h4 += b;\n+  b = h4 >> 26;\n+  h4 = h4 & 0x3ffffff;\n+  h0 += b * 5;\n+  b = h0 >> 26;\n+  h0 = h0 & 0x3ffffff;\n+  h1 += b;\n+\n+  g0 = h0 + 5;\n+  b = g0 >> 26;\n+  g0 &= 0x3ffffff;\n+  g1 = h1 + b;\n+  b = g1 >> 26;\n+  g1 &= 0x3ffffff;\n+  g2 = h2 + b;\n+  b = g2 >> 26;\n+  g2 &= 0x3ffffff;\n+  g3 = h3 + b;\n+  b = g3 >> 26;\n+  g3 &= 0x3ffffff;\n+  g4 = h4 + b - (1 << 26);\n+\n+  b = (g4 >> 31) - 1;\n+  nb = ~b;\n+  h0 = (h0 & nb) | (g0 & b);\n+  h1 = (h1 & nb) | (g1 & b);\n+  h2 = (h2 & nb) | (g2 & b);\n+  h3 = (h3 & nb) | (g3 & b);\n+  h4 = (h4 & nb) | (g4 & b);\n+\n+  f0 = ((h0) | (h1 << 26)) + (uint64_t)U8TO32_LE(&key[16]);",
      "path": "src/crypto/poly1305.cpp",
      "position": 186,
      "original_position": 186,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Just to double check: This bit shifting takes place on a 32-bit value which is then expanded to a 64-bit type. That is the intention? Applies to `h1 << 26`, `h2 << 20`, `h3 << 14` and `h4 << 8`.",
      "created_at": "2018-09-12T09:52:14Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r216966884",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216966884"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 186,
      "original_line": 186,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/217071702",
      "pull_request_review_id": 154698661,
      "id": 217071702,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNzA3MTcwMg==",
      "diff_hunk": "@@ -562,4 +564,198 @@ BOOST_AUTO_TEST_CASE(sha256d64)\n     }\n }\n \n+\n+BOOST_AUTO_TEST_CASE(chacha20poly1305_openssh)\n+{\n+    struct chacha20_testvector {\n+        uint8_t key[32];\n+        uint8_t nonce[8];\n+        uint8_t resulting_keystream[512];\n+        int keystream_check_size;\n+    };\n+\n+    struct poly1305_testvector {\n+        uint8_t input[64];\n+        int inputlen;\n+        uint8_t key[64];\n+        uint8_t resulting_tag[16];\n+    };\n+\n+    /*\n+       Testvectors have been taken from the draft RFC\n+       https://tools.ietf.org/html/draft-agl-tls-chacha20poly1305-04#section-7\n+    */\n+\n+    static const struct chacha20_testvector chacha20_testvectors[] = {\n+        {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},\n+            {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},\n+            {0x76, 0xb8, 0xe0, 0xad, 0xa0, 0xf1, 0x3d, 0x90, 0x40, 0x5d, 0x6a,\n+                0xe5, 0x53, 0x86, 0xbd, 0x28, 0xbd, 0xd2, 0x19, 0xb8, 0xa0, 0x8d,\n+                0xed, 0x1a, 0xa8, 0x36, 0xef, 0xcc, 0x8b, 0x77, 0x0d, 0xc7, 0xda,\n+                0x41, 0x59, 0x7c, 0x51, 0x57, 0x48, 0x8d, 0x77, 0x24, 0xe0, 0x3f,\n+                0xb8, 0xd8, 0x4a, 0x37, 0x6a, 0x43, 0xb8, 0xf4, 0x15, 0x18, 0xa1,\n+                0x1c, 0xc3, 0x87, 0xb6, 0x69, 0xb2, 0xee, 0x65, 0x86},\n+            64},\n+        {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01},\n+            {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},\n+            {0x45, 0x40, 0xf0, 0x5a, 0x9f, 0x1f, 0xb2, 0x96, 0xd7, 0x73, 0x6e,\n+                0x7b, 0x20, 0x8e, 0x3c, 0x96, 0xeb, 0x4f, 0xe1, 0x83, 0x46, 0x88,\n+                0xd2, 0x60, 0x4f, 0x45, 0x09, 0x52, 0xed, 0x43, 0x2d, 0x41, 0xbb,\n+                0xe2, 0xa0, 0xb6, 0xea, 0x75, 0x66, 0xd2, 0xa5, 0xd1, 0xe7, 0xe2,\n+                0x0d, 0x42, 0xaf, 0x2c, 0x53, 0xd7, 0x92, 0xb1, 0xc4, 0x3f, 0xea,\n+                0x81, 0x7e, 0x9a, 0xd2, 0x75, 0xae, 0x54, 0x69, 0x63},\n+            64},\n+        {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},\n+            {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01},\n+            {0xde, 0x9c, 0xba, 0x7b, 0xf3, 0xd6, 0x9e, 0xf5, 0xe7, 0x86, 0xdc, 0x63,\n+                0x97, 0x3f, 0x65, 0x3a, 0x0b, 0x49, 0xe0, 0x15, 0xad, 0xbf, 0xf7, 0x13,\n+                0x4f, 0xcb, 0x7d, 0xf1, 0x37, 0x82, 0x10, 0x31, 0xe8, 0x5a, 0x05, 0x02,\n+                0x78, 0xa7, 0x08, 0x45, 0x27, 0x21, 0x4f, 0x73, 0xef, 0xc7, 0xfa, 0x5b,\n+                0x52, 0x77, 0x06, 0x2e, 0xb7, 0xa0, 0x43, 0x3e, 0x44, 0x5f, 0x41, 0xe3},\n+            60},\n+        {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+             0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},\n+            {0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},\n+            {0xef, 0x3f, 0xdf, 0xd6, 0xc6, 0x15, 0x78, 0xfb, 0xf5, 0xcf, 0x35,\n+                0xbd, 0x3d, 0xd3, 0x3b, 0x80, 0x09, 0x63, 0x16, 0x34, 0xd2, 0x1e,\n+                0x42, 0xac, 0x33, 0x96, 0x0b, 0xd1, 0x38, 0xe5, 0x0d, 0x32, 0x11,\n+                0x1e, 0x4c, 0xaf, 0x23, 0x7e, 0xe5, 0x3c, 0xa8, 0xad, 0x64, 0x26,\n+                0x19, 0x4a, 0x88, 0x54, 0x5d, 0xdc, 0x49, 0x7a, 0x0b, 0x46, 0x6e,\n+                0x7d, 0x6b, 0xbd, 0xb0, 0x04, 0x1b, 0x2f, 0x58, 0x6b},\n+            64},\n+        {{0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a,\n+             0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15,\n+             0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f},\n+            {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07},\n+            {0xf7, 0x98, 0xa1, 0x89, 0xf1, 0x95, 0xe6, 0x69, 0x82, 0x10, 0x5f, 0xfb,\n+                0x64, 0x0b, 0xb7, 0x75, 0x7f, 0x57, 0x9d, 0xa3, 0x16, 0x02, 0xfc, 0x93,\n+                0xec, 0x01, 0xac, 0x56, 0xf8, 0x5a, 0xc3, 0xc1, 0x34, 0xa4, 0x54, 0x7b,\n+                0x73, 0x3b, 0x46, 0x41, 0x30, 0x42, 0xc9, 0x44, 0x00, 0x49, 0x17, 0x69,\n+                0x05, 0xd3, 0xbe, 0x59, 0xea, 0x1c, 0x53, 0xf1, 0x59, 0x16, 0x15, 0x5c,\n+                0x2b, 0xe8, 0x24, 0x1a, 0x38, 0x00, 0x8b, 0x9a, 0x26, 0xbc, 0x35, 0x94,\n+                0x1e, 0x24, 0x44, 0x17, 0x7c, 0x8a, 0xde, 0x66, 0x89, 0xde, 0x95, 0x26,\n+                0x49, 0x86, 0xd9, 0x58, 0x89, 0xfb, 0x60, 0xe8, 0x46, 0x29, 0xc9, 0xbd,\n+                0x9a, 0x5a, 0xcb, 0x1c, 0xc1, 0x18, 0xbe, 0x56, 0x3e, 0xb9, 0xb3, 0xa4,\n+                0xa4, 0x72, 0xf8, 0x2e, 0x09, 0xa7, 0xe7, 0x78, 0x49, 0x2b, 0x56, 0x2e,\n+                0xf7, 0x13, 0x0e, 0x88, 0xdf, 0xe0, 0x31, 0xc7, 0x9d, 0xb9, 0xd4, 0xf7,\n+                0xc7, 0xa8, 0x99, 0x15, 0x1b, 0x9a, 0x47, 0x50, 0x32, 0xb6, 0x3f, 0xc3,\n+                0x85, 0x24, 0x5f, 0xe0, 0x54, 0xe3, 0xdd, 0x5a, 0x97, 0xa5, 0xf5, 0x76,\n+                0xfe, 0x06, 0x40, 0x25, 0xd3, 0xce, 0x04, 0x2c, 0x56, 0x6a, 0xb2, 0xc5,\n+                0x07, 0xb1, 0x38, 0xdb, 0x85, 0x3e, 0x3d, 0x69, 0x59, 0x66, 0x09, 0x96,\n+                0x54, 0x6c, 0xc9, 0xc4, 0xa6, 0xea, 0xfd, 0xc7, 0x77, 0xc0, 0x40, 0xd7,\n+                0x0e, 0xaf, 0x46, 0xf7, 0x6d, 0xad, 0x39, 0x79, 0xe5, 0xc5, 0x36, 0x0c,\n+                0x33, 0x17, 0x16, 0x6a, 0x1c, 0x89, 0x4c, 0x94, 0xa3, 0x71, 0x87, 0x6a,\n+                0x94, 0xdf, 0x76, 0x28, 0xfe, 0x4e, 0xaa, 0xf2, 0xcc, 0xb2, 0x7d, 0x5a,\n+                0xaa, 0xe0, 0xad, 0x7a, 0xd0, 0xf9, 0xd4, 0xb6, 0xad, 0x3b, 0x54, 0x09,\n+                0x87, 0x46, 0xd4, 0x52, 0x4d, 0x38, 0x40, 0x7a, 0x6d, 0xeb, 0x3a, 0xb7,\n+                0x8f, 0xab, 0x78, 0xc9},\n+            256}};\n+\n+    static const struct poly1305_testvector poly1305_testvectors[] = {\n+        {\n+            {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},\n+            32,\n+            {0x74, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20, 0x33, 0x32, 0x2d,\n+                0x62, 0x79, 0x74, 0x65, 0x20, 0x6b, 0x65, 0x79, 0x20, 0x66, 0x6f,\n+                0x72, 0x20, 0x50, 0x6f, 0x6c, 0x79, 0x31, 0x33, 0x30, 0x35},\n+            {0x49, 0xec, 0x78, 0x09, 0x0e, 0x48, 0x1e, 0xc6, 0xc2, 0x6b, 0x33, 0xb9,\n+                0x1c, 0xcc, 0x03, 0x07},\n+        },\n+        {{0x48, 0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21},\n+            12,\n+            {0x74, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20, 0x33, 0x32, 0x2d,\n+                0x62, 0x79, 0x74, 0x65, 0x20, 0x6b, 0x65, 0x79, 0x20, 0x66, 0x6f,\n+                0x72, 0x20, 0x50, 0x6f, 0x6c, 0x79, 0x31, 0x33, 0x30, 0x35},\n+            {0xa6, 0xf7, 0x45, 0x00, 0x8f, 0x81, 0xc9, 0x16, 0xa2, 0x0d, 0xcc, 0x74,\n+                0xee, 0xf2, 0xb2, 0xf0}}};\n+\n+    struct chacha_ctx ctx;\n+    unsigned int i = 0;\n+    uint8_t keystream[512];\n+    uint8_t poly1305_tag[16];\n+\n+    /* test chacha20 */\n+    for (i = 0;\n+         i < (sizeof(chacha20_testvectors) / sizeof(chacha20_testvectors[0]));\n+         i++) {\n+        chacha_ivsetup(&ctx, chacha20_testvectors[i].nonce, NULL);\n+        memset(keystream, 0, 512);\n+        chacha_keysetup(&ctx, chacha20_testvectors[i].key, 256);\n+        chacha_encrypt_bytes(&ctx, keystream, keystream, 512);\n+        assert(memcmp(keystream, chacha20_testvectors[i].resulting_keystream,\n+                   chacha20_testvectors[i].keystream_check_size) == 0);\n+    }\n+\n+    /* test poly1305 */\n+    for (i = 0;\n+         i < (sizeof(poly1305_testvectors) / sizeof(poly1305_testvectors[0]));\n+         i++) {\n+        memset(poly1305_tag, 0, 16);\n+        poly1305_auth(poly1305_tag, poly1305_testvectors[i].input,\n+            poly1305_testvectors[i].inputlen,\n+            poly1305_testvectors[i].key);\n+        assert(memcmp(poly1305_tag, poly1305_testvectors[i].resulting_tag, 16) ==\n+               0);\n+    }\n+\n+    /* test chacha20poly1305 AEAD */\n+    struct chachapolyaead_ctx aead_ctx;\n+    uint32_t seqnr = 100;\n+    uint8_t aead_keys[64] = {\n+        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a,\n+        0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15,\n+        0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f, 0x00,\n+        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};\n+\n+    uint8_t plaintext_buf[255] = {\n+        0xff, 0x00, 0x00, 0xf1, 0x95, 0xe6, 0x69, 0x82, 0x10, 0x5f, 0xfb,\n+        0x64, 0x0b, 0xb7, 0x75, 0x7f, 0x57, 0x9d, 0xa3, 0x16, 0x02, 0xfc, 0x93,\n+        0xec, 0x01, 0xac, 0x56, 0xf8, 0x5a, 0xc3, 0xc1, 0x34, 0xa4, 0x54, 0x7b,\n+        0x73, 0x3b, 0x46, 0x41, 0x30, 0x42, 0xc9, 0x44, 0x00, 0x49, 0x17, 0x69,\n+        0x05, 0xd3, 0xbe, 0x59, 0xea, 0x1c, 0x53, 0xf1, 0x59, 0x16, 0x15, 0x5c,\n+        0x2b, 0xe8, 0x24, 0x1a, 0x38, 0x00, 0x8b, 0x9a, 0x26, 0xbc, 0x35, 0x94,\n+        0x1e, 0x24, 0x44, 0x17, 0x7c, 0x8a, 0xde, 0x66, 0x89, 0xde, 0x95, 0x26,\n+        0x49, 0x86, 0xd9, 0x58, 0x89, 0xfb, 0x60, 0xe8, 0x46, 0x29, 0xc9, 0xbd,\n+        0x9a, 0x5a, 0xcb, 0x1c, 0xc1, 0x18, 0xbe, 0x56, 0x3e, 0xb9, 0xb3, 0xa4,\n+        0xa4, 0x72, 0xf8, 0x2e, 0x09, 0xa7, 0xe7, 0x78, 0x49, 0x2b, 0x56, 0x2e,\n+        0xf7, 0x13, 0x0e, 0x88, 0xdf, 0xe0, 0x31, 0xc7, 0x9d, 0xb9, 0xd4, 0xf7,\n+        0xc7, 0xa8, 0x99, 0x15, 0x1b, 0x9a, 0x47, 0x50, 0x32, 0xb6, 0x3f, 0xc3,\n+        0x85, 0x24, 0x5f, 0xe0, 0x54, 0xe3, 0xdd, 0x5a, 0x97, 0xa5, 0xf5, 0x76,\n+        0xfe, 0x06, 0x40, 0x25, 0xd3, 0xce, 0x04, 0x2c, 0x56, 0x6a, 0xb2, 0xc5,\n+        0x07, 0xb1, 0x38, 0xdb, 0x85, 0x3e, 0x3d, 0x69, 0x59, 0x66, 0x09, 0x96,\n+        0x54, 0x6c, 0xc9, 0xc4, 0xa6, 0xea, 0xfd, 0xc7, 0x77, 0xc0, 0x40, 0xd7,\n+        0x0e, 0xaf, 0x46, 0xf7, 0x6d, 0xad, 0x39, 0x79, 0xe5, 0xc5, 0x36, 0x0c,\n+        0x33, 0x17, 0x16, 0x6a, 0x1c, 0x89, 0x4c, 0x94, 0xa3, 0x71, 0x87, 0x6a,\n+        0x94, 0xdf, 0x76, 0x28, 0xfe, 0x4e, 0xaa, 0xf2, 0xcc, 0xb2, 0x7d, 0x5a,\n+        0xaa, 0xe0, 0xad, 0x7a, 0xd0, 0xf9, 0xd4, 0xb6, 0xad, 0x3b, 0x54, 0x09,\n+        0x87, 0x46, 0xd4, 0x52, 0x4d, 0x38, 0x40, 0x7a, 0x6d, 0xeb, 0x3a, 0xb7,\n+        0x8f, 0xab, 0x78, 0xc9};\n+\n+    uint8_t ciphertext_buf[300];\n+    uint8_t plaintext_buf_new[256];\n+    memset(ciphertext_buf, 0, 300);\n+    memset(plaintext_buf_new, 0, 256);\n+    chacha20poly1305_init(&aead_ctx, aead_keys, 64);\n+    assert((uint32_t)plaintext_buf[0] == 255);\n+    chacha20poly1305_crypt(&aead_ctx, seqnr, ciphertext_buf, plaintext_buf, 252,\n+        3, 1);\n+    uint32_t out_len = 0;\n+    chacha20poly1305_get_length24(&aead_ctx, &out_len, seqnr, ciphertext_buf);\n+    assert(out_len == 255);\n+    chacha20poly1305_crypt(&aead_ctx, seqnr, plaintext_buf_new, ciphertext_buf,\n+        252, 3, 0);\n+    assert(memcmp(plaintext_buf, plaintext_buf_new, 252) == 0);",
      "path": "src/test/crypto_tests.cpp",
      "position": null,
      "original_position": 214,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Shouldn't this be `assert(memcmp(plaintext_buf, plaintext_buf_new, 255) == 0); `  or `assert(memcmp(plaintext_buf, plaintext_buf_new, sizeof(plaintext_buf)) == 0);`?",
      "created_at": "2018-09-12T15:08:09Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r217071702",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/217071702"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 758,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463737",
      "pull_request_review_id": 160119097,
      "id": 221463737,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ2MzczNw==",
      "diff_hunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Public Domain poly1305 from Andrew Moon\n+ * poly1305-donna-unrolled.c from https://github.com/floodyberry/poly1305-donna\n+ */\n+\n+/* $OpenBSD: poly1305.c,v 1.3 2013/12/19 22:57:13 djm Exp $ */\n+\n+#include <crypto/poly1305.h>\n+\n+#define mul32x32_64(a, b) ((uint64_t)(a) * (b))\n+\n+#define U8TO32_LE(p)                                                           \\\n+  (((uint32_t)((p)[0])) | ((uint32_t)((p)[1]) << 8) |                          \\\n+   ((uint32_t)((p)[2]) << 16) | ((uint32_t)((p)[3]) << 24))\n+\n+#define U32TO8_LE(p, v)                                                        \\\n+  do {                                                                         \\\n+    (p)[0] = (uint8_t)((v));                                                   \\\n+    (p)[1] = (uint8_t)((v) >> 8);                                              \\\n+    (p)[2] = (uint8_t)((v) >> 16);                                             \\\n+    (p)[3] = (uint8_t)((v) >> 24);                                             \\\n+  } while (0)\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m,\n+                   size_t inlen, const unsigned char key[POLY1305_KEYLEN]) {\n+  uint32_t t0, t1, t2, t3;\n+  uint32_t h0, h1, h2, h3, h4;\n+  uint32_t r0, r1, r2, r3, r4;\n+  uint32_t s1, s2, s3, s4;\n+  uint32_t b, nb;\n+  size_t j;\n+  uint64_t t[5];\n+  uint64_t f0, f1, f2, f3;\n+  uint32_t g0, g1, g2, g3, g4;\n+  uint64_t c;\n+  unsigned char mp[16];\n+\n+  /* clamp key */\n+  t0 = U8TO32_LE(key + 0);\n+  t1 = U8TO32_LE(key + 4);\n+  t2 = U8TO32_LE(key + 8);\n+  t3 = U8TO32_LE(key + 12);\n+\n+  /* precompute multipliers */\n+  r0 = t0 & 0x3ffffff;\n+  t0 >>= 26;\n+  t0 |= t1 << 6;\n+  r1 = t0 & 0x3ffff03;\n+  t1 >>= 20;\n+  t1 |= t2 << 12;\n+  r2 = t1 & 0x3ffc0ff;\n+  t2 >>= 14;\n+  t2 |= t3 << 18;\n+  r3 = t2 & 0x3f03fff;\n+  t3 >>= 8;\n+  r4 = t3 & 0x00fffff;\n+\n+  s1 = r1 * 5;\n+  s2 = r2 * 5;\n+  s3 = r3 * 5;\n+  s4 = r4 * 5;\n+\n+  /* init state */\n+  h0 = 0;\n+  h1 = 0;\n+  h2 = 0;\n+  h3 = 0;\n+  h4 = 0;\n+\n+  /* full blocks */\n+  if (inlen < 16)\n+    goto poly1305_donna_atmost15bytes;\n+poly1305_donna_16bytes:\n+  m += 16;\n+  inlen -= 16;\n+\n+  t0 = U8TO32_LE(m - 16);\n+  t1 = U8TO32_LE(m - 12);\n+  t2 = U8TO32_LE(m - 8);\n+  t3 = U8TO32_LE(m - 4);\n+\n+  h0 += t0 & 0x3ffffff;\n+  h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+  h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+  h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+  h4 += (t3 >> 8) | (1 << 24);\n+\n+poly1305_donna_mul:\n+  t[0] = mul32x32_64(h0, r0) + mul32x32_64(h1, s4) + mul32x32_64(h2, s3) +\n+         mul32x32_64(h3, s2) + mul32x32_64(h4, s1);\n+  t[1] = mul32x32_64(h0, r1) + mul32x32_64(h1, r0) + mul32x32_64(h2, s4) +\n+         mul32x32_64(h3, s3) + mul32x32_64(h4, s2);\n+  t[2] = mul32x32_64(h0, r2) + mul32x32_64(h1, r1) + mul32x32_64(h2, r0) +\n+         mul32x32_64(h3, s4) + mul32x32_64(h4, s3);\n+  t[3] = mul32x32_64(h0, r3) + mul32x32_64(h1, r2) + mul32x32_64(h2, r1) +\n+         mul32x32_64(h3, r0) + mul32x32_64(h4, s4);\n+  t[4] = mul32x32_64(h0, r4) + mul32x32_64(h1, r3) + mul32x32_64(h2, r2) +\n+         mul32x32_64(h3, r1) + mul32x32_64(h4, r0);\n+\n+  h0 = (uint32_t)t[0] & 0x3ffffff;\n+  c = (t[0] >> 26);\n+  t[1] += c;\n+  h1 = (uint32_t)t[1] & 0x3ffffff;\n+  b = (uint32_t)(t[1] >> 26);\n+  t[2] += b;\n+  h2 = (uint32_t)t[2] & 0x3ffffff;\n+  b = (uint32_t)(t[2] >> 26);\n+  t[3] += b;\n+  h3 = (uint32_t)t[3] & 0x3ffffff;\n+  b = (uint32_t)(t[3] >> 26);\n+  t[4] += b;\n+  h4 = (uint32_t)t[4] & 0x3ffffff;\n+  b = (uint32_t)(t[4] >> 26);\n+  h0 += b * 5;\n+\n+  if (inlen >= 16)\n+    goto poly1305_donna_16bytes;\n+\n+/* final bytes */\n+poly1305_donna_atmost15bytes:\n+  if (!inlen)\n+    goto poly1305_donna_finish;\n+\n+  for (j = 0; j < inlen; j++)\n+    mp[j] = m[j];\n+  mp[j++] = 1;\n+  for (; j < 16; j++)\n+    mp[j] = 0;\n+  inlen = 0;\n+\n+  t0 = U8TO32_LE(mp + 0);\n+  t1 = U8TO32_LE(mp + 4);\n+  t2 = U8TO32_LE(mp + 8);\n+  t3 = U8TO32_LE(mp + 12);\n+\n+  h0 += t0 & 0x3ffffff;\n+  h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+  h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+  h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+  h4 += (t3 >> 8);\n+\n+  goto poly1305_donna_mul;\n+\n+poly1305_donna_finish:\n+  b = h0 >> 26;\n+  h0 = h0 & 0x3ffffff;\n+  h1 += b;\n+  b = h1 >> 26;\n+  h1 = h1 & 0x3ffffff;\n+  h2 += b;\n+  b = h2 >> 26;\n+  h2 = h2 & 0x3ffffff;\n+  h3 += b;\n+  b = h3 >> 26;\n+  h3 = h3 & 0x3ffffff;\n+  h4 += b;\n+  b = h4 >> 26;\n+  h4 = h4 & 0x3ffffff;\n+  h0 += b * 5;\n+  b = h0 >> 26;\n+  h0 = h0 & 0x3ffffff;\n+  h1 += b;\n+\n+  g0 = h0 + 5;\n+  b = g0 >> 26;\n+  g0 &= 0x3ffffff;\n+  g1 = h1 + b;\n+  b = g1 >> 26;\n+  g1 &= 0x3ffffff;\n+  g2 = h2 + b;\n+  b = g2 >> 26;\n+  g2 &= 0x3ffffff;\n+  g3 = h3 + b;\n+  b = g3 >> 26;\n+  g3 &= 0x3ffffff;\n+  g4 = h4 + b - (1 << 26);",
      "path": "src/crypto/poly1305.cpp",
      "position": 176,
      "original_position": 176,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "An unsigned integer wraparound takes place here which is triggered by the tests. Worth adding a comment to make it clear it is intentional?",
      "created_at": "2018-09-30T15:50:11Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221463737",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463737"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 176,
      "original_line": 176,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463804",
      "pull_request_review_id": 160119178,
      "id": 221463804,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ2MzgwNA==",
      "diff_hunk": "@@ -0,0 +1,90 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+#include <support/cleanse.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *ctx, const uint8_t *key,\n+                          int keylen) {\n+  if (keylen != (32 + 32)) /* 2 x 256 bit keys */\n+    return -1;\n+  chacha_keysetup(&ctx->main_ctx, key, 256);\n+  chacha_keysetup(&ctx->header_ctx, key + 32, 256);\n+  return 0;\n+}\n+\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt) {\n+  const uint8_t one[8] = {1, 0, 0, 0, 0, 0, 0, 0}; /* NB little-endian */\n+  uint8_t expected_tag[POLY1305_TAGLEN], poly_key[POLY1305_KEYLEN];\n+  int r = -1;",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is a dead store :-)\r\n\r\nInitialize to zero instead and remove the `r = 0` below?",
      "created_at": "2018-09-30T15:53:04Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221463804",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463804"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 37,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463848",
      "pull_request_review_id": 160119209,
      "id": 221463848,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ2Mzg0OA==",
      "diff_hunk": "@@ -0,0 +1,90 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+#include <support/cleanse.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *ctx, const uint8_t *key,\n+                          int keylen) {\n+  if (keylen != (32 + 32)) /* 2 x 256 bit keys */\n+    return -1;\n+  chacha_keysetup(&ctx->main_ctx, key, 256);\n+  chacha_keysetup(&ctx->header_ctx, key + 32, 256);\n+  return 0;\n+}\n+\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt) {\n+  const uint8_t one[8] = {1, 0, 0, 0, 0, 0, 0, 0}; /* NB little-endian */\n+  uint8_t expected_tag[POLY1305_TAGLEN], poly_key[POLY1305_KEYLEN];\n+  int r = -1;\n+\n+  uint64_t seqnr64 = seqnr;\n+  uint64_t chacha_iv = htole64(seqnr64);\n+  memset(poly_key, 0, sizeof(poly_key));\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, NULL);",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": 46,
      "original_position": 42,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Use `nullptr` :-)",
      "created_at": "2018-09-30T15:54:30Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221463848",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463848"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 46,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463855",
      "pull_request_review_id": 160119217,
      "id": 221463855,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ2Mzg1NQ==",
      "diff_hunk": "@@ -0,0 +1,90 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+#include <support/cleanse.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *ctx, const uint8_t *key,\n+                          int keylen) {\n+  if (keylen != (32 + 32)) /* 2 x 256 bit keys */\n+    return -1;\n+  chacha_keysetup(&ctx->main_ctx, key, 256);\n+  chacha_keysetup(&ctx->header_ctx, key + 32, 256);\n+  return 0;\n+}\n+\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt) {\n+  const uint8_t one[8] = {1, 0, 0, 0, 0, 0, 0, 0}; /* NB little-endian */\n+  uint8_t expected_tag[POLY1305_TAGLEN], poly_key[POLY1305_KEYLEN];\n+  int r = -1;\n+\n+  uint64_t seqnr64 = seqnr;\n+  uint64_t chacha_iv = htole64(seqnr64);\n+  memset(poly_key, 0, sizeof(poly_key));\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, NULL);\n+  chacha_encrypt_bytes(&ctx->main_ctx, poly_key, poly_key, sizeof(poly_key));\n+\n+  if (!is_encrypt) {\n+    const uint8_t *tag = src + aadlen + len;\n+\n+    poly1305_auth(expected_tag, src, aadlen + len, poly_key);\n+    if (timingsafe_bcmp(expected_tag, tag, POLY1305_TAGLEN) != 0) {\n+      r = -1;\n+      goto out;\n+    }\n+  }\n+\n+  if (aadlen) {\n+    chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&chacha_iv, NULL);",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": 60,
      "original_position": 56,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Use `nullptr` :-)",
      "created_at": "2018-09-30T15:54:45Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221463855",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463855"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 60,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463861",
      "pull_request_review_id": 160119222,
      "id": 221463861,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ2Mzg2MQ==",
      "diff_hunk": "@@ -0,0 +1,90 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+#include <support/cleanse.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *ctx, const uint8_t *key,\n+                          int keylen) {\n+  if (keylen != (32 + 32)) /* 2 x 256 bit keys */\n+    return -1;\n+  chacha_keysetup(&ctx->main_ctx, key, 256);\n+  chacha_keysetup(&ctx->header_ctx, key + 32, 256);\n+  return 0;\n+}\n+\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt) {\n+  const uint8_t one[8] = {1, 0, 0, 0, 0, 0, 0, 0}; /* NB little-endian */\n+  uint8_t expected_tag[POLY1305_TAGLEN], poly_key[POLY1305_KEYLEN];\n+  int r = -1;\n+\n+  uint64_t seqnr64 = seqnr;\n+  uint64_t chacha_iv = htole64(seqnr64);\n+  memset(poly_key, 0, sizeof(poly_key));\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, NULL);\n+  chacha_encrypt_bytes(&ctx->main_ctx, poly_key, poly_key, sizeof(poly_key));\n+\n+  if (!is_encrypt) {\n+    const uint8_t *tag = src + aadlen + len;\n+\n+    poly1305_auth(expected_tag, src, aadlen + len, poly_key);\n+    if (timingsafe_bcmp(expected_tag, tag, POLY1305_TAGLEN) != 0) {\n+      r = -1;\n+      goto out;\n+    }\n+  }\n+\n+  if (aadlen) {\n+    chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&chacha_iv, NULL);\n+    chacha_encrypt_bytes(&ctx->header_ctx, src, dest, aadlen);\n+  }\n+\n+  /* Set Chacha's block counter to 1 */\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, one);\n+  chacha_encrypt_bytes(&ctx->main_ctx, src + aadlen, dest + aadlen, len);\n+\n+  /* If encrypting, calculate and append tag */\n+  if (is_encrypt) {\n+    poly1305_auth(dest + aadlen + len, dest, aadlen + len, poly_key);\n+  }\n+  r = 0;\n+out:\n+  memory_cleanse(expected_tag, sizeof(expected_tag));\n+  memory_cleanse(&chacha_iv, sizeof(chacha_iv));\n+  memory_cleanse(poly_key, sizeof(poly_key));\n+  return r;\n+}\n+\n+int chacha20poly1305_get_length24(struct chachapolyaead_ctx *ctx,\n+                                uint32_t *len24_out, uint32_t seqnr,\n+                                const uint8_t *ciphertext) {\n+  uint8_t buf[3];\n+\n+  uint64_t seqnr64 = htole64(seqnr); //use LE for the nonce\n+  chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&seqnr64, NULL);",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": 85,
      "original_position": 82,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Use `nullptr` :-)",
      "created_at": "2018-09-30T15:54:59Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221463861",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221463861"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 85,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221594295",
      "pull_request_review_id": 160277293,
      "id": 221594295,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTU5NDI5NQ==",
      "diff_hunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Public Domain poly1305 from Andrew Moon\n+ * poly1305-donna-unrolled.c from https://github.com/floodyberry/poly1305-donna\n+ */\n+\n+/* $OpenBSD: poly1305.c,v 1.3 2013/12/19 22:57:13 djm Exp $ */\n+\n+#include <crypto/poly1305.h>\n+\n+#define mul32x32_64(a, b) ((uint64_t)(a) * (b))\n+\n+#define U8TO32_LE(p)                                                           \\\n+  (((uint32_t)((p)[0])) | ((uint32_t)((p)[1]) << 8) |                          \\\n+   ((uint32_t)((p)[2]) << 16) | ((uint32_t)((p)[3]) << 24))\n+\n+#define U32TO8_LE(p, v)                                                        \\\n+  do {                                                                         \\\n+    (p)[0] = (uint8_t)((v));                                                   \\\n+    (p)[1] = (uint8_t)((v) >> 8);                                              \\\n+    (p)[2] = (uint8_t)((v) >> 16);                                             \\\n+    (p)[3] = (uint8_t)((v) >> 24);                                             \\\n+  } while (0)\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m,\n+                   size_t inlen, const unsigned char key[POLY1305_KEYLEN]) {\n+  uint32_t t0, t1, t2, t3;\n+  uint32_t h0, h1, h2, h3, h4;\n+  uint32_t r0, r1, r2, r3, r4;\n+  uint32_t s1, s2, s3, s4;\n+  uint32_t b, nb;\n+  size_t j;\n+  uint64_t t[5];\n+  uint64_t f0, f1, f2, f3;\n+  uint32_t g0, g1, g2, g3, g4;\n+  uint64_t c;\n+  unsigned char mp[16];\n+\n+  /* clamp key */\n+  t0 = U8TO32_LE(key + 0);\n+  t1 = U8TO32_LE(key + 4);\n+  t2 = U8TO32_LE(key + 8);\n+  t3 = U8TO32_LE(key + 12);\n+\n+  /* precompute multipliers */\n+  r0 = t0 & 0x3ffffff;\n+  t0 >>= 26;\n+  t0 |= t1 << 6;\n+  r1 = t0 & 0x3ffff03;\n+  t1 >>= 20;\n+  t1 |= t2 << 12;\n+  r2 = t1 & 0x3ffc0ff;\n+  t2 >>= 14;\n+  t2 |= t3 << 18;\n+  r3 = t2 & 0x3f03fff;\n+  t3 >>= 8;\n+  r4 = t3 & 0x00fffff;\n+\n+  s1 = r1 * 5;\n+  s2 = r2 * 5;\n+  s3 = r3 * 5;\n+  s4 = r4 * 5;\n+\n+  /* init state */\n+  h0 = 0;\n+  h1 = 0;\n+  h2 = 0;\n+  h3 = 0;\n+  h4 = 0;\n+\n+  /* full blocks */\n+  if (inlen < 16)\n+    goto poly1305_donna_atmost15bytes;\n+poly1305_donna_16bytes:\n+  m += 16;\n+  inlen -= 16;\n+\n+  t0 = U8TO32_LE(m - 16);\n+  t1 = U8TO32_LE(m - 12);\n+  t2 = U8TO32_LE(m - 8);\n+  t3 = U8TO32_LE(m - 4);\n+\n+  h0 += t0 & 0x3ffffff;\n+  h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+  h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+  h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+  h4 += (t3 >> 8) | (1 << 24);\n+\n+poly1305_donna_mul:\n+  t[0] = mul32x32_64(h0, r0) + mul32x32_64(h1, s4) + mul32x32_64(h2, s3) +\n+         mul32x32_64(h3, s2) + mul32x32_64(h4, s1);\n+  t[1] = mul32x32_64(h0, r1) + mul32x32_64(h1, r0) + mul32x32_64(h2, s4) +\n+         mul32x32_64(h3, s3) + mul32x32_64(h4, s2);\n+  t[2] = mul32x32_64(h0, r2) + mul32x32_64(h1, r1) + mul32x32_64(h2, r0) +\n+         mul32x32_64(h3, s4) + mul32x32_64(h4, s3);\n+  t[3] = mul32x32_64(h0, r3) + mul32x32_64(h1, r2) + mul32x32_64(h2, r1) +\n+         mul32x32_64(h3, r0) + mul32x32_64(h4, s4);\n+  t[4] = mul32x32_64(h0, r4) + mul32x32_64(h1, r3) + mul32x32_64(h2, r2) +\n+         mul32x32_64(h3, r1) + mul32x32_64(h4, r0);\n+\n+  h0 = (uint32_t)t[0] & 0x3ffffff;\n+  c = (t[0] >> 26);\n+  t[1] += c;\n+  h1 = (uint32_t)t[1] & 0x3ffffff;\n+  b = (uint32_t)(t[1] >> 26);\n+  t[2] += b;\n+  h2 = (uint32_t)t[2] & 0x3ffffff;\n+  b = (uint32_t)(t[2] >> 26);\n+  t[3] += b;\n+  h3 = (uint32_t)t[3] & 0x3ffffff;\n+  b = (uint32_t)(t[3] >> 26);\n+  t[4] += b;\n+  h4 = (uint32_t)t[4] & 0x3ffffff;\n+  b = (uint32_t)(t[4] >> 26);\n+  h0 += b * 5;\n+\n+  if (inlen >= 16)\n+    goto poly1305_donna_16bytes;\n+\n+/* final bytes */\n+poly1305_donna_atmost15bytes:\n+  if (!inlen)\n+    goto poly1305_donna_finish;\n+\n+  for (j = 0; j < inlen; j++)\n+    mp[j] = m[j];\n+  mp[j++] = 1;\n+  for (; j < 16; j++)\n+    mp[j] = 0;\n+  inlen = 0;\n+\n+  t0 = U8TO32_LE(mp + 0);\n+  t1 = U8TO32_LE(mp + 4);\n+  t2 = U8TO32_LE(mp + 8);\n+  t3 = U8TO32_LE(mp + 12);\n+\n+  h0 += t0 & 0x3ffffff;\n+  h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+  h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+  h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+  h4 += (t3 >> 8);\n+\n+  goto poly1305_donna_mul;\n+\n+poly1305_donna_finish:\n+  b = h0 >> 26;\n+  h0 = h0 & 0x3ffffff;\n+  h1 += b;\n+  b = h1 >> 26;\n+  h1 = h1 & 0x3ffffff;\n+  h2 += b;\n+  b = h2 >> 26;\n+  h2 = h2 & 0x3ffffff;\n+  h3 += b;\n+  b = h3 >> 26;\n+  h3 = h3 & 0x3ffffff;\n+  h4 += b;\n+  b = h4 >> 26;\n+  h4 = h4 & 0x3ffffff;\n+  h0 += b * 5;\n+  b = h0 >> 26;\n+  h0 = h0 & 0x3ffffff;\n+  h1 += b;\n+\n+  g0 = h0 + 5;\n+  b = g0 >> 26;\n+  g0 &= 0x3ffffff;\n+  g1 = h1 + b;\n+  b = g1 >> 26;\n+  g1 &= 0x3ffffff;\n+  g2 = h2 + b;\n+  b = g2 >> 26;\n+  g2 &= 0x3ffffff;\n+  g3 = h3 + b;\n+  b = g3 >> 26;\n+  g3 &= 0x3ffffff;\n+  g4 = h4 + b - (1 << 26);",
      "path": "src/crypto/poly1305.cpp",
      "position": 176,
      "original_position": 176,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": 221463737,
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Its upstream code from openssh,.. the plan is to refactor this to c++ after initial merge to master.",
      "created_at": "2018-10-01T12:44:25Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221594295",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221594295"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 176,
      "original_line": 176,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221596313",
      "pull_request_review_id": 160279931,
      "id": 221596313,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTU5NjMxMw==",
      "diff_hunk": "@@ -0,0 +1,90 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+#include <support/cleanse.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *ctx, const uint8_t *key,\n+                          int keylen) {\n+  if (keylen != (32 + 32)) /* 2 x 256 bit keys */\n+    return -1;\n+  chacha_keysetup(&ctx->main_ctx, key, 256);\n+  chacha_keysetup(&ctx->header_ctx, key + 32, 256);\n+  return 0;\n+}\n+\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt) {\n+  const uint8_t one[8] = {1, 0, 0, 0, 0, 0, 0, 0}; /* NB little-endian */\n+  uint8_t expected_tag[POLY1305_TAGLEN], poly_key[POLY1305_KEYLEN];\n+  int r = -1;\n+\n+  uint64_t seqnr64 = seqnr;\n+  uint64_t chacha_iv = htole64(seqnr64);\n+  memset(poly_key, 0, sizeof(poly_key));\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, NULL);",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": 46,
      "original_position": 42,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": 221463848,
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'd like to keep this as C code for now, the .cpp filename extension is for bypassing the CXXFLAGS/CFLAGS issue.",
      "created_at": "2018-10-01T12:51:47Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221596313",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221596313"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 46,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221597018",
      "pull_request_review_id": 160280815,
      "id": 221597018,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTU5NzAxOA==",
      "diff_hunk": "@@ -0,0 +1,90 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+#include <support/cleanse.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *ctx, const uint8_t *key,\n+                          int keylen) {\n+  if (keylen != (32 + 32)) /* 2 x 256 bit keys */\n+    return -1;\n+  chacha_keysetup(&ctx->main_ctx, key, 256);\n+  chacha_keysetup(&ctx->header_ctx, key + 32, 256);\n+  return 0;\n+}\n+\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt) {\n+  const uint8_t one[8] = {1, 0, 0, 0, 0, 0, 0, 0}; /* NB little-endian */\n+  uint8_t expected_tag[POLY1305_TAGLEN], poly_key[POLY1305_KEYLEN];\n+  int r = -1;\n+\n+  uint64_t seqnr64 = seqnr;\n+  uint64_t chacha_iv = htole64(seqnr64);\n+  memset(poly_key, 0, sizeof(poly_key));\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, NULL);\n+  chacha_encrypt_bytes(&ctx->main_ctx, poly_key, poly_key, sizeof(poly_key));\n+\n+  if (!is_encrypt) {\n+    const uint8_t *tag = src + aadlen + len;\n+\n+    poly1305_auth(expected_tag, src, aadlen + len, poly_key);\n+    if (timingsafe_bcmp(expected_tag, tag, POLY1305_TAGLEN) != 0) {\n+      r = -1;\n+      goto out;\n+    }\n+  }\n+\n+  if (aadlen) {\n+    chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&chacha_iv, NULL);\n+    chacha_encrypt_bytes(&ctx->header_ctx, src, dest, aadlen);\n+  }\n+\n+  /* Set Chacha's block counter to 1 */\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, one);\n+  chacha_encrypt_bytes(&ctx->main_ctx, src + aadlen, dest + aadlen, len);\n+\n+  /* If encrypting, calculate and append tag */\n+  if (is_encrypt) {\n+    poly1305_auth(dest + aadlen + len, dest, aadlen + len, poly_key);\n+  }\n+  r = 0;\n+out:\n+  memory_cleanse(expected_tag, sizeof(expected_tag));\n+  memory_cleanse(&chacha_iv, sizeof(chacha_iv));\n+  memory_cleanse(poly_key, sizeof(poly_key));\n+  return r;\n+}\n+\n+int chacha20poly1305_get_length24(struct chachapolyaead_ctx *ctx,\n+                                uint32_t *len24_out, uint32_t seqnr,\n+                                const uint8_t *ciphertext) {\n+  uint8_t buf[3];\n+\n+  uint64_t seqnr64 = htole64(seqnr); //use LE for the nonce\n+  chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&seqnr64, NULL);\n+  chacha_encrypt_bytes(&ctx->header_ctx, ciphertext, buf, 3);\n+  *len24_out = 0;\n+  *len24_out = buf[0] | (buf[1] << 8) | (buf[2] << 16);",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": 88,
      "original_position": 85,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": 216966077,
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm not sure if applying 3 time a uint_8t (24bits) the way its done here will guarantee to set the other 8 bits to 0. This is why I initialise with 0, then set bit 0 to 23. Could be that I'm wrong though.",
      "created_at": "2018-10-01T12:54:22Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221597018",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221597018"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221597516",
      "pull_request_review_id": 160281448,
      "id": 221597516,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTU5NzUxNg==",
      "diff_hunk": "@@ -0,0 +1,198 @@\n+/*\n+ * Public Domain poly1305 from Andrew Moon\n+ * poly1305-donna-unrolled.c from https://github.com/floodyberry/poly1305-donna\n+ */\n+\n+/* $OpenBSD: poly1305.c,v 1.3 2013/12/19 22:57:13 djm Exp $ */\n+\n+#include <crypto/poly1305.h>\n+\n+#define mul32x32_64(a, b) ((uint64_t)(a) * (b))\n+\n+#define U8TO32_LE(p)                                                           \\\n+  (((uint32_t)((p)[0])) | ((uint32_t)((p)[1]) << 8) |                          \\\n+   ((uint32_t)((p)[2]) << 16) | ((uint32_t)((p)[3]) << 24))\n+\n+#define U32TO8_LE(p, v)                                                        \\\n+  do {                                                                         \\\n+    (p)[0] = (uint8_t)((v));                                                   \\\n+    (p)[1] = (uint8_t)((v) >> 8);                                              \\\n+    (p)[2] = (uint8_t)((v) >> 16);                                             \\\n+    (p)[3] = (uint8_t)((v) >> 24);                                             \\\n+  } while (0)\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m,\n+                   size_t inlen, const unsigned char key[POLY1305_KEYLEN]) {\n+  uint32_t t0, t1, t2, t3;\n+  uint32_t h0, h1, h2, h3, h4;\n+  uint32_t r0, r1, r2, r3, r4;\n+  uint32_t s1, s2, s3, s4;\n+  uint32_t b, nb;\n+  size_t j;\n+  uint64_t t[5];\n+  uint64_t f0, f1, f2, f3;\n+  uint32_t g0, g1, g2, g3, g4;\n+  uint64_t c;\n+  unsigned char mp[16];\n+\n+  /* clamp key */\n+  t0 = U8TO32_LE(key + 0);\n+  t1 = U8TO32_LE(key + 4);\n+  t2 = U8TO32_LE(key + 8);\n+  t3 = U8TO32_LE(key + 12);\n+\n+  /* precompute multipliers */\n+  r0 = t0 & 0x3ffffff;\n+  t0 >>= 26;\n+  t0 |= t1 << 6;\n+  r1 = t0 & 0x3ffff03;\n+  t1 >>= 20;\n+  t1 |= t2 << 12;\n+  r2 = t1 & 0x3ffc0ff;\n+  t2 >>= 14;\n+  t2 |= t3 << 18;\n+  r3 = t2 & 0x3f03fff;\n+  t3 >>= 8;\n+  r4 = t3 & 0x00fffff;\n+\n+  s1 = r1 * 5;\n+  s2 = r2 * 5;\n+  s3 = r3 * 5;\n+  s4 = r4 * 5;\n+\n+  /* init state */\n+  h0 = 0;\n+  h1 = 0;\n+  h2 = 0;\n+  h3 = 0;\n+  h4 = 0;\n+\n+  /* full blocks */\n+  if (inlen < 16)\n+    goto poly1305_donna_atmost15bytes;\n+poly1305_donna_16bytes:\n+  m += 16;\n+  inlen -= 16;\n+\n+  t0 = U8TO32_LE(m - 16);\n+  t1 = U8TO32_LE(m - 12);\n+  t2 = U8TO32_LE(m - 8);\n+  t3 = U8TO32_LE(m - 4);\n+\n+  h0 += t0 & 0x3ffffff;\n+  h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+  h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+  h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+  h4 += (t3 >> 8) | (1 << 24);\n+\n+poly1305_donna_mul:\n+  t[0] = mul32x32_64(h0, r0) + mul32x32_64(h1, s4) + mul32x32_64(h2, s3) +\n+         mul32x32_64(h3, s2) + mul32x32_64(h4, s1);\n+  t[1] = mul32x32_64(h0, r1) + mul32x32_64(h1, r0) + mul32x32_64(h2, s4) +\n+         mul32x32_64(h3, s3) + mul32x32_64(h4, s2);\n+  t[2] = mul32x32_64(h0, r2) + mul32x32_64(h1, r1) + mul32x32_64(h2, r0) +\n+         mul32x32_64(h3, s4) + mul32x32_64(h4, s3);\n+  t[3] = mul32x32_64(h0, r3) + mul32x32_64(h1, r2) + mul32x32_64(h2, r1) +\n+         mul32x32_64(h3, r0) + mul32x32_64(h4, s4);\n+  t[4] = mul32x32_64(h0, r4) + mul32x32_64(h1, r3) + mul32x32_64(h2, r2) +\n+         mul32x32_64(h3, r1) + mul32x32_64(h4, r0);\n+\n+  h0 = (uint32_t)t[0] & 0x3ffffff;\n+  c = (t[0] >> 26);\n+  t[1] += c;\n+  h1 = (uint32_t)t[1] & 0x3ffffff;\n+  b = (uint32_t)(t[1] >> 26);\n+  t[2] += b;\n+  h2 = (uint32_t)t[2] & 0x3ffffff;\n+  b = (uint32_t)(t[2] >> 26);\n+  t[3] += b;\n+  h3 = (uint32_t)t[3] & 0x3ffffff;\n+  b = (uint32_t)(t[3] >> 26);\n+  t[4] += b;\n+  h4 = (uint32_t)t[4] & 0x3ffffff;\n+  b = (uint32_t)(t[4] >> 26);\n+  h0 += b * 5;\n+\n+  if (inlen >= 16)\n+    goto poly1305_donna_16bytes;\n+\n+/* final bytes */\n+poly1305_donna_atmost15bytes:\n+  if (!inlen)\n+    goto poly1305_donna_finish;\n+\n+  for (j = 0; j < inlen; j++)\n+    mp[j] = m[j];\n+  mp[j++] = 1;\n+  for (; j < 16; j++)\n+    mp[j] = 0;\n+  inlen = 0;\n+\n+  t0 = U8TO32_LE(mp + 0);\n+  t1 = U8TO32_LE(mp + 4);\n+  t2 = U8TO32_LE(mp + 8);\n+  t3 = U8TO32_LE(mp + 12);\n+\n+  h0 += t0 & 0x3ffffff;\n+  h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+  h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+  h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+  h4 += (t3 >> 8);\n+\n+  goto poly1305_donna_mul;\n+\n+poly1305_donna_finish:\n+  b = h0 >> 26;\n+  h0 = h0 & 0x3ffffff;\n+  h1 += b;\n+  b = h1 >> 26;\n+  h1 = h1 & 0x3ffffff;\n+  h2 += b;\n+  b = h2 >> 26;\n+  h2 = h2 & 0x3ffffff;\n+  h3 += b;\n+  b = h3 >> 26;\n+  h3 = h3 & 0x3ffffff;\n+  h4 += b;\n+  b = h4 >> 26;\n+  h4 = h4 & 0x3ffffff;\n+  h0 += b * 5;\n+  b = h0 >> 26;\n+  h0 = h0 & 0x3ffffff;\n+  h1 += b;\n+\n+  g0 = h0 + 5;\n+  b = g0 >> 26;\n+  g0 &= 0x3ffffff;\n+  g1 = h1 + b;\n+  b = g1 >> 26;\n+  g1 &= 0x3ffffff;\n+  g2 = h2 + b;\n+  b = g2 >> 26;\n+  g2 &= 0x3ffffff;\n+  g3 = h3 + b;\n+  b = g3 >> 26;\n+  g3 &= 0x3ffffff;\n+  g4 = h4 + b - (1 << 26);\n+\n+  b = (g4 >> 31) - 1;\n+  nb = ~b;\n+  h0 = (h0 & nb) | (g0 & b);\n+  h1 = (h1 & nb) | (g1 & b);\n+  h2 = (h2 & nb) | (g2 & b);\n+  h3 = (h3 & nb) | (g3 & b);\n+  h4 = (h4 & nb) | (g4 & b);\n+\n+  f0 = ((h0) | (h1 << 26)) + (uint64_t)U8TO32_LE(&key[16]);",
      "path": "src/crypto/poly1305.cpp",
      "position": 186,
      "original_position": 186,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": 216966884,
      "user": {
        "login": "jonasschnelli",
        "id": 178464,
        "node_id": "MDQ6VXNlcjE3ODQ2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasschnelli",
        "html_url": "https://github.com/jonasschnelli",
        "followers_url": "https://api.github.com/users/jonasschnelli/followers",
        "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
        "repos_url": "https://api.github.com/users/jonasschnelli/repos",
        "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Looks like.\r\nThis has been taken from openSSH (https://github.com/openssh/openssh-portable/blob/90e51d672711c19a36573be1785caf35019ae7a8/poly1305.c).",
      "created_at": "2018-10-01T12:55:54Z",
      "updated_at": "2018-10-01T13:17:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221597516",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221597516"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 186,
      "original_line": 186,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221648668",
      "pull_request_review_id": 160347486,
      "id": 221648668,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTY0ODY2OA==",
      "diff_hunk": "@@ -0,0 +1,90 @@\n+#include <crypto/chachapoly_aead.h>\n+\n+#define __STDC_WANT_LIB_EXT1__ 1\n+#include <crypto/poly1305.h>\n+#include <string.h>\n+\n+#include <compat/endian.h>\n+#include <support/cleanse.h>\n+\n+#ifndef HAVE_TIMINGSAFE_BCMP\n+\n+int timingsafe_bcmp(const unsigned char *b1, const unsigned char *b2, size_t n) {\n+  const unsigned char *p1 = b1, *p2 = b2;\n+  int ret = 0;\n+\n+  for (; n > 0; n--)\n+    ret |= *p1++ ^ *p2++;\n+  return (ret != 0);\n+}\n+\n+#endif /* TIMINGSAFE_BCMP */\n+\n+int chacha20poly1305_init(struct chachapolyaead_ctx *ctx, const uint8_t *key,\n+                          int keylen) {\n+  if (keylen != (32 + 32)) /* 2 x 256 bit keys */\n+    return -1;\n+  chacha_keysetup(&ctx->main_ctx, key, 256);\n+  chacha_keysetup(&ctx->header_ctx, key + 32, 256);\n+  return 0;\n+}\n+\n+int chacha20poly1305_crypt(struct chachapolyaead_ctx *ctx, uint32_t seqnr,\n+                           uint8_t *dest, const uint8_t *src, uint32_t len,\n+                           uint32_t aadlen, int is_encrypt) {\n+  const uint8_t one[8] = {1, 0, 0, 0, 0, 0, 0, 0}; /* NB little-endian */\n+  uint8_t expected_tag[POLY1305_TAGLEN], poly_key[POLY1305_KEYLEN];\n+  int r = -1;\n+\n+  uint64_t seqnr64 = seqnr;\n+  uint64_t chacha_iv = htole64(seqnr64);\n+  memset(poly_key, 0, sizeof(poly_key));\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, NULL);\n+  chacha_encrypt_bytes(&ctx->main_ctx, poly_key, poly_key, sizeof(poly_key));\n+\n+  if (!is_encrypt) {\n+    const uint8_t *tag = src + aadlen + len;\n+\n+    poly1305_auth(expected_tag, src, aadlen + len, poly_key);\n+    if (timingsafe_bcmp(expected_tag, tag, POLY1305_TAGLEN) != 0) {\n+      r = -1;\n+      goto out;\n+    }\n+  }\n+\n+  if (aadlen) {\n+    chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&chacha_iv, NULL);\n+    chacha_encrypt_bytes(&ctx->header_ctx, src, dest, aadlen);\n+  }\n+\n+  /* Set Chacha's block counter to 1 */\n+  chacha_ivsetup(&ctx->main_ctx, (uint8_t *)&chacha_iv, one);\n+  chacha_encrypt_bytes(&ctx->main_ctx, src + aadlen, dest + aadlen, len);\n+\n+  /* If encrypting, calculate and append tag */\n+  if (is_encrypt) {\n+    poly1305_auth(dest + aadlen + len, dest, aadlen + len, poly_key);\n+  }\n+  r = 0;\n+out:\n+  memory_cleanse(expected_tag, sizeof(expected_tag));\n+  memory_cleanse(&chacha_iv, sizeof(chacha_iv));\n+  memory_cleanse(poly_key, sizeof(poly_key));\n+  return r;\n+}\n+\n+int chacha20poly1305_get_length24(struct chachapolyaead_ctx *ctx,\n+                                uint32_t *len24_out, uint32_t seqnr,\n+                                const uint8_t *ciphertext) {\n+  uint8_t buf[3];\n+\n+  uint64_t seqnr64 = htole64(seqnr); //use LE for the nonce\n+  chacha_ivsetup(&ctx->header_ctx, (uint8_t *)&seqnr64, NULL);\n+  chacha_encrypt_bytes(&ctx->header_ctx, ciphertext, buf, 3);\n+  *len24_out = 0;\n+  *len24_out = buf[0] | (buf[1] << 8) | (buf[2] << 16);",
      "path": "src/crypto/chachapoly_aead.cpp",
      "position": 88,
      "original_position": 85,
      "commit_id": "e65a41853dcc1ba968e47a5e8d40e36d1f346a08",
      "original_commit_id": "d415a02a481c8c42786204a3a3dac64ccbff2953",
      "in_reply_to_id": 216966077,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "We wouldn't initialise before assignment if the RHS was an integer, right? :-)\r\n\r\n`buf[0] | (buf[1] << 8) | (buf[2] << 16)` evaluates to an integer.\r\n\r\nBut don't trust me  I'm just a fellow human.\r\n\r\nLet's verify using our favourite C++ interpreter `cling`:\r\n\r\n```\r\n$ cling\r\n\r\n****************** CLING ******************\r\n* Type C++ code and press enter to run it *\r\n*             Type .q to exit             *\r\n*******************************************\r\n[cling]$ typeid(1).name()\r\n(const char *) \"i\"\r\n[cling]$ #include <cstdint>\r\n[cling]$ uint8_t buf[3] = {1, 2, 3}\r\n(uint8_t [3]) { '0x01', '0x02', '0x03' }\r\n[cling]$ typeid(buf[0] | (buf[1] << 8) | (buf[2] << 16)).name()\r\n(const char *) \"i\"\r\n[cling]$ buf[0] | (buf[1] << 8) | (buf[2] << 16)\r\n(int) 197121\r\n```\r\n\r\n:-)",
      "created_at": "2018-10-01T15:16:52Z",
      "updated_at": "2018-10-01T15:20:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14050#discussion_r221648668",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221648668"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14050"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    }
  ]
}