{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34480",
    "id": 3236402146,
    "node_id": "PR_kwDOABII587A55Pi",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34480",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34480.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34480.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34480",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34480/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34480/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34480/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/c3e79dffb0ccfaa86f61843838873059613caaaf",
    "number": 34480,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet: don't back-date locktime below input locktime",
    "user": {
      "login": "danielabrozzoni",
      "id": 25042473,
      "node_id": "MDQ6VXNlcjI1MDQyNDcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danielabrozzoni",
      "html_url": "https://github.com/danielabrozzoni",
      "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
      "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
      "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
      "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
      "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "Fixes #26527\r\n\r\nThe Bitcoin Core wallet implements an anti-fee-sniping mechanism that sets a transaction's nLockTime to the current block height, and occasionally to an earlier height.\r\n\r\nPreviously, when creating a transaction, the wallet could choose an nLockTime that was lower than the nLockTime of one of its inputs. This creates an unrealistic \"transaction signed earlier but only broadcast now\" scenario and may act as a wallet fingerprint.\r\n\r\nThis PR fixes the issue by adding a `min_allowed_locktime` parameter to `DiscourageFeeSniping`. When creating a transaction, the wallet now sets this minimum to the highest locktime among all parent transactions. This ensures that while the locktime can still be backdated for anti-fee-sniping, it won't go below any input's locktime.\r\n\r\n`DiscourageFeeSniping` is invoked by the following RPCs:\r\n- `sendall`\r\n- `send`\r\n- `sendtoaddress`\r\n- `sendmany`\r\n- `fundrawtransaction`\r\n- `walletcreatefundedpsbt`\r\n\r\nTests are added for `sendall`, `send`, `sendtoaddress` and `sendmany`.\r\n\r\n`fundrawtransaction` and `walletcreatefundedpsbt` can't hit this edge case, because they don't use the anti-fee-sniping logic and instead always set nLockTime to 0 unless explicitly provided by the user.",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2026-02-02T12:47:55Z",
    "updated_at": "2026-02-05T10:17:22Z",
    "mergeable_state": "unknown",
    "merged": false,
    "merge_commit_sha": "89324f651d5c757cadaffbf6510d1528934af1f9",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "danielabrozzoni:issue/26527-dont-backtime-nlocktime-unconf",
      "ref": "issue/26527-dont-backtime-nlocktime-unconf",
      "sha": "c3e79dffb0ccfaa86f61843838873059613caaaf",
      "user": {
        "login": "danielabrozzoni",
        "id": 25042473,
        "node_id": "MDQ6VXNlcjI1MDQyNDcz",
        "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/danielabrozzoni",
        "html_url": "https://github.com/danielabrozzoni",
        "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
        "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
        "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
        "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
        "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 487334034,
        "node_id": "R_kgDOHQwgkg",
        "name": "bitcoin",
        "full_name": "danielabrozzoni/bitcoin",
        "owner": {
          "login": "danielabrozzoni",
          "id": 25042473,
          "node_id": "MDQ6VXNlcjI1MDQyNDcz",
          "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/danielabrozzoni",
          "html_url": "https://github.com/danielabrozzoni",
          "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
          "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
          "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
          "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
          "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/danielabrozzoni/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/danielabrozzoni/bitcoin",
        "archive_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/events",
        "forks_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/danielabrozzoni/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:danielabrozzoni/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/danielabrozzoni/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/hooks",
        "svn_url": "https://github.com/danielabrozzoni/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 291689,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-05T10:12:31Z",
        "created_at": "2022-04-30T17:02:30Z",
        "updated_at": "2026-02-02T12:38:32Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "41b9b76cce6aa26291bfef969645be0fa490b5f0",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38847,
        "stargazers_count": 87947,
        "watchers_count": 87947,
        "size": 303069,
        "default_branch": "master",
        "open_issues_count": 747,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-05T10:56:42Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-02-05T10:56:51Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34480"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 166,
    "deletions": 8,
    "changed_files": 7,
    "commits": 6,
    "review_comments": 3,
    "comments": 3
  },
  "events": [
    {
      "event": "labeled",
      "id": 22464527233,
      "node_id": "LE_lADOABII587nm8WCzwAAAAU6_XuB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22464527233",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-02T12:48:00Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "commented",
      "id": 3834928158,
      "node_id": "IC_kwDOABII587klFwe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3834928158",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-02T12:48:45Z",
      "updated_at": "2026-02-02T12:48:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34480#issuecomment-3834928158",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34480"
    },
    {
      "event": "commented",
      "id": 3834948866,
      "node_id": "IC_kwDOABII587klK0C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3834948866",
      "actor": {
        "login": "danielabrozzoni",
        "id": 25042473,
        "node_id": "MDQ6VXNlcjI1MDQyNDcz",
        "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/danielabrozzoni",
        "html_url": "https://github.com/danielabrozzoni",
        "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
        "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
        "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
        "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
        "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-02T12:52:58Z",
      "updated_at": "2026-02-02T12:52:58Z",
      "author_association": "MEMBER",
      "body": "@ishaanam: I put you as a co-author for the first commit, because I started working from your code here https://github.com/bitcoin/bitcoin/pull/26902#pullrequestreview-1522310111 :)",
      "user": {
        "login": "danielabrozzoni",
        "id": 25042473,
        "node_id": "MDQ6VXNlcjI1MDQyNDcz",
        "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/danielabrozzoni",
        "html_url": "https://github.com/danielabrozzoni",
        "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
        "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
        "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
        "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
        "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34480#issuecomment-3834948866",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34480"
    },
    {
      "event": "mentioned",
      "id": 22464665014,
      "node_id": "MEE_lADOABII587nm8WCzwAAAAU6_5W2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22464665014",
      "actor": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-02T12:52:59Z"
    },
    {
      "event": "subscribed",
      "id": 22464665095,
      "node_id": "SE_lADOABII587nm8WCzwAAAAU6_5YH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22464665095",
      "actor": {
        "login": "ishaanam",
        "id": 75942586,
        "node_id": "MDQ6VXNlcjc1OTQyNTg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ishaanam",
        "html_url": "https://github.com/ishaanam",
        "followers_url": "https://api.github.com/users/ishaanam/followers",
        "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
        "organizations_url": "https://api.github.com/users/ishaanam/orgs",
        "repos_url": "https://api.github.com/users/ishaanam/repos",
        "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ishaanam/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-02T12:52:59Z"
    },
    {
      "event": "reviewed",
      "id": 3741843815,
      "node_id": "PRR_kwDOABII587fCAFn",
      "url": null,
      "actor": null,
      "commit_id": "6dd81c2aaae5ce96d123fa637d3a373071c5fc27",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-02T22:12:19Z",
      "author_association": "MEMBER",
      "body": "> The `sendtoaddress` and `sendmany` RPCs don't spend unconfirmed inputs\n\nThey can spend unconfirmed change, and I would prefer for these to be tested as well since the calling of `DiscourageFeeSniping` is different between these RPCs and `send` and `sendall`.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34480#pullrequestreview-3741843815",
      "submitted_at": "2026-02-02T22:12:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34480"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhjNTM3YTFhMjZhZWRjYTY1NzE3NDM3ZTFlM2IyY2I4YTczMmQzMGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8c537a1a26aedca65717437e1e3b2cb8a732d30a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8c537a1a26aedca65717437e1e3b2cb8a732d30a",
      "tree": {
        "sha": "c0c7d10ba0cf212ee51406f1ff97afb40b144620",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c0c7d10ba0cf212ee51406f1ff97afb40b144620"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c0c7d10ba0cf212ee51406f1ff97afb40b144620\nparent 5cb4cf9b428ed64edc11fc5489d7b0f0be3c7d73\nauthor Daniela Brozzoni <danielabrozzoni@protonmail.com> 1769692941 +0100\ncommitter Daniela Brozzoni <danielabrozzoni@protonmail.com> 1770220713 +0100\n\nwallet: don't back-date locktime below input locktime\n\nWhen creating a transaction with anti fee sniping enabled, the wallet\ncould previously select an nLockTime that was lower than the nLockTime\nof its input transactions. This can break the \"transaction signed earlier\nbut broadcast later\" explanation and may act as a wallet fingerprint.\n\nThis is fixed by constraining the anti fee sniping logic to never select\nan nLockTime lower than the maximum nLockTime of the wallet-owned input\ntransactions. The minimum allowed value is passed to\nDiscourageFeeSniping().\n\nCo-Authored-By: ishaanam <ishaana.misra@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEZkx/loNGWB3axvvxfeTx/c7Qq4cFAmmDbKkACgkQfeTx/c7Q\nq4dPsw/+LKtygoek8c5zwKGhMDUr/Crt7seOKbz98WGJ28XvDyagTGCY/A6vODH2\n6SvGJ6DdyetKcg5kx/ujOmMi1DZSGDfV6E4fG2Wm/htT6eP4lKuU4l3vzC4zu/z6\nQq6tP1mJnxp+n2+EfflGT3j7b8dj0ZG1r3S+dKnM/UT++AlQ5kBonRW9LvPXv0PJ\n4CwyXf6yLaLUL+94Hyyw74oheVSvgAQcy5QtLzN/80rVT7OvAB5tibOW6I86XHmj\nIn6DuXVpcQ00s0yRH5OQ+e0+Epf5BE215v3yHMOh0V+hjY3s5f8h8GBCPrtPot9F\ndsUo0P8zdJ9vI5aiudnXbnonut4XdGq8IsOWnMs1x1R3jKJV4VV5QcSB0G9zqgPV\nbz9bHVihLmpfMvGID3asxlmIMgur6FCVYgm14c0ljzYrUYu7sXzpwZti5CzIo0o0\nxck4jtqwZREMW6MlwHJychar4ddsaauYaH1aVcfM+FcgpB/R1HRMa1tjkochfTnl\n8NW+lGGIZ0T8rYfaj17aA9jfA+weOtxtxWQMBG1Bw4CvSvbpNRf4GDypjfYCBaAm\ngBDhZHgODotFc1HuWSjZXj3AzZwlBfQBbuLMEuH8TTZJqmzIlMN/yUUwnP/QEGKY\nCptx7HvJYOb5h2F3g/6JCXkogmyCrF9czqt0N4e04CmPGspDkLI=\n=2nDH\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5cb4cf9b428ed64edc11fc5489d7b0f0be3c7d73",
          "sha": "5cb4cf9b428ed64edc11fc5489d7b0f0be3c7d73",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5cb4cf9b428ed64edc11fc5489d7b0f0be3c7d73"
        }
      ],
      "message": "wallet: don't back-date locktime below input locktime\n\nWhen creating a transaction with anti fee sniping enabled, the wallet\ncould previously select an nLockTime that was lower than the nLockTime\nof its input transactions. This can break the \"transaction signed earlier\nbut broadcast later\" explanation and may act as a wallet fingerprint.\n\nThis is fixed by constraining the anti fee sniping logic to never select\nan nLockTime lower than the maximum nLockTime of the wallet-owned input\ntransactions. The minimum allowed value is passed to\nDiscourageFeeSniping().\n\nCo-Authored-By: ishaanam <ishaana.misra@gmail.com>",
      "committer": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-02-04T15:58:33Z"
      },
      "author": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-01-29T13:22:21Z"
      },
      "sha": "8c537a1a26aedca65717437e1e3b2cb8a732d30a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDgyOTk5Njc2NjQxNzNmNGZhN2NmZTAxYWQ3NDZkZDBlNjIyMGQ4YzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8299967664173f4fa7cfe01ad746dd0e6220d8c5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8299967664173f4fa7cfe01ad746dd0e6220d8c5",
      "tree": {
        "sha": "bba9422f75ca16fc441c7f47c5f8ce55fec0d130",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bba9422f75ca16fc441c7f47c5f8ce55fec0d130"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree bba9422f75ca16fc441c7f47c5f8ce55fec0d130\nparent 8c537a1a26aedca65717437e1e3b2cb8a732d30a\nauthor Daniela Brozzoni <danielabrozzoni@protonmail.com> 1769692963 +0100\ncommitter Daniela Brozzoni <danielabrozzoni@protonmail.com> 1770220714 +0100\n\ntest: assert anti-fee-sniping locktime is within 100 blocks\n\nThe previous assertion only verified that nLockTime was non-zero.\nTighten the check to ensure the locktime is within the allowed range,\nup to 100 blocks in the past.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEZkx/loNGWB3axvvxfeTx/c7Qq4cFAmmDbKoACgkQfeTx/c7Q\nq4c93A/+P1g4PsbCKmlFYBr4os9paUm/uaR1k9AIY3AGT96qgDaIqowtwruy1G9a\nLNZyAMK3sMz4OpQCeXTz77Xmlno8H9KZQ6eTo9RVZQm2EFeQkTriRGwpkD+4h8Um\n+I9Egx2qXI7A7J+RZzgdSSZjJCIQ7uPJLb+HTEyOQ+NdvpQ/jGcW38hC6VQwYNJH\nv30a7rrEt7NPJH38VpLaf5BUFJh06Fx7amGgiWE3jUi7ym25YPSJXDFcQwy7rQ0+\nnB1S+b4SA0wrnEc59BdujjC3sMLxA6kbkH4H2JdEN1A0gf3E/ZbOGNq3kx/rTL/8\nH/T75Fgfv3Z4eKGgJzVEbppw82Stq17yzgHGP4Lw8W/SB1CruuEujuP/zqPwWZzX\nx0KRUYLLc7WmL5VdqJWx1w1HpsEl75iu/P46i7JX5bExNxP1jxGvFsS1MV6Uc2hl\nuCCzLLJBagViw8JFxijYQUw6piI8+QC96Ycy7++OvyahfN7ATU9isWLZIsAlGbFd\nrfe2BYV/rCOOTva9V9vIPvTEblIy3y52LquFWg/Dxx654vpC04e2/h4zaMeozxQc\nVGqlyWd4/SHiV9Qb1/masJqWBsY3G29g/825+5w9Wtsu+MGEXB5dMoaebZj1ycUu\nPH6DEzOoyHvV92PPLX6HmP0bdc/utCJvIugH+soekU5l48di5jg=\n=T2O2\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8c537a1a26aedca65717437e1e3b2cb8a732d30a",
          "sha": "8c537a1a26aedca65717437e1e3b2cb8a732d30a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8c537a1a26aedca65717437e1e3b2cb8a732d30a"
        }
      ],
      "message": "test: assert anti-fee-sniping locktime is within 100 blocks\n\nThe previous assertion only verified that nLockTime was non-zero.\nTighten the check to ensure the locktime is within the allowed range,\nup to 100 blocks in the past.",
      "committer": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-02-04T15:58:34Z"
      },
      "author": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-01-29T13:22:43Z"
      },
      "sha": "8299967664173f4fa7cfe01ad746dd0e6220d8c5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQwMzNhNWNjZjkyNGEyMmJiOTIzNmY2NzA1MmRjMDVmMWIxNGM0NDY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4033a5ccf924a22bb9236f67052dc05f1b14c446",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4033a5ccf924a22bb9236f67052dc05f1b14c446",
      "tree": {
        "sha": "7f33ffa252288ea559a09392141f5b7db2256b57",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7f33ffa252288ea559a09392141f5b7db2256b57"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 7f33ffa252288ea559a09392141f5b7db2256b57\nparent 8299967664173f4fa7cfe01ad746dd0e6220d8c5\nauthor Daniela Brozzoni <danielabrozzoni@protonmail.com> 1769692981 +0100\ncommitter Daniela Brozzoni <danielabrozzoni@protonmail.com> 1770220715 +0100\n\ntest: check send respects input locktimes with anti fee sniping\n\nAdd a test to verify that when the anti fee sniping logic randomly\nbackdates a transaction locktime, the send RPC never selects a value\nlower than the nLockTime of its input transactions.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEZkx/loNGWB3axvvxfeTx/c7Qq4cFAmmDbKsACgkQfeTx/c7Q\nq4eXKg/8D6btRDObyaPLaKqqAN0vLwjm6DRbo0PjTHrktqSeBxSkAY9ZVOzykaMW\nJvTma+THaHdO9owQjxGPwguLGt+K4zvcdENZ4Jwng0X1O/5JHpCPCviGE16Bs1Ev\nTFaCKlOlTpCLiz78Q0QvmSVHt1/9gbCYGsOZeZ6VHDaGJcnstzC/HT+XxbazQRV0\ncwCW8XxuvTfBLM3Kj7PQE9Gr1GeUAL7HMchGpvo6M5IZrz9eA/vCHMZrOGQ5PC0/\nSy3ytb4bqzTjd/Tp8/BcaVU3ajfeQN4ezR8xp6dQFnKmyP0bGaI2+rA60Kb/1wCL\nuBAXbuUtrJN87BLK78qHc8783C4XKJwl8rULMstfkBCEw2RtaxLW5KK5XLenFFNT\nzfDjPlhQguUj6BmIxNBXtJHUtT3vFcFySy/z7lWGsSLRg9u4hX8il28X1VLZv186\ndCfZzHkWJmTwlMOjHgi4VV9WGQ5hUxNaElpW8Ogzblzmtkyrh+jOllQNDEHErvUN\njObysjEpvyGOl/prgolz7h7oItC+7+2CFDTQAicv8AAwfEjsk9RDYPx/leyPDoIm\niJxzgEKX4MCZObKcGnTOSKxaMqWjhbeHqVYc3Hih4kx4vrUCQkKCkGhfkwZguNSL\nw0nob2N/zTuGzuUpZKZQfpF/cePR91udG+mcf7QZKE4kQx8xbro=\n=j8q5\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8299967664173f4fa7cfe01ad746dd0e6220d8c5",
          "sha": "8299967664173f4fa7cfe01ad746dd0e6220d8c5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8299967664173f4fa7cfe01ad746dd0e6220d8c5"
        }
      ],
      "message": "test: check send respects input locktimes with anti fee sniping\n\nAdd a test to verify that when the anti fee sniping logic randomly\nbackdates a transaction locktime, the send RPC never selects a value\nlower than the nLockTime of its input transactions.",
      "committer": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-02-04T15:58:35Z"
      },
      "author": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-01-29T13:23:01Z"
      },
      "sha": "4033a5ccf924a22bb9236f67052dc05f1b14c446"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc4OGNmYTQyYmUwYzhkNmQ0ZTdmY2Q5MDM2NjVmM2EwMjlkNTczM2Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/788cfa42be0c8d6d4e7fcd903665f3a029d5733d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/788cfa42be0c8d6d4e7fcd903665f3a029d5733d",
      "tree": {
        "sha": "f1b156c12e487cfee736832d4ab1876f14796ddc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f1b156c12e487cfee736832d4ab1876f14796ddc"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f1b156c12e487cfee736832d4ab1876f14796ddc\nparent 4033a5ccf924a22bb9236f67052dc05f1b14c446\nauthor Daniela Brozzoni <danielabrozzoni@protonmail.com> 1769692998 +0100\ncommitter Daniela Brozzoni <danielabrozzoni@protonmail.com> 1770225153 +0100\n\ntest: check sendall respects input locktimes with anti fee sniping\n\nAdd a test to verify that when the anti fee sniping logic randomly\nbackdates a transaction locktime, the send RPC never selects a value\nlower than the nLockTime of its input transactions.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEZkx/loNGWB3axvvxfeTx/c7Qq4cFAmmDfgEACgkQfeTx/c7Q\nq4eVMw/+JSdQDnfV2joT3jTLZOueTYtpmY7ZKgRySSqwQNhgcnLRT++CRfIZ2X9o\n6f4DbG46QSJo8cMBQcV8QwMg9G+Y+BVUyjVkid+6cF30w8cTx9Ot+0eUISA1z28E\nyi/1Uj0KxG0ugVDKqjcE8NsiXDTlOS5I3Fv/8vbuT6GWmBGpyF2jAZxWeWxhPGY3\nSUneNb6VmMs09I5Ln3w4V7JOwPGg+PxGJP0kLeGYekzIVWI1l8m3To9fET37Ch+K\nXVLR9Mr7/cljIyYmZ3k3uu1MU00ELhX66tDIMt+aa+sEffFW1Gl0FJn+IA+SxcHB\ndgaxEkoh9Woa+xkAsvaTfesJXMYwTd3YNJbo5e+76Onl6JoBazeYV/d0elV6Jf96\n6cBkMNrTqSfpkjqIIlgY8C6oVC8fXEUtQXCAoFmMoZrmjPw5+Mj5dkoF0bEuzYS6\ncfafKJxFqMofwt3VbzZllSssQSWQ0Xjubz7DCnLCgQcdobd2ylxI3g6OR1xfPNc2\n55oHt/Mu6kZJc93WlH6ILHsTmojdSfCij7c7z0JdrJcEDQjcVxLBRdusz1nnox7Q\n1/QwoSiI/m1orOz1PgjsTrl0kdhEIVNI7OEBgKld95EhmyKrzWDJ93tiGRtVXnxo\nQPXKgVCqsgWEwIBCt4rOZPIAAXAB8J9/RKKB0ZbyY144zHjfvMg=\n=6r2O\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4033a5ccf924a22bb9236f67052dc05f1b14c446",
          "sha": "4033a5ccf924a22bb9236f67052dc05f1b14c446",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4033a5ccf924a22bb9236f67052dc05f1b14c446"
        }
      ],
      "message": "test: check sendall respects input locktimes with anti fee sniping\n\nAdd a test to verify that when the anti fee sniping logic randomly\nbackdates a transaction locktime, the send RPC never selects a value\nlower than the nLockTime of its input transactions.",
      "committer": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-02-04T17:12:33Z"
      },
      "author": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-01-29T13:23:18Z"
      },
      "sha": "788cfa42be0c8d6d4e7fcd903665f3a029d5733d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGIwZjZlOTZlZmYwOGM2ODc4OThiNTEwYWIwNzEwZmE4N2VmMGIxYjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b0f6e96eff08c687898b510ab0710fa87ef0b1b6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b0f6e96eff08c687898b510ab0710fa87ef0b1b6",
      "tree": {
        "sha": "4ede37a9c916dda7fedaa8b92279766527576eac",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4ede37a9c916dda7fedaa8b92279766527576eac"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4ede37a9c916dda7fedaa8b92279766527576eac\nparent 788cfa42be0c8d6d4e7fcd903665f3a029d5733d\nauthor Daniela Brozzoni <danielabrozzoni@protonmail.com> 1770203720 +0100\ncommitter Daniela Brozzoni <danielabrozzoni@protonmail.com> 1770225154 +0100\n\ntest: check sendtoaddress respects input locktimes with anti fee sniping\n\nAdd a test to verify that when the anti fee sniping logic randomly\nbackdates a transaction locktime, the send RPC never selects a value\nlower than the nLockTime of its input transactions.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEZkx/loNGWB3axvvxfeTx/c7Qq4cFAmmDfgIACgkQfeTx/c7Q\nq4eetBAAidTXQV7q+ZfAQ8m/enNJLkVYPa2gZpU/5SKlgDNkxKY3sb0cm+XMkdPE\n07Ienx37MkS/V7nnTtwzf15Vney6l6qhhwIqgkinlxKqOdROLFkjDaxZA6cz8K0s\nVm2omgweqtcWXPZNypbGfGYciQDB54OIKAvRmUTYAfW3E/lzESfLJY9KYqILecWq\nejyIuoDOVClm3ymDdCpMjhkD0ViWOjyd0JAGJRQzCTcOOcVs0EsSwF4GWpBrq/tD\ngBcGpd6/l3Fu0+TEGet6MC6jRWbJQhd18HeVNAPn5i3P/IgwLp8nMBszTVNzETDr\nMPq+dBV9HwgFU2Ntfi2YAwh54hSMlkqMKTTcmQU8tZsAY/cQBtayT9xHjzmgFz+2\n8zLQ1vxv45dt8Vx5csVOBe7BcjLujF3npIr2sCW1gpE9Gtaeu50KUrBAgRxHlYbA\nREW8XTa1N9yHgx6puW43p/AKNZ+EA0IeCrtBjIRcgNjuMuuR9oi2WvjyD+1V9+4R\nuFpKug2lYjLGRJ0oUgi1brUb6dcPCDoPALLN3KE7CktQEOpeRMsPYjHGJCqUdArV\nZGqCwhQSLWzRQjDq8diVXKxGhr3RDMS4BFu0yxnAGaVX1jStniP8ut6B8wU17t/T\nbP1+wyU4rOFzTi7aSR6qsvm7WuZuilX+WH9pLAJnxgYywFYbB7Y=\n=TmlR\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/788cfa42be0c8d6d4e7fcd903665f3a029d5733d",
          "sha": "788cfa42be0c8d6d4e7fcd903665f3a029d5733d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/788cfa42be0c8d6d4e7fcd903665f3a029d5733d"
        }
      ],
      "message": "test: check sendtoaddress respects input locktimes with anti fee sniping\n\nAdd a test to verify that when the anti fee sniping logic randomly\nbackdates a transaction locktime, the send RPC never selects a value\nlower than the nLockTime of its input transactions.",
      "committer": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-02-04T17:12:34Z"
      },
      "author": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-02-04T11:15:20Z"
      },
      "sha": "b0f6e96eff08c687898b510ab0710fa87ef0b1b6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGMzZTc5ZGZmYjBjY2ZhYTg2ZjYxODQzODM4ODczMDU5NjEzY2FhYWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c3e79dffb0ccfaa86f61843838873059613caaaf",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c3e79dffb0ccfaa86f61843838873059613caaaf",
      "tree": {
        "sha": "627029066d5e8d45efba73628146d4049f9517f4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/627029066d5e8d45efba73628146d4049f9517f4"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 627029066d5e8d45efba73628146d4049f9517f4\nparent b0f6e96eff08c687898b510ab0710fa87ef0b1b6\nauthor Daniela Brozzoni <danielabrozzoni@protonmail.com> 1770203733 +0100\ncommitter Daniela Brozzoni <danielabrozzoni@protonmail.com> 1770225155 +0100\n\ntest: check sendmany respects input locktimes with anti fee sniping\n\nAdd a test to verify that when the anti fee sniping logic randomly\nbackdates a transaction locktime, the send RPC never selects a value\nlower than the nLockTime of its input transactions.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEZkx/loNGWB3axvvxfeTx/c7Qq4cFAmmDfgMACgkQfeTx/c7Q\nq4cdrA//etWMgGRU8/xkIRy0DCQDDROzZCbo4eTUmE53cbTOkz8gGe+nY68UlP44\nYQvXqOjpwUw2eEvbPUV1UZrVooC5+KNgmwDDJHmgh4BkWhx0cOkcKrnrnC2MjU2m\nNf37la/kYpZgpc+8naiL8XhBrYsv4r9p3+soeXi7cRm2baugZffk+VFptzutsbu3\n2GP7ZIaGB3TsMroJMc4giPpIPDn9A+0ILhNU4sSr4XBMXqS1vk7TphnH2140inlI\nr7DDM4BTIFgl/vixhhcWQjn7z17+IpligCPmou8Pe76aVQqwwS46TV05seEeMESu\nPJTu/QHEMLwX/SzVCk4w/yeRcu7e/aUbhWIpqATx5EpAJE7ABJ8HqHsOqUFdMRnM\nOXEU/TfFktgzpuPO/tOepTeGLNcSTDnP4TG+D1mcshxfPgN8QtMPRVHuFa7/o/F0\nZJvOO/kONcDfBStI0M5TACaxFDaH1FEnN+1lX8U89AANSDM74cd4Yt6z8dpVXxQ0\njFAXlAXQmXwagtwKa2uFfihcio7ee5yk+x1hHKlfgt9+y66/zwzV8z1a0O2yUBpV\nYs1xkvmaigXd08V1x2aVWBLC0E9ZrKkS8k09TtpIFs4bDhHCZnZbTe6V2SE769tQ\n+QknQsESZ5mcnpE+zGNjoVzn+Pd5Pu4pGRrnG9VlqflyFHZjJNw=\n=NiIa\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b0f6e96eff08c687898b510ab0710fa87ef0b1b6",
          "sha": "b0f6e96eff08c687898b510ab0710fa87ef0b1b6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b0f6e96eff08c687898b510ab0710fa87ef0b1b6"
        }
      ],
      "message": "test: check sendmany respects input locktimes with anti fee sniping\n\nAdd a test to verify that when the anti fee sniping logic randomly\nbackdates a transaction locktime, the send RPC never selects a value\nlower than the nLockTime of its input transactions.",
      "committer": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-02-04T17:12:35Z"
      },
      "author": {
        "name": "Daniela Brozzoni",
        "email": "danielabrozzoni@protonmail.com",
        "date": "2026-02-04T11:15:33Z"
      },
      "sha": "c3e79dffb0ccfaa86f61843838873059613caaaf"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22553937619,
      "node_id": "HRFPE_lADOABII587nm8WCzwAAAAVAUcbT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22553937619",
      "actor": {
        "login": "danielabrozzoni",
        "id": 25042473,
        "node_id": "MDQ6VXNlcjI1MDQyNDcz",
        "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/danielabrozzoni",
        "html_url": "https://github.com/danielabrozzoni",
        "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
        "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
        "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
        "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
        "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "c3e79dffb0ccfaa86f61843838873059613caaaf",
      "commit_url": "https://api.github.com/repos/danielabrozzoni/bitcoin/commits/c3e79dffb0ccfaa86f61843838873059613caaaf",
      "created_at": "2026-02-05T10:12:33Z"
    },
    {
      "event": "renamed",
      "id": 22553979690,
      "node_id": "RTE_lADOABII587nm8WCzwAAAAVAUmsq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22553979690",
      "actor": {
        "login": "danielabrozzoni",
        "id": 25042473,
        "node_id": "MDQ6VXNlcjI1MDQyNDcz",
        "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/danielabrozzoni",
        "html_url": "https://github.com/danielabrozzoni",
        "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
        "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
        "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
        "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
        "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T10:14:13Z",
      "rename": {
        "from": "wallet: don't back-date locktime below unconfirmed input locktime",
        "to": "wallet: don't back-date locktime below input locktime"
      }
    },
    {
      "event": "commented",
      "id": 3852562476,
      "node_id": "IC_kwDOABII587loXAs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3852562476",
      "actor": {
        "login": "danielabrozzoni",
        "id": 25042473,
        "node_id": "MDQ6VXNlcjI1MDQyNDcz",
        "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/danielabrozzoni",
        "html_url": "https://github.com/danielabrozzoni",
        "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
        "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
        "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
        "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
        "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T10:17:22Z",
      "updated_at": "2026-02-05T10:17:22Z",
      "author_association": "MEMBER",
      "body": "Thanks for your review Ava! I picked up your suggestions, and the idea in https://github.com/bitcoin/bitcoin/issues/26527#issuecomment-3818834598.\r\n\r\nChanges since last push:\r\n- Now we avoid backdating the nlocktime below any input nLocktime, not just unconfirmed inputs.\r\n- I added tests for `sendtoaddress` and `sendmany`. These use confirmed parent transactions instead of unconfirmed change, which was easier to implement and still tests the same behavior.\r\n- In the tests, I explicitly set the parent `nLockTime` and retry creating a child transaction until I get one with a backdated `nLockTime` (`nLockTime != tip_height`).\r\n\r\nOne concern I have, which I just realized: since we cannot know the `nLockTime` for external inputs, we might still end up backdating below those inputs `nLockTime`. This could be problematic, since it may leak some information about which inputs are wallet-owned. Is this acceptable?\r\n\r\nI thought about a couple of ways to mitigate this but could not implement either. Let me know if I missed something:\r\n\r\n- Getting external unconfirmed inputs from the mempool. Unfortunately, I could use `wallet.chain` to check whether a tx is in the mempool (`isInMempool`), but couldn't retrieve the whole transaction\r\n- Getting external inputs from the txindex, if enabled. Unfortunately I could not access g_txindex from the wallet code.\r\n\r\nOtherwise, we could disallow backdating if there's at least one external input, by setting `min_allowed_locktime` to the tip height. ",
      "user": {
        "login": "danielabrozzoni",
        "id": 25042473,
        "node_id": "MDQ6VXNlcjI1MDQyNDcz",
        "avatar_url": "https://avatars.githubusercontent.com/u/25042473?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/danielabrozzoni",
        "html_url": "https://github.com/danielabrozzoni",
        "followers_url": "https://api.github.com/users/danielabrozzoni/followers",
        "following_url": "https://api.github.com/users/danielabrozzoni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/danielabrozzoni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/danielabrozzoni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/danielabrozzoni/subscriptions",
        "organizations_url": "https://api.github.com/users/danielabrozzoni/orgs",
        "repos_url": "https://api.github.com/users/danielabrozzoni/repos",
        "events_url": "https://api.github.com/users/danielabrozzoni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/danielabrozzoni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34480#issuecomment-3852562476",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34480"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2756256034",
      "pull_request_review_id": 3741843815,
      "id": 2756256034,
      "node_id": "PRRC_kwDOABII586kSSEi",
      "diff_hunk": "@@ -1286,7 +1293,19 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n         use_anti_fee_sniping = false;\n     }\n     if (use_anti_fee_sniping) {\n-        DiscourageFeeSniping(txNew, rng_fast, wallet.chain(), wallet.GetLastBlockHash(), wallet.GetLastBlockHeight());\n+        // Find the highest nLockTime of all unconfirmed inputs so that\n+        // this transaction does not use a lower value.\n+        // Setting a lower nLockTime would make the \"signed earlier but broadcast later\"\n+        // explanation unrealistic, and may act as a wallet fingerprint.\n+        unsigned int max_unconfirmed_input_locktime{0}; // If there aren't any unconfirmed inputs, the minimum locktime is 0\n+        for (const auto& coin: selected_coins) {",
      "path": "src/wallet/spend.cpp",
      "position": 1,
      "original_position": 37,
      "commit_id": "c4325985a0a6f82d482f9c1f9c0276336b2476c8",
      "original_commit_id": "c4325985a0a6f82d482f9c1f9c0276336b2476c8",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In c4325985a0a6f82d482f9c1f9c0276336b2476c8 \"wallet: don't back-date locktime below unconfirmed input locktime\"\n\nnit:\n\n```suggestion\n        for (const auto& coin : selected_coins) {\n```",
      "created_at": "2026-02-02T22:03:42Z",
      "updated_at": "2026-02-02T22:12:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34480#discussion_r2756256034",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2756256034"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34480"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1301,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2756266399",
      "pull_request_review_id": 3741843815,
      "id": 2756266399,
      "node_id": "PRRC_kwDOABII586kSUmf",
      "diff_hunk": "@@ -563,6 +564,25 @@ def test_weight_limits(self):\n \n         self.nodes[1].unloadwallet(\"test_weight_limits\")\n \n+    def test_unconfirmed_input_fee_sniping(self):\n+        self.log.info(\"Test that send sets the transaction locktime no lower than any unconfirmed input locktime\")\n+        self.nodes[1].createwallet(\"test_fee_sniping\")\n+        # Create parent tx with anti-fee-sniping nlocktime\n+        wallet = self.nodes[1].get_wallet_rpc(\"test_fee_sniping\")\n+        unconfirmed_parent_txid = self.nodes[0].sendtoaddress(wallet.getnewaddress(), 10)",
      "path": "test/functional/wallet_send.py",
      "position": 1,
      "original_position": 17,
      "commit_id": "d4b45ac6fb09ac85579724497ec9ba639235fe0a",
      "original_commit_id": "d4b45ac6fb09ac85579724497ec9ba639235fe0a",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In d4b45ac6fb09ac85579724497ec9ba639235fe0a \"test: check send RPC locktime is not below unconfirmed input locktime\"\n\nThis relies on the anti-fee-sniping to randomly backdate the locktime. I think it would be better if this could set the locktime to a specific value that would be in range so that the range is not often just a single value.",
      "created_at": "2026-02-02T22:08:28Z",
      "updated_at": "2026-02-02T22:12:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34480#discussion_r2756266399",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2756266399"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34480"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 572,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2756269235",
      "pull_request_review_id": 3741843815,
      "id": 2756269235,
      "node_id": "PRRC_kwDOABII586kSVSz",
      "diff_hunk": "@@ -563,6 +564,25 @@ def test_weight_limits(self):\n \n         self.nodes[1].unloadwallet(\"test_weight_limits\")\n \n+    def test_unconfirmed_input_fee_sniping(self):\n+        self.log.info(\"Test that send sets the transaction locktime no lower than any unconfirmed input locktime\")\n+        self.nodes[1].createwallet(\"test_fee_sniping\")\n+        # Create parent tx with anti-fee-sniping nlocktime\n+        wallet = self.nodes[1].get_wallet_rpc(\"test_fee_sniping\")\n+        unconfirmed_parent_txid = self.nodes[0].sendtoaddress(wallet.getnewaddress(), 10)\n+        unconfirmed_parent_nlocktime = self.nodes[0].gettransaction(txid=unconfirmed_parent_txid, verbose=True)[\"decoded\"][\"locktime\"]\n+        # Parent nlocktime should be within 100 blocks of tip\n+        assert_greater_than_or_equal(unconfirmed_parent_nlocktime, self.nodes[0].getblockcount() - 100)\n+        self.sync_mempools()\n+        # Create child tx spending the unconfirmed parent\n+        utxos = wallet.listunspent(0, 0)\n+        child_txid = wallet.send([{wallet.getnewaddress(): 8}], inputs=utxos)[\"txid\"]",
      "path": "test/functional/wallet_send.py",
      "position": 1,
      "original_position": 24,
      "commit_id": "d4b45ac6fb09ac85579724497ec9ba639235fe0a",
      "original_commit_id": "d4b45ac6fb09ac85579724497ec9ba639235fe0a",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In d4b45ac6fb09ac85579724497ec9ba639235fe0a \"test: check send RPC locktime is not below unconfirmed input locktime\"\n\nSince backdating anti-fee-sniping is random, we should do this multiple times to be reasonably sure that we get a backdated nlocktime.",
      "created_at": "2026-02-02T22:09:47Z",
      "updated_at": "2026-02-02T22:12:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34480#discussion_r2756269235",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2756269235"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34480"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 579,
      "side": "RIGHT"
    }
  ]
}