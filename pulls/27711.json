{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711",
    "id": 1358186704,
    "node_id": "PR_kwDOABII585Q9EjQ",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/27711",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/27711.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/27711.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/f13880e83200ec824d7528061f96708d96bf9bd4",
    "number": 27711,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "kernel:  Remove shutdown globals from kernel library",
    "user": {
      "login": "TheCharlatan",
      "id": 8421793,
      "node_id": "MDQ6VXNlcjg0MjE3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheCharlatan",
      "html_url": "https://github.com/TheCharlatan",
      "followers_url": "https://api.github.com/users/TheCharlatan/followers",
      "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
      "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
      "repos_url": "https://api.github.com/users/TheCharlatan/repos",
      "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This pull request is part of the `libbitcoinkernel` project https://github.com/bitcoin/bitcoin/issues/27587 https://github.com/orgs/bitcoin/projects/3 and more specifically its \"Step 2: Decouple most non-consensus code from libbitcoinkernel\".\r\n\r\n---\r\n\r\nThis removes the shutdown files from the kernel library. As a standalone library the libbitcoinkernel should not have to rely on code that accesses shutdown state through a global. Instead, replace it with an interrupt class that is owned by the kernel context. Additionally this moves the remaining usages of the `uiInterface` out of the kernel code. The process of moving the `uiInterface` out of the kernel was started in https://github.com/bitcoin/bitcoin/pull/27636.\r\n\r\nThe approach taken here uses the notification interface to externalize the existing shutdown code from the kernel library. The `SignalInterrupt` kernel context member is passed by reference to the `ChainstateManager` to allow for the termination of long-running kernel functions and sending interrupt signals.\r\n",
    "labels": [
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2023-05-21T11:20:12Z",
    "updated_at": "2024-07-07T12:58:50Z",
    "closed_at": "2023-07-08T10:45:07Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merge_commit_sha": "c747f8fbd9e1005f3e2df0fc599539f5ab39bfe1",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "TheCharlatan:rmKernelShutdown",
      "ref": "rmKernelShutdown",
      "sha": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 94456368,
        "node_id": "MDEwOlJlcG9zaXRvcnk5NDQ1NjM2OA==",
        "name": "bitcoin",
        "full_name": "TheCharlatan/bitcoin",
        "owner": {
          "login": "TheCharlatan",
          "id": 8421793,
          "node_id": "MDQ6VXNlcjg0MjE3OTM=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/TheCharlatan",
          "html_url": "https://github.com/TheCharlatan",
          "followers_url": "https://api.github.com/users/TheCharlatan/followers",
          "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
          "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
          "repos_url": "https://api.github.com/users/TheCharlatan/repos",
          "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/TheCharlatan/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/TheCharlatan/bitcoin",
        "archive_url": "https://api.github.com/repos/TheCharlatan/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/TheCharlatan/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/TheCharlatan/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/TheCharlatan/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/TheCharlatan/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/TheCharlatan/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/TheCharlatan/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/TheCharlatan/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/TheCharlatan/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/TheCharlatan/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/TheCharlatan/bitcoin/events",
        "forks_url": "https://api.github.com/repos/TheCharlatan/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/TheCharlatan/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/TheCharlatan/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/TheCharlatan/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/TheCharlatan/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/TheCharlatan/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/TheCharlatan/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/TheCharlatan/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/TheCharlatan/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/TheCharlatan/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:TheCharlatan/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/TheCharlatan/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/TheCharlatan/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/TheCharlatan/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/TheCharlatan/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/TheCharlatan/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/TheCharlatan/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/TheCharlatan/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/TheCharlatan/bitcoin/hooks",
        "svn_url": "https://github.com/TheCharlatan/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 240454,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-07-07T12:25:38Z",
        "created_at": "2017-06-15T16:03:35Z",
        "updated_at": "2024-06-30T21:19:17Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "1af72e728d984d9fd49f7fa7eaa0c14943245c19",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35612,
        "stargazers_count": 77123,
        "watchers_count": 77123,
        "size": 262585,
        "default_branch": "master",
        "open_issues_count": 684,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-07-07T02:02:32Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-07-07T12:38:10Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 416,
    "deletions": 197,
    "changed_files": 31,
    "commits": 7,
    "review_comments": 15,
    "comments": 20
  },
  "events": [
    {
      "event": "commented",
      "id": 1556152994,
      "node_id": "IC_kwDOABII585cwQKi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1556152994",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-21T11:20:15Z",
      "updated_at": "2023-06-07T17:18:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [theuni](https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1557129134), [hebasto](https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1576836334) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27823](https://github.com/bitcoin/bitcoin/pull/27823) (init: return error when block index is non-contiguous, fix feature_init.py file perturbation by mzumsande)\n* [#27746](https://github.com/bitcoin/bitcoin/pull/27746) (Draft: rework validation logic for assumeutxo by sdaftuar)\n* [#27708](https://github.com/bitcoin/bitcoin/pull/27708) (Return EXIT_FAILURE on post-init fatal errors by furszy)\n* [#27607](https://github.com/bitcoin/bitcoin/pull/27607) (index: improve initialization and pruning violation check by furszy)\n* [#27596](https://github.com/bitcoin/bitcoin/pull/27596) (assumeutxo (2) by jamesob)\n* [#27576](https://github.com/bitcoin/bitcoin/pull/27576) (kernel: Remove args, settings, chainparams, chainparamsbase from kernel library by TheCharlatan)\n* [#26966](https://github.com/bitcoin/bitcoin/pull/26966) (index: blockfilter initial sync speedup, parallelize process by furszy)\n* [#26762](https://github.com/bitcoin/bitcoin/pull/26762) (refactor: Make `CCheckQueue` RAII-styled by hebasto)\n* [#26045](https://github.com/bitcoin/bitcoin/pull/26045) (rpc: Optimize serialization disk space of dumptxoutset by aureleoules)\n* [#10443](https://github.com/bitcoin/bitcoin/pull/10443) (Add fee_est tool for debugging fee estimation code by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1556152994",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "labeled",
      "id": 9295815137,
      "node_id": "LE_lADOABII585mbbWMzwAAAAIqEuHh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9295815137",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-21T11:20:16Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "commented",
      "id": 1556839009,
      "node_id": "IC_kwDOABII585cy3ph",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1556839009",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-22T09:06:08Z",
      "updated_at": "2023-05-22T09:06:08Z",
      "author_association": "MEMBER",
      "body": "cc @theuni ",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1556839009",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "mentioned",
      "id": 9300096233,
      "node_id": "MEE_lADOABII585mbbWMzwAAAAIqVDTp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9300096233",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-22T09:06:08Z"
    },
    {
      "event": "subscribed",
      "id": 9300096260,
      "node_id": "SE_lADOABII585mbbWMzwAAAAIqVDUE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9300096260",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-22T09:06:08Z"
    },
    {
      "event": "commented",
      "id": 1557129134,
      "node_id": "IC_kwDOABII585cz-eu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1557129134",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-22T12:24:09Z",
      "updated_at": "2023-05-22T12:24:09Z",
      "author_association": "MEMBER",
      "body": "Nice! Huge concept ACK. Haven't looked at the approach/code yet but will review.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1557129134",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9304994140,
      "node_id": "HRFPE_lADOABII585mbbWMzwAAAAIqnvFc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9304994140",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-22T16:56:02Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9324266684,
      "node_id": "HRFPE_lADOABII585mbbWMzwAAAAIrxQS8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9324266684",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-24T07:54:35Z"
    },
    {
      "event": "commented",
      "id": 1563561502,
      "node_id": "IC_kwDOABII585dMg4e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1563561502",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-25T22:07:21Z",
      "updated_at": "2023-05-25T22:07:21Z",
      "author_association": "MEMBER",
      "body": "I spent some time reviving my clang-tidy transform plugin which is able to force bubble-ups of fatal errors and decorations of functions which may call them. I'm not suggesting that we use this approach (I mentioned at core-dev that it works but I find it pretty ugly), though it's useful to point out our current shutdown behavior.\r\n\r\nNote that the plugin is self-written, so it's not flawless. It does produce compiling code though, so I have a reasonable amount of confidence.\r\n\r\n[See here for the transform of the current master branch](https://github.com/theuni/bitcoin/commit/8054f8b204ae30c781768133da7e2b308e5b7ad1).\r\n\r\nA quick guide:\r\n- Any functions/assignments/declarations which may call shutdown is wrapped in a macro like `MAYBE_EXIT`, `EXIT_OR_IF`, etc.\r\n- Any function containing one of those gets a return type of ``MaybeEarlyExit<real_return_type>`` in order to bubble it up the call-stack.\r\n- This repeats recursively until the topmost functions have had their return type modified.\r\n\r\nThis provides an easy way to see whether or not a high-level function may call shutdown from some deeply nested function.\r\n\r\nIt also provides an easy way to see when calls to shutdown are made _without_ returning to the calling function.\r\n\r\nI haven't looked at the actual result yet at all. I suspect it will [point out several things for us to fix](https://github.com/bitcoin/bitcoin/pull/27636#discussion_r1200547867).",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1563561502",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "commented",
      "id": 1563846514,
      "node_id": "IC_kwDOABII585dNmdy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1563846514",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-26T05:56:52Z",
      "updated_at": "2023-05-26T05:56:52Z",
      "author_association": "MEMBER",
      "body": "> It also provides an easy way to see when calls to shutdown are made without returning to the calling function.\r\n\r\nCan you explain this? Am I correct when guessing that any added EXIT* macro, and not the BUBBLE* macros are indicating a missing return?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1563846514",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "commented",
      "id": 1568618485,
      "node_id": "IC_kwDOABII585dfzf1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1568618485",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:12:44Z",
      "updated_at": "2023-05-30T15:16:41Z",
      "author_association": "MEMBER",
      "body": "> > It also provides an easy way to see when calls to shutdown are made without returning to the calling function.\r\n> \r\n> Can you explain this? Am I correct when guessing that any added EXIT* macro, and not the BUBBLE* macros are indicating a missing return?\r\n\r\n@MarcoFalke Right, the `BUBBLE_UP` is kinda like a cast, it's not so interesting. The others introduce conditional returns to pass any errors back up the stack. So the problem cases are ones where we don't already have that behavior.\r\n\r\nThe main complication comes from the fact that the callstack might look like:\r\n```\r\nvoid foo()\r\n  int bar()\r\n    std::string baz()\r\n```\r\nWhere `baz()` returns a fatal error. The solution implemented here is to wrap everything in a variant:\r\n```\r\nMaybeEarlyExit<void> foo()\r\n  MaybeEarlyExit<int> bar()\r\n    MaybeEarlyExit<std::string> baz()\r\n```\r\nWhere: `MaybeEarlyExit : std::variant<T, FatalError, UserInterrupted>` (and those are simple enum classes)\r\n\r\nSo basically if the call resulted in an error, pass an error type back up immediately rather than a real return value. These [macros are defined here](https://github.com/theuni/bitcoin/commit/1fb1e7c632ccf5cd9e8a64cccfa490c688e3dbaa) and do that as necessary (you can largely think of them of different notations of try/catch/rethrow). In fact, this model forces that invariant: you get a return value or a fatal error but never both.\r\n\r\n---\r\n\r\n[BlockManager::WriteUndoDataForBlock](https://github.com/theuni/bitcoin/commit/8054f8b204ae30c781768133da7e2b308e5b7ad1#diff-114c2880ec1ff2c5293ac65ceda0637bf92c05745b74b58410585a549464a33fL718) is a good example of correct/incorrect:\r\n- FindUndoPos: potential error caught and passed back up (what callers do with it is a different question)\r\n- UndoWriteToDisk: aborts and returns immediately as needed\r\n- [FlushUndoFile](https://github.com/theuni/bitcoin/commit/8054f8b204ae30c781768133da7e2b308e5b7ad1#diff-114c2880ec1ff2c5293ac65ceda0637bf92c05745b74b58410585a549464a33fR738): this one is (I believe) an example of a missed return in master that could cause problems with changes like these. Not necessarily this one in particular, but it's clearly not alone. Edit: to be clear, the problem here is that `FlushUndoFile` may call `AbortNode`, but we don't react to that in `WriteUndoDataForBlock`.\r\n\r\nI'm not sure how to proceed. @ryanofsky mentioned maybe fixing them up as part of this shutdown callback effort?",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1568618485",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "mentioned",
      "id": 9379763317,
      "node_id": "MEE_lADOABII585mbbWMzwAAAAIvE9R1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9379763317",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:12:44Z"
    },
    {
      "event": "subscribed",
      "id": 9379763348,
      "node_id": "SE_lADOABII585mbbWMzwAAAAIvE9SU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9379763348",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:12:44Z"
    },
    {
      "event": "mentioned",
      "id": 9379763389,
      "node_id": "MEE_lADOABII585mbbWMzwAAAAIvE9S9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9379763389",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:12:44Z"
    },
    {
      "event": "subscribed",
      "id": 9379763405,
      "node_id": "SE_lADOABII585mbbWMzwAAAAIvE9TN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9379763405",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:12:45Z"
    },
    {
      "event": "commented",
      "id": 1568675044,
      "node_id": "IC_kwDOABII585dgBTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1568675044",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:49:31Z",
      "updated_at": "2023-05-30T15:49:31Z",
      "author_association": "MEMBER",
      "body": "> Edit: to be clear, the problem here is that FlushUndoFile may call AbortNode, but we don't react to that in WriteUndoDataForBlock.\r\n\r\nDo we have to react there?  `AbortNode` starts a shutdown, and the shutdown is later checked in ABC: https://github.com/bitcoin/bitcoin/blob/71300489af362c3fed4736de6bffab4d758b6a84/src/validation.cpp#L3193\r\n\r\nSure, better annotations are better, but then why not use the existing `Result` class over the `MaybeEarlyExit` type?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1568675044",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "labeled",
      "id": 9380200003,
      "node_id": "LE_lADOABII585mbbWMzwAAAAIvGn5D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9380200003",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:49:33Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9380301161,
      "node_id": "HRFPE_lADOABII585mbbWMzwAAAAIvHAlp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9380301161",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T15:59:20Z"
    },
    {
      "event": "commented",
      "id": 1568701692,
      "node_id": "IC_kwDOABII585dgHz8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1568701692",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T16:07:13Z",
      "updated_at": "2023-05-30T16:07:13Z",
      "author_association": "MEMBER",
      "body": "> > Edit: to be clear, the problem here is that FlushUndoFile may call AbortNode, but we don't react to that in WriteUndoDataForBlock.\r\n> \r\n> Do we have to react there? `AbortNode` starts a shutdown, and the shutdown is later checked in ABC:\r\n> \r\n> https://github.com/bitcoin/bitcoin/blob/71300489af362c3fed4736de6bffab4d758b6a84/src/validation.cpp#L3193\r\n> \r\n\r\nYes, looks like I picked this example too hastily. You're correct that this one is caught higher up.\r\n\r\n> Sure, better annotations are better, but then why not use the existing `Result` class over the `MaybeEarlyExit` type?\r\n\r\nAgain, I'm not suggesting that we use `MaybeEarlyExit`. Only suggesting analyzing the above transformation to see if there are true bugs hiding.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1568701692",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "labeled",
      "id": 9381033247,
      "node_id": "LE_lADOABII585mbbWMzwAAAAIvJzUf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9381033247",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T17:19:49Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 9381456660,
      "node_id": "UNLE_lADOABII585mbbWMzwAAAAIvLasU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9381456660",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-30T18:06:52Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9386815304,
      "node_id": "HRFPE_lADOABII585mbbWMzwAAAAIvf29I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9386815304",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-31T08:12:51Z"
    },
    {
      "event": "ready_for_review",
      "id": 9387085096,
      "node_id": "RFRE_lADOABII585mbbWMzwAAAAIvg40o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9387085096",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-31T08:38:44Z"
    },
    {
      "event": "unlabeled",
      "id": 9388992499,
      "node_id": "UNLE_lADOABII585mbbWMzwAAAAIvoKfz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9388992499",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-31T11:19:54Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1572503569,
      "node_id": "IC_kwDOABII585duoAR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572503569",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-01T17:30:40Z",
      "updated_at": "2023-06-01T17:31:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "I think I agree with Cory, and think it is a problem even if it is not a bug for `BlockManager::FlushBlockFile` and `BlockManager::FlushUndoFile` methods to call `Notifications::fatalError` without returning errors themselves. The fatal errors there seem different than other fatal errors, and the contradict the \"whatever function triggered the error should also return an error code or raise an exception\" documention.\r\n\r\nI would suggest making one (or both) of the following changes to this PR:\r\n\r\n1. Changing `FlushBlockFile` and `FlushUndoFile` to send a different \"flush failed\" notification rather than \"fatal error\". The node's KernelNotifications handler could treat this just like a fatal error to keep current behavior the same. Other applications using libbitcoinkernel might choose to handle the error in a different way for example by sending a notification or trying to free up disk space, rather than shutting down the service right away.\r\n2. Changing `FlushBlockFile` and `FlushUndoFile` to return `[[nodiscard]] bool`, and changing calls to these functions either bubble up the error or have comments about why the error is safe to ignore in that particular context.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1572503569",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "reviewed",
      "id": 1455988697,
      "node_id": "PRR_kwDOABII585WyJ_Z",
      "url": null,
      "actor": null,
      "commit_id": "a6a3c3245303d05917c04460e71790e33241f3b5",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#pullrequestreview-1455988697",
      "submitted_at": "2023-06-01T18:14:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
    },
    {
      "event": "commented",
      "id": 1572651644,
      "node_id": "IC_kwDOABII585dvMJ8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572651644",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-01T19:25:12Z",
      "updated_at": "2023-06-01T19:25:12Z",
      "author_association": "MEMBER",
      "body": ">    Changing `FlushBlockFile` and `FlushUndoFile` to return `[[nodiscard]] bool`, and changing calls to these  functions either bubble up the error or have comments about why the error is safe to ignore in that particular context.\r\n\r\nI learned while working on the bubble-up stuff that a _type_ can be `[[nodiscard]]` too. [You can see an example of it here ](https://github.com/theuni/bitcoin/blob/clang-tidy-shutdown-rebase/src/early_exit.h#L45)to force bubble-up warnings.\r\n\r\nRather than returning `bool`, maybe return a custom `[[nodiscard]]` result type? That way if the caller wants to bubble-up the result, the use-checking bubbles up as well. Of course that starts breaking down as soon as something actually needs its return value, so maybe it's not useful. Just throwing it out there because imo it's neat :)",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1572651644",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "commented",
      "id": 1572800909,
      "node_id": "IC_kwDOABII585dvwmN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572800909",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-01T21:19:54Z",
      "updated_at": "2023-06-01T21:19:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "Re https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1572503569\r\n\r\n> The node's KernelNotifications handler could treat this just like a fatal error to keep current behavior the same. Other applications using libbitcoinkernel might choose to handle the error in a different way for example by sending a notification or trying to free up disk space, rather than shutting down the service right away.\r\n\r\nIs there really a qualitative difference between the errors? Instead of adding multiple functions, it feels like a better approach here might be to encode some common error reasons into an enum and let the user then decide how to handle them.  I don't understand why these abort calls were ignored so far (the code was introduced [here](https://github.com/bitcoin/bitcoin/commit/ac94141af0c16161afa68de1c3720f254ae4e12c)).",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1572800909",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "commented",
      "id": 1572835701,
      "node_id": "IC_kwDOABII585dv5F1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572835701",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-01T21:50:36Z",
      "updated_at": "2023-06-01T21:50:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Is there really a qualitative difference between the errors?\r\n\r\nI didn't dig into the actual errors, but the qualitative difference here seems to be that the other AbortNode errors actually need to be fatal and should try to shut down to prevent getting into a worse state. But an error flushing state in memory to disk does not need to be fatal, as long the state in memory is kept and can be saved later. There are lots of ways an application could handle a failed flush notification, and I think it would be better to avoid using fatal error callback for any notification that does not have to be fatal.\r\n\r\nThe choice of whether to use separate methods or enums is basically just aesthetic. And I didn't dig into whether these particular flush errors need to fatal or not. I think you can decide what to do here or whether to do anything at all. My reason for suggesting \"flushFailed\" as an alternative to \"nodiscard bool\" was that latter change might be more invasive and require changing more sensitive code.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1572835701",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhiM2FjN2Q5NTI1M2FjOWMxN2ZhZWUzZGYyOWYxMTE0NGU3OWY4YjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8b3ac7d95253ac9c17faee3df29f11144e79f8b4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8b3ac7d95253ac9c17faee3df29f11144e79f8b4",
      "tree": {
        "sha": "88763b48b5ec166dfcaa50a779b39e1162f291f1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/88763b48b5ec166dfcaa50a779b39e1162f291f1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 88763b48b5ec166dfcaa50a779b39e1162f291f1\nparent 71300489af362c3fed4736de6bffab4d758b6a84\nauthor TheCharlatan <seb.kung@gmail.com> 1685652813 -0400\ncommitter TheCharlatan <seb.kung@gmail.com> 1685875343 +0200\n\nutil: Add SignalInterrupt class and use in shutdown.cpp\n\nThis change helps generalize shutdown code so an interrupt can be\nprovided to libbitcoinkernel callers. This may also be useful to\neventually de-globalize all of the shutdown code.\n\nCo-authored-by: Russell Yanofsky <russ@yanofsky.org>\nCo-authored-by: TheCharlatan <seb.kung@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmR8apEACgkQm3m0VpHb\nQXNTZA//fC58roqt75d2lKKyMZtqojTddP8jOmUOZyyAmNEpaczV7CmPMtoHXxou\neK/VRTRLCmqR+vP7IkkKAxIm5AwtYiNffSEhC73+K+crqcHhPqK4P6j9SWqd2LPe\nYlG2MUM9SH/tmfcj1b01UMrN0kFFZU9hnsOSTmhzzt6UHSxUf8iIaXdIDEywZms/\nozG7ydRQ0hDxH24oF5cJd4NznDuglTWDTQGF2lyJujpu88SunvmmSSgzoG2mlFwZ\nONSICi8JcyMLSxRGXXtmMFmrWNCEnxZuS8583rBKJPgwNxbk0IugMLL4OSA/LT01\nyyYHm6zlIBS0JqPMJJM0r2UjuNbRVvzmcm0VZS2K1rf0LZmLGgeSN966ullwsit8\nS8ZqZleyKddR6umJnuHVFJDV66EPEsm+5C3Jkmx7zEbHEl8p1O78DXZfCAZBaWCI\nvGniJK9ZTTagBaVwugKo7W7O3SvkAWmmp/wMDsu41AVjTdodwNth451IzxrDfYko\nABGpJGiVKVkrPJDPGihU/AeeBBl9Qb8s7vBa/XkWIWoI/J4whQq50w63yWBLpxTj\nP4hgPVAHWyDVeeM7+TMtFAwwVTXJgh+UDxzTipqA0crA6KdFpixhY3kdKpVruyjD\n3ke9UR1P215vQAws/ANIrwNTSw4odruK9Gngh06fuK+aIiEPoag=\n=3c3/\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/71300489af362c3fed4736de6bffab4d758b6a84",
          "sha": "71300489af362c3fed4736de6bffab4d758b6a84",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/71300489af362c3fed4736de6bffab4d758b6a84"
        }
      ],
      "message": "util: Add SignalInterrupt class and use in shutdown.cpp\n\nThis change helps generalize shutdown code so an interrupt can be\nprovided to libbitcoinkernel callers. This may also be useful to\neventually de-globalize all of the shutdown code.\n\nCo-authored-by: Russell Yanofsky <russ@yanofsky.org>\nCo-authored-by: TheCharlatan <seb.kung@gmail.com>",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-04T10:42:23Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-01T20:53:33Z"
      },
      "sha": "8b3ac7d95253ac9c17faee3df29f11144e79f8b4"
    },
    {
      "event": "commented",
      "id": 1576836334,
      "node_id": "IC_kwDOABII585d_Jzu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1576836334",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-05T13:44:32Z",
      "updated_at": "2023-06-05T13:44:32Z",
      "author_association": "MEMBER",
      "body": "Concept ACK.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1576836334",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "commented",
      "id": 1576941978,
      "node_id": "IC_kwDOABII585d_jma",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1576941978",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-05T14:46:28Z",
      "updated_at": "2023-06-05T14:46:28Z",
      "author_association": "MEMBER",
      "body": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214342650:\r\n> I think the approach in the branch is better for two reasons...\r\n\r\nI agree with both of them.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1576941978",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU3YTU3YmFlMDA4ODgxYTJjZWM5NDBmYzExNmVmNTMyNDQ5YTVlYmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/57a57bae008881a2cec940fc116ef532449a5ebc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/57a57bae008881a2cec940fc116ef532449a5ebc",
      "tree": {
        "sha": "40efe0589c380eeffa7a72ab80582732fa79391c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/40efe0589c380eeffa7a72ab80582732fa79391c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 40efe0589c380eeffa7a72ab80582732fa79391c\nparent 8b3ac7d95253ac9c17faee3df29f11144e79f8b4\nauthor TheCharlatan <seb.kung@gmail.com> 1684320203 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1686125583 +0200\n\nkernel: Pass interrupt reference to chainman\n\nThis and the following commit seek to decouple the libbitcoinkernel\nlibrary from the shutdown code. As a library, it should it should have\nits own flexible interrupt infrastructure without relying on node-wide\nglobals.\n\nThe commit takes the first step towards this goal by de-globalising\n`ShutdownRequested` calls in kernel code.\n\nCo-authored-by: Russell Yanofsky <russ@yanofsky.org>\nCo-authored-by: TheCharlatan <seb.kung@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmSAPA8ACgkQm3m0VpHb\nQXNYchAAm+QMErHQuzVGXyoecUeIhTSH3Cf5s61Z0+FWg7TjfDMf3BuDZOsScaZa\n7h3+J4H1PPPDeFlP1O67J/SolDDbWJkImg1ANPjACpoM8gxING4SjIAlAHtPVO3L\ndBi1hNQ0tWMyXClklqf7fH/S94KuxZMsQ4QoLJ9O/c3iX+YlfWwsGFGg7GKq6J8B\n9zbqleDOhOsYDsiPKrSoI5DQ/L/Gb8WgE5G8xwrQVQOT1rbpMPSbBSKUgzzWVtNc\nxwF71LH3gxOH+gHTJOiCzEGTRigIErBRj4wy5R5dNZGmReE/X3909cdEkyMDOmLz\nDEQHbHQeaja3l7jWZSzlEY2L1bL+GeVOr6BdxTMwGfycyxlC97ew/4Mi2LqkcoZs\n7jGCQkUalwPLtXMul0hbPIXNP2KdHWpR75oLVnS4AdV2Q/MiWYeq9Ee92LmnXkE0\n+KT0IWwgtitWTl+H5zi4z9rPWGLiZQV2MgYNoZsL9SZiG1Dvur2c4C2RasBEiWVm\n3qinTLKY5DYAzxqi5BvhMaQU0tQ3x5fNCoOzm9Cy9mfuvazSHjo0ZHffsS4u568L\n0019txhZ8BfGxwhJomW1AlWWVLBq6vsTVHKfXcjtzNGk0yZwfGoer827Exsj4kqr\nnsAPMHYpQ1IdFILJkL5KMY6qP+3JN/bOSUEqjYkaLpwZfmJtZY0=\n=ekLK\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8b3ac7d95253ac9c17faee3df29f11144e79f8b4",
          "sha": "8b3ac7d95253ac9c17faee3df29f11144e79f8b4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8b3ac7d95253ac9c17faee3df29f11144e79f8b4"
        }
      ],
      "message": "kernel: Pass interrupt reference to chainman\n\nThis and the following commit seek to decouple the libbitcoinkernel\nlibrary from the shutdown code. As a library, it should it should have\nits own flexible interrupt infrastructure without relying on node-wide\nglobals.\n\nThe commit takes the first step towards this goal by de-globalising\n`ShutdownRequested` calls in kernel code.\n\nCo-authored-by: Russell Yanofsky <russ@yanofsky.org>\nCo-authored-by: TheCharlatan <seb.kung@gmail.com>",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-07T08:13:03Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-05-17T10:43:23Z"
      },
      "sha": "57a57bae008881a2cec940fc116ef532449a5ebc"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYwZjU0NjFlMTYwYzRlZjlhYTVlZThlMzRmNzBhNjQ1OWQxMmNhZTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60f5461e160c4ef9aa5ee8e34f70a6459d12cae5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/60f5461e160c4ef9aa5ee8e34f70a6459d12cae5",
      "tree": {
        "sha": "bfc8e65df4c8c974efa5c37385826f1157d092c5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bfc8e65df4c8c974efa5c37385826f1157d092c5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree bfc8e65df4c8c974efa5c37385826f1157d092c5\nparent 57a57bae008881a2cec940fc116ef532449a5ebc\nauthor TheCharlatan <seb.kung@gmail.com> 1685653034 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1686125588 +0200\n\nblockstorage: Return on fatal flush errors\n\nBy returning if either `FlushUndoFile` or `FlushBlockFile` fail, we\nensure that no further write operations take place that may lead to an\ninconsistent database when crashing.\n\nPrior to this patch `FlushBlockFile` may have failed without returning\nin `Chainstate::FlushStateToDisk`, leading to a potential write from\n`WriteBlockIndexDB` that may refer to a block that is not fully\nflushed to disk yet.\n\nFunctions that have either `FlushUndoFile` or `FlushBlockFile` in their\ncall stack, need to handle these extra abort cases properly. Since\n`Chainstate::FlushStateToDisk` already produces an abort error in case\nof `WriteBlockIndexDB` failing, no extra logic for functions calling\n`Chainstate::FlushStateToDisk` is required.\n\nBesides `Chainstate::FlushStateToDisk`, `FlushBlockFile` is also called\nby `FindBlockPos`, which also already produces other potential abort\nfailures. FlushUndoFile is only called by `FlushBlockFile` and\n`WriteUndoDataForBlock`. Both already produce their own abort errors, so\nagain no extra handling of these cases in calling code is required.\n\nAdd [[nodiscard]] annotations to these cases such that they are not\nignored in future.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmSAPBQACgkQm3m0VpHb\nQXO+nBAAx6ngS1mnNJEZWR+6rhRIUP6a7gUIA+mKNRBCXdCIgdnLbpGARy7We4vI\nGKDVSZk/LzNyd1sNJAMAjhIKNQdk1eq3qLECWbSoh0Ub3mRFVq0CXe7Y31ey1KNZ\naQDwyPEsf1AD9X1ZWgilUGC7x8Y5xy32K2Gtr96DhiPq6fHVHbKYf9Hm2WD9a4s8\n9xKQR9Rz47dnOzMESqckt9gLCifF5EKnAChLawupJuyuSKjO0CZq+U0BYd4w3Nsh\nQ9jAZ6ezZh0R5ni3VwJTrq4sqnremvFHHAmCxH5PIlTcqW6JnbfE3tBU1gC04UWj\ntURLzMHRrtjigIOzLHAfKVxBywerspJ/o8A2yKKme3zLyj7L5RfOBqnXxM/eRinX\nPUsbSxUXIZPxlGD8l86lRzHRN1uJ+0Y5bUyvUrE+TyyAzPUrsBLFPLQrKkCxHxJ0\nEsscKnSIrv5xCx00zs/5FcE7z+togYeADdQORBWqn1YAR4v21ANqsjHrjPeopQfq\npFSUTN51IHmtRI8WSp0Oi4xfnqZtFCdQ4fqNqC8dUgp5bCMw6PyBxXAhFbH6FfjG\nYp7ChdRdF87YKfSyhnC9h432nNLWoIIV96SLVJLD60ytsysYz4lPnh4wYEZ9IfCd\nAkE8CfsrC4IvsA+6+ftEVGpSQtp4OJnepb4d2YN783TuLSnjlAs=\n=DkOW\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/57a57bae008881a2cec940fc116ef532449a5ebc",
          "sha": "57a57bae008881a2cec940fc116ef532449a5ebc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/57a57bae008881a2cec940fc116ef532449a5ebc"
        }
      ],
      "message": "blockstorage: Return on fatal flush errors\n\nBy returning if either `FlushUndoFile` or `FlushBlockFile` fail, we\nensure that no further write operations take place that may lead to an\ninconsistent database when crashing.\n\nPrior to this patch `FlushBlockFile` may have failed without returning\nin `Chainstate::FlushStateToDisk`, leading to a potential write from\n`WriteBlockIndexDB` that may refer to a block that is not fully\nflushed to disk yet.\n\nFunctions that have either `FlushUndoFile` or `FlushBlockFile` in their\ncall stack, need to handle these extra abort cases properly. Since\n`Chainstate::FlushStateToDisk` already produces an abort error in case\nof `WriteBlockIndexDB` failing, no extra logic for functions calling\n`Chainstate::FlushStateToDisk` is required.\n\nBesides `Chainstate::FlushStateToDisk`, `FlushBlockFile` is also called\nby `FindBlockPos`, which also already produces other potential abort\nfailures. FlushUndoFile is only called by `FlushBlockFile` and\n`WriteUndoDataForBlock`. Both already produce their own abort errors, so\nagain no extra handling of these cases in calling code is required.\n\nAdd [[nodiscard]] annotations to these cases such that they are not\nignored in future.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-07T08:13:08Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-01T20:57:14Z"
      },
      "sha": "60f5461e160c4ef9aa5ee8e34f70a6459d12cae5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJkY2EzYzc5ZmI4ZDAwNGIwZDg3ZDdmZTY2ZTcyZTAxZjhhNzRhMzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bdca3c79fb8d004b0d87d7fe66e72e01f8a74a38",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/bdca3c79fb8d004b0d87d7fe66e72e01f8a74a38",
      "tree": {
        "sha": "ebea2f9bec368e271df5851fb3c3aa8e345a099a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ebea2f9bec368e271df5851fb3c3aa8e345a099a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree ebea2f9bec368e271df5851fb3c3aa8e345a099a\nparent 60f5461e160c4ef9aa5ee8e34f70a6459d12cae5\nauthor TheCharlatan <seb.kung@gmail.com> 1684084910 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1686125693 +0200\n\nscripted-diff: Rename FatalError to FatalErrorf\n\nThis is done in preparation for the next commit where a new FatalError\nfunction is introduced. FatalErrorf follows common convention to append\n'f' for functions accepting format arguments.\n\n-BEGIN VERIFY SCRIPT-\nsed -i 's/FatalError/FatalErrorf/g' $( git grep -l 'FatalError')\n-END VERIFY SCRIPT-\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmSAPH0ACgkQm3m0VpHb\nQXOuqg/+N9+BBvw7FBdOl5AB1Wkvm9KmmE3kpv8MCOWR4SEMwOt7RGBbxpVB9Mr4\n8ty93K2t3PvVrdu4FPRekWmxago8VM9bMvLvV0BAPiPjvN0yvy7OHlKafHxaD/4w\nPWk5c/hxKCWy46iKSJBdRikPTLu3cQV8WS3NLcsYcwwBWLAjwNhJVNvRbO4c9ufn\nb39a7MPyx/adqtrSqwkPmp9i6th81egj4347PX86RQb9RghPQR9x+azwzQro9w21\n3C0dppaFIywaLukhlkSVDLObNbdFJox1gXa3+lgAvlF2e1XkiArT8hFa/9Wn9yq6\nx8eMb6PiQmOnGk0JwCTk4dN1Xc9XapQhI3+S+2aCB6LQiAWkCttqCayXM+EGEfjH\nB7HxIOZSXMIhQi9wVh47huBpe0JO+SUK6HA47paXl04DVlgIycrHD0tyN2rN1yZT\n4HqaNZxcWyWrRtzW9wj4VYTxELiTwWqFs2r44xB/I9zii6daww2MSbyMe3vNZeyC\nMFVnnZsX9hVjeiEVFBcG4upbGOvsaZGjZaCpAoTht/SeIH7g9FowEV2hmj9UI+b4\nbjj9nJEAhznxX5A14DcdPB7Ul+/IKb7OPAhWxe6C5jsM6LNUwrZnG5fRDK4C7pQB\nQvStbyQ3mP9KAPH8aLdZpxFXthwGnqW49oOhPabKhg0E4qtClGs=\n=6cec\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60f5461e160c4ef9aa5ee8e34f70a6459d12cae5",
          "sha": "60f5461e160c4ef9aa5ee8e34f70a6459d12cae5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/60f5461e160c4ef9aa5ee8e34f70a6459d12cae5"
        }
      ],
      "message": "scripted-diff: Rename FatalError to FatalErrorf\n\nThis is done in preparation for the next commit where a new FatalError\nfunction is introduced. FatalErrorf follows common convention to append\n'f' for functions accepting format arguments.\n\n-BEGIN VERIFY SCRIPT-\nsed -i 's/FatalError/FatalErrorf/g' $( git grep -l 'FatalError')\n-END VERIFY SCRIPT-",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-07T08:14:53Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-05-14T17:21:50Z"
      },
      "sha": "bdca3c79fb8d004b0d87d7fe66e72e01f8a74a38"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU5ZjAwZDVmY2Q0MGNmNmJkYjI2MDdlNDhhMjY0YzJjY2UwMGRhYTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/59f00d5fcd40cf6bdb2607e48a264c2cce00daa9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/59f00d5fcd40cf6bdb2607e48a264c2cce00daa9",
      "tree": {
        "sha": "dab6441ea2513ee4182b0e1d5a65140d57b27382",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dab6441ea2513ee4182b0e1d5a65140d57b27382"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree dab6441ea2513ee4182b0e1d5a65140d57b27382\nparent bdca3c79fb8d004b0d87d7fe66e72e01f8a74a38\nauthor TheCharlatan <seb.kung@gmail.com> 1683623746 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1686125702 +0200\n\nkernel: Add fatalError method to notifications\n\nFatalError replaces what previously was the AbortNode function in\nshutdown.cpp.\n\nThis commit is part of the libbitcoinkernel project and removes the\nshutdown's and, more generally, the kernel library's dependency on\ninterface_ui with a kernel notification method. By removing interface_ui\nfrom the kernel library, its dependency on boost is reduced to just\nboost::multi_index. At the same time it also takes a step towards\nde-globalising the interrupt infrastructure.\n\nAlso add an interrupt switch in chainman and blockman. This simplifies\ntesting of validation methods that may normally trigger an interrupt on a\nfatal error by leaving out the interrupt invocation.\n\nCo-authored-by: Russell Yanofsky <russ@yanofsky.org>\nCo-authored-by: TheCharlatan <seb.kung@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmSAPIYACgkQm3m0VpHb\nQXMUzRAAv8yRVnLgrRfXDLzt9ROU8dVL5a0RLW4Z0lEofvdZ+4NhQ5DMhs3+l2zD\nEafIcuZn2Ql7+TtV1o0HZ/8Ex/OariBncTFMeiYw8Gcl71uiVk/BdyiwgPJp1Jaq\nLfe1VVU3GwW76Z2gbNWRDaMuf1qlWngtuvkbg/U9WiVbTRD+WCgxJneezR1+mQ7j\n/lS1AC+kPVbhu3lR3AkUpaPXEr+Zh8TT7ArQWG5dDmokHkhCJyYwqP/er02wj7y/\n/vbCDYx6q67rrTt2mezjKDkaRw7MEwqcb1d/uKuiSJ1CCPapz1HjWBrxc/4mnI4x\n6IKjZ02XlYnDQaREpEUuy2J8iYyl6cnpl8K44mE7Hil7P6dwi70xQ2hSN+rIsGFR\ncDvU0+DgvUyjFq3Y3HvBhEeSAI4ja/hTY+MmgHmUc0dcSJu2REIOYTm1rLE8fA6U\n60VllZzLLppLqNkLDLFlRIT1P+y1Yt9NdZ4CgCe1sxhO9UbJThOSUPjXXH8stnin\nmadk7HzqLkYzmgSuOgvTCdS/8L6LNhVfJKOo/aLTWV1t1F8iXO5jNiVmxzMb9I90\nkaUzAL5S1sATJc1FmlVAH1UvEzpXPdpXVPC0Lgb4FeulOLf8I8IwzEP3kfq38FzH\ntt7ccSKiew6Eknoe2JqNSbzrBAP1fWQ/qyCgN2HpPAVrWfWk/Kg=\n=LOqJ\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bdca3c79fb8d004b0d87d7fe66e72e01f8a74a38",
          "sha": "bdca3c79fb8d004b0d87d7fe66e72e01f8a74a38",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bdca3c79fb8d004b0d87d7fe66e72e01f8a74a38"
        }
      ],
      "message": "kernel: Add fatalError method to notifications\n\nFatalError replaces what previously was the AbortNode function in\nshutdown.cpp.\n\nThis commit is part of the libbitcoinkernel project and removes the\nshutdown's and, more generally, the kernel library's dependency on\ninterface_ui with a kernel notification method. By removing interface_ui\nfrom the kernel library, its dependency on boost is reduced to just\nboost::multi_index. At the same time it also takes a step towards\nde-globalising the interrupt infrastructure.\n\nAlso add an interrupt switch in chainman and blockman. This simplifies\ntesting of validation methods that may normally trigger an interrupt on a\nfatal error by leaving out the interrupt invocation.\n\nCo-authored-by: Russell Yanofsky <russ@yanofsky.org>\nCo-authored-by: TheCharlatan <seb.kung@gmail.com>",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-07T08:15:02Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-05-09T09:15:46Z"
      },
      "sha": "59f00d5fcd40cf6bdb2607e48a264c2cce00daa9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc5YjU0OWFiZWU2MGQxM2VkY2Y4ZmU2YTRjODk5YzFiMGJkMDhmODg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/79b549abee60d13edcf8fe6a4c899c1b0bd08f88",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/79b549abee60d13edcf8fe6a4c899c1b0bd08f88",
      "tree": {
        "sha": "9e7eef3834296e9ba154781b58479b2b112c5dcb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9e7eef3834296e9ba154781b58479b2b112c5dcb"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9e7eef3834296e9ba154781b58479b2b112c5dcb\nparent 59f00d5fcd40cf6bdb2607e48a264c2cce00daa9\nauthor TheCharlatan <seb.kung@gmail.com> 1685781491 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1686125761 +0200\n\nblockstorage: Make failed to connect best block a FatalError\n\nThis is an error and we return on it, so treat it like one and don't\ncall the normal shutdown procedure.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmSAPMEACgkQm3m0VpHb\nQXPSkw//dhRc47sI/K9pfnyiifRnyCKmwR6WS1aEKVo+qvid9aY31VAYyMkkeAvc\nHbzYmgBCadDzpiV+UDYUxud/Cpf+vAxLB0NNGUmvRr6/84E2EPnCr+DgAf49oYQv\nGm8/joluN/c+C0j4lnMLX0QQEk8yJdLr7PeQhkF2+DCElX3oLOT51ihDPBE8R1XX\nm5vFlBGCT0X4Z7kv78BqeoExPaUyqFcoSun9oLeHwXGQITKDHa4Yn0JSTwrkH0RT\nuo6uCmBAWKPogCTN2mQNO/k/D7PtyNXJVnSnDhB3KnOKc5IM1uo9d/TZlVBTvNFB\n4xCALxWv2VLolew40lkVKzNyMlfPAeIYpqNVVzvS0SwZnpbt69bdxkEM6POZEz7M\n4vJxu21Y25gNgv9dS6eKfaCyGXVdF3VYEXbnIxTjje2HCmuwbOHqsR578bi9YDlX\nhsnW9yUlaAkwh6hAWEo/yzcV6bvoNGlOS0+tSFyV8Pv3QLgJQUboHyz4PNFjl35C\nWV6XxQlQNouihYaF4ttmInjHAdAqo6jYagB7vhh/jE6LlkmgFpJlDtH1aI7RjCnM\nqnndE+Q0D5ZpAx/eitXJJlB9vWNGbGcFGY3R0mGBcYgCx5WI1JHkAKRwGj8AyYaW\nF9nA9b4ynPRnpNDDcQ9vHMFU9raTetdZ7dGeDK/ka+/PmvxXBQY=\n=QZLD\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/59f00d5fcd40cf6bdb2607e48a264c2cce00daa9",
          "sha": "59f00d5fcd40cf6bdb2607e48a264c2cce00daa9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/59f00d5fcd40cf6bdb2607e48a264c2cce00daa9"
        }
      ],
      "message": "blockstorage: Make failed to connect best block a FatalError\n\nThis is an error and we return on it, so treat it like one and don't\ncall the normal shutdown procedure.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-07T08:16:01Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-03T08:38:11Z"
      },
      "sha": "79b549abee60d13edcf8fe6a4c899c1b0bd08f88"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYxMzg4MGU4MzIwMGVjODI0ZDc1MjgwNjFmOTY3MDhkOTZiZjliZDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f13880e83200ec824d7528061f96708d96bf9bd4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f13880e83200ec824d7528061f96708d96bf9bd4",
      "tree": {
        "sha": "4e02d0e0163982027d0fed8b5eb51219fedd1e70",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4e02d0e0163982027d0fed8b5eb51219fedd1e70"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4e02d0e0163982027d0fed8b5eb51219fedd1e70\nparent 79b549abee60d13edcf8fe6a4c899c1b0bd08f88\nauthor TheCharlatan <seb.kung@gmail.com> 1684321383 +0200\ncommitter TheCharlatan <seb.kung@gmail.com> 1686125786 +0200\n\nkernel: Remove shutdown from kernel library\n\nThis decouples the libbitcoinkernel library from the shutdown routines.\nAs a library, it should it should have its own flexible interrupt\ninfrastructure without relying on node-wide globals.\n\nThis commit should achieve the final step towards this goal by replacing\ncalls to shutdown in kernel code with calls to interrupt. Since some\nkernel library user might not want to interrupt, but still receive the\nnotification, add a bool to control whether an interrupt is triggered\nupon reaching one of the trigger conditions.\n\nWhile touching the lines around StartShutdown, it became apparent that\nthere was no logging indicating the reason for a call to StartShutdown.\nAdd an InterruptReason enum to the interrupt notification to communicate\nthis.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmSAPNoACgkQm3m0VpHb\nQXOe7BAAmiMdAb93i+uqghN8V2CjoXNszaWMMkvvq3bJ5Yl14euTKf8kcA+6omKL\n81R+YBQ+1LdKFr7s3yZWNq8oURurs6Fe5862AKfFJVmaURzf772O/Uo/J5POOLQ/\nsN+T5UAzzKfVfaxK8amoq6/JPwfpCKvye5sMYyyco8kvptECiAwRZOJ4s0pKgsuG\noeqY6s7aHzWBr/bEsfvgMb+mF8D+jeZYTmb1DQib/2hFitwlAoJtjcsmg8EaPJRn\n2Fu+oEddC/gAX4yM1O41OsAnPRjs0CPdcXcXu3ShFyVSF+JJ2WCgWsFQdeB+rcTU\nsiggde4N9e6bxIq7H1IhCTrAhUXvYAkSxWCj+wxXVXaJ/LohTrhYNJvZHG1j5Mko\nJRnDWMnxw1YoITt/IRPDkhSOqYEd4YuWfBh7tKhFxlMJtdN3cP/25yh+0X/RoqG7\ng59QgTe8zDSWbI74ukzqDO8RtBTOpWv1iyJOKL5MvbD5ovCppfnzbnXMzZ+MbJqC\nv1v4DNMtYF91lBSUpaDV2oaKdbsdQMVARTnhpYs4+DbmU/wDO++4ZKwtnw0f8ZIV\nzdr0LmW0rAFSCp59Q8KirFjV9CeHloP62uKuszsdxeXGmhe3FnNWD9LAnSaXvgfU\nLCbjOXZOLi75d1BLh6eKXHPq0yFZXrnoYQLmar2l50xsOxZfZ5Y=\n=9XmD\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/79b549abee60d13edcf8fe6a4c899c1b0bd08f88",
          "sha": "79b549abee60d13edcf8fe6a4c899c1b0bd08f88",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/79b549abee60d13edcf8fe6a4c899c1b0bd08f88"
        }
      ],
      "message": "kernel: Remove shutdown from kernel library\n\nThis decouples the libbitcoinkernel library from the shutdown routines.\nAs a library, it should it should have its own flexible interrupt\ninfrastructure without relying on node-wide globals.\n\nThis commit should achieve the final step towards this goal by replacing\ncalls to shutdown in kernel code with calls to interrupt. Since some\nkernel library user might not want to interrupt, but still receive the\nnotification, add a bool to control whether an interrupt is triggered\nupon reaching one of the trigger conditions.\n\nWhile touching the lines around StartShutdown, it became apparent that\nthere was no logging indicating the reason for a call to StartShutdown.\nAdd an InterruptReason enum to the interrupt notification to communicate\nthis.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-06-07T08:16:26Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2023-05-17T11:03:03Z"
      },
      "sha": "f13880e83200ec824d7528061f96708d96bf9bd4"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9456790224,
      "node_id": "HRFPE_lADOABII585mbbWMzwAAAAIzqyrQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9456790224",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T10:02:21Z"
    },
    {
      "event": "commented",
      "id": 1580365465,
      "node_id": "IC_kwDOABII585eMnaZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1580365465",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T10:02:56Z",
      "updated_at": "2023-06-07T10:02:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you @theuni and @ryanofsky for the great discussion so far.\r\n\r\nUpdated a6a3c3245303d05917c04460e71790e33241f3b5 -> f13880e83200ec824d7528061f96708d96bf9bd4 ([rmKernelShutdown_0](https://github.com/TheCharlatan/bitcoin/commits/rmKernelShutdown_0) -> [rmKernelShutdown_1](https://github.com/TheCharlatan/bitcoin/commits/rmKernelShutdown_1), [compare](https://github.com/TheCharlatan/bitcoin/compare/rmKernelShutdown_0..rmKernelShutdown_1)).\r\n\r\nThis update reworks the existing logic in this pull request by integrating @ryanofsky's suggested [branch](https://github.com/ryanofsky/bitcoin/commits/review.27711.1-edit). \r\n\r\nInstead of getting rid of the shutdown logic in the kernel, the core logic is now retained, but de-globalized and wrapped into a more user-friendly and self-descriptive class (`SignalInterrupt`).\r\n\r\nAs an alternative to @ryanofsky's [suggestion](https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214568318) for dropping the commits handling `startShutdown` I added boolean options that can be set by users of the kernel to indicate whether it should terminate if either a `FatalError` or `Interrupt` should trigger an actual interrupt.\r\n\r\nAlso adds two new commits, one for making a failure connecting the best block a `FatalError` and another for making `FlushBlockFile` and `FlushUndoFile` return on calls to `FatalError`. Rationale for each of these is provided in the commit messages.\r\n\r\nThese patches now went through quite some evolution in terms of their scope and intention. I am pushing this patch set to show how I'd currently unify the feeback received so far. In terms of next steps I'd like to lay out the following options:\r\n\r\n1. Get the current patch set through review, completing the goal of removing the `ui_interface` and some of the boost headers from the kernel. Complete step 2 of this phase of the kernel project. Add another step in this phase of the kernel project for strictly typing any functions that may cause an interrupt. My current thinking is to use @ryanofsky's #25665 extension of the `Result` type to return either a result or these fatal errors. Each instance of an interrupt call will be replaced piecemeal in separate PR's to allow for clean review. I found that some of these cases get quite complicated, meaning simply returning on a fatal error may lead to bugs if surrounding code is not also adapted, and catching all nuances in a single, sprawling PR is probably too burdensome. Eventually this should lead to code where we'd only have to trigger a fatal interrupt at the edges of the library, and otherwise just push fatal errors to code using it. \r\n\r\n2. Revert to a more minimal patch set, basically containing the new interrupt class + the `FatalError` wrapper to remove the `ui_interface`. Then proceed as in step 1.\r\n\r\n3. Close this PR, then proceed as in step 1. Once all fatal interrupt cases are handled, circle back to the kernel interrupt handling for long-running functions and conditional interrupts (in other words those lines of code that currently call `StartShutdown`).\r\n\r\nOption 1 is what seems pragmatic to me currently, option 2 would be closest to the goals as laid out in the kernel tracking issue (first cleave unwanted functionality / dependencies, then improve interfaces and fix weirdness discovered during development). Option 3 is where my heart is, even if it might block progress for some time and would depend on a bunch of other improvements to be completed first.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1580365465",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "mentioned",
      "id": 9456797880,
      "node_id": "MEE_lADOABII585mbbWMzwAAAAIzq0i4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9456797880",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T10:02:57Z"
    },
    {
      "event": "subscribed",
      "id": 9456797912,
      "node_id": "SE_lADOABII585mbbWMzwAAAAIzq0jY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9456797912",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T10:02:57Z"
    },
    {
      "event": "mentioned",
      "id": 9456797948,
      "node_id": "MEE_lADOABII585mbbWMzwAAAAIzq0j8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9456797948",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T10:02:57Z"
    },
    {
      "event": "subscribed",
      "id": 9456797967,
      "node_id": "SE_lADOABII585mbbWMzwAAAAIzq0kP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9456797967",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T10:02:57Z"
    },
    {
      "event": "renamed",
      "id": 9456804352,
      "node_id": "RTE_lADOABII585mbbWMzwAAAAIzq2IA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9456804352",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T10:03:20Z",
      "rename": {
        "from": "kernel: Remove shutdown from kernel library",
        "to": "kernel:  Remove shutdown globals from kernel library"
      }
    },
    {
      "event": "labeled",
      "id": 9457440822,
      "node_id": "LE_lADOABII585mbbWMzwAAAAIztRg2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9457440822",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T10:49:51Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1580779869,
      "node_id": "IC_kwDOABII585eOMld",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1580779869",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T13:07:05Z",
      "updated_at": "2023-06-07T13:07:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for following up and incorporating the feedback! \r\n\r\nOn the topic of how to move forward with these changes, I think we should see if we can find a way to avoid making temporary changes to validation code that are not desirable for the long term. Specifically:\r\n\r\n- Having `interrupt_on_fatal_error` and `interrupt_on_condition` ChainStateManager options which are complicated (and very confusing even to me!)\r\n- Giving ChainStateManager a mutable reference to the interrupt object instead of a const reference, and using the mutable reference to have it send interrupt signals to itself.\r\n\r\nIf temporary kludges are necessary to avoid having a PR that is too big to review, maybe that's a good tradeoff. But it would be better if we could see what the final code looks like before making that tradeoff. If this isn't possible, I think we should at least be able to add comments / documentation in the code saying which things are temporary and how they should be used in the meantime.\r\n\r\nIf you want to take time to iterate more on this code more, I think we could easily pull out parts of this PR right now that are pure improvements and could be reviewed and merged quickly. If you took the first commit here 8b3ac7d95253ac9c17faee3df29f11144e79f8b4 and the last two commits a4034e719c0dfa07bc8c267af3c2139d3b353757\r\nand bbfbcd0360e486d47025a412f2c0f4e8535ab255 that were previously part of #27636, I think we could quickly review and merge these in a separate PR as they are pure refactorings which do not change behavior or add temporary kludges to validation code.\r\n\r\nAfter that PR or alongside it commits 60f5461e160c4ef9aa5ee8e34f70a6459d12cae5 and 79b549abee60d13edcf8fe6a4c899c1b0bd08f88 from this PR also seem like good candidates for splitting off and being in their own PR so they could get more careful review as they do change behavior subtly.\r\n\r\nGreat to see more work here, though. I think there are still some tricky details to work out but most of the changes seem very good.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1580779869",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "labeled",
      "id": 9488090027,
      "node_id": "LE_lADOABII585mbbWMzwAAAAI1iMOr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9488090027",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-09T20:50:54Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1585112394,
      "node_id": "IC_kwDOABII585eeuVK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1585112394",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-09T20:50:55Z",
      "updated_at": "2023-06-09T20:50:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nðŸ™ This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1585112394",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "commented",
      "id": 1587127075,
      "node_id": "IC_kwDOABII585emaMj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1587127075",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-12T11:20:12Z",
      "updated_at": "2023-06-12T11:20:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "Re https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1580779869\r\n\r\n> If you want to take time to iterate more on this code more, I think we could easily pull out parts of this PR right now that are pure improvements and could be reviewed and merged quickly.\r\n\r\nOk, I will put this PR back to draft, and open two new ones as you suggested. I'll continue using this draft to stage my further improvements.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1587127075",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "convert_to_draft",
      "id": 9502621861,
      "node_id": "CTDE_lADOABII585mbbWMzwAAAAI2ZoCl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9502621861",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-12T13:17:19Z"
    },
    {
      "event": "commented",
      "id": 1587883295,
      "node_id": "IC_kwDOABII585epS0f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1587883295",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-12T18:45:01Z",
      "updated_at": "2023-06-12T18:45:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "I opened #27861 to introduce the interrupt class and implement the `fatalError` notification. Also opened https://github.com/bitcoin/bitcoin/pull/27866 to start tackling proper error return types when a function calls abort.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1587883295",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "referenced",
      "id": 9748078793,
      "node_id": "REFE_lADOABII585mbbWMzwAAAAJFB-DJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9748078793",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "75135c673ee61b61eb36b1b8aa8b4ddbe8da55e1",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/75135c673ee61b61eb36b1b8aa8b4ddbe8da55e1",
      "created_at": "2023-07-06T21:07:41Z"
    },
    {
      "event": "commented",
      "id": 1627096093,
      "node_id": "IC_kwDOABII585g-4Qd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627096093",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-08T10:45:06Z",
      "updated_at": "2023-07-08T10:45:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "Closing this PR in favor of:\r\n* #28053 Handling shutdown with `-stopafterblockimport`\r\n* https://github.com/bitcoin/bitcoin/pull/28048 Handling shutdown with `-stopatheight`\r\n* https://github.com/bitcoin/bitcoin/pull/27866 Handling blockstorage flush errors\r\n* https://github.com/bitcoin/bitcoin/pull/28051 Getting rid of shutdown code",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1627096093",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711"
    },
    {
      "event": "closed",
      "id": 9763644210,
      "node_id": "CE_lADOABII585mbbWMzwAAAAJF9WMy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9763644210",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-08T10:45:07Z"
    },
    {
      "event": "referenced",
      "id": 10513842721,
      "node_id": "REFE_lADOABII585mbbWMzwAAAAJyrIIh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10513842721",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "f562856d02d60625d914012d38df3582ea6b6c1f",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f562856d02d60625d914012d38df3582ea6b6c1f",
      "created_at": "2023-09-29T17:30:10Z"
    },
    {
      "event": "referenced",
      "id": 10566409801,
      "node_id": "REFE_lADOABII585mbbWMzwAAAAJ1zp5J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10566409801",
      "actor": {
        "login": "Frank-GER",
        "id": 87550788,
        "node_id": "MDQ6VXNlcjg3NTUwNzg4",
        "avatar_url": "https://avatars.githubusercontent.com/u/87550788?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Frank-GER",
        "html_url": "https://github.com/Frank-GER",
        "followers_url": "https://api.github.com/users/Frank-GER/followers",
        "following_url": "https://api.github.com/users/Frank-GER/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Frank-GER/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Frank-GER/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Frank-GER/subscriptions",
        "organizations_url": "https://api.github.com/users/Frank-GER/orgs",
        "repos_url": "https://api.github.com/users/Frank-GER/repos",
        "events_url": "https://api.github.com/users/Frank-GER/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Frank-GER/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "53099fdff43fbcab12a599ed82e3c73ac83a0424",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/53099fdff43fbcab12a599ed82e3c73ac83a0424",
      "created_at": "2023-10-05T16:57:13Z"
    },
    {
      "event": "locked",
      "id": 13414082642,
      "node_id": "LOE_lADOABII585mbbWMzwAAAAMfiqhS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13414082642",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-07T12:58:50Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213477846",
      "pull_request_review_id": 1455988697,
      "id": 1213477846,
      "node_id": "PRRC_kwDOABII585IVDPW",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"kernel: Pass reference of global shutdown requested atomic\" (978c05d58cea9f96f2713667663af35b43905701)\r\n\r\nI don't think I understand what the purpose of this option is at a high level. If I am writing an application which uses libbitcoinkernel, the thing I would want from the kernel library is a cancel() function I could call to cancel potentially slow operations. I don't want to have to mirror my application state to an `atomic<bool>` and be give the kernel read/write access to the bool as a more awkward way of cancelling.\r\n\r\nSo it seems to me the approach here is not very friendly to potential libbitcoinkernel applications, and is not even very friendly to our own application since it exposes the fRequestShutdown global more broadly and makes it harder to get rid of.\r\n\r\nI think a better approach would be to get rid of the `fRequestShutdown` global and replace it with a `CThreadInterrupt cancel` member in `kernel::Context`. I think this should not be too hard to do, and would still be compatible with most other changes in the PR.",
      "created_at": "2023-06-01T17:36:47Z",
      "updated_at": "2023-06-01T18:15:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1213477846",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213477846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213631522",
      "pull_request_review_id": 1456233246,
      "id": 1213631522,
      "node_id": "PRRC_kwDOABII585IVowi",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thank you for taking a look!\r\n\r\n> So it seems to me the approach here is not very friendly to potential libbitcoinkernel applications, and is not even very friendly to our own application since it exposes the fRequestShutdown global more broadly and makes it harder to get rid of.\r\n\r\nI was trying this out today on my proof of concept branch and got the same impression. It is unwieldy and the naming is bad.\r\n\r\n> I think a better approach would be to get rid of the fRequestShutdown global and replace it with a CThreadInterrupt cancel member in kernel::Context. I think this should not be too hard to do, and would still be compatible with most other changes in the PR.\r\n\r\nJust for clarity: This would imply passing a reference of the kernel context to the validation and blockstorage code? Giving the kernel ownership over this interrupt state seems a bit weird to me at first glance, since it is shared with all the other components that we have. Thinking of it as a pure execution interrupt, and not a kill signal makes this a bit more palatable though. ",
      "created_at": "2023-06-01T20:11:31Z",
      "updated_at": "2023-06-01T20:11:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1213631522",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213631522"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213768416",
      "pull_request_review_id": 1456443017,
      "id": 1213768416,
      "node_id": "PRRC_kwDOABII585IWKLg",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Just for clarity: This would imply passing a reference of the kernel context to the validation and blockstorage code? Giving the kernel ownership over this interrupt state seems a bit weird to me at first glance, since it is shared with all the other components that we have.\r\n\r\nI think the idea is to give the kernel ownership of it's own interrupt state, and not have to rely on an external mechanism. If other components that are already depending on the kernel want to share the same interrupt mechanism, they are then free to do that or not to do that.\r\n\r\nI implemented this approach in a branch based of this PR: https://github.com/ryanofsky/bitcoin/commits/review.27711.1-edit. \r\n\r\nThe first commit 04ee8f1190dc6712ea053caed0428ff0c70fca85 is the main one which moves the globals in shutdown.cpp into a `kernel::Context::cancel` member that should allow code using libbitcoinkernel to cancel ongoing tasks and interrupt execution.\r\n\r\nThe second commit 6df7bf3adf8f2a683379ed7830c296847ebfcb51 is just an updated version of your first commit 978c05d58cea9f96f2713667663af35b43905701 which passes references to the interrupt object everywhere instead of references to a `std::atomic<bool>`, and calls the object `m_interrupt` instead of `shutdown_requested` and passes it directly to *Manager constructors instead of requiring another field to be filled in the options structs.\r\n\r\nFree to incorporate any of those changes here.\r\n\r\nOne thing that I didn't think about enough is the last commit. I like the shutdown reason enum added there, but I don't think it should be necessary for the kernel to call out to the application cancel it's own execution if it can just call the cancellation object directly. So it might make sense to change that commit a little too in light of the first commit.\r\n",
      "created_at": "2023-06-01T23:18:24Z",
      "updated_at": "2023-06-01T23:18:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1213768416",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213768416"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214254203",
      "pull_request_review_id": 1457167784,
      "id": 1214254203,
      "node_id": "PRRC_kwDOABII585IYAx7",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't really understand the improvement in the context of achieving step 2 of the kernel library project between the solution you implemented now and what is implemented currently here in the first commit, besides it being a big step towards de-globalizing. One of my goals for this PR here is to stop the kernel relying on code that handles platform-dependent blocking while still being signal-aware (e.g. the bulk of what is currently in shutdown). I don't see why such logic should exist in a standalone kernel library. Do you have a different perspective here?\r\n\r\n> I like the shutdown reason enum added there, but I don't think it should be necessary for the kernel to call out to the application cancel it's own execution if it can just call the cancellation object directly.\r\n\r\nThis suggestion sounds good to me, setting the interrupt flag/bool/condition within kernel code would greatly improve ergonomics.",
      "created_at": "2023-06-02T11:26:38Z",
      "updated_at": "2023-06-02T11:26:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214254203",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214254203"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214342650",
      "pull_request_review_id": 1457365238,
      "id": 1214342650,
      "node_id": "PRRC_kwDOABII585IYWX6",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> One of my goals for this PR here is to stop the kernel relying on code that handles platform-dependent blocking while still being signal-aware (e.g. the bulk of what is currently in shutdown). I don't see why such logic should exist in a standalone kernel library. Do you have a different perspective here?\r\n\r\nYes, I don't think we should do this because it gets in the way of the kernel having a nice and future-proof API.\r\n\r\nI think we both agree that applications using libbitcoinkernel should have a way to cancel long running kernel threads and operations from an outside thread or signal handler. My [branch](https://github.com/ryanofsky/bitcoin/commits/review.27711.1-edit) provides that functionality though a [`SignalInterrupt`](https://github.com/ryanofsky/bitcoin/blob/cf326d0a42eadff811d466a84cbdd626f39c9d86/src/kernel/context.h#L21-L22) object that sits in the `kernel::Context` struct. By contrast, the [current PR](https://github.com/TheCharlatan/bitcoin/commits/a6a3c3245303d05917c04460e71790e33241f3b5) uses a `std::atomic<bool>` object that application needs to initialize itself and pass to the library.\r\n\r\nI think the approach in the branch is better for two reasons:\r\n\r\n- Using an `SignalInterrupt` object instead of an atomic bool provides a more future-proof API. It is true that right now, all the code running in the kernel can just get away with polling a bool every once in a while to decide whether to continue executing. But we don't know that this will be true in the future. If future kernel code wants to use a thread pool or some other asynchronous processing, there should be a way for outside code to _actively_ send an interrupt and cancel that processing, not just passively set a bool and require the kernel to poll for it. Supporting active cancellation should not require a change to the kernel API when we can just define the API in a general way without reference to `std::atomic<bool>` right now.\r\n\r\n- The API in the branch is friendlier than the API in the PR. Adding the interrupt object to the kernel::Context struct is nicer than requiring the application to initialize the interrupt object itself. Not every application needs to cancel kernel operations (bitcoin-chainstate.cpp is one example) so requiring those applications to declare an atomic shutdown variable adds boilerplate and complexity. You could address this by moving the atomic bool into kernel::Context. But even with that change I still think SignalInterrupt interface is cleaner than the atomic bool interface.\r\n\r\nI understand the approach in the PR makes kernel a littler smaller and lightweight, but to me overhead of depending on CThreadInterrupt, TokenPipe, SignalInterrupt, and unistd.h does not seem high enough to worry about. Also, whatever overhead there is here is an implemention detail of the kernel, and can be changed later. It's not something that's hardcoded into the kernel API.",
      "created_at": "2023-06-02T12:57:56Z",
      "updated_at": "2023-06-02T12:57:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214342650",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214342650"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214417257",
      "pull_request_review_id": 1457544117,
      "id": 1214417257,
      "node_id": "PRRC_kwDOABII585IYolp",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thank you for your comprehensive answer. I think it boils down to: A fatal error should not necessarily have to trigger an interrupt for all kernel operations. The user of the library should decide this. A `startShutdown` should interrupt all operations in order to cleanly halt kernel execution. \r\n\r\n> I don't think it should be necessary for the kernel to call out to the application cancel it's own execution if it can just call the cancellation object directly.\r\n\r\nGoing back to this earlier remark again, you declared the `m_interrupt` member in your branch as `const`. Do you think it is a bad idea to mutate it from within the chainman to forego a call to `StartShutdown`?",
      "created_at": "2023-06-02T13:57:32Z",
      "updated_at": "2023-06-02T13:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214417257",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214417257"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214538307",
      "pull_request_review_id": 1457844422,
      "id": 1214538307,
      "node_id": "PRRC_kwDOABII585IZGJD",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Thank you for your comprehensive answer. I think it boils down to: A fatal error should not necessarily have to trigger an interrupt for all kernel operations.\r\n\r\nYes, this is definitely a goal. Libbitcoinkernel should try to be a library, not an application or application framework. It should have a convenient way of cancelling operations and not force everything to use one shutdown variable.\r\n\r\nBut both the current PR and my branch do already support this. The main difference between the PR and branch is that the PR uses a `std::atomic<bool>` object, while the branch uses a `SignalInterrupt` object.\r\n\r\n> Going back to this earlier remark again, you declared the `m_interrupt` member in your branch as `const`. Do you think it is a bad idea to mutate it from within the chainman to forego a call to `StartShutdown`?\r\n\r\nIt's not necessarily bad, but it would be nice to avoid it. It would be cleaner if interrupt state cleanly represented whether a cancellation was requested or not, and wasn't also used to handle the `-stopatheight` and `-stopafterblockimport` corner cases.\r\n\r\nBecause of this, I was thinking of suggesting dropping the last commit a6a3c3245303d05917c04460e71790e33241f3b5 from the current PR, and leaving the two `StartShutdown()` calls in place for now. I think a better approach than calling `StartShutdown()` or calling `m_interrupt()` in those cases would be to just return \"finished\" or \"success\" status codes. Also in both cases, it would be better if the kernel wasn't deciding itself whether to return early, but instead asked the application through std::function callbacks. I.e. there could be a std::function callbacks for \"I just a new chain tip, should I keep processing or return early?\" that would be more general than having hardcoded `-stopatheight` logic in the kernel. The third \"FailedConnectingBestBlock\" shutdown case also seems like it should be returning a real error code to the application and calling fatalErrror, not just sending a shutdown notification.\r\n",
      "created_at": "2023-06-02T15:39:43Z",
      "updated_at": "2023-06-02T15:39:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214538307",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214538307"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214545050",
      "pull_request_review_id": 1457862394,
      "id": 1214545050,
      "node_id": "PRRC_kwDOABII585IZHya",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Also in both cases, it would be better if the kernel wasn't deciding itself whether to return early, but instead asked the application through std::function callbacks. I.e. there could be a std::function callbacks for \"I just a new chain tip, should I keep processing or return early?\" that would be more general than having hardcoded -stopatheight logic in the kernel. \r\n\r\nHow about making `startShutdown` return a boolean then that can be interpreted by calling code to either terminate the function or continue?\r\n\r\n> The third \"FailedConnectingBestBlock\" shutdown case also seems like it should be returning a real error code to the application and calling fatalErrror, not just sending a shutdown notification.\r\n\r\nAgreed.",
      "created_at": "2023-06-02T15:46:54Z",
      "updated_at": "2023-06-02T15:46:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214545050",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214545050"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214568318",
      "pull_request_review_id": 1457923567,
      "id": 1214568318,
      "node_id": "PRRC_kwDOABII585IZNd-",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> How about making `startShutdown` return a boolean then that can be interpreted by calling code to either terminate the function or continue?\r\n\r\nI think it's best if the notification interfaces just streamed notifications in one direction to the application, to update its UI, or trigger tasks like starting other services, saving state, freeing up disk space, or shutting down. \r\n\r\nThe notifications interface seems like an awkward way to send information the other direction from the application to the kernel, because it requires implementing a subclass, and because as a user of the kernel library, I would expect to look in option structs, not in the notification interface if to help implement functionality like `-stopatheight`.\r\n\r\nI think it would be great to get rid of the 3 StartShutdown calls in kernel code, but probably better to do in a separate PR that was independent of this one, since there's lots of approaches that could be used and none of them seem to depend on the other changes here.",
      "created_at": "2023-06-02T16:11:34Z",
      "updated_at": "2023-06-02T16:11:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214568318",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214568318"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1256159653",
      "pull_request_review_id": 1519329811,
      "id": 1256159653,
      "node_id": "PRRC_kwDOABII585K33ml",
      "diff_hunk": "@@ -25,6 +26,7 @@ struct BlockManagerOpts {\n     bool fast_prune{false};\n     bool stop_after_block_import{DEFAULT_STOPAFTERBLOCKIMPORT};\n     const fs::path blocks_dir;\n+    std::atomic<bool>& shutdown_requested;",
      "path": "src/kernel/blockmanager_opts.h",
      "position": null,
      "original_position": 12,
      "commit_id": "f13880e83200ec824d7528061f96708d96bf9bd4",
      "original_commit_id": "978c05d58cea9f96f2713667663af35b43905701",
      "in_reply_to_id": 1213477846,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1214568318\r\n\r\n> I think it would be great to get rid of the 3 StartShutdown calls in kernel code, but probably better to do in a separate PR that was independent of this one, since there's lots of approaches that could be used and none of them seem to depend on the other changes here.\r\n\r\nI implemented this idea in #28048, getting rid of the `stop_after_block_import` and `stop_at_height` kernel options and replacing them with more flexible blocks imported and block tips hooks.\r\n\r\nI did change my mind about making the hooks `std::function` callbacks instead of `kernel::Notification` callbacks, despite this adding a little more overhead to the notifications interface. Since the existing `blockTip` notification was already being sent at the same place the `StopAtHeight` check was implemented, it seemed less confusing to just reuse the existing callback instead of adding another callback at the same place.",
      "created_at": "2023-07-07T17:16:45Z",
      "updated_at": "2023-07-07T17:16:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27711#discussion_r1256159653",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1256159653"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    }
  ]
}