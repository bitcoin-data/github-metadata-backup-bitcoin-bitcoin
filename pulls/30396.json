{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396",
    "id": 1955323980,
    "node_id": "PR_kwDOABII5850i-BM",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/30396",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/30396.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/30396.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30396",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30396/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/6ecda04fefad980872c72fba89844393f5581120",
    "number": 30396,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "random: add benchmarks and drop unnecessary Shuffle function",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This adds benchmarks for various operations on `FastRandomContext` and `InsecureRandomContext`, and then removes the ad-hoc `Shuffle` functions, now that it appears that standard library `std::shuffle` beats it. The other reason for keeping `Shuffle`, namely the fact that libstdc++ used self-move (which debug mode panics on) has been fixed as well (see https://github.com/bitcoin/bitcoin/pull/29625#discussion_r1658344049).",
    "labels": [
      {
        "id": 241832923,
        "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
        "name": "Utils/log/libs",
        "description": "",
        "color": "5319e7",
        "default": false
      },
      {
        "id": 6861582155,
        "node_id": "LA_kwDOABII588AAAABmPtvSw",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20CMake%20port",
        "name": "Needs CMake port",
        "description": "",
        "color": "0e8a16",
        "default": false
      }
    ],
    "created_at": "2024-07-05T14:54:13Z",
    "updated_at": "2024-07-06T20:54:02Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "8604533d7fd23494c8cee2574923e0349200a9f1",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "sipa:202407_rng_opt",
      "ref": "202407_rng_opt",
      "sha": "6ecda04fefad980872c72fba89844393f5581120",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 1458655,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDU4NjU1",
        "name": "bitcoin",
        "full_name": "sipa/bitcoin",
        "owner": {
          "login": "sipa",
          "id": 548488,
          "node_id": "MDQ6VXNlcjU0ODQ4OA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/sipa",
          "html_url": "https://github.com/sipa",
          "followers_url": "https://api.github.com/users/sipa/followers",
          "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
          "organizations_url": "https://api.github.com/users/sipa/orgs",
          "repos_url": "https://api.github.com/users/sipa/repos",
          "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/sipa/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/sipa/bitcoin",
        "description": "Bitcoin integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/sipa/bitcoin",
        "archive_url": "https://api.github.com/repos/sipa/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/sipa/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/sipa/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/sipa/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/sipa/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/sipa/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/sipa/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/sipa/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/sipa/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/sipa/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/sipa/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/sipa/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/sipa/bitcoin/events",
        "forks_url": "https://api.github.com/repos/sipa/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/sipa/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/sipa/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/sipa/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/sipa/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/sipa/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/sipa/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/sipa/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/sipa/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/sipa/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/sipa/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/sipa/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/sipa/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/sipa/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/sipa/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/sipa/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:sipa/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/sipa/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/sipa/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/sipa/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/sipa/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/sipa/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/sipa/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/sipa/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/sipa/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/sipa/bitcoin/hooks",
        "svn_url": "https://github.com/sipa/bitcoin",
        "homepage": "http://www.bitcoin.org",
        "language": "TypeScript",
        "forks_count": 22,
        "stargazers_count": 86,
        "watchers_count": 86,
        "size": 241859,
        "default_branch": "lows",
        "open_issues_count": 16,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-07-06T13:07:05Z",
        "created_at": "2011-03-09T10:46:59Z",
        "updated_at": "2024-06-02T01:19:44Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "bd5d1688b4311e21c0e0ff89a3ae02ef7d0543b8",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35606,
        "stargazers_count": 77119,
        "watchers_count": 77119,
        "size": 262585,
        "default_branch": "master",
        "open_issues_count": 683,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-07-06T19:11:04Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-07-06T20:15:28Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 123,
    "deletions": 65,
    "changed_files": 16,
    "commits": 3,
    "review_comments": 8,
    "comments": 3
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBhOWJiYzY0YzE1N2EzMTRlNTQ3MmVjZDk4MzAwZTMwYjEyZDNmZGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0a9bbc64c157a314e5472ecd98300e30b12d3fdf",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0a9bbc64c157a314e5472ecd98300e30b12d3fdf",
      "tree": {
        "sha": "7b9f14319a5c8b766a7fa338ec7abeecb99aecc1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7b9f14319a5c8b766a7fa338ec7abeecb99aecc1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bd5d1688b4311e21c0e0ff89a3ae02ef7d0543b8",
          "sha": "bd5d1688b4311e21c0e0ff89a3ae02ef7d0543b8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bd5d1688b4311e21c0e0ff89a3ae02ef7d0543b8"
        }
      ],
      "message": "random bench refactor: move to new bench/random.cpp",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2024-07-05T13:51:26Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2024-07-05T13:51:26Z"
      },
      "sha": "0a9bbc64c157a314e5472ecd98300e30b12d3fdf"
    },
    {
      "event": "commented",
      "id": 2211019196,
      "node_id": "IC_kwDOABII586DyXm8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2211019196",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-05T14:54:16Z",
      "updated_at": "2024-07-05T14:54:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30396).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#issuecomment-2211019196",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30396"
    },
    {
      "event": "commented",
      "id": 2211033120,
      "node_id": "IC_kwDOABII586DybAg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2211033120",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-05T15:02:45Z",
      "updated_at": "2024-07-05T15:28:14Z",
      "author_association": "MEMBER",
      "body": "I've also benchmarked Deniel Lemire's [nearly divisionless random integer generation](https://lemire.me/blog/2019/06/06/nearly-divisionless-random-integer-generation-on-various-systems/) (which libstdc++'s `std::shuffle` switched to), for `randrange` itself, but opted not to include this in this PR.\r\n\r\nFor `InsecureRandomContext` it's unambiguously faster than the current code (but nothing performance-critical relies on `InsecureRandomContext::randrange`, so far). For `FastRandomContext` the advantage is there, but it's more tricky  to achieve (it either needs fast 128-bit integer multiplication, or needs specialization for 32-bit randrange where a 64-bit multiply suffices).",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#issuecomment-2211033120",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30396"
    },
    {
      "event": "labeled",
      "id": 13407295753,
      "node_id": "LE_lADOABII586OnpJbzwAAAAMfIxkJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13407295753",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-05T15:13:35Z",
      "label": {
        "name": "Utils/log/libs",
        "color": "5319e7"
      }
    },
    {
      "event": "labeled",
      "id": 13407295761,
      "node_id": "LE_lADOABII586OnpJbzwAAAAMfIxkR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13407295761",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-05T15:13:35Z",
      "label": {
        "name": "Needs CMake port",
        "color": "0e8a16"
      }
    },
    {
      "event": "reviewed",
      "id": 2160912705,
      "node_id": "PRR_kwDOABII586AzOlB",
      "url": null,
      "actor": null,
      "commit_id": "3757fb9074fec417baeb5cef10ed7ee7be1d4c18",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#pullrequestreview-2160912705",
      "submitted_at": "2024-07-05T15:14:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13407383723,
      "node_id": "HRFPE_lADOABII586OnpJbzwAAAAMfJHCr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13407383723",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-05T15:23:26Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13407435838,
      "node_id": "HRFPE_lADOABII586OnpJbzwAAAAMfJTw-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13407435838",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-05T15:29:17Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13407456920,
      "node_id": "HRFPE_lADOABII586OnpJbzwAAAAMfJY6Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13407456920",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-05T15:31:44Z"
    },
    {
      "event": "reviewed",
      "id": 2161156126,
      "node_id": "PRR_kwDOABII586A0KAe",
      "url": null,
      "actor": null,
      "commit_id": "e8985f42854fe8e83a4c588c39f4429f788d6439",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "~Is determinism of `std::shuffle` controlled/controllable? If we don't control it maybe it would be better to keep our custom one to ease reproducibility of test failures, despite it being slower.~\r\nI see now that you are passing the proper context. üëç",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#pullrequestreview-2161156126",
      "submitted_at": "2024-07-05T19:27:03Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRhMjhhMjZhYWUzMTc4ZmI3NjYzZWZiZTIwYmI2NTA4NTdhY2U3NzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da28a26aae3178fb7663efbe20bb650857ace775",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/da28a26aae3178fb7663efbe20bb650857ace775",
      "tree": {
        "sha": "2fe21be8368cc3b42199626923b2e37a4e31a759",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2fe21be8368cc3b42199626923b2e37a4e31a759"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0a9bbc64c157a314e5472ecd98300e30b12d3fdf",
          "sha": "0a9bbc64c157a314e5472ecd98300e30b12d3fdf",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0a9bbc64c157a314e5472ecd98300e30b12d3fdf"
        }
      ],
      "message": "bench random: benchmark more functions, and add InsecureRandomContext\n\nAlso rename the benchmark names to match the operation names",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2024-07-06T13:06:01Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2024-07-05T14:00:50Z"
      },
      "sha": "da28a26aae3178fb7663efbe20bb650857ace775"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZlY2RhMDRmZWZhZDk4MDg3MmM3MmZiYTg5ODQ0MzkzZjU1ODExMjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ecda04fefad980872c72fba89844393f5581120",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6ecda04fefad980872c72fba89844393f5581120",
      "tree": {
        "sha": "b08e3d4a97887f7d5bdc558b18ed3d9c07786914",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b08e3d4a97887f7d5bdc558b18ed3d9c07786914"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da28a26aae3178fb7663efbe20bb650857ace775",
          "sha": "da28a26aae3178fb7663efbe20bb650857ace775",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/da28a26aae3178fb7663efbe20bb650857ace775"
        }
      ],
      "message": "random: drop ad-hoc Shuffle in favor of std::shuffle\n\nBenchmarks show it is no longer faster with modern standard C++ libraries,\nand the debug-mode failure due to self-move has been fixed as well.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2024-07-06T13:06:36Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2024-07-05T14:45:54Z"
      },
      "sha": "6ecda04fefad980872c72fba89844393f5581120"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13411511104,
      "node_id": "HRFPE_lADOABII586OnpJbzwAAAAMfY2tA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13411511104",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-06T13:07:06Z"
    },
    {
      "event": "reviewed",
      "id": 2161613367,
      "node_id": "PRR_kwDOABII586A15o3",
      "url": null,
      "actor": null,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "Ran benchmarks on da28a26aae3178fb7663efbe20bb650857ace775 with..\r\n\r\n### Clang, non-debug, Linux\r\n\r\n```console\r\n$ src/bench/bench_bitcoin --filter=\".*Random.*\"\r\n\r\n|           ns/number |            number/s |    err% |      ins/number |      cyc/number |    IPC |     bra/number |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|               12.84 |       77,883,564.55 |    0.2% |          103.12 |           47.37 |  2.177 |          15.66 |    4.2% |      0.01 | `FastRandom_Shuffle100`\r\n|               10.35 |       96,651,871.86 |    0.1% |          116.75 |           38.15 |  3.060 |           9.38 |    0.0% |      0.01 | `FastRandom_rand32`\r\n|               19.03 |       52,549,720.82 |    0.2% |          214.50 |           70.12 |  3.059 |          15.75 |    0.0% |      0.01 | `FastRandom_rand64`\r\n|               14.56 |       68,674,993.41 |    0.2% |          149.17 |           53.67 |  2.779 |          14.49 |    1.2% |      0.01 | `FastRandom_randbits`\r\n|                1.69 |      591,854,532.68 |    0.0% |           11.38 |            6.23 |  1.826 |           1.26 |    0.2% |      0.01 | `FastRandom_randbool`\r\n|               12.11 |       82,569,289.00 |    0.1% |           95.33 |           44.68 |  2.133 |          13.70 |    4.4% |      0.01 | `FastRandom_randrange100`\r\n|               13.55 |       73,808,837.05 |    0.6% |          108.46 |           49.99 |  2.170 |          14.63 |    4.4% |      0.01 | `FastRandom_randrange1000`\r\n|               17.80 |       56,164,658.15 |    0.1% |          156.81 |           65.65 |  2.389 |          18.39 |    3.3% |      0.20 | `FastRandom_randrange1000000`\r\n|               13.08 |       76,440,558.82 |    0.2% |          134.02 |           48.23 |  2.779 |          12.42 |    0.7% |      0.01 | `FastRandom_stdshuffle100`\r\n|                7.55 |      132,409,503.40 |    0.9% |           52.83 |           27.85 |  1.897 |          10.39 |    6.3% |      0.01 | `InsecureRandom_Shuffle100`\r\n|                1.70 |      589,139,570.89 |    0.2% |           19.50 |            6.25 |  3.118 |           1.50 |    0.0% |      0.01 | `InsecureRandom_rand32`\r\n|                1.11 |      901,858,137.81 |    0.0% |            7.00 |            4.09 |  1.711 |           0.00 |    0.0% |      0.01 | `InsecureRandom_rand64`\r\n|                2.10 |      475,829,327.28 |    0.4% |           20.89 |            7.75 |  2.697 |           2.48 |    0.0% |      0.01 | `InsecureRandom_randbits`\r\n|                1.40 |      714,972,427.11 |    0.1% |           12.25 |            5.16 |  2.374 |           1.02 |    0.0% |      0.01 | `InsecureRandom_randbool`\r\n|                6.46 |      154,870,239.99 |    0.3% |           39.00 |           23.80 |  1.639 |           8.14 |    7.7% |      0.01 | `InsecureRandom_randrange100`\r\n|                7.08 |      141,237,665.66 |    0.4% |           39.80 |           26.10 |  1.525 |           7.97 |    7.9% |      0.01 | `InsecureRandom_randrange1000`\r\n|                6.49 |      154,065,899.22 |    0.6% |           43.93 |           23.80 |  1.846 |           7.80 |    7.0% |      0.07 | `InsecureRandom_randrange1000000`\r\n|                3.61 |      276,805,356.11 |    0.1% |           34.38 |           13.33 |  2.580 |           3.98 |    0.3% |      0.01 | `InsecureRandom_stdshuffle100`\r\n```\r\n`FastRandom` - `std::shuffle` slower by ~2%.\r\n`InsecureRandom` - `std::shuffle` is ~2.1x faster, the case for migrating is strong here.\r\n\r\n### GCC equivalent\r\n\r\n```console\r\n$ src/bench/bench_bitcoin --filter=\".*Random.*\"\r\n\r\n|           ns/number |            number/s |    err% |      ins/number |      cyc/number |    IPC |     bra/number |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|               10.90 |       91,706,416.37 |    0.4% |           73.17 |           40.22 |  1.819 |           8.91 |    7.6% |      0.01 | `FastRandom_Shuffle100`\r\n|               10.29 |       97,154,304.49 |    0.1% |          115.31 |           37.96 |  3.037 |           8.94 |    0.0% |      0.01 | `FastRandom_rand32`\r\n|               18.97 |       52,727,508.94 |    0.4% |          210.63 |           69.79 |  3.018 |          15.88 |    0.0% |      0.01 | `FastRandom_rand64`\r\n|               11.56 |       86,507,143.42 |    0.5% |          122.79 |           42.62 |  2.881 |          10.55 |    0.4% |      0.01 | `FastRandom_randbits`\r\n|                1.68 |      594,607,147.44 |    0.1% |           12.32 |            6.20 |  1.987 |           1.25 |    0.2% |      0.01 | `FastRandom_randbool`\r\n|                9.99 |      100,126,193.36 |    0.4% |           61.84 |           36.83 |  1.679 |           6.91 |    9.1% |      0.01 | `FastRandom_randrange100`\r\n|               11.50 |       86,963,003.45 |    0.3% |           75.50 |           42.40 |  1.781 |           7.89 |    8.1% |      0.01 | `FastRandom_randrange1000`\r\n|               15.36 |       65,104,420.98 |    0.4% |          122.93 |           56.09 |  2.192 |          11.41 |    5.2% |      0.17 | `FastRandom_randrange1000000`\r\n|               14.70 |       68,050,253.74 |    0.0% |          138.64 |           54.21 |  2.558 |          11.02 |    0.1% |      0.01 | `FastRandom_stdshuffle100`\r\n|                8.32 |      120,167,896.55 |    0.4% |           51.58 |           30.66 |  1.682 |           7.84 |    8.3% |      0.01 | `InsecureRandom_Shuffle100`\r\n|                1.09 |      920,716,470.48 |    0.0% |           13.00 |            4.01 |  3.244 |           1.00 |    0.0% |      0.01 | `InsecureRandom_rand32`\r\n|                0.88 |    1,133,795,846.45 |    0.1% |            7.00 |            3.25 |  2.153 |           0.00 |   57.0% |      0.01 | `InsecureRandom_rand64`\r\n|                1.66 |      601,775,499.66 |    1.2% |           19.86 |            6.11 |  3.251 |           1.98 |    0.0% |      0.01 | `InsecureRandom_randbits`\r\n|                0.56 |    1,771,130,575.63 |    0.1% |            4.28 |            2.08 |  2.057 |           1.00 |    0.0% |      0.01 | `InsecureRandom_randbool`\r\n|                6.97 |      143,428,585.12 |    0.2% |           30.93 |           25.70 |  1.203 |           5.84 |   10.5% |      0.01 | `InsecureRandom_randrange100`\r\n|                7.25 |      137,895,833.08 |    0.2% |           32.18 |           26.75 |  1.203 |           5.78 |   10.6% |      0.01 | `InsecureRandom_randrange1000`\r\n|                7.37 |      135,732,504.89 |    0.4% |           37.62 |           26.87 |  1.400 |           5.81 |    9.2% |      0.08 | `InsecureRandom_randrange1000000`\r\n|                5.81 |      172,220,492.06 |    0.1% |           33.82 |           21.42 |  1.579 |           3.09 |    0.3% |      0.01 | `InsecureRandom_stdshuffle100`\r\n```\r\n`FastRandom` - `std::shuffle` shows a performance loss of 26%. :/\r\n`InsecureRandom` - `std::shuffle` wins with ~1.4x speed multiplier.\r\n(Side note: `std::shuffle` seems much better than `Shuffle` when it comes to branch misses in this configuration (already significantly better in Clang)).\r\n\r\n### GCC in debug mode\r\n\r\n```console\r\n$ src/bench/bench_bitcoin --filter=\".*Random.*\"\r\nWarning, results might be unstable:\r\n* DEBUG defined\r\n\r\nRecommendations\r\n* Make sure you compile for Release\r\n\r\n|           ns/number |            number/s |    err% |      ins/number |      cyc/number |    IPC |     bra/number |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|               96.61 |       10,350,962.32 |    0.4% |          844.51 |          356.24 |  2.371 |         124.47 |    0.5% |      0.01 | `FastRandom_Shuffle100`\r\n|              182.54 |        5,478,307.47 |    0.0% |        1,703.98 |          673.49 |  2.530 |         204.73 |    0.1% |      0.01 | `FastRandom_rand32`\r\n|              342.44 |        2,920,180.80 |    0.0% |        3,197.03 |        1,263.38 |  2.531 |         370.47 |    0.1% |      0.01 | `FastRandom_rand64`\r\n|              192.05 |        5,207,050.93 |    0.1% |        1,756.26 |          708.80 |  2.478 |         213.54 |    0.3% |      0.01 | `FastRandom_randbits`\r\n|               16.01 |       62,471,637.02 |    0.1% |          148.23 |           59.00 |  2.513 |          23.84 |    0.1% |      0.01 | `FastRandom_randbool`\r\n|               87.24 |       11,461,986.84 |    0.6% |          758.66 |          321.66 |  2.359 |         108.08 |    0.6% |      0.01 | `FastRandom_randrange100`\r\n|              110.16 |        9,077,576.97 |    0.5% |          965.24 |          405.83 |  2.378 |         132.06 |    0.5% |      0.01 | `FastRandom_randrange1000`\r\n|              186.39 |        5,365,223.88 |    0.1% |        1,676.54 |          687.82 |  2.437 |         215.45 |    0.3% |      2.05 | `FastRandom_randrange1000000`\r\n|              215.54 |        4,639,483.16 |    0.2% |        1,906.59 |          794.16 |  2.401 |         229.95 |    0.1% |      0.01 | `FastRandom_stdshuffle100`\r\n|               53.91 |       18,549,333.04 |    0.3% |          457.13 |          198.59 |  2.302 |          79.37 |    0.8% |      0.01 | `InsecureRandom_Shuffle100`\r\n|               22.03 |       45,393,295.79 |    0.1% |          215.50 |           81.27 |  2.652 |          31.50 |    0.0% |      0.01 | `InsecureRandom_rand32`\r\n|               22.72 |       44,019,773.42 |    0.0% |          220.00 |           83.84 |  2.624 |          24.00 |    0.0% |      0.01 | `InsecureRandom_rand64`\r\n|               27.54 |       36,307,742.75 |    0.6% |          244.77 |          101.11 |  2.421 |          37.63 |    1.0% |      0.01 | `InsecureRandom_randbits`\r\n|               10.95 |       91,358,394.49 |    0.1% |          101.70 |           40.40 |  2.518 |          18.42 |    0.1% |      0.01 | `InsecureRandom_randbool`\r\n|               44.06 |       22,693,987.66 |    0.3% |          371.40 |          162.65 |  2.283 |          63.01 |    0.9% |      0.01 | `InsecureRandom_randrange100`\r\n|               45.33 |       22,061,595.98 |    0.2% |          382.82 |          167.30 |  2.288 |          64.26 |    0.9% |      0.01 | `InsecureRandom_randrange1000`\r\n|               50.17 |       19,933,844.35 |    0.2% |          438.63 |          184.96 |  2.372 |          71.38 |    0.8% |      0.55 | `InsecureRandom_randrange1000000`\r\n|               52.96 |       18,880,998.91 |    0.2% |          418.53 |          195.25 |  2.144 |          56.76 |    0.0% |      0.01 | `InsecureRandom_stdshuffle100`\r\n```\r\n`FastRandom` - `std::shuffle` is less than half the speed. :/ A lot more instructions & branches.\r\n`InsecureRandom` - Negligible difference.\r\n\r\n### Conclusion so far\r\n\r\n`InsecureRandom` is only used in tests, so this would probably be a win for developers/testers/fuzzing but not really for end users. Maybe other systems/configurations show a clearer win.\r\n\r\nAlso ran `make check` & `test/functional/test_runner.py` on 6ecda04fefad980872c72fba89844393f5581120 in GCC debug without any failures. Confirming that the self-assign issue with `std::shuffle` doesn't appear to be an issue. (Haven't tried to create a configuration that triggers the panic though).",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#pullrequestreview-2161613367",
      "submitted_at": "2024-07-06T20:28:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
    },
    {
      "event": "commented",
      "id": 2211965086,
      "node_id": "IC_kwDOABII586D1-ie",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2211965086",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-06T20:54:02Z",
      "updated_at": "2024-07-06T20:54:02Z",
      "author_association": "MEMBER",
      "body": "@hodlinator FWIW, my motivation here is just FastRandomContext non-debug performance. I did notice that `std::shuffle` is a bit slower than the custom Shuffle on my system too (AMD 5950X, GCC 13.2) , but not the huge (5x-10x) slowdown it once was. With 2% or 26% or even 50% slowdown, I don't think it's worth keeping a custom function around (I don't think any of the `Shuffle` uses are *that* performance critical). Things like `randbool` and `randrange` are probably more relevant overall.\r\n\r\nI do expect InsecureRandomContext will get used for non-testing purposes eventually, but that's not a huge motivation now.\r\n\r\nTo explain what we're seeing here, worked out for a shuffle of 100 elements:\r\n* `Shuffle` would use `randrange` 100 times, which for the ranges involved would invoke `rand64` on average ~13.005 times.\r\n* `std::shuffle` would invoke `rand64` ~100 times directly.\r\n\r\nIn FastRandomContext, the cost of a `rand64` is relevatively high, while for InsecureRandomContext it is very low. On the other hand, `randrange` itself has some overhead too. For `FastRandomContext` this `randrange` overhead is worth it as it is compensated by less of the expensive `rand64` calls, while for `InsecureRandomContext` the reduction in `rand64` cost is negligible.\r\n\r\nIf we really wanted, it would be possible to use the technique that `std::shuffle` uses for converting `rand64`s directly into integers of arbitrary range, in `InsecureRandomContext::randrange`, but it making it efficient would need a few different variants for different compilers/architectures. As there is no use case for efficient `InsecureRandomContext::randrange` right now that doesn't seem worth it, but that can change.\r\n\r\n\r\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#issuecomment-2211965086",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30396"
    },
    {
      "event": "mentioned",
      "id": 13412379160,
      "node_id": "MEE_lADOABII586OnpJbzwAAAAMfcKoY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13412379160",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-06T20:54:03Z"
    },
    {
      "event": "subscribed",
      "id": 13412379166,
      "node_id": "SE_lADOABII586OnpJbzwAAAAMfcKoe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13412379166",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-06T20:54:03Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1666921146",
      "pull_request_review_id": 2160912705,
      "id": 1666921146,
      "node_id": "PRRC_kwDOABII585jWzK6",
      "diff_hunk": "@@ -5,21 +5,34 @@\n #include <bench/bench.h>\n #include <random.h>\n \n-static void FastRandom_32bit(benchmark::Bench& bench)\n+namespace {\n+\n+template<typename RNG>\n+void BenchRandom_rand32(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n     bench.run([&] {\n-        rng.rand32();\n+        rng._rand32();",
      "path": "src/bench/random.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "original_commit_id": "3757fb9074fec417baeb5cef10ed7ee7be1d4c18",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Are you sure this commit compiles?",
      "created_at": "2024-07-05T15:14:47Z",
      "updated_at": "2024-07-05T15:14:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#discussion_r1666921146",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1666921146"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1666929156",
      "pull_request_review_id": 2160925226,
      "id": 1666929156,
      "node_id": "PRRC_kwDOABII585jW1IE",
      "diff_hunk": "@@ -5,21 +5,34 @@\n #include <bench/bench.h>\n #include <random.h>\n \n-static void FastRandom_32bit(benchmark::Bench& bench)\n+namespace {\n+\n+template<typename RNG>\n+void BenchRandom_rand32(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n     bench.run([&] {\n-        rng.rand32();\n+        rng._rand32();",
      "path": "src/bench/random.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "original_commit_id": "3757fb9074fec417baeb5cef10ed7ee7be1d4c18",
      "in_reply_to_id": 1666921146,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm sure it does not. Fixed.",
      "created_at": "2024-07-05T15:23:34Z",
      "updated_at": "2024-07-05T15:23:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#discussion_r1666929156",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1666929156"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667073020",
      "pull_request_review_id": 2161156126,
      "id": 1667073020,
      "node_id": "PRRC_kwDOABII585jXYP8",
      "diff_hunk": "@@ -5,21 +5,113 @@\n #include <bench/bench.h>\n #include <random.h>\n \n-static void FastRandom_32bit(benchmark::Bench& bench)\n+#include <cstdint>\n+#include <numeric>\n+\n+namespace {\n+\n+template<typename RNG>\n+void BenchRandom_rand64(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n+        rng.rand64();\n+    });\n+}\n+\n+template<typename RNG>\n+void BenchRandom_rand32(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.rand32();\n     });\n }\n \n-static void FastRandom_1bit(benchmark::Bench& bench)\n+template<typename RNG>\n+void BenchRandom_randbool(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.randbool();\n     });\n }\n \n-BENCHMARK(FastRandom_32bit, benchmark::PriorityLevel::HIGH);\n-BENCHMARK(FastRandom_1bit, benchmark::PriorityLevel::HIGH);\n+template<typename RNG>\n+void BenchRandom_randbits(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(64).unit(\"number\").run([&] {\n+        for (int i = 1; i <= 64; ++i) {\n+            rng.randbits(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_randrange(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        for (int i = 1; i <= RANGE; ++i) {\n+            rng.randrange(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_Shuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        Shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_stdshuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        std::shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+void FastRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, FastRandomContext(true)); }\n+void FastRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, FastRandomContext(true)); }\n+void FastRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, FastRandomContext(true)); }\n+void FastRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, FastRandomContext(true)); }\n+void FastRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, FastRandomContext(true)); }\n+void FastRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_stdshuffle100(benchmark::Bench& bench) { BenchRandom_stdshuffle<1000>(bench, FastRandomContext(true)); }\n+\n+void InsecureRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_stdshuffle100(benchmark::Bench& bench) { BenchRandom_stdshuffle<1000>(bench, InsecureRandomContext(251438)); }",
      "path": "src/bench/random.cpp",
      "position": null,
      "original_position": 99,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "original_commit_id": "094798a9a53b3a9e89e8155c778fe14311e327df",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`251438` seems to be a fine hook for manhole covers. :)\r\nWorth documenting the choice of seed initialization value?",
      "created_at": "2024-07-05T19:13:06Z",
      "updated_at": "2024-07-05T19:27:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#discussion_r1667073020",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667073020"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
        }
      },
      "start_line": null,
      "original_start_line": 87,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 95,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667076256",
      "pull_request_review_id": 2161156126,
      "id": 1667076256,
      "node_id": "PRRC_kwDOABII585jXZCg",
      "diff_hunk": "@@ -5,21 +5,113 @@\n #include <bench/bench.h>\n #include <random.h>\n \n-static void FastRandom_32bit(benchmark::Bench& bench)\n+#include <cstdint>\n+#include <numeric>\n+\n+namespace {\n+\n+template<typename RNG>\n+void BenchRandom_rand64(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n+        rng.rand64();\n+    });\n+}\n+\n+template<typename RNG>\n+void BenchRandom_rand32(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.rand32();\n     });\n }\n \n-static void FastRandom_1bit(benchmark::Bench& bench)\n+template<typename RNG>\n+void BenchRandom_randbool(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.randbool();\n     });\n }\n \n-BENCHMARK(FastRandom_32bit, benchmark::PriorityLevel::HIGH);\n-BENCHMARK(FastRandom_1bit, benchmark::PriorityLevel::HIGH);\n+template<typename RNG>\n+void BenchRandom_randbits(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(64).unit(\"number\").run([&] {\n+        for (int i = 1; i <= 64; ++i) {\n+            rng.randbits(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_randrange(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        for (int i = 1; i <= RANGE; ++i) {\n+            rng.randrange(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_Shuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        Shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_stdshuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        std::shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+void FastRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, FastRandomContext(true)); }\n+void FastRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, FastRandomContext(true)); }\n+void FastRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, FastRandomContext(true)); }\n+void FastRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, FastRandomContext(true)); }\n+void FastRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, FastRandomContext(true)); }\n+void FastRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_stdshuffle100(benchmark::Bench& bench) { BenchRandom_stdshuffle<1000>(bench, FastRandomContext(true)); }\n+\n+void InsecureRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }",
      "path": "src/bench/random.cpp",
      "position": null,
      "original_position": 95,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "original_commit_id": "094798a9a53b3a9e89e8155c778fe14311e327df",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should template value be `<100>`?",
      "created_at": "2024-07-05T19:19:03Z",
      "updated_at": "2024-07-05T19:27:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#discussion_r1667076256",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667076256"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667077868",
      "pull_request_review_id": 2161156126,
      "id": 1667077868,
      "node_id": "PRRC_kwDOABII585jXZbs",
      "diff_hunk": "@@ -5,21 +5,113 @@\n #include <bench/bench.h>\n #include <random.h>\n \n-static void FastRandom_32bit(benchmark::Bench& bench)\n+#include <cstdint>\n+#include <numeric>\n+\n+namespace {\n+\n+template<typename RNG>\n+void BenchRandom_rand64(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n+        rng.rand64();\n+    });\n+}\n+\n+template<typename RNG>\n+void BenchRandom_rand32(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.rand32();\n     });\n }\n \n-static void FastRandom_1bit(benchmark::Bench& bench)\n+template<typename RNG>\n+void BenchRandom_randbool(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.randbool();\n     });\n }\n \n-BENCHMARK(FastRandom_32bit, benchmark::PriorityLevel::HIGH);\n-BENCHMARK(FastRandom_1bit, benchmark::PriorityLevel::HIGH);\n+template<typename RNG>\n+void BenchRandom_randbits(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(64).unit(\"number\").run([&] {\n+        for (int i = 1; i <= 64; ++i) {\n+            rng.randbits(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_randrange(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        for (int i = 1; i <= RANGE; ++i) {\n+            rng.randrange(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_Shuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        Shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_stdshuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        std::shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+void FastRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, FastRandomContext(true)); }\n+void FastRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, FastRandomContext(true)); }\n+void FastRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, FastRandomContext(true)); }\n+void FastRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, FastRandomContext(true)); }\n+void FastRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, FastRandomContext(true)); }\n+void FastRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_stdshuffle100(benchmark::Bench& bench) { BenchRandom_stdshuffle<1000>(bench, FastRandomContext(true)); }\n+\n+void InsecureRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, InsecureRandomContext(251438)); }",
      "path": "src/bench/random.cpp",
      "position": null,
      "original_position": 98,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "original_commit_id": "094798a9a53b3a9e89e8155c778fe14311e327df",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`InsecureRandom_Shuffle100` combined with `<1000>` here as well.",
      "created_at": "2024-07-05T19:21:54Z",
      "updated_at": "2024-07-05T19:27:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#discussion_r1667077868",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667077868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 94,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667109704",
      "pull_request_review_id": 2161229113,
      "id": 1667109704,
      "node_id": "PRRC_kwDOABII585jXhNI",
      "diff_hunk": "@@ -5,21 +5,113 @@\n #include <bench/bench.h>\n #include <random.h>\n \n-static void FastRandom_32bit(benchmark::Bench& bench)\n+#include <cstdint>\n+#include <numeric>\n+\n+namespace {\n+\n+template<typename RNG>\n+void BenchRandom_rand64(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n+        rng.rand64();\n+    });\n+}\n+\n+template<typename RNG>\n+void BenchRandom_rand32(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.rand32();\n     });\n }\n \n-static void FastRandom_1bit(benchmark::Bench& bench)\n+template<typename RNG>\n+void BenchRandom_randbool(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.randbool();\n     });\n }\n \n-BENCHMARK(FastRandom_32bit, benchmark::PriorityLevel::HIGH);\n-BENCHMARK(FastRandom_1bit, benchmark::PriorityLevel::HIGH);\n+template<typename RNG>\n+void BenchRandom_randbits(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(64).unit(\"number\").run([&] {\n+        for (int i = 1; i <= 64; ++i) {\n+            rng.randbits(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_randrange(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        for (int i = 1; i <= RANGE; ++i) {\n+            rng.randrange(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_Shuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        Shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_stdshuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        std::shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+void FastRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, FastRandomContext(true)); }\n+void FastRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, FastRandomContext(true)); }\n+void FastRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, FastRandomContext(true)); }\n+void FastRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, FastRandomContext(true)); }\n+void FastRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, FastRandomContext(true)); }\n+void FastRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_stdshuffle100(benchmark::Bench& bench) { BenchRandom_stdshuffle<1000>(bench, FastRandomContext(true)); }\n+\n+void InsecureRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_stdshuffle100(benchmark::Bench& bench) { BenchRandom_stdshuffle<1000>(bench, InsecureRandomContext(251438)); }",
      "path": "src/bench/random.cpp",
      "position": null,
      "original_position": 99,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "original_commit_id": "094798a9a53b3a9e89e8155c778fe14311e327df",
      "in_reply_to_id": 1667073020,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's the alphabetic position of the letters of \"bench\" (2-5-14-3-8) concatenated, but it's really just an arbitrary constant.",
      "created_at": "2024-07-05T20:22:40Z",
      "updated_at": "2024-07-05T20:22:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#discussion_r1667109704",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667109704"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
        }
      },
      "start_line": null,
      "original_start_line": 87,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 95,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667364813",
      "pull_request_review_id": 2161529328,
      "id": 1667364813,
      "node_id": "PRRC_kwDOABII585jYffN",
      "diff_hunk": "@@ -5,21 +5,113 @@\n #include <bench/bench.h>\n #include <random.h>\n \n-static void FastRandom_32bit(benchmark::Bench& bench)\n+#include <cstdint>\n+#include <numeric>\n+\n+namespace {\n+\n+template<typename RNG>\n+void BenchRandom_rand64(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n+        rng.rand64();\n+    });\n+}\n+\n+template<typename RNG>\n+void BenchRandom_rand32(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.rand32();\n     });\n }\n \n-static void FastRandom_1bit(benchmark::Bench& bench)\n+template<typename RNG>\n+void BenchRandom_randbool(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.randbool();\n     });\n }\n \n-BENCHMARK(FastRandom_32bit, benchmark::PriorityLevel::HIGH);\n-BENCHMARK(FastRandom_1bit, benchmark::PriorityLevel::HIGH);\n+template<typename RNG>\n+void BenchRandom_randbits(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(64).unit(\"number\").run([&] {\n+        for (int i = 1; i <= 64; ++i) {\n+            rng.randbits(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_randrange(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        for (int i = 1; i <= RANGE; ++i) {\n+            rng.randrange(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_Shuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        Shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_stdshuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        std::shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+void FastRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, FastRandomContext(true)); }\n+void FastRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, FastRandomContext(true)); }\n+void FastRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, FastRandomContext(true)); }\n+void FastRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, FastRandomContext(true)); }\n+void FastRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, FastRandomContext(true)); }\n+void FastRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_stdshuffle100(benchmark::Bench& bench) { BenchRandom_stdshuffle<1000>(bench, FastRandomContext(true)); }\n+\n+void InsecureRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }",
      "path": "src/bench/random.cpp",
      "position": null,
      "original_position": 95,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "original_commit_id": "094798a9a53b3a9e89e8155c778fe14311e327df",
      "in_reply_to_id": 1667076256,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-07-06T13:07:11Z",
      "updated_at": "2024-07-06T13:07:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#discussion_r1667364813",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667364813"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667364824",
      "pull_request_review_id": 2161529352,
      "id": 1667364824,
      "node_id": "PRRC_kwDOABII585jYffY",
      "diff_hunk": "@@ -5,21 +5,113 @@\n #include <bench/bench.h>\n #include <random.h>\n \n-static void FastRandom_32bit(benchmark::Bench& bench)\n+#include <cstdint>\n+#include <numeric>\n+\n+namespace {\n+\n+template<typename RNG>\n+void BenchRandom_rand64(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n+        rng.rand64();\n+    });\n+}\n+\n+template<typename RNG>\n+void BenchRandom_rand32(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.rand32();\n     });\n }\n \n-static void FastRandom_1bit(benchmark::Bench& bench)\n+template<typename RNG>\n+void BenchRandom_randbool(benchmark::Bench& bench, RNG&& rng) noexcept\n {\n-    FastRandomContext rng(true);\n-    bench.run([&] {\n+    bench.batch(1).unit(\"number\").run([&] {\n         rng.randbool();\n     });\n }\n \n-BENCHMARK(FastRandom_32bit, benchmark::PriorityLevel::HIGH);\n-BENCHMARK(FastRandom_1bit, benchmark::PriorityLevel::HIGH);\n+template<typename RNG>\n+void BenchRandom_randbits(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(64).unit(\"number\").run([&] {\n+        for (int i = 1; i <= 64; ++i) {\n+            rng.randbits(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_randrange(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        for (int i = 1; i <= RANGE; ++i) {\n+            rng.randrange(i);\n+        }\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_Shuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        Shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+template<int RANGE, typename RNG>\n+void BenchRandom_stdshuffle(benchmark::Bench& bench, RNG&& rng) noexcept\n+{\n+    uint64_t data[RANGE];\n+    std::iota(std::begin(data), std::end(data), uint64_t(0));\n+    bench.batch(RANGE).unit(\"number\").run([&] {\n+        std::shuffle(std::begin(data), std::end(data), rng);\n+    });\n+}\n+\n+void FastRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, FastRandomContext(true)); }\n+void FastRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, FastRandomContext(true)); }\n+void FastRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, FastRandomContext(true)); }\n+void FastRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, FastRandomContext(true)); }\n+void FastRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, FastRandomContext(true)); }\n+void FastRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, FastRandomContext(true)); }\n+void FastRandom_stdshuffle100(benchmark::Bench& bench) { BenchRandom_stdshuffle<1000>(bench, FastRandomContext(true)); }\n+\n+void InsecureRandom_rand64(benchmark::Bench& bench) { BenchRandom_rand64(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_rand32(benchmark::Bench& bench) { BenchRandom_rand32(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbool(benchmark::Bench& bench) { BenchRandom_randbool(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randbits(benchmark::Bench& bench) { BenchRandom_randbits(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange100(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange1000(benchmark::Bench& bench) { BenchRandom_randrange<1000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_randrange1000000(benchmark::Bench& bench) { BenchRandom_randrange<1000000>(bench, InsecureRandomContext(251438)); }\n+void InsecureRandom_Shuffle100(benchmark::Bench& bench) { BenchRandom_Shuffle<1000>(bench, InsecureRandomContext(251438)); }",
      "path": "src/bench/random.cpp",
      "position": null,
      "original_position": 98,
      "commit_id": "6ecda04fefad980872c72fba89844393f5581120",
      "original_commit_id": "094798a9a53b3a9e89e8155c778fe14311e327df",
      "in_reply_to_id": 1667077868,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, here and elsewhere.",
      "created_at": "2024-07-06T13:07:21Z",
      "updated_at": "2024-07-06T13:07:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30396#discussion_r1667364824",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1667364824"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30396"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 94,
      "side": "RIGHT"
    }
  ]
}