{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022",
    "id": 2104295782,
    "node_id": "PR_kwDOABII5859bQFm",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/31022",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/31022.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/31022.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31022",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31022/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/258b2856cdc6e2c054ea573cf57de7021aebc3c5",
    "number": 31022,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "test: Add mockable steady clock, tests for PCP and NATPMP implementations",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Add a NodeSteadyClock, a steady_clock that can be mocked with millisecond precision. Use this in the PCP implementation.\r\n\r\nThen add a mock for a simple scriptable UDP server,, which is used to test various code paths (including successful mappings, timeouts and errors) in the PCP and NATPMP implementations.\r\n\r\nIncludes \"net: Add optional length checking to CService::SetSockAddr\" from #31014 as a prerequisite.",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      },
      {
        "id": 241832923,
        "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
        "name": "Utils/log/libs",
        "description": "",
        "color": "5319e7",
        "default": false
      }
    ],
    "created_at": "2024-10-02T20:52:40Z",
    "updated_at": "2024-12-25T21:29:58Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "109e6ad41d1ff778d82281b70330ce2674ceb3a7",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "laanwj:2024-10-pcp-tests",
      "ref": "2024-10-pcp-tests",
      "sha": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1750308,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNzUwMzA4",
        "name": "bitcoin",
        "full_name": "laanwj/bitcoin",
        "owner": {
          "login": "laanwj",
          "id": 126646,
          "node_id": "MDQ6VXNlcjEyNjY0Ng==",
          "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/laanwj",
          "html_url": "https://github.com/laanwj",
          "followers_url": "https://api.github.com/users/laanwj/followers",
          "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
          "organizations_url": "https://api.github.com/users/laanwj/orgs",
          "repos_url": "https://api.github.com/users/laanwj/repos",
          "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/laanwj/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/laanwj/bitcoin",
        "description": "Laanwj's Bitcoin Core fork - see README.md on \"readme\" branch",
        "fork": true,
        "url": "https://api.github.com/repos/laanwj/bitcoin",
        "archive_url": "https://api.github.com/repos/laanwj/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/laanwj/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/laanwj/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/laanwj/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/laanwj/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/laanwj/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/laanwj/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/laanwj/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/laanwj/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/laanwj/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/laanwj/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/laanwj/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/laanwj/bitcoin/events",
        "forks_url": "https://api.github.com/repos/laanwj/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/laanwj/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/laanwj/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/laanwj/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/laanwj/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/laanwj/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/laanwj/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/laanwj/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/laanwj/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/laanwj/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/laanwj/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/laanwj/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/laanwj/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/laanwj/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/laanwj/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/laanwj/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:laanwj/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/laanwj/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/laanwj/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/laanwj/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/laanwj/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/laanwj/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/laanwj/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/laanwj/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/laanwj/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/laanwj/bitcoin/hooks",
        "svn_url": "https://github.com/laanwj/bitcoin",
        "homepage": "",
        "forks_count": 14,
        "stargazers_count": 44,
        "watchers_count": 44,
        "size": 244752,
        "default_branch": "readme",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-12-17T15:53:36Z",
        "created_at": "2011-05-15T07:09:54Z",
        "updated_at": "2024-10-04T16:35:48Z",
        "allow_forking": true
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "684873931b399af5bf34638141487923459d2713",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36411,
        "stargazers_count": 80824,
        "watchers_count": 80824,
        "size": 273659,
        "default_branch": "master",
        "open_issues_count": 695,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-12-20T15:19:08Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-12-25T21:40:42Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 638,
    "deletions": 15,
    "changed_files": 9,
    "commits": 4,
    "review_comments": 12,
    "comments": 2
  },
  "events": [
    {
      "event": "labeled",
      "id": 14495201987,
      "node_id": "LE_lADOABII586Yvn5VzwAAAANf-zrD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14495201987",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-02T20:52:40Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "labeled",
      "id": 14495201996,
      "node_id": "LE_lADOABII586Yvn5VzwAAAANf-zrM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14495201996",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-02T20:52:40Z",
      "label": {
        "name": "Utils/log/libs",
        "color": "5319e7"
      }
    },
    {
      "event": "commented",
      "id": 2389676933,
      "node_id": "IC_kwDOABII586Ob5OF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2389676933",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-02T20:52:43Z",
      "updated_at": "2024-12-23T16:53:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31022.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [sipa](https://github.com/bitcoin/bitcoin/pull/31022#pullrequestreview-2520898727) |\n| Concept ACK | [dergoegge](https://github.com/bitcoin/bitcoin/pull/31022#pullrequestreview-2345125043), [darosior](https://github.com/bitcoin/bitcoin/pull/31022#issuecomment-2464948588) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31549](https://github.com/bitcoin/bitcoin/pull/31549) (fuzz: Abort if system time is called without mock time being set by marcofleon)\n* [#31014](https://github.com/bitcoin/bitcoin/pull/31014) (net: Use GetAdaptersAddresses to get local addresses on Windows by laanwj)\n* [#30988](https://github.com/bitcoin/bitcoin/pull/30988) (Split CConnman by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#issuecomment-2389676933",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31022"
    },
    {
      "event": "renamed",
      "id": 14495203310,
      "node_id": "RTE_lADOABII586Yvn5VzwAAAANf-z_u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14495203310",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-02T20:52:45Z",
      "rename": {
        "from": "test: Add mockable steady clock, tests for PCP and NATPMP implementations ",
        "to": "test: Add mockable steady clock, tests for PCP and NATPMP implementations"
      }
    },
    {
      "event": "labeled",
      "id": 14496450056,
      "node_id": "LE_lADOABII586Yvn5VzwAAAANgDkYI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14496450056",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-02T23:11:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14499558275,
      "node_id": "HRFPE_lADOABII586Yvn5VzwAAAANgPbOD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14499558275",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "957348d2cebc6bd59bdca0a3d34a5ba12257e733",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/957348d2cebc6bd59bdca0a3d34a5ba12257e733",
      "created_at": "2024-10-03T06:55:27Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM5ZjdjMTQ2MjFmNzRkZjU1OTZhMzMzYjMyY2NmZTJkNmU5YTIxZGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39f7c14621f74df5596a333b32ccfe2d6e9a21db",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/39f7c14621f74df5596a333b32ccfe2d6e9a21db",
      "tree": {
        "sha": "140237e64096300a297d000ba94c428f8d71e4ba",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/140237e64096300a297d000ba94c428f8d71e4ba"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cfb59da4b3bb34afae467691a3e901f2b5a186f3",
          "sha": "cfb59da4b3bb34afae467691a3e901f2b5a186f3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cfb59da4b3bb34afae467691a3e901f2b5a186f3"
        }
      ],
      "message": "net: Add optional length checking to CService::SetSockAddr\n\nIn almost all cases (the only exception is `getifaddrs`), we know the\nsize of the data passed into SetSockAddr, so we can check this to be\nwhat is expected.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-10-03T07:00:53Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-10-01T14:28:28Z"
      },
      "sha": "39f7c14621f74df5596a333b32ccfe2d6e9a21db"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14499739271,
      "node_id": "HRFPE_lADOABII586Yvn5VzwAAAANgQHaH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14499739271",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "a2420fa9f51a0ebfade1b8759a2a2820d7a8781c",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/a2420fa9f51a0ebfade1b8759a2a2820d7a8781c",
      "created_at": "2024-10-03T07:12:24Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14499949899,
      "node_id": "HRFPE_lADOABII586Yvn5VzwAAAANgQ61L",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14499949899",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "41d276d4beca08f9cddbe2ccdb6707b711987bf9",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/41d276d4beca08f9cddbe2ccdb6707b711987bf9",
      "created_at": "2024-10-03T07:30:26Z"
    },
    {
      "event": "labeled",
      "id": 14499958776,
      "node_id": "LE_lADOABII586Yvn5VzwAAAANgQ8_4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14499958776",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T07:31:11Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14500105131,
      "node_id": "HRFPE_lADOABII586Yvn5VzwAAAANgRgur",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14500105131",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "created_at": "2024-10-03T07:43:34Z"
    },
    {
      "event": "comment_deleted",
      "id": 14500128342,
      "node_id": "CDE_lADOABII586Yvn5VzwAAAANgRmZW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14500128342",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T07:45:33Z"
    },
    {
      "event": "unlabeled",
      "id": 14500129692,
      "node_id": "UNLE_lADOABII586Yvn5VzwAAAANgRmuc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14500129692",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T07:45:40Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 14500998501,
      "node_id": "UNLE_lADOABII586Yvn5VzwAAAANgU61l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14500998501",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T08:54:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "comment_deleted",
      "id": 14501518975,
      "node_id": "CDE_lADOABII586Yvn5VzwAAAANgW55_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14501518975",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T09:34:08Z"
    },
    {
      "event": "reviewed",
      "id": 2345125043,
      "node_id": "PRR_kwDOABII586Lx8Sz",
      "url": null,
      "actor": null,
      "commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nLeft some comments on the approach for the steady mock time.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#pullrequestreview-2345125043",
      "submitted_at": "2024-10-03T09:55:01Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14517760848,
      "node_id": "HRFPE_lADOABII586Yvn5VzwAAAANhU3NQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14517760848",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "5016a0707000d56be57683507bc77661bdbf8037",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/5016a0707000d56be57683507bc77661bdbf8037",
      "created_at": "2024-10-04T11:27:01Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE1OWUyZWMyNzQ2NWQ4ZjJmZjRhMzg4MzUwNzlkNzkzMjNiNzkyM2M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/159e2ec27465d8f2ff4a38835079d79323b7923c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/159e2ec27465d8f2ff4a38835079d79323b7923c",
      "tree": {
        "sha": "b7c604b6265304240e84377d09502a74cd4ce3da",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b7c604b6265304240e84377d09502a74cd4ce3da"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39f7c14621f74df5596a333b32ccfe2d6e9a21db",
          "sha": "39f7c14621f74df5596a333b32ccfe2d6e9a21db",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/39f7c14621f74df5596a333b32ccfe2d6e9a21db"
        }
      ],
      "message": "util: Add mockable steady_clock\n\nThis adds a NodeSteadyClock, which is a steady_clock that can be mocked\nwith millisecond precision.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-10-04T14:49:01Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-10-02T20:24:58Z"
      },
      "sha": "159e2ec27465d8f2ff4a38835079d79323b7923c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIxZDZmNDVlYmJmY2U1NGE3NDQyMmM4ZmM5Yzc5NjRlOTA5N2E2ZDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/21d6f45ebbfce54a74422c8fc9c7964e9097a6d0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/21d6f45ebbfce54a74422c8fc9c7964e9097a6d0",
      "tree": {
        "sha": "c557db85565b592e5f9ef9c7a1daf69dfec9eddd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c557db85565b592e5f9ef9c7a1daf69dfec9eddd"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/159e2ec27465d8f2ff4a38835079d79323b7923c",
          "sha": "159e2ec27465d8f2ff4a38835079d79323b7923c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/159e2ec27465d8f2ff4a38835079d79323b7923c"
        }
      ],
      "message": "net: Use mockable steady clock in PCP implementation\n\nThis will be needed for the test harness.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-10-04T14:49:01Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-10-02T20:26:21Z"
      },
      "sha": "21d6f45ebbfce54a74422c8fc9c7964e9097a6d0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI1OGIyODU2Y2RjNmUyYzA1NGVhNTczY2Y1N2RlNzAyMWFlYmMzYzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "tree": {
        "sha": "09251e4837bb9aa38b593b6cbe1228ae7e39a6da",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/09251e4837bb9aa38b593b6cbe1228ae7e39a6da"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/21d6f45ebbfce54a74422c8fc9c7964e9097a6d0",
          "sha": "21d6f45ebbfce54a74422c8fc9c7964e9097a6d0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/21d6f45ebbfce54a74422c8fc9c7964e9097a6d0"
        }
      ],
      "message": "test: Add tests for PCP and NATPMP implementations\n\nAdd a mock for a simple scriptable UDP server, and use this to test\nvarious code paths (including successful mappings, timeouts and errors)\nin the PCP and NATPMP implementations.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-10-15T08:11:28Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-10-02T20:26:54Z"
      },
      "sha": "258b2856cdc6e2c054ea573cf57de7021aebc3c5"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14769674464,
      "node_id": "HRFPE_lADOABII586Yvn5VzwAAAANwV1jg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14769674464",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "created_at": "2024-10-21T18:41:48Z"
    },
    {
      "event": "commented",
      "id": 2464948588,
      "node_id": "IC_kwDOABII586S7CFs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2464948588",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-08T14:49:51Z",
      "updated_at": "2024-11-08T14:49:51Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#issuecomment-2464948588",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31022"
    },
    {
      "event": "reviewed",
      "id": 2520898727,
      "node_id": "PRR_kwDOABII586WQdyn",
      "url": null,
      "actor": null,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Neat, utACK 258b2856cdc6e2c054ea573cf57de7021aebc3c5. I did not verify the test scenario byte sequences against the spec. Just a few nits.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#pullrequestreview-2520898727",
      "submitted_at": "2024-12-23T16:53:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
    },
    {
      "event": "review_requested",
      "id": 15750110412,
      "node_id": "RRE_lADOABII586Yvn5VzwAAAAOqx5zM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15750110412",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-23T16:53:47Z",
      "requested_reviewer": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 15750110523,
      "node_id": "RRE_lADOABII586Yvn5VzwAAAAOqx507",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15750110523",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-23T16:53:48Z",
      "requested_reviewer": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785930990",
      "pull_request_review_id": 2345125043,
      "id": 1785930990,
      "node_id": "PRRC_kwDOABII585qcyTu",
      "diff_hunk": "@@ -22,6 +22,15 @@ struct NodeClock : public std::chrono::system_clock {\n };\n using NodeSeconds = std::chrono::time_point<NodeClock, std::chrono::seconds>;\n \n+/** Mockable steady clock in the context of tests, otherwise the system steady clock */\n+struct NodeSteadyClock : public std::chrono::steady_clock {",
      "path": "src/util/time.h",
      "position": null,
      "original_position": 5,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "in_reply_to_id": null,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Could we turn `SteadyClock` into this struct instead? Having both types could be confusing.",
      "created_at": "2024-10-03T09:40:27Z",
      "updated_at": "2024-10-03T09:55:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1785930990",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785930990"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785941780",
      "pull_request_review_id": 2345125043,
      "id": 1785941780,
      "node_id": "PRRC_kwDOABII585qc08U",
      "diff_hunk": "@@ -41,6 +42,22 @@ std::chrono::seconds GetMockTime()\n     return g_mock_time.load(std::memory_order_relaxed);\n }\n \n+NodeSteadyClock::time_point NodeSteadyClock::now() noexcept\n+{\n+    const auto mocktime{g_mock_steady_time.load(std::memory_order_relaxed)};\n+    const auto ret{\n+        mocktime.count() ?\n+            mocktime :\n+            std::chrono::steady_clock::now().time_since_epoch()};\n+    return time_point{ret};\n+};\n+\n+void SetMockSteadyTime(std::chrono::milliseconds mock_time_in)\n+{\n+    Assert(mock_time_in >= 0s);\n+    g_mock_steady_time.store(mock_time_in, std::memory_order_relaxed);",
      "path": "src/util/time.cpp",
      "position": 25,
      "original_position": 25,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "in_reply_to_id": null,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "My approach for this would have been to reuse `SetMockTime`, which would set `g_mock_time` to the requested mocktime and `g_mock_steady_time` to `max(mock_time_in, g_mock_steady_time)` (to ensure it only ever increases).\r\n\r\nThe benefit of that approach would be that all existing tests that make use of mock time would now also mock steady time (assuming `NodeSteadyClock` is used throughout). \r\n\r\nI never implemented and tested this but I was curious if you considered this as well?",
      "created_at": "2024-10-03T09:48:49Z",
      "updated_at": "2024-10-03T09:55:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1785941780",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785941780"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 58,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785957916",
      "pull_request_review_id": 2345168193,
      "id": 1785957916,
      "node_id": "PRRC_kwDOABII585qc44c",
      "diff_hunk": "@@ -22,6 +22,15 @@ struct NodeClock : public std::chrono::system_clock {\n };\n using NodeSeconds = std::chrono::time_point<NodeClock, std::chrono::seconds>;\n \n+/** Mockable steady clock in the context of tests, otherwise the system steady clock */\n+struct NodeSteadyClock : public std::chrono::steady_clock {",
      "path": "src/util/time.h",
      "position": null,
      "original_position": 5,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "in_reply_to_id": 1785930990,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "sure, fine with me, agree it's less confusing (`NodeSteadyClock` says nothing at all) though i wasn't sure which of the current usages should be mockable and didn't want to decide that here\r\n\r\nedit: i'll rename the structure to something clearer like `MockableSteadyClock` how about that?",
      "created_at": "2024-10-03T10:01:34Z",
      "updated_at": "2024-10-03T10:24:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1785957916",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785957916"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785962075",
      "pull_request_review_id": 2345175237,
      "id": 1785962075,
      "node_id": "PRRC_kwDOABII585qc55b",
      "diff_hunk": "@@ -41,6 +42,22 @@ std::chrono::seconds GetMockTime()\n     return g_mock_time.load(std::memory_order_relaxed);\n }\n \n+NodeSteadyClock::time_point NodeSteadyClock::now() noexcept\n+{\n+    const auto mocktime{g_mock_steady_time.load(std::memory_order_relaxed)};\n+    const auto ret{\n+        mocktime.count() ?\n+            mocktime :\n+            std::chrono::steady_clock::now().time_since_epoch()};\n+    return time_point{ret};\n+};\n+\n+void SetMockSteadyTime(std::chrono::milliseconds mock_time_in)\n+{\n+    Assert(mock_time_in >= 0s);\n+    g_mock_steady_time.store(mock_time_in, std::memory_order_relaxed);",
      "path": "src/util/time.cpp",
      "position": 25,
      "original_position": 25,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "in_reply_to_id": 1785941780,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "i don't know.\r\n\r\ni like being able to mock them seperately, and millisecond resolultion instead of second resolution is kind of nice here because it tends to be used for deadlines and timeouts, seconds are kind of clunky there.\r\n\r\nalso conceptually i think \"`max(mock_time_in, g_mock_steady_time)`\" is a wrong representation of how monotonic time works, it's basically a CPU cycle counter (from system startup, usually), it isn't linked to wall time or updates of that at all. \r\n\r\nThe reference point generally doesn't matter, only differences do; in my current tests i in fact reset it in every test case.",
      "created_at": "2024-10-03T10:04:46Z",
      "updated_at": "2024-10-03T10:12:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1785962075",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785962075"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 58,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1786428201",
      "pull_request_review_id": 2345944225,
      "id": 1786428201,
      "node_id": "PRRC_kwDOABII585qersp",
      "diff_hunk": "@@ -22,6 +22,15 @@ struct NodeClock : public std::chrono::system_clock {\n };\n using NodeSeconds = std::chrono::time_point<NodeClock, std::chrono::seconds>;\n \n+/** Mockable steady clock in the context of tests, otherwise the system steady clock */\n+struct NodeSteadyClock : public std::chrono::steady_clock {",
      "path": "src/util/time.h",
      "position": null,
      "original_position": 5,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "in_reply_to_id": 1785930990,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": ">  i wasn't sure which of the current usages should be mockable and didn't want to decide that here\r\n\r\nfair enough!\r\n\r\n`MockableSteadyClock` sgtm!",
      "created_at": "2024-10-03T15:22:51Z",
      "updated_at": "2024-10-03T15:22:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1786428201",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1786428201"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1786431421",
      "pull_request_review_id": 2345949547,
      "id": 1786431421,
      "node_id": "PRRC_kwDOABII585qese9",
      "diff_hunk": "@@ -41,6 +42,22 @@ std::chrono::seconds GetMockTime()\n     return g_mock_time.load(std::memory_order_relaxed);\n }\n \n+NodeSteadyClock::time_point NodeSteadyClock::now() noexcept\n+{\n+    const auto mocktime{g_mock_steady_time.load(std::memory_order_relaxed)};\n+    const auto ret{\n+        mocktime.count() ?\n+            mocktime :\n+            std::chrono::steady_clock::now().time_since_epoch()};\n+    return time_point{ret};\n+};\n+\n+void SetMockSteadyTime(std::chrono::milliseconds mock_time_in)\n+{\n+    Assert(mock_time_in >= 0s);\n+    g_mock_steady_time.store(mock_time_in, std::memory_order_relaxed);",
      "path": "src/util/time.cpp",
      "position": 25,
      "original_position": 25,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "in_reply_to_id": 1785941780,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> in my current tests i in fact reset it in every test case.\r\n\r\nRight, this wouldn't work with my approach as this is a global.",
      "created_at": "2024-10-03T15:25:06Z",
      "updated_at": "2024-10-03T15:25:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1786431421",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1786431421"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 58,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1787577470",
      "pull_request_review_id": 2347823354,
      "id": 1787577470,
      "node_id": "PRRC_kwDOABII585qjER-",
      "diff_hunk": "@@ -22,6 +22,15 @@ struct NodeClock : public std::chrono::system_clock {\n };\n using NodeSeconds = std::chrono::time_point<NodeClock, std::chrono::seconds>;\n \n+/** Mockable steady clock in the context of tests, otherwise the system steady clock */\n+struct NodeSteadyClock : public std::chrono::steady_clock {",
      "path": "src/util/time.h",
      "position": null,
      "original_position": 5,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "85a41cb90e2f7d4c90297b7198e7d08fd285354d",
      "in_reply_to_id": 1785930990,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Should be unambigious now, i've renamed it and the methods to set/clear the mock time are included on the clock itself.\r\n```c++\r\n/**\r\n * Version of SteadyClock that is mockable in the context of tests (set the\r\n * current value with SetMockTime), otherwise the system steady clock.\r\n */\r\nstruct MockableSteadyClock : public std::chrono::steady_clock {\r\n    using time_point = std::chrono::time_point<MockableSteadyClock>;\r\n    /** Return current system time or mocked time, if set */\r\n    static time_point now() noexcept;\r\n    static std::time_t to_time_t(const time_point&) = delete; // unused\r\n    static time_point from_time_t(std::time_t) = delete;      // unused\r\n\r\n    /** Set mock time for testing. */\r\n    static void SetMockTime(std::chrono::milliseconds mock_time_in);\r\n\r\n    /** Clear mock time, go back to system steady clock. */\r\n    static void ClearMockTime();\r\n};\r\n```",
      "created_at": "2024-10-04T11:29:05Z",
      "updated_at": "2024-10-04T14:16:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1787577470",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1787577470"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1895944792",
      "pull_request_review_id": 2520898727,
      "id": 1895944792,
      "node_id": "PRRC_kwDOABII585xAdJY",
      "diff_hunk": "@@ -0,0 +1,580 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <common/pcp.h>\n+#include <netbase.h>\n+#include <test/util/logging.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <deque>\n+\n+using namespace std::literals;\n+\n+/// UDP test server operation.\n+struct TestOp {\n+    std::chrono::milliseconds delay;\n+    enum Op {\n+        SEND, // Expect send (with optional data)\n+        RECV, // Expect receive (with data)\n+        NOP,  // Just delay\n+    } op;\n+    std::vector<uint8_t> data;\n+    int error;",
      "path": "src/test/pcp_tests.cpp",
      "position": 27,
      "original_position": 27,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Perhaps document that this represents the expected error.",
      "created_at": "2024-12-23T16:45:58Z",
      "updated_at": "2024-12-23T16:53:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1895944792",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1895944792"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 27,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1895945169",
      "pull_request_review_id": 2520898727,
      "id": 1895945169,
      "node_id": "PRRC_kwDOABII585xAdPR",
      "diff_hunk": "@@ -0,0 +1,580 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <common/pcp.h>\n+#include <netbase.h>\n+#include <test/util/logging.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <deque>\n+\n+using namespace std::literals;\n+\n+/// UDP test server operation.\n+struct TestOp {\n+    std::chrono::milliseconds delay;\n+    enum Op {\n+        SEND, // Expect send (with optional data)\n+        RECV, // Expect receive (with data)\n+        NOP,  // Just delay\n+    } op;\n+    std::vector<uint8_t> data;\n+    int error;\n+\n+    TestOp(std::chrono::milliseconds delay_in, Op op_in, const std::vector<uint8_t> &data_in, int error_in):\n+        delay(delay_in), op(op_in), data(data_in), error(error_in) {}\n+};\n+\n+/// Save the value of CreateSock and restore when the test ends.\n+class PCPTestingSetup : public BasicTestingSetup",
      "path": "src/test/pcp_tests.cpp",
      "position": 34,
      "original_position": 34,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Could be marked `final`.",
      "created_at": "2024-12-23T16:46:27Z",
      "updated_at": "2024-12-23T16:53:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1895945169",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1895945169"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 34,
      "original_line": 34,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1895945418",
      "pull_request_review_id": 2520898727,
      "id": 1895945418,
      "node_id": "PRRC_kwDOABII585xAdTK",
      "diff_hunk": "@@ -0,0 +1,580 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <common/pcp.h>\n+#include <netbase.h>\n+#include <test/util/logging.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <deque>\n+\n+using namespace std::literals;\n+\n+/// UDP test server operation.\n+struct TestOp {\n+    std::chrono::milliseconds delay;\n+    enum Op {\n+        SEND, // Expect send (with optional data)\n+        RECV, // Expect receive (with data)\n+        NOP,  // Just delay\n+    } op;\n+    std::vector<uint8_t> data;\n+    int error;\n+\n+    TestOp(std::chrono::milliseconds delay_in, Op op_in, const std::vector<uint8_t> &data_in, int error_in):\n+        delay(delay_in), op(op_in), data(data_in), error(error_in) {}\n+};\n+\n+/// Save the value of CreateSock and restore when the test ends.\n+class PCPTestingSetup : public BasicTestingSetup\n+{\n+public:\n+    explicit PCPTestingSetup(const ChainType chainType = ChainType::MAIN,\n+                             TestOpts opts = {})\n+        : BasicTestingSetup{chainType, opts},\n+          m_create_sock_orig{CreateSock}\n+    {\n+        const std::optional<CService> local_ipv4{Lookup(\"192.168.0.6\", 1, false)};\n+        const std::optional<CService> local_ipv6{Lookup(\"2a10:1234:5678:9abc:def0:1234:5678:9abc\", 1, false)};\n+        const std::optional<CService> gateway_ipv4{Lookup(\"192.168.0.1\", 1, false)};\n+        const std::optional<CService> gateway_ipv6{Lookup(\"2a10:1234:5678:9abc:def0:0000:0000:0000\", 1, false)};\n+        BOOST_REQUIRE(local_ipv4 && local_ipv6 && gateway_ipv4 && gateway_ipv6);\n+        default_local_ipv4 = *local_ipv4;\n+        default_local_ipv6 = *local_ipv6;\n+        default_gateway_ipv4 = *gateway_ipv4;\n+        default_gateway_ipv6 = *gateway_ipv6;\n+\n+        struct in_addr inaddr_any;\n+        inaddr_any.s_addr = htonl(INADDR_ANY);\n+        bind_any_ipv4 = CNetAddr(inaddr_any);\n+    }\n+\n+    ~PCPTestingSetup()\n+    {\n+        CreateSock = m_create_sock_orig;\n+        MockableSteadyClock::ClearMockTime();\n+    }\n+\n+    // Default testing nonce.\n+    static constexpr PCPMappingNonce TEST_NONCE{0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc};\n+    // Default network addresses.\n+    CNetAddr default_local_ipv4;\n+    CNetAddr default_local_ipv6;\n+    CNetAddr default_gateway_ipv4;\n+    CNetAddr default_gateway_ipv6;\n+    // IPv4 bind\n+    CNetAddr bind_any_ipv4;\n+private:\n+    const decltype(CreateSock) m_create_sock_orig;\n+};\n+\n+/** Simple scripted UDP server emulation for testing.\n+ */\n+class PCPTestSock : public Sock",
      "path": "src/test/pcp_tests.cpp",
      "position": 78,
      "original_position": 78,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Could be marked `final`.",
      "created_at": "2024-12-23T16:46:47Z",
      "updated_at": "2024-12-23T16:53:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1895945418",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1895945418"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 78,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1895947529",
      "pull_request_review_id": 2520898727,
      "id": 1895947529,
      "node_id": "PRRC_kwDOABII585xAd0J",
      "diff_hunk": "@@ -0,0 +1,580 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <common/pcp.h>\n+#include <netbase.h>\n+#include <test/util/logging.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <deque>\n+\n+using namespace std::literals;\n+\n+/// UDP test server operation.\n+struct TestOp {\n+    std::chrono::milliseconds delay;\n+    enum Op {\n+        SEND, // Expect send (with optional data)\n+        RECV, // Expect receive (with data)\n+        NOP,  // Just delay\n+    } op;\n+    std::vector<uint8_t> data;\n+    int error;\n+\n+    TestOp(std::chrono::milliseconds delay_in, Op op_in, const std::vector<uint8_t> &data_in, int error_in):\n+        delay(delay_in), op(op_in), data(data_in), error(error_in) {}\n+};\n+\n+/// Save the value of CreateSock and restore when the test ends.\n+class PCPTestingSetup : public BasicTestingSetup\n+{\n+public:\n+    explicit PCPTestingSetup(const ChainType chainType = ChainType::MAIN,\n+                             TestOpts opts = {})\n+        : BasicTestingSetup{chainType, opts},\n+          m_create_sock_orig{CreateSock}\n+    {\n+        const std::optional<CService> local_ipv4{Lookup(\"192.168.0.6\", 1, false)};\n+        const std::optional<CService> local_ipv6{Lookup(\"2a10:1234:5678:9abc:def0:1234:5678:9abc\", 1, false)};\n+        const std::optional<CService> gateway_ipv4{Lookup(\"192.168.0.1\", 1, false)};\n+        const std::optional<CService> gateway_ipv6{Lookup(\"2a10:1234:5678:9abc:def0:0000:0000:0000\", 1, false)};\n+        BOOST_REQUIRE(local_ipv4 && local_ipv6 && gateway_ipv4 && gateway_ipv6);\n+        default_local_ipv4 = *local_ipv4;\n+        default_local_ipv6 = *local_ipv6;\n+        default_gateway_ipv4 = *gateway_ipv4;\n+        default_gateway_ipv6 = *gateway_ipv6;\n+\n+        struct in_addr inaddr_any;\n+        inaddr_any.s_addr = htonl(INADDR_ANY);\n+        bind_any_ipv4 = CNetAddr(inaddr_any);\n+    }\n+\n+    ~PCPTestingSetup()\n+    {\n+        CreateSock = m_create_sock_orig;\n+        MockableSteadyClock::ClearMockTime();\n+    }\n+\n+    // Default testing nonce.\n+    static constexpr PCPMappingNonce TEST_NONCE{0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc};\n+    // Default network addresses.\n+    CNetAddr default_local_ipv4;\n+    CNetAddr default_local_ipv6;\n+    CNetAddr default_gateway_ipv4;\n+    CNetAddr default_gateway_ipv6;\n+    // IPv4 bind\n+    CNetAddr bind_any_ipv4;\n+private:\n+    const decltype(CreateSock) m_create_sock_orig;\n+};\n+\n+/** Simple scripted UDP server emulation for testing.\n+ */\n+class PCPTestSock : public Sock\n+{\n+public:\n+    // Note: we awkwardly mark all methods as const, and properties as mutable,\n+    // because Sock expects all networking calls to be const.\n+    explicit PCPTestSock(const CNetAddr &local_ip, const CNetAddr &gateway_ip, const std::vector<TestOp> &script)\n+        : Sock{INVALID_SOCKET},\n+          m_script(script),\n+          m_local_ip(local_ip),\n+          m_gateway_ip(gateway_ip)\n+    {\n+        ElapseTime(std::chrono::seconds(0)); // start mocking steady time\n+        PrepareOp();\n+    }\n+\n+    ~PCPTestSock() override { m_socket = INVALID_SOCKET; }\n+\n+    PCPTestSock& operator=(Sock&& other) override\n+    {\n+        assert(false && \"Move of Sock into MockSock not allowed.\");\n+        return *this;\n+    }\n+\n+    ssize_t Send(const void* data, size_t len, int) const override {\n+        if (!m_connected) return -1;\n+        Span in_pkt = Span(static_cast<const uint8_t*>(data), len);\n+        if (AtEndOfScript() || CurOp().op != TestOp::SEND) {\n+            // Ignore sends after end of script, or sends when we expect a receive.\n+            FailScript();\n+            return len;\n+        }\n+        if (CurOp().error) return -1; // Inject failure\n+        if (CurOp().data.empty() || std::ranges::equal(CurOp().data, in_pkt)) {\n+            AdvanceOp();\n+        } else {\n+            // Wrong send, fail script\n+            FailScript();\n+        }\n+        return len;\n+    }\n+\n+    ssize_t Recv(void* buf, size_t len, int flags) const override\n+    {\n+        if (!m_connected || AtEndOfScript() || CurOp().op != TestOp::RECV || m_time_left != 0s) {\n+            return -1;\n+        }\n+        if (CurOp().error) return -1; // Inject failure\n+        const auto &recv_pkt = CurOp().data;\n+        const size_t consume_bytes{std::min(len, recv_pkt.size())};\n+        std::memcpy(buf, recv_pkt.data(), consume_bytes);\n+        if ((flags & MSG_PEEK) == 0) {\n+            AdvanceOp();\n+        }\n+        return consume_bytes;\n+    }\n+\n+    int Connect(const sockaddr* sa, socklen_t sa_len) const override {\n+        CService service;\n+        if (service.SetSockAddr(sa, sa_len) && service == CService(m_gateway_ip, 5351)) {\n+            if (m_bound.IsBindAny()) { // If bind-any, bind to local ip.\n+                m_bound = CService(m_local_ip, 0);\n+            }\n+            if (m_bound.GetPort() == 0) { // If no port assigned, assign port 1.\n+                m_bound = CService(m_bound, 1);\n+            }\n+            m_connected = true;\n+            return 0;\n+        }\n+        return -1;\n+    }\n+\n+    int Bind(const sockaddr* sa, socklen_t sa_len) const override {\n+        CService service;\n+        if (service.SetSockAddr(sa, sa_len)) {\n+            // Can only bind to one of our local ips\n+            if (!service.IsBindAny() && service != m_local_ip) {\n+                return -1;\n+            }\n+            m_bound = service;\n+        }\n+        return 0;\n+    }\n+\n+    int Listen(int) const override { return -1; }\n+\n+    std::unique_ptr<Sock> Accept(sockaddr* addr, socklen_t* addr_len) const override\n+    {\n+        return nullptr;\n+    };\n+\n+    int GetSockOpt(int level, int opt_name, void* opt_val, socklen_t* opt_len) const override\n+    {\n+        std::memset(opt_val, 0x0, *opt_len);\n+        return 0;\n+    }\n+\n+    int SetSockOpt(int, int, const void*, socklen_t) const override { return 0; }\n+\n+    int GetSockName(sockaddr* name, socklen_t* name_len) const override\n+    {\n+        // Return the address we've been bound to.\n+        return m_bound.GetSockAddr(name, name_len) ? 0 : -1;\n+    }\n+\n+    bool SetNonBlocking() const override { return true; }\n+\n+    bool IsSelectable() const override { return true; }\n+\n+    bool Wait(std::chrono::milliseconds timeout,\n+              Event requested,\n+              Event* occurred = nullptr) const override\n+    {\n+        // Only handles receive events.\n+        if (AtEndOfScript() || requested != Sock::RECV) {\n+            ElapseTime(timeout);\n+        } else {\n+            std::chrono::milliseconds delay = std::min(m_time_left, timeout);\n+            ElapseTime(delay);\n+            m_time_left -= delay;\n+            if (CurOp().op == TestOp::RECV && m_time_left == 0s && occurred != nullptr) {\n+                *occurred = Sock::RECV;\n+            }\n+            if (CurOp().op == TestOp::NOP) {\n+                // This was a pure delay operation, move to the next op.\n+                AdvanceOp();\n+            }\n+        }\n+        return true;\n+    }\n+\n+    bool WaitMany(std::chrono::milliseconds timeout, EventsPerSock& events_per_sock) const override\n+    {\n+        return false;\n+    }\n+\n+    bool IsConnected(std::string&) const override\n+    {\n+        return true;\n+    }\n+\n+private:\n+    const std::vector<TestOp> m_script;\n+    mutable size_t m_script_ptr = 0;\n+    mutable std::chrono::milliseconds m_time_left;\n+    mutable std::chrono::milliseconds m_time{1000};",
      "path": "src/test/pcp_tests.cpp",
      "position": 222,
      "original_position": 222,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Perhaps document that this must start at nonzero, otherwise `MockableSteadyClock::SetMockTime(m_time)` would disable mocking.",
      "created_at": "2024-12-23T16:49:11Z",
      "updated_at": "2024-12-23T16:53:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1895947529",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1895947529"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 222,
      "original_line": 222,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1897481126",
      "pull_request_review_id": 2522662948,
      "id": 1897481126,
      "node_id": "PRRC_kwDOABII585xGUOm",
      "diff_hunk": "@@ -0,0 +1,580 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <common/pcp.h>\n+#include <netbase.h>\n+#include <test/util/logging.h>\n+#include <test/util/setup_common.h>\n+#include <util/time.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <deque>\n+\n+using namespace std::literals;\n+\n+/// UDP test server operation.\n+struct TestOp {\n+    std::chrono::milliseconds delay;\n+    enum Op {\n+        SEND, // Expect send (with optional data)\n+        RECV, // Expect receive (with data)\n+        NOP,  // Just delay\n+    } op;\n+    std::vector<uint8_t> data;\n+    int error;\n+\n+    TestOp(std::chrono::milliseconds delay_in, Op op_in, const std::vector<uint8_t> &data_in, int error_in):\n+        delay(delay_in), op(op_in), data(data_in), error(error_in) {}\n+};\n+\n+/// Save the value of CreateSock and restore when the test ends.\n+class PCPTestingSetup : public BasicTestingSetup\n+{\n+public:\n+    explicit PCPTestingSetup(const ChainType chainType = ChainType::MAIN,\n+                             TestOpts opts = {})\n+        : BasicTestingSetup{chainType, opts},\n+          m_create_sock_orig{CreateSock}\n+    {\n+        const std::optional<CService> local_ipv4{Lookup(\"192.168.0.6\", 1, false)};\n+        const std::optional<CService> local_ipv6{Lookup(\"2a10:1234:5678:9abc:def0:1234:5678:9abc\", 1, false)};\n+        const std::optional<CService> gateway_ipv4{Lookup(\"192.168.0.1\", 1, false)};\n+        const std::optional<CService> gateway_ipv6{Lookup(\"2a10:1234:5678:9abc:def0:0000:0000:0000\", 1, false)};\n+        BOOST_REQUIRE(local_ipv4 && local_ipv6 && gateway_ipv4 && gateway_ipv6);\n+        default_local_ipv4 = *local_ipv4;\n+        default_local_ipv6 = *local_ipv6;\n+        default_gateway_ipv4 = *gateway_ipv4;\n+        default_gateway_ipv6 = *gateway_ipv6;\n+\n+        struct in_addr inaddr_any;\n+        inaddr_any.s_addr = htonl(INADDR_ANY);\n+        bind_any_ipv4 = CNetAddr(inaddr_any);\n+    }\n+\n+    ~PCPTestingSetup()\n+    {\n+        CreateSock = m_create_sock_orig;\n+        MockableSteadyClock::ClearMockTime();\n+    }\n+\n+    // Default testing nonce.\n+    static constexpr PCPMappingNonce TEST_NONCE{0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc};\n+    // Default network addresses.\n+    CNetAddr default_local_ipv4;\n+    CNetAddr default_local_ipv6;\n+    CNetAddr default_gateway_ipv4;\n+    CNetAddr default_gateway_ipv6;\n+    // IPv4 bind\n+    CNetAddr bind_any_ipv4;\n+private:\n+    const decltype(CreateSock) m_create_sock_orig;\n+};\n+\n+/** Simple scripted UDP server emulation for testing.\n+ */\n+class PCPTestSock : public Sock\n+{\n+public:\n+    // Note: we awkwardly mark all methods as const, and properties as mutable,\n+    // because Sock expects all networking calls to be const.\n+    explicit PCPTestSock(const CNetAddr &local_ip, const CNetAddr &gateway_ip, const std::vector<TestOp> &script)\n+        : Sock{INVALID_SOCKET},\n+          m_script(script),\n+          m_local_ip(local_ip),\n+          m_gateway_ip(gateway_ip)\n+    {\n+        ElapseTime(std::chrono::seconds(0)); // start mocking steady time\n+        PrepareOp();\n+    }\n+\n+    ~PCPTestSock() override { m_socket = INVALID_SOCKET; }\n+\n+    PCPTestSock& operator=(Sock&& other) override\n+    {\n+        assert(false && \"Move of Sock into MockSock not allowed.\");\n+        return *this;\n+    }\n+\n+    ssize_t Send(const void* data, size_t len, int) const override {\n+        if (!m_connected) return -1;\n+        Span in_pkt = Span(static_cast<const uint8_t*>(data), len);\n+        if (AtEndOfScript() || CurOp().op != TestOp::SEND) {\n+            // Ignore sends after end of script, or sends when we expect a receive.\n+            FailScript();\n+            return len;\n+        }\n+        if (CurOp().error) return -1; // Inject failure\n+        if (CurOp().data.empty() || std::ranges::equal(CurOp().data, in_pkt)) {\n+            AdvanceOp();\n+        } else {\n+            // Wrong send, fail script\n+            FailScript();\n+        }\n+        return len;\n+    }\n+\n+    ssize_t Recv(void* buf, size_t len, int flags) const override\n+    {\n+        if (!m_connected || AtEndOfScript() || CurOp().op != TestOp::RECV || m_time_left != 0s) {\n+            return -1;\n+        }\n+        if (CurOp().error) return -1; // Inject failure\n+        const auto &recv_pkt = CurOp().data;\n+        const size_t consume_bytes{std::min(len, recv_pkt.size())};\n+        std::memcpy(buf, recv_pkt.data(), consume_bytes);\n+        if ((flags & MSG_PEEK) == 0) {\n+            AdvanceOp();\n+        }\n+        return consume_bytes;\n+    }\n+\n+    int Connect(const sockaddr* sa, socklen_t sa_len) const override {\n+        CService service;\n+        if (service.SetSockAddr(sa, sa_len) && service == CService(m_gateway_ip, 5351)) {\n+            if (m_bound.IsBindAny()) { // If bind-any, bind to local ip.\n+                m_bound = CService(m_local_ip, 0);\n+            }\n+            if (m_bound.GetPort() == 0) { // If no port assigned, assign port 1.\n+                m_bound = CService(m_bound, 1);\n+            }\n+            m_connected = true;\n+            return 0;\n+        }\n+        return -1;\n+    }\n+\n+    int Bind(const sockaddr* sa, socklen_t sa_len) const override {\n+        CService service;\n+        if (service.SetSockAddr(sa, sa_len)) {\n+            // Can only bind to one of our local ips\n+            if (!service.IsBindAny() && service != m_local_ip) {\n+                return -1;\n+            }\n+            m_bound = service;\n+        }\n+        return 0;\n+    }\n+\n+    int Listen(int) const override { return -1; }\n+\n+    std::unique_ptr<Sock> Accept(sockaddr* addr, socklen_t* addr_len) const override\n+    {\n+        return nullptr;\n+    };\n+\n+    int GetSockOpt(int level, int opt_name, void* opt_val, socklen_t* opt_len) const override\n+    {\n+        std::memset(opt_val, 0x0, *opt_len);\n+        return 0;\n+    }\n+\n+    int SetSockOpt(int, int, const void*, socklen_t) const override { return 0; }\n+\n+    int GetSockName(sockaddr* name, socklen_t* name_len) const override\n+    {\n+        // Return the address we've been bound to.\n+        return m_bound.GetSockAddr(name, name_len) ? 0 : -1;\n+    }\n+\n+    bool SetNonBlocking() const override { return true; }\n+\n+    bool IsSelectable() const override { return true; }\n+\n+    bool Wait(std::chrono::milliseconds timeout,\n+              Event requested,\n+              Event* occurred = nullptr) const override\n+    {\n+        // Only handles receive events.\n+        if (AtEndOfScript() || requested != Sock::RECV) {\n+            ElapseTime(timeout);\n+        } else {\n+            std::chrono::milliseconds delay = std::min(m_time_left, timeout);\n+            ElapseTime(delay);\n+            m_time_left -= delay;\n+            if (CurOp().op == TestOp::RECV && m_time_left == 0s && occurred != nullptr) {\n+                *occurred = Sock::RECV;\n+            }\n+            if (CurOp().op == TestOp::NOP) {\n+                // This was a pure delay operation, move to the next op.\n+                AdvanceOp();\n+            }\n+        }\n+        return true;\n+    }\n+\n+    bool WaitMany(std::chrono::milliseconds timeout, EventsPerSock& events_per_sock) const override\n+    {\n+        return false;\n+    }\n+\n+    bool IsConnected(std::string&) const override\n+    {\n+        return true;\n+    }\n+\n+private:\n+    const std::vector<TestOp> m_script;\n+    mutable size_t m_script_ptr = 0;\n+    mutable std::chrono::milliseconds m_time_left;\n+    mutable std::chrono::milliseconds m_time{1000};",
      "path": "src/test/pcp_tests.cpp",
      "position": 222,
      "original_position": 222,
      "commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "original_commit_id": "258b2856cdc6e2c054ea573cf57de7021aebc3c5",
      "in_reply_to_id": 1895947529,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Correct. Thinking of it, we could define a constant for this in the MockableClock like `INITIAL_MOCK_TIME`. This would document it while at the same time as preventing that mistake being made in future tests that use the mockable steady clock.\r\n\r\nThe alternative was to make the mock time in MockableClock an optional, but this would mean it could no longer simply be an atomic value, so was kind of a hassle compared to starting at non-zero.",
      "created_at": "2024-12-25T21:29:58Z",
      "updated_at": "2024-12-25T21:30:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31022#discussion_r1897481126",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1897481126"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31022"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 222,
      "original_line": 222,
      "side": "RIGHT"
    }
  ]
}