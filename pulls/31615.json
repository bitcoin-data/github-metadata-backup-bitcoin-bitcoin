{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615",
    "id": 2263728332,
    "node_id": "PR_kwDOABII586G7cDM",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/31615",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/31615.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/31615.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
    "number": 31615,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "validation: ensure assumevalid is always used during reindex",
    "user": {
      "login": "Eunovo",
      "id": 37949128,
      "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Eunovo",
      "html_url": "https://github.com/Eunovo",
      "followers_url": "https://api.github.com/users/Eunovo/followers",
      "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
      "organizations_url": "https://api.github.com/users/Eunovo/orgs",
      "repos_url": "https://api.github.com/users/Eunovo/repos",
      "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Eunovo/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "assumevalid may be ignored during reindex for the following reasons:\r\n- the assumevalid block is not in the block index:  this happens when the assumevalid block could not be downloaded before the previous IBD run was interrupted\r\n-  the chainwork of the best header is less than the minimumchainwork: happens if the previous IBD was interrupted before it could connect blocks up to minimumchainwork. See Issue https://github.com/bitcoin/bitcoin/issues/31494\r\n\r\nThis PR fixes this by skipping script verification during reindex if assumevalid is enabled. \r\n\r\nEDIT: While the minimumchainwork is typically set to match the assumevalid block height, users typically adjust the assumevalid block without also adjusting the minimumchainwork; Scenario 2 from the list can occur if the assumevalid block is set to an older block without also reducing the minimumchainwork.",
    "labels": [
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      }
    ],
    "created_at": "2025-01-07T11:52:23Z",
    "updated_at": "2025-11-24T11:23:56Z",
    "closed_at": "2025-11-11T14:23:17Z",
    "mergeable_state": "unknown",
    "merged": false,
    "merge_commit_sha": "6d3ed0c7392de4ea7ce3b9b5c02d45ad56732f49",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "Eunovo:31494-reindex-assumevalid",
      "ref": "31494-reindex-assumevalid",
      "sha": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 755831492,
        "node_id": "R_kgDOLQ0SxA",
        "name": "bitcoin",
        "full_name": "Eunovo/bitcoin",
        "owner": {
          "login": "Eunovo",
          "id": 37949128,
          "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
          "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/Eunovo",
          "html_url": "https://github.com/Eunovo",
          "followers_url": "https://api.github.com/users/Eunovo/followers",
          "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
          "organizations_url": "https://api.github.com/users/Eunovo/orgs",
          "repos_url": "https://api.github.com/users/Eunovo/repos",
          "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/Eunovo/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/Eunovo/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/Eunovo/bitcoin",
        "archive_url": "https://api.github.com/repos/Eunovo/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/Eunovo/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/Eunovo/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/Eunovo/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/Eunovo/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/Eunovo/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/Eunovo/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/Eunovo/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/Eunovo/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/Eunovo/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/Eunovo/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/Eunovo/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/Eunovo/bitcoin/events",
        "forks_url": "https://api.github.com/repos/Eunovo/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/Eunovo/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/Eunovo/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/Eunovo/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/Eunovo/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/Eunovo/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/Eunovo/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/Eunovo/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/Eunovo/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/Eunovo/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/Eunovo/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/Eunovo/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/Eunovo/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/Eunovo/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/Eunovo/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/Eunovo/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:Eunovo/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/Eunovo/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/Eunovo/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/Eunovo/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/Eunovo/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/Eunovo/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/Eunovo/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/Eunovo/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/Eunovo/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/Eunovo/bitcoin/hooks",
        "svn_url": "https://github.com/Eunovo/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "forks_count": 1,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 256273,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-21T16:18:09Z",
        "created_at": "2024-02-11T07:44:19Z",
        "updated_at": "2025-05-02T08:08:35Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "9bd9ec00b2380367d81399f4825352f66dde8a14",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38251,
        "stargazers_count": 86979,
        "watchers_count": 86979,
        "size": 296256,
        "default_branch": "master",
        "open_issues_count": 736,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-24T15:24:04Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-11-25T01:53:34Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 150,
    "deletions": 17,
    "changed_files": 5,
    "commits": 2,
    "review_comments": 60,
    "comments": 23
  },
  "events": [
    {
      "event": "commented",
      "id": 2575096378,
      "node_id": "IC_kwDOABII586ZfNo6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2575096378",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-07T11:52:27Z",
      "updated_at": "2025-11-05T11:14:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31615.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3403430467) |\n| Concept ACK | [mzumsande](https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-2668456532), [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3397101094) |\n| Stale ACK | [stratospher](https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3043958524), [l0rinc](https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3044142789) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-2575096378",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "reviewed",
      "id": 2534670554,
      "node_id": "PRR_kwDOABII586XFADa",
      "url": null,
      "actor": null,
      "commit_id": "57bd31eac470eef41e819e7ad4957629734ce414",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-01-07T16:13:32Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-2534670554",
      "submitted_at": "2025-01-07T16:13:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "commented",
      "id": 2599687406,
      "node_id": "IC_kwDOABII586a9BTu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2599687406",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-18T11:56:57Z",
      "updated_at": "2025-01-18T11:56:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "I had an offline conversation with @mzumsande. During the reindex, we can apply assumevalid for following cases:\r\n- If the assumevalid block is the index, then we can skip script checks for all ancestors of the assumevalid block\r\n- If the assumevalid block is not in the index, then the initial IBD run had not downloaded the assumevalid block yet then the blocks on disk are ancestors of the assumevalid block and we can still skip script verification\r\n\r\nThen we download headers from peers in parallel to ActivateBestChain()\r\n\r\nI'll put this in draft while I implement and test this over  the next few days",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-2599687406",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "mentioned",
      "id": 15985688473,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAAO40j-Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15985688473",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-18T11:56:58Z"
    },
    {
      "event": "subscribed",
      "id": 15985688475,
      "node_id": "SE_lADOABII586lQ1oXzwAAAAO40j-b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15985688475",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-18T11:56:58Z"
    },
    {
      "event": "convert_to_draft",
      "id": 15985688601,
      "node_id": "CTDE_lADOABII586lQ1oXzwAAAAO40kAZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15985688601",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-18T11:57:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16110088151,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAAPAPG_X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16110088151",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "89ca265501d3a7dfd0e15bfe02a6a5a94d562670",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/89ca265501d3a7dfd0e15bfe02a6a5a94d562670",
      "created_at": "2025-01-29T15:37:25Z"
    },
    {
      "event": "labeled",
      "id": 16111050577,
      "node_id": "LE_lADOABII586lQ1oXzwAAAAPASx9R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16111050577",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-29T16:42:58Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16111852039,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAAPAV1oH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16111852039",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "fda93dfae214f9f93283827f8fddacc0df1d4337",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/fda93dfae214f9f93283827f8fddacc0df1d4337",
      "created_at": "2025-01-29T17:43:05Z"
    },
    {
      "event": "unlabeled",
      "id": 16112677077,
      "node_id": "UNLE_lADOABII586lQ1oXzwAAAAPAY_DV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16112677077",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-29T18:55:49Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2624782947,
      "node_id": "IC_kwDOABII586ccwJj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2624782947",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-30T15:17:25Z",
      "updated_at": "2025-11-24T11:23:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "I'm not sure whether `LoadingBlocks` is the correct way to solve it or not (I would need someone else to opine on that, I can't tell if this can err on the side of not checking the scripts at all for some edge case).\r\n\r\nI can confirm however that this does seem to solve the issue I had, reported in https://github.com/bitcoin/bitcoin/issues/31494 (i.e. reindex(-chainstate) after a partial IBD always enabling script verification).\r\n\r\n-----\r\n\r\nTo test it, I have added a `LogWarning(\"fScriptChecks is %s\", fScriptChecks);` after the assignments and ran it with master vs the branch:\r\n```bash\r\n   cmake -B build -DCMAKE_BUILD_TYPE=Debug >/dev/null 2>&1 && cmake --build build -j$(nproc) >/dev/null 2>&1\\\r\n&& mkdir -p demo && build/bin/bitcoind -datadir=demo -stopatheight=1000 >/dev/null && build/bin/bitcoind -datadir=demo -reindex -stopatheight=100 >/dev/null \\\r\n&& build/bin/bitcoind -datadir=demo -reindex-chainstate -stopatheight=10 | grep \"script verification\"\r\n```\r\n\r\n> master\r\n```bash\r\n[warning] fScriptChecks is true\r\n```\r\n\r\n> Eunovo:31494-reindex-assumevalid\r\n```bash\r\n[warning] fScriptChecks is false\r\n```\r\n\r\n----\r\n\r\nI can also confirm that adding `-assumevalid=0` will enable script checking from the beginning and that `-assumevalid=000000009b7262315dbf071787ad3656097b892abffd1f95a1a022f896f533fc` has 5 fScriptChecks=false values after which script checking is (correctly) enabled again.\r\n\r\n---\r\n\r\nI also checked that the new `assume_valid` test passes here and fails correctly on master (though it's *very* slow, we have to check if there's a way to speed it up somewhat)\r\n\r\n<details>\r\n<summary>Details</summary>\r\n\r\n```bash\r\n2025-01-30T15:08:22.897000Z TestFramework (INFO): Success\r\n2025-01-30T15:08:31.343000Z TestFramework (INFO): Restarting node while reindexing..\r\n2025-01-30T15:08:32.551000Z TestFramework (INFO): Testing reindex with -assumevalid\r\n2025-01-30T15:09:23.963000Z TestFramework (INFO): Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\r\n2025-01-30T15:09:52.592000Z TestFramework (ERROR): Assertion failed\r\nTraceback (most recent call last):\r\n  File \"/Users/lorinc/IdeaProjects/bitcoin/test/functional/test_framework/test_framework.py\", line 135, in main\r\n    self.run_test()\r\n    ~~~~~~~~~~~~~^^\r\n  File \"/Users/lorinc/IdeaProjects/bitcoin/build/test/functional/feature_reindex.py\", line 203, in run_test\r\n    self.assume_valid()\r\n    ~~~~~~~~~~~~~~~~~^^\r\n```\r\n\r\n</details>\r\n\r\n----\r\n\r\nSo from me it's an approach ACK, but someone else needs to validate the implementation details and the corner cases that can result from this.\r\n",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-2624782947",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "commented",
      "id": 2624877742,
      "node_id": "IC_kwDOABII586cdHSu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2624877742",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-30T15:51:52Z",
      "updated_at": "2025-01-30T15:51:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I'm not sure whether `LoadingBlocks` is the correct way to solve it or not (I would need someone else to opine on that, I can't tell if this can err on the side of not checking the scripts at all for some edge case).\r\n\r\nI agree too. `LoadingBlocks()` is `true` when blocks are being reindexed or  when new blocks are being loaded with `-loadblocks` .  I intend to move away from `LoadingBlocks()` to something that's only true when blockfiles are being reindexed.\r\n\r\n> I also checked that the new `assume_valid` test passes here and fails correctly on master (though it's _very_ slow, we have to check if there's a way to speed it up somewhat)\r\n\r\nI'll look into this!",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-2624877742",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "unsubscribed",
      "id": 16129566785,
      "node_id": "UE_lADOABII586lQ1oXzwAAAAPBZahB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16129566785",
      "actor": {
        "login": "PRADACANDI18",
        "id": 91190628,
        "node_id": "MDQ6VXNlcjkxMTkwNjI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/91190628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PRADACANDI18",
        "html_url": "https://github.com/PRADACANDI18",
        "followers_url": "https://api.github.com/users/PRADACANDI18/followers",
        "following_url": "https://api.github.com/users/PRADACANDI18/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PRADACANDI18/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PRADACANDI18/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PRADACANDI18/subscriptions",
        "organizations_url": "https://api.github.com/users/PRADACANDI18/orgs",
        "repos_url": "https://api.github.com/users/PRADACANDI18/repos",
        "events_url": "https://api.github.com/users/PRADACANDI18/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PRADACANDI18/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-30T20:13:57Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16301232476,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAAPLoRFc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16301232476",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "98dce62e11fe3b75b8f354f607ad2852e0caf861",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/98dce62e11fe3b75b8f354f607ad2852e0caf861",
      "created_at": "2025-02-13T18:49:00Z"
    },
    {
      "event": "reviewed",
      "id": 2668456532,
      "node_id": "PRR_kwDOABII586fDWpU",
      "url": null,
      "actor": null,
      "commit_id": "98dce62e11fe3b75b8f354f607ad2852e0caf861",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-03-07T21:49:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nI think the current approach would work.\r\nEven though it means that if the user provided a bad / non-existing assumeutxo hash they could skip script validation during a reindex when they wouldn't have in the original run,  I'd  say that's not a major problem because a reindex should only be necessary in case of a a db corruption, which should not be remotely triggerable.\r\n\r\nSo it will hopefully make the reindex a bit faster in case of a database corruption, while not changing the assumevalid security assumption very much, and it does respect `-assumevalid=0`.\r\n\r\nThough it would be good to have some experienced contributors chime in that were around when assumevalid was introduced (#9484).",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-2668456532",
      "submitted_at": "2025-03-07T21:49:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "ready_for_review",
      "id": 16641307203,
      "node_id": "RFRE_lADOABII586lQ1oXzwAAAAPf5jJD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16641307203",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-08T06:30:25Z"
    },
    {
      "event": "commented",
      "id": 2708070578,
      "node_id": "IC_kwDOABII586haeCy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2708070578",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-08T06:33:47Z",
      "updated_at": "2025-03-08T06:33:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the reviews @l0rinc and @mzumsande . Due to your feedback, I have opened the PR for general review.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-2708070578",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "mentioned",
      "id": 16641321655,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAAPf5mq3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16641321655",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-08T06:33:48Z"
    },
    {
      "event": "subscribed",
      "id": 16641321660,
      "node_id": "SE_lADOABII586lQ1oXzwAAAAPf5mq8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16641321660",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-08T06:33:48Z"
    },
    {
      "event": "mentioned",
      "id": 16641321664,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAAPf5mrA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16641321664",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-08T06:33:48Z"
    },
    {
      "event": "subscribed",
      "id": 16641321667,
      "node_id": "SE_lADOABII586lQ1oXzwAAAAPf5mrD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16641321667",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-08T06:33:48Z"
    },
    {
      "event": "labeled",
      "id": 16921038095,
      "node_id": "LE_lADOABII586lQ1oXzwAAAAPwko0P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16921038095",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-21T02:52:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2742593133,
      "node_id": "IC_kwDOABII586jeKZt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2742593133",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-21T07:47:31Z",
      "updated_at": "2025-03-21T07:47:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "Needs rebase, if still relevant",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-2742593133",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16952865605,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAAPyeDNF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16952865605",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "created_at": "2025-03-24T10:23:35Z"
    },
    {
      "event": "renamed",
      "id": 16953802714,
      "node_id": "RTE_lADOABII586lQ1oXzwAAAAPyhn_a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16953802714",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-24T11:21:10Z",
      "rename": {
        "from": "Ensure assumevalid is always used during reindex",
        "to": "validation: ensure assumevalid is always used during reindex"
      }
    },
    {
      "event": "commented",
      "id": 2747830190,
      "node_id": "IC_kwDOABII586jyI-u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2747830190",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-24T11:39:41Z",
      "updated_at": "2025-03-24T11:39:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on master https://github.com/bitcoin/bitcoin/commit/770d39a37652d40885533fecce37e9f71cc0d051\r\n- fix failing functional test by changing `self.send_message` to `self.send_without_ping` due to https://github.com/bitcoin/bitcoin/commit/fa9cf38ab666b50b0d8e82cb17f9e5a8a613547d",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-2747830190",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "unlabeled",
      "id": 16954092275,
      "node_id": "UNLE_lADOABII586lQ1oXzwAAAAPyiurz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16954092275",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-24T11:40:33Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 16954093075,
      "node_id": "LE_lADOABII586lQ1oXzwAAAAPyiu4T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16954093075",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-24T11:40:35Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "reviewed",
      "id": 2844925670,
      "node_id": "PRR_kwDOABII586pkh7m",
      "url": null,
      "actor": null,
      "commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-05-15T22:08:15Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-2844925670",
      "submitted_at": "2025-05-15T22:08:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "labeled",
      "id": 18156507534,
      "node_id": "LE_lADOABII586lQ1oXzwAAAAQ6NlGO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18156507534",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-15T13:59:14Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2931181107,
      "node_id": "PRR_kwDOABII586utkYz",
      "url": null,
      "actor": null,
      "commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-06-16T08:49:13Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-2931181107",
      "submitted_at": "2025-06-16T08:49:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18209047541,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAAQ9WAP1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18209047541",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "11a9d55e84af2d6ff138b99310720667cd59dcc3",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/11a9d55e84af2d6ff138b99310720667cd59dcc3",
      "created_at": "2025-06-18T11:59:07Z"
    },
    {
      "event": "commented",
      "id": 2983922120,
      "node_id": "IC_kwDOABII586x2wnI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2983922120",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-18T12:02:58Z",
      "updated_at": "2025-06-18T12:02:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on master https://github.com/bitcoin/bitcoin/commit/5e6dbfd14ea9eace1c7e5ee76b140be46a0ec855 and addressed reviews",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-2983922120",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "unlabeled",
      "id": 18210306891,
      "node_id": "UNLE_lADOABII586lQ1oXzwAAAAQ9aztL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18210306891",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-18T13:10:11Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2946966884,
      "node_id": "PRR_kwDOABII586vpyVk",
      "url": null,
      "actor": null,
      "commit_id": "11a9d55e84af2d6ff138b99310720667cd59dcc3",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-04T08:31:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 11a9d55e.\r\n\r\nAgree that applying reindex-assumevalid combo can be useful in the special cases mentioned above to speedup reindexing when we don't have all blocks.\r\n\r\nA behaviour change during assumevalid+reindex now would be:\r\n- we'd skip script checks even when the assumevalid blockindex doesn't exist (ex:we put `assumevalid=somegarbage(or)blockhash-with-typo`)\r\n- this was not the case on master where we skip script checks only when know that the assumevalid blockindex exists.\r\n\r\nDon't think it's a problem since assumevalid already puts responsibility on the user and we'd need to have tampered block files on disk from some external source (in which case user shouldn't be using assumevalid in the first place). just wanted to mention it + curious about what others think about this/any other possible behaviour change. ",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-2946966884",
      "submitted_at": "2025-07-04T08:31:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "review_requested",
      "id": 18467072563,
      "node_id": "RRE_lADOABII586lQ1oXzwAAAARMuSoz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18467072563",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-04T08:31:24Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 18467072762,
      "node_id": "RRE_lADOABII586lQ1oXzwAAAARMuSr6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18467072762",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-04T08:31:25Z",
      "requested_reviewer": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18472933906,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAARNEpoS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18472933906",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "e260e23d88cd6b2aaa03d9d45dae8b174f2cfe1f",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/e260e23d88cd6b2aaa03d9d45dae8b174f2cfe1f",
      "created_at": "2025-07-04T13:47:36Z"
    },
    {
      "event": "commented",
      "id": 3036343118,
      "node_id": "IC_kwDOABII5860-utO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3036343118",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-04T13:49:48Z",
      "updated_at": "2025-07-04T13:54:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased https://github.com/bitcoin/bitcoin/pull/31615/commits/11a9d55e84af2d6ff138b99310720667cd59dcc3 to https://github.com/bitcoin/bitcoin/pull/31615/commits/e260e23d88cd6b2aaa03d9d45dae8b174f2cfe1f\r\n\r\n- moved `feature_reindex.py` test to \"Tests less than 2m\" section in `test_runner.py`, because it is now much slower and has similar runtimes to other tests in this section",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3036343118",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18496137939,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAAROdKrT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18496137939",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a53d43bc0f010513b0922ad48d611f402ec0e511",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/a53d43bc0f010513b0922ad48d611f402ec0e511",
      "created_at": "2025-07-07T03:47:55Z"
    },
    {
      "event": "commented",
      "id": 3043395366,
      "node_id": "IC_kwDOABII5861Zocm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3043395366",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T03:49:42Z",
      "updated_at": "2025-07-07T03:52:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased https://github.com/bitcoin/bitcoin/commit/e260e23d88cd6b2aaa03d9d45dae8b174f2cfe1f to https://github.com/bitcoin/bitcoin/commit/a53d43bc0f010513b0922ad48d611f402ec0e511 to address https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2185605623\r\nAlso see https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2188910716",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3043395366",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "commented",
      "id": 3043958524,
      "node_id": "IC_kwDOABII5861bx78",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3043958524",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T08:25:49Z",
      "updated_at": "2025-07-07T08:25:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "reACK a53d43b.",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3043958524",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "labeled",
      "id": 18703541765,
      "node_id": "LE_lADOABII586lQ1oXzwAAAARa0WYF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18703541765",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-18T16:05:23Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3036675207,
      "node_id": "PRR_kwDOABII5860__yH",
      "url": null,
      "actor": null,
      "commit_id": "a53d43bc0f010513b0922ad48d611f402ec0e511",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-21T06:06:47Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3036675207",
      "submitted_at": "2025-07-21T06:06:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18722666714,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAARb9Tja",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18722666714",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/01e372b25855a21d205c6ded83f6849691111d42",
      "created_at": "2025-07-21T07:34:07Z"
    },
    {
      "event": "unlabeled",
      "id": 18723724392,
      "node_id": "UNLE_lADOABII586lQ1oXzwAAAARcBVxo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18723724392",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-21T08:43:38Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3095873057,
      "node_id": "IC_kwDOABII5864h0Yh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3095873057",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-21T09:23:50Z",
      "updated_at": "2025-07-21T09:23:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on master@ https://github.com/bitcoin/bitcoin/commit/5878f35446",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3095873057",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "reviewed",
      "id": 3039244807,
      "node_id": "PRR_kwDOABII5861JzIH",
      "url": null,
      "actor": null,
      "commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-21T19:01:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 01e372b25855a21d205c6ded83f6849691111d42\r\n\r\nThanks for fixing it - someone with more knowledge in this area should also validate it.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3039244807",
      "submitted_at": "2025-07-21T19:01:30Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "review_requested",
      "id": 18735160270,
      "node_id": "RRE_lADOABII586lQ1oXzwAAAARcs9vO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18735160270",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-21T19:01:34Z",
      "requested_reviewer": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18746401522,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAARdX2Ly",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18746401522",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "7a77aee48e9de403da59cf94be4c02bd0dca0211",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/7a77aee48e9de403da59cf94be4c02bd0dca0211",
      "created_at": "2025-07-22T08:27:18Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18746960841,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAARdZ-vJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18746960841",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "89b5b607e3380ff2cf03d8199c70e655e8c265cb",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/89b5b607e3380ff2cf03d8199c70e655e8c265cb",
      "created_at": "2025-07-22T08:52:22Z"
    },
    {
      "event": "reviewed",
      "id": 3044142789,
      "node_id": "PRR_kwDOABII5861ce7F",
      "url": null,
      "actor": null,
      "commit_id": "89b5b607e3380ff2cf03d8199c70e655e8c265cb",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-22T17:46:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 89b5b607e3380ff2cf03d8199c70e655e8c265cb\r\n\r\nConsider unifying the way your refer to the first block that fulfills the assumevalid condition",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3044142789",
      "submitted_at": "2025-07-22T17:46:48Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18766917645,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAARemHAN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18766917645",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6923417e0990af3ac1a99da7559236eedf5ad833",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/6923417e0990af3ac1a99da7559236eedf5ad833",
      "created_at": "2025-07-23T06:47:36Z"
    },
    {
      "event": "commented",
      "id": 3273275956,
      "node_id": "IC_kwDOABII587DGjo0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3273275956",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-10T04:27:29Z",
      "updated_at": "2025-09-10T05:20:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "Just tried this on my [rpi4b server which keeps enabling signature validation](https://github.com/bitcoin/bitcoin/pull/33336#issuecomment-3273277122) after a reindex. Restarting it with only the args `./build/bin/bitcoind -dbcache=5000 -datadir=$DATA_DIR -assumevalid=0000000000000000000087564caa77e7b3f29d0464256c04d5539e43663f8698` still shows heavy signature validation (based on `perf top`).\r\n<img width=\"1000\"  alt=\"image\" src=\"https://github.com/user-attachments/assets/b29b6bdd-6be2-4b05-98e3-82d60989c52c\" />\r\n\r\nAdding some logging reveals that the reason for reenabling it is that the assumedcalid block is not actually found in the block index for some reason: https://github.com/bitcoin/bitcoin/blob/master/src/validation.cpp#L2433-L2434",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3273275956",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "commented",
      "id": 3274934398,
      "node_id": "IC_kwDOABII587DM4h-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3274934398",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-10T13:13:59Z",
      "updated_at": "2025-09-10T13:14:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Just tried this on my [rpi4b server which keeps enabling signature validation](https://github.com/bitcoin/bitcoin/pull/33336#issuecomment-3273277122) after a reindex. Restarting it with only the args `./build/bin/bitcoind -dbcache=5000 -datadir=$DATA_DIR -assumevalid=0000000000000000000087564caa77e7b3f29d0464256c04d5539e43663f8698` still shows heavy signature validation\r\n\r\n@l0rinc  Can you share steps to reproduce? Did the previous reindex use signature validation? Was your node pruned? ",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3274934398",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "mentioned",
      "id": 19612969477,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAASRBioF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19612969477",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-10T13:14:32Z"
    },
    {
      "event": "subscribed",
      "id": 19612969525,
      "node_id": "SE_lADOABII586lQ1oXzwAAAASRBio1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19612969525",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-10T13:14:32Z"
    },
    {
      "event": "commented",
      "id": 3276022733,
      "node_id": "IC_kwDOABII587DRCPN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3276022733",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-10T18:13:12Z",
      "updated_at": "2025-09-10T18:13:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "Not pruned, but did many reindex-chainstates (it's a rpi4b benchmarking server), maybe a few `reindex`es as well. I don't know how to reliably reproduce it, but it always happen on that server with the given state. I will try to copy the data over when the other servers free up.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3276022733",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "commented",
      "id": 3281660246,
      "node_id": "IC_kwDOABII587DmilW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3281660246",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-11T16:11:24Z",
      "updated_at": "2025-09-11T16:11:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "While just restarting the node with this commit didn't help for some reason, doing a reindex with it does seem to disable signature verification successfully. But it doesn't actually seem to fix the underlying problem, since `./build/bin/bitcoin-cli -datadir=$DATA_DIR getblockchaininfo | jq .headers` still returns `841150` for me.\r\n\r\nSo while it does seem to work around the issue described in https://github.com/bitcoin/bitcoin/pull/33336#issuecomment-3277968407, it doesn't seem to solve the underlying problem of reindex ignoring the later headers.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3281660246",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "reviewed",
      "id": 3214117877,
      "node_id": "PRR_kwDOABII586_k4v1",
      "url": null,
      "actor": null,
      "commit_id": "6923417e0990af3ac1a99da7559236eedf5ad833",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-09-12T00:49:57Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3214117877",
      "submitted_at": "2025-09-12T00:49:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "labeled",
      "id": 19663691395,
      "node_id": "LE_lADOABII586lQ1oXzwAAAASUDB6D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19663691395",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-12T15:27:52Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 19696313152,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAASV_eNA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19696313152",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "created_at": "2025-09-15T09:17:03Z"
    },
    {
      "event": "review_requested",
      "id": 19697865623,
      "node_id": "RRE_lADOABII586lQ1oXzwAAAASWFZOX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19697865623",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-15T10:29:40Z",
      "requested_reviewer": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 19697865841,
      "node_id": "RRE_lADOABII586lQ1oXzwAAAASWFZRx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19697865841",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-15T10:29:40Z",
      "requested_reviewer": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 19697866079,
      "node_id": "RRE_lADOABII586lQ1oXzwAAAASWFZVf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19697866079",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-15T10:29:41Z",
      "requested_reviewer": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 3291494499,
      "node_id": "IC_kwDOABII587EMDhj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3291494499",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-15T10:33:15Z",
      "updated_at": "2025-09-15T10:33:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on master and added a comment explaining why we bother to skip minimumchainwork, even though we expect minimumchainwork to match assumevalid block height most times.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3291494499",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "unlabeled",
      "id": 19698546953,
      "node_id": "UNLE_lADOABII586lQ1oXzwAAAASWH_kJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19698546953",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-15T11:02:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3269093414,
      "node_id": "PRR_kwDOABII587C2mgm",
      "url": null,
      "actor": null,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-09-25T18:59:48Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3269093414",
      "submitted_at": "2025-09-25T18:59:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "commented",
      "id": 3397101094,
      "node_id": "IC_kwDOABII587Ke6Ym",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3397101094",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-13T11:23:00Z",
      "updated_at": "2025-10-13T11:23:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3397101094",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "reviewed",
      "id": 3337308344,
      "node_id": "PRR_kwDOABII587G60i4",
      "url": null,
      "actor": null,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-14T20:32:57Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3337308344",
      "submitted_at": "2025-10-14T20:32:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20380641702,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAAS-x-mm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20380641702",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "06ab0844367eb7b1d609967b9f09fe690f73c7a8",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/06ab0844367eb7b1d609967b9f09fe690f73c7a8",
      "created_at": "2025-10-20T13:42:13Z"
    },
    {
      "event": "labeled",
      "id": 20491581272,
      "node_id": "LE_lADOABII586lQ1oXzwAAAATFZLdY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20491581272",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-24T19:10:05Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20528465152,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAATHl4UA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20528465152",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6270f2137070ab90dae19f78570a3ac038ea44f9",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/6270f2137070ab90dae19f78570a3ac038ea44f9",
      "created_at": "2025-10-27T15:13:46Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDMyZWNlZWU0NWFlZjViMDQ4NmU3ZGU1MWJmMTk4NzM1ZmVlMjJmYTc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/32eceee45aef5b0486e7de51bf198735fee22fa7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/32eceee45aef5b0486e7de51bf198735fee22fa7",
      "tree": {
        "sha": "165ae1dbf194aee4cd0a6eeb6c1bad235184227d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/165ae1dbf194aee4cd0a6eeb6c1bad235184227d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f54ffb4bc141ffcc6fffe574edbcbbb21f001476",
          "sha": "f54ffb4bc141ffcc6fffe574edbcbbb21f001476",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f54ffb4bc141ffcc6fffe574edbcbbb21f001476"
        }
      ],
      "message": "validation.cpp: use assumevalid during reindex\n\n-reindex deletes the block tree db and attempts to rebuild it based on local block files,\nwithout attempting to re-request headers for which we don't have the full block.\nThis might cause:\n- the best known chain to have a chainwork less than the minimumchainwork\n- the assumedvalid block to not be in the block index if the previous IBD was interrupted\nbefore downloading it",
      "committer": {
        "name": "Novo",
        "email": "eunovo9@gmail.com",
        "date": "2025-10-27T15:18:10Z"
      },
      "author": {
        "name": "Eunovo",
        "email": "eunovo9@gmail.com",
        "date": "2025-01-07T11:30:56Z"
      },
      "sha": "32eceee45aef5b0486e7de51bf198735fee22fa7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU1ZGFmMGUwNjA3OGI1NmExOGViOTAwZDBlZjBkNjBjZTA5YWVjYzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "tree": {
        "sha": "07ea96921538491ffa0c42de26015eefff66df4d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/07ea96921538491ffa0c42de26015eefff66df4d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/32eceee45aef5b0486e7de51bf198735fee22fa7",
          "sha": "32eceee45aef5b0486e7de51bf198735fee22fa7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/32eceee45aef5b0486e7de51bf198735fee22fa7"
        }
      ],
      "message": "test: Check that reindex always uses -assumevalid\n\nAlso move feature_reindex.py test to \"Tests less than 2m\" section in test_runner.py,\nbecause it is now much slower and has similar runtimes to other tests in this section",
      "committer": {
        "name": "Novo",
        "email": "eunovo9@gmail.com",
        "date": "2025-10-27T15:18:10Z"
      },
      "author": {
        "name": "Eunovo",
        "email": "eunovo9@gmail.com",
        "date": "2025-01-06T18:44:17Z"
      },
      "sha": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20528595141,
      "node_id": "HRFPE_lADOABII586lQ1oXzwAAAATHmYDF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20528595141",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "commit_url": "https://api.github.com/repos/Eunovo/bitcoin/commits/55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "created_at": "2025-10-27T15:18:31Z"
    },
    {
      "event": "commented",
      "id": 3451978821,
      "node_id": "IC_kwDOABII587NwQRF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3451978821",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T15:41:17Z",
      "updated_at": "2025-10-27T15:41:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on master",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3451978821",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "unlabeled",
      "id": 20531589282,
      "node_id": "UNLE_lADOABII586lQ1oXzwAAAATHxzCi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20531589282",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T17:16:28Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3403430467,
      "node_id": "PRR_kwDOABII587K3DpD",
      "url": null,
      "actor": null,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-31T10:00:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK: reindex validation behaviour being different to IBD validation behaviour is undesirable and should be avoided.\r\n\r\nSlight approach NACK: I think this is probably the smallest diff we can get to improve reindex behaviour, but I think there are drawbacks that outweigh the benefits:\r\n1) it still doesn't make IBD and reindex validation behaviour the same: with the current approach blocks that are NOT part of the assumevalid chain will still be validated as assumevalid. While it doesn't seem likely that this can currently be abused by an attacker, I'm not certain and I'd prefer avoiding having to think about it now and in the future.\r\n2) this makes validation slightly more complex by adding another edge case to solve a problem which should only (?) occur in case of corruption, most likely caused by faulty hardware. While I'm not against improving reindex behaviour, I'm not convinced it's important enough to complicate overall validation logic. If the user has fixed their hardware faults, just running a fresh IBD doesn't seem like a big deal for these rare occurences?\r\n\r\nGenerally speaking, I think we should move towards IBD and reindex validation behaviour converging rather than diverging. Three alternative approaches, sorted by decreasing feasibility, include:\r\n1) Log an error that assumevalid is enabled but reindex could not find the specified assumevalid header, print the highest available header in blockindex and inform the user that they can restart with `-assumevalid=0` or `-assumevalid=<best_available_header>`or a fresh IBD, and then shutdown the node.\r\n2) rearchitect our blockindex storage so that we don't need reindex, or so that it doesn't wipe the assumevalid state. Relevant work is being done in https://github.com/bitcoin/bitcoin/pull/32427, and @cfields shared some relevant thoughts offline too.\r\n3) generalize validation logic so that there is no difference between IBD and reindex, making it possible to do p2p during reindex\r\n\r\nMy preference for this PR would be to implement approach 1) to not change logic but just increase visibility for the user, and then actually improve things by improving our architecture (approaches 2) and/or 3)) rather than patching things up.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3403430467",
      "submitted_at": "2025-10-31T09:58:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "commented",
      "id": 3472571178,
      "node_id": "IC_kwDOABII587O-zsq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3472571178",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-31T11:11:51Z",
      "updated_at": "2025-10-31T11:11:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "> 1. Log an error that assumevalid is enabled but reindex could not find the specified assumevalid header, print the highest available header in blockindex and inform the user that they can restart with `-assumevalid=0` or `-assumevalid=<best_available_header>`or a fresh IBD, and then shutdown the node.\r\n\r\nI agree with this approach, but we would still have to update the `minimumchainwork` logic for reindex, or we ask the user to also update the `minimumchainwork` too.\r\n\r\n> 3. generalize validation logic so that there is no difference between IBD and reindex, making it possible to do p2p during reindex\r\n\r\nI'm not sure how important it is for `reindex` to be able to work without a network connection.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3472571178",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "commented",
      "id": 3472925314,
      "node_id": "IC_kwDOABII587PAKKC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3472925314",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-31T12:38:32Z",
      "updated_at": "2025-10-31T12:38:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I agree with this approach, but we would still have to update the `minimumchainwork` logic for reindex, or we ask the user to also update the `minimumchainwork` too.\r\n\r\nThat seems sensible. I'm currently unsure what the best approach is here, but informing in logging seems like the minimum we can do.\r\n\r\n> I'm not sure how important it is for reindex to be able to work without a network connection.\r\n\r\nI don't think it is. Reindex being fully offline to me seems like an artifact of our current startup and locking logic, rather than a stated goal. Note also that my suggestions don't mean reindex requires network connection, just that it doesn't preclude it so headers _can_ be synced if the user allows network connections.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3472925314",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "commented",
      "id": 3473833357,
      "node_id": "IC_kwDOABII587PDn2N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3473833357",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-31T16:19:15Z",
      "updated_at": "2025-10-31T16:19:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "For my benchmarking needs `reindex-chainstate` suffices, especially now that I know about this corner-case.\r\n\r\n> Log an error that assumevalid is enabled but reindex could not find the specified assumevalid header\r\n\r\nNow that https://github.com/bitcoin/bitcoin/pull/33336 was merge we're getting part of that message already which should already help a lot in this situation.\r\n\r\nThanks for taking care of this issue, agree with the concerns of @stickies-v, but I personally would either keep `reindex` offline (I don't like surprises, I often start benchmarks with `-connect=0`) or add an optional header update between reindex and reindex-chainstate steps which could time out to degrade gracefully.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3473833357",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "mentioned",
      "id": 20638230618,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAATOImha",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20638230618",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-31T16:19:17Z"
    },
    {
      "event": "subscribed",
      "id": 20638230650,
      "node_id": "SE_lADOABII586lQ1oXzwAAAATOImh6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20638230650",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-31T16:19:17Z"
    },
    {
      "event": "reviewed",
      "id": 3364452726,
      "node_id": "PRR_kwDOABII587IiXl2",
      "url": null,
      "actor": null,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-07T15:52:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Agree this issue would be good to fix!\n\nHowever also agree with https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3403430467 that logging a warning/error and doing some kind of higher level change instead of patching things up here would be preferable.\n\n#### Higher level proposal\n\nAdd an earlier phase for `-reindex` where it rebuilds the headers chain/`BlockIndex` from blocks on disk, and if we're still below minimumchainwork, perform headerssync to populate the index prior to this phase of processing blocks.\n\nA condition for exiting this new phase would be that we fulfill minimumchainwork, that way we shouldn't (ever?) have an issue where best header is below minimum chainwork when we reach `ConnectBlock()`.\n\nThere may be a concern that some of the headers taken from blocks on disk somehow got corrupted, leading to us filling the block index with garbage. But if we verify headers connect by prev-hash and obey thresholds and difficulty adjustments before feeding them to the index we should be okay (same as we do for headerssync).\n\n#### Alternative\n\nAn alternative to the above would be to have a completely different fast path for `-reindex` where if the block exists on disk, we only do minimal hashing to verify that the entire block data is not corrupt. This assumes we do more complete validation before storing blocks to disk (and doesn't account for switching between binaries with different consensus rules).\n\nThis would however enable a malicious party to give invalid blocks data to a victim while offline, \"here, I optimized IBD for you\". But it would still require an eclipse attack / network split to maintain.\n\n#### Sidebar\n\n(There was an issue with the prior 661a32305c13fdffc7dc4420aa44eb503739fc12 where if we halt IBD before reaching the assumevalid block, and restart with -reindex, it looks like we would have disabled script validation even though the block was younger than 2 weeks.\n\nhttps://github.com/bitcoin/bitcoin/commit/661a32305c13fdffc7dc4420aa44eb503739fc12#diff-97c3a52bc5fad452d82670a7fd291800bae20c7bc35bb82686c2c0a4ea7b5b98R2462\n\nThis has been fixed in newer pushes AFAICS).",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#pullrequestreview-3364452726",
      "submitted_at": "2025-11-07T15:52:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
    },
    {
      "event": "commented",
      "id": 3517155840,
      "node_id": "IC_kwDOABII587Ro4oA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3517155840",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:18Z",
      "updated_at": "2025-11-11T14:32:10Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the reviews and suggestions @l0rinc @stickies-v @hodlinator @mzumsande @TheCharlatan @stratospher .\r\nI have implemented an approach that uses headers-sync in https://github.com/bitcoin/bitcoin/pull/33854 and will be closing this PR.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#issuecomment-3517155840",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31615"
    },
    {
      "event": "closed",
      "id": 20864134069,
      "node_id": "CE_lADOABII586lQ1oXzwAAAATbmWu1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864134069",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:18Z"
    },
    {
      "event": "mentioned",
      "id": 20864134803,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAATbmW6T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864134803",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:20Z"
    },
    {
      "event": "subscribed",
      "id": 20864134846,
      "node_id": "SE_lADOABII586lQ1oXzwAAAATbmW6-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864134846",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:20Z"
    },
    {
      "event": "mentioned",
      "id": 20864134874,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAATbmW7a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864134874",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:20Z"
    },
    {
      "event": "subscribed",
      "id": 20864134911,
      "node_id": "SE_lADOABII586lQ1oXzwAAAATbmW7_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864134911",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:20Z"
    },
    {
      "event": "mentioned",
      "id": 20864134950,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAATbmW8m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864134950",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:20Z"
    },
    {
      "event": "subscribed",
      "id": 20864134973,
      "node_id": "SE_lADOABII586lQ1oXzwAAAATbmW89",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864134973",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:20Z"
    },
    {
      "event": "mentioned",
      "id": 20864135016,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAATbmW9o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864135016",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:21Z"
    },
    {
      "event": "subscribed",
      "id": 20864135040,
      "node_id": "SE_lADOABII586lQ1oXzwAAAATbmW-A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864135040",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:21Z"
    },
    {
      "event": "mentioned",
      "id": 20864135077,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAATbmW-l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864135077",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:21Z"
    },
    {
      "event": "subscribed",
      "id": 20864135109,
      "node_id": "SE_lADOABII586lQ1oXzwAAAATbmW_F",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864135109",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:21Z"
    },
    {
      "event": "mentioned",
      "id": 20864135157,
      "node_id": "MEE_lADOABII586lQ1oXzwAAAATbmW_1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864135157",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:21Z"
    },
    {
      "event": "subscribed",
      "id": 20864135201,
      "node_id": "SE_lADOABII586lQ1oXzwAAAATbmXAh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20864135201",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T14:23:21Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905647128",
      "pull_request_review_id": 2534670554,
      "id": 1905647128,
      "node_id": "PRRC_kwDOABII585xld4Y",
      "diff_hunk": "@@ -2499,7 +2499,7 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         if (it != m_blockman.m_block_index.end()) {\n             if (it->second.GetAncestor(pindex->nHeight) == pindex &&\n                 m_chainman.m_best_header->GetAncestor(pindex->nHeight) == pindex &&\n-                m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork()) {\n+                (m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork() || m_chainman.m_blockman.LoadingBlocks())) {",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "951812b0ac93424ed4adf09427ca042a832c73ef",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think that this won't achieve the desired result: If the assumevalid block is not in the block index (which will be the case if IBD crashed midway before that block was downloaded, and a reindex is done) we'll abort above in line 2499 and  never get to this spot.",
      "created_at": "2025-01-07T15:39:12Z",
      "updated_at": "2025-01-07T16:13:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r1905647128",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905647128"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2502,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905885950",
      "pull_request_review_id": 2535103631,
      "id": 1905885950,
      "node_id": "PRRC_kwDOABII585xmYL-",
      "diff_hunk": "@@ -2499,7 +2499,7 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         if (it != m_blockman.m_block_index.end()) {\n             if (it->second.GetAncestor(pindex->nHeight) == pindex &&\n                 m_chainman.m_best_header->GetAncestor(pindex->nHeight) == pindex &&\n-                m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork()) {\n+                (m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork() || m_chainman.m_blockman.LoadingBlocks())) {",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "951812b0ac93424ed4adf09427ca042a832c73ef",
      "in_reply_to_id": 1905647128,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "That's true. I thought https://github.com/bitcoin/bitcoin/issues/31494 was focused on the best header chainwork not being up to minimumchainwork. I could change this to always skip script checks during a reindex, but IIUC having a block on disk doesn't mean that it was connected during the previous IBD. Might be worth it to sync headers first then connect blocks even during reindex.",
      "created_at": "2025-01-07T18:29:47Z",
      "updated_at": "2025-01-07T18:29:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r1905885950",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905885950"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2502,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1906056946",
      "pull_request_review_id": 2535395138,
      "id": 1906056946,
      "node_id": "PRRC_kwDOABII585xnB7y",
      "diff_hunk": "@@ -2499,7 +2499,7 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         if (it != m_blockman.m_block_index.end()) {\n             if (it->second.GetAncestor(pindex->nHeight) == pindex &&\n                 m_chainman.m_best_header->GetAncestor(pindex->nHeight) == pindex &&\n-                m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork()) {\n+                (m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork() || m_chainman.m_blockman.LoadingBlocks())) {",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "951812b0ac93424ed4adf09427ca042a832c73ef",
      "in_reply_to_id": 1905647128,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I really wasn't sure what the best solution is when I opened the issue and still am not, but these are my thoughts:\r\n\r\nYes, there are two reasons why we might not apply assumevalid during a reindex currently:\r\n1.) The best header has not enough chainwork\r\n2.) The assumevalid block is not in our block index\r\n\r\n> I could change this to always skip script checks during a reindex, but IIUC having a block on disk doesn't mean that it was connected during the previous IBD. \r\n\r\nI think the question is rather how well we can avoid to connect blocks skipping the script checks during the reindex that we would have fully validated in the original run if we hadn't crashed. Assuming that the user provides the same `-assumevalid`  arg to the reindex run that they did in the original run I can see the following cases:\r\n1.) The user provides an existing block (or nothing, so that the default hash from chainparams is used) that we just haven't downloaded yet because it's later in the best chain - if we don't have it in our index we'd be justified to skip script checks - if we do have it in our index, no special rules are necessary for reindexing. I think that's the most common case for users.\r\n2.) The user provides `-assumevalid=0`  - we should respect that also in the reindex run and fully validate everything.\r\n3.) The user provides a block hash with `-assumevalid` that is non-existing / not in the best chain. I think that's the critical case because here we would have fully validated everything in the original run, but won't validate anything during the reindex. But arguably that's not a common case / the user's fault for providing this bad block, so maybe it can be tolerated?\r\n\r\n> Might be worth it to sync headers first then connect blocks even during reindex.\r\n\r\nYes, that's the second option I thought of. I think we can't just stop and wait for the headers to be downloaded - reindex should be able to finish without having a p2p connection, even if that means no assumevalid. But I was thinking of maybe just disabling the relevant `LoadingBlocks()` guards in net_processing, so that we'd download headers in parallel to `ActivateBestChain()`, and would change to use assumevalid after a few thousand blocks or so. That seem a bit messy (we'd still connect _some_ blocks without assumevalid) and requires testing but might work well in practice?!\r\n\r\n",
      "created_at": "2025-01-07T21:23:34Z",
      "updated_at": "2025-01-07T21:23:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r1906056946",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1906056946"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2502,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910413909",
      "pull_request_review_id": 2542504562,
      "id": 1910413909,
      "node_id": "PRRC_kwDOABII585x3ppV",
      "diff_hunk": "@@ -2499,7 +2499,7 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         if (it != m_blockman.m_block_index.end()) {\n             if (it->second.GetAncestor(pindex->nHeight) == pindex &&\n                 m_chainman.m_best_header->GetAncestor(pindex->nHeight) == pindex &&\n-                m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork()) {\n+                (m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork() || m_chainman.m_blockman.LoadingBlocks())) {",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "951812b0ac93424ed4adf09427ca042a832c73ef",
      "in_reply_to_id": 1905647128,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I created another test to check if blocks rejected in the normal IBD run get loaded during a `-reindex`. The test reveals that it does load the invalid block and it will connect it if script checks are skipped, see https://github.com/Eunovo/bitcoin/commit/1ff4e5ee78418a30ba1ea9c384b8c7ee43435ce6\r\n\r\nIIUC During a reindex, the node does not know what blocks were connected in the previous run so it can't safely skip checks. It looks to me like we have to:\r\n1. Sync headers before connecting blocks during  reindex OR\r\n2. Persist data to show that we previously connected this block (IIUC this exact data exists but gets deleted during reindex, maybe we can preserve the relevant data we need?)",
      "created_at": "2025-01-10T13:59:01Z",
      "updated_at": "2025-01-10T13:59:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r1910413909",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910413909"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2502,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910419783",
      "pull_request_review_id": 2542515313,
      "id": 1910419783,
      "node_id": "PRRC_kwDOABII585x3rFH",
      "diff_hunk": "@@ -2499,7 +2499,7 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         if (it != m_blockman.m_block_index.end()) {\n             if (it->second.GetAncestor(pindex->nHeight) == pindex &&\n                 m_chainman.m_best_header->GetAncestor(pindex->nHeight) == pindex &&\n-                m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork()) {\n+                (m_chainman.m_best_header->nChainWork >= m_chainman.MinimumChainWork() || m_chainman.m_blockman.LoadingBlocks())) {",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "951812b0ac93424ed4adf09427ca042a832c73ef",
      "in_reply_to_id": 1905647128,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> The test reveals that it does load the invalid block and it will connect it if script checks are skipped, see [Eunovo@1ff4e5e](https://github.com/Eunovo/bitcoin/commit/1ff4e5ee78418a30ba1ea9c384b8c7ee43435ce6)\r\n\r\nI'm still not sure if this causes any damage because I expect the node to eventually pick the most-work chain when it syncs headers",
      "created_at": "2025-01-10T14:04:03Z",
      "updated_at": "2025-01-10T14:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r1910419783",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910419783"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2502,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2091928728",
      "pull_request_review_id": 2844925670,
      "id": 2091928728,
      "node_id": "PRRC_kwDOABII5858sEyY",
      "diff_hunk": "@@ -1213,6 +1228,11 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n             }\n             nFile++;\n         }\n+\n+        // Call ActivateBestChain here so we can skip script verification",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "e1b42458cc5a4ab906b1b8ee0db29b0dad0c7b3c",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: I'd replace \"here\" with \"before setting m_blockfiles_indexed\" so the reason becomes more clear.",
      "created_at": "2025-05-15T20:41:19Z",
      "updated_at": "2025-05-15T22:08:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2091928728",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2091928728"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2091930195",
      "pull_request_review_id": 2844925670,
      "id": 2091930195,
      "node_id": "PRRC_kwDOABII5858sFJT",
      "diff_hunk": "@@ -1190,6 +1190,21 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n {\n     ImportingNow imp{chainman.m_blockman.m_importing};\n \n+    auto update_all_chainstate = [&]() {",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "e1b42458cc5a4ab906b1b8ee0db29b0dad0c7b3c",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'd prefer to call it `activate_all_chainstates` to not introduce a less precise term (\"update\").",
      "created_at": "2025-05-15T20:42:29Z",
      "updated_at": "2025-05-15T22:08:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2091930195",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2091930195"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1193,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2091983914",
      "pull_request_review_id": 2844925670,
      "id": 2091983914,
      "node_id": "PRRC_kwDOABII5858sSQq",
      "diff_hunk": "@@ -1235,18 +1255,7 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n         }\n     }\n \n-    // scan for better chains in the block chain database, that are not yet connected in the active best chain\n-\n-    // We can't hold cs_main during ActivateBestChain even though we're accessing\n-    // the chainman unique_ptrs since ABC requires us not to be holding cs_main, so retrieve\n-    // the relevant pointers before the ABC call.\n-    for (Chainstate* chainstate : WITH_LOCK(::cs_main, return chainman.GetAll())) {\n-        BlockValidationState state;\n-        if (!chainstate->ActivateBestChain(state, nullptr)) {\n-            chainman.GetNotifications().fatalError(strprintf(_(\"Failed to connect best block (%s).\"), state.ToString()));\n-            return;\n-        }\n-    }\n+    update_all_chainstate();",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 50,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "e1b42458cc5a4ab906b1b8ee0db29b0dad0c7b3c",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This means that in case of a reindex, `ActivateBestChain()`, will be called twice now from `ImportBlocks`, but that shouldn't be a problem because the second call just won't do any work.",
      "created_at": "2025-05-15T21:27:20Z",
      "updated_at": "2025-05-15T22:08:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2091983914",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2091983914"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1258,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092011943",
      "pull_request_review_id": 2844925670,
      "id": 2092011943,
      "node_id": "PRRC_kwDOABII5858sZGn",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the block with invalid signature\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-assumevalid=\" + blocks[-1].hash])\n+\n+        # Send blocks to node0\n+        p2p0 = node.add_p2p_connection(BaseNode())\n+        p2p0.send_header_for_blocks(blocks[0:2000])\n+        p2p0.send_header_for_blocks(blocks[2000:])\n+        # Only send the first 2100 blocks so the assumevalid block is not saved to disk before we reindex\n+        # This allows us to test that assumevalid is used in reindex even if the assumevalid block was not loaded during reindex\n+        for block in blocks[:2101]:\n+            p2p0.send_without_ping(msg_block(block))\n+        p2p0.sync_with_ping(timeout=960)\n+\n+        expected_height = height - 100\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+\n+        self.log.info(\"Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\")\n+        # Restart node0 but raise minimumchainwork to that of a chain 32256 blocks long\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\", \"-assumevalid=\" + blocks[2100].hash, \"-minimumchainwork=00000000000000000000000000000000000000000000000000007e01acd42dd2\"])\n+\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+        assert_equal(int(node.getbestblockhash(), 16), blocks[2100].sha256)\n+\n+        self.log.info(\"Testing reindex with assumevalid block not in block index\")\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\", \"-assumevalid=\" + blocks[-1].hash])\n+\n+        # node0 should still sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+        assert_equal(int(node.getbestblockhash(), 16), blocks[2100].sha256)\n+\n+        self.log.info(\"Success\")",
      "path": "test/functional/feature_reindex.py",
      "position": 124,
      "original_position": 111,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "would be good to add a subtest that a run without `-assumevalid` will not connect the invalid block. ",
      "created_at": "2025-05-15T21:54:39Z",
      "updated_at": "2025-05-15T22:08:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2092011943",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092011943"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 206,
      "original_line": 206,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092014654",
      "pull_request_review_id": 2844925670,
      "id": 2092014654,
      "node_id": "PRRC_kwDOABII5858sZw-",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the block with invalid signature",
      "path": "test/functional/feature_reindex.py",
      "position": 1,
      "original_position": 76,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Comment needs updating, `-assumevalid` points to the last block, not the invalid one.",
      "created_at": "2025-05-15T21:57:24Z",
      "updated_at": "2025-05-15T22:08:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2092014654",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092014654"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 158,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092020053",
      "pull_request_review_id": 2844925670,
      "id": 2092020053,
      "node_id": "PRRC_kwDOABII5858sbFV",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):",
      "path": "test/functional/feature_reindex.py",
      "position": 69,
      "original_position": 68,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "is there a reason we need to mine that many blocks, and not just a few more to make the test faster?",
      "created_at": "2025-05-15T22:02:53Z",
      "updated_at": "2025-05-15T22:08:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2092020053",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092020053"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 151,
      "original_line": 151,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092562248",
      "pull_request_review_id": 2845859601,
      "id": 2092562248,
      "node_id": "PRRC_kwDOABII5858ufdI",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the block with invalid signature\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-assumevalid=\" + blocks[-1].hash])\n+\n+        # Send blocks to node0\n+        p2p0 = node.add_p2p_connection(BaseNode())\n+        p2p0.send_header_for_blocks(blocks[0:2000])\n+        p2p0.send_header_for_blocks(blocks[2000:])\n+        # Only send the first 2100 blocks so the assumevalid block is not saved to disk before we reindex\n+        # This allows us to test that assumevalid is used in reindex even if the assumevalid block was not loaded during reindex\n+        for block in blocks[:2101]:\n+            p2p0.send_without_ping(msg_block(block))\n+        p2p0.sync_with_ping(timeout=960)\n+\n+        expected_height = height - 100\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+\n+        self.log.info(\"Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\")\n+        # Restart node0 but raise minimumchainwork to that of a chain 32256 blocks long\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\", \"-assumevalid=\" + blocks[2100].hash, \"-minimumchainwork=00000000000000000000000000000000000000000000000000007e01acd42dd2\"])\n+\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+        assert_equal(int(node.getbestblockhash(), 16), blocks[2100].sha256)\n+\n+        self.log.info(\"Testing reindex with assumevalid block not in block index\")\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\", \"-assumevalid=\" + blocks[-1].hash])\n+\n+        # node0 should still sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+        assert_equal(int(node.getbestblockhash(), 16), blocks[2100].sha256)\n+\n+        self.log.info(\"Success\")",
      "path": "test/functional/feature_reindex.py",
      "position": 124,
      "original_position": 111,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092011943,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Will do",
      "created_at": "2025-05-16T08:12:47Z",
      "updated_at": "2025-05-16T08:12:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2092562248",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092562248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 206,
      "original_line": 206,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092592761",
      "pull_request_review_id": 2845906267,
      "id": 2092592761,
      "node_id": "PRRC_kwDOABII5858um55",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):",
      "path": "test/functional/feature_reindex.py",
      "position": 69,
      "original_position": 68,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092020053,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Are you referring to the 100 blocks mined after the first 2100 blocks?",
      "created_at": "2025-05-16T08:31:12Z",
      "updated_at": "2025-05-16T08:31:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2092592761",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2092592761"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 151,
      "original_line": 151,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2093270847",
      "pull_request_review_id": 2846986085,
      "id": 2093270847,
      "node_id": "PRRC_kwDOABII5858xMc_",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):",
      "path": "test/functional/feature_reindex.py",
      "position": 69,
      "original_position": 68,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092020053,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I meant the 2100 (two weeks) of blocks. I didn't test this, but is there a reason this couldn't just be a few blocks (plus a few more that aren't sent to the node)?",
      "created_at": "2025-05-16T15:31:36Z",
      "updated_at": "2025-05-16T15:31:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2093270847",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2093270847"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 151,
      "original_line": 151,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2093372479",
      "pull_request_review_id": 2847147953,
      "id": 2093372479,
      "node_id": "PRRC_kwDOABII5858xlQ_",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):",
      "path": "test/functional/feature_reindex.py",
      "position": 69,
      "original_position": 68,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092020053,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Script checks are only skipped when the current block is roughly 2 weeks away from the tip. See https://github.com/bitcoin/bitcoin/blob/3f83c744ac28b700090e15b5dda2260724a56f49/src/validation.cpp#L2476-L2494\r\n\r\nWe have to bury the test block 2 weeks deep for script verification to the skipped",
      "created_at": "2025-05-16T16:42:39Z",
      "updated_at": "2025-05-16T16:42:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2093372479",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2093372479"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 151,
      "original_line": 151,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2093440637",
      "pull_request_review_id": 2847251855,
      "id": 2093440637,
      "node_id": "PRRC_kwDOABII5858x159",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):",
      "path": "test/functional/feature_reindex.py",
      "position": 69,
      "original_position": 68,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092020053,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "oh I see, forgot about that check - can be resolved.",
      "created_at": "2025-05-16T17:30:53Z",
      "updated_at": "2025-05-16T17:30:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2093440637",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2093440637"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 151,
      "original_line": 151,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2149393863",
      "pull_request_review_id": 2931181107,
      "id": 2149393863,
      "node_id": "PRRC_kwDOABII586AHSXH",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()",
      "path": "test/functional/feature_reindex.py",
      "position": 1,
      "original_position": 61,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": null,
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "                                   AttributeError: 'CTransaction' object has no attribute 'calc_sha256'",
      "created_at": "2025-06-16T08:49:12Z",
      "updated_at": "2025-06-16T08:49:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2149393863",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2149393863"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154418571",
      "pull_request_review_id": 2938920361,
      "id": 2154418571,
      "node_id": "PRRC_kwDOABII586AadGL",
      "diff_hunk": "@@ -1213,6 +1228,11 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n             }\n             nFile++;\n         }\n+\n+        // Call ActivateBestChain here so we can skip script verification",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "e1b42458cc5a4ab906b1b8ee0db29b0dad0c7b3c",
      "in_reply_to_id": 2091928728,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-06-18T11:59:37Z",
      "updated_at": "2025-06-18T11:59:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2154418571",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154418571"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154418790",
      "pull_request_review_id": 2938920752,
      "id": 2154418790,
      "node_id": "PRRC_kwDOABII586AadJm",
      "diff_hunk": "@@ -1190,6 +1190,21 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n {\n     ImportingNow imp{chainman.m_blockman.m_importing};\n \n+    auto update_all_chainstate = [&]() {",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "e1b42458cc5a4ab906b1b8ee0db29b0dad0c7b3c",
      "in_reply_to_id": 2091930195,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-06-18T11:59:45Z",
      "updated_at": "2025-06-18T11:59:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2154418790",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154418790"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1193,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154419225",
      "pull_request_review_id": 2938921347,
      "id": 2154419225,
      "node_id": "PRRC_kwDOABII586AadQZ",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the block with invalid signature\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-assumevalid=\" + blocks[-1].hash])\n+\n+        # Send blocks to node0\n+        p2p0 = node.add_p2p_connection(BaseNode())\n+        p2p0.send_header_for_blocks(blocks[0:2000])\n+        p2p0.send_header_for_blocks(blocks[2000:])\n+        # Only send the first 2100 blocks so the assumevalid block is not saved to disk before we reindex\n+        # This allows us to test that assumevalid is used in reindex even if the assumevalid block was not loaded during reindex\n+        for block in blocks[:2101]:\n+            p2p0.send_without_ping(msg_block(block))\n+        p2p0.sync_with_ping(timeout=960)\n+\n+        expected_height = height - 100\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+\n+        self.log.info(\"Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\")\n+        # Restart node0 but raise minimumchainwork to that of a chain 32256 blocks long\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\", \"-assumevalid=\" + blocks[2100].hash, \"-minimumchainwork=00000000000000000000000000000000000000000000000000007e01acd42dd2\"])\n+\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+        assert_equal(int(node.getbestblockhash(), 16), blocks[2100].sha256)\n+\n+        self.log.info(\"Testing reindex with assumevalid block not in block index\")\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\", \"-assumevalid=\" + blocks[-1].hash])\n+\n+        # node0 should still sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+        assert_equal(int(node.getbestblockhash(), 16), blocks[2100].sha256)\n+\n+        self.log.info(\"Success\")",
      "path": "test/functional/feature_reindex.py",
      "position": 124,
      "original_position": 111,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092011943,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-06-18T11:59:58Z",
      "updated_at": "2025-06-18T11:59:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2154419225",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154419225"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 206,
      "original_line": 206,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154420015",
      "pull_request_review_id": 2938922675,
      "id": 2154420015,
      "node_id": "PRRC_kwDOABII586Aadcv",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the block with invalid signature",
      "path": "test/functional/feature_reindex.py",
      "position": 1,
      "original_position": 76,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092014654,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-06-18T12:00:24Z",
      "updated_at": "2025-06-18T12:00:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2154420015",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154420015"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 158,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2184580600",
      "pull_request_review_id": 2946966884,
      "id": 2184580600,
      "node_id": "PRRC_kwDOABII586CNg34",
      "diff_hunk": "@@ -97,6 +121,87 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        best_blockhash = node.getbestblockhash()\n+        tip = int(best_blockhash, 16)\n+        block_info = node.getblock(best_blockhash)\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the last block\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-assumevalid=\" + blocks[-1].hash])\n+\n+        # Send blocks to node0\n+        p2p0 = node.add_p2p_connection(BaseNode())\n+        p2p0.send_header_for_blocks(blocks[0:2000])\n+        p2p0.send_header_for_blocks(blocks[2000:])\n+        # Only send the first 2100 blocks so the assumevalid block is not saved to disk before we reindex\n+        # This allows us to test that assumevalid is used in reindex even if the assumevalid block was not loaded during reindex\n+        for block in blocks[:2101]:\n+            p2p0.send_without_ping(msg_block(block))\n+        p2p0.sync_with_ping(timeout=960)\n+\n+        expected_height = height - 100\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+\n+        self.log.info(\"Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\")\n+        # Restart node0 but raise minimumchainwork to that of a chain 32256 blocks long",
      "path": "test/functional/feature_reindex.py",
      "position": 1,
      "original_position": 96,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "11a9d55e84af2d6ff138b99310720667cd59dcc3",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "any particular reason for having this high minimum chain work? (ex: for 32256 blocks instead of 3256 blocks). also curious how you computed it?",
      "created_at": "2025-07-04T07:04:49Z",
      "updated_at": "2025-07-04T08:31:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2184580600",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2184580600"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 178,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2184701733",
      "pull_request_review_id": 2946966884,
      "id": 2184701733,
      "node_id": "PRRC_kwDOABII586CN-cl",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):",
      "path": "test/functional/feature_reindex.py",
      "position": 69,
      "original_position": 68,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092020053,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "the tests now take 2m34.878s on my system (was around 18 seconds before).\r\nsince the tests takes much more time now, maybe remove it from the \"Tests less than 30s\" section in `test_runner.py`?",
      "created_at": "2025-07-04T08:15:02Z",
      "updated_at": "2025-07-04T08:31:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2184701733",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2184701733"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 151,
      "original_line": 151,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2185423052",
      "pull_request_review_id": 2987319663,
      "id": 2185423052,
      "node_id": "PRRC_kwDOABII586CQujM",
      "diff_hunk": "@@ -97,6 +121,87 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        best_blockhash = node.getbestblockhash()\n+        tip = int(best_blockhash, 16)\n+        block_info = node.getblock(best_blockhash)\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the last block\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-assumevalid=\" + blocks[-1].hash])\n+\n+        # Send blocks to node0\n+        p2p0 = node.add_p2p_connection(BaseNode())\n+        p2p0.send_header_for_blocks(blocks[0:2000])\n+        p2p0.send_header_for_blocks(blocks[2000:])\n+        # Only send the first 2100 blocks so the assumevalid block is not saved to disk before we reindex\n+        # This allows us to test that assumevalid is used in reindex even if the assumevalid block was not loaded during reindex\n+        for block in blocks[:2101]:\n+            p2p0.send_without_ping(msg_block(block))\n+        p2p0.sync_with_ping(timeout=960)\n+\n+        expected_height = height - 100\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+\n+        self.log.info(\"Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\")\n+        # Restart node0 but raise minimumchainwork to that of a chain 32256 blocks long",
      "path": "test/functional/feature_reindex.py",
      "position": 1,
      "original_position": 96,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "11a9d55e84af2d6ff138b99310720667cd59dcc3",
      "in_reply_to_id": 2184580600,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "For this test, I need  the `minimumchainwork` to be higher than the best_header chainwork. The `height` of the best_header here is `3714`, so the `minimumchainwork` needs to be for a chain considerably higher than `3714` blocks.  Antoine had provided the exact chain work for `32256` blocks in this [stack exchange answer](https://bitcoin.stackexchange.com/questions/26869/what-is-chainwork#66874), so I used that.\r\n\r\nNote that the `minimumchainwork` used doesn't affect the duration of the test, it just checks that the `minimumchainwork` parameter is ignored during the reindex.",
      "created_at": "2025-07-04T13:46:23Z",
      "updated_at": "2025-07-04T13:46:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2185423052",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2185423052"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 178,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2185441225",
      "pull_request_review_id": 2987346540,
      "id": 2185441225,
      "node_id": "PRRC_kwDOABII586CQy_J",
      "diff_hunk": "@@ -97,6 +121,77 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        tip = int(node.getbestblockhash(), 16)\n+        block_info = node.getblock(node.getbestblockhash())\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+        tx.calc_sha256()\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):",
      "path": "test/functional/feature_reindex.py",
      "position": 69,
      "original_position": 68,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "cb29bc3c30ccd14919b4a66bec0c56d9e4adaafa",
      "in_reply_to_id": 2092020053,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@stratospher the test completes much faster on my system, but by checking the timing of other tests, I put it among \"Tests less than 2m\" section because it completes faster than `mining_getblocktemplate_longpoll.py` than slower than `mempool_persist.py`",
      "created_at": "2025-07-04T13:53:30Z",
      "updated_at": "2025-07-04T13:53:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2185441225",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2185441225"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 151,
      "original_line": 151,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2185605623",
      "pull_request_review_id": 2987602616,
      "id": 2185605623,
      "node_id": "PRRC_kwDOABII586CRbH3",
      "diff_hunk": "@@ -97,6 +121,87 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        best_blockhash = node.getbestblockhash()\n+        tip = int(best_blockhash, 16)\n+        block_info = node.getblock(best_blockhash)\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the last block\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-assumevalid=\" + blocks[-1].hash])\n+\n+        # Send blocks to node0\n+        p2p0 = node.add_p2p_connection(BaseNode())\n+        p2p0.send_header_for_blocks(blocks[0:2000])\n+        p2p0.send_header_for_blocks(blocks[2000:])\n+        # Only send the first 2100 blocks so the assumevalid block is not saved to disk before we reindex\n+        # This allows us to test that assumevalid is used in reindex even if the assumevalid block was not loaded during reindex\n+        for block in blocks[:2101]:\n+            p2p0.send_without_ping(msg_block(block))\n+        p2p0.sync_with_ping(timeout=960)\n+\n+        expected_height = height - 100\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+\n+        self.log.info(\"Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\")\n+        # Restart node0 but raise minimumchainwork to that of a chain 32256 blocks long",
      "path": "test/functional/feature_reindex.py",
      "position": 1,
      "original_position": 96,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "11a9d55e84af2d6ff138b99310720667cd59dcc3",
      "in_reply_to_id": 2184580600,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "ah I see, but that's on mainnet and not on regtest, so comment might need an edit. agree that the value doesn't affect the test!",
      "created_at": "2025-07-04T15:09:09Z",
      "updated_at": "2025-07-04T15:09:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2185605623",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2185605623"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 178,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2188910716",
      "pull_request_review_id": 2992079122,
      "id": 2188910716,
      "node_id": "PRRC_kwDOABII586CeCB8",
      "diff_hunk": "@@ -97,6 +121,87 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        best_blockhash = node.getbestblockhash()\n+        tip = int(best_blockhash, 16)\n+        block_info = node.getblock(best_blockhash)\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.sha256\n+\n+        # Start node0 with -assumevalid pointing to the last block\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-assumevalid=\" + blocks[-1].hash])\n+\n+        # Send blocks to node0\n+        p2p0 = node.add_p2p_connection(BaseNode())\n+        p2p0.send_header_for_blocks(blocks[0:2000])\n+        p2p0.send_header_for_blocks(blocks[2000:])\n+        # Only send the first 2100 blocks so the assumevalid block is not saved to disk before we reindex\n+        # This allows us to test that assumevalid is used in reindex even if the assumevalid block was not loaded during reindex\n+        for block in blocks[:2101]:\n+            p2p0.send_without_ping(msg_block(block))\n+        p2p0.sync_with_ping(timeout=960)\n+\n+        expected_height = height - 100\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+\n+        self.log.info(\"Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\")\n+        # Restart node0 but raise minimumchainwork to that of a chain 32256 blocks long",
      "path": "test/functional/feature_reindex.py",
      "position": 1,
      "original_position": 96,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "11a9d55e84af2d6ff138b99310720667cd59dcc3",
      "in_reply_to_id": 2184580600,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I modified the test to calculate chainwork to be approximately 100 blocks greater than the current `best_header`, and I checked that the test still verifies the expected behaviour. See https://github.com/bitcoin/bitcoin/pull/31615/commits/a53d43bc0f010513b0922ad48d611f402ec0e511",
      "created_at": "2025-07-07T03:51:38Z",
      "updated_at": "2025-07-07T03:52:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2188910716",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2188910716"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 178,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2218278553",
      "pull_request_review_id": 3036675207,
      "id": 2218278553,
      "node_id": "PRRC_kwDOABII586EOD6Z",
      "diff_hunk": "@@ -97,6 +121,90 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        best_blockhash = node.getbestblockhash()\n+        tip = int(best_blockhash, 16)\n+        block_info = node.getblock(best_blockhash)\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.sha256",
      "path": "test/functional/feature_reindex.py",
      "position": 1,
      "original_position": 65,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "a53d43bc0f010513b0922ad48d611f402ec0e511",
      "in_reply_to_id": null,
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "                                   AttributeError: 'CBlock' object has no attribute 'sha256'",
      "created_at": "2025-07-21T06:06:47Z",
      "updated_at": "2025-07-21T06:06:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2218278553",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2218278553"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 147,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2219951005",
      "pull_request_review_id": 3039244807,
      "id": 2219951005,
      "node_id": "PRRC_kwDOABII586EUcOd",
      "diff_hunk": "@@ -2485,9 +2485,15 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  that are hardly doing any signature verification at all in testing without having to\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n-                //  least as good as the expected chain.\n+                // least as good as the expected chain.",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 14,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: the leading space was deliberate, it's used in other sentences as well to signal that it's a continuation. \r\nWe can either keep this style or remove it from this block comment, but only removing it on this line only is inconsistent. For simplicity and diff minimization I'd just revert this line.",
      "created_at": "2025-07-21T18:27:57Z",
      "updated_at": "2025-07-21T19:01:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2219951005",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2219951005"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2488,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2219955595",
      "pull_request_review_id": 3039244807,
      "id": 2219955595,
      "node_id": "PRRC_kwDOABII586EUdWL",
      "diff_hunk": "@@ -1218,6 +1218,21 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n {\n     ImportingNow imp{chainman.m_blockman.m_importing};\n \n+    auto activate_all_chainstate = [&]() {",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: we don't need to drag all context into the lambda, consider (+ `()` is redundant):\r\n```suggestion\r\n    auto activate_all_chainstate = [&chainman] {\r\n```",
      "created_at": "2025-07-21T18:30:32Z",
      "updated_at": "2025-07-21T19:01:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2219955595",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2219955595"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2219977333",
      "pull_request_review_id": 3039244807,
      "id": 2219977333,
      "node_id": "PRRC_kwDOABII586EUip1",
      "diff_hunk": "@@ -1241,6 +1256,11 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n             }\n             nFile++;\n         }\n+\n+        // Call ActivateBestChain before setting m_blockfiles_indexed so we can skip script verification\n+        // during reindex if assumevalid is enabled\n+        activate_all_chainstate();",
      "path": "src/node/blockstorage.cpp",
      "position": 29,
      "original_position": 29,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "could we do this change in a separate commit, explaining in the commit messages separately why this needed?\r\nAnd I might be wrong here but I don't understand why we need to run this twice - which is the case for reindex as far as I can tell.",
      "created_at": "2025-07-21T18:42:04Z",
      "updated_at": "2025-07-21T19:01:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2219977333",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2219977333"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1262,
      "original_line": 1262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2219981258",
      "pull_request_review_id": 3039244807,
      "id": 2219981258,
      "node_id": "PRRC_kwDOABII586EUjnK",
      "diff_hunk": "@@ -1263,18 +1283,7 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n         }\n     }\n \n-    // scan for better chains in the block chain database, that are not yet connected in the active best chain\n-\n-    // We can't hold cs_main during ActivateBestChain even though we're accessing\n-    // the chainman unique_ptrs since ABC requires us not to be holding cs_main, so retrieve\n-    // the relevant pointers before the ABC call.\n-    for (Chainstate* chainstate : WITH_LOCK(::cs_main, return chainman.GetAll())) {\n-        BlockValidationState state;\n-        if (!chainstate->ActivateBestChain(state, nullptr)) {\n-            chainman.GetNotifications().fatalError(strprintf(_(\"Failed to connect best block (%s).\"), state.ToString()));\n-            return;\n-        }\n-    }\n+    activate_all_chainstate();\n     // End scope of ImportingNow",
      "path": "src/node/blockstorage.cpp",
      "position": 56,
      "original_position": 51,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "does this comment still make sense?",
      "created_at": "2025-07-21T18:44:27Z",
      "updated_at": "2025-07-21T19:01:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2219981258",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2219981258"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1292,
      "original_line": 1292,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2220008096",
      "pull_request_review_id": 3039244807,
      "id": 2220008096,
      "node_id": "PRRC_kwDOABII586EUqKg",
      "diff_hunk": "@@ -97,6 +121,90 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid",
      "path": "test/functional/feature_reindex.py",
      "position": 42,
      "original_position": 42,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "pretty good test, it covers every new added line!",
      "created_at": "2025-07-21T18:58:39Z",
      "updated_at": "2025-07-21T19:01:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2220008096",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2220008096"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 124,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2220011447",
      "pull_request_review_id": 3039244807,
      "id": 2220011447,
      "node_id": "PRRC_kwDOABII586EUq-3",
      "diff_hunk": "@@ -103,6 +103,7 @@\n     'p2p_segwit.py',\n     'feature_maxuploadtarget.py',\n     'feature_assumeutxo.py',\n+    'feature_reindex.py',",
      "path": "test/functional/test_runner.py",
      "position": 4,
      "original_position": 4,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What's the reason for moving this? If it's needed, could you add it to the commit message?",
      "created_at": "2025-07-21T19:00:45Z",
      "updated_at": "2025-07-21T19:01:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2220011447",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2220011447"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 107,
      "original_line": 107,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2221561291",
      "pull_request_review_id": 3041618947,
      "id": 2221561291,
      "node_id": "PRRC_kwDOABII586EalXL",
      "diff_hunk": "@@ -1263,18 +1283,7 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n         }\n     }\n \n-    // scan for better chains in the block chain database, that are not yet connected in the active best chain\n-\n-    // We can't hold cs_main during ActivateBestChain even though we're accessing\n-    // the chainman unique_ptrs since ABC requires us not to be holding cs_main, so retrieve\n-    // the relevant pointers before the ABC call.\n-    for (Chainstate* chainstate : WITH_LOCK(::cs_main, return chainman.GetAll())) {\n-        BlockValidationState state;\n-        if (!chainstate->ActivateBestChain(state, nullptr)) {\n-            chainman.GetNotifications().fatalError(strprintf(_(\"Failed to connect best block (%s).\"), state.ToString()));\n-            return;\n-        }\n-    }\n+    activate_all_chainstate();\n     // End scope of ImportingNow",
      "path": "src/node/blockstorage.cpp",
      "position": 56,
      "original_position": 51,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": 2219981258,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, it does. The ImportingNow object is destroyed at the end of the function.",
      "created_at": "2025-07-22T07:51:49Z",
      "updated_at": "2025-07-22T07:51:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2221561291",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2221561291"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1292,
      "original_line": 1292,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2221693565",
      "pull_request_review_id": 3041812852,
      "id": 2221693565,
      "node_id": "PRRC_kwDOABII586EbFp9",
      "diff_hunk": "@@ -103,6 +103,7 @@\n     'p2p_segwit.py',\n     'feature_maxuploadtarget.py',\n     'feature_assumeutxo.py',\n+    'feature_reindex.py',",
      "path": "test/functional/test_runner.py",
      "position": 4,
      "original_position": 4,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": 2220011447,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-07-22T08:28:24Z",
      "updated_at": "2025-07-22T08:28:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2221693565",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2221693565"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 107,
      "original_line": 107,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2221785394",
      "pull_request_review_id": 3041937935,
      "id": 2221785394,
      "node_id": "PRRC_kwDOABII586EbcEy",
      "diff_hunk": "@@ -1241,6 +1256,11 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n             }\n             nFile++;\n         }\n+\n+        // Call ActivateBestChain before setting m_blockfiles_indexed so we can skip script verification\n+        // during reindex if assumevalid is enabled\n+        activate_all_chainstate();",
      "path": "src/node/blockstorage.cpp",
      "position": 29,
      "original_position": 29,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": 2219977333,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`ImportBlocks` first tries to load blocks from existing block files during the reindex process. After the reindex process, it tries to load any external blocks provided by the user. We only want to force the use of assumevalid(if set) during the reindex process, not when loading external blocks.\r\n\r\nWe call `activate_all_chainstate` the first time, during the reindex process. This allows us to skip script checks using modified assumevalid rules for reindex.\r\nWe call `activate_all_chainstate` the second time, after external blocks have been loaded, so we can search for better chains among the new blocks. If no external blocks were loaded `activate_all_chainstate` will have no effect.\r\n\r\nI have added a comment explaining that the second call will have no effect if no external blocks were imported.\r\n\r\nI am not convinced that this should be in a separate commit. This change only makes sense in the context of this commit.",
      "created_at": "2025-07-22T08:54:47Z",
      "updated_at": "2025-08-13T11:29:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2221785394",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2221785394"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1262,
      "original_line": 1262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2223342500",
      "pull_request_review_id": 3044142789,
      "id": 2223342500,
      "node_id": "PRRC_kwDOABII586EhYOk",
      "diff_hunk": "@@ -1263,18 +1283,10 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n         }\n     }\n \n-    // scan for better chains in the block chain database, that are not yet connected in the active best chain\n-\n-    // We can't hold cs_main during ActivateBestChain even though we're accessing\n-    // the chainman unique_ptrs since ABC requires us not to be holding cs_main, so retrieve\n-    // the relevant pointers before the ABC call.\n-    for (Chainstate* chainstate : WITH_LOCK(::cs_main, return chainman.GetAll())) {\n-        BlockValidationState state;\n-        if (!chainstate->ActivateBestChain(state, nullptr)) {\n-            chainman.GetNotifications().fatalError(strprintf(_(\"Failed to connect best block (%s).\"), state.ToString()));\n-            return;\n-        }\n-    }\n+    // Call activate_all_chainstate() again, after loading blocks from files,\n+    // If no blocks were imported, ActivateBestChain will nothing to do",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "89b5b607e3380ff2cf03d8199c70e655e8c265cb",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\r\n    // If no blocks were imported, ActivateBestChain will have nothing to do\r\n```",
      "created_at": "2025-07-22T17:39:23Z",
      "updated_at": "2025-07-22T17:46:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2223342500",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2223342500"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2223343368",
      "pull_request_review_id": 3044142789,
      "id": 2223343368,
      "node_id": "PRRC_kwDOABII586EhYcI",
      "diff_hunk": "@@ -2486,8 +2486,14 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n                 //  least as good as the expected chain.\n+                // During a reindex, skip the minimumchainwork check because the previous IBD run may have been interrupted\n+                //  before it could connect enough blocks to reach the minimumchainwork.\n                 fScriptChecks = (GetBlockProofEquivalentTime(*m_chainman.m_best_header, *pindex, *m_chainman.m_best_header, params.GetConsensus()) <= 60 * 60 * 24 * 7 * 2);\n             }\n+        } else if (m_chainman.m_blockman.IsReindexing()) {\n+            // During a reindex, the assumed valid block may not be in the index\n+            // if the previous IBD run was interrupted before it downloaded the assume valid block.",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 19,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "89b5b607e3380ff2cf03d8199c70e655e8c265cb",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "To be consistent with previous line:\r\n```suggestion\r\n            // if the previous IBD run was interrupted before it downloaded the assumed valid block.\r\n```",
      "created_at": "2025-07-22T17:39:47Z",
      "updated_at": "2025-07-22T17:46:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2223343368",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2223343368"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2495,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2223351892",
      "pull_request_review_id": 3044142789,
      "id": 2223351892,
      "node_id": "PRRC_kwDOABII586EhahU",
      "diff_hunk": "",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "25b875a95c8059acedbdc2c5d9372f800f5a6863",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Commit message is inconsistent with comments: `assumedvalid block` is written in your code as `assumed valid block`. I would be fine with `assumevalid block` as well, as long as they're consistent.\r\n\r\nnit: sentence ends in `full block yet` - we could add a fullstop.",
      "created_at": "2025-07-22T17:43:33Z",
      "updated_at": "2025-07-22T17:46:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2223351892",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2223351892"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2224573243",
      "pull_request_review_id": 3045905296,
      "id": 2224573243,
      "node_id": "PRRC_kwDOABII586EmEs7",
      "diff_hunk": "@@ -1263,18 +1283,10 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n         }\n     }\n \n-    // scan for better chains in the block chain database, that are not yet connected in the active best chain\n-\n-    // We can't hold cs_main during ActivateBestChain even though we're accessing\n-    // the chainman unique_ptrs since ABC requires us not to be holding cs_main, so retrieve\n-    // the relevant pointers before the ABC call.\n-    for (Chainstate* chainstate : WITH_LOCK(::cs_main, return chainman.GetAll())) {\n-        BlockValidationState state;\n-        if (!chainstate->ActivateBestChain(state, nullptr)) {\n-            chainman.GetNotifications().fatalError(strprintf(_(\"Failed to connect best block (%s).\"), state.ToString()));\n-            return;\n-        }\n-    }\n+    // Call activate_all_chainstate() again, after loading blocks from files,\n+    // If no blocks were imported, ActivateBestChain will nothing to do",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "89b5b607e3380ff2cf03d8199c70e655e8c265cb",
      "in_reply_to_id": 2223342500,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-07-23T06:47:58Z",
      "updated_at": "2025-07-23T06:47:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2224573243",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2224573243"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2224573495",
      "pull_request_review_id": 3045905674,
      "id": 2224573495,
      "node_id": "PRRC_kwDOABII586EmEw3",
      "diff_hunk": "@@ -2486,8 +2486,14 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n                 //  least as good as the expected chain.\n+                // During a reindex, skip the minimumchainwork check because the previous IBD run may have been interrupted\n+                //  before it could connect enough blocks to reach the minimumchainwork.\n                 fScriptChecks = (GetBlockProofEquivalentTime(*m_chainman.m_best_header, *pindex, *m_chainman.m_best_header, params.GetConsensus()) <= 60 * 60 * 24 * 7 * 2);\n             }\n+        } else if (m_chainman.m_blockman.IsReindexing()) {\n+            // During a reindex, the assumed valid block may not be in the index\n+            // if the previous IBD run was interrupted before it downloaded the assume valid block.",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 19,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "89b5b607e3380ff2cf03d8199c70e655e8c265cb",
      "in_reply_to_id": 2223343368,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-07-23T06:48:08Z",
      "updated_at": "2025-07-23T06:48:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2224573495",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2224573495"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2495,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2224573797",
      "pull_request_review_id": 3045906096,
      "id": 2224573797,
      "node_id": "PRRC_kwDOABII586EmE1l",
      "diff_hunk": "",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "25b875a95c8059acedbdc2c5d9372f800f5a6863",
      "in_reply_to_id": 2223351892,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-07-23T06:48:18Z",
      "updated_at": "2025-07-23T06:48:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2224573797",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2224573797"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2342658393",
      "pull_request_review_id": 3214117877,
      "id": 2342658393,
      "node_id": "PRRC_kwDOABII586LoiFZ",
      "diff_hunk": "@@ -2486,8 +2486,14 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n                 //  least as good as the expected chain.\n+                // During a reindex, skip the minimumchainwork check because the previous IBD run may have been interrupted\n+                //  before it could connect enough blocks to reach the minimumchainwork.",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 14,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "6923417e0990af3ac1a99da7559236eedf5ad833",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The minimumchainwork [should match](https://github.com/bitcoin-core/bitcoin-maintainer-tools/blob/f36fa930bb99e332f2ccb9f76a42ea721850feb8/release-prep.sh#L151-L160) the assumevalid block, so if minimumchainwork isn't reached the assumevalid block won't be present and this code block won't be executed.\r\n\r\nSo this is only relevant for reindexing when you're manually choosing an older assumevalid block than the default, and aren't also adjusting the minchainwork. (If you choose a more recent assumevalid block, then the default minchainwork will be satisfied anyway)",
      "created_at": "2025-09-12T00:49:57Z",
      "updated_at": "2025-09-12T00:49:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2342658393",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2342658393"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2490,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2348327967",
      "pull_request_review_id": 3223582077,
      "id": 2348327967,
      "node_id": "PRRC_kwDOABII586L-KQf",
      "diff_hunk": "@@ -2486,8 +2486,14 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n                 //  least as good as the expected chain.\n+                // During a reindex, skip the minimumchainwork check because the previous IBD run may have been interrupted\n+                //  before it could connect enough blocks to reach the minimumchainwork.",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 14,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "6923417e0990af3ac1a99da7559236eedf5ad833",
      "in_reply_to_id": 2342658393,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think it still makes sense to account for this scenario since minimumchainwork and assumevalid block are set separately. I'll update the comment to explain that minimumchainwork only needs to be skipped if you set an older assumevalid block without also reducing the minimumchainwork.",
      "created_at": "2025-09-15T09:00:59Z",
      "updated_at": "2025-09-15T09:00:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2348327967",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2348327967"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2490,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2380061485",
      "pull_request_review_id": 3269093414,
      "id": 2380061485,
      "node_id": "PRRC_kwDOABII586N3Nst",
      "diff_hunk": "@@ -2449,8 +2449,17 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n                 //  least as good as the expected chain.\n+                // The minimumchainwork threshold is typically aligned with the assumevalid block height.\n+                // However, if assumevalid points to an older block while minimumchainwork remains high,\n+                //  we may find the assumevalid block in our index before accumulating sufficient chainwork.\n+                // Therefore, during reindex operations, we bypass the minimumchainwork check since a prior IBD\n+                //  may have been interrupted before reaching the required chainwork threshold.\n                 fScriptChecks = (GetBlockProofEquivalentTime(*m_chainman.m_best_header, *pindex, *m_chainman.m_best_header, params.GetConsensus()) <= 60 * 60 * 24 * 7 * 2);\n             }\n+        } else if (m_chainman.m_blockman.IsReindexing()) {\n+            // During a reindex, the assumed valid block may not be in the index",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "06ab0844367eb7b1d609967b9f09fe690f73c7a8",
      "original_commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "While the change does seem to fix my personal experience of unexpected script validations, I don't yet understand why reindex does this in the first place - can we fix that instead of adding extra conditions to the script validation checks? Seems a bit hacky and only solves part of the problem, doesn't it?",
      "created_at": "2025-09-25T18:59:48Z",
      "updated_at": "2025-09-25T18:59:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2380061485",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2380061485"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2460,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2381229968",
      "pull_request_review_id": 3270653872,
      "id": 2381229968,
      "node_id": "PRRC_kwDOABII586N7q-Q",
      "diff_hunk": "@@ -2449,8 +2449,17 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n                 //  least as good as the expected chain.\n+                // The minimumchainwork threshold is typically aligned with the assumevalid block height.\n+                // However, if assumevalid points to an older block while minimumchainwork remains high,\n+                //  we may find the assumevalid block in our index before accumulating sufficient chainwork.\n+                // Therefore, during reindex operations, we bypass the minimumchainwork check since a prior IBD\n+                //  may have been interrupted before reaching the required chainwork threshold.\n                 fScriptChecks = (GetBlockProofEquivalentTime(*m_chainman.m_best_header, *pindex, *m_chainman.m_best_header, params.GetConsensus()) <= 60 * 60 * 24 * 7 * 2);\n             }\n+        } else if (m_chainman.m_blockman.IsReindexing()) {\n+            // During a reindex, the assumed valid block may not be in the index",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "06ab0844367eb7b1d609967b9f09fe690f73c7a8",
      "original_commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "in_reply_to_id": 2380061485,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Looks like you are suggesting we do something more invasive. Can you clarify what you mean?\r\nI do not believe something more invasive is required since this simple fix works, but I'm happy to hear what others think. ",
      "created_at": "2025-09-26T07:49:40Z",
      "updated_at": "2025-09-26T07:49:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2381229968",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2381229968"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2460,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2383126356",
      "pull_request_review_id": 3273333938,
      "id": 2383126356,
      "node_id": "PRRC_kwDOABII586OC59U",
      "diff_hunk": "@@ -2449,8 +2449,17 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n                 //  least as good as the expected chain.\n+                // The minimumchainwork threshold is typically aligned with the assumevalid block height.\n+                // However, if assumevalid points to an older block while minimumchainwork remains high,\n+                //  we may find the assumevalid block in our index before accumulating sufficient chainwork.\n+                // Therefore, during reindex operations, we bypass the minimumchainwork check since a prior IBD\n+                //  may have been interrupted before reaching the required chainwork threshold.\n                 fScriptChecks = (GetBlockProofEquivalentTime(*m_chainman.m_best_header, *pindex, *m_chainman.m_best_header, params.GetConsensus()) <= 60 * 60 * 24 * 7 * 2);\n             }\n+        } else if (m_chainman.m_blockman.IsReindexing()) {\n+            // During a reindex, the assumed valid block may not be in the index",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "06ab0844367eb7b1d609967b9f09fe690f73c7a8",
      "original_commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "in_reply_to_id": 2380061485,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Not necessarily, but it bothers me that we (or at least I) don't understand what's causing the problem in the first place, the current solution feels like a work-around to me - which is still better than what we had, but it's also arguably more complicated and it doesn't seem to fix the underlying problem of why reindex is missing headers in the first place. And are we sure it's a reindex-only bug or can it happen for reindex-chainstate or IBD as well? I haven't dug too deep into this, but I want it to be fixed and was wondering if the apparent lack of interest in the reviews is because others also felt it's a workaround. Thanks for working on this.",
      "created_at": "2025-09-26T18:06:41Z",
      "updated_at": "2025-09-26T18:06:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2383126356",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2383126356"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2460,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2383171731",
      "pull_request_review_id": 3273399843,
      "id": 2383171731,
      "node_id": "PRRC_kwDOABII586ODFCT",
      "diff_hunk": "@@ -2449,8 +2449,17 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n                 //  artificially set the default assumed verified block further back.\n                 // The test against the minimum chain work prevents the skipping when denied access to any chain at\n                 //  least as good as the expected chain.\n+                // The minimumchainwork threshold is typically aligned with the assumevalid block height.\n+                // However, if assumevalid points to an older block while minimumchainwork remains high,\n+                //  we may find the assumevalid block in our index before accumulating sufficient chainwork.\n+                // Therefore, during reindex operations, we bypass the minimumchainwork check since a prior IBD\n+                //  may have been interrupted before reaching the required chainwork threshold.\n                 fScriptChecks = (GetBlockProofEquivalentTime(*m_chainman.m_best_header, *pindex, *m_chainman.m_best_header, params.GetConsensus()) <= 60 * 60 * 24 * 7 * 2);\n             }\n+        } else if (m_chainman.m_blockman.IsReindexing()) {\n+            // During a reindex, the assumed valid block may not be in the index",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "06ab0844367eb7b1d609967b9f09fe690f73c7a8",
      "original_commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "in_reply_to_id": 2380061485,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Not necessarily, but it bothers me that we (or at least I) don't understand what's causing the problem in the first place\r\n\r\nI tried to describe this in the linked issue, I think the problem is understood. To rephrase it:\r\n\r\nNormal IBD has the order 1) Download entire header chain until we have crossed minchainwork 2) Start downloading blocks \r\n=> assumevalid will be applied because we have a header with minchainwork and the assumevalid block in our index\r\n\r\nDuring reindex, we 1) Delete all existing headers 2) Read blocks and headers of just the blocks we have saved on disk 3) Start connecting blocks - without ever downloading the full header chain from peers.\r\n\r\nSo if we didn't have the assumevalid block / a minchainwork full block on disk before starting the reindex (because we didn't get that far in our previous IBD) assumevalid will not be applied.",
      "created_at": "2025-09-26T18:29:16Z",
      "updated_at": "2025-09-26T18:32:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2383171731",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2383171731"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2460,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2426025067",
      "pull_request_review_id": 3331162428,
      "id": 2426025067,
      "node_id": "PRRC_kwDOABII586QmjRr",
      "diff_hunk": "@@ -1241,6 +1256,11 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n             }\n             nFile++;\n         }\n+\n+        // Call ActivateBestChain before setting m_blockfiles_indexed so we can skip script verification\n+        // during reindex if assumevalid is enabled\n+        activate_all_chainstate();",
      "path": "src/node/blockstorage.cpp",
      "position": 29,
      "original_position": 29,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": 2219977333,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'm a bit confused by this change too. Previously we wrote the reindexing flag before starting to connect blocks (through the call to ABC), but now it seems like we are connecting blocks first, and only then writing the reindexing flag again?",
      "created_at": "2025-10-13T11:21:12Z",
      "updated_at": "2025-10-13T11:22:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2426025067",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2426025067"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1262,
      "original_line": 1262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2430339233",
      "pull_request_review_id": 3337308344,
      "id": 2430339233,
      "node_id": "PRRC_kwDOABII586Q3Aih",
      "diff_hunk": "@@ -1263,18 +1283,10 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n         }\n     }\n \n-    // scan for better chains in the block chain database, that are not yet connected in the active best chain\n-\n-    // We can't hold cs_main during ActivateBestChain even though we're accessing\n-    // the chainman unique_ptrs since ABC requires us not to be holding cs_main, so retrieve\n-    // the relevant pointers before the ABC call.\n-    for (Chainstate* chainstate : WITH_LOCK(::cs_main, return chainman.GetAll())) {\n-        BlockValidationState state;\n-        if (!chainstate->ActivateBestChain(state, nullptr)) {\n-            chainman.GetNotifications().fatalError(strprintf(_(\"Failed to connect best block (%s).\"), state.ToString()));\n-            return;\n-        }\n-    }\n+    // Call activate_all_chainstate() again, after loading blocks from files,\n+    // If no blocks were imported, ActivateBestChain will have nothing to do",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "45126d1ed91f521f81dbea54163a5a627e9a0fc3",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think that this comment is misleading, the call is not only here for `-loadblock`.\r\n\r\nThis is (unless `-reindex` is used) the first and only time `ActivateBestChain()` is invoked as part of init. Even without `-reindex` and without `-loadblocks` it does important work: It connects the genesis block on first startup (without which init [cannot finish](https://github.com/bitcoin/bitcoin/blob/db4bde0b0347f5141cd6721895e47400239a30e8/src/init.cpp#L1980-L1995)), and  on later starts it will connect blocks that were eligible to be connected in the previous run, but weren't because of the shutdown interruption (you'll often observe this when restarting nodes during IBD). So the main reason the call needs to be there is so that `ActivateBestChain()` is invoked even if no `-reindex` is specified.",
      "created_at": "2025-10-14T20:17:48Z",
      "updated_at": "2025-10-14T20:32:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2430339233",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2430339233"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2430391932",
      "pull_request_review_id": 3337388877,
      "id": 2430391932,
      "node_id": "PRRC_kwDOABII586Q3NZ8",
      "diff_hunk": "@@ -1241,6 +1256,11 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n             }\n             nFile++;\n         }\n+\n+        // Call ActivateBestChain before setting m_blockfiles_indexed so we can skip script verification\n+        // during reindex if assumevalid is enabled\n+        activate_all_chainstate();",
      "path": "src/node/blockstorage.cpp",
      "position": 29,
      "original_position": 29,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "01e372b25855a21d205c6ded83f6849691111d42",
      "in_reply_to_id": 2219977333,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2430339233 is relevant to this, too. Basically, we want to connect blocks with the reindexing flag set during a reindex, but need a ABC call in the case of no `-reindex`.",
      "created_at": "2025-10-14T20:35:50Z",
      "updated_at": "2025-10-14T20:35:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2430391932",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2430391932"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1262,
      "original_line": 1262,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2431873023",
      "pull_request_review_id": 3339408523,
      "id": 2431873023,
      "node_id": "PRRC_kwDOABII586Q82__",
      "diff_hunk": "@@ -1263,18 +1283,10 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n         }\n     }\n \n-    // scan for better chains in the block chain database, that are not yet connected in the active best chain\n-\n-    // We can't hold cs_main during ActivateBestChain even though we're accessing\n-    // the chainman unique_ptrs since ABC requires us not to be holding cs_main, so retrieve\n-    // the relevant pointers before the ABC call.\n-    for (Chainstate* chainstate : WITH_LOCK(::cs_main, return chainman.GetAll())) {\n-        BlockValidationState state;\n-        if (!chainstate->ActivateBestChain(state, nullptr)) {\n-            chainman.GetNotifications().fatalError(strprintf(_(\"Failed to connect best block (%s).\"), state.ToString()));\n-            return;\n-        }\n-    }\n+    // Call activate_all_chainstate() again, after loading blocks from files,\n+    // If no blocks were imported, ActivateBestChain will have nothing to do",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "45126d1ed91f521f81dbea54163a5a627e9a0fc3",
      "in_reply_to_id": 2430339233,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Thanks for pointing this out. I will update the comment.",
      "created_at": "2025-10-15T09:40:27Z",
      "updated_at": "2025-10-15T09:40:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2431873023",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2431873023"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2445073249",
      "pull_request_review_id": 3356538026,
      "id": 2445073249,
      "node_id": "PRRC_kwDOABII586RvNth",
      "diff_hunk": "@@ -1263,18 +1283,10 @@ void ImportBlocks(ChainstateManager& chainman, std::span<const fs::path> import_\n         }\n     }\n \n-    // scan for better chains in the block chain database, that are not yet connected in the active best chain\n-\n-    // We can't hold cs_main during ActivateBestChain even though we're accessing\n-    // the chainman unique_ptrs since ABC requires us not to be holding cs_main, so retrieve\n-    // the relevant pointers before the ABC call.\n-    for (Chainstate* chainstate : WITH_LOCK(::cs_main, return chainman.GetAll())) {\n-        BlockValidationState state;\n-        if (!chainstate->ActivateBestChain(state, nullptr)) {\n-            chainman.GetNotifications().fatalError(strprintf(_(\"Failed to connect best block (%s).\"), state.ToString()));\n-            return;\n-        }\n-    }\n+    // Call activate_all_chainstate() again, after loading blocks from files,\n+    // If no blocks were imported, ActivateBestChain will have nothing to do",
      "path": "src/node/blockstorage.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "d7e4854990a6eb6974b15de68b3a1fca88521e45",
      "original_commit_id": "45126d1ed91f521f81dbea54163a5a627e9a0fc3",
      "in_reply_to_id": 2430339233,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-10-20T13:46:10Z",
      "updated_at": "2025-10-20T13:46:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2445073249",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2445073249"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2451027360",
      "pull_request_review_id": 3364452726,
      "id": 2451027360,
      "node_id": "PRRC_kwDOABII586SF7Wg",
      "diff_hunk": "@@ -97,6 +121,90 @@ def continue_reindex_after_shutdown(self):\n             node.wait_for_rpc_connection(wait_for_import=False)\n         node.stop_node()\n \n+    # Check that reindex uses -assumevalid\n+    def assume_valid(self):\n+        self.log.info(\"Testing reindex with -assumevalid\")\n+        self.start_node(0)\n+        node = self.nodes[0]\n+        self.generate(node, 1)\n+        coinbase_to_spend = node.getblock(node.getbestblockhash())['tx'][0]\n+        # Generate COINBASE_MATURITY blocks to make the coinbase spendable\n+        self.generate(node, COINBASE_MATURITY)\n+        best_blockhash = node.getbestblockhash()\n+        tip = int(best_blockhash, 16)\n+        block_info = node.getblock(best_blockhash)\n+        block_time = block_info['time'] + 1\n+        height = block_info['height'] + 1\n+        blocks = []\n+\n+        # Create a block with an invalid signature\n+        tx = CTransaction()\n+        tx.vin.append(CTxIn(COutPoint(int(coinbase_to_spend, 16), 0), scriptSig=b\"\"))\n+        tx.vout.append(CTxOut(49 * 10000, CScript([OP_TRUE])))\n+\n+        invalid_block = create_block(tip, create_coinbase(height), block_time, txlist=[tx])\n+        invalid_block.solve()\n+        tip = invalid_block.hash_int\n+        blocks.append(invalid_block)\n+\n+        # Bury that block with roughly two weeks' worth of blocks (2100 blocks) and an extra 100 blocks\n+        for _ in range(2200):\n+            block_time += 1\n+            height += 1\n+            block = create_block(tip, create_coinbase(height), block_time)\n+            block.solve()\n+            blocks.append(block)\n+            tip = block.hash_int\n+\n+        # Start node0 with -assumevalid pointing to the last block\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-assumevalid=\" + blocks[-1].hash_hex])\n+\n+        # Send blocks to node0\n+        p2p0 = node.add_p2p_connection(BaseNode())\n+        p2p0.send_header_for_blocks(blocks[0:2000])\n+        p2p0.send_header_for_blocks(blocks[2000:])\n+        # Only send the first 2100 blocks so the assumevalid block is not saved to disk before we reindex\n+        # This allows us to test that assumevalid is used in reindex even if the assumevalid block was not loaded during reindex\n+        for block in blocks[:2101]:\n+            p2p0.send_without_ping(msg_block(block))\n+        p2p0.sync_with_ping(timeout=960)\n+\n+        expected_height = height - 100\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        assert_equal(node.getblock(node.getbestblockhash())['height'], expected_height)\n+\n+        self.log.info(\"Testing reindex with assumevalid block in block index and minchainwork > best_header chainwork\")\n+        # Restart node0 but raise minimumchainwork to be 100 blocks greater than the chainwork of the best header\n+        best_header_target = int(node.getblock(node.getbestblockhash())['target'], 16)\n+        chainwork = (100 + expected_height) * (2**256) // (best_header_target + 1)\n+        chainwork = format(chainwork, '064x')\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\", \"-assumevalid=\" + blocks[2100].hash_hex, \"-minimumchainwork=\" + chainwork])\n+\n+        # node0 should sync to tip of the chain, ignoring the invalid signature\n+        best_blockhash = node.getbestblockhash()\n+        assert_equal(node.getblock(best_blockhash)['height'], expected_height)\n+        assert_equal(int(best_blockhash, 16), blocks[2100].hash_int)\n+\n+        self.log.info(\"Testing reindex with assumevalid block not in block index\")\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\", \"-assumevalid=\" + blocks[-1].hash_hex])\n+\n+        # node0 should still sync to tip of the chain, ignoring the invalid signature\n+        best_blockhash = node.getbestblockhash()\n+        assert_equal(node.getblock(best_blockhash)['height'], expected_height)\n+        assert_equal(int(best_blockhash, 16), blocks[2100].hash_int)\n+\n+        self.log.info(\"Test reindex without -assumevalid does not skip script validation\")\n+        node.stop_node()\n+        self.start_node(0, extra_args=[\"-reindex\"])\n+        best_blockhash = node.getbestblockhash()\n+        assert_equal(node.getblock(best_blockhash)['height'], block_info['height'])\n+        assert_equal(best_blockhash, block_info['hash'])\n+\n+        self.log.info(\"Success\")",
      "path": "test/functional/feature_reindex.py",
      "position": 124,
      "original_position": 124,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "06ab0844367eb7b1d609967b9f09fe690f73c7a8",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: Few tests report success, the test framework always outputs \"Tests successful\" if the test(s) it runs succeed already, so seems unnecessary.\r\n```\r\nâ‚¿ git grep 'self.log.info(\"Success\")'\r\ntest/functional/feature_pruning.py:        self.log.info(\"Success\")\r\ntest/functional/feature_pruning.py:        self.log.info(\"Success\")\r\ntest/functional/feature_pruning.py:        self.log.info(\"Success\")\r\ntest/functional/feature_pruning.py:        self.log.info(\"Success\")\r\ntest/functional/feature_pruning.py:        self.log.info(\"Success\")\r\ntest/functional/feature_reindex.py:        self.log.info(\"Success\")\r\ntest/functional/feature_reindex.py:        self.log.info(\"Success\")\r\n```",
      "created_at": "2025-10-22T08:57:15Z",
      "updated_at": "2025-11-07T15:52:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2451027360",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2451027360"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 206,
      "original_line": 206,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2502875481",
      "pull_request_review_id": 3364452726,
      "id": 2502875481,
      "node_id": "PRRC_kwDOABII586VLtlZ",
      "diff_hunk": "@@ -2433,13 +2433,22 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         // This setting doesn't force the selection of any particular chain but makes validating some faster by\n         //  effectively caching the result of part of the verification.\n         BlockMap::const_iterator it{m_blockman.m_block_index.find(m_chainman.AssumedValidBlock())};\n-        if (it == m_blockman.m_block_index.end()) {\n+        bool is_present_in_index{it != m_blockman.m_block_index.end()};\n+        bool is_reindexing{m_chainman.m_blockman.IsReindexing()};\n+        if (!is_present_in_index && !is_reindexing) {\n+            // The previous IBD run may have been interrupted before it downloaded the assumevalid block.\n+            // Therefore, bypass this check during a reindex.\n             script_check_reason = \"assumevalid hash not in headers\";\n-        } else if (it->second.GetAncestor(pindex->nHeight) != pindex) {\n+        } else if (is_present_in_index && it->second.GetAncestor(pindex->nHeight) != pindex) {\n             script_check_reason = (pindex->nHeight > it->second.nHeight) ? \"block height above assumevalid height\" : \"block not in assumevalid chain\";\n         } else if (m_chainman.m_best_header->GetAncestor(pindex->nHeight) != pindex) {",
      "path": "src/validation.cpp",
      "position": 14,
      "original_position": 14,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "(Prior to this PR, all `if`'s from here on down expected the current block to be an ancestor of the assumed valid block).",
      "created_at": "2025-11-07T11:13:27Z",
      "updated_at": "2025-11-07T15:52:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2502875481",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2502875481"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2444,
      "original_line": 2444,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2503080190",
      "pull_request_review_id": 3364452726,
      "id": 2503080190,
      "node_id": "PRRC_kwDOABII586VMfj-",
      "diff_hunk": "@@ -2433,13 +2433,22 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         // This setting doesn't force the selection of any particular chain but makes validating some faster by\n         //  effectively caching the result of part of the verification.\n         BlockMap::const_iterator it{m_blockman.m_block_index.find(m_chainman.AssumedValidBlock())};\n-        if (it == m_blockman.m_block_index.end()) {\n+        bool is_present_in_index{it != m_blockman.m_block_index.end()};\n+        bool is_reindexing{m_chainman.m_blockman.IsReindexing()};",
      "path": "src/validation.cpp",
      "position": 6,
      "original_position": 6,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: if we keep these, `const bool` might be nicer, although the scope is small.",
      "created_at": "2025-11-07T11:54:10Z",
      "updated_at": "2025-11-07T15:52:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2503080190",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2503080190"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": 2436,
      "original_start_line": 2436,
      "start_side": "RIGHT",
      "line": 2437,
      "original_line": 2437,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2503513923",
      "pull_request_review_id": 3364452726,
      "id": 2503513923,
      "node_id": "PRRC_kwDOABII586VOJdD",
      "diff_hunk": "@@ -2433,13 +2433,22 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         // This setting doesn't force the selection of any particular chain but makes validating some faster by\n         //  effectively caching the result of part of the verification.\n         BlockMap::const_iterator it{m_blockman.m_block_index.find(m_chainman.AssumedValidBlock())};\n-        if (it == m_blockman.m_block_index.end()) {\n+        bool is_present_in_index{it != m_blockman.m_block_index.end()};\n+        bool is_reindexing{m_chainman.m_blockman.IsReindexing()};\n+        if (!is_present_in_index && !is_reindexing) {\n+            // The previous IBD run may have been interrupted before it downloaded the assumevalid block.\n+            // Therefore, bypass this check during a reindex.\n             script_check_reason = \"assumevalid hash not in headers\";\n-        } else if (it->second.GetAncestor(pindex->nHeight) != pindex) {\n+        } else if (is_present_in_index && it->second.GetAncestor(pindex->nHeight) != pindex) {\n             script_check_reason = (pindex->nHeight > it->second.nHeight) ? \"block height above assumevalid height\" : \"block not in assumevalid chain\";\n         } else if (m_chainman.m_best_header->GetAncestor(pindex->nHeight) != pindex) {\n             script_check_reason = \"block not in best header chain\";\n-        } else if (m_chainman.m_best_header->nChainWork < m_chainman.MinimumChainWork()) {",
      "path": "src/validation.cpp",
      "position": 16,
      "original_position": 16,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "remark:\r\nDidn't get this at first - if *our block is an ancestor of `AssumedValidBlock()`*, why would either of:\r\na) it not being part of the best header chain\r\nb) the best header chain being below minimum chainwork\r\n...make us turn on script checking for this assumevalid ancestor?\r\n\r\nIt's been this way since assumevalid was introduced #9484 / e440ac7ef3b6f3ad1cd8fc7027cece40413202d9.\r\n\r\nI guess a) could be to cover the case where a node runner is instructed by a malicious party to run with an `-assumevalid` hash from a bogus chain fork which has less PoW. If you're off the main fork, we need to make sure you're not on a fork that contains invalid blocks, so we perform full validation.\r\n\r\nb) Could be to handle network eclipse attacks in combination with `-assumevalid` where the malicious party is too lazy to also make users lower the `-minimumchainwork` setting.\r\n\r\nMaybe we could add some clarifying comments to that affect?",
      "created_at": "2025-11-07T13:21:54Z",
      "updated_at": "2025-11-07T15:52:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2503513923",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2503513923"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": 2438,
      "original_start_line": 2438,
      "start_side": "LEFT",
      "line": 2442,
      "original_line": 2442,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2510056357",
      "pull_request_review_id": 3442596022,
      "id": 2510056357,
      "node_id": "PRRC_kwDOABII586VnGul",
      "diff_hunk": "@@ -2433,13 +2433,22 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         // This setting doesn't force the selection of any particular chain but makes validating some faster by\n         //  effectively caching the result of part of the verification.\n         BlockMap::const_iterator it{m_blockman.m_block_index.find(m_chainman.AssumedValidBlock())};\n-        if (it == m_blockman.m_block_index.end()) {\n+        bool is_present_in_index{it != m_blockman.m_block_index.end()};\n+        bool is_reindexing{m_chainman.m_blockman.IsReindexing()};\n+        if (!is_present_in_index && !is_reindexing) {\n+            // The previous IBD run may have been interrupted before it downloaded the assumevalid block.\n+            // Therefore, bypass this check during a reindex.\n             script_check_reason = \"assumevalid hash not in headers\";\n-        } else if (it->second.GetAncestor(pindex->nHeight) != pindex) {\n+        } else if (is_present_in_index && it->second.GetAncestor(pindex->nHeight) != pindex) {\n             script_check_reason = (pindex->nHeight > it->second.nHeight) ? \"block height above assumevalid height\" : \"block not in assumevalid chain\";\n         } else if (m_chainman.m_best_header->GetAncestor(pindex->nHeight) != pindex) {\n             script_check_reason = \"block not in best header chain\";\n-        } else if (m_chainman.m_best_header->nChainWork < m_chainman.MinimumChainWork()) {",
      "path": "src/validation.cpp",
      "position": 16,
      "original_position": 16,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "in_reply_to_id": 2503513923,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "From what I can infer, we use `MinimumChainWork` to set an \"expected chain length\".  This protects the node from any chain that is not at least as good as the set expected chain length, especially when it is eclipsed. Since the assumevalid block is typically set at the `MinimumChainWork` height, it would seem that we can remove the `MinimumChainWork` check from here by checking that the assumevalid block is an ancestor of (or is) the best_header, but in the case that we are using a malicious assumevalid block hash, we can still choose the expected chain by setting our `MinimumChainWork` appropriately. I see this as the last defence against such an attack; the attacker would also have to convince you to also reduce your `MinimumChainWork`. ",
      "created_at": "2025-11-10T11:19:54Z",
      "updated_at": "2025-11-10T11:20:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2510056357",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2510056357"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": 2438,
      "original_start_line": 2438,
      "start_side": "LEFT",
      "line": 2442,
      "original_line": 2442,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2510065160",
      "pull_request_review_id": 3442606064,
      "id": 2510065160,
      "node_id": "PRRC_kwDOABII586VnI4I",
      "diff_hunk": "@@ -2433,13 +2433,22 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         // This setting doesn't force the selection of any particular chain but makes validating some faster by\n         //  effectively caching the result of part of the verification.\n         BlockMap::const_iterator it{m_blockman.m_block_index.find(m_chainman.AssumedValidBlock())};\n-        if (it == m_blockman.m_block_index.end()) {\n+        bool is_present_in_index{it != m_blockman.m_block_index.end()};\n+        bool is_reindexing{m_chainman.m_blockman.IsReindexing()};\n+        if (!is_present_in_index && !is_reindexing) {\n+            // The previous IBD run may have been interrupted before it downloaded the assumevalid block.\n+            // Therefore, bypass this check during a reindex.\n             script_check_reason = \"assumevalid hash not in headers\";\n-        } else if (it->second.GetAncestor(pindex->nHeight) != pindex) {\n+        } else if (is_present_in_index && it->second.GetAncestor(pindex->nHeight) != pindex) {\n             script_check_reason = (pindex->nHeight > it->second.nHeight) ? \"block height above assumevalid height\" : \"block not in assumevalid chain\";\n         } else if (m_chainman.m_best_header->GetAncestor(pindex->nHeight) != pindex) {\n             script_check_reason = \"block not in best header chain\";\n-        } else if (m_chainman.m_best_header->nChainWork < m_chainman.MinimumChainWork()) {",
      "path": "src/validation.cpp",
      "position": 16,
      "original_position": 16,
      "commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "original_commit_id": "55daf0e06078b56a18eb900d0ef0d60ce09aecc6",
      "in_reply_to_id": 2503513923,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I wouldn't mind adding a comment stating this. Reviewers can confirm if it correctly reflects the intent of the code.",
      "created_at": "2025-11-10T11:21:31Z",
      "updated_at": "2025-11-10T11:21:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31615#discussion_r2510065160",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2510065160"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31615"
        }
      },
      "start_line": 2438,
      "original_start_line": 2438,
      "start_side": "LEFT",
      "line": 2442,
      "original_line": 2442,
      "side": "LEFT"
    }
  ]
}