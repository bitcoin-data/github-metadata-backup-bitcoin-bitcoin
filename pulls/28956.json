{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956",
    "id": 1619912580,
    "node_id": "PR_kwDOABII585gjeeE",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/28956",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/28956.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/28956.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
    "number": 28956,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "Nuke adjusted time from validation (attempt 2)",
    "user": {
      "login": "dergoegge",
      "id": 8077169,
      "node_id": "MDQ6VXNlcjgwNzcxNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dergoegge",
      "html_url": "https://github.com/dergoegge",
      "followers_url": "https://api.github.com/users/dergoegge/followers",
      "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
      "organizations_url": "https://api.github.com/users/dergoegge/orgs",
      "repos_url": "https://api.github.com/users/dergoegge/repos",
      "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/dergoegge/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This picks up parts of #25908.\r\n\r\nThe use of adjusted time is removed from validation code while the warning to users if their clock is out of sync with the rest of the network remains.",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2023-11-28T13:26:59Z",
    "updated_at": "2024-07-27T18:06:13Z",
    "closed_at": "2024-01-31T20:58:56Z",
    "mergeable_state": "unknown",
    "merged_at": "2024-01-31T20:58:56Z",
    "merge_commit_sha": "3c13f5d6124d887ebeb7f473d73722b570945130",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "dergoegge:2023-11-nuke-adjtime",
      "ref": "2023-11-nuke-adjtime",
      "sha": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 315023492,
        "node_id": "MDEwOlJlcG9zaXRvcnkzMTUwMjM0OTI=",
        "name": "bitcoin",
        "full_name": "dergoegge/bitcoin",
        "owner": {
          "login": "dergoegge",
          "id": 8077169,
          "node_id": "MDQ6VXNlcjgwNzcxNjk=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/dergoegge",
          "html_url": "https://github.com/dergoegge",
          "followers_url": "https://api.github.com/users/dergoegge/followers",
          "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
          "organizations_url": "https://api.github.com/users/dergoegge/orgs",
          "repos_url": "https://api.github.com/users/dergoegge/repos",
          "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/dergoegge/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/dergoegge/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/dergoegge/bitcoin",
        "archive_url": "https://api.github.com/repos/dergoegge/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/dergoegge/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/dergoegge/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/dergoegge/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/dergoegge/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/dergoegge/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/dergoegge/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/dergoegge/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/dergoegge/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/dergoegge/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/dergoegge/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/dergoegge/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/dergoegge/bitcoin/events",
        "forks_url": "https://api.github.com/repos/dergoegge/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/dergoegge/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/dergoegge/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/dergoegge/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/dergoegge/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/dergoegge/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/dergoegge/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/dergoegge/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/dergoegge/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/dergoegge/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/dergoegge/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/dergoegge/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/dergoegge/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/dergoegge/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/dergoegge/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/dergoegge/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:dergoegge/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/dergoegge/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/dergoegge/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/dergoegge/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/dergoegge/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/dergoegge/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/dergoegge/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/dergoegge/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/dergoegge/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/dergoegge/bitcoin/hooks",
        "svn_url": "https://github.com/dergoegge/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 249107,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-07-20T10:58:36Z",
        "created_at": "2020-11-22T11:41:30Z",
        "updated_at": "2024-04-30T10:49:58Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "651fb034d85eb5db561bfd24b74f7271417defa5",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35668,
        "stargazers_count": 77353,
        "watchers_count": 77353,
        "size": 263928,
        "default_branch": "master",
        "open_issues_count": 670,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-07-27T15:16:22Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-07-27T18:40:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 15,
    "deletions": 29,
    "changed_files": 13,
    "commits": 1,
    "review_comments": 56,
    "comments": 22
  },
  "events": [
    {
      "event": "commented",
      "id": 1829843027,
      "node_id": "IC_kwDOABII585tETBT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1829843027",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T13:27:02Z",
      "updated_at": "2024-01-31T20:48:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28956).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [naumenkogs](https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1914324428), [maflcko](https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1848654967), [stickies-v](https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1852031524), [achow101](https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1919931046) |\n| Concept ACK | [ajtowns](https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1755018341), [RandyMcMillan](https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1832151113), [fanquake](https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1832376788), [Pttn](https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1832799066), [ariard](https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1761497233), [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1875562921), [sr-gi](https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1800831281) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29236](https://github.com/bitcoin/bitcoin/pull/29236) (log: Nuke error(...) by maflcko)\n* [#28339](https://github.com/bitcoin/bitcoin/pull/28339) (validation: improve performance of CheckBlockIndex by mzumsande)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1829843027",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "convert_to_draft",
      "id": 11084370519,
      "node_id": "CTDE_lADOABII5854Eer8zwAAAAKUrhJX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11084370519",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T14:25:20Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11084418634,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKUrs5K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11084418634",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T14:28:59Z"
    },
    {
      "event": "labeled",
      "id": 11084420161,
      "node_id": "LE_lADOABII5854Eer8zwAAAAKUrtRB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11084420161",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T14:29:06Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11085464377,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKUvsM5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11085464377",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T15:46:38Z"
    },
    {
      "event": "ready_for_review",
      "id": 11085467127,
      "node_id": "RFRE_lADOABII5854Eer8zwAAAAKUvs33",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11085467127",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T15:46:50Z"
    },
    {
      "event": "unlabeled",
      "id": 11087759273,
      "node_id": "UNLE_lADOABII5854Eer8zwAAAAKU4cep",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11087759273",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-28T19:18:05Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1831671138,
      "node_id": "IC_kwDOABII585tLRVi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1831671138",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:33Z",
      "updated_at": "2023-11-29T10:58:33Z",
      "author_association": "MEMBER",
      "body": "@ajtowns  @darosior @fanquake @maflcko @naumenkogs You all were interested in the previous PR. Would appreciate your review.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1831671138",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "mentioned",
      "id": 11094818121,
      "node_id": "MEE_lADOABII5854Eer8zwAAAAKVTX1J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818121",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:33Z"
    },
    {
      "event": "subscribed",
      "id": 11094818141,
      "node_id": "SE_lADOABII5854Eer8zwAAAAKVTX1d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818141",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "mentioned",
      "id": 11094818160,
      "node_id": "MEE_lADOABII5854Eer8zwAAAAKVTX1w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818160",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "subscribed",
      "id": 11094818176,
      "node_id": "SE_lADOABII5854Eer8zwAAAAKVTX2A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818176",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "mentioned",
      "id": 11094818190,
      "node_id": "MEE_lADOABII5854Eer8zwAAAAKVTX2O",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818190",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "subscribed",
      "id": 11094818205,
      "node_id": "SE_lADOABII5854Eer8zwAAAAKVTX2d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818205",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "mentioned",
      "id": 11094818238,
      "node_id": "MEE_lADOABII5854Eer8zwAAAAKVTX2-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818238",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "subscribed",
      "id": 11094818267,
      "node_id": "SE_lADOABII5854Eer8zwAAAAKVTX3b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818267",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "mentioned",
      "id": 11094818295,
      "node_id": "MEE_lADOABII5854Eer8zwAAAAKVTX33",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818295",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "subscribed",
      "id": 11094818314,
      "node_id": "SE_lADOABII5854Eer8zwAAAAKVTX4K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11094818314",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T10:58:34Z"
    },
    {
      "event": "reviewed",
      "id": 1755018341,
      "node_id": "PRR_kwDOABII585om3Rl",
      "url": null,
      "actor": null,
      "commit_id": "aec6b138ced9347c36b2e6e00411c6ee0f9aa8df",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1755018341",
      "submitted_at": "2023-11-29T11:34:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11096426918,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKVZgmm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11096426918",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T13:28:41Z"
    },
    {
      "event": "commented",
      "id": 1832151113,
      "node_id": "IC_kwDOABII585tNGhJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1832151113",
      "actor": {
        "login": "RandyMcMillan",
        "id": 152159,
        "node_id": "MDQ6VXNlcjE1MjE1OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/152159?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RandyMcMillan",
        "html_url": "https://github.com/RandyMcMillan",
        "followers_url": "https://api.github.com/users/RandyMcMillan/followers",
        "following_url": "https://api.github.com/users/RandyMcMillan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RandyMcMillan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RandyMcMillan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RandyMcMillan/subscriptions",
        "organizations_url": "https://api.github.com/users/RandyMcMillan/orgs",
        "repos_url": "https://api.github.com/users/RandyMcMillan/repos",
        "events_url": "https://api.github.com/users/RandyMcMillan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RandyMcMillan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T15:36:45Z",
      "updated_at": "2023-11-29T15:36:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "RandyMcMillan",
        "id": 152159,
        "node_id": "MDQ6VXNlcjE1MjE1OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/152159?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RandyMcMillan",
        "html_url": "https://github.com/RandyMcMillan",
        "followers_url": "https://api.github.com/users/RandyMcMillan/followers",
        "following_url": "https://api.github.com/users/RandyMcMillan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RandyMcMillan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RandyMcMillan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RandyMcMillan/subscriptions",
        "organizations_url": "https://api.github.com/users/RandyMcMillan/orgs",
        "repos_url": "https://api.github.com/users/RandyMcMillan/repos",
        "events_url": "https://api.github.com/users/RandyMcMillan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RandyMcMillan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1832151113",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "commented",
      "id": 1832376788,
      "node_id": "IC_kwDOABII585tN9nU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1832376788",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T17:21:12Z",
      "updated_at": "2023-11-29T17:21:12Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1832376788",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "commented",
      "id": 1832799066,
      "node_id": "IC_kwDOABII585tPkta",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1832799066",
      "actor": {
        "login": "Pttn",
        "id": 28868425,
        "node_id": "MDQ6VXNlcjI4ODY4NDI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/28868425?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Pttn",
        "html_url": "https://github.com/Pttn",
        "followers_url": "https://api.github.com/users/Pttn/followers",
        "following_url": "https://api.github.com/users/Pttn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Pttn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Pttn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Pttn/subscriptions",
        "organizations_url": "https://api.github.com/users/Pttn/orgs",
        "repos_url": "https://api.github.com/users/Pttn/repos",
        "events_url": "https://api.github.com/users/Pttn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Pttn/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-29T22:26:33Z",
      "updated_at": "2023-11-29T22:26:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "Pttn",
        "id": 28868425,
        "node_id": "MDQ6VXNlcjI4ODY4NDI1",
        "avatar_url": "https://avatars.githubusercontent.com/u/28868425?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Pttn",
        "html_url": "https://github.com/Pttn",
        "followers_url": "https://api.github.com/users/Pttn/followers",
        "following_url": "https://api.github.com/users/Pttn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Pttn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Pttn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Pttn/subscriptions",
        "organizations_url": "https://api.github.com/users/Pttn/orgs",
        "repos_url": "https://api.github.com/users/Pttn/repos",
        "events_url": "https://api.github.com/users/Pttn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Pttn/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1832799066",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "reviewed",
      "id": 1758318406,
      "node_id": "PRR_kwDOABII585ozc9G",
      "url": null,
      "actor": null,
      "commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1758318406",
      "submitted_at": "2023-11-30T19:44:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "reviewed",
      "id": 1759350317,
      "node_id": "PRR_kwDOABII585o3Y4t",
      "url": null,
      "actor": null,
      "commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1759350317",
      "submitted_at": "2023-12-01T09:17:58Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "reviewed",
      "id": 1759382310,
      "node_id": "PRR_kwDOABII585o3gsm",
      "url": null,
      "actor": null,
      "commit_id": "d283c10c296163cf5492707030d7579ec38c7413",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1759382310",
      "submitted_at": "2023-12-01T09:34:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "reviewed",
      "id": 1761497233,
      "node_id": "PRR_kwDOABII585o_lCR",
      "url": null,
      "actor": null,
      "commit_id": "d283c10c296163cf5492707030d7579ec38c7413",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nI would recommend to add an explicit release note, inciting nodes operators to monitor this new warning, especially if theyâ€™re running time-sensitive apps. Exploiting NTP to target bitcoin has been suggested both in NTP security literature and the time-dilation paper (Iâ€™ve never seen or heard any in the wild, contrary to some BGP attacks in other cryptos though I believe this is fairly practical). E.g\r\n\r\n```\r\nnew local clock monitoring \r\n==========================\r\n\r\nThe notion of adjusted time relying on the median of other network nodes clocks is removed.\r\nInstead, a rolling sample of the time offset from local clock of each of the last 10 outbound\r\npeers is maintained and the median computed. If the yielding result is more or less than\r\n70 min, a node warning is issued.\r\n\r\nThis warning can be consumed by a call to `getblockchaininfo`. If the node is backing an\r\napplication or protocol with stringent time-sensitive requirements and high funds at stake\r\n(e.g a lightning or time-enabled wallet)  it is recommended to periodically run a monitoring\r\njob and in presence of warning automatically notify the operator.\r\n``` ",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1761497233",
      "submitted_at": "2023-12-04T02:27:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11169808698,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKZxcE6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11169808698",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-06T15:18:36Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11170218184,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKZzADI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11170218184",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-06T15:47:49Z"
    },
    {
      "event": "labeled",
      "id": 11172147816,
      "node_id": "LE_lADOABII5854Eer8zwAAAAKZ6XJo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11172147816",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-06T18:25:37Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1769589876,
      "node_id": "PRR_kwDOABII585pecx0",
      "url": null,
      "actor": null,
      "commit_id": "6c65f61b625212e128e5db52cbd80a3b57b1450b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1769589876",
      "submitted_at": "2023-12-07T09:04:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "reviewed",
      "id": 1769618257,
      "node_id": "PRR_kwDOABII585pejtR",
      "url": null,
      "actor": null,
      "commit_id": "569a8797cce6bd1cbb4c3d8362ce300baf250ac8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1769618257",
      "submitted_at": "2023-12-07T09:18:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "reviewed",
      "id": 1769630587,
      "node_id": "PRR_kwDOABII585pemt7",
      "url": null,
      "actor": null,
      "commit_id": "b7364bc832437d95f1e712ed25f25ecb072da66c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1769630587",
      "submitted_at": "2023-12-07T09:25:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11211435280,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKcQO0Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11211435280",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-11T14:44:41Z"
    },
    {
      "event": "commented",
      "id": 1850227162,
      "node_id": "IC_kwDOABII585uSDna",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1850227162",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-11T14:47:52Z",
      "updated_at": "2023-12-11T14:47:52Z",
      "author_association": "MEMBER",
      "body": "Changed the approach.\r\n\r\nThis now still deletes all the adjusted time code and removes it from consensus code but keeps the warning condition for a large median time offset as it is on master. Improvements to the warning can be done in a follow up.\r\n\r\nThis should now be a very straight forward review, since we don't need to discuss a new warning mechanism.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1850227162",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "unlabeled",
      "id": 11212114396,
      "node_id": "UNLE_lADOABII5854Eer8zwAAAAKcS0nc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11212114396",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-11T15:34:47Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1851561925,
      "node_id": "IC_kwDOABII585uXJfF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1851561925",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-12T08:55:30Z",
      "updated_at": "2023-12-12T08:55:30Z",
      "author_association": "MEMBER",
      "body": "Looking at the diff between the two versions, I see these changes:\r\n1. which peers are taken into account (`FEELER`, `ADDRFETCH`, `BLOCKRELAY` are also considered)\r\n2. the 199-bug is brought back\r\n3. fixed addition overflow; an alternative would divide each element by 2 and then add without overflow risk, it saves us the sloppiness `int64_max/2`; but i don't care that much)\r\n\r\nNot sure i see `keeps warning condition for a large median time offset as it is on master`.\r\n\r\nGenerally, while I think it's fine to leave (1) for the latter PR, re-introducing the bug (2) is somewhat unfortunate:\r\n- it's just a bad practice\r\n- even if the bug was anything useful before, it won't be anymore since all we keep is\r\n- i actually think the original diff is easier to review than the bug re-introduction :)\r\n\r\n(3) should be kept for either version of course.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1851561925",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "commented",
      "id": 1851803284,
      "node_id": "IC_kwDOABII585uYEaU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1851803284",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-12T10:54:38Z",
      "updated_at": "2023-12-12T10:54:38Z",
      "author_association": "MEMBER",
      "body": "Removing adjusted time from consensus is a big win. Having time samples received from peers be involved in consensus checks is not great and not effective against NTP based attacks (https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1264632475, https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1271239626). The warning itself is not as interesting to me but most of the review on both #25908 and this PR is about the warning and its threshold.\r\n\r\nI don't want changing the warning (small win) to distract from removing adjusted time from consensus (big win).",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1851803284",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11221921340,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKc4O48",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11221921340",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-12T11:00:42Z"
    },
    {
      "event": "commented",
      "id": 1851813782,
      "node_id": "IC_kwDOABII585uYG-W",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1851813782",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-12T11:01:14Z",
      "updated_at": "2023-12-12T11:01:14Z",
      "author_association": "MEMBER",
      "body": "> an alternative would divide each element by 2 and then add without overflow risk\r\n\r\nDone.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1851813782",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "labeled",
      "id": 11225544047,
      "node_id": "LE_lADOABII5854Eer8zwAAAAKdGDVv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11225544047",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-12T15:48:28Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 1852816465,
      "node_id": "IC_kwDOABII585ub7xR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1852816465",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-12T21:10:21Z",
      "updated_at": "2023-12-12T21:17:21Z",
      "author_association": "MEMBER",
      "body": "> Removing adjusted time from consensus is a big win. Having time samples received from peers be involved in consensus checks is not great and not effective against NTP based attacks (#25908 (comment), #25908 (comment)). The warning itself is not as interesting to me but most of the review on both #25908 and this PR is about the warning and its threshold.\r\n\r\nCurrently, we're adjusting our local clock from the median of the first 199 outbound peers we're connecting to (only the first 199 due to the oddness bug in `AddTimeData()`). In case of the occurence of a NTP-based attack (e.g a malicious network delay on traffic between the local system NTP client and its timeservers), this median-adjusted time mechanism can generate a salvatory warning towards the node operators (the `\"Please check that your computer's date and time are correct!\"`). However, this mechanism comes as a security benefit only if the attack is active when you start your local bitcoind and until the first 199 outbound peers connection have been sampled (which might last for hours / days, given our only 10 outbound connections slots at the moment). So there is a robustness benefit brought by the current adjusted time mechanism and this is has been one of my main concern brought in #25908.\r\n\r\nOn the other hand, this mechanism can allow your outbound peers topology to correct your local time (as used for some consensus rules validation in `ContextualCheckBlockHeader()` ) in the boundaries of -/+ `DEFAULT_MAX_TIME_ADJUSTEMENT`. This exploit assumes youâ€™re able to corrupt or compromise 100 outbound peers (as it's a median), which has to be done in considerations of all our hardenings in `AddrMan` and some low-hashrate capabilities. Those 2 elements in my appreciation present a very high-bar (at least compared to state-of-art practical NTP-based attacks).\r\n\r\nAs such, I reasonably think maintaining the warning mechanism is valuable at the very least to maintain current robustness of our consensus validation code in face of NTP attacks. This always give the chance of node operators noticing time anomalies from their logs, which is welcome robustness if youâ€™re operating a time-sensitive bitcoin infrastructure imo. I think we should be better to keep a large buffer of sampled outbound peers (e.g in the order of 100 outbound peers as right now) for this current change itself, and fix the oddness bug.\r\n\r\nFor sure, we can add additional robustness mechanisms in follow-up PRs, e.g \"random drop\" of sampeld peers time offset to add uncertainty in the eyes of adversaries targeting neutralization of the warning mechanism or including feelers connections in sampled offsets. \r\n\r\n--------------------------------------\r\n\r\nAnother source of concern, the ajdusted-time is implemented by other full-nodes with at least some other real-world economic traffic. If we're modifying our consensus-definition of time, and they stay on the old one, this could be source of consensus discrepancies in some edge scenarios. True, this could be a source of concern for non-upraded Bitcoin Core nodes.\r\n\r\nFrom a deployment viewpoint, my recommendation is to notify on the maling list or bitcoin forums other bitcoin full-nodes  implementations of this change, and some \"rough\" deployment timeline in function of Bitcoin Core's own 27.0 or 28.0 release schedules. I think there is a lesson to be learnt from the old Bitcoin 0.8 LevelDB upgrade.\r\n\r\nSee, btcd code: https://github.com/btcsuite/btcd/blob/master/blockchain/mediantime.go#L74\r\n\r\n```\r\n// medianTime provides an implementation of the MedianTimeSource interface.\r\n// It is limited to maxMedianTimeEntries includes the same buggy behavior as\r\n// the time offset mechanism in Bitcoin Core.  This is necessary because it is\r\n// used in the consensus code.\r\ntype medianTime struct {\r\n        mtx                sync.Mutex\r\n        knownIDs           map[string]struct{}\r\n        offsets            []int64\r\n        offsetSecs         int64\r\n        invalidTimeChecked bool\r\n}\r\n```",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1852816465",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "labeled",
      "id": 11253202416,
      "node_id": "LE_lADOABII5854Eer8zwAAAAKevj3w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11253202416",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-14T21:41:34Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1786684919,
      "node_id": "PRR_kwDOABII585qfqX3",
      "url": null,
      "actor": null,
      "commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Looks like a nice improvement, but still improving my understanding so comments are limited to code review now, and not the concept. It would be helpful if at least some of the commits had a bit more rationale in the description.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1786684919",
      "submitted_at": "2023-12-18T12:11:49Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11277979206,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKgOE5G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11277979206",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-18T15:01:06Z"
    },
    {
      "event": "reviewed",
      "id": 1791903508,
      "node_id": "PRR_kwDOABII585qzkcU",
      "url": null,
      "actor": null,
      "commit_id": "87c577e9742d7154826c755a7fe320f34fd54c81",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1791903508",
      "submitted_at": "2023-12-20T23:59:25Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "commented",
      "id": 1865838565,
      "node_id": "IC_kwDOABII585vNm_l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1865838565",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-21T08:17:28Z",
      "updated_at": "2023-12-21T08:21:48Z",
      "author_association": "MEMBER",
      "body": "I agree with @ariard above we don't want a chain split after relaxing the consensus rule, perhaps this is worthy a discussion on the ML or irc meeting. I think it's safe due to the buggy protection and whatnot, but I'd bring this up for others.\r\n\r\nOtherwise the code looks good.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1865838565",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "review_requested",
      "id": 11311860419,
      "node_id": "RRE_lADOABII5854Eer8zwAAAAKiPUrD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11311860419",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-21T08:17:32Z",
      "requested_reviewer": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 11311860562,
      "node_id": "RRE_lADOABII5854Eer8zwAAAAKiPUtS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11311860562",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-21T08:17:33Z",
      "requested_reviewer": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 11311860693,
      "node_id": "RRE_lADOABII5854Eer8zwAAAAKiPUvV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11311860693",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-21T08:17:34Z",
      "requested_reviewer": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "mentioned",
      "id": 11311915161,
      "node_id": "MEE_lADOABII5854Eer8zwAAAAKiPiCZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11311915161",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-21T08:21:49Z"
    },
    {
      "event": "subscribed",
      "id": 11311915175,
      "node_id": "SE_lADOABII5854Eer8zwAAAAKiPiCn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11311915175",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-21T08:21:49Z"
    },
    {
      "event": "reviewed",
      "id": 1792415804,
      "node_id": "PRR_kwDOABII585q1hg8",
      "url": null,
      "actor": null,
      "commit_id": "87c577e9742d7154826c755a7fe320f34fd54c81",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1792415804",
      "submitted_at": "2023-12-21T08:22:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "reviewed",
      "id": 1793314902,
      "node_id": "PRR_kwDOABII585q49BW",
      "url": null,
      "actor": null,
      "commit_id": "87c577e9742d7154826c755a7fe320f34fd54c81",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, and code LGTM 87c577e9742d7154826c755a7fe320f34fd54c81 (but needs rebase).\r\n\r\nIt is unfortunate that this is not a strict security improvement (by increasing the dependency on the local system clock, which can also be tampered with), but not having consensus rely on a majority of arbitrary peers (phrased very well [here](https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1264632475)) is a worthwhile improvement and in my view probably safer. A wrong system clock should be pretty visible (and cause other issues) anyway, and hardening the system (clock) is not really a task for Core.\r\n\r\nThat said, I think having a good warning system is helpful, if indeed manipulating a user's system clock is feasible (which I'm not  an expert on), but I'm happy to be convinced otherwise on this.\r\n\r\n> perhaps this is worthy a discussion on the ML or irc meeting.\r\n\r\nI agree.\r\n\r\n---\r\n\r\nMy understanding of what nuking network-adjusted time affects:\r\n- block validity and the timestamp of newly created block (template)s\r\n- our assessment of whether we're close to the chaintip (via `PeerManagerImpl::CanDirectFetch()`)\r\n- `HeadersSyncState::m_max_commitments` which represents the maximum number of headers we accept from a peer",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1793314902",
      "submitted_at": "2023-12-21T17:39:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11371902139,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKl0XS7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11371902139",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-02T16:33:04Z"
    },
    {
      "event": "commented",
      "id": 1874258028,
      "node_id": "IC_kwDOABII585vtuhs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1874258028",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-02T16:33:27Z",
      "updated_at": "2024-01-02T16:33:27Z",
      "author_association": "MEMBER",
      "body": "Only rebased for now",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1874258028",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "unlabeled",
      "id": 11372719140,
      "node_id": "UNLE_lADOABII5854Eer8zwAAAAKl3ewk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11372719140",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-02T18:18:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1800902150,
      "node_id": "PRR_kwDOABII585rV5YG",
      "url": null,
      "actor": null,
      "commit_id": "1d226ae1f984c5c808f5c24c431b959cdefa692e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1800902150",
      "submitted_at": "2024-01-02T19:39:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "commented",
      "id": 1875562921,
      "node_id": "IC_kwDOABII585vytGp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1875562921",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-03T15:36:40Z",
      "updated_at": "2024-01-03T15:36:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1875562921",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "reviewed",
      "id": 1800831281,
      "node_id": "PRR_kwDOABII585rVoEx",
      "url": null,
      "actor": null,
      "commit_id": "1d226ae1f984c5c808f5c24c431b959cdefa692e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1800831281",
      "submitted_at": "2024-01-03T16:27:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "reviewed",
      "id": 1802864286,
      "node_id": "PRR_kwDOABII585rdYae",
      "url": null,
      "actor": null,
      "commit_id": "1d226ae1f984c5c808f5c24c431b959cdefa692e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1802864286",
      "submitted_at": "2024-01-03T18:21:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZmOTAzOWY2ZWE4NzZiYWIyYzQwYTA2YTkzZTBkZDA4N2Y0NDVmYTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "tree": {
        "sha": "f02d9c74ad4de3eef6069adab3fb8b4946e1fef1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f02d9c74ad4de3eef6069adab3fb8b4946e1fef1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b1196a9855dcd188a24f393aa2fa21e2d61f061",
          "sha": "4b1196a9855dcd188a24f393aa2fa21e2d61f061",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4b1196a9855dcd188a24f393aa2fa21e2d61f061"
        }
      ],
      "message": "Remove GetAdjustedTime",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2024-01-05T17:16:38Z"
      },
      "author": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2024-01-05T17:16:38Z"
      },
      "sha": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2"
    },
    {
      "event": "labeled",
      "id": 11499948438,
      "node_id": "LE_lADOABII5854Eer8zwAAAAKtc0mW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11499948438",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-16T14:48:46Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11558065730,
      "node_id": "HRFPE_lADOABII5854Eer8zwAAAAKw6hZC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11558065730",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-22T15:06:43Z"
    },
    {
      "event": "renamed",
      "id": 11558070532,
      "node_id": "RTE_lADOABII5854Eer8zwAAAAKw6ikE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11558070532",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-22T15:07:05Z",
      "rename": {
        "from": "Nuke adjusted time (attempt 2)",
        "to": "Nuke adjusted time from validation (attempt 2)"
      }
    },
    {
      "event": "commented",
      "id": 1904214370,
      "node_id": "IC_kwDOABII585xgAFi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1904214370",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-22T15:13:29Z",
      "updated_at": "2024-01-22T15:13:29Z",
      "author_association": "MEMBER",
      "body": "This PR now only removes adjusted time from validation code while keeping all the code for the warning in place as is. A follow-up can change the warning (as it has many problems) but this PR will focus on the removal of adjusted time from consensus.\r\n\r\nRe-implementing the same warning seemed unnecessary (even if it was less code) and prone to bugs.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1904214370",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "reviewed",
      "id": 1838562579,
      "node_id": "PRR_kwDOABII585tlj0T",
      "url": null,
      "actor": null,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK\r\n\r\nI think keeping this diff small and focusing on just the (non-warning) functional behaviour change is the best approach to reduce friction to get more high quality feedback on whether this is indeed a safety improvement (I lean towards yes). Code LGTM ff9039f6ea876bab2c40a06a93e0dd087f445fa2, but I think this warrants a release note since we are changing some security assumptions, making users aware of that seems like the way to go imo.\r\n\r\n--- \r\n\r\nnit: latest force push regressed a couple of includes:\r\n\r\n<details>\r\n<summary>git diff on ff9039f6ea</summary>\r\n\r\n```diff\r\ndiff --git a/src/headerssync.cpp b/src/headerssync.cpp\r\nindex e1dfe10483..e14de004f5 100644\r\n--- a/src/headerssync.cpp\r\n+++ b/src/headerssync.cpp\r\n@@ -5,8 +5,8 @@\r\n #include <headerssync.h>\r\n #include <logging.h>\r\n #include <pow.h>\r\n-#include <timedata.h>\r\n #include <util/check.h>\r\n+#include <util/time.h>\r\n #include <util/vector.h>\r\n \r\n // The two constants below are computed using the simulation script in\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex b426b889cf..8c43377875 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -41,6 +41,7 @@\r\n #include <txrequest.h>\r\n #include <util/check.h>\r\n #include <util/strencodings.h>\r\n+#include <util/time.h>\r\n #include <util/trace.h>\r\n #include <validation.h>\r\n \r\ndiff --git a/src/node/miner.cpp b/src/node/miner.cpp\r\nindex 89498fb976..87f40e993f 100644\r\n--- a/src/node/miner.cpp\r\n+++ b/src/node/miner.cpp\r\n@@ -20,8 +20,8 @@\r\n #include <policy/policy.h>\r\n #include <pow.h>\r\n #include <primitives/transaction.h>\r\n-#include <timedata.h>\r\n #include <util/moneystr.h>\r\n+#include <util/time.h>\r\n #include <validation.h>\r\n \r\n #include <algorithm>\r\ndiff --git a/src/rpc/mining.cpp b/src/rpc/mining.cpp\r\nindex 069a451089..929247d32b 100644\r\n--- a/src/rpc/mining.cpp\r\n+++ b/src/rpc/mining.cpp\r\n@@ -27,11 +27,11 @@\r\n #include <script/descriptor.h>\r\n #include <script/script.h>\r\n #include <script/signingprovider.h>\r\n-#include <timedata.h>\r\n #include <txmempool.h>\r\n #include <univalue.h>\r\n #include <util/strencodings.h>\r\n #include <util/string.h>\r\n+#include <util/time.h>\r\n #include <util/translation.h>\r\n #include <validation.h>\r\n #include <validationinterface.h>\r\ndiff --git a/src/timedata.h b/src/timedata.h\r\nindex 90428d071c..17e7539700 100644\r\n--- a/src/timedata.h\r\n+++ b/src/timedata.h\r\n@@ -5,8 +5,6 @@\r\n #ifndef BITCOIN_TIMEDATA_H\r\n #define BITCOIN_TIMEDATA_H\r\n \r\n-#include <util/time.h>\r\n-\r\n #include <algorithm>\r\n #include <cassert>\r\n #include <chrono>\r\n\r\n```\r\n</details>\r\n",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1838562579",
      "submitted_at": "2024-01-24T13:58:03Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "commented",
      "id": 1912675545,
      "node_id": "IC_kwDOABII585yARzZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1912675545",
      "actor": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-26T20:47:15Z",
      "updated_at": "2024-01-26T20:47:15Z",
      "author_association": "MEMBER",
      "body": "> This PR now only removes adjusted time from validation code while keeping all the code for the warning in place as is. A follow-up can change the warning (as it has many problems) but this PR will focus on the removal of adjusted time from consensus.\r\n> \r\n> Re-implementing the same warning seemed unnecessary (even if it was less code) and prone to bugs.\r\n\r\nDoes this mean that the adjusted time is now being collected and used exclusively to raise the warning?",
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1912675545",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "commented",
      "id": 1912691682,
      "node_id": "IC_kwDOABII585yAVvi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1912691682",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-26T21:02:08Z",
      "updated_at": "2024-01-26T21:02:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Does this mean that the adjusted time is now being collected and used exclusively to raise the warning?\r\n\r\nThis was the case before the force-push, too. In this current approach, the diff is much smaller so review can focus more on whether we're okay removing network-adjusted time, instead of on the adjusted time calculation refactoring.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1912691682",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "unlabeled",
      "id": 11614686559,
      "node_id": "UNLE_lADOABII5854Eer8zwAAAAK0Sg1f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11614686559",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-27T01:59:14Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1914324428,
      "node_id": "IC_kwDOABII585yGkXM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1914324428",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-29T09:46:37Z",
      "updated_at": "2024-01-29T09:46:37Z",
      "author_association": "MEMBER",
      "body": "ACK ff9039f6ea876bab2c40a06a93e0dd087f445fa2\r\n\r\nAfter a few attempts, I haven't found a way to trigger a consensus fork through adjusted time. It's not like this could \"infect\" half of the network (legacy) through block propagation or something. Because of that, if there was/is a legacy way to exploit it (say an overflow in `nTimeOffset` calculation), this new code won't make it worse.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1914324428",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "review_requested",
      "id": 11625141626,
      "node_id": "RRE_lADOABII5854Eer8zwAAAAK06ZV6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11625141626",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-29T09:46:42Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 11625142007,
      "node_id": "RRE_lADOABII5854Eer8zwAAAAK06Zb3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11625142007",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-29T09:46:44Z",
      "requested_reviewer": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 11625142136,
      "node_id": "RRE_lADOABII5854Eer8zwAAAAK06Zd4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11625142136",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-29T09:46:45Z",
      "requested_reviewer": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1848654967,
      "node_id": "PRR_kwDOABII585uMDx3",
      "url": null,
      "actor": null,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "lgtm ACK ff9039f6ea876bab2c40a06a93e0dd087f445fa2 ðŸ¤½\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\nuntrusted comment: signature from minisign secret key on empty file; verify via: minisign -Vm \"${path_to_any_empty_file}\" -P RWTRmVTMeKV5noAMqVlsMugDDCyyTSbA3Re5AkUrhvLVln0tSaFWglOw -x \"${path_to_this_whole_four_line_signature_blob}\"\r\nRUTRmVTMeKV5npGrKx1nqXCw5zeVHdtdYURB/KlyA/LMFgpNCs+SkW9a8N95d+U4AP1RJMi+krxU1A3Yux4bpwZNLvVBKy0wLgM=\r\ntrusted comment: lgtm ACK ff9039f6ea876bab2c40a06a93e0dd087f445fa2 ðŸ¤½\r\nhjCKZbc2j48mFkBbdMp6XYwvC+JpHi9gtElrJyy4RJVJjbMvsAntWQAHbs4leVk6OCxxLaX5X9PRIWR3wRQ/DA==\r\n```\r\n\r\n</details>\r\n",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1848654967",
      "submitted_at": "2024-01-29T13:17:50Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "reviewed",
      "id": 1852031524,
      "node_id": "PRR_kwDOABII585uY8Ik",
      "url": null,
      "actor": null,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK ff9039f6ea876bab2c40a06a93e0dd087f445fa2\r\n\r\nI would prefer the commit message to contain a rationale for the change, though. It's currently empty.\r\n\r\n---\r\n\r\nI now believe that the network-adjusted time implementation in master does not offer any security guarantees against an attacker trying to get a node out of consensus. The existing NTP vulnerabilities (which seem to be very real, even if currently apparently not exploited too often) can just as well be used by an attacker when network-adjusted time is used, given that we limit the network adjustment to 70 minutes. As such, this PR does indeed seem like a strong improvement to me.\r\n\r\nEnsuring an accurate clock is a system responsibility, and should not be a Bitcoin Core concern. Removing this logic simplifies the code, and removes the assumption that we need a majority of honest outbound nodes. Moreover, it seems trivial to implement an external daemon that monitors Bitcoin network time and e.g. adjusts the local clock or shuts down Bitcoin Core when a large offset is detected, for users that wish to harden their system this way.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1852031524",
      "submitted_at": "2024-01-30T18:13:14Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "commented",
      "id": 1919931046,
      "node_id": "IC_kwDOABII585yb9Km",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1919931046",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-31T20:48:37Z",
      "updated_at": "2024-01-31T20:48:37Z",
      "author_association": "MEMBER",
      "body": "ACK ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1919931046",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "merged",
      "id": 11661268434,
      "node_id": "ME_lADOABII5854Eer8zwAAAAK3ENXS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11661268434",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "3c13f5d6124d887ebeb7f473d73722b570945130",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3c13f5d6124d887ebeb7f473d73722b570945130",
      "created_at": "2024-01-31T20:58:56Z"
    },
    {
      "event": "closed",
      "id": 11661268457,
      "node_id": "CE_lADOABII5854Eer8zwAAAAK3ENXp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11661268457",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-31T20:58:56Z"
    },
    {
      "event": "reviewed",
      "id": 1854827936,
      "node_id": "PRR_kwDOABII585ujm2g",
      "url": null,
      "actor": null,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#pullrequestreview-1854827936",
      "submitted_at": "2024-01-31T20:59:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
    },
    {
      "event": "commented",
      "id": 1935077559,
      "node_id": "IC_kwDOABII585zVvC3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1935077559",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T23:12:15Z",
      "updated_at": "2024-02-08T23:12:15Z",
      "author_association": "MEMBER",
      "body": "> After a few attempts, I haven't found a way to trigger a consensus fork through adjusted time.\r\n\r\nUnclear what has been tested actually (e.g setting sampled time of peers in the past and playing with blocks timestamps).\r\nThat said I think itâ€™s a very edge scenario, and most susceptible to affect non-upgraded things like btcd.\r\n\r\n> I now believe that the network-adjusted time implementation in master does not offer any security guarantees against an attacker trying to get a node out of consensus. The existing NTP vulnerabilities (which seem to be very real, even if currently apparently not exploited too often) can just as well be used by an attacker when network-adjusted time is used, given that we limit the network adjustment to 70 minutes.\r\n\r\nNTP has its own data / control plane. Our peers connections going through TCP. You might compromise NTP stack but not TCP and vice-versa.\r\n\r\n> Ensuring an accurate clock is a system responsibility, and should not be a Bitcoin Core concern\r\n\r\nWith argument of that kind we can remove `assumevalid` / `assumeutxo` and say perf issues poor host not core concern.\r\nMore weâ€™re able to compensate weakness from network infrastructure level, better core node ecosystem stronger.\r\n\r\n> Moreover, it seems trivial to implement an external daemon that monitors Bitcoin network time and e.g. adjusts the local clock or shuts down Bitcoin Core when a large offset is detected, for users that wish to harden their system this way.\r\n\r\nIâ€™ll let as an exercise to the reader to define what should be the authoritative source of time of this external monitoring daemon :) My belief we should conserve a a warning system based on other peers nversion announcements.\r\n\r\n@dergoegge I think it can be good if you notify btcd and other validation software carrying a minimum of economic traffic of this change, at least to avoid future issues like the bip68 consensus discrepancy you found recently. ",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1935077559",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "mentioned",
      "id": 11752229386,
      "node_id": "MEE_lADOABII5854Eer8zwAAAAK8fMoK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11752229386",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T23:12:17Z"
    },
    {
      "event": "subscribed",
      "id": 11752229391,
      "node_id": "SE_lADOABII5854Eer8zwAAAAK8fMoP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11752229391",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T23:12:17Z"
    },
    {
      "event": "commented",
      "id": 1935525053,
      "node_id": "IC_kwDOABII585zXcS9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1935525053",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T08:37:35Z",
      "updated_at": "2024-02-09T08:37:35Z",
      "author_association": "MEMBER",
      "body": "> My belief we should conserve a a warning system based on other peers nversion announcements.\r\n\r\nYes, this is exactly what this pull request did. See also the description, which said: \"while the warning to users if their clock is out of sync with the rest of the network remains.\"\r\n\r\nSee also: https://bitcoinops.org/en/newsletters/2024/02/07/#bitcoin-core-28956",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1935525053",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "commented",
      "id": 1937931750,
      "node_id": "IC_kwDOABII585zgn3m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1937931750",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-12T00:26:23Z",
      "updated_at": "2024-02-12T00:26:23Z",
      "author_association": "MEMBER",
      "body": "> Yes, this is exactly what this pull request did. See also the description, which said: \"while the warning to users if their clock is out of sync with the rest of the network remains.â€\r\n\r\nThat I know. It was more related to using an external daemon and naively using the same NTP source than your Bitcoin Core instance. There is no such thing as Bitcoin network time, just a sampling of peers nversion time. Yes it works if this external daemon consumes Core warning messages and takes corrective actions on this. And even that the correction frequency have to be weighted carefully (are you scaling the correction frequency on internal clock itself or received peers msgs ?)\r\n\r\nFYI, some NTP attacks were actually on targeting NTP pool monitoring infrastructure, see this [paper](https://www.usenix.org/system/files/sec23fall-prepub-520-kwon.pdf).",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-1937931750",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    },
    {
      "event": "referenced",
      "id": 12664837109,
      "node_id": "REFE_lADOABII5854Eer8zwAAAALy4hP1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12664837109",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "0c3a3c9394e608c4beb92722ad034648af81dee7",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0c3a3c9394e608c4beb92722ad034648af81dee7",
      "created_at": "2024-04-30T22:49:41Z"
    },
    {
      "event": "commented",
      "id": 2254216150,
      "node_id": "IC_kwDOABII586GXJvW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2254216150",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-27T18:06:12Z",
      "updated_at": "2024-07-27T18:06:12Z",
      "author_association": "MEMBER",
      "body": "For future reference, related: https://bitcoincore.org/en/2024/07/03/disclose-timestamp-overflow.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#issuecomment-2254216150",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28956"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409131058",
      "pull_request_review_id": 1755018341,
      "id": 1409131058,
      "node_id": "PRRC_kwDOABII585T_aIy",
      "diff_hunk": "@@ -84,6 +88,9 @@ class PeerManager : public CValidationInterface, public NetEventsInterface\n     /** Get statistics from node state */\n     virtual bool GetNodeStateStats(NodeId nodeid, CNodeStateStats& stats) const = 0;\n \n+    /** Get stats from peer manager. */\n+    virtual PeerManagerStats GetStats() const = 0;",
      "path": "src/net_processing.h",
      "position": null,
      "original_position": 16,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "cab1cf9c134b15e829ddcea676cc1b5a039ace08",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If you're building a function that collects this info, maybe call it `GetInfo()` and combine it with `IgnoresIncomingTxs()` ?",
      "created_at": "2023-11-29T11:13:45Z",
      "updated_at": "2023-11-29T11:34:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409131058",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409131058"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 92,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409132248",
      "pull_request_review_id": 1755018341,
      "id": 1409132248,
      "node_id": "PRRC_kwDOABII585T_abY",
      "diff_hunk": "@@ -674,7 +673,7 @@ static RPCHelpMan getnetworkinfo()\n     if (node.peerman) {\n         obj.pushKV(\"localrelay\", !node.peerman->IgnoresIncomingTxs());\n     }\n-    obj.pushKV(\"timeoffset\",    GetTimeOffset());\n+    obj.pushKV(\"timeoffset\", node.peerman->GetStats().median_outbound_time_offset);",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "aec6b138ced9347c36b2e6e00411c6ee0f9aa8df",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should be conditional on `node.peerman` being valid, see the previous line.",
      "created_at": "2023-11-29T11:14:45Z",
      "updated_at": "2023-11-29T11:34:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409132248",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409132248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 676,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409140558",
      "pull_request_review_id": 1755018341,
      "id": 1409140558,
      "node_id": "PRRC_kwDOABII585T_cdO",
      "diff_hunk": "@@ -3567,6 +3601,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             // Don't use timedata samples from inbound peers to make it\n             // harder for others to tamper with our adjusted time.\n             AddTimeData(pfrom.addr, peer->m_time_offset);\n+\n+            m_outbound_time_offsets.Add(peer->m_time_offset);",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "71d61076657557f7d7041624e0d959807fa6d786",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Having a rolling set of 10 time offsets from every outbound connection we make (full outbounds, block-relay-only, extra block-relay-only, feelers?) seems somewhat risky: at present, you'll get odd behaviour if a high-proportion of the first 100 outbound peers you connect to have a different time; with this change, you'll get a warning if the last 10 peers you randomly connect to have a dodgy view of the time?\r\n\r\nMaybe consider making this conditional on `IsManualOrFullOutboundConn()` instead; that way it only updates rarely for things we're really trying to connect to, and isn't mostly made up of random peers we're briefly sampling?",
      "created_at": "2023-11-29T11:22:50Z",
      "updated_at": "2023-11-29T11:34:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409140558",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409140558"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3613,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409146055",
      "pull_request_review_id": 1755018341,
      "id": 1409146055,
      "node_id": "PRRC_kwDOABII585T_dzH",
      "diff_hunk": "@@ -3611,6 +3613,12 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             AddTimeData(pfrom.addr, peer->m_time_offset);\n \n             m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();\n+            if (median > TIME_OFFSET_WARN_THRESHOLD.count() ||\n+                median < -TIME_OFFSET_WARN_THRESHOLD.count()) {\n+                SetMiscWarning(Untranslated(\"Please check that your computer's date and time are correct\"));",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "786c562b074324cc81e81a008d2a7e36f9deca7d",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`SetMiscWarning` seems a poor interface; if there's two warnings, the latest one overrides the first, and you can't remove warnings in the event that they resolve themselves. Might be better to do something like `SetfLargeWorkInvalidChainFound(bool)` ?",
      "created_at": "2023-11-29T11:27:50Z",
      "updated_at": "2023-11-29T11:34:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409146055",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409146055"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3620,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409150007",
      "pull_request_review_id": 1755018341,
      "id": 1409150007,
      "node_id": "PRRC_kwDOABII585T_ew3",
      "diff_hunk": "@@ -175,6 +176,7 @@ static constexpr double MAX_ADDR_RATE_PER_SECOND{0.1};\n static constexpr size_t MAX_ADDR_PROCESSING_TOKEN_BUCKET{MAX_ADDR_TO_SEND};\n /** The compactblocks version we support. See BIP 152. */\n static constexpr uint64_t CMPCTBLOCKS_VERSION{2};\n+static constexpr std::chrono::seconds TIME_OFFSET_WARN_THRESHOLD{30min};",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "786c562b074324cc81e81a008d2a7e36f9deca7d",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is reduced from 70min to 30min, compared to `DEFAULT_MAX_TIME_ADJUSTMENT`. 70min avoids warning if you're buggy by an hour due to (you or your peers) getting daylight savings time wrong, which seems like a vaguely plausible thing to continue doing?",
      "created_at": "2023-11-29T11:31:46Z",
      "updated_at": "2023-11-29T11:34:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409150007",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409150007"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 179,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409151223",
      "pull_request_review_id": 1755018341,
      "id": 1409151223,
      "node_id": "PRRC_kwDOABII585T_fD3",
      "diff_hunk": "@@ -497,7 +496,6 @@ void SetupServerArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-maxconnections=<n>\", strprintf(\"Maintain at most <n> automatic connections to peers (default: %u). This limit does not apply to connections manually added via -addnode or the addnode RPC, which have a separate limit of %u.\", DEFAULT_MAX_PEER_CONNECTIONS, MAX_ADDNODE_CONNECTIONS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-maxreceivebuffer=<n>\", strprintf(\"Maximum per-connection receive buffer, <n>*1000 bytes (default: %u)\", DEFAULT_MAXRECEIVEBUFFER), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-maxsendbuffer=<n>\", strprintf(\"Maximum per-connection memory usage for the send buffer, <n>*1000 bytes (default: %u)\", DEFAULT_MAXSENDBUFFER), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n-    argsman.AddArg(\"-maxtimeadjustment\", strprintf(\"Maximum allowed median peer time offset adjustment. Local perspective of time may be influenced by outbound peers forward or backward by this amount (default: %u seconds).\", DEFAULT_MAX_TIME_ADJUSTMENT), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "aec6b138ced9347c36b2e6e00411c6ee0f9aa8df",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Perhaps swap this option for one that controls how much of a time difference results in a warning? Not sure.",
      "created_at": "2023-11-29T11:32:59Z",
      "updated_at": "2023-11-29T11:34:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409151223",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409151223"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 531,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409284495",
      "pull_request_review_id": 1755270180,
      "id": 1409284495,
      "node_id": "PRRC_kwDOABII585T__mP",
      "diff_hunk": "@@ -84,6 +88,9 @@ class PeerManager : public CValidationInterface, public NetEventsInterface\n     /** Get statistics from node state */\n     virtual bool GetNodeStateStats(NodeId nodeid, CNodeStateStats& stats) const = 0;\n \n+    /** Get stats from peer manager. */\n+    virtual PeerManagerStats GetStats() const = 0;",
      "path": "src/net_processing.h",
      "position": null,
      "original_position": 16,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "cab1cf9c134b15e829ddcea676cc1b5a039ace08",
      "in_reply_to_id": 1409131058,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good idea, done!",
      "created_at": "2023-11-29T13:29:54Z",
      "updated_at": "2023-11-29T13:29:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409284495",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409284495"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 92,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409285449",
      "pull_request_review_id": 1755271738,
      "id": 1409285449,
      "node_id": "PRRC_kwDOABII585T__1J",
      "diff_hunk": "@@ -3567,6 +3601,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             // Don't use timedata samples from inbound peers to make it\n             // harder for others to tamper with our adjusted time.\n             AddTimeData(pfrom.addr, peer->m_time_offset);\n+\n+            m_outbound_time_offsets.Add(peer->m_time_offset);",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "71d61076657557f7d7041624e0d959807fa6d786",
      "in_reply_to_id": 1409140558,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Maybe consider making this conditional on IsManualOrFullOutboundConn()\r\n\r\nDone",
      "created_at": "2023-11-29T13:30:42Z",
      "updated_at": "2023-11-29T13:30:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409285449",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409285449"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3613,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409290332",
      "pull_request_review_id": 1755281286,
      "id": 1409290332,
      "node_id": "PRRC_kwDOABII585UABBc",
      "diff_hunk": "@@ -497,7 +496,6 @@ void SetupServerArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-maxconnections=<n>\", strprintf(\"Maintain at most <n> automatic connections to peers (default: %u). This limit does not apply to connections manually added via -addnode or the addnode RPC, which have a separate limit of %u.\", DEFAULT_MAX_PEER_CONNECTIONS, MAX_ADDNODE_CONNECTIONS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-maxreceivebuffer=<n>\", strprintf(\"Maximum per-connection receive buffer, <n>*1000 bytes (default: %u)\", DEFAULT_MAXRECEIVEBUFFER), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-maxsendbuffer=<n>\", strprintf(\"Maximum per-connection memory usage for the send buffer, <n>*1000 bytes (default: %u)\", DEFAULT_MAXSENDBUFFER), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n-    argsman.AddArg(\"-maxtimeadjustment\", strprintf(\"Maximum allowed median peer time offset adjustment. Local perspective of time may be influenced by outbound peers forward or backward by this amount (default: %u seconds).\", DEFAULT_MAX_TIME_ADJUSTMENT), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "aec6b138ced9347c36b2e6e00411c6ee0f9aa8df",
      "in_reply_to_id": 1409151223,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No strong opinion on this, but it doesn't seem very useful to me to be able to set that threshold. Happy to add this if someone can name a good reason.",
      "created_at": "2023-11-29T13:34:19Z",
      "updated_at": "2023-11-29T13:34:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1409290332",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1409290332"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 531,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1411184510",
      "pull_request_review_id": 1758318406,
      "id": 1411184510,
      "node_id": "PRRC_kwDOABII585UHPd-",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Shouldn't this use `min(N, m_index)` instead of `N`?",
      "created_at": "2023-11-30T19:44:45Z",
      "updated_at": "2023-11-30T19:44:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1411184510",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1411184510"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1411821098",
      "pull_request_review_id": 1759350317,
      "id": 1411821098,
      "node_id": "PRRC_kwDOABII585UJq4q",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "122658f95b36b7f940351bd34a89e13831931f18\r\n\r\nshould we make this addition overflow safe?",
      "created_at": "2023-12-01T09:17:58Z",
      "updated_at": "2023-12-01T09:17:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1411821098",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1411821098"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1413301629",
      "pull_request_review_id": 1761497233,
      "id": 1413301629,
      "node_id": "PRRC_kwDOABII585UPUV9",
      "diff_hunk": "@@ -3557,12 +3605,17 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n-        if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n+        peer->m_time_offset = nTime - GetTime();\n+\n+        if (pfrom.IsManualOrFullOutboundConn()) {\n+            // Only sample from outbound connections we are really trying to connect to.\n+            m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 137,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d283c10c296163cf5492707030d7579ec38c7413",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think one advance in term of robustness of this local time monitoring mechanism could be to add feeler â€™s time offset (`ConnectionType::FEELER`) to reserved slots in the index (e.g +3 on the 10 full-outbound connections). Those peers connections are already triggered at regular interval, which is not necessarily the case of outbound peer topology if the peers are stable and performant.\r\n\r\nI guess a NTP-attacker could silently time shift the local clock of a victim, without this warning logic ever triggering if no new outbound or manual connections are ever opened during the exploitation.",
      "created_at": "2023-12-04T02:23:07Z",
      "updated_at": "2023-12-04T02:27:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1413301629",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1413301629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3615,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1413770472",
      "pull_request_review_id": 1762231767,
      "id": 1413770472,
      "node_id": "PRRC_kwDOABII585URGzo",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": 1411184510,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The idea is that `m_index` is always set to the next index in `m_offsets` that gets written to (so a value out of `[0, N)`) and we just assume that the initial N samples were 0, which is why the median is immediately computed out of N.\r\n\r\nI could change it to always increase `m_index` instead and add new offsets by doing `m_offsets[m_index % N] = new_offset`, in which case your suggestion would allow us to compute the median more \"accurately\" while we haven't seen N samples yet. I'm not sure though if that is an improvement,. e.g. do we want to issue a warning if only the first outbound connection has a offset larger than our threshold?",
      "created_at": "2023-12-04T11:56:44Z",
      "updated_at": "2023-12-04T11:56:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1413770472",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1413770472"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1413773031",
      "pull_request_review_id": 1762238037,
      "id": 1413773031,
      "node_id": "PRRC_kwDOABII585URHbn",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": 1411821098,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Hm yea I guess... I could also just remove support for even `N`s from this class.",
      "created_at": "2023-12-04T11:58:49Z",
      "updated_at": "2023-12-04T16:37:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1413773031",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1413773031"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1415130119",
      "pull_request_review_id": 1764352235,
      "id": 1415130119,
      "node_id": "PRRC_kwDOABII585UWSwH",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": 1411184510,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ">do we want to issue a warning if only the first outbound connection has a offset larger than our threshold?\r\n\r\nThis is the main question I guess.\r\nSo, with the current code, having 4 peers would never trigger it, right? Because median will always be 0.",
      "created_at": "2023-12-05T08:31:51Z",
      "updated_at": "2023-12-05T08:31:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1415130119",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1415130119"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1415132157",
      "pull_request_review_id": 1764355275,
      "id": 1415132157,
      "node_id": "PRRC_kwDOABII585UWTP9",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": 1411821098,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "i won't mind that either, but ideally with an in-function comment.",
      "created_at": "2023-12-05T08:32:27Z",
      "updated_at": "2023-12-05T08:32:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1415132157",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1415132157"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417498148",
      "pull_request_review_id": 1767854381,
      "id": 1417498148,
      "node_id": "PRRC_kwDOABII585UfU4k",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": 1411184510,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ">  So, with the current code, having 4 peers would never trigger it, right? Because median will always be 0.\r\n\r\nYes and this sort of (on accident) mimics how/when we trigger the warning on master at 5 or more samples: https://github.com/bitcoin/bitcoin/blob/dde7ac5c704688c8a9af29bd07e5ae8114824ce7/src/timedata.cpp#L77",
      "created_at": "2023-12-06T15:20:15Z",
      "updated_at": "2023-12-06T15:20:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1417498148",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417498148"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417498497",
      "pull_request_review_id": 1767854950,
      "id": 1417498497,
      "node_id": "PRRC_kwDOABII585UfU-B",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": 1411821098,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-12-06T15:20:28Z",
      "updated_at": "2023-12-06T15:20:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1417498497",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417498497"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417504050",
      "pull_request_review_id": 1767864568,
      "id": 1417504050,
      "node_id": "PRRC_kwDOABII585UfWUy",
      "diff_hunk": "@@ -3557,12 +3605,17 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n-        if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n+        peer->m_time_offset = nTime - GetTime();\n+\n+        if (pfrom.IsManualOrFullOutboundConn()) {\n+            // Only sample from outbound connections we are really trying to connect to.\n+            m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 137,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d283c10c296163cf5492707030d7579ec38c7413",
      "in_reply_to_id": 1413301629,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I see your point but I think I would like to keep discussion about improving the warning condition to a future PR. The current adjusted time mechanism has the same flaw and is even worse as it stops sampling entirely after 200 samples.\r\n\r\nMaybe we can collect some stats on how often outbound connections rotate and how many samples from which connections are actually useful to inform such a change.\r\n\r\n---\r\n\r\nI will add the release note.",
      "created_at": "2023-12-06T15:23:58Z",
      "updated_at": "2023-12-06T15:23:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1417504050",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1417504050"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3615,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418616411",
      "pull_request_review_id": 1769568731,
      "id": 1418616411,
      "node_id": "PRRC_kwDOABII585Ujl5b",
      "diff_hunk": "@@ -186,6 +186,38 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;\n+    }\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        std::array<int64_t, N> sorted_copy = WITH_LOCK(m_mutex, return m_offsets);\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if constexpr (N % 2 == 0) {\n+            return (sorted_copy[N / 2 - 1] + sorted_copy[N / 2]) / 2;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "122658f95b36b7f940351bd34a89e13831931f18",
      "in_reply_to_id": 1411184510,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I won't mind, but this should be commented somewhere above â€”Â perhaps where 0 returned is handled.",
      "created_at": "2023-12-07T08:58:04Z",
      "updated_at": "2023-12-07T08:58:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1418616411",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418616411"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418629765",
      "pull_request_review_id": 1769589876,
      "id": 1418629765,
      "node_id": "PRRC_kwDOABII585UjpKF",
      "diff_hunk": "@@ -186,6 +186,35 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+template <size_t N>\n+class TimeOffsets\n+{\n+private:\n+    static_assert(N > 0, \"TimeOffsets has to sample at least one element\");\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+        m_offsets[m_index] = offset;\n+        m_index = (1 + m_index) % N;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "6c65f61b625212e128e5db52cbd80a3b57b1450b",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "6c65f61b625212e128e5db52cbd80a3b57b1450b\r\n\r\nnit: your code assumes that N is less than the capacity of `size_t`, otherwise this addition can overflow. You might consider adding a static assert for that too, just in case someone in the future decides to use `TimeOffsets<bazillion>`",
      "created_at": "2023-12-07T09:04:40Z",
      "updated_at": "2023-12-07T09:04:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1418629765",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418629765"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 205,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418647036",
      "pull_request_review_id": 1769618257,
      "id": 1418647036,
      "node_id": "PRRC_kwDOABII585UjtX8",
      "diff_hunk": "@@ -3604,11 +3603,6 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n         peer->m_time_offset = nTime - GetTime();\n-        if (!pfrom.IsInboundConn()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "569a8797cce6bd1cbb4c3d8362ce300baf250ac8",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "After your changes, we won't consider `BLOCK_RELAY`, `FEELER`, `ADDR_FETCH` anymore, right?",
      "created_at": "2023-12-07T09:18:47Z",
      "updated_at": "2023-12-07T09:18:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1418647036",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418647036"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3553,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418654682",
      "pull_request_review_id": 1769630587,
      "id": 1418654682,
      "node_id": "PRRC_kwDOABII585UjvPa",
      "diff_hunk": "@@ -28,6 +29,12 @@ void SetfLargeWorkInvalidChainFound(bool flag)\n     fLargeWorkInvalidChainFound = flag;\n }\n \n+void SetMedianTimeOffsetWarning()\n+{\n+    LOCK(g_warnings_mutex);\n+    g_timeoffset_warning = true;",
      "path": "src/warnings.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "b7364bc832437d95f1e712ed25f25ecb072da66c",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why don't you implement going out of this warning?",
      "created_at": "2023-12-07T09:24:59Z",
      "updated_at": "2023-12-07T09:25:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1418654682",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418654682"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 35,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418656693",
      "pull_request_review_id": 1769633858,
      "id": 1418656693,
      "node_id": "PRRC_kwDOABII585Ujvu1",
      "diff_hunk": "@@ -3557,12 +3605,17 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n-        if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n+        peer->m_time_offset = nTime - GetTime();\n+\n+        if (pfrom.IsManualOrFullOutboundConn()) {\n+            // Only sample from outbound connections we are really trying to connect to.\n+            m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 137,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d283c10c296163cf5492707030d7579ec38c7413",
      "in_reply_to_id": 1413301629,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ">stops sampling entirely after 200 samples\r\n\r\nperhaps record this bug in the commit message, might be useful in the future?",
      "created_at": "2023-12-07T09:26:37Z",
      "updated_at": "2023-12-07T09:26:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1418656693",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1418656693"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3615,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1422593402",
      "pull_request_review_id": 1775338668,
      "id": 1422593402,
      "node_id": "PRRC_kwDOABII585Uyw16",
      "diff_hunk": "@@ -497,7 +496,6 @@ void SetupServerArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-maxconnections=<n>\", strprintf(\"Maintain at most <n> automatic connections to peers (default: %u). This limit does not apply to connections manually added via -addnode or the addnode RPC, which have a separate limit of %u.\", DEFAULT_MAX_PEER_CONNECTIONS, MAX_ADDNODE_CONNECTIONS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-maxreceivebuffer=<n>\", strprintf(\"Maximum per-connection receive buffer, <n>*1000 bytes (default: %u)\", DEFAULT_MAXRECEIVEBUFFER), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-maxsendbuffer=<n>\", strprintf(\"Maximum per-connection memory usage for the send buffer, <n>*1000 bytes (default: %u)\", DEFAULT_MAXSENDBUFFER), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n-    argsman.AddArg(\"-maxtimeadjustment\", strprintf(\"Maximum allowed median peer time offset adjustment. Local perspective of time may be influenced by outbound peers forward or backward by this amount (default: %u seconds).\", DEFAULT_MAX_TIME_ADJUSTMENT), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "aec6b138ced9347c36b2e6e00411c6ee0f9aa8df",
      "in_reply_to_id": 1409151223,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Kept the setting in the new approach",
      "created_at": "2023-12-11T14:52:27Z",
      "updated_at": "2023-12-11T14:52:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1422593402",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1422593402"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 531,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1422595852",
      "pull_request_review_id": 1775342506,
      "id": 1422595852,
      "node_id": "PRRC_kwDOABII585UyxcM",
      "diff_hunk": "@@ -3557,12 +3605,17 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n-        if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n+        peer->m_time_offset = nTime - GetTime();\n+\n+        if (pfrom.IsManualOrFullOutboundConn()) {\n+            // Only sample from outbound connections we are really trying to connect to.\n+            m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 137,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d283c10c296163cf5492707030d7579ec38c7413",
      "in_reply_to_id": 1413301629,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is documented in the current code. \r\nhttps://github.com/bitcoin/bitcoin/blob/40bc501bf462e1b38679f728336f18f08ee251ca/src/timedata.cpp#L60-L76",
      "created_at": "2023-12-11T14:54:08Z",
      "updated_at": "2023-12-11T14:54:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1422595852",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1422595852"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3615,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1422596329",
      "pull_request_review_id": 1775343288,
      "id": 1422596329,
      "node_id": "PRRC_kwDOABII585Uyxjp",
      "diff_hunk": "@@ -3604,11 +3603,6 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n         peer->m_time_offset = nTime - GetTime();\n-        if (!pfrom.IsInboundConn()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "569a8797cce6bd1cbb4c3d8362ce300baf250ac8",
      "in_reply_to_id": 1418647036,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "With the new approach this is kept as is on master",
      "created_at": "2023-12-11T14:54:29Z",
      "updated_at": "2023-12-11T14:54:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1422596329",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1422596329"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3553,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1422596929",
      "pull_request_review_id": 1775344296,
      "id": 1422596929,
      "node_id": "PRRC_kwDOABII585UyxtB",
      "diff_hunk": "@@ -28,6 +29,12 @@ void SetfLargeWorkInvalidChainFound(bool flag)\n     fLargeWorkInvalidChainFound = flag;\n }\n \n+void SetMedianTimeOffsetWarning()\n+{\n+    LOCK(g_warnings_mutex);\n+    g_timeoffset_warning = true;",
      "path": "src/warnings.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "b7364bc832437d95f1e712ed25f25ecb072da66c",
      "in_reply_to_id": 1418654682,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This wasn't implemented before either. This can be improved in a follow up.",
      "created_at": "2023-12-11T14:54:55Z",
      "updated_at": "2023-12-11T14:54:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1422596929",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1422596929"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 35,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429975769",
      "pull_request_review_id": 1786684919,
      "id": 1429975769,
      "node_id": "PRRC_kwDOABII585VO7LZ",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if (m_index % 2 == 0) {\n+            return sorted_copy[m_index / 2];\n+        } else {\n+            return (sorted_copy[m_index / 2] / 2) +\n+                   (sorted_copy[m_index / 2 - 1] / 2);\n+        }\n+    }",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "1. I think the calculation is wrong: the average of the 2 middle elements should be taken in case of an even number of elements.\r\n2. UB: `sorted_copy` being an array of size `N`, I think we'd be sorting uninitialized values if `m_index < N`?\r\n3. nit: the scope of the lock can be reduced\r\n\r\nPotential fix addressing all 3:\r\n\r\n<details>\r\n<summary>git diff on 8b1c133921</summary>\r\n\r\n```diff\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 664992dcab..9ade704fe9 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -215,20 +215,24 @@ public:\r\n     /** Compute and return the median of the collected time offset samples. */\r\n     int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n     {\r\n-        AssertLockNotHeld(m_mutex);\r\n-        LOCK(m_mutex);\r\n+        std::vector<int64_t> sorted_copy;\r\n+        {\r\n+            AssertLockNotHeld(m_mutex);\r\n+            LOCK(m_mutex);\r\n \r\n-        // Only compute the median from 5 or more samples.\r\n-        if (m_index < 4) return 0;\r\n+            // Only compute the median from 5 or more samples.\r\n+            if (m_index < 4) return 0;\r\n+\r\n+            sorted_copy.assign(m_offsets.begin(), m_offsets.begin() + m_index);\r\n+        }\r\n \r\n-        std::array<int64_t, N> sorted_copy = m_offsets;\r\n         std::sort(sorted_copy.begin(), sorted_copy.end());\r\n+        auto mid{sorted_copy.size() / 2};\r\n \r\n-        if (m_index % 2 == 0) {\r\n-            return sorted_copy[m_index / 2];\r\n+        if (sorted_copy.size() % 2 == 0) {\r\n+            return (sorted_copy[mid] / 2) + (sorted_copy[mid - 1] / 2);\r\n         } else {\r\n-            return (sorted_copy[m_index / 2] / 2) +\r\n-                   (sorted_copy[m_index / 2 - 1] / 2);\r\n+            return sorted_copy[mid];\r\n         }\r\n     }\r\n };\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2023-12-18T11:31:21Z",
      "updated_at": "2023-12-18T12:11:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1429975769",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429975769"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 216,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430002494",
      "pull_request_review_id": 1786684919,
      "id": 1430002494,
      "node_id": "PRRC_kwDOABII585VPBs-",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: [\"AssertLockNotHeld() can be omitted if LOCK() is called unconditionally after it because LOCK() does the same check as AssertLockNotHeld() internally, for non-recursive mutexes\"](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#threads-and-synchronization)",
      "created_at": "2023-12-18T11:39:58Z",
      "updated_at": "2023-12-18T12:11:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430002494",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430002494"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 218,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430024540",
      "pull_request_review_id": 1786684919,
      "id": 1430024540,
      "node_id": "PRRC_kwDOABII585VPHFc",
      "diff_hunk": "@@ -672,9 +671,10 @@ static RPCHelpMan getnetworkinfo()\n         obj.pushKV(\"localservicesnames\", GetServicesNames(services));\n     }\n     if (node.peerman) {\n-        obj.pushKV(\"localrelay\", !node.peerman->IgnoresIncomingTxs());\n+        auto peerman_info{node.peerman->GetInfo()};",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "const nit\r\n```suggestion\r\n        const auto peerman_info{node.peerman->GetInfo()};\r\n```",
      "created_at": "2023-12-18T11:48:39Z",
      "updated_at": "2023-12-18T12:11:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430024540",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430024540"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 674,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430056990",
      "pull_request_review_id": 1786684919,
      "id": 1430056990,
      "node_id": "PRRC_kwDOABII585VPPAe",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Wdyt about making the offsets typesafe with `std::chrono::seconds`?\r\n\r\n<details>\r\n<summary>git diff on 8b1c133921</summary>\r\n\r\n```diff\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 664992dcab..4a7243b82f 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -193,12 +193,12 @@ private:\r\n     static constexpr size_t N{199};\r\n \r\n     mutable Mutex m_mutex;\r\n-    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\r\n+    std::array<std::chrono::seconds, N> m_offsets GUARDED_BY(m_mutex){};\r\n     size_t m_index GUARDED_BY(m_mutex){0};\r\n \r\n public:\r\n     /** Add a new time offset sample. */\r\n-    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n+    void Add(std::chrono::seconds offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n     {\r\n         AssertLockNotHeld(m_mutex);\r\n         LOCK(m_mutex);\r\n@@ -213,15 +213,15 @@ public:\r\n     }\r\n \r\n     /** Compute and return the median of the collected time offset samples. */\r\n-    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n+    std::chrono::seconds Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n     {\r\n         AssertLockNotHeld(m_mutex);\r\n         LOCK(m_mutex);\r\n \r\n         // Only compute the median from 5 or more samples.\r\n-        if (m_index < 4) return 0;\r\n+        if (m_index < 4) return std::chrono::seconds{0};\r\n \r\n-        std::array<int64_t, N> sorted_copy = m_offsets;\r\n+        std::array<std::chrono::seconds, N> sorted_copy = m_offsets;\r\n         std::sort(sorted_copy.begin(), sorted_copy.end());\r\n \r\n         if (m_index % 2 == 0) {\r\n@@ -3621,11 +3621,11 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n \r\n         peer->m_time_offset = nTime - GetTime();\r\n         if (!pfrom.IsInboundConn()) {\r\n-            m_outbound_time_offsets.Add(peer->m_time_offset);\r\n+            m_outbound_time_offsets.Add(std::chrono::seconds{peer->m_time_offset});\r\n \r\n             auto median = m_outbound_time_offsets.Median();\r\n-            if (median > m_opts.time_offset_warn_threshold.count() ||\r\n-                median < -m_opts.time_offset_warn_threshold.count()) {\r\n+            if (median > m_opts.time_offset_warn_threshold ||\r\n+                median < -m_opts.time_offset_warn_threshold) {\r\n                 SetMedianTimeOffsetWarning();\r\n             }\r\n         }\r\ndiff --git a/src/net_processing.h b/src/net_processing.h\r\nindex 0fec728ebb..4fb280ed16 100644\r\n--- a/src/net_processing.h\r\n+++ b/src/net_processing.h\r\n@@ -46,7 +46,7 @@ struct CNodeStateStats {\r\n };\r\n \r\n struct PeerManagerInfo {\r\n-    int64_t median_outbound_time_offset{0};\r\n+    std::chrono::seconds median_outbound_time_offset{0};\r\n     bool ignores_incoming_txs{false};\r\n };\r\n \r\ndiff --git a/src/rpc/net.cpp b/src/rpc/net.cpp\r\nindex ea53a974f1..780f1383ed 100644\r\n--- a/src/rpc/net.cpp\r\n+++ b/src/rpc/net.cpp\r\n@@ -673,7 +673,7 @@ static RPCHelpMan getnetworkinfo()\r\n     if (node.peerman) {\r\n         auto peerman_info{node.peerman->GetInfo()};\r\n         obj.pushKV(\"localrelay\", !peerman_info.ignores_incoming_txs);\r\n-        obj.pushKV(\"timeoffset\", peerman_info.median_outbound_time_offset);\r\n+        obj.pushKV(\"timeoffset\", peerman_info.median_outbound_time_offset.count());\r\n     }\r\n     if (node.connman) {\r\n         obj.pushKV(\"networkactive\", node.connman->GetNetworkActive());\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2023-12-18T12:07:12Z",
      "updated_at": "2023-12-18T12:11:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430056990",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430056990"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430078828",
      "pull_request_review_id": 1786792742,
      "id": 1430078828,
      "node_id": "PRRC_kwDOABII585VPUVs",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if (m_index % 2 == 0) {\n+            return sorted_copy[m_index / 2];\n+        } else {\n+            return (sorted_copy[m_index / 2] / 2) +\n+                   (sorted_copy[m_index / 2 - 1] / 2);\n+        }\n+    }",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": 1429975769,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> I think the calculation is wrong: the average of the 2 middle elements should be taken in case of an even number of elements.\r\n\r\nyesðŸ¤¦\r\n\r\n> UB: sorted_copy being an array of size N, I think we'd be sorting uninitialized values if m_index < N?\r\n\r\nNo, `m_offsets` is not uninitialized",
      "created_at": "2023-12-18T12:26:04Z",
      "updated_at": "2023-12-18T12:26:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430078828",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430078828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 216,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430080537",
      "pull_request_review_id": 1786796317,
      "id": 1430080537,
      "node_id": "PRRC_kwDOABII585VPUwZ",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": 1430056990,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good idea, but I'd prefer to leave that for a follow up",
      "created_at": "2023-12-18T12:27:45Z",
      "updated_at": "2023-12-18T12:27:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430080537",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430080537"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430148600",
      "pull_request_review_id": 1786903164,
      "id": 1430148600,
      "node_id": "PRRC_kwDOABII585VPlX4",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if (m_index % 2 == 0) {\n+            return sorted_copy[m_index / 2];\n+        } else {\n+            return (sorted_copy[m_index / 2] / 2) +\n+                   (sorted_copy[m_index / 2 - 1] / 2);\n+        }\n+    }",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": 1429975769,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> No, `m_offsets` is not uninitialized\r\n\r\nThe array is initialized, ~but the items are not~, and afaik `int64_t` doesn't have a default constructor?\r\n",
      "created_at": "2023-12-18T13:32:16Z",
      "updated_at": "2023-12-18T14:44:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430148600",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430148600"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 216,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430149707",
      "pull_request_review_id": 1786904866,
      "id": 1430149707,
      "node_id": "PRRC_kwDOABII585VPlpL",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": 1430056990,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Care to elaborate why? Since this is newly introduced code, seems sensible to do it right away?",
      "created_at": "2023-12-18T13:33:15Z",
      "updated_at": "2023-12-18T13:33:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430149707",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430149707"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430151965",
      "pull_request_review_id": 1786908619,
      "id": 1430151965,
      "node_id": "PRRC_kwDOABII585VPmMd",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if (m_index % 2 == 0) {\n+            return sorted_copy[m_index / 2];\n+        } else {\n+            return (sorted_copy[m_index / 2] / 2) +\n+                   (sorted_copy[m_index / 2 - 1] / 2);\n+        }\n+    }",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": 1429975769,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://godbolt.org/z/5PKET7E39",
      "created_at": "2023-12-18T13:35:25Z",
      "updated_at": "2023-12-18T13:35:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430151965",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430151965"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 216,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430166505",
      "pull_request_review_id": 1786932704,
      "id": 1430166505,
      "node_id": "PRRC_kwDOABII585VPpvp",
      "diff_hunk": "@@ -186,6 +186,53 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        AssertLockNotHeld(m_mutex);\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.end());\n+\n+        if (m_index % 2 == 0) {\n+            return sorted_copy[m_index / 2];\n+        } else {\n+            return (sorted_copy[m_index / 2] / 2) +\n+                   (sorted_copy[m_index / 2 - 1] / 2);\n+        }\n+    }",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "8b1c133921964a69a12bcc62942f96db72ce0261",
      "in_reply_to_id": 1429975769,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah cool, didn't know, thanks. Still, having default (0-)values in sorted_copy seems like it would lead to an incorrect median calculation?",
      "created_at": "2023-12-18T13:49:10Z",
      "updated_at": "2023-12-18T13:49:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1430166505",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430166505"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 216,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1433289091",
      "pull_request_review_id": 1791903508,
      "id": 1433289091,
      "node_id": "PRRC_kwDOABII585VbkGD",
      "diff_hunk": "@@ -3557,12 +3617,15 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n+        peer->m_time_offset = nTime - GetTime();\n         if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n+            m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();\n+            if (median > m_opts.time_offset_warn_threshold.count() ||\n+                median < -m_opts.time_offset_warn_threshold.count()) {\n+                SetMedianTimeOffsetWarning();\n+            }",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 143,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "87c577e9742d7154826c755a7fe320f34fd54c81",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This does seem to change warning behaviour, in that:\r\n1. it isn't logged anymore\r\n2. there's no more pop-up message for bitcoin-qt\r\n\r\nIs that intentional?",
      "created_at": "2023-12-20T23:59:24Z",
      "updated_at": "2023-12-20T23:59:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1433289091",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1433289091"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 3625,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 3619,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1433684385",
      "pull_request_review_id": 1792415804,
      "id": 1433684385,
      "node_id": "PRRC_kwDOABII585VdEmh",
      "diff_hunk": "@@ -186,6 +186,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "dde4e1c6b0cbb49b84e75b9d0d1a92161ba5a499",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "dde4e1c6b0cbb49b84e75b9d0d1a92161ba5a499\r\nif `m_index` is 4, there are 4 samples but we will still compute the median, so the comment is inaccurate.",
      "created_at": "2023-12-21T08:01:48Z",
      "updated_at": "2023-12-21T08:22:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1433684385",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1433684385"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1433686298",
      "pull_request_review_id": 1792415804,
      "id": 1433686298,
      "node_id": "PRRC_kwDOABII585VdFEa",
      "diff_hunk": "@@ -84,6 +88,9 @@ class PeerManager : public CValidationInterface, public NetEventsInterface\n     /** Get statistics from node state */\n     virtual bool GetNodeStateStats(NodeId nodeid, CNodeStateStats& stats) const = 0;\n \n+    /** Get peer manager info. */",
      "path": "src/net_processing.h",
      "position": null,
      "original_position": 15,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "83c790e3abd7d2434894fb964c21796f1d024e9b",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "83c790e3abd7d2434894fb964c21796f1d024e9b\r\n\r\nthe comment could be more useful, rephrasing the meaning of this info.",
      "created_at": "2023-12-21T08:03:41Z",
      "updated_at": "2023-12-21T08:22:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1433686298",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1433686298"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 95,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1434286266",
      "pull_request_review_id": 1793314902,
      "id": 1434286266,
      "node_id": "PRRC_kwDOABII585VfXi6",
      "diff_hunk": "@@ -186,6 +186,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "87c577e9742d7154826c755a7fe320f34fd54c81",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: Especially since there's no git log for this new code, this comment is pretty difficult to understand for future readers. Would suggest adding a link to e.g. https://github.com/bitcoin/bitcoin/commit/93659379bdedc29a87fe351ba2950a2c976aebd9 for context",
      "created_at": "2023-12-21T16:36:38Z",
      "updated_at": "2023-12-21T17:39:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1434286266",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1434286266"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 206,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 208,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1434312496",
      "pull_request_review_id": 1793314902,
      "id": 1434312496,
      "node_id": "PRRC_kwDOABII585Vfd8w",
      "diff_hunk": "@@ -3557,12 +3617,15 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n+        peer->m_time_offset = nTime - GetTime();\n         if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n+            m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();\n+            if (median > m_opts.time_offset_warn_threshold.count() ||\n+                median < -m_opts.time_offset_warn_threshold.count()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 141,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "87c577e9742d7154826c755a7fe320f34fd54c81",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n            if (std::abs(median) > m_opts.time_offset_warn_threshold.count()) {\r\n```",
      "created_at": "2023-12-21T17:03:39Z",
      "updated_at": "2023-12-21T17:39:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1434312496",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1434312496"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 3625,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 3617,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1435666435",
      "pull_request_review_id": 1795460706,
      "id": 1435666435,
      "node_id": "PRRC_kwDOABII585VkogD",
      "diff_hunk": "@@ -3557,12 +3617,15 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n+        peer->m_time_offset = nTime - GetTime();\n         if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n+            m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();\n+            if (median > m_opts.time_offset_warn_threshold.count() ||\n+                median < -m_opts.time_offset_warn_threshold.count()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 141,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "87c577e9742d7154826c755a7fe320f34fd54c81",
      "in_reply_to_id": 1434312496,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This wouldn't trigger the warning if the median is equal to `std::numeric_limits<int64_t>::min()`",
      "created_at": "2023-12-23T18:02:47Z",
      "updated_at": "2023-12-23T18:02:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1435666435",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1435666435"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 3625,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 3617,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439717289",
      "pull_request_review_id": 1800831281,
      "id": 1439717289,
      "node_id": "PRRC_kwDOABII585V0Fep",
      "diff_hunk": "@@ -186,6 +186,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "dde4e1c6b0cbb49b84e75b9d0d1a92161ba5a499",
      "in_reply_to_id": 1433684385,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In order to be consistent with how the code used to be what needs updating is the code and not the comment, doesn't it? Otherwise, we will be computing the median as low as with 4 elements when we used to need 5 before. \r\n\r\nI don't know what the motivation to require 5 data points previously was (why not 4 or 3?), but my impression by reading the comments in this PR is that we are trying no to change anyting with respect to how the median is computed and leave that for a followup\r\n\r\n",
      "created_at": "2024-01-02T18:41:27Z",
      "updated_at": "2024-01-03T16:52:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1439717289",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439717289"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439726269",
      "pull_request_review_id": 1800831281,
      "id": 1439726269,
      "node_id": "PRRC_kwDOABII585V0Hq9",
      "diff_hunk": "@@ -3557,12 +3617,15 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n+        peer->m_time_offset = nTime - GetTime();\n         if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n+            m_outbound_time_offsets.Add(peer->m_time_offset);\n+\n+            auto median = m_outbound_time_offsets.Median();\n+            if (median > m_opts.time_offset_warn_threshold.count() ||\n+                median < -m_opts.time_offset_warn_threshold.count()) {",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 141,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "87c577e9742d7154826c755a7fe320f34fd54c81",
      "in_reply_to_id": 1434312496,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Came for this. ðŸ˜• indeed",
      "created_at": "2024-01-02T18:54:21Z",
      "updated_at": "2024-01-03T16:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1439726269",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439726269"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 3625,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 3617,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439738186",
      "pull_request_review_id": 1800831281,
      "id": 1439738186,
      "node_id": "PRRC_kwDOABII585V0KlK",
      "diff_hunk": "@@ -3548,12 +3608,15 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToStringAddrPort(), fRelay, pfrom.GetId(),\n                   remoteAddr, (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n+        peer->m_time_offset = nTime - GetTime();\n         if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 135,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "1d226ae1f984c5c808f5c24c431b959cdefa692e",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think a version of this comment may still be relevant to motivate why we only sample outbound nodes",
      "created_at": "2024-01-02T19:11:34Z",
      "updated_at": "2024-01-03T16:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1439738186",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439738186"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 3554,
      "start_side": "LEFT",
      "line": null,
      "original_line": 3555,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439748605",
      "pull_request_review_id": 1800902150,
      "id": 1439748605,
      "node_id": "PRRC_kwDOABII585V0NH9",
      "diff_hunk": "@@ -187,6 +187,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.begin() + m_index);\n+\n+        if (m_index % 2 == 0) {\n+            return (sorted_copy[m_index / 2] / 2) +",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 41,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d079ffc9b8e9a81eb0bfb3da66f64c0257f16e71",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think the the addition should be done before the division to handle rounding effects better, like it's done in `timedata`. If the two relevant offsets are, for example, 3 and 5, the median with this code would be 3.",
      "created_at": "2024-01-02T19:25:59Z",
      "updated_at": "2024-01-02T19:39:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1439748605",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439748605"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439751712",
      "pull_request_review_id": 1800831281,
      "id": 1439751712,
      "node_id": "PRRC_kwDOABII585V0N4g",
      "diff_hunk": "@@ -41,6 +42,12 @@ struct CNodeStateStats {\n     bool m_addr_relay_enabled{false};\n     ServiceFlags their_services;\n     int64_t presync_height{-1};\n+    int64_t time_offset{0};\n+};\n+\n+struct PeerManagerInfo {\n+    int64_t median_outbound_time_offset{0};\n+    bool ignores_incoming_txs{false};",
      "path": "src/net_processing.h",
      "position": null,
      "original_position": 17,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "1d226ae1f984c5c808f5c24c431b959cdefa692e",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Out of curiosity: are you grouping these two so you can query them together, given you'll need both of them in `getnetworkinfo` if peerman is defined? ",
      "created_at": "2024-01-02T19:30:04Z",
      "updated_at": "2024-01-03T16:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1439751712",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439751712"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": 48,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 50,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439769121",
      "pull_request_review_id": 1800932681,
      "id": 1439769121,
      "node_id": "PRRC_kwDOABII585V0SIh",
      "diff_hunk": "@@ -187,6 +187,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.begin() + m_index);\n+\n+        if (m_index % 2 == 0) {\n+            return (sorted_copy[m_index / 2] / 2) +",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 41,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d079ffc9b8e9a81eb0bfb3da66f64c0257f16e71",
      "in_reply_to_id": 1439748605,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The current approach addresses overflow concerns as per https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1411821098",
      "created_at": "2024-01-02T19:51:24Z",
      "updated_at": "2024-01-02T19:51:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1439769121",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439769121"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439781598",
      "pull_request_review_id": 1800951998,
      "id": 1439781598,
      "node_id": "PRRC_kwDOABII585V0VLe",
      "diff_hunk": "@@ -187,6 +187,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.begin() + m_index);\n+\n+        if (m_index % 2 == 0) {\n+            return (sorted_copy[m_index / 2] / 2) +",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 41,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d079ffc9b8e9a81eb0bfb3da66f64c0257f16e71",
      "in_reply_to_id": 1439748605,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ok, I see. Still, having a function  that returns 3 as the median of {3,5} and 5 as the median of {4,6} seems inconsistent, couldn't we explicitly check and handle overflows instead?",
      "created_at": "2024-01-02T20:10:04Z",
      "updated_at": "2024-01-02T20:10:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1439781598",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439781598"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439793095",
      "pull_request_review_id": 1800831281,
      "id": 1439793095,
      "node_id": "PRRC_kwDOABII585V0X_H",
      "diff_hunk": "@@ -187,6 +187,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.begin() + m_index);\n+\n+        if (m_index % 2 == 0) {\n+            return (sorted_copy[m_index / 2] / 2) +",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 41,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d079ffc9b8e9a81eb0bfb3da66f64c0257f16e71",
      "in_reply_to_id": 1439748605,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I was going to suggest doing `sorted_copy[m_index / 2]  + sorted_copy[m_index / 2 - 1]) / 2))` before seeing this comment since the current approach feels a bit strange. If we keep this I'd say at least add a comment pointing out this is to prevent overflow ",
      "created_at": "2024-01-02T20:28:04Z",
      "updated_at": "2024-01-03T16:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1439793095",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439793095"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440456087",
      "pull_request_review_id": 1802069279,
      "id": 1440456087,
      "node_id": "PRRC_kwDOABII585V252X",
      "diff_hunk": "@@ -187,6 +187,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.begin() + m_index);\n+\n+        if (m_index % 2 == 0) {\n+            return (sorted_copy[m_index / 2] / 2) +",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 41,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d079ffc9b8e9a81eb0bfb3da66f64c0257f16e71",
      "in_reply_to_id": 1439748605,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "We already assume the median can be rounded down, so I don't think extra rounding changes any assumptions, and therefore I wouldn't overcomplicate things, it's just not worth it imo. I'd be okay with casting to a double first, but it's not strictly better as we're trading off precision at the higher ranges (which I also don't think is important at all).\r\n\r\n```cpp\r\n        if (m_index % 2 == 0) {\r\n            return (0.5 * sorted_copy[m_index / 2]) +\r\n                   (0.5 * sorted_copy[m_index / 2 - 1]);\r\n        }\r\n```",
      "created_at": "2024-01-03T13:31:34Z",
      "updated_at": "2024-01-03T13:31:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1440456087",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440456087"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440584344",
      "pull_request_review_id": 1802425502,
      "id": 1440584344,
      "node_id": "PRRC_kwDOABII585V3ZKY",
      "diff_hunk": "@@ -187,6 +187,51 @@ struct QueuedBlock {\n     std::unique_ptr<PartiallyDownloadedBlock> partialBlock;\n };\n \n+class TimeOffsets\n+{\n+private:\n+    // Historic maximum number of time offsets we include in our median.\n+    static constexpr size_t N{199};\n+\n+    mutable Mutex m_mutex;\n+    std::array<int64_t, N> m_offsets GUARDED_BY(m_mutex){};\n+    size_t m_index GUARDED_BY(m_mutex){0};\n+\n+public:\n+    /** Add a new time offset sample. */\n+    void Add(int64_t offset) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Stop sampling after N samples.\n+        // TODO This maintains a historic bug of adjusted time and could be\n+        // changed in the future.\n+        if (m_index >= N) return;\n+\n+        m_offsets[m_index] = offset;\n+        ++m_index;\n+    }\n+\n+    /** Compute and return the median of the collected time offset samples. */\n+    int64_t Median() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    {\n+        LOCK(m_mutex);\n+\n+        // Only compute the median from 5 or more samples.\n+        if (m_index < 4) return 0;\n+\n+        std::array<int64_t, N> sorted_copy = m_offsets;\n+        std::sort(sorted_copy.begin(), sorted_copy.begin() + m_index);\n+\n+        if (m_index % 2 == 0) {\n+            return (sorted_copy[m_index / 2] / 2) +",
      "path": "src/net_processing.cpp",
      "position": null,
      "original_position": 41,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "d079ffc9b8e9a81eb0bfb3da66f64c0257f16e71",
      "in_reply_to_id": 1439748605,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Just a code comment would be fine too. I agree that the rounding doesn't matter at all in this context (and it'd also be fine not to calculate the mean in the even case at all), but code tends to get copied and reused.",
      "created_at": "2024-01-03T15:28:27Z",
      "updated_at": "2024-01-03T15:28:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1440584344",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440584344"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440772571",
      "pull_request_review_id": 1802864286,
      "id": 1440772571,
      "node_id": "PRRC_kwDOABII585V4HHb",
      "diff_hunk": "@@ -2185,10 +2185,6 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n     // upgrade from one software version to the next after a consensus rule\n     // change is potentially tricky and issue-specific (see NeedsRedownload()\n     // for one approach that was used for BIP 141 deployment).\n-    // Also, currently the rule against blocks more than 2 hours in the future",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "1d226ae1f984c5c808f5c24c431b959cdefa692e",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think this comment should stay, because `NodeClock` isn't guaranteed to be monotonic?",
      "created_at": "2024-01-03T18:21:04Z",
      "updated_at": "2024-01-03T18:21:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1440772571",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440772571"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2188,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1464827885",
      "pull_request_review_id": 1838562579,
      "id": 1464827885,
      "node_id": "PRRC_kwDOABII585XT3_t",
      "diff_hunk": "@@ -3805,7 +3805,7 @@ static bool ContextualCheckBlockHeader(const CBlockHeader& block, BlockValidatio\n         return state.Invalid(BlockValidationResult::BLOCK_INVALID_HEADER, \"time-too-old\", \"block's timestamp is too early\");\n \n     // Check timestamp\n-    if (block.Time() > now + std::chrono::seconds{MAX_FUTURE_BLOCK_TIME}) {\n+    if (block.Time() > NodeClock::now() + std::chrono::seconds{MAX_FUTURE_BLOCK_TIME}) {",
      "path": "src/validation.cpp",
      "position": 14,
      "original_position": 14,
      "commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "original_commit_id": "ff9039f6ea876bab2c40a06a93e0dd087f445fa2",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This latest force-push seems to have accidentally reverted the necessary doc change in `chain.h`:\r\n\r\n<details>\r\n<summary>git diff on ff9039f6ea</summary>\r\n\r\n```diff\r\ndiff --git a/src/chain.h b/src/chain.h\r\nindex f9121fb861..ab58fad5b9 100644\r\n--- a/src/chain.h\r\n+++ b/src/chain.h\r\n@@ -19,7 +19,7 @@\r\n \r\n /**\r\n  * Maximum amount of time that a block timestamp is allowed to exceed the\r\n- * current network-adjusted time before the block will be accepted.\r\n+ * current time before the block will be accepted.\r\n  */\r\n static constexpr int64_t MAX_FUTURE_BLOCK_TIME = 2 * 60 * 60;\r\n \r\n\r\n```\r\n</details>\r\n",
      "created_at": "2024-01-24T12:14:31Z",
      "updated_at": "2024-01-24T13:58:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28956#discussion_r1464827885",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1464827885"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28956"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3808,
      "original_line": 3808,
      "side": "RIGHT"
    }
  ]
}