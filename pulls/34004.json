{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004",
    "id": 3070554287,
    "node_id": "PR_kwDOABII5863BPCv",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34004",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34004.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34004.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/86d009d0009a53bbb42923b1c1c062f11499d481",
    "number": 34004,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Implementation of SwiftSync",
    "user": {
      "login": "rustaceanrob",
      "id": 102320249,
      "node_id": "U_kgDOBhlIeQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rustaceanrob",
      "html_url": "https://github.com/rustaceanrob",
      "followers_url": "https://api.github.com/users/rustaceanrob/followers",
      "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
      "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
      "repos_url": "https://api.github.com/users/rustaceanrob/repos",
      "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "Link to the original protocol writeup found [here](https://gist.github.com/RubenSomsen/a61a37d14182ccd78760e477c78133cd). See the [Delving Bitcoin post](https://delvingbitcoin.org/t/swiftsync-speeding-up-ibd-with-pre-generated-hints-poc/1562) for initial works and discussion.\r\n\r\n# Motivation\r\n\r\nWhile many coins are available in cache when spent, every cache miss requires a trip to the disk. Memory can be scarce for single board machines, so cache misses are expected to be far more frequent. A trip to disk is all-the-more severe on low end hardware, so any minimization of disk interactions can speed up initial block download for limited resource devices. One such example may be a block template provider serving a home miner.\r\n\r\n# Intuition\r\n\r\nThe vast majority of coins created are later spent. The cost of this observation is many coins will be written to disk, only to be removed later. The SwiftSync protocol alleviates the problem by recording what coins have been added and removed with a small, in-memory aggregate. This allows for the removal of intermediate coin states until SwiftSync has completed. The state of the aggregate is verified at a predetermined chain height, and IBD continues as usual thereafter.\r\n\r\nFor any chain height, we know `all outputs - all inputs = UTXO set`, which is equivalently `all outputs - UTXO set = all inputs`. The goal is to verify the set `all outputs - UTXO set` is equal to `all inputs`. Addition and subtraction modulo a field offers a way to do so. For any set, if we add all elements of the set and subtract them, regardless of ordering, we will arrive at zero. In the current implementation, the set elements being compared are hashed outpoints.\r\n\r\nThe SwiftSync protocol is comprised of two structures. First, the aggregate that will record the state of what outpoints have been added (created) or subtracted (spent). Next, notice that the UTXO set must be reported in order to verify `all outputs - UTXO set = all inputs`. SwiftSync introduces a hints file, which may be provided to the client at startup. This hints file is nothing more than a pointer to each unspent output by recording the block height and the indexes that will remain unspent. By using this file, a client may omit outpoints that will be in the UTXO set when updating the aggregate. Note this file is not trusted. If a malicious actor provides a faulty UTXO set, the set comparison above will fail, and the client may begin a reindex.\r\n# Implementation\r\n\r\n## Aggregate\r\n\r\nThe hash aggregate takes outpoints, hashes them with a salted hasher, and updates 4, 64-bit limbs with wrapping modulo arithmetic. The choice of 4, 64-bit limbs with no carries between limbs was made to: 1. minimize code complexity within the aggregate 2. conform to existing APIs, namely `uint256`. After adding and subtracting some arbitrary list of outpoints, we may poll if the sets were equivalent with `IsZero`.\r\n## Hintsfile\r\n\r\nThe hints file is a map of block height to the indexes of the outputs in that block that _will_ be in the UTXO set. To construct this file for a particular UTXO set state, each block must be read and queried to find the outputs in that block that remain unspent. Because this is a read-only operation, this may be done on parallel threads in the future. To allow for parallelization, the hints file contains a \"contents\" section, which denotes the height and corresponding file position to find the hints for that block.\r\n\r\nTo save space when representing the indexes that remain unspent in a block, an easy choice is to take the difference between the last coin that was unspent and the next one in the block. AFICT this is a version of run-length-encoding. These indexes are encoded using `compactSize` to further save space, the run-lengths should normally fit into at least 16 bits, often 8 bits.\r\n## Parameter Interaction\r\n\r\nA side effect of omitting intermediate UTXO states while performing IBD is the \"undo data\" cannot be derived. There are already configurations that do not have full undo data history, namely pruned nodes. To avoid additional complexity in this PR, this version of accelerated IBD is only made available to pruned nodes, as the undo data would have been removed regardless of the this setting.\r\n\r\nOther parameter interactions, not yet implemented:\r\n- `assumeutxo`: Startup should fail if both are configured. A hints file will have no effect, as the UTXO set is already present.\r\n- `assumevalid`: A natural choice is to only allow SwiftSync when using `assumevalid`, and to only allow a hints file that commits to the `assumevalid` block. Similar to `assumeutxo`, a hash of the hints file may be committed to in the binary, which would be resistant to griefing attacks.\r\n# Testing [Linux example]\r\n\r\nIn your `bitcoin` directory, download the hints from the test server:\r\n\r\n```bash\r\ncurl -o signet.hints http://utxohints.store/hints/signet\r\n```\r\n\r\nVerify the hash of the file:\r\n\r\n```bash\r\necho \"2b625392ecb2adba2b5f9d7b00c8f3a8adca0d3c  signet.hints\" | sha1sum --check -\r\n```\r\n\r\nBuild the branch:\r\n\r\n```bash\r\ncmake -B build && cmake --build build -j $(nproc)\r\n```\r\n\r\nRemove existing chain state:\r\n\r\n```bash\r\nrm -rf ~/.bitcoin/signet/\r\n```\r\n\r\nProvide the file at startup:\r\n\r\n```bash\r\n./build/bin/bitcoind --chain=signet --utxohints=./signet.hints --prune=550\r\n```\r\n\r\n#### Other networks:\r\n- ~Testnet4: endpoint `http://utxohints.store/hints/testnet4`, expected checksum `7acbb25b651ffc5ebc59c46fd065a510c149f00e  testnet4.hints`~\r\n\r\n# Open Questions\r\n\r\n- Given the outcome of SwiftSync is pass/fail, and there is no use of intermediate states, should blocks be persisted to disk at all during the protocol?\r\n- To what degree should a hints file be committed to in the binary. No commitment allows for a server to provide hints for an arbitrary height, providing a convenience for the client, but opens up the possibility of a grief attack. Of course the server risks losing reputation for serving faulty files.\r\n\r\n# Future Iteration\r\n\r\nThis is the first iteration of the SwiftSync proposal, however more optimizations may be made. Namely, because set elements may be added or subtracted from the aggregate in any order, blocks may be downloaded in parallel from multiple peers. If you are interested in benchmarking the performance of a fully-parallel version, see the [Rust implementation](https://github.com/2140-dev/swiftsync).\r\n",
    "labels": [
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2025-12-04T09:50:39Z",
    "updated_at": "2026-01-07T12:03:04Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "b46b8afc7d1aa22bb256ef53a63417f54f553e7c",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "rustaceanrob:swiftsync-v0",
      "ref": "swiftsync-v0",
      "sha": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 849046112,
        "node_id": "R_kgDOMptqYA",
        "name": "bitcoin",
        "full_name": "rustaceanrob/bitcoin",
        "owner": {
          "login": "rustaceanrob",
          "id": 102320249,
          "node_id": "U_kgDOBhlIeQ",
          "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/rustaceanrob",
          "html_url": "https://github.com/rustaceanrob",
          "followers_url": "https://api.github.com/users/rustaceanrob/followers",
          "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
          "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
          "repos_url": "https://api.github.com/users/rustaceanrob/repos",
          "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/rustaceanrob/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/rustaceanrob/bitcoin",
        "archive_url": "https://api.github.com/repos/rustaceanrob/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/rustaceanrob/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/rustaceanrob/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/rustaceanrob/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/rustaceanrob/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/rustaceanrob/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/rustaceanrob/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/rustaceanrob/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/rustaceanrob/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/rustaceanrob/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/rustaceanrob/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/rustaceanrob/bitcoin/events",
        "forks_url": "https://api.github.com/repos/rustaceanrob/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/rustaceanrob/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/rustaceanrob/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/rustaceanrob/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/rustaceanrob/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/rustaceanrob/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/rustaceanrob/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/rustaceanrob/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/rustaceanrob/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/rustaceanrob/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/rustaceanrob/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/rustaceanrob/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/rustaceanrob/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/rustaceanrob/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/rustaceanrob/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/rustaceanrob/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:rustaceanrob/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/rustaceanrob/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/rustaceanrob/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/rustaceanrob/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/rustaceanrob/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/rustaceanrob/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/rustaceanrob/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/rustaceanrob/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/rustaceanrob/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/rustaceanrob/bitcoin/hooks",
        "svn_url": "https://github.com/rustaceanrob/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 257781,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-12-29T10:44:30Z",
        "created_at": "2024-08-28T22:00:36Z",
        "updated_at": "2025-12-29T10:45:01Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "ab513103df8d1cadd2cf23397a39c652f3a2a550",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38580,
        "stargazers_count": 87562,
        "watchers_count": 87562,
        "size": 301305,
        "default_branch": "master",
        "open_issues_count": 735,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-07T11:09:02Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-07T12:16:06Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 723,
    "deletions": 11,
    "changed_files": 15,
    "commits": 9,
    "review_comments": 57,
    "comments": 8
  },
  "events": [
    {
      "event": "commented",
      "id": 3611171349,
      "node_id": "IC_kwDOABII587XPhoV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3611171349",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-04T09:50:46Z",
      "updated_at": "2025-12-18T10:41:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34004.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32741](https://github.com/bitcoin/bitcoin/pull/32741) (rpc: Add optional peer_ids param to filter getpeerinfo by waketraindev)\n* [#32317](https://github.com/bitcoin/bitcoin/pull/32317) (kernel: Separate UTXO set access from validation functions by sedited)\n* [#31974](https://github.com/bitcoin/bitcoin/pull/31974) (Drop testnet3 by Sjors)\n* [#31774](https://github.com/bitcoin/bitcoin/pull/31774) (crypto: Use secure_allocator for `AES256_ctx` by davidgumberg)\n* [#28690](https://github.com/bitcoin/bitcoin/pull/28690) (build: Introduce internal kernel library by sedited)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\n\n\nPossible typos and grammar issues:\n\n- \"...hint file may take a few hours to build.\" \"Make sure to use no RPC timeout (bitcoin-cli -rpcclienttimeout=0)\" -> \"...hint file may take a few hours to build. Make sure to use no RPC timeout (bitcoin-cli -rpcclienttimeout=0)\" [The two adjacent string literals are concatenated without an intervening space, producing \"build.Make\" which is hard to read; add a space between sentences.]\n\n\n\n<sup>2025-12-17</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#issuecomment-3611171349",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004"
    },
    {
      "event": "labeled",
      "id": 21356328582,
      "node_id": "LE_lADOABII587cKlOpzwAAAAT477aG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21356328582",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-04T11:05:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3611566460,
      "node_id": "IC_kwDOABII587XRCF8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3611566460",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-04T11:05:23Z",
      "updated_at": "2025-12-04T11:05:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `ASan + LSan + UBSan + integer`: https://github.com/bitcoin/bitcoin/actions/runs/19924702497/job/57121471145</sub>\n<sub>LLM reason (âœ¨ experimental): swiftsync_tests failed due to an unsigned integer overflow (runtime error) in swiftsync.cpp.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#issuecomment-3611566460",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21358528075,
      "node_id": "HRFPE_lADOABII587cKlOpzwAAAAT5EUZL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21358528075",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "652d99dc12f9c30e8a5983479a8ff0ae05a6d561",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/652d99dc12f9c30e8a5983479a8ff0ae05a6d561",
      "created_at": "2025-12-04T12:39:34Z"
    },
    {
      "event": "reviewed",
      "id": 3539878634,
      "node_id": "PRR_kwDOABII587S_kLq",
      "url": null,
      "actor": null,
      "commit_id": "183fd9aa2e06826f2a1cf708278b19db2fbecc68",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-04T12:53:02Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3539878634",
      "submitted_at": "2025-12-04T12:53:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21370870717,
      "node_id": "HRFPE_lADOABII587cKlOpzwAAAAT5zZu9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21370870717",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/fcdce16cf1c974a153942948af334f2859169559",
      "created_at": "2025-12-04T21:24:04Z"
    },
    {
      "event": "unlabeled",
      "id": 21372247363,
      "node_id": "UNLE_lADOABII587cKlOpzwAAAAT54p1D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21372247363",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-04T22:41:25Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3543553336,
      "node_id": "PRR_kwDOABII587TNlU4",
      "url": null,
      "actor": null,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-09T15:40:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "I went through the change once to get a feel for it, left a ton of questions and suggestions.\nMany of my suggestions apply to many places of the PR - I didn't comment on each occurrence. Some are very low-level, some very high - please put them into context.\nAs far as I'm concerned there are a few blockers here - it should indeed be a draft for now.\n\nFirst, the storage assumes sparse blocks throughout the mainchain history - which is unlikely to be the case, I think we could achieve better storage if we used a mixed storage mechanism based on which is cheaper: an index-to-boolean map for each unspend tx or a bitset of the complete block. Given how easy it is to implement a compressed sparse bitset, I think we should investigate that. Could you plot the blockchain by height vs unspent tx for us?\n\nIt also bothers me greatly that this can only seed pruned nodes - it limits its use a lot, it's hard to argue what this provides over current `AssumeUTXO`.\nIs it possible to carve out features from this change and progressively introduce chunks into the codebase - e.g. introduce hints file but use it to optimize the current storage to warm the cache based on whether we expect those to end up on disk or not. It would be a pure optimization without any validation change - in worst case it would just make the code slower. And it would already get our foot in the door - I don't expect this change to be merged soon, we should expect pushback.\n\nIn its current state even I have strong objections against it: the logic is spread around the validation code, I want to be able to review this in isolation instead of sprinkled around consensus code. As @sedited also mentioned in a deleted comment: could we separate the gist into a coins cache like @andrewtoth did in https://github.com/bitcoin/bitcoin/pull/31132 to encapsulate its effect? We should expect some refactoring changes before this PR.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3543553336",
      "submitted_at": "2025-12-09T15:40:50Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "commented",
      "id": 3637307626,
      "node_id": "IC_kwDOABII587YzOjq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3637307626",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-10T14:18:41Z",
      "updated_at": "2025-12-10T14:18:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks a lot for the thorough review. I will respond both high level and to review comments over the coming days.",
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#issuecomment-3637307626",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004"
    },
    {
      "event": "reviewed",
      "id": 3569068972,
      "node_id": "PRR_kwDOABII587Uu6us",
      "url": null,
      "actor": null,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-11T21:34:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "I've ran a mutation analysis on this PR. Unkilled mutants should be killed (covered) by an unit or functional test (if make sense). However, I noticed that there are part of the code that doesn't even have test coverage (corecheck.dev would have show it but did not generated the report for this PR) and should have it. As soon as more tests are added to this PR, I can re-run the analysis again.",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3569068972",
      "submitted_at": "2025-12-11T21:34:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "reviewed",
      "id": 3569407824,
      "node_id": "PRR_kwDOABII587UwNdQ",
      "url": null,
      "actor": null,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-11T21:35:18Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3569407824",
      "submitted_at": "2025-12-11T21:35:18Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "reviewed",
      "id": 3569558994,
      "node_id": "PRR_kwDOABII587UwyXS",
      "url": null,
      "actor": null,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-11T22:23:47Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3569558994",
      "submitted_at": "2025-12-11T22:23:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "reviewed",
      "id": 3570829796,
      "node_id": "PRR_kwDOABII587U1onk",
      "url": null,
      "actor": null,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-12T08:28:19Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3570829796",
      "submitted_at": "2025-12-12T08:28:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "reviewed",
      "id": 3570977196,
      "node_id": "PRR_kwDOABII587U2Mms",
      "url": null,
      "actor": null,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-12T09:11:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Since this SwiftSync implementation uses `assumevalid` assumptions, it makes sense to reason about attacks that apply to `assumevalid`, here as well.\nWhat happens if an attack gives a SwiftSync node a malicious hint file and eclipses the node so that it is denied an honest chain? Assumevalid uses:\n- the minimumchain work check to ensure that scripts are verified when the node is denied access to \"any chain at least as good as the expected chain\"\n- the equivalent time check to force the attacker to generate 2 weeks' worth of blocks to bury the invalid block.\nSee https://github.com/bitcoin/bitcoin/blob/d5c8199b7904f4b13230d5677d4528591e4d5b41/src/validation.cpp#L2377-L2397\n\nI think we need to include these checks as well when doing SwiftSync with `assumevalid` assumptions. Unless, for some reason, SwiftSync with assumevalid is not vulnerable to the same attacks.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3570977196",
      "submitted_at": "2025-12-12T09:11:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21529737412,
      "node_id": "HRFPE_lADOABII587cKlOpzwAAAAUDRbjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21529737412",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/68539852861e22acb051bdb1213b3e04cab22cd5",
      "created_at": "2025-12-12T14:54:12Z"
    },
    {
      "event": "referenced",
      "id": 21531726407,
      "node_id": "REFE_lADOABII587cKlOpzwAAAAUDZBJH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21531726407",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "c62f93b6313cfa88099d6c8a7bb04c83930df723",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/c62f93b6313cfa88099d6c8a7bb04c83930df723",
      "created_at": "2025-12-12T16:22:12Z"
    },
    {
      "event": "subscribed",
      "id": 21542621626,
      "node_id": "SE_lADOABII587cKlOpzwAAAAUEClG6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21542621626",
      "actor": {
        "login": "nervana21",
        "id": 205626986,
        "node_id": "U_kgDODEGeag",
        "avatar_url": "https://avatars.githubusercontent.com/u/205626986?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nervana21",
        "html_url": "https://github.com/nervana21",
        "followers_url": "https://api.github.com/users/nervana21/followers",
        "following_url": "https://api.github.com/users/nervana21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nervana21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nervana21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nervana21/subscriptions",
        "organizations_url": "https://api.github.com/users/nervana21/orgs",
        "repos_url": "https://api.github.com/users/nervana21/repos",
        "events_url": "https://api.github.com/users/nervana21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nervana21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-13T14:18:09Z"
    },
    {
      "event": "referenced",
      "id": 21543694121,
      "node_id": "REFE_lADOABII587cKlOpzwAAAAUEGq8p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21543694121",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "9b62dadd004c509baf579ef7a9e904c21326e02e",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/9b62dadd004c509baf579ef7a9e904c21326e02e",
      "created_at": "2025-12-13T18:20:04Z"
    },
    {
      "event": "referenced",
      "id": 21543708667,
      "node_id": "REFE_lADOABII587cKlOpzwAAAAUEGuf7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21543708667",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "5ac35795206d252c9f464e967b84521ddaad38f1",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/5ac35795206d252c9f464e967b84521ddaad38f1",
      "created_at": "2025-12-13T18:24:04Z"
    },
    {
      "event": "commented",
      "id": 3655557640,
      "node_id": "IC_kwDOABII587Z42II",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3655557640",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-15T13:09:31Z",
      "updated_at": "2025-12-17T09:59:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "> It also bothers me greatly that this can only seed pruned nodes - it limits its use a lot, it's hard to argue what this provides over current AssumeUTXO.\r\nIs it possible to carve out features from this change and progressively introduce chunks into the codebase - e.g. introduce hints file but use it to optimize the current storage to warm the cache based on whether we expect those to end up on disk or not\r\n\r\nI entertained this idea for a while. In the current format, the only thing we get is a guarantee some outputs should go straight to disk and minimize time in the cache. While this might not make things slower, I don't think it will offer a significant improvement. One iteration on this idea is to use time-to-live values similar to the [UTXO draft BIP](https://github.com/bitcoin/bips/pull/1923). So, something like `10` represents this output will be spent soon and `110` means this output will be spent a bit later, etc. This would have no benefit to the SwiftSync protocol itself, but could potentially offer an improvement in cache efficiency.\r\n\r\nRegarding the pruned-only feature. This would not be the case if there was a P2P message for undo-data. It would allow undo-data to be written in an un-trusted state and later confirmed as valid with a check of `IsBalanced`. Not to mention it would allow for full validation. Perhaps downloading undo-data should be required regardless of script checks, as 1. the changes to `validation.cpp` should be minimal in terms of omitted amount checks (especially with #32317) 2. it would support pruned, assume-valid, and fully validating nodes with no discrepancies between the code-paths for each of these options. I think it would be worthwhile for me to demonstrate this approach on a separate PR.\r\n\r\nRegarding the current format of the hintsfile, AFICT the linked delving bitcoin post explored the difference in encodings, and ~found essentially no difference in the bitset encoding and using the run-lengths~. Given that `std::vector<bool>` is an optimized data structure, it makes sense to opt for the `0/1` format. I have no strong opinion here.",
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#issuecomment-3655557640",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21572289366,
      "node_id": "HRFPE_lADOABII587cKlOpzwAAAAUFzwNW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21572289366",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "created_at": "2025-12-15T17:14:53Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21593879224,
      "node_id": "HRFPE_lADOABII587cKlOpzwAAAAUHGHK4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21593879224",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "83cb4ab1ee746edf0f4cc9bb3427549bd82e3042",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/83cb4ab1ee746edf0f4cc9bb3427549bd82e3042",
      "created_at": "2025-12-16T14:16:03Z"
    },
    {
      "event": "labeled",
      "id": 21595642561,
      "node_id": "LE_lADOABII587cKlOpzwAAAAUHM1rB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21595642561",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-16T15:26:18Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3664604170,
      "node_id": "IC_kwDOABII587abWwK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3664604170",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-17T10:03:49Z",
      "updated_at": "2025-12-17T10:03:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "> found essentially no difference in the bitset encoding and using the run-length\r\n\r\nThis turned out to not be true. Using bit-packing as shown in the current state of the PR, the encoding was far worse. `0/1` encoding up to 928000 resulted in a hintsfile of 438Mb, whereas the run-lengths for height came in at 173Mb. I think 438Mb is not acceptable, so a hybrid approach is likely required. The construction of both files was around the same duration. I will do a more thorough analysis of chain history to see when each encoding style is appropriate.",
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#issuecomment-3664604170",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21613982156,
      "node_id": "HRFPE_lADOABII587cKlOpzwAAAAUISzHM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21613982156",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "8abdfec5eb5ed204f2dbdbf3d5c00ca052ade821",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/8abdfec5eb5ed204f2dbdbf3d5c00ca052ade821",
      "created_at": "2025-12-17T10:33:16Z"
    },
    {
      "event": "unlabeled",
      "id": 21614050198,
      "node_id": "UNLE_lADOABII587cKlOpzwAAAAUITDuW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21614050198",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-17T10:36:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 21616090262,
      "node_id": "LE_lADOABII587cKlOpzwAAAAUIa1yW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21616090262",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-17T12:20:52Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "referenced",
      "id": 21622785277,
      "node_id": "REFE_lADOABII587cKlOpzwAAAAUI0YT9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21622785277",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "e5c600dc0e06e00a7e938ba4d287f82257d9aeff",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e5c600dc0e06e00a7e938ba4d287f82257d9aeff",
      "created_at": "2025-12-17T17:16:35Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQzNzBmNmE3MDZiNjQ1MzFmOTcyZTA1YmFjZThkNmNhZGUxNDk3OGM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d370f6a706b64531f972e05bace8d6cade14978c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d370f6a706b64531f972e05bace8d6cade14978c",
      "tree": {
        "sha": "226003898e665289ba065de15bcc24d627ebcf80",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/226003898e665289ba065de15bcc24d627ebcf80"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 226003898e665289ba065de15bcc24d627ebcf80\nparent ab513103df8d1cadd2cf23397a39c652f3a2a550\nauthor rustaceanrob <rob.netzke@gmail.com> 1762872973 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766006650 +0000\n\nswiftsync: Add aggregate class\n\nThis class allows for the comparison of two sets `A` and `B`. Elements\nof `A` are added to a wrapping integer, and elements of `B` are also\nadded to a wrapping integer. If the two integers are equivalent, then\nsets `A` and `B` are equivalent. In this case we say they are\n\"balanced\".\n\nThe client-side salt is required to prevent the generalized birthday\nattack, whereby an attacker may choose a targeted hash collision and\nreduce the search space by a square root of the original security.\n\nCo-authored-by: l0rinc <pap.lorinc@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDH3sACgkQ9N2PhIbs\nDx8lWRAAil3gngyx6fiCyBF0yuLNRi/kWLCzqkchG90u1n6/dlHB7NP0LGhVWOvx\n1Y3w193aMSOBVNNsEdBfbqel2/GN5D1gJEZOy5hF3eaKNgEFIUqSorzpoKLW03db\nrnJCcLdqfBxcy0tWDNlfbON8oMAT22YwuaoH0IIn7gg0iNT02TWwonGA5nbU+HJu\naMkHpBoqzAUzpVJdbj4eKH4vd6974kVnuHcEO+PIhoVRM1I7cg2kY0apVyRLguCC\nXQBHanvEd/CJj4PFPpOMgSjEiUKqFq1/x6bPCIf9rfwnDN2RXEE2j0fMwbzcIusQ\nF8FjEDLXDJT2XpbrNI1yGLIcDJY5DZyOihMUnfKqI0cPVP44WkjceiZL7qi7JuZ2\ntTIz0oKqlGxk2XMJ/4cLnJGOdosYAk7nveK2SizceYsThh+Z9nOWd8rFDSgc5Wh+\nfjieYE7rh3ZdAKt+uQXwu67ED15auRofdWKUcG2rPyXWADaMX1GLSx4cgvSldARu\nKPr1jbvYK6OZYdfUGqiz2fb4VfHpBiqxANGFgM6rVwEMx5rYqBfrQJNpBVgioO63\nBAVPXFk7IlsopvfgoM4NTdG0PA1gjX8JlIPqSbjnjKMTwXTyn9Ac7exdEjaFRssY\nGYuU9M8uFlnvC3eHFzChWnIW3C8VKau4LDBi7MnGxPDw9H7VEQE=\n=ZneI\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ab513103df8d1cadd2cf23397a39c652f3a2a550",
          "sha": "ab513103df8d1cadd2cf23397a39c652f3a2a550",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ab513103df8d1cadd2cf23397a39c652f3a2a550"
        }
      ],
      "message": "swiftsync: Add aggregate class\n\nThis class allows for the comparison of two sets `A` and `B`. Elements\nof `A` are added to a wrapping integer, and elements of `B` are also\nadded to a wrapping integer. If the two integers are equivalent, then\nsets `A` and `B` are equivalent. In this case we say they are\n\"balanced\".\n\nThe client-side salt is required to prevent the generalized birthday\nattack, whereby an attacker may choose a targeted hash collision and\nreduce the search space by a square root of the original security.\n\nCo-authored-by: l0rinc <pap.lorinc@gmail.com>",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:24:10Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-11-11T14:56:13Z"
      },
      "sha": "d370f6a706b64531f972e05bace8d6cade14978c"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21628005112,
      "node_id": "HRFPE_lADOABII587cKlOpzwAAAAUJISr4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21628005112",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b125d65d150df03c3340b3bbf19c512a84e682a1",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/b125d65d150df03c3340b3bbf19c512a84e682a1",
      "created_at": "2025-12-17T21:30:54Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFmZjU5YTE1NDA3Y2I1ZmRjMmFlMDYzNThlNDUxMzQxNjZkYjI0NDg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1ff59a15407cb5fdc2ae06358e45134166db2448",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1ff59a15407cb5fdc2ae06358e45134166db2448",
      "tree": {
        "sha": "f93afbc73890cc9c9e9d0c35d64fcf865707096e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f93afbc73890cc9c9e9d0c35d64fcf865707096e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f93afbc73890cc9c9e9d0c35d64fcf865707096e\nparent d370f6a706b64531f972e05bace8d6cade14978c\nauthor rustaceanrob <rob.netzke@gmail.com> 1763386451 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766007166 +0000\n\ntest: swiftsync: Add aggregate test\n\nIntroduce a trivial example of creating and spending outpoints in\narbitrary order.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDIX8ACgkQ9N2PhIbs\nDx/ZyQ//U/8CH6fu0q1jUuvXICvDb8hvttj2ppAv+LGwTWouu8NICpTrtnWLHsS/\nmhhZKX2+8kZWaKX9fS4UvO1yZmHSZheALoUQP+BhryS5+RwD4LHLsLSm236V0BGI\n93Z+2HG9oTEtTYwJ1JpYJw6W+lmWHtIHZELTMSZL4P8c/PBeRoHzIqzLVhhmqyRb\n7H3SJ0exSUzA2smkDcJbd/mQEa0FOQOQB8kDWefg/FGPfSZccfhFOHIpfno/DVDp\nFXmh64owimJkVpbUmgiWLwOzhQG1wmRcE+kCto9grRtnQyWeAC/QrCSigZknzr36\n1JKU44k3hRccU1+9pcquALd0XSusDpPdB7m6boB7fb88gYameWfDdsb2CzzPCXx2\nrdmrhwiMX5yIAzKXRtAIrJOb2r3MVQy5E/Kpum8DzDfVDB/lA/uN+hhfEhviUCiu\nJaROA8a+YtprzQ9VPmVN4fgLO2/5/NUwkd06aV0hbxadTi6zWYNrerhvwMLad9yL\nMzTni84+lm7FrN8lEd/FaJ59mhQ/3aVzR3RmCCjwde1NfNe/0SigrdFJyWouv3Qf\nkP0F8UOcBl3peo2XVVOFvHcrN0Y1b17ZrWutqjw54et/Xpukqq9KrPxyGbuyaebL\nMArrA9k6QhstlhM6Q6S7JX/svRqcOIfyfqopA8TeX3XGr7x+GOQ=\n=WOni\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d370f6a706b64531f972e05bace8d6cade14978c",
          "sha": "d370f6a706b64531f972e05bace8d6cade14978c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d370f6a706b64531f972e05bace8d6cade14978c"
        }
      ],
      "message": "test: swiftsync: Add aggregate test\n\nIntroduce a trivial example of creating and spending outpoints in\narbitrary order.",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:32:46Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-11-17T13:34:11Z"
      },
      "sha": "1ff59a15407cb5fdc2ae06358e45134166db2448"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI3YzRhZjNhZGJiZTdlMDMxMDdiOGVhM2IwMjM5YTA0ZDNkYjgzM2Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/27c4af3adbbe7e03107b8ea3b0239a04d3db833d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/27c4af3adbbe7e03107b8ea3b0239a04d3db833d",
      "tree": {
        "sha": "d7e8a5cf386ed9fafcb6aa1551ef14586abdceec",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d7e8a5cf386ed9fafcb6aa1551ef14586abdceec"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d7e8a5cf386ed9fafcb6aa1551ef14586abdceec\nparent 1ff59a15407cb5fdc2ae06358e45134166db2448\nauthor rustaceanrob <rob.netzke@gmail.com> 1762941925 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766007177 +0000\n\nswiftsync: Add hintfile reader/writer\n\nThe set of all inputs ever created and the set of all outputs are not\nequivalent sets. Naturally, some outputs will be unspent. To update the\naggregate correctly, we require \"hints\" as to what outputs will remain\nin the UTXO set at a particular height in the chain. These hints allow a\nclient to verify `inputs = outputs - UTXOs` for a terminal block height.\n\nThe hints are encoded using a bitset, where a `0` represents an output\nthat will be spent, and a `1` represents an output that will be unspent.\n\nA header section is added so multiple blocks may be encoded\nconcurrently. The header section denotes the block height and file\nposition.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDIYkACgkQ9N2PhIbs\nDx9hZQ//QDzkBLY4Xmv/j4U0X8VoGqRU3/vhcipbDfKt2QVejRjy5ZcSMC70UcXn\noXzp2Va/cwCh45pbMfRGKj/zuy5HRnd4U5HCfZzKr4dW3w2APQ/iiOD6CJ/j8vsq\nEJ+kw/oh9+2TbEaXQFcu2QFsWnJOxb3K/StWfY0Lxe4q3NF/jatuTZ1WdYy0/aMs\nKtCZigrWimzyD9Z0/z4Hg2j5k4MwPokK1ZtV55dDfNN1brdFK/41lXOFBFVr0zm/\n9hQmzMYWxvjlkVyS7zUGD5Nt+EvdtYB0gXQwjN4eVVFC7ZjtBJn1Y2F0EEMoqOx9\nsg4fCqtsGB5KG3S7dBwvojcA0CAbUbxEzSH/Z8LMynFfcQ6j6CdOXPQdVSumK0RJ\nCenFdjOISL9cA/s7jm1SP6D0wg5X3bv60NLrXZlwGTU/I/TJKlSEbgsxzav2iLiL\nH7pNG7Q6hBwe3M4PTdRlZxhj53eryIIra2Gyz+lnoM4gChLT2C5R0utxRE0psCoA\nsdhsP95CBJL7R4PWKgq5BNGzwA3yrNiGMQlfGyHi+pPNgT7OL5Qc3CXoZya155Al\ntCjwqOxDhXhHNTOE9KqKTjZCEbiR1W/3d+Npu12i45WUYqPUTnSYoNyAa6w5OwXe\nHUEVTDlx3JJynWuLDytyf3Bfk5oHgZeTCjMB1kkkCUvIJ8hKmp8=\n=UDg3\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1ff59a15407cb5fdc2ae06358e45134166db2448",
          "sha": "1ff59a15407cb5fdc2ae06358e45134166db2448",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1ff59a15407cb5fdc2ae06358e45134166db2448"
        }
      ],
      "message": "swiftsync: Add hintfile reader/writer\n\nThe set of all inputs ever created and the set of all outputs are not\nequivalent sets. Naturally, some outputs will be unspent. To update the\naggregate correctly, we require \"hints\" as to what outputs will remain\nin the UTXO set at a particular height in the chain. These hints allow a\nclient to verify `inputs = outputs - UTXOs` for a terminal block height.\n\nThe hints are encoded using a bitset, where a `0` represents an output\nthat will be spent, and a `1` represents an output that will be unspent.\n\nA header section is added so multiple blocks may be encoded\nconcurrently. The header section denotes the block height and file\nposition.",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:32:57Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-11-12T10:05:25Z"
      },
      "sha": "27c4af3adbbe7e03107b8ea3b0239a04d3db833d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc3YjI1MThlOTkwM2QwYjFmZmZlMWNhN2NmZDVmN2UxOTFhZjBiNWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a",
      "tree": {
        "sha": "19bda24f2e1e04d0d816079cee93f32d139d3d32",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/19bda24f2e1e04d0d816079cee93f32d139d3d32"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 19bda24f2e1e04d0d816079cee93f32d139d3d32\nparent 27c4af3adbbe7e03107b8ea3b0239a04d3db833d\nauthor rustaceanrob <rob.netzke@gmail.com> 1763742157 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766007178 +0000\n\ntest: swiftsync: Add roundtrip hintfile read/write\n\nAssert that writing elements to file in an arbitrary order and reading\nthem back in an arbitrary order does not fail.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDIYoACgkQ9N2PhIbs\nDx+HSg//bouUQF+H6pCsOJxqkb7Iai936HjSCKZFIXF2yw1GUnw1t3sks1Cwdnjp\nPdFNQDSfBR10DdpVwAY3DFMCbsPfRTcPcZE5d94LmkvyVQobprrItkJ+V4bQszGv\nyDmZWK9naPNoGhWlEiplH/JZZDuB6nlp2X61lLWOuF7mjp+BjggVuKQpgAhLEPPQ\n8ubm0VtdaqPB0zdaAPlY2Zx31L8xUDexQx27uSPPJJZGcc2U31ESKLp0INi0NAP6\nP+wz8NUrITe2Z6zVLBfcBVlMdZqivpC85fuZhjwTI0JYHiikTp8JfsFmM4h56aOP\nJgwCrvi/rFdqIq2Eh4IQ1/qtBUMML7i5TxwDDUWf8Me/J3NqNWh1gFmL/ELH2w3C\nKbisj0Q6WHY/pzmClzXxdQU5Phzwj1+5ZheO2U34AcHNyWpvuu8+r3D0OdvkV5rX\nYTz4qWmSgne/e9f/LQn8VuJedOJZf6QoE0b36N98f9R2V5wkG7onar+H7WElvSSq\n7wLe/S9m6ox0I8pOfwrIygH6QdKBejlLvzOvd0R4513IAZjjPXiuEo68R96xwnAY\n6ip0q2qUGiofNkqMH7Fv5Izt105+P6M6G6rG4syBgnLPezOlDPJZWYtb3tp9Qnrw\num/1rXxw3fvqx+DN48hM5KHO7UwHFnOAmNA+o4tMkd3J/AZ4tSU=\n=qkiA\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/27c4af3adbbe7e03107b8ea3b0239a04d3db833d",
          "sha": "27c4af3adbbe7e03107b8ea3b0239a04d3db833d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/27c4af3adbbe7e03107b8ea3b0239a04d3db833d"
        }
      ],
      "message": "test: swiftsync: Add roundtrip hintfile read/write\n\nAssert that writing elements to file in an arbitrary order and reading\nthem back in an arbitrary order does not fail.",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:32:58Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-11-21T16:22:37Z"
      },
      "sha": "77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGE1OTIxMGIxMTExNTJlM2EwMTU4ZGIwNTVlNjM4MGFlNDYxNTVhMmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a59210b111152e3a0158db055e6380ae46155a2e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a59210b111152e3a0158db055e6380ae46155a2e",
      "tree": {
        "sha": "e068b4412d6ae94eafd85b3ef692e6c08881bf8c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e068b4412d6ae94eafd85b3ef692e6c08881bf8c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e068b4412d6ae94eafd85b3ef692e6c08881bf8c\nparent 77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a\nauthor rustaceanrob <rob.netzke@gmail.com> 1762337535 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766007178 +0000\n\nrpc: Generate UTXO set hints\n\nGenerate hints for the location of UTXOs in each block. This RPC allows\nfor a rollback of the chainstate to an arbitary height. Currently, the\nhintfile is made in sequential order, but this may be done in parallel\nas a future improvement.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDIYsACgkQ9N2PhIbs\nDx/IDBAAiWQIUb3mhwhSbiCEdcg/mAMakme+ZXYypV+8lrvP55cSlg290FFOXiuo\ne/FlsuWWMDWK8qLcluAiLAYhry4GhOHRiALUWS179JtO6JBQtvUrQJGdB6amooVA\nwYYk08p974NlIa3G1uxvWPQvbBgNM4r2KToE5eC67B6TU2x+0/s+6hwRU9vc8zjb\ntSmewF7dnnCpcjDIDvgxIBE9qisbse82jLlYBd22XmEd6x9Wi3cWIQP6DgIEo8yN\n4jMdGPt9Zmfs43zx8kHdXqYHXbB2tEV0t6ouiaetEadarEnGoGt+VY7WbGpnYv6y\nLxEkoffiY1iQMl1gKmD5vr6TwNCX4p3CA6mF7YNGfNy1jFLRl63dlS0l6vRLQ+wZ\nYNaWNGu3NTombqSszUcowME/tM9qdlqOaYOUlxGa8MkokzQqJCJiqfK0TiCtIPOS\n5BRzqp76s7EgwuJVPXjlWGlAp8jn+XZtOAP6nLJUz4l4DdUegAlAYGiF+cZC2GCj\njeATxAkuuAd/lA2oD7TfM/45OgENiLdTcmVatGsc/QDlWJmft0EqUMLo3keGe+qw\nrlOh0NMsA0VZmn7rcZT1ctZL3+on8/cxRNWeatijf4NLBYwUfcqIJHOnq1sf3A7n\noVH8ctDmDOGW8mZ4LXz1kf0jT9mNgr14JVks+Nu+am66Kq0r2yo=\n=LfU/\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a",
          "sha": "77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a"
        }
      ],
      "message": "rpc: Generate UTXO set hints\n\nGenerate hints for the location of UTXOs in each block. This RPC allows\nfor a rollback of the chainstate to an arbitary height. Currently, the\nhintfile is made in sequential order, but this may be done in parallel\nas a future improvement.",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:32:58Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-11-05T10:12:15Z"
      },
      "sha": "a59210b111152e3a0158db055e6380ae46155a2e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ4Yjg4ZjBmNTMwMzBkMTdlZjk1YjIwYzFkOWIxYjMyODkwZDNkYzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/48b88f0f53030d17ef95b20c1d9b1b32890d3dc6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/48b88f0f53030d17ef95b20c1d9b1b32890d3dc6",
      "tree": {
        "sha": "130f9185af1cd8584e22725dfafcafbb163abc20",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/130f9185af1cd8584e22725dfafcafbb163abc20"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 130f9185af1cd8584e22725dfafcafbb163abc20\nparent a59210b111152e3a0158db055e6380ae46155a2e\nauthor rustaceanrob <rob.netzke@gmail.com> 1763985472 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766007179 +0000\n\nswiftsync: Add unified context class\n\nThis combines the aggregate and hints into a single class for consumers\nto interact with. The SwiftSync protocol is only possible if: the entire\nblock history is being downloaded from genesis, the protocol is not\nalready completed, and there are hints avaiable to use. If all of these\nconditions are met within the internal context, SwiftSync is possible.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDIYwACgkQ9N2PhIbs\nDx+DfRAAthXzer5XsoX/Msx4rgYx77noF4zZH6ogxPOisqrTsL5r6vuOwkOEfh9S\nsmP4RPT74Q4iA86N7Wn82vdJRWgRX/TAWWL67F8NpuO2XoqsFIm8X0CI5DRjPkAQ\nmbDmsQAHpM18V+OuShhHLehaT5D63soXKRRDdvVzIiQBaRwtIlIuXBwD7FqZzbov\nlUyEyEttex1sx6h/OCLJSiJzRCkJCCpMCwQYalzK3xNOgH3XedV2kzXJzyJshtvo\ndpbSIGyBUT7gtEZC9SKnFstOhjs6JkBtwhWDDctDSZ9zUfYrDM+swLWdy4N5KAZX\neeGJMCIKRufZxJY7rMh9GPZXw8NE0m4crj77/KPn67OzT6/l7/CDSeJ7rPLaCC+4\nXIMaw3wPYVUZFFyCOkrtU6C/NVCfDK4hRQwzwJWLPKKGsB1F5r6PXIeLu/g3aGAI\noytH0V2NHnbiLIwV4mleqDcGL7IsYdIeKD6bYSxjSBaIGOp3JXRsvMCzghwcWf94\nmv1iKSeAzS4W/e3Sw1mwEthEsf9jb+HCnLjDJXW4JS381PQU1kS0jK7SBravu6wV\ni4+nN2di8TeQJNEZu9LiBrROlxmQeAeQzwgzNF1qcjlsjPnd9cohun8oVEmjW6Du\nU10ymIP8RG6bOilEaZ4FVqa2rq40i9Uv4i4R/OGGaRzx5XHZnHE=\n=/hBw\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a59210b111152e3a0158db055e6380ae46155a2e",
          "sha": "a59210b111152e3a0158db055e6380ae46155a2e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a59210b111152e3a0158db055e6380ae46155a2e"
        }
      ],
      "message": "swiftsync: Add unified context class\n\nThis combines the aggregate and hints into a single class for consumers\nto interact with. The SwiftSync protocol is only possible if: the entire\nblock history is being downloaded from genesis, the protocol is not\nalready completed, and there are hints avaiable to use. If all of these\nconditions are met within the internal context, SwiftSync is possible.",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:32:59Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-11-24T11:57:52Z"
      },
      "sha": "48b88f0f53030d17ef95b20c1d9b1b32890d3dc6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQwMTlmOWFiZTcwYmE5YjQ4OGJhYWMzNDU0ZTljODUzYjA0ZmU4ODU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d019f9abe70ba9b488baac3454e9c853b04fe885",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d019f9abe70ba9b488baac3454e9c853b04fe885",
      "tree": {
        "sha": "71f283f2a8e24b7cfe86728d5a32fe770f4649cf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/71f283f2a8e24b7cfe86728d5a32fe770f4649cf"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 71f283f2a8e24b7cfe86728d5a32fe770f4649cf\nparent 48b88f0f53030d17ef95b20c1d9b1b32890d3dc6\nauthor rustaceanrob <rob.netzke@gmail.com> 1763988938 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766007180 +0000\n\ninit: Add hintfile path arg\n\nAllow a user to pass a file path to UTXO hints, failing for any errors\nencountered.\n\nNamely, undo-data cannot be written during this implementation of\nSwiftSync. A partial compension for this is to only allow hints when\nusing `-prune`, as undo-data will be deleted anyway.\n\nA SwiftSync context is applied to the active chainstate. If a hints file\nis present, it is passed to the active chainstate for use later.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDIY0ACgkQ9N2PhIbs\nDx8JzQ//Q4e8su+rPfWxxfHYX3MlqYiQDTI60awmigt+MsZHvd/XUnlVlYKFcwup\nI+l9zzWEbyNuEck+39xUhoMoTLlJi5dYE0eEOj1ZD9+NSz15oW1ppg8M+G7uKQ1e\nV75neGpQ2uVuqQHLhKF8Dt7SBZ2q60d0Hnq1AJ9La6DZmf9lhdZVWJig0QmIHbvJ\nLcfoxUeo/eoZeLIb2UetO+BsWdosCZdthnqtcOS7TSR1MlblEMOx9pNrXu8K6UIG\nhYH3Mjshefi5fuUXCQW0xwfq7NQq/v5+xif76PWB31Jco/xaKm/KPxB31LYH0/Zn\nPvG3xT/0jKxKwAcgRX697CweG6beSFU3GXR4jccfOWoliX47qABE1i0gsPN9+BHP\n4hnHic49VeIp4Qv6kqUXv/9aPxYUdbu1w6PGyqiQLqk/rbufybloE4qbmznyGpSV\n2KIpKZTiFyKcsBXzyspUBylpfCSsAZFPR9owdlnoAd0fsq3vOBIDnEYyR95zEuJo\nJAJa1SZSCvtE35WOB97hDZpWSwM1OZNjGpqQ+kkPscAXGL6Q4IjpyiFlZCGWnIh/\nxWGRyPiPL3M3Np4ioQZpyQNZIdZ+pExdGekIh6HfevKoAPiEGTzVMIpO53pmSdC2\nTi3Zp+BXg84aS+XRN5D5x6NNMkQpNoBIiDxckry9rbyYqYnPnl8=\n=qjof\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/48b88f0f53030d17ef95b20c1d9b1b32890d3dc6",
          "sha": "48b88f0f53030d17ef95b20c1d9b1b32890d3dc6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/48b88f0f53030d17ef95b20c1d9b1b32890d3dc6"
        }
      ],
      "message": "init: Add hintfile path arg\n\nAllow a user to pass a file path to UTXO hints, failing for any errors\nencountered.\n\nNamely, undo-data cannot be written during this implementation of\nSwiftSync. A partial compension for this is to only allow hints when\nusing `-prune`, as undo-data will be deleted anyway.\n\nA SwiftSync context is applied to the active chainstate. If a hints file\nis present, it is passed to the active chainstate for use later.",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:33:00Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-11-24T12:55:38Z"
      },
      "sha": "d019f9abe70ba9b488baac3454e9c853b04fe885"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJhNzZlZjY3ZmFlZWY1OGJjZGVhMzUwNTg1YzFiMjcyMjcxZTE1Y2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ba76ef67faeef58bcdea350585c1b272271e15ca",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ba76ef67faeef58bcdea350585c1b272271e15ca",
      "tree": {
        "sha": "88e4f925eff351fc31b04f6bdb6d180b77cee05e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/88e4f925eff351fc31b04f6bdb6d180b77cee05e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 88e4f925eff351fc31b04f6bdb6d180b77cee05e\nparent d019f9abe70ba9b488baac3454e9c853b04fe885\nauthor rustaceanrob <rob.netzke@gmail.com> 1764000442 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766007181 +0000\n\nvalidation: Use UTXO hints in `ConnectBlock`\n\nDuring the SwiftSync protocol, inputs are not fetch-able from the coins\nview. This means the following cannot be checked until the terminal\nstate may be verified as valid:\n1. inputs do not attempt to spend more coins than available\n2. script validity\n3. sigops\n4. subsidy + fees = coinbase\n\nAt the terminal SwiftSync height, we verify the history of transaction\ninputs and outputs that have been fetched indeed correspond to the\nresulting UTXO set. In the case of success, IBD continues as usual. In\nthe case of a failure, the UTXO set present does _not_ correspond to the\nblock history received. In this situation, the program should crash and\nindicate to the user that they may recover the correct UTXO set with a\n`-reindex`.\n\nOf note, writing undo-data is not possible until the UTXO set present on\ndisk is verified as correct.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDIY0ACgkQ9N2PhIbs\nDx+qNRAAlqKoDhAulxkD/hoJ9IUnjocCtBiJOFkf3nCWEVAD5jkQJSFRHDzVInmf\nOhV+9jgxUG5S+uNjd+im5uMdqCLt8NChi9fU73XJVPtDcxR45pt+9l6kc3sD2fnI\n56jniFMkYcwxIxNJZJo+9rXeaLrkksln+46qfbrClbXKPBdY3aAfsHRI5cHCMfAY\nFzN/f7ec0ath+Xq/qMeisoFiZmZ75FhZTAyHU87q2U9BWRgCQfUDPCcokpEPZ2Pk\nUFvprFL2dZ1FEl4QiNZUo7YJKwQ+x9BLG9ucA1JjRx9uQI23gMxov9OUtSqlFGdz\nwNYQQxUaQTlEpgQi7R9vFdngd3/mUf4zcCois8L44HC5c1gXgnVxbtkvbUrAVpPi\nABkZey69PtM2SdZH0Iy0kNuEjiO7/NekK32S+2hFhLEEF/iu7RQBmsFNe1qaB27N\nxtphDOpol/pKBefetAx1qLyNTR470P2YC1F63/xlXlkl3t2epyY7tNOXxfaelDjx\nkrpk2WDfR5vJ03vP/UGN4S/wWY6L//E0bQv+KVZDfYq5E5aOaRQrN1G/2K9yGXld\nXdWg1RU363apLv7edrgrUEtQqPowDc+irbDmXGdb+cqlvIXKsJL2UheGA36Pxg4P\ngamqNxS+T3fHdPFnZ4uosuswCC2g/89qNg5yZbxwbq3NyNI0srk=\n=DkTj\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d019f9abe70ba9b488baac3454e9c853b04fe885",
          "sha": "d019f9abe70ba9b488baac3454e9c853b04fe885",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d019f9abe70ba9b488baac3454e9c853b04fe885"
        }
      ],
      "message": "validation: Use UTXO hints in `ConnectBlock`\n\nDuring the SwiftSync protocol, inputs are not fetch-able from the coins\nview. This means the following cannot be checked until the terminal\nstate may be verified as valid:\n1. inputs do not attempt to spend more coins than available\n2. script validity\n3. sigops\n4. subsidy + fees = coinbase\n\nAt the terminal SwiftSync height, we verify the history of transaction\ninputs and outputs that have been fetched indeed correspond to the\nresulting UTXO set. In the case of success, IBD continues as usual. In\nthe case of a failure, the UTXO set present does _not_ correspond to the\nblock history received. In this situation, the program should crash and\nindicate to the user that they may recover the correct UTXO set with a\n`-reindex`.\n\nOf note, writing undo-data is not possible until the UTXO set present on\ndisk is verified as correct.",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:33:01Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-11-24T16:07:22Z"
      },
      "sha": "ba76ef67faeef58bcdea350585c1b272271e15ca"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg2ZDAwOWQwMDA5YTUzYmJiNDI5MjNiMWMxYzA2MmYxMTQ5OWQ0ODE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/86d009d0009a53bbb42923b1c1c062f11499d481",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/86d009d0009a53bbb42923b1c1c062f11499d481",
      "tree": {
        "sha": "e2f4fc2a9c1ac877b140a50f125018048e163e0b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e2f4fc2a9c1ac877b140a50f125018048e163e0b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e2f4fc2a9c1ac877b140a50f125018048e163e0b\nparent ba76ef67faeef58bcdea350585c1b272271e15ca\nauthor rustaceanrob <rob.netzke@gmail.com> 1764586752 +0000\ncommitter rustaceanrob <rob.netzke@gmail.com> 1766007182 +0000\n\ntest: swiftsync: Add integration test\n\nThe following test asserts that a client may sync to the network tip\nusing a hints file and may reorganize thereafter. Furthermore, it tests\na faulty hints file cannot be used to leave a client in an invalid\nstate, and any client given a bad file may recover with a reindex.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyfvDMeToPs1c0LWs9N2PhIbsDx8FAmlDIY4ACgkQ9N2PhIbs\nDx+seA/+IAmDnmsuClnoabxiTrxVoMLmJAT1hexaC11F51KXL12FnJncqU86pRYC\nIaXUTl2CS99KMKl4lvEo2fy1SdIegv9qJPYP4/ag6tCuRNUUz620GGAmMmazYojh\nwbxQOyTc7toBCj2gSeWotUmBobkaNTHfBSoO7363c8rpQZccyw5SbHVmJ7f8m5sR\nqZGDHnq6Rl286bdGu28FQ6Bhb1WGArrZVX3Z7NWCGUie4edIvjYG7TTMFtICL/eS\ntc78BL8ZXL+LhXoluYZUhl7LQXE6RkYBfDGfR/Ha4gwUV2WjWgh4praDMMIXk/mo\n+FV+2NQ+MAWT1ifM0nMAnhUKQ//9zjgnqfLknjxkQ3c6VfniVvsVvX1crDiTunVS\nZlJxQ6/miyDGB9tJY+O/guGQ4WWTNvROJFlTkoyS5VXGjAFJW3lzCJCeNki62FAX\nzBMLhc90ZVbw5eJEI5bjj9LSUfrA9I7rcR5U0gBN1ocQW/gQcwyvDjwQ9oLg4NPT\nxpHg1yJoRqRU7nSirPmKoCUwW1aYqgpoBPgdWtRWYj56ZbemTC08Qig1MIlv9tO1\nL1knWU4LOCXowRmgwZUSZYjO1RfPxE0RcH0wbaRqiObZKliya2cbfPDrCe6wrj3g\nHegVWfCbIhHVHWrOE1tSDZeGbQPHpF1iEXB/2kExalMvpsmkiLI=\n=Ij7m\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ba76ef67faeef58bcdea350585c1b272271e15ca",
          "sha": "ba76ef67faeef58bcdea350585c1b272271e15ca",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ba76ef67faeef58bcdea350585c1b272271e15ca"
        }
      ],
      "message": "test: swiftsync: Add integration test\n\nThe following test asserts that a client may sync to the network tip\nusing a hints file and may reorganize thereafter. Furthermore, it tests\na faulty hints file cannot be used to leave a client in an invalid\nstate, and any client given a bad file may recover with a reindex.",
      "committer": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-17T21:33:02Z"
      },
      "author": {
        "name": "rustaceanrob",
        "email": "rob.netzke@gmail.com",
        "date": "2025-12-01T10:59:12Z"
      },
      "sha": "86d009d0009a53bbb42923b1c1c062f11499d481"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21628072881,
      "node_id": "HRFPE_lADOABII587cKlOpzwAAAAUJIjOx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21628072881",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "commit_url": "https://api.github.com/repos/rustaceanrob/bitcoin/commits/86d009d0009a53bbb42923b1c1c062f11499d481",
      "created_at": "2025-12-17T21:33:22Z"
    },
    {
      "event": "commented",
      "id": 3667635232,
      "node_id": "IC_kwDOABII587am6wg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3667635232",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-17T23:58:02Z",
      "updated_at": "2025-12-17T23:58:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Regarding the pruned-only feature. This would not be the case if there was a P2P message for undo-data. It would allow undo-data to be written in an un-trusted state and later confirmed as valid with a check of IsBalanced. Not to mention it would allow for full validation.\r\n\r\nAre you intending to work on this P2P message? Is this part of any specification?",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#issuecomment-3667635232",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004"
    },
    {
      "event": "reviewed",
      "id": 3590009095,
      "node_id": "PRR_kwDOABII587V-zEH",
      "url": null,
      "actor": null,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-17T23:58:22Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3590009095",
      "submitted_at": "2025-12-17T23:58:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "reviewed",
      "id": 3592577690,
      "node_id": "PRR_kwDOABII587WImKa",
      "url": null,
      "actor": null,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-18T12:04:47Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#pullrequestreview-3592577690",
      "submitted_at": "2025-12-18T12:04:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
    },
    {
      "event": "commented",
      "id": 3672031975,
      "node_id": "IC_kwDOABII587a3sLn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3672031975",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-18T20:06:22Z",
      "updated_at": "2025-12-18T20:06:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Are you intending to work on this P2P message? Is this part of any specification?\r\n\r\nYeah I plan on creating a patch to add this, either here or separately. Notably, the [UTREEXO BIPs](https://github.com/bitcoin/bips/pull/1923) specify serving undo data, however it is also grouped with proofs that SwiftSync would not require. I will suggest as a comment that these messages may be appropriate to split into undo-data and proofs, as there are a number of use cases for a network message for this data. The easiest approach would be to use the current compressed serialization format and send that directly over the wire.",
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#issuecomment-3672031975",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004"
    },
    {
      "event": "referenced",
      "id": 21767557372,
      "node_id": "REFE_lADOABII587cKlOpzwAAAAURcpD8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21767557372",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b1593ac93048bc7f2651fd99feb6e323c6a8a770",
      "commit_url": "https://api.github.com/repos/0xB10C/bitcoin/commits/b1593ac93048bc7f2651fd99feb6e323c6a8a770",
      "created_at": "2025-12-28T00:00:40Z"
    },
    {
      "event": "commented",
      "id": 3716715648,
      "node_id": "IC_kwDOABII587diJSA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3716715648",
      "actor": {
        "login": "exd02",
        "id": 62575526,
        "node_id": "MDQ6VXNlcjYyNTc1NTI2",
        "avatar_url": "https://avatars.githubusercontent.com/u/62575526?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/exd02",
        "html_url": "https://github.com/exd02",
        "followers_url": "https://api.github.com/users/exd02/followers",
        "following_url": "https://api.github.com/users/exd02/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/exd02/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/exd02/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/exd02/subscriptions",
        "organizations_url": "https://api.github.com/users/exd02/orgs",
        "repos_url": "https://api.github.com/users/exd02/repos",
        "events_url": "https://api.github.com/users/exd02/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/exd02/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-06T23:25:16Z",
      "updated_at": "2026-01-07T12:03:04Z",
      "author_association": "NONE",
      "body": "@rustaceanrob \r\n### Possible issue with `generatetxohints` when passing rollback parameter\r\n\r\nI am testing the `generatetxohints` RPC in my full node (performing IDB, currently in block 912483) and observed a possible unexpected behavior when the optional rollback parameter is provided:\r\n\r\n### Setup / Command\r\n```\r\n./build/bin/bitcoin-cli \\\r\n  -datadir=/run/media/exd/hd1/Bitcoin \\\r\n  --rpcclienttimeout=0 \\\r\n  generatetxohints ~/teste/test.hints 10000\r\n```\r\n\r\n### Behaviour\r\n- When no block height is provided:\r\n  - The hint file is generated successfully.\r\n- When a block height is provided:\r\n  - The output file is `test.hints.incomplete` (and it's empty)\r\n\r\n### Debugging details\r\nI attached gdb to `bitcoind` and set a breakpoint at `rpc/blockchain.cpp:3457` (I believe that if there is an error it should be here, because the problem only occurs when `params[1]` is defined):\r\n\r\n```cpp\r\nif (!request.params[1].isNull()) { // <----- Breakpoint here\r\n    const CBlockIndex* invalidate_index = ParseHashOrHeight(request.params[1], *node.chainman);\r\n    invalidate_index = WITH_LOCK(::cs_main, return node.chainman->ActiveChain().Next(invalidate_index));\r\n    rollback.emplace(*node.chainman, *invalidate_index);\r\n}\r\n```\r\n\r\n```sh\r\n# attached the debugger\r\ngdb build/bin/bitcoind\r\n(gdb) set args -datadir=/run/media/exd/hd1/Bitcoin -debug=rpc\r\n(gdb) start\r\n(gdb) break rpc/blockchain.cpp:3457\r\n(gdb) continue\r\n\r\n# called generatetxohints from cli\r\n./build/bin/bitcoin-cli -datadir=/run/media/exd/hd1/Bitcoin --rpcclienttimeout=0 generatetxohints ~/teste/test.hints 10000\r\n\r\n# gdb output\r\nThread 4 \"b-httpworker.0\" hit Breakpoint 2, generatetxohints()::$_0::operator()(RPCHelpMan const&, JSONRPCRequest const&) const (request=..., this=<optimized out>, self=...) at ./rpc/blockchain.cpp:3457\r\n3457\t    if (!request.params[1].isNull()) {\r\n(gdb) n\r\n3458\t        const CBlockIndex* invalidate_index = ParseHashOrHeight(request.params[1], *node.chainman);\r\n(gdb) n\r\n3459\t        invalidate_index = WITH_LOCK(::cs_main, return node.chainman->ActiveChain().Next(invalidate_index));\r\n(gdb) n\r\n3460\t        rollback.emplace(*node.chainman, *invalidate_index);\r\n(gdb) n\r\n\r\n# after this point, the RPC execution does not continue its expected flow. Instead, the node resumes normal tip validation (UpdateTip logs continue), while the generatetxohints RPC appears to stall. The output file remains as `test.hints.incomplete`, stays empty, and is never finalized. No explicit error is returned.\r\n2026-01-06T23:05:37Z UpdateTip: new best=00000000000000000001c4803c902cfab517056bd8191e1d5870b2c58c36d3c2 height=912483 version=0x2001e000 log2_work=95.797984 tx=1234594715 date='2025-08-30T23:36:43Z' progress=0.953049 cache=15.6MiB(115671txo)\r\n...\r\n```\r\n\r\n### Question\r\nAm I using `generatetxohints` incorrectly, or is this an unintended behavior when the rollback parameter is provided?",
      "user": {
        "login": "exd02",
        "id": 62575526,
        "node_id": "MDQ6VXNlcjYyNTc1NTI2",
        "avatar_url": "https://avatars.githubusercontent.com/u/62575526?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/exd02",
        "html_url": "https://github.com/exd02",
        "followers_url": "https://api.github.com/users/exd02/followers",
        "following_url": "https://api.github.com/users/exd02/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/exd02/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/exd02/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/exd02/subscriptions",
        "organizations_url": "https://api.github.com/users/exd02/orgs",
        "repos_url": "https://api.github.com/users/exd02/repos",
        "events_url": "https://api.github.com/users/exd02/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/exd02/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#issuecomment-3716715648",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34004"
    },
    {
      "event": "mentioned",
      "id": 21886790634,
      "node_id": "MEE_lADOABII587cKlOpzwAAAAUYjevq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21886790634",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-06T23:25:18Z"
    },
    {
      "event": "subscribed",
      "id": 21886790647,
      "node_id": "SE_lADOABII587cKlOpzwAAAAUYjev3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21886790647",
      "actor": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-06T23:25:18Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2588961718",
      "pull_request_review_id": 3539878634,
      "id": 2588961718,
      "node_id": "PRRC_kwDOABII586aUGu2",
      "diff_hunk": "@@ -0,0 +1,35 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <span>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 19,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "183fd9aa2e06826f2a1cf708278b19db2fbecc68",
      "in_reply_to_id": null,
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "To suppress the UB sanitizer here I added a `__attribute__(no_sanitize ... ))` which cause a CI failure on windows. Is there 1. a wrapping addition/subtraction API I am not aware of 2. a way to suppress UB across all targets",
      "created_at": "2025-12-04T12:53:02Z",
      "updated_at": "2025-12-04T12:53:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2588961718",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2588961718"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2589210000",
      "pull_request_review_id": 3540197389,
      "id": 2589210000,
      "node_id": "PRRC_kwDOABII586aVDWQ",
      "diff_hunk": "@@ -0,0 +1,35 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <span>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 19,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "183fd9aa2e06826f2a1cf708278b19db2fbecc68",
      "in_reply_to_id": 2588961718,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "You\r\nmay need to use a suppressions file, see `test/sanitizer_suppressions`. They may be\r\nused as follows:\r\n```bash\r\nexport LSAN_OPTIONS=\"suppressions=$(pwd)/test/sanitizer_suppressions/lsan\"\r\nexport TSAN_OPTIONS=\"suppressions=$(pwd)/test/sanitizer_suppressions/tsan:halt_on_error=1:second_deadlock_stack=1\"\r\nexport UBSAN_OPTIONS=\"suppressions=$(pwd)/test/sanitizer_suppressions/ubsan:print_stacktrace=1:halt_on_error=1:report_error_type=1\"\r\n```\r\n\r\n",
      "created_at": "2025-12-04T14:02:08Z",
      "updated_at": "2025-12-04T14:02:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2589210000",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2589210000"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591783568",
      "pull_request_review_id": 3543553336,
      "id": 2591783568,
      "node_id": "PRRC_kwDOABII586ae3qQ",
      "diff_hunk": "@@ -981,6 +983,10 @@ bool AppInitParameterInteraction(const ArgsManager& args)\n         if (args.GetBoolArg(\"-reindex-chainstate\", false)) {\n             return InitError(_(\"Prune mode is incompatible with -reindex-chainstate. Use full -reindex instead.\"));\n         }\n+    } else {\n+        if (args.IsArgSet(\"-utxohints\")) {\n+            return InitError(_(\"UTXO hints cannot be used without pruned mode.\"));",
      "path": "src/init.cpp",
      "position": 22,
      "original_position": 22,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This seems like a very serious limitation currently, I don't see a huge difference between this and just loading the final `AssumeUTXO` state. If this is targeted to very low-memory environments, `AssumeUTXO` would be even better. I'm not a fan of `AssumeUTXO`, but it still seems better than just pruned `SwiftSync`.",
      "created_at": "2025-12-05T08:11:33Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2591783568",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591783568"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 988,
      "original_line": 988,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591793669",
      "pull_request_review_id": 3543553336,
      "id": 2591793669,
      "node_id": "PRRC_kwDOABII586ae6IF",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 58,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "any reason for passing height (and a few other similar primitives) as (const) reference?",
      "created_at": "2025-12-05T08:15:54Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2591793669",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591793669"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591794217",
      "pull_request_review_id": 3543553336,
      "id": 2591794217,
      "node_id": "PRRC_kwDOABII586ae6Qp",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;",
      "path": "src/swiftsync.cpp",
      "position": 51,
      "original_position": 54,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "why do we need a dummy during file writing?",
      "created_at": "2025-12-05T08:16:09Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2591794217",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591794217"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 51,
      "original_line": 51,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591795898",
      "pull_request_review_id": 3543553336,
      "id": 2591795898,
      "node_id": "PRRC_kwDOABII586ae6q6",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)\n+{\n+    // First write the current file position for the current height in the header section.\n+    uint64_t curr_pos = m_file.size();\n+    uint64_t cursor = FILE_HEADER_LEN + (m_index * (sizeof(uint64_t) + sizeof(uint32_t)));\n+    m_file.seek(cursor, SEEK_SET);\n+    m_file << height;\n+    m_file << curr_pos;\n+    // Next append the positions of the unspent offsets in the block at this height.\n+    m_file.seek(curr_pos, SEEK_SET);\n+    WriteCompactSize(m_file, unspent_offsets.size());\n+    for (const auto& offset : unspent_offsets) {\n+        WriteCompactSize(m_file, offset);\n+    }\n+    m_index++;\n+    return m_file.Commit();\n+}\n+\n+HintsfileReader::HintsfileReader(AutoFile& file) : m_file(file.release())\n+{\n+    std::array<uint8_t, 4> magic{};\n+    m_file >> magic;\n+    if (magic != FILE_MAGIC) {\n+        throw std::ios_base::failure(\"HintsfileReader: This is not a hint file.\");\n+    }\n+    uint8_t version{};\n+    m_file >> version;\n+    if (version != FILE_VERSION) {\n+        throw std::ios_base::failure(\"HintsfileReader: Unsupported file version.\");\n+    }\n+    m_file >> m_stop_height;\n+    for (uint32_t index = 1; index <= m_stop_height; index++) {",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 89,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "any reason for starting indexes at 1?\nnit: `++index` usage is more common",
      "created_at": "2025-12-05T08:16:52Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2591795898",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591795898"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 89,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591798846",
      "pull_request_review_id": 3543553336,
      "id": 2591798846,
      "node_id": "PRRC_kwDOABII586ae7Y-",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 33,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "any reason for storing 64 bit chunks instead of e.g. `arith_uint256`?",
      "created_at": "2025-12-05T08:18:11Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2591798846",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591798846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 33,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591801626",
      "pull_request_review_id": 3543553336,
      "id": 2591801626,
      "node_id": "PRRC_kwDOABII586ae8Ea",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);\n+    // Close the underlying file.\n+    int Close() { return m_file.fclose(); };\n+};\n+\n+/**\n+ * A file that encodes the UTXO set state at a particular block height.\n+ */\n+class HintsfileReader\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_stop_height;\n+    std::unordered_map<uint32_t, uint64_t> m_height_to_file_pos;",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 76,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: file pos could be `size_t` instead",
      "created_at": "2025-12-05T08:19:13Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2591801626",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591801626"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 72,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591803311",
      "pull_request_review_id": 3543553336,
      "id": 2591803311,
      "node_id": "PRRC_kwDOABII586ae8ev",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);\n+    // Close the underlying file.\n+    int Close() { return m_file.fclose(); };\n+};\n+\n+/**\n+ * A file that encodes the UTXO set state at a particular block height.\n+ */\n+class HintsfileReader\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_stop_height;\n+    std::unordered_map<uint32_t, uint64_t> m_height_to_file_pos;\n+\n+public:\n+    HintsfileReader(AutoFile& file);\n+    HintsfileReader(HintsfileReader&& o) noexcept;\n+    ~HintsfileReader()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    /** Read the hints for the specified block height. */\n+    std::vector<uint64_t> ReadBlock(const uint32_t& height);\n+    /** The height this file encodes up to. */\n+    uint32_t StopHeight() { return m_stop_height; };",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 88,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "what should happen when `-stopatheight` is smaller than this target? We can't stop before the swiftsync target...",
      "created_at": "2025-12-05T08:19:48Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2591803311",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591803311"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591809462",
      "pull_request_review_id": 3543553336,
      "id": 2591809462,
      "node_id": "PRRC_kwDOABII586ae9-2",
      "diff_hunk": "@@ -2535,14 +2565,18 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n     int nInputs = 0;\n     int64_t nSigOpsCost = 0;\n     blockundo.vtxundo.reserve(block.vtx.size() - 1);\n+    std::optional<swiftsync::BlockHints> hints;",
      "path": "src/validation.cpp",
      "position": 60,
      "original_position": 60,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "hmmm, when swiftsync isn't active we shouldn't have dangling state available in `validation.cpp` - it's already huge, can we make sure all of the state is encapsulated? This bothers me the most, I don't want the state sprinkled around (like we have with AssumeUTXO), it should be easy to disregard it when it's not active.",
      "created_at": "2025-12-05T08:22:08Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2591809462",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2591809462"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2595,
      "original_line": 2595,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602552925",
      "pull_request_review_id": 3543553336,
      "id": 2602552925,
      "node_id": "PRRC_kwDOABII586bH85d",
      "diff_hunk": "@@ -1377,6 +1384,10 @@ static ChainstateLoadResult InitAndLoadChainstate(\n         }\n     };\n     auto [status, error] = catch_exceptions([&] { return LoadChainstate(chainman, cache_sizes, options); });\n+    if (utxo_hints.has_value()) {\n+        LogInfo(\"Applying UTXO hints from file\");",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "83cb4ab1ee746edf0f4cc9bb3427549bd82e3042",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "we could log the file path here.",
      "created_at": "2025-12-09T13:00:10Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602552925",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602552925"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1388,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602556922",
      "pull_request_review_id": 3543553336,
      "id": 2602556922,
      "node_id": "PRRC_kwDOABII586bH936",
      "diff_hunk": "@@ -1790,11 +1801,34 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     bool do_reindex{args.GetBoolArg(\"-reindex\", false)};\n     const bool do_reindex_chainstate{args.GetBoolArg(\"-reindex-chainstate\", false)};\n \n+    std::optional<swiftsync::HintsfileReader> utxo_hints;\n+    if (args.IsArgSet(\"-utxohints\")) {\n+        fs::path path = fs::absolute(args.GetPathArg(\"-utxohints\"));\n+        if (!fs::exists(path)) {\n+            LogError(\"Provided UTXO file does not exist.\");",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 54,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "same, it would be helpful for these errors to show the invalid path",
      "created_at": "2025-12-09T13:01:15Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602556922",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602556922"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1808,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602578048",
      "pull_request_review_id": 3543553336,
      "id": 2602578048,
      "node_id": "PRRC_kwDOABII586bIDCA",
      "diff_hunk": "@@ -0,0 +1,68 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <boost/test/unit_test.hpp>\n+#include <common/args.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <test/util/setup_common.h>\n+#include <cstdio>\n+\n+namespace {\n+Txid txid_1{Txid::FromHex(\"bd0f71c1d5e50589063e134fad22053cdae5ab2320db5bf5e540198b0b5a4e69\").value()};\n+Txid txid_2{Txid::FromHex(\"b4749f017444b051c44dfd2720e88f314ff94f3dd6d56d40ef65854fcd7fff6b\").value()};\n+Txid txid_3{Txid::FromHex(\"ee707be5201160e32c4fc715bec227d1aeea5940fb4295605e7373edce3b1a93\").value()};\n+COutPoint outpoint_1{COutPoint(txid_1, 2142)};\n+COutPoint outpoint_2{COutPoint(txid_2, 99328)};\n+COutPoint outpoint_3{COutPoint(txid_3, 5438584)};",
      "path": "src/test/swiftsync_tests.cpp",
      "position": 1,
      "original_position": 18,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\nCOutPoint outpoint_1{txid_1, 2142};\nCOutPoint outpoint_2{txid_2, 99328};\nCOutPoint outpoint_3{txid_3, 5438584};\n```",
      "created_at": "2025-12-09T13:06:43Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602578048",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602578048"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 16,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 18,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602698384",
      "pull_request_review_id": 3543553336,
      "id": 2602698384,
      "node_id": "PRRC_kwDOABII586bIgaQ",
      "diff_hunk": "@@ -0,0 +1,68 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <boost/test/unit_test.hpp>\n+#include <common/args.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <test/util/setup_common.h>\n+#include <cstdio>\n+\n+namespace {\n+Txid txid_1{Txid::FromHex(\"bd0f71c1d5e50589063e134fad22053cdae5ab2320db5bf5e540198b0b5a4e69\").value()};\n+Txid txid_2{Txid::FromHex(\"b4749f017444b051c44dfd2720e88f314ff94f3dd6d56d40ef65854fcd7fff6b\").value()};\n+Txid txid_3{Txid::FromHex(\"ee707be5201160e32c4fc715bec227d1aeea5940fb4295605e7373edce3b1a93\").value()};",
      "path": "src/test/swiftsync_tests.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "8abdfec5eb5ed204f2dbdbf3d5c00ca052ade821",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "hmmm, the `value` will fail during runtime for invalid values, we could add a\n```C++\nconsteval explicit transaction_identifier(std::string_view hex_str) : m_wrapped{uint256{hex_str}} {}\n```\nconstructor which would allow us to have compile-time checked values as:\n```suggestion\nTxid txid_1{\"bd0f71c1d5e50589063e134fad22053cdae5ab2320db5bf5e540198b0b5a4e69\"};\nTxid txid_2{\"b4749f017444b051c44dfd2720e88f314ff94f3dd6d56d40ef65854fcd7fff6b\"};\nTxid txid_3{\"ee707be5201160e32c4fc715bec227d1aeea5940fb4295605e7373edce3b1a93\"};\n```",
      "created_at": "2025-12-09T13:35:02Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602698384",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602698384"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 13,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602752622",
      "pull_request_review_id": 3543553336,
      "id": 2602752622,
      "node_id": "PRRC_kwDOABII586bItpu",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)\n+{\n+    // First write the current file position for the current height in the header section.\n+    uint64_t curr_pos = m_file.size();\n+    uint64_t cursor = FILE_HEADER_LEN + (m_index * (sizeof(uint64_t) + sizeof(uint32_t)));\n+    m_file.seek(cursor, SEEK_SET);\n+    m_file << height;\n+    m_file << curr_pos;\n+    // Next append the positions of the unspent offsets in the block at this height.\n+    m_file.seek(curr_pos, SEEK_SET);\n+    WriteCompactSize(m_file, unspent_offsets.size());\n+    for (const auto& offset : unspent_offsets) {\n+        WriteCompactSize(m_file, offset);\n+    }\n+    m_index++;\n+    return m_file.Commit();\n+}\n+\n+HintsfileReader::HintsfileReader(AutoFile& file) : m_file(file.release())\n+{\n+    std::array<uint8_t, 4> magic{};\n+    m_file >> magic;\n+    if (magic != FILE_MAGIC) {\n+        throw std::ios_base::failure(\"HintsfileReader: This is not a hint file.\");",
      "path": "src/swiftsync.cpp",
      "position": 74,
      "original_position": 81,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "these failures could be exercised in the provided unit test",
      "created_at": "2025-12-09T13:46:54Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602752622",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602752622"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 74,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602754758",
      "pull_request_review_id": 3543553336,
      "id": 2602754758,
      "node_id": "PRRC_kwDOABII586bIuLG",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)\n+{\n+    // First write the current file position for the current height in the header section.\n+    uint64_t curr_pos = m_file.size();\n+    uint64_t cursor = FILE_HEADER_LEN + (m_index * (sizeof(uint64_t) + sizeof(uint32_t)));\n+    m_file.seek(cursor, SEEK_SET);\n+    m_file << height;\n+    m_file << curr_pos;\n+    // Next append the positions of the unspent offsets in the block at this height.\n+    m_file.seek(curr_pos, SEEK_SET);\n+    WriteCompactSize(m_file, unspent_offsets.size());\n+    for (const auto& offset : unspent_offsets) {\n+        WriteCompactSize(m_file, offset);\n+    }\n+    m_index++;\n+    return m_file.Commit();\n+}\n+\n+HintsfileReader::HintsfileReader(AutoFile& file) : m_file(file.release())\n+{\n+    std::array<uint8_t, 4> magic{};\n+    m_file >> magic;\n+    if (magic != FILE_MAGIC) {\n+        throw std::ios_base::failure(\"HintsfileReader: This is not a hint file.\");\n+    }\n+    uint8_t version{};\n+    m_file >> version;\n+    if (version != FILE_VERSION) {\n+        throw std::ios_base::failure(\"HintsfileReader: Unsupported file version.\");\n+    }\n+    m_file >> m_stop_height;\n+    for (uint32_t index = 1; index <= m_stop_height; index++) {\n+        uint32_t height;\n+        uint64_t file_pos;\n+        m_file >> height;\n+        m_file >> file_pos;\n+        m_height_to_file_pos.emplace(height, file_pos);\n+    }\n+}\n+HintsfileReader::HintsfileReader(HintsfileReader&& o) noexcept : m_file{o.m_file.release()}, m_stop_height{o.m_stop_height}, m_height_to_file_pos{std::move(o.m_height_to_file_pos)} {};\n+\n+std::vector<uint64_t> HintsfileReader::ReadBlock(const uint32_t& height)\n+{\n+    uint64_t file_pos = m_height_to_file_pos.at(height);\n+    m_file.seek(file_pos, SEEK_SET);\n+    uint64_t num_unspents = ReadCompactSize(m_file);\n+    std::vector<uint64_t> offsets{};\n+    offsets.reserve(num_unspents);\n+    for (uint64_t i = 0; i < num_unspents; i++) {\n+        offsets.push_back(ReadCompactSize(m_file));\n+    }\n+    return offsets;\n+}\n+\n+BlockHints::BlockHints(const std::vector<uint64_t>& offsets)\n+{\n+    uint64_t prev{};\n+    for (const auto& offset : offsets) {\n+        uint64_t next = prev + offset;\n+        m_unspent_outputs_index.insert(next);\n+        prev = next;\n+    }\n+}\n+\n+void Context::ApplyHints(HintsfileReader reader)\n+{\n+    m_hint_reader.emplace(std::move(reader));\n+}\n+\n+BlockHints Context::ReadBlockHints(const int& nHeight)\n+{\n+    BlockHints hints{m_hint_reader->ReadBlock(nHeight)};\n+    return hints;\n+}",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 131,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "These don't seem to be exercised in the unit test",
      "created_at": "2025-12-09T13:47:23Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602754758",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602754758"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 112,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 105,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602773194",
      "pull_request_review_id": 3543553336,
      "id": 2602773194,
      "node_id": "PRRC_kwDOABII586bIyrK",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 60,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "hah, I didn't know about this trick. We usually cast to `void` in these cases:\n\n```suggestion\n        (void)m_file.fclose();\n```",
      "created_at": "2025-12-09T13:52:21Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602773194",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602773194"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602775381",
      "pull_request_review_id": 3543553336,
      "id": 2602775381,
      "node_id": "PRRC_kwDOABII586bIzNV",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 63,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "instead of const vector reference we could likely pass `std::span<uint64_t>` instead",
      "created_at": "2025-12-09T13:52:57Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602775381",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602775381"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602783263",
      "pull_request_review_id": 3543553336,
      "id": 2602783263,
      "node_id": "PRRC_kwDOABII586bI1If",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);\n+    // Close the underlying file.\n+    int Close() { return m_file.fclose(); };\n+};\n+\n+/**\n+ * A file that encodes the UTXO set state at a particular block height.\n+ */\n+class HintsfileReader\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_stop_height;\n+    std::unordered_map<uint32_t, uint64_t> m_height_to_file_pos;\n+\n+public:\n+    HintsfileReader(AutoFile& file);\n+    HintsfileReader(HintsfileReader&& o) noexcept;\n+    ~HintsfileReader()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    /** Read the hints for the specified block height. */\n+    std::vector<uint64_t> ReadBlock(const uint32_t& height);\n+    /** The height this file encodes up to. */\n+    uint32_t StopHeight() { return m_stop_height; };\n+};\n+\n+/**\n+ * Stateful data structure that walks over the outputs of a block, determining the spent-ness.\n+ */\n+class BlockHints\n+{\n+private:\n+    std::unordered_set<uint64_t> m_unspent_outputs_index;\n+    uint64_t m_index{};\n+\n+public:\n+    BlockHints(const std::vector<uint64_t>& unspent_offsets);\n+    bool IsCurrOutputUnspent() { return m_unspent_outputs_index.contains(m_index); };",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 102,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Could be marked const and noexcept:\n\n```suggestion\n    bool IsCurrOutputUnspent() const noexcept { return m_unspent_outputs_index.contains(m_index); };\n```\n\nnote: this also seems untested",
      "created_at": "2025-12-09T13:55:13Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602783263",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602783263"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602791377",
      "pull_request_review_id": 3543553336,
      "id": 2602791377,
      "node_id": "PRRC_kwDOABII586bI3HR",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 27,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\n * The current implementation uses a salted SHA-256 hash and updates\n * four 64-bit integers by taking the first 16 bytes of the hash and adding or\n```",
      "created_at": "2025-12-09T13:57:27Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602791377",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602791377"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 26,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602827380",
      "pull_request_review_id": 3543553336,
      "id": 2602827380,
      "node_id": "PRRC_kwDOABII586bI_50",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 44,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> The choice of 4, 64-bit limbs with no carries between limbs was made to: 1. minimize code complexity\n\nWouldn't a 256-bit group with carry propagation retain associativity, commutativity, identity (zero), inverses (negation), etc? The aggregate \"add all created, subtract all spent, check for zero\" works in either, I think we could simplify to:\n\n```C++\nclass Aggregate\n{\n    arith_uint256 m_state{};\n    HashWriter m_salted_hasher{};\n\npublic:\n    Aggregate();\n    bool IsZero() const { return m_state == arith_uint256{}; }\n    void Create(const COutPoint& outpoint);\n    void Spend(const COutPoint& outpoint);\n};\n```\nand\n\n```suggestion\nvoid Aggregate::Create(const COutPoint& outpoint)\n{\n    m_state += UintToArith256((HashWriter(m_salted_hasher) << outpoint).GetSHA256());\n}\n\nvoid Aggregate::Spend(const COutPoint& outpoint)\n{\n    m_state -= UintToArith256((HashWriter(m_salted_hasher) << outpoint).GetSHA256());\n}\n```\n\nIt may perform a bit more calculations, but it's a lot simpler and I doubt this will be the bottleneck.\n\nnote: If subtraction is called `Spend`, this should rather be called: `Create`",
      "created_at": "2025-12-09T14:07:33Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602827380",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602827380"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602855032",
      "pull_request_review_id": 3543553336,
      "id": 2602855032,
      "node_id": "PRRC_kwDOABII586bJGp4",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);\n+    // Close the underlying file.\n+    int Close() { return m_file.fclose(); };\n+};\n+\n+/**\n+ * A file that encodes the UTXO set state at a particular block height.\n+ */\n+class HintsfileReader\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_stop_height;\n+    std::unordered_map<uint32_t, uint64_t> m_height_to_file_pos;\n+\n+public:\n+    HintsfileReader(AutoFile& file);\n+    HintsfileReader(HintsfileReader&& o) noexcept;\n+    ~HintsfileReader()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    /** Read the hints for the specified block height. */\n+    std::vector<uint64_t> ReadBlock(const uint32_t& height);\n+    /** The height this file encodes up to. */\n+    uint32_t StopHeight() { return m_stop_height; };\n+};\n+\n+/**\n+ * Stateful data structure that walks over the outputs of a block, determining the spent-ness.\n+ */\n+class BlockHints\n+{\n+private:\n+    std::unordered_set<uint64_t> m_unspent_outputs_index;\n+    uint64_t m_index{};\n+\n+public:\n+    BlockHints(const std::vector<uint64_t>& unspent_offsets);",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 101,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "it's not intuitive to convert a vector to `BlockHints`, can we make the constructor explicit?",
      "created_at": "2025-12-09T14:14:55Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602855032",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602855032"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 97,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602867982",
      "pull_request_review_id": 3543553336,
      "id": 2602867982,
      "node_id": "PRRC_kwDOABII586bJJ0O",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);\n+    // Close the underlying file.\n+    int Close() { return m_file.fclose(); };\n+};\n+\n+/**\n+ * A file that encodes the UTXO set state at a particular block height.\n+ */\n+class HintsfileReader\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_stop_height;\n+    std::unordered_map<uint32_t, uint64_t> m_height_to_file_pos;\n+\n+public:\n+    HintsfileReader(AutoFile& file);\n+    HintsfileReader(HintsfileReader&& o) noexcept;\n+    ~HintsfileReader()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    /** Read the hints for the specified block height. */\n+    std::vector<uint64_t> ReadBlock(const uint32_t& height);\n+    /** The height this file encodes up to. */\n+    uint32_t StopHeight() { return m_stop_height; };\n+};\n+\n+/**\n+ * Stateful data structure that walks over the outputs of a block, determining the spent-ness.\n+ */\n+class BlockHints\n+{\n+private:\n+    std::unordered_set<uint64_t> m_unspent_outputs_index;",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 97,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Do I understand correctly that instead of a compressed bitset, signalling which of the ordered transactions was (un)spent, we're storing the unspent txs explicitly as a set? I understand that we expet old blocks to be mostly spent, but I have a hard time believing that's the most optimal way to store and retrieve this information.\nIt seems to me we could have a layered approach - first a bitset showing which blocks are completely spent/unspent and for the remaining ones we can likely store them in a compressed/sparse bitset (skipping uniform values automatically).\nI understand this is \"just\" the first implementation, but the file format should preferably be stable.",
      "created_at": "2025-12-09T14:18:26Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602867982",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602867982"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 93,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602874013",
      "pull_request_review_id": 3543553336,
      "id": 2602874013,
      "node_id": "PRRC_kwDOABII586bJLSd",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);\n+    // Close the underlying file.\n+    int Close() { return m_file.fclose(); };\n+};\n+\n+/**\n+ * A file that encodes the UTXO set state at a particular block height.\n+ */\n+class HintsfileReader\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_stop_height;\n+    std::unordered_map<uint32_t, uint64_t> m_height_to_file_pos;\n+\n+public:\n+    HintsfileReader(AutoFile& file);\n+    HintsfileReader(HintsfileReader&& o) noexcept;\n+    ~HintsfileReader()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    /** Read the hints for the specified block height. */\n+    std::vector<uint64_t> ReadBlock(const uint32_t& height);\n+    /** The height this file encodes up to. */\n+    uint32_t StopHeight() { return m_stop_height; };\n+};\n+\n+/**\n+ * Stateful data structure that walks over the outputs of a block, determining the spent-ness.\n+ */\n+class BlockHints\n+{\n+private:\n+    std::unordered_set<uint64_t> m_unspent_outputs_index;\n+    uint64_t m_index{};\n+\n+public:\n+    BlockHints(const std::vector<uint64_t>& unspent_offsets);\n+    bool IsCurrOutputUnspent() { return m_unspent_outputs_index.contains(m_index); };\n+    void NextOutput() { m_index++; };\n+};\n+\n+class Context\n+{\n+private:\n+    std::optional<HintsfileReader> m_hint_reader{};\n+    bool m_is_starting_from_genesis{};\n+    bool m_is_complete{};\n+\n+public:\n+    /** Aggregate of block inputs and outputs. */\n+    Aggregate m_aggregate{};\n+    Context() = default;\n+    /** Apply the hints from reader to this context. */\n+    void ApplyHints(HintsfileReader reader);\n+    /** The entire block history must be aggregated for accelerated IBD. */\n+    void StartingFromGenesis() { m_is_starting_from_genesis = true; };\n+    /** Accelerated IBD has completed. */\n+    void Completed() { m_is_complete = true; };",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 122,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The past tense is confusing regarding its side-effect\n\n```suggestion\n    void Complete() { m_is_complete = true; };\n```\n\nnote: we should assert this was started and not completed as a sanity check",
      "created_at": "2025-12-09T14:20:00Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602874013",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602874013"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602876118",
      "pull_request_review_id": 3543553336,
      "id": 2602876118,
      "node_id": "PRRC_kwDOABII586bJLzW",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);\n+    // Close the underlying file.\n+    int Close() { return m_file.fclose(); };\n+};\n+\n+/**\n+ * A file that encodes the UTXO set state at a particular block height.\n+ */\n+class HintsfileReader\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_stop_height;\n+    std::unordered_map<uint32_t, uint64_t> m_height_to_file_pos;\n+\n+public:\n+    HintsfileReader(AutoFile& file);\n+    HintsfileReader(HintsfileReader&& o) noexcept;\n+    ~HintsfileReader()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    /** Read the hints for the specified block height. */\n+    std::vector<uint64_t> ReadBlock(const uint32_t& height);\n+    /** The height this file encodes up to. */\n+    uint32_t StopHeight() { return m_stop_height; };\n+};\n+\n+/**\n+ * Stateful data structure that walks over the outputs of a block, determining the spent-ness.\n+ */\n+class BlockHints\n+{\n+private:\n+    std::unordered_set<uint64_t> m_unspent_outputs_index;\n+    uint64_t m_index{};\n+\n+public:\n+    BlockHints(const std::vector<uint64_t>& unspent_offsets);\n+    bool IsCurrOutputUnspent() { return m_unspent_outputs_index.contains(m_index); };\n+    void NextOutput() { m_index++; };\n+};\n+\n+class Context\n+{\n+private:\n+    std::optional<HintsfileReader> m_hint_reader{};\n+    bool m_is_starting_from_genesis{};\n+    bool m_is_complete{};\n+\n+public:\n+    /** Aggregate of block inputs and outputs. */\n+    Aggregate m_aggregate{};\n+    Context() = default;\n+    /** Apply the hints from reader to this context. */\n+    void ApplyHints(HintsfileReader reader);\n+    /** The entire block history must be aggregated for accelerated IBD. */\n+    void StartingFromGenesis() { m_is_starting_from_genesis = true; };",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 120,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Same as below:\n\n```suggestion\n    void StartFromGenesis() { m_is_starting_from_genesis = true; };\n```\n\nnote: we should assert this isn't the case already as a sanity check",
      "created_at": "2025-12-09T14:20:34Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602876118",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602876118"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 116,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602885928",
      "pull_request_review_id": 3543553336,
      "id": 2602885928,
      "node_id": "PRRC_kwDOABII586bJOMo",
      "diff_hunk": "@@ -2026,6 +2027,33 @@ void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, CTxUndo &txund\n     AddCoins(inputs, tx, nHeight);\n }\n \n+void UpdateCoinsWithHints(const CTransaction& tx, CCoinsViewCache& inputs, const CBlockIndex& pindex, swiftsync::Aggregate& agg, swiftsync::BlockHints& hints)\n+{\n+    const bool is_coinbase = tx.IsCoinBase();\n+    if (is_coinbase && IsBIP30Unspendable(pindex.GetBlockHash(), pindex.nHeight)) {",
      "path": "src/validation.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "My understanding is that we can only run this in in the `assumevalid` range - would it help if we buried the bip30 checks behind `assumevalid` as well (as attempted in https://github.com/bitcoin/bitcoin/pull/33817), or it's orthogonal since they already invalidate the addition/subtraction and need to be explicitly checked anyway?",
      "created_at": "2025-12-09T14:23:00Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602885928",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602885928"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2059,
      "original_line": 2059,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602907499",
      "pull_request_review_id": 3543553336,
      "id": 2602907499,
      "node_id": "PRRC_kwDOABII586bJTdr",
      "diff_hunk": "@@ -2026,6 +2027,33 @@ void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, CTxUndo &txund\n     AddCoins(inputs, tx, nHeight);\n }\n \n+void UpdateCoinsWithHints(const CTransaction& tx, CCoinsViewCache& inputs, const CBlockIndex& pindex, swiftsync::Aggregate& agg, swiftsync::BlockHints& hints)\n+{\n+    const bool is_coinbase = tx.IsCoinBase();\n+    if (is_coinbase && IsBIP30Unspendable(pindex.GetBlockHash(), pindex.nHeight)) {\n+        for (uint64_t index = 0; index < tx.vout.size(); index++) {\n+            // No-op on the aggregator and TXO set. These coins will show up again.\n+            hints.NextOutput();\n+        }\n+        return;\n+    }\n+    if (!is_coinbase) {\n+        for (const CTxIn& txin : tx.vin) {\n+            agg.Spend(txin.prevout);\n+        }\n+    }\n+    const Txid& txid{tx.GetHash()};\n+    for (uint64_t index = 0; index < tx.vout.size(); index++) {\n+        COutPoint outpoint = COutPoint(txid, index);\n+        if (!hints.IsCurrOutputUnspent() && !tx.vout[index].scriptPubKey.IsUnspendable()) {\n+            agg.Add(outpoint);\n+        } else {\n+            inputs.AddCoin(outpoint, Coin(tx.vout[index], pindex.nHeight, is_coinbase), is_coinbase);",
      "path": "src/validation.cpp",
      "position": 33,
      "original_position": 33,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "this should likely be `EmplaceCoinInternalDANGER` instead",
      "created_at": "2025-12-09T14:27:42Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602907499",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602907499"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2077,
      "original_line": 2077,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602949599",
      "pull_request_review_id": 3543553336,
      "id": 2602949599,
      "node_id": "PRRC_kwDOABII586bJdvf",
      "diff_hunk": "@@ -2026,6 +2027,33 @@ void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, CTxUndo &txund\n     AddCoins(inputs, tx, nHeight);\n }\n \n+void UpdateCoinsWithHints(const CTransaction& tx, CCoinsViewCache& inputs, const CBlockIndex& pindex, swiftsync::Aggregate& agg, swiftsync::BlockHints& hints)\n+{\n+    const bool is_coinbase = tx.IsCoinBase();\n+    if (is_coinbase && IsBIP30Unspendable(pindex.GetBlockHash(), pindex.nHeight)) {\n+        for (uint64_t index = 0; index < tx.vout.size(); index++) {\n+            // No-op on the aggregator and TXO set. These coins will show up again.\n+            hints.NextOutput();\n+        }\n+        return;\n+    }\n+    if (!is_coinbase) {\n+        for (const CTxIn& txin : tx.vin) {\n+            agg.Spend(txin.prevout);\n+        }\n+    }\n+    const Txid& txid{tx.GetHash()};\n+    for (uint64_t index = 0; index < tx.vout.size(); index++) {\n+        COutPoint outpoint = COutPoint(txid, index);\n+        if (!hints.IsCurrOutputUnspent() && !tx.vout[index].scriptPubKey.IsUnspendable()) {",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 30,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "why are we calling `IsUnspendable` just to return immediately in `AddCoin`? We could skip these at the beginning of the loop for both branches. We should also skip this from the hints file of course?",
      "created_at": "2025-12-09T14:37:38Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602949599",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602949599"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2048,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602968670",
      "pull_request_review_id": 3543553336,
      "id": 2602968670,
      "node_id": "PRRC_kwDOABII586bJiZe",
      "diff_hunk": "@@ -2026,6 +2027,33 @@ void UpdateCoins(const CTransaction& tx, CCoinsViewCache& inputs, CTxUndo &txund\n     AddCoins(inputs, tx, nHeight);\n }\n \n+void UpdateCoinsWithHints(const CTransaction& tx, CCoinsViewCache& inputs, const CBlockIndex& pindex, swiftsync::Aggregate& agg, swiftsync::BlockHints& hints)\n+{\n+    const bool is_coinbase = tx.IsCoinBase();\n+    if (is_coinbase && IsBIP30Unspendable(pindex.GetBlockHash(), pindex.nHeight)) {\n+        for (uint64_t index = 0; index < tx.vout.size(); index++) {",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: would prefer using brace init and `++` consistenctly throughout the PR",
      "created_at": "2025-12-09T14:42:28Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602968670",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602968670"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2034,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602974853",
      "pull_request_review_id": 3543553336,
      "id": 2602974853,
      "node_id": "PRRC_kwDOABII586bJj6F",
      "diff_hunk": "@@ -2611,7 +2647,19 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         if (i > 0) {\n             blockundo.vtxundo.emplace_back();\n         }\n-        UpdateCoins(tx, view, i == 0 ? undoDummy : blockundo.vtxundo.back(), pindex->nHeight);\n+        if (swiftsync_active) {\n+            UpdateCoinsWithHints(tx, view, *pindex, m_swiftsync_ctx.m_aggregate, hints.value());\n+        } else {\n+            UpdateCoins(tx, view, i == 0 ? undoDummy : blockundo.vtxundo.back(), pindex->nHeight);\n+        }\n+    }\n+    if (swiftsync_active && m_swiftsync_ctx.StopHeight() == (uint32_t)pindex->nHeight) {\n+        m_swiftsync_ctx.Completed();\n+        if (m_swiftsync_ctx.m_aggregate.IsZero()) {",
      "path": "src/validation.cpp",
      "position": 1,
      "original_position": 110,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`IsZero` requires context to understand why it means \"valid.\"\nWhat we're checking is: do all created outputs equal all spent inputs.\nConsider tracking created and spent sums separately, then comparing for equality:\n```C++\nbool IsBalanced() const { return m_created == m_spent; }\n```\nThis makes the invariant self-evident: all created outputs must equal all spent inputs.",
      "created_at": "2025-12-09T14:43:57Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2602974853",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2602974853"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2658,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603002475",
      "pull_request_review_id": 3543553336,
      "id": 2603002475,
      "node_id": "PRRC_kwDOABII586bJqpr",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 26,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "we already have a dedicated `SaltedOutpointHasher` which just xors all four 64 bit chunks:\nhttps://github.com/bitcoin/bitcoin/blob/bdb8eadcdc193f398ebad83911d3297b5257e721/src/crypto/siphash.cpp#L177\n\nWouldn't that suffice (given that it's what we're already using for the map and we don't expect it to have *any* collisions in our case)? And even if it would collide, `SipHash` basically guarantees that it can't be weaponized since these inputs already have to satisfy an extremely high bar, we can't just easily grind these values, especially since it's salted. \n\nIt would also allow storing the created and spent as\n```C++\nclass Aggregate\n{\n    arith_uint256 m_created{};\n    arith_uint256 m_spent{};\n    SaltedOutpointHasher m_hasher{};\n\npublic:\n    bool IsBalanced() const { return m_created == m_spent; }\n    void Create(const COutPoint& outpoint) { m_created += m_hasher(outpoint); }\n    void Spend(const COutPoint& outpoint) { m_spent += m_hasher(outpoint); }\n};\n```\n\nand this way the created and spent sums couldn't even overflow (which in itself is a collision threat).",
      "created_at": "2025-12-09T14:50:56Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2603002475",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603002475"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 21,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603026740",
      "pull_request_review_id": 3543553336,
      "id": 2603026740,
      "node_id": "PRRC_kwDOABII586bJwk0",
      "diff_hunk": "@@ -39,6 +39,7 @@\n #include <script/descriptor.h>\n #include <serialize.h>\n #include <streams.h>\n+#include <swiftsync.h>",
      "path": "src/rpc/blockchain.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "so when are we calling it `swift` and when `accelerated`?",
      "created_at": "2025-12-09T14:57:10Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2603026740",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603026740"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 42,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603031293",
      "pull_request_review_id": 3543553336,
      "id": 2603031293,
      "node_id": "PRRC_kwDOABII586bJxr9",
      "diff_hunk": "@@ -0,0 +1,68 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <boost/test/unit_test.hpp>\n+#include <common/args.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <test/util/setup_common.h>\n+#include <cstdio>\n+\n+namespace {\n+Txid txid_1{Txid::FromHex(\"bd0f71c1d5e50589063e134fad22053cdae5ab2320db5bf5e540198b0b5a4e69\").value()};\n+Txid txid_2{Txid::FromHex(\"b4749f017444b051c44dfd2720e88f314ff94f3dd6d56d40ef65854fcd7fff6b\").value()};\n+Txid txid_3{Txid::FromHex(\"ee707be5201160e32c4fc715bec227d1aeea5940fb4295605e7373edce3b1a93\").value()};\n+COutPoint outpoint_1{COutPoint(txid_1, 2142)};\n+COutPoint outpoint_2{COutPoint(txid_2, 99328)};\n+COutPoint outpoint_3{COutPoint(txid_3, 5438584)};\n+std::vector<uint64_t> unspent_block_1{0, 3253, 120};\n+std::vector<uint64_t> unspent_block_2{0, 999, 532, 624, 623623, 436134, 32443, 2346, 3, 3564, 234, 122};\n+std::vector<uint64_t> unspent_block_3{0, 4231, 92385, 53894, 82, 3, 2389453, 92, 2, 23985};\n+std::vector<uint64_t> unspent_block_4{0, 83948, 1111, 12424, 12, 2, 3, 3, 14};\n+} // namespace\n+\n+BOOST_FIXTURE_TEST_SUITE(swiftsync_tests, BasicTestingSetup);\n+\n+BOOST_AUTO_TEST_CASE(swiftsync_aggregate_test)\n+{\n+    swiftsync::Aggregate agg{};\n+    agg.Add(outpoint_1);\n+    agg.Spend(outpoint_2);\n+    agg.Add(outpoint_3);\n+    BOOST_CHECK(!agg.IsZero());\n+    agg.Spend(outpoint_1);\n+    agg.Add(outpoint_2);\n+    agg.Spend(outpoint_3);\n+    BOOST_CHECK(agg.IsZero());\n+}\n+\n+BOOST_AUTO_TEST_CASE(swiftsync_hintfile_test)\n+{\n+    const fs::path temppath = fsbridge::AbsPathJoin(gArgs.GetDataDirNet(), fs::u8path(\"test.hints\"));\n+    {\n+        FILE* file{fsbridge::fopen(temppath, \"wb\")};\n+        AutoFile afile{file};\n+        swiftsync::HintsfileWriter writer{afile, 4};\n+        BOOST_CHECK(writer.WriteNextUnspents(unspent_block_1, 1));\n+        BOOST_CHECK(writer.WriteNextUnspents(unspent_block_3, 3));\n+        BOOST_CHECK(writer.WriteNextUnspents(unspent_block_4, 4));\n+        BOOST_CHECK(writer.WriteNextUnspents(unspent_block_2, 2));\n+    }\n+    FILE* file{fsbridge::fopen(temppath, \"rb\")};\n+    AutoFile afile{file};\n+    swiftsync::HintsfileReader reader{afile};\n+    BOOST_CHECK(reader.StopHeight() == 4);",
      "path": "src/test/swiftsync_tests.cpp",
      "position": 1,
      "original_position": 55,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "you could use `BOOST_CHECK_EQUAL` for primitive comparison, it gives better errors",
      "created_at": "2025-12-09T14:58:25Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2603031293",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603031293"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 55,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603062275",
      "pull_request_review_id": 3543553336,
      "id": 2603062275,
      "node_id": "PRRC_kwDOABII586bJ5QD",
      "diff_hunk": "@@ -0,0 +1,68 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <boost/test/unit_test.hpp>\n+#include <common/args.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <test/util/setup_common.h>\n+#include <cstdio>\n+\n+namespace {\n+Txid txid_1{Txid::FromHex(\"bd0f71c1d5e50589063e134fad22053cdae5ab2320db5bf5e540198b0b5a4e69\").value()};\n+Txid txid_2{Txid::FromHex(\"b4749f017444b051c44dfd2720e88f314ff94f3dd6d56d40ef65854fcd7fff6b\").value()};\n+Txid txid_3{Txid::FromHex(\"ee707be5201160e32c4fc715bec227d1aeea5940fb4295605e7373edce3b1a93\").value()};\n+COutPoint outpoint_1{COutPoint(txid_1, 2142)};\n+COutPoint outpoint_2{COutPoint(txid_2, 99328)};\n+COutPoint outpoint_3{COutPoint(txid_3, 5438584)};\n+std::vector<uint64_t> unspent_block_1{0, 3253, 120};\n+std::vector<uint64_t> unspent_block_2{0, 999, 532, 624, 623623, 436134, 32443, 2346, 3, 3564, 234, 122};\n+std::vector<uint64_t> unspent_block_3{0, 4231, 92385, 53894, 82, 3, 2389453, 92, 2, 23985};\n+std::vector<uint64_t> unspent_block_4{0, 83948, 1111, 12424, 12, 2, 3, 3, 14};\n+} // namespace\n+\n+BOOST_FIXTURE_TEST_SUITE(swiftsync_tests, BasicTestingSetup);\n+\n+BOOST_AUTO_TEST_CASE(swiftsync_aggregate_test)\n+{\n+    swiftsync::Aggregate agg{};\n+    agg.Add(outpoint_1);\n+    agg.Spend(outpoint_2);\n+    agg.Add(outpoint_3);\n+    BOOST_CHECK(!agg.IsZero());\n+    agg.Spend(outpoint_1);\n+    agg.Add(outpoint_2);\n+    agg.Spend(outpoint_3);\n+    BOOST_CHECK(agg.IsZero());\n+}\n+\n+BOOST_AUTO_TEST_CASE(swiftsync_hintfile_test)\n+{\n+    const fs::path temppath = fsbridge::AbsPathJoin(gArgs.GetDataDirNet(), fs::u8path(\"test.hints\"));\n+    {\n+        FILE* file{fsbridge::fopen(temppath, \"wb\")};\n+        AutoFile afile{file};\n+        swiftsync::HintsfileWriter writer{afile, 4};\n+        BOOST_CHECK(writer.WriteNextUnspents(unspent_block_1, 1));",
      "path": "src/test/swiftsync_tests.cpp",
      "position": 1,
      "original_position": 47,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "if this is still the setup phase of the test, it could be a `BOOST_REQUIRE`",
      "created_at": "2025-12-09T15:06:13Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2603062275",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603062275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603093574",
      "pull_request_review_id": 3543553336,
      "id": 2603093574,
      "node_id": "PRRC_kwDOABII586bKA5G",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)\n+{\n+    // First write the current file position for the current height in the header section.\n+    uint64_t curr_pos = m_file.size();\n+    uint64_t cursor = FILE_HEADER_LEN + (m_index * (sizeof(uint64_t) + sizeof(uint32_t)));\n+    m_file.seek(cursor, SEEK_SET);\n+    m_file << height;\n+    m_file << curr_pos;\n+    // Next append the positions of the unspent offsets in the block at this height.\n+    m_file.seek(curr_pos, SEEK_SET);\n+    WriteCompactSize(m_file, unspent_offsets.size());",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 68,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "compact size is very wasteful in case we have values greater than 253. Consider `WriteVarInt` for cases that contain a significant portion of greater than 1 byte values",
      "created_at": "2025-12-09T15:14:32Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2603093574",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603093574"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603116652",
      "pull_request_review_id": 3543553336,
      "id": 2603116652,
      "node_id": "PRRC_kwDOABII586bKGhs",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)\n+{\n+    // First write the current file position for the current height in the header section.\n+    uint64_t curr_pos = m_file.size();\n+    uint64_t cursor = FILE_HEADER_LEN + (m_index * (sizeof(uint64_t) + sizeof(uint32_t)));\n+    m_file.seek(cursor, SEEK_SET);\n+    m_file << height;\n+    m_file << curr_pos;\n+    // Next append the positions of the unspent offsets in the block at this height.\n+    m_file.seek(curr_pos, SEEK_SET);\n+    WriteCompactSize(m_file, unspent_offsets.size());\n+    for (const auto& offset : unspent_offsets) {\n+        WriteCompactSize(m_file, offset);\n+    }\n+    m_index++;\n+    return m_file.Commit();\n+}\n+\n+HintsfileReader::HintsfileReader(AutoFile& file) : m_file(file.release())\n+{\n+    std::array<uint8_t, 4> magic{};\n+    m_file >> magic;\n+    if (magic != FILE_MAGIC) {\n+        throw std::ios_base::failure(\"HintsfileReader: This is not a hint file.\");\n+    }\n+    uint8_t version{};\n+    m_file >> version;\n+    if (version != FILE_VERSION) {\n+        throw std::ios_base::failure(\"HintsfileReader: Unsupported file version.\");\n+    }\n+    m_file >> m_stop_height;\n+    for (uint32_t index = 1; index <= m_stop_height; index++) {\n+        uint32_t height;\n+        uint64_t file_pos;\n+        m_file >> height;\n+        m_file >> file_pos;\n+        m_height_to_file_pos.emplace(height, file_pos);\n+    }\n+}\n+HintsfileReader::HintsfileReader(HintsfileReader&& o) noexcept : m_file{o.m_file.release()}, m_stop_height{o.m_stop_height}, m_height_to_file_pos{std::move(o.m_height_to_file_pos)} {};\n+\n+std::vector<uint64_t> HintsfileReader::ReadBlock(const uint32_t& height)\n+{\n+    uint64_t file_pos = m_height_to_file_pos.at(height);\n+    m_file.seek(file_pos, SEEK_SET);\n+    uint64_t num_unspents = ReadCompactSize(m_file);\n+    std::vector<uint64_t> offsets{};\n+    offsets.reserve(num_unspents);\n+    for (uint64_t i = 0; i < num_unspents; i++) {\n+        offsets.push_back(ReadCompactSize(m_file));\n+    }",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 108,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "we're currently \"decompressing\" the data during read, instead of during access - it should be possible to read the whole file data into the vector without interpreting it and decipher them when the data is needed.\nPlease see the way we've implemented it in https://github.com/l0rinc/bitcoin/pull/11/commits/8398cbc72c55047467bfef687582d89b1627793c#diff-c754d7c547c3523356e9a430b5448ba384fe135cf3f83508a7d0384d30c9d2d0R45-R54",
      "created_at": "2025-12-09T15:20:12Z",
      "updated_at": "2025-12-09T15:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2603116652",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2603116652"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 104,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 82,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2611879532",
      "pull_request_review_id": 3569068972,
      "id": 2611879532,
      "node_id": "PRRC_kwDOABII586brh5s",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)\n+{\n+    // First write the current file position for the current height in the header section.\n+    uint64_t curr_pos = m_file.size();\n+    uint64_t cursor = FILE_HEADER_LEN + (m_index * (sizeof(uint64_t) + sizeof(uint32_t)));\n+    m_file.seek(cursor, SEEK_SET);\n+    m_file << height;\n+    m_file << curr_pos;\n+    // Next append the positions of the unspent offsets in the block at this height.\n+    m_file.seek(curr_pos, SEEK_SET);\n+    WriteCompactSize(m_file, unspent_offsets.size());\n+    for (const auto& offset : unspent_offsets) {\n+        WriteCompactSize(m_file, offset);\n+    }\n+    m_index++;\n+    return m_file.Commit();\n+}\n+\n+HintsfileReader::HintsfileReader(AutoFile& file) : m_file(file.release())\n+{\n+    std::array<uint8_t, 4> magic{};\n+    m_file >> magic;\n+    if (magic != FILE_MAGIC) {\n+        throw std::ios_base::failure(\"HintsfileReader: This is not a hint file.\");",
      "path": "src/swiftsync.cpp",
      "position": 74,
      "original_position": 81,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2602752622,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> these failures could be exercised in the provided unit test\r\n\r\n+1. Some unkilled mutants for obvious lack of testing:\r\n\r\n```diff\r\n--- a/src/swiftsync.cpp\r\n+++ b/muts-pr-34004-swiftsync-cpp/swiftsync.mutant.25.cpp\r\n@@ -82,7 +82,7 @@ HintsfileReader::HintsfileReader(AutoFile& file) : m_file(file.release())\r\n     }\r\n     uint8_t version{};\r\n     m_file >> version;\r\n-    if (version != FILE_VERSION) {\r\n+    if (1==0) {\r\n         throw std::ios_base::failure(\"HintsfileReader: Unsupported file version.\");\r\n     }\r\n     m_file >> m_stop_height\r\n```\r\n\r\n```diff\r\ndiff --git a/src/swiftsync.cpp b/muts-pr-34004-swiftsync-cpp/swiftsync.mutant.22.cpp\r\nindex bd028031f0..f0e04a9014 100644\r\n--- a/src/swiftsync.cpp\r\n+++ b/muts-pr-34004-swiftsync-cpp/swiftsync.mutant.22.cpp\r\n@@ -77,7 +77,7 @@ HintsfileReader::HintsfileReader(AutoFile& file) : m_file(file.release())\r\n {\r\n     std::array<uint8_t, 4> magic{};\r\n     m_file >> magic;\r\n-    if (magic != FILE_MAGIC) {\r\n+    if (1==0) {\r\n         throw std::ios_base::failure(\"HintsfileReader: This is not a hint file.\");\r\n     }\r\n\r\n```",
      "created_at": "2025-12-11T19:53:05Z",
      "updated_at": "2025-12-11T21:34:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2611879532",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2611879532"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 74,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2611893305",
      "pull_request_review_id": 3569068972,
      "id": 2611893305,
      "node_id": "PRRC_kwDOABII586brlQ5",
      "diff_hunk": "@@ -2579,13 +2613,15 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\n         // * legacy (always)\n         // * p2sh (when P2SH enabled in flags and excludes coinbase)\n         // * witness (when witness enabled in flags and excludes coinbase)\n-        nSigOpsCost += GetTransactionSigOpCost(tx, view, flags);\n-        if (nSigOpsCost > MAX_BLOCK_SIGOPS_COST) {\n-            state.Invalid(BlockValidationResult::BLOCK_CONSENSUS, \"bad-blk-sigops\", \"too many sigops\");\n-            break;\n+        if (!swiftsync_active) {",
      "path": "src/validation.cpp",
      "position": 84,
      "original_position": 84,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Unkilled mutant:\r\n```diff\r\ndiff --git a/src/validation.cpp b/muts-pr-34004-validation-cpp/validation.mutant.16.cpp\r\nindex 3d84576e7d..efc5037570 100644\r\n--- a/src/validation.cpp\r\n+++ b/muts-pr-34004-validation-cpp/validation.mutant.16.cpp\r\n@@ -2613,7 +2613,7 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\r\n         // * legacy (always)\r\n         // * p2sh (when P2SH enabled in flags and excludes coinbase)\r\n         // * witness (when witness enabled in flags and excludes coinbase)\r\n-        if (!swiftsync_active) {\r\n+        if (1==0) {\r\n             nSigOpsCost += GetTransactionSigOpCost(tx, view, flags);\r\n             if (nSigOpsCost > MAX_BLOCK_SIGOPS_COST) {\r\n                 state.Invalid(BlockValidationResult::BLOCK_CONSENSUS, \"bad-blk-sigops\", \"too many sigops\");\r\n@@ -6571,4 +6571,4 @@ std::pair<int, int> ChainstateManager::GetPruneRange(const Chainstate& chainstat\r\n     int prune_end = std::min(last_height_can_prune, max_prune);\r\n\r\n     return {prune_start, prune_end};\r\n\r\n```",
      "created_at": "2025-12-11T19:58:21Z",
      "updated_at": "2025-12-11T21:34:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2611893305",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2611893305"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2643,
      "original_line": 2643,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2611914615",
      "pull_request_review_id": 3569068972,
      "id": 2611914615,
      "node_id": "PRRC_kwDOABII586brqd3",
      "diff_hunk": "@@ -1790,11 +1801,34 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     bool do_reindex{args.GetBoolArg(\"-reindex\", false)};\n     const bool do_reindex_chainstate{args.GetBoolArg(\"-reindex-chainstate\", false)};\n \n+    std::optional<swiftsync::HintsfileReader> utxo_hints;\n+    if (args.IsArgSet(\"-utxohints\")) {\n+        fs::path path = fs::absolute(args.GetPathArg(\"-utxohints\"));\n+        if (!fs::exists(path)) {",
      "path": "src/init.cpp",
      "position": 52,
      "original_position": 53,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "We could exercise these errors (file doesn't exist and open failure) in the functional tests. An (obvious) unkilled mutant:\r\n\r\n```diff\r\ndiff --git a/src/init.cpp b/muts-pr-34004-init-cpp/init.mutant.1.cpp\r\nindex fb7336f9ae..59de0f6b7a 100644\r\n--- a/src/init.cpp\r\n+++ b/muts-pr-34004-init-cpp/init.mutant.1.cpp\r\n@@ -1812,7 +1812,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n         AutoFile afile{file};\r\n         if (afile.IsNull()) {\r\n             LogError(\"Failed to open UTXO hint file.\");\r\n-            return false;\r\n+            return true;\r\n         }\r\n\r\n```",
      "created_at": "2025-12-11T20:06:50Z",
      "updated_at": "2025-12-11T21:34:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2611914615",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2611914615"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1810,
      "original_line": 1810,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2611981935",
      "pull_request_review_id": 3569068972,
      "id": 2611981935,
      "node_id": "PRRC_kwDOABII586br65v",
      "diff_hunk": "@@ -3396,6 +3397,125 @@ static RPCHelpMan loadtxoutset()\n     };\n }\n \n+static RPCHelpMan generatetxohints()\n+{\n+    return RPCHelpMan{\n+        \"generatetxohints\",\n+        \"Build a file of hints for the state of the UTXO set at a particular height.\\n\"\n+        \"The purpose of said hints is to allow clients performing initial block download\"\n+        \"to omit unnecessary disk I/O and CPU usage.\\n\"\n+        \"The hint file is constructed by reading in blocks sequentially and determining what outputs\"\n+        \"will remain in the UTXO set. Network activity will be suspended during this process, and the\"\n+        \"hint file may take a few hours to build.\"\n+        \"Make sure to use no RPC timeout (bitcoin-cli -rpcclienttimeout=0)\",\n+        {\n+            {\"path\",\n+                RPCArg::Type::STR,\n+                RPCArg::Optional::NO,\n+                \"Path to the hint file. If relative, will be prefixed by datadir.\"},\n+            {\"rollback\",\n+                RPCArg::Type::NUM,\n+                RPCArg::Optional::OMITTED,\n+                \"The block hash or height to build the hint file up to. If none is provided, the file will be built from the current block tip.\",\n+                RPCArgOptions{\n+                    .skip_type_check = true,\n+                    .type_str = {\"\", \"string or numeric\"},}},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::NUM, \"height\", \"The stopping height encoded by the hint file.\"},\n+                    {RPCResult::Type::STR, \"path\", \"Absolute path where the file was written.\"},\n+                    {RPCResult::Type::STR, \"duration\", \"Time taken to build the file.\"},\n+                }\n+        },\n+        RPCExamples{\n+            HelpExampleCli(\"--rpcclienttimeout=0 generatetxohints\", \"signet.hints 270000\"),\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+{\n+    const auto start{SteadyClock::now()};\n+    NodeContext& node = EnsureAnyNodeContext(request.context);\n+    if (node.chainman->m_blockman.IsPruneMode()) {\n+        throw JSONRPCError(RPC_MISC_ERROR, \"Creating a hint file in pruned mode is not possible.\");\n+    }\n+    const ArgsManager& args = EnsureAnyArgsman(request.context);\n+    const fs::path path = fsbridge::AbsPathJoin(args.GetDataDirNet(), fs::u8path(self.Arg<std::string_view>(\"path\")));\n+    const fs::path temppath = path + \".incomplete\";\n+    if (fs::exists(path)) {\n+        throw JSONRPCError(\n+            RPC_INVALID_PARAMETER,\n+            path.utf8string() + \" already exists. If you are sure this is what you want, \"\n+            \"move it out of the way first\");\n+    }\n+    FILE* file{fsbridge::fopen(temppath, \"wb\")};\n+    AutoFile afile{file};\n+    if (afile.IsNull()) {\n+        throw JSONRPCError(\n+            RPC_INVALID_PARAMETER,\n+            \"Couldn't open file \" + temppath.utf8string() + \" for writing.\");\n+    }\n+    CConnman& connman = EnsureConnman(node);\n+    NetworkDisable disable_net = NetworkDisable(connman);\n+    std::optional<TemporaryRollback> rollback;\n+    if (!request.params[1].isNull()) {\n+        const CBlockIndex* invalidate_index = ParseHashOrHeight(request.params[1], *node.chainman);\n+        invalidate_index = WITH_LOCK(::cs_main, return node.chainman->ActiveChain().Next(invalidate_index));\n+        rollback.emplace(*node.chainman, *invalidate_index);\n+    }\n+    node.rpc_interruption_point();\n+    LOCK(node.chainman->GetMutex());\n+    CChain& active_chain = node.chainman->ActiveChain();\n+    Chainstate& active_state = node.chainman->ActiveChainstate();\n+    active_state.ForceFlushStateToDisk();\n+    const CBlockIndex* end_index = active_chain.Tip();\n+    const auto tip_height = end_index->nHeight;\n+    LogDebug(BCLog::RPC, \"Active chain best tip %d\", tip_height);\n+    swiftsync::HintsfileWriter writer = swiftsync::HintsfileWriter(afile, tip_height);\n+    CBlockIndex* curr = active_chain.Next(active_chain.Genesis());\n+    while (curr) {\n+        auto height = curr->nHeight;\n+        if (height % 10000 == 0) {\n+            LogDebug(BCLog::RPC, \"Wrote hints up to height (%s)\", height);\n+        }\n+        FlatFilePos file_pos = curr->GetBlockPos();\n+        std::unique_ptr<CBlock> pblock = std::make_unique<CBlock>();\n+        bool read = node.chainman->m_blockman.ReadBlock(*pblock, file_pos, curr->GetBlockHash());\n+        if (!read) {\n+            throw JSONRPCError(RPC_DATABASE_ERROR, \"Block could not be read from disk.\");",
      "path": "src/rpc/blockchain.cpp",
      "position": 97,
      "original_position": 97,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This error isn't covered by any test and could be addressed in `feature_swiftsync`. Perhaps by deleting a block file before calling the `generatetxohints` RPC.",
      "created_at": "2025-12-11T20:33:04Z",
      "updated_at": "2025-12-11T21:34:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2611981935",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2611981935"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3481,
      "original_line": 3481,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2612145025",
      "pull_request_review_id": 3569407824,
      "id": 2612145025,
      "node_id": "PRRC_kwDOABII586bsiuB",
      "diff_hunk": "@@ -0,0 +1,94 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2025-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\" Testing related to SwiftSync initial block download protocol.\n+\n+This test creates a node that acts as a single source of truth for two other nodes.\n+It tests three properties:\n+- A correctly constructed hints file allows a new client to perform initial block download\n+- Block reorganizations are handled by the new node online\n+- A faulty hints file is recognized by a new client and the new client can recover with a `-reindex`\n+\"\"\"\n+from test_framework.util import assert_equal\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.wallet import MiniWallet\n+\n+BASE_BLOCKS = 200\n+NUM_SWIFTSYNC_BLOCKS = 100\n+NUM_ADDITIONAL_BLOCKS = 100\n+GOOD_FILE = \"good.hints\"\n+BAD_FILE = \"bad.hints\"\n+\n+class SwiftSyncTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        self.add_nodes(3)\n+\n+    def run_test(self):\n+        full_node = self.nodes[0]\n+        sync_node = self.nodes[1]\n+        fail_node = self.nodes[2]\n+        self.start_node(0)\n+        mini_wallet = MiniWallet(full_node)\n+        ## Coinbase outputs are treated differently by the SwiftSync protocol as their inputs are ignored.\n+        ## To ensure the hash aggregate is working correctly, we also create non-coinbase transactions.\n+        self.log.info(f\"Generating {BASE_BLOCKS} blocks to a source node\")\n+        self.generate(mini_wallet, BASE_BLOCKS, sync_fun=self.no_op)\n+        self.log.info(f\"Sending {NUM_SWIFTSYNC_BLOCKS} self transfers\")\n+        for i in range(NUM_SWIFTSYNC_BLOCKS):",
      "path": "test/functional/feature_swiftsync.py",
      "position": 1,
      "original_position": 42,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit:\r\n```suggestion\r\n        for _ in range(NUM_SWIFTSYNC_BLOCKS):\r\n```",
      "created_at": "2025-12-11T21:35:18Z",
      "updated_at": "2025-12-11T21:35:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2612145025",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2612145025"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2612266788",
      "pull_request_review_id": 3569558994,
      "id": 2612266788,
      "node_id": "PRRC_kwDOABII586btAck",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 39,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Unkilled mutant:\r\n```diff\r\ndiff --git a/src/swiftsync.h b/muts-pr-34004-swiftsync-h/swiftsync.mutant.0.h\r\nindex 2c60e96895..ae229d18d8 100644\r\n--- a/src/swiftsync.h\r\n+++ b/muts-pr-34004-swiftsync-h/swiftsync.mutant.0.h\r\n@@ -36,7 +36,7 @@ private:\r\n public:\r\n     Aggregate();\r\n     /** Is the internal state zero, representing the empty set. */\r\n-    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\r\n+    bool IsZero() const { return m_limb0 == 0 || m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\r\n     /** Add an outpoint created in a block. */\r\n     void Add(const COutPoint& outpoint);\r\n     /** Spend an outpoint used in a block. */\r\n@@ -132,4 +132,4 @@ public:\r\n     uint32_t StopHeight() { return m_hint_reader->StopHeight(); };\r\n };\r\n\r\n```",
      "created_at": "2025-12-11T22:23:46Z",
      "updated_at": "2025-12-11T22:23:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2612266788",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2612266788"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 39,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2613366431",
      "pull_request_review_id": 3570829796,
      "id": 2613366431,
      "node_id": "PRRC_kwDOABII586bxM6f",
      "diff_hunk": "@@ -3396,6 +3397,125 @@ static RPCHelpMan loadtxoutset()\n     };\n }\n \n+static RPCHelpMan generatetxohints()\n+{\n+    return RPCHelpMan{\n+        \"generatetxohints\",\n+        \"Build a file of hints for the state of the UTXO set at a particular height.\\n\"\n+        \"The purpose of said hints is to allow clients performing initial block download\"\n+        \"to omit unnecessary disk I/O and CPU usage.\\n\"\n+        \"The hint file is constructed by reading in blocks sequentially and determining what outputs\"\n+        \"will remain in the UTXO set. Network activity will be suspended during this process, and the\"\n+        \"hint file may take a few hours to build.\"",
      "path": "src/rpc/blockchain.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": null,
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "LLM Linter (âœ¨ experimental)\r\n\r\nPossible typos and grammar issues:\r\n\r\n    \"initial block download\"\"to\" -> \"initial block download\" \"to\" [Two adjacent string literals were concatenated without a space, producing \"downloadto\". Insert a space between them.]\r\n    \"determining what outputs\"\"will\" -> \"determining what outputs\" \"will\" [Two adjacent string literals were concatenated without a space, producing \"outputswill\". Insert a space between them.]\r\n    \"hint file may take a few hours to build.\"\"Make\" -> \"hint file may take a few hours to build.\" \"Make\" [Two adjacent string literals were concatenated without a space, producing \"build.Make\". Insert a space or newline between them.]\r\n",
      "created_at": "2025-12-12T08:28:19Z",
      "updated_at": "2025-12-12T08:28:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2613366431",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2613366431"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 3405,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 3409,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2614495045",
      "pull_request_review_id": 3572156054,
      "id": 2614495045,
      "node_id": "PRRC_kwDOABII586b1gdF",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)\n+{\n+    // First write the current file position for the current height in the header section.\n+    uint64_t curr_pos = m_file.size();\n+    uint64_t cursor = FILE_HEADER_LEN + (m_index * (sizeof(uint64_t) + sizeof(uint32_t)));\n+    m_file.seek(cursor, SEEK_SET);\n+    m_file << height;\n+    m_file << curr_pos;\n+    // Next append the positions of the unspent offsets in the block at this height.\n+    m_file.seek(curr_pos, SEEK_SET);\n+    WriteCompactSize(m_file, unspent_offsets.size());\n+    for (const auto& offset : unspent_offsets) {\n+        WriteCompactSize(m_file, offset);\n+    }\n+    m_index++;\n+    return m_file.Commit();\n+}\n+\n+HintsfileReader::HintsfileReader(AutoFile& file) : m_file(file.release())\n+{\n+    std::array<uint8_t, 4> magic{};\n+    m_file >> magic;\n+    if (magic != FILE_MAGIC) {\n+        throw std::ios_base::failure(\"HintsfileReader: This is not a hint file.\");\n+    }\n+    uint8_t version{};\n+    m_file >> version;\n+    if (version != FILE_VERSION) {\n+        throw std::ios_base::failure(\"HintsfileReader: Unsupported file version.\");\n+    }\n+    m_file >> m_stop_height;\n+    for (uint32_t index = 1; index <= m_stop_height; index++) {",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 89,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2591795898,
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Side-effect of a past commit. Fixed.",
      "created_at": "2025-12-12T14:55:45Z",
      "updated_at": "2025-12-12T14:55:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2614495045",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2614495045"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 89,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2614499974",
      "pull_request_review_id": 3572162905,
      "id": 2614499974,
      "node_id": "PRRC_kwDOABII586b1hqG",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 60,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2602773194,
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Changed to void cast for style consistency",
      "created_at": "2025-12-12T14:56:46Z",
      "updated_at": "2025-12-12T14:56:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2614499974",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2614499974"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2614523808",
      "pull_request_review_id": 3572194767,
      "id": 2614523808,
      "node_id": "PRRC_kwDOABII586b1neg",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 26,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2603002475,
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I have used this exact suggestion and added you as a commit co-author. Indeed, the salt is the primary defense against grinding here. I was not sure and discussed out of band, but I think siphash should be faster. As far as the \"balancing\" concept, this avoids having to invert a field element (subtracting an element is addition of the inverse), so I think this is strictly an improvement. Thanks for the suggestion. I was not aware of `arith_uint256` prior to your review.",
      "created_at": "2025-12-12T15:01:20Z",
      "updated_at": "2025-12-12T15:01:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2614523808",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2614523808"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 21,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2614526263",
      "pull_request_review_id": 3572197997,
      "id": 2614526263,
      "node_id": "PRRC_kwDOABII586b1oE3",
      "diff_hunk": "@@ -39,6 +39,7 @@\n #include <script/descriptor.h>\n #include <serialize.h>\n #include <streams.h>\n+#include <swiftsync.h>",
      "path": "src/rpc/blockchain.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2603026740,
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Changed the \"accelerated\" log to \"SwiftSync\" for consistency",
      "created_at": "2025-12-12T15:01:51Z",
      "updated_at": "2025-12-12T15:01:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2614526263",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2614526263"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 42,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2615700914",
      "pull_request_review_id": 3573744620,
      "id": 2615700914,
      "node_id": "PRRC_kwDOABII586b6G2y",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 26,
      "commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2603002475,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> added you as a commit co-author\r\n\r\nYou need to add a [coauthor](https://docs.github.com/en/pull-requests/committing-changes-to-your-project/creating-and-editing-commits/creating-a-commit-with-multiple-authors#creating-co-authored-commits-on-the-command-line) with a fixed format, e.g. https://github.com/bitcoin/bitcoin/commit/8e4c66d0a7a0911c10dced0d6dd60ca7bd9545af",
      "created_at": "2025-12-12T22:06:49Z",
      "updated_at": "2025-12-12T22:06:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2615700914",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2615700914"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 21,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2619331691",
      "pull_request_review_id": 3578048785,
      "id": 2619331691,
      "node_id": "PRRC_kwDOABII586cH9Rr",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 58,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2591793669,
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "No. Are all primitives expected to be passed by value? I don't see a harm in making them `const`, but maybe I am missing something. ",
      "created_at": "2025-12-15T13:00:22Z",
      "updated_at": "2025-12-15T13:00:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2619331691",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2619331691"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2619344675",
      "pull_request_review_id": 3578067046,
      "id": 2619344675,
      "node_id": "PRRC_kwDOABII586cIAcj",
      "diff_hunk": "@@ -0,0 +1,68 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <boost/test/unit_test.hpp>\n+#include <common/args.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <test/util/setup_common.h>\n+#include <cstdio>\n+\n+namespace {\n+Txid txid_1{Txid::FromHex(\"bd0f71c1d5e50589063e134fad22053cdae5ab2320db5bf5e540198b0b5a4e69\").value()};\n+Txid txid_2{Txid::FromHex(\"b4749f017444b051c44dfd2720e88f314ff94f3dd6d56d40ef65854fcd7fff6b\").value()};\n+Txid txid_3{Txid::FromHex(\"ee707be5201160e32c4fc715bec227d1aeea5940fb4295605e7373edce3b1a93\").value()};",
      "path": "src/test/swiftsync_tests.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "8abdfec5eb5ed204f2dbdbf3d5c00ca052ade821",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2602698384,
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "PR'd #34063 ",
      "created_at": "2025-12-15T13:03:27Z",
      "updated_at": "2025-12-15T13:03:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2619344675",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2619344675"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": 13,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2619355999",
      "pull_request_review_id": 3578082148,
      "id": 2619355999,
      "node_id": "PRRC_kwDOABII586cIDNf",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 58,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2591793669,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "C++ Core Guidelines say to pass things that are up to 2-3 words by value, for performance reasons: https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#rf-in",
      "created_at": "2025-12-15T13:05:33Z",
      "updated_at": "2025-12-15T13:05:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2619355999",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2619355999"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2620343038",
      "pull_request_review_id": 3579489943,
      "id": 2620343038,
      "node_id": "PRRC_kwDOABII586cL0L-",
      "diff_hunk": "@@ -0,0 +1,131 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <random.h>\n+#include <serialize.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <uint256.h>\n+#include <util/fs.h>\n+#include <array>\n+#include <cstdint>\n+#include <cstdio>\n+#include <ios>\n+#include <span>\n+#include <utility>\n+#include <vector>\n+\n+using namespace swiftsync;\n+\n+Aggregate::Aggregate()\n+{\n+    std::span<unsigned char> salt;\n+    GetStrongRandBytes(salt);\n+    m_salted_hasher.write(std::as_writable_bytes(salt));\n+}\n+\n+void Aggregate::Add(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 += hash.GetUint64(0);\n+    m_limb1 += hash.GetUint64(1);\n+    m_limb2 += hash.GetUint64(2);\n+    m_limb3 += hash.GetUint64(3);\n+}\n+\n+void Aggregate::Spend(const COutPoint& outpoint)\n+{\n+    auto hash = (HashWriter(m_salted_hasher) << outpoint).GetSHA256();\n+    m_limb0 -= hash.GetUint64(0);\n+    m_limb1 -= hash.GetUint64(1);\n+    m_limb2 -= hash.GetUint64(2);\n+    m_limb3 -= hash.GetUint64(3);\n+}\n+\n+HintsfileWriter::HintsfileWriter(AutoFile& file, const uint32_t& preallocate) : m_file(file.release())\n+{\n+    uint64_t dummy_file_pos{0};\n+    m_file << FILE_MAGIC;\n+    m_file << FILE_VERSION;\n+    m_file << preallocate;\n+    for (uint32_t height = 1; height <= preallocate; height++) {\n+        m_file << height;\n+        m_file << dummy_file_pos;\n+    }\n+}\n+\n+bool HintsfileWriter::WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height)",
      "path": "src/swiftsync.cpp",
      "position": 1,
      "original_position": 58,
      "commit_id": "68539852861e22acb051bdb1213b3e04cab22cd5",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2591793669,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> for performance reasons\r\n\r\nyes, and it's also easier to reason about local state",
      "created_at": "2025-12-15T17:59:03Z",
      "updated_at": "2025-12-15T17:59:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2620343038",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2620343038"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2626401193",
      "pull_request_review_id": 3586955850,
      "id": 2626401193,
      "node_id": "PRRC_kwDOABII586ci7Op",
      "diff_hunk": "@@ -0,0 +1,135 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_SWIFTSYNC_H\n+#define BITCOIN_SWIFTSYNC_H\n+#include <hash.h>\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <uint256.h>\n+#include <array>\n+#include <cstdint>\n+#include <unordered_map>\n+#include <util/fs.h>\n+#include <vector>\n+\n+namespace swiftsync {\n+inline constexpr std::array<uint8_t, 4> FILE_MAGIC = {0x55, 0x54, 0x58, 0x4f};\n+const uint8_t FILE_VERSION = 0x00;\n+// file magic length + version + height\n+const uint64_t FILE_HEADER_LEN = 9;\n+/** An aggregate for the SwiftSync protocol.\n+ * This class is intentionally left opaque, as internal changes may occur,\n+ * but all aggregates will have the concept of \"adding\" and \"spending\" an\n+ * outpoint.\n+ *\n+ * The current implementation uses a salted SHA-256 hash and updates two\n+ * 64-bit integers by taking the first 16 bytes of the hash and adding or\n+ * subtracting according to if the outpoint was added or spent.\n+ * */\n+class Aggregate\n+{\n+private:\n+    uint64_t m_limb0{}, m_limb1{}, m_limb2{}, m_limb3{};\n+    HashWriter m_salted_hasher{};\n+\n+public:\n+    Aggregate();\n+    /** Is the internal state zero, representing the empty set. */\n+    bool IsZero() const { return m_limb0 == 0 && m_limb1 == 0 && m_limb2 == 0 && m_limb3 == 0; }\n+    /** Add an outpoint created in a block. */\n+    void Add(const COutPoint& outpoint);\n+    /** Spend an outpoint used in a block. */\n+    void Spend(const COutPoint& outpoint);\n+};\n+\n+/**\n+ * Create a new hint file for writing.\n+ */\n+class HintsfileWriter\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_index{};\n+\n+public:\n+    // Create a new hint file writer that will encode `preallocate` number of blocks.\n+    HintsfileWriter(AutoFile& file, const uint32_t& preallocate);\n+    ~HintsfileWriter()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    // Write the next hints to file.\n+    bool WriteNextUnspents(const std::vector<uint64_t>& unspent_offsets, const uint32_t& height);\n+    // Close the underlying file.\n+    int Close() { return m_file.fclose(); };\n+};\n+\n+/**\n+ * A file that encodes the UTXO set state at a particular block height.\n+ */\n+class HintsfileReader\n+{\n+private:\n+    AutoFile m_file;\n+    uint32_t m_stop_height;\n+    std::unordered_map<uint32_t, uint64_t> m_height_to_file_pos;\n+\n+public:\n+    HintsfileReader(AutoFile& file);\n+    HintsfileReader(HintsfileReader&& o) noexcept;\n+    ~HintsfileReader()\n+    {\n+        std::ignore = m_file.fclose();\n+    }\n+    /** Read the hints for the specified block height. */\n+    std::vector<uint64_t> ReadBlock(const uint32_t& height);\n+    /** The height this file encodes up to. */\n+    uint32_t StopHeight() { return m_stop_height; };\n+};\n+\n+/**\n+ * Stateful data structure that walks over the outputs of a block, determining the spent-ness.\n+ */\n+class BlockHints\n+{\n+private:\n+    std::unordered_set<uint64_t> m_unspent_outputs_index;",
      "path": "src/swiftsync.h",
      "position": 1,
      "original_position": 97,
      "commit_id": "53c887bf2e134966870e2c2c4c8b59b9a0e851de",
      "original_commit_id": "fcdce16cf1c974a153942948af334f2859169559",
      "in_reply_to_id": 2602867982,
      "user": {
        "login": "rustaceanrob",
        "id": 102320249,
        "node_id": "U_kgDOBhlIeQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/102320249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rustaceanrob",
        "html_url": "https://github.com/rustaceanrob",
        "followers_url": "https://api.github.com/users/rustaceanrob/followers",
        "following_url": "https://api.github.com/users/rustaceanrob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rustaceanrob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rustaceanrob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rustaceanrob/subscriptions",
        "organizations_url": "https://api.github.com/users/rustaceanrob/orgs",
        "repos_url": "https://api.github.com/users/rustaceanrob/repos",
        "events_url": "https://api.github.com/users/rustaceanrob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rustaceanrob/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "See comment, I will investigate this in the coming weeks.",
      "created_at": "2025-12-17T10:05:43Z",
      "updated_at": "2025-12-17T10:05:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2626401193",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2626401193"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 93,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2628927165",
      "pull_request_review_id": 3590009095,
      "id": 2628927165,
      "node_id": "PRRC_kwDOABII586csj69",
      "diff_hunk": "@@ -29,4 +38,80 @@ BOOST_AUTO_TEST_CASE(swiftsync_aggregate_test)\n     BOOST_CHECK(agg.IsBalanced());\n }\n \n+BOOST_AUTO_TEST_CASE(swiftsync_hintfile_test)\n+{\n+    const fs::path temppath = fsbridge::AbsPathJoin(gArgs.GetDataDirNet(), fs::u8path(\"test.hints\"));\n+    {\n+        FILE* file{fsbridge::fopen(temppath, \"wb\")};\n+        AutoFile afile{file};\n+        swiftsync::HintsfileWriter writer{afile, 3};\n+        swiftsync::BlockHintsWriter block_one{};\n+        for (const bool hint : unspent_block_1) {\n+            if (hint) {\n+                block_one.PushHighBit();\n+            } else {\n+                block_one.PushLowBit();\n+            };\n+        }\n+        BOOST_CHECK(writer.WriteNextUnspents(block_one, 1));\n+        swiftsync::BlockHintsWriter block_three{};\n+        for (const bool hint : unspent_block_3) {",
      "path": "src/test/swiftsync_tests.cpp",
      "position": 58,
      "original_position": 50,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "77b2518e9903d0b1fffe1ca7cfd5f7e191af0b5a: nit: We could avoid this duplicated loop (we basically have the same thing for each unspent block) by creating an \"util\" function that does it. ",
      "created_at": "2025-12-17T23:06:11Z",
      "updated_at": "2025-12-17T23:58:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2628927165",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2628927165"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 58,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2628960699",
      "pull_request_review_id": 3590009095,
      "id": 2628960699,
      "node_id": "PRRC_kwDOABII586cssG7",
      "diff_hunk": "@@ -0,0 +1,94 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2025-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\" Testing related to SwiftSync initial block download protocol.\n+\n+This test creates a node that acts as a single source of truth for two other nodes.\n+It tests three properties:\n+- A correctly constructed hints file allows a new client to perform initial block download\n+- Block reorganizations are handled by the new node online\n+- A faulty hints file is recognized by a new client and the new client can recover with a `-reindex`\n+\"\"\"\n+from test_framework.util import assert_equal\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.wallet import MiniWallet\n+\n+BASE_BLOCKS = 200\n+NUM_SWIFTSYNC_BLOCKS = 100\n+NUM_ADDITIONAL_BLOCKS = 100\n+GOOD_FILE = \"good.hints\"\n+BAD_FILE = \"bad.hints\"\n+\n+class SwiftSyncTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        self.add_nodes(3)\n+\n+    def run_test(self):\n+        full_node = self.nodes[0]\n+        sync_node = self.nodes[1]\n+        fail_node = self.nodes[2]\n+        self.start_node(0)\n+        mini_wallet = MiniWallet(full_node)\n+        ## Coinbase outputs are treated differently by the SwiftSync protocol as their inputs are ignored.\n+        ## To ensure the hash aggregate is working correctly, we also create non-coinbase transactions.\n+        self.log.info(f\"Generating {BASE_BLOCKS} blocks to a source node\")\n+        self.generate(mini_wallet, BASE_BLOCKS, sync_fun=self.no_op)\n+        self.log.info(f\"Sending {NUM_SWIFTSYNC_BLOCKS} self transfers\")\n+        for _ in range(NUM_SWIFTSYNC_BLOCKS):\n+            mini_wallet.send_self_transfer(from_node=full_node)\n+            self.generate(full_node, nblocks=1, sync_fun=self.no_op)\n+        self.log.info(\"Creating hints file\")\n+        result = full_node.generatetxohints(GOOD_FILE)\n+        hints_path = result[\"path\"]\n+        self.log.info(f\"Created hints file at {hints_path}\")\n+        assert_equal(full_node.getblockcount(), NUM_SWIFTSYNC_BLOCKS + BASE_BLOCKS)",
      "path": "test/functional/feature_swiftsync.py",
      "position": 49,
      "original_position": 49,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "86d009d0009a53bbb42923b1c1c062f11499d481: You could also assert that the block count is the same as `result[\"height\"]`.",
      "created_at": "2025-12-17T23:27:20Z",
      "updated_at": "2025-12-17T23:58:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2628960699",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2628960699"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 49,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2628968775",
      "pull_request_review_id": 3590009095,
      "id": 2628968775,
      "node_id": "PRRC_kwDOABII586csuFH",
      "diff_hunk": "@@ -478,6 +479,7 @@ void SetupServerArgs(ArgsManager& argsman, bool can_listen_ipc)\n     argsman.AddArg(\"-alertnotify=<cmd>\", \"Execute command when an alert is raised (%s in cmd is replaced by message)\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n #endif\n     argsman.AddArg(\"-assumevalid=<hex>\", strprintf(\"If this block is in the chain assume that it and its ancestors are valid and potentially skip their script verification (0 to verify all, default: %s, testnet3: %s, testnet4: %s, signet: %s)\", defaultChainParams->GetConsensus().defaultAssumeValid.GetHex(), testnetChainParams->GetConsensus().defaultAssumeValid.GetHex(), testnet4ChainParams->GetConsensus().defaultAssumeValid.GetHex(), signetChainParams->GetConsensus().defaultAssumeValid.GetHex()), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-utxohints=<path>\", \"Accelerate initial block download with the assistance of a UTXO hint file.\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS),",
      "path": "src/init.cpp",
      "position": 12,
      "original_position": 12,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "d019f9abe70ba9b488baac3454e9c853b04fe885",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "d019f9abe70ba9b488baac3454e9c853b04fe885: We could point here that it cannot be used without pruned mode.",
      "created_at": "2025-12-17T23:32:51Z",
      "updated_at": "2025-12-17T23:58:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2628968775",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2628968775"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 482,
      "original_line": 482,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2630789857",
      "pull_request_review_id": 3592577690,
      "id": 2630789857,
      "node_id": "PRRC_kwDOABII586czqrh",
      "diff_hunk": "@@ -0,0 +1,117 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include <primitives/transaction.h>\n+#include <streams.h>\n+#include <swiftsync.h>\n+#include <test/util/setup_common.h>\n+#include <boost/test/unit_test.hpp>\n+#include <cstdio>\n+\n+namespace {\n+Txid txid_1{Txid{\"bd0f71c1d5e50589063e134fad22053cdae5ab2320db5bf5e540198b0b5a4e69\"}};\n+Txid txid_2{Txid{\"b4749f017444b051c44dfd2720e88f314ff94f3dd6d56d40ef65854fcd7fff6b\"}};\n+Txid txid_3{Txid{\"ee707be5201160e32c4fc715bec227d1aeea5940fb4295605e7373edce3b1a93\"}};\n+COutPoint outpoint_1{COutPoint{txid_1, 2142}};\n+COutPoint outpoint_2{COutPoint{txid_2, 99328}};\n+COutPoint outpoint_3{COutPoint{txid_3, 5438584}};\n+// One byte worth of hints.\n+std::vector<bool> unspent_block_1{true, false, false, true, false, true, true, true};\n+// Between one and two bytes worth of hints.\n+std::vector<bool> unspent_block_2{true, false, false, true, false, true, true, true, true, false, true};\n+// Two bytes worth of hints.\n+std::vector<bool> unspent_block_3{true, false, false, true, false, true, true, true, true, false, true, true, true, true, true, true};\n+} // namespace\n+\n+BOOST_FIXTURE_TEST_SUITE(swiftsync_tests, BasicTestingSetup);\n+\n+BOOST_AUTO_TEST_CASE(swiftsync_aggregate_test)",
      "path": "src/test/swiftsync_tests.cpp",
      "position": 28,
      "original_position": 28,
      "commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "original_commit_id": "86d009d0009a53bbb42923b1c1c062f11499d481",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "1ff59a15407cb5fdc2ae06358e45134166db2448: Besides a unit test for the aggregate, I think a fuzz testing would be nice, e.g.:\r\n\r\n```cpp\r\n// Copyright (c) 2025-present The Bitcoin Core developers\r\n// Distributed under the MIT software license, see the accompanying\r\n// file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n\r\n#include <random.h>\r\n#include <test/fuzz/FuzzedDataProvider.h>\r\n#include <test/fuzz/fuzz.h>\r\n#include <test/fuzz/util.h>\r\n#include <test/util/setup_common.h>\r\n#include <swiftsync.h>\r\n\r\nFUZZ_TARGET(swiftsync_aggregate_test)\r\n{\r\n    SeedRandomStateForTest(SeedRand::ZEROS);\r\n    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\r\n    swiftsync::Aggregate agg{};\r\n    bool good_data{true};\r\n    LIMITED_WHILE(good_data && fuzzed_data_provider.ConsumeBool(), 500) {\r\n        const std::optional<COutPoint> out_point{ConsumeDeserializable<COutPoint>(fuzzed_data_provider)};\r\n        if (!out_point) {\r\n            good_data = false;\r\n            return;\r\n        }\r\n\r\n        if (fuzzed_data_provider.ConsumeBool()) {\r\n            agg.Spend(*out_point);\r\n        } else {\r\n            agg.Create(*out_point);\r\n        }\r\n    }\r\n    (void)agg.IsBalanced();\r\n}\r\n\r\n```",
      "created_at": "2025-12-18T12:04:47Z",
      "updated_at": "2025-12-18T12:04:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34004#discussion_r2630789857",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2630789857"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34004"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 28,
      "original_line": 28,
      "side": "RIGHT"
    }
  ]
}