{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033",
    "id": 2683353492,
    "node_id": "PR_kwDOABII586f8LmU",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/33033",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/33033.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/33033.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33033",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33033/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/0af7c2a11819a21e11abf34b4229c5c21150d827",
    "number": 33033,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet, sqlite: Encapsulate SQLite statements in a RAII class",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "SQLite statements are C objects which can be long lived, so having them be initialized in a constructor, and cleanup everything in a destructor, makes the sqlite code cleaner and easier to read. This also lets us have the various functions needed to interact with sqlite statements be member functions.\r\n\r\nThis will be particularly useful in future work which makes use of more complicated SQL statements.",
    "labels": [],
    "created_at": "2025-07-21T22:43:08Z",
    "updated_at": "2025-11-17T21:28:43Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "0124e1704db42531ddafe76f49898f2deca929f6",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "achow101:sqlite-stmt-raii",
      "ref": "sqlite-stmt-raii",
      "sha": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 45006379,
        "node_id": "MDEwOlJlcG9zaXRvcnk0NTAwNjM3OQ==",
        "name": "bitcoin",
        "full_name": "achow101/bitcoin",
        "owner": {
          "login": "achow101",
          "id": 3782274,
          "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/achow101",
          "html_url": "https://github.com/achow101",
          "followers_url": "https://api.github.com/users/achow101/followers",
          "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
          "organizations_url": "https://api.github.com/users/achow101/orgs",
          "repos_url": "https://api.github.com/users/achow101/repos",
          "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/achow101/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/achow101/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/achow101/bitcoin",
        "archive_url": "https://api.github.com/repos/achow101/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/achow101/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/achow101/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/achow101/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/achow101/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/achow101/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/achow101/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/achow101/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/achow101/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/achow101/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/achow101/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/achow101/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/achow101/bitcoin/events",
        "forks_url": "https://api.github.com/repos/achow101/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/achow101/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/achow101/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/achow101/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/achow101/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/achow101/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/achow101/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/achow101/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/achow101/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/achow101/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/achow101/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/achow101/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/achow101/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/achow101/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/achow101/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/achow101/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:achow101/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/achow101/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/achow101/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/achow101/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/achow101/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/achow101/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/achow101/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/achow101/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/achow101/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/achow101/bitcoin/hooks",
        "svn_url": "https://github.com/achow101/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 10,
        "stargazers_count": 40,
        "watchers_count": 40,
        "size": 311475,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-17T21:26:00Z",
        "created_at": "2015-10-27T00:20:28Z",
        "updated_at": "2025-11-04T06:39:45Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "ead849c9f177a3a175a22b35fa864b4b37fb9934",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38215,
        "stargazers_count": 86848,
        "watchers_count": 86848,
        "size": 296068,
        "default_branch": "master",
        "open_issues_count": 741,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-17T14:00:10Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-11-17T19:17:05Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 202,
    "deletions": 207,
    "changed_files": 2,
    "commits": 9,
    "review_comments": 38,
    "comments": 2
  },
  "events": [
    {
      "event": "commented",
      "id": 3099699375,
      "node_id": "IC_kwDOABII5864waiv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3099699375",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-21T22:43:12Z",
      "updated_at": "2025-11-13T07:25:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33033.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [rkrux](https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3404260829) |\n| Approach ACK | [vasild](https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3452618086) |\n| Stale ACK | [w0xlt](https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3049382506) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33034](https://github.com/bitcoin/bitcoin/pull/33034) (wallet: Store transactions in a separate sqlite table by achow101)\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n* [#25722](https://github.com/bitcoin/bitcoin/pull/25722) (refactor: Use util::Result class for wallet loading by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#issuecomment-3099699375",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33033"
    },
    {
      "event": "labeled",
      "id": 18740990993,
      "node_id": "LE_lADOABII587Buqg4zwAAAARdDNQR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18740990993",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-22T02:33:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3100539274,
      "node_id": "IC_kwDOABII5864znmK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3100539274",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-22T02:33:18Z",
      "updated_at": "2025-07-22T02:33:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `previous releases, depends DEBUG`: https://github.com/bitcoin/bitcoin/runs/46428794695</sub>\n<sub>LLM reason (âœ¨ experimental): The CI failure is caused by a static assertion failure in the sqlite.cpp file during compilation.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#issuecomment-3100539274",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33033"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18741355503,
      "node_id": "HRFPE_lADOABII587Buqg4zwAAAARdEmPv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18741355503",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "7fe3a8ed9cc2c987e36a8aeb0a2cdf76fe5b1610",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/7fe3a8ed9cc2c987e36a8aeb0a2cdf76fe5b1610",
      "created_at": "2025-07-22T03:05:45Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18741463907,
      "node_id": "HRFPE_lADOABII587Buqg4zwAAAARdFAtj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18741463907",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "e1bf41a5aa1b90659034e441446569cda507069f",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/e1bf41a5aa1b90659034e441446569cda507069f",
      "created_at": "2025-07-22T03:16:53Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18743868260,
      "node_id": "HRFPE_lADOABII587Buqg4zwAAAARdOLtk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18743868260",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "2c1edccfc5b5a1ef792248cba3b7291c3ee55fb6",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/2c1edccfc5b5a1ef792248cba3b7291c3ee55fb6",
      "created_at": "2025-07-22T06:11:43Z"
    },
    {
      "event": "reviewed",
      "id": 3041694144,
      "node_id": "PRR_kwDOABII5861TJHA",
      "url": null,
      "actor": null,
      "commit_id": "2c1edccfc5b5a1ef792248cba3b7291c3ee55fb6",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-22T08:07:39Z",
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3041694144",
      "submitted_at": "2025-07-22T08:07:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
    },
    {
      "event": "unlabeled",
      "id": 18748165996,
      "node_id": "UNLE_lADOABII587Buqg4zwAAAARdek9s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18748165996",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-22T09:49:13Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18757024168,
      "node_id": "HRFPE_lADOABII587Buqg4zwAAAAReAXmo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18757024168",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b2c824a3ce0877f2cb7cbed1731088ed8ba6171a",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/b2c824a3ce0877f2cb7cbed1731088ed8ba6171a",
      "created_at": "2025-07-22T17:00:53Z"
    },
    {
      "event": "reviewed",
      "id": 3049049509,
      "node_id": "PRR_kwDOABII5861vM2l",
      "url": null,
      "actor": null,
      "commit_id": "b2c824a3ce0877f2cb7cbed1731088ed8ba6171a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-23T21:00:23Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3049049509",
      "submitted_at": "2025-07-23T21:00:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
    },
    {
      "event": "reviewed",
      "id": 3049382506,
      "node_id": "PRR_kwDOABII5861weJq",
      "url": null,
      "actor": null,
      "commit_id": "b2c824a3ce0877f2cb7cbed1731088ed8ba6171a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-23T23:03:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "Looks good to me\r\n\r\nACK https://github.com/bitcoin/bitcoin/pull/33033/commits/b2c824a3ce0877f2cb7cbed1731088ed8ba6171a",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3049382506",
      "submitted_at": "2025-07-23T23:03:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
    },
    {
      "event": "reviewed",
      "id": 3050397496,
      "node_id": "PRR_kwDOABII58610V84",
      "url": null,
      "actor": null,
      "commit_id": "b2c824a3ce0877f2cb7cbed1731088ed8ba6171a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-24T07:58:20Z",
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3050397496",
      "submitted_at": "2025-07-24T07:58:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18802988005,
      "node_id": "HRFPE_lADOABII587Buqg4zwAAAARgvtPl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18802988005",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a8cf39607e9f3425a99492e3bb7d798f8a139cb8",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/a8cf39607e9f3425a99492e3bb7d798f8a139cb8",
      "created_at": "2025-07-24T20:30:04Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18803264434,
      "node_id": "HRFPE_lADOABII587Buqg4zwAAAARgwwuy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18803264434",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "created_at": "2025-07-24T20:50:46Z"
    },
    {
      "event": "review_requested",
      "id": 20434620494,
      "node_id": "RRE_lADOABII587Buqg4zwAAAATB_5BO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20434620494",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:48:47Z",
      "requested_reviewer": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 20434620528,
      "node_id": "RRE_lADOABII587Buqg4zwAAAATB_5Bw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20434620528",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:48:47Z",
      "requested_reviewer": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 20434620541,
      "node_id": "RRE_lADOABII587Buqg4zwAAAATB_5B9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20434620541",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:48:47Z",
      "requested_reviewer": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 3404260829,
      "node_id": "PRR_kwDOABII587K6OXd",
      "url": null,
      "actor": null,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-31T14:22:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "Started reviewing; I'm not opposed to this introduction at the moment and I will get more clarity soon in the review.\n\nInitial Concept ACK 1829b3512d7bf430ec44daa801eb8fadf46cd30b\n\nThese 3 commits from #33034 looks pretty generic and related enough. Can they be included in this PR?\n- 818989093d9e6b8ee765c21630f7342b99af7fa0 \"sqlite: Make SQLiteStatement::Bind a template function\"\n- 07cac74e1340c7e771850633dd9418ff3efa5bb7 \"sqlite: Make SQLiteDatabase::Column an std::optional\"\n- ff47eea527e58071bdaff5c2acbc98ee97294021 \"sqlite: Add additional blob types to SQLiteStatement::Column\"\n\n",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3404260829",
      "submitted_at": "2025-10-31T14:22:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
    },
    {
      "event": "reviewed",
      "id": 3452618086,
      "node_id": "PRR_kwDOABII587NysVm",
      "url": null,
      "actor": null,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-12T16:21:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK 1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#pullrequestreview-3452618086",
      "submitted_at": "2025-11-12T16:21:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ5ZjdmNTE2MTQzODcxODIxMzJjYmU2MjE1NmVhNWM1ZDkwNDkwOWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d9f7f51614387182132cbe62156ea5c5d904909a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d9f7f51614387182132cbe62156ea5c5d904909a",
      "tree": {
        "sha": "58916b7a6dd1e2688683d0d1d9a885eba292f719",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/58916b7a6dd1e2688683d0d1d9a885eba292f719"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7129c9ea8e950f50bdc56d88c57617c66c90bb8a",
          "sha": "7129c9ea8e950f50bdc56d88c57617c66c90bb8a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7129c9ea8e950f50bdc56d88c57617c66c90bb8a"
        }
      ],
      "message": "sqlite: Add SQLiteStatement RAII class\n\nThis class will be used to encapsulate a sqlite3_stmt",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T21:22:34Z"
      },
      "sha": "d9f7f51614387182132cbe62156ea5c5d904909a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVjZDk3OGMzNzk4MmYwNmM4MzdmYTRiMDYzODVmOWM1YWZkYjgxZmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ecd978c37982f06c837fa4b06385f9c5afdb81fc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ecd978c37982f06c837fa4b06385f9c5afdb81fc",
      "tree": {
        "sha": "5874ebd486780f7ce1810fd5a942b42ed806cd17",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5874ebd486780f7ce1810fd5a942b42ed806cd17"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d9f7f51614387182132cbe62156ea5c5d904909a",
          "sha": "d9f7f51614387182132cbe62156ea5c5d904909a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d9f7f51614387182132cbe62156ea5c5d904909a"
        }
      ],
      "message": "sqlite: Make Column template function",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T21:29:16Z"
      },
      "sha": "ecd978c37982f06c837fa4b06385f9c5afdb81fc"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGIzMzFmMjgyNGZlMDI5Y2YxN2NlZDk4NzZkNjFlZWIwMjFjOGE1NzM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b331f2824fe029cf17ced9876d61eeb021c8a573",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b331f2824fe029cf17ced9876d61eeb021c8a573",
      "tree": {
        "sha": "73fe326652d71aa8465e03001e97bd5adc529c30",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/73fe326652d71aa8465e03001e97bd5adc529c30"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ecd978c37982f06c837fa4b06385f9c5afdb81fc",
          "sha": "ecd978c37982f06c837fa4b06385f9c5afdb81fc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ecd978c37982f06c837fa4b06385f9c5afdb81fc"
        }
      ],
      "message": "sqlite: Refactor ReadPragmaInteger to use SQLiteStatement",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T21:35:39Z"
      },
      "sha": "b331f2824fe029cf17ced9876d61eeb021c8a573"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI4NDc1MTg2YTI3N2I1NGY0MjhiMzYyNTQxNzhiMmQ4NzhlOTg1ZWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b8475186a277b54f428b36254178b2d878e985eb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b8475186a277b54f428b36254178b2d878e985eb",
      "tree": {
        "sha": "a7d7ac2790d12be4d18ca60c37f6c7ebc1159364",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a7d7ac2790d12be4d18ca60c37f6c7ebc1159364"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b331f2824fe029cf17ced9876d61eeb021c8a573",
          "sha": "b331f2824fe029cf17ced9876d61eeb021c8a573",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b331f2824fe029cf17ced9876d61eeb021c8a573"
        }
      ],
      "message": "sqlite: Use SQLiteStatement in PRAGMA integrity_check",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T21:39:16Z"
      },
      "sha": "b8475186a277b54f428b36254178b2d878e985eb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDJmN2E2YzU4YTJhODdkYzVkNTliOTk4ZWQ1NDgzNTRiZDk0ZWQxMjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2f7a6c58a2a87dc5d59b998ed548354bd94ed127",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2f7a6c58a2a87dc5d59b998ed548354bd94ed127",
      "tree": {
        "sha": "e28f11db4b5291837227ed3772c6dab393614a2a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e28f11db4b5291837227ed3772c6dab393614a2a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b8475186a277b54f428b36254178b2d878e985eb",
          "sha": "b8475186a277b54f428b36254178b2d878e985eb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b8475186a277b54f428b36254178b2d878e985eb"
        }
      ],
      "message": "sqlite: Use SQLiteStatement in check_main_stmt",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T21:39:40Z"
      },
      "sha": "2f7a6c58a2a87dc5d59b998ed548354bd94ed127"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdhN2QwNDUxMzM2OTk4YjFjNTg4ZjY3MTQwZGI4ODU3MTRkNTY2ZjU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7a7d0451336998b1c588f67140db885714d566f5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7a7d0451336998b1c588f67140db885714d566f5",
      "tree": {
        "sha": "8e2ffca559242e74cfce1964b21389c62a74e1af",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8e2ffca559242e74cfce1964b21389c62a74e1af"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2f7a6c58a2a87dc5d59b998ed548354bd94ed127",
          "sha": "2f7a6c58a2a87dc5d59b998ed548354bd94ed127",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2f7a6c58a2a87dc5d59b998ed548354bd94ed127"
        }
      ],
      "message": "sqlite: Have SQLiteCursor store SQLiteStatement",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T21:43:00Z"
      },
      "sha": "7a7d0451336998b1c588f67140db885714d566f5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY3NjExMTllNmYyM2Q5YzVhYzk1Yjk1ZDg3OTY2OWVhZjgzOTQ3MGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f761119e6f23d9c5ac95b95d879669eaf839470d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f761119e6f23d9c5ac95b95d879669eaf839470d",
      "tree": {
        "sha": "126f6c3dfdab2984439e700919884df9b63c8478",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/126f6c3dfdab2984439e700919884df9b63c8478"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7a7d0451336998b1c588f67140db885714d566f5",
          "sha": "7a7d0451336998b1c588f67140db885714d566f5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7a7d0451336998b1c588f67140db885714d566f5"
        }
      ],
      "message": "sqlite: Replace remaining sqlite3_stmt usage with SQLiteStatement",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T21:51:43Z"
      },
      "sha": "f761119e6f23d9c5ac95b95d879669eaf839470d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZmODk1NGYxMzZhYmNmMmY4ZjNhMGY1N2QzNzk4ODhkM2VkMjg3Yjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6f8954f136abcf2f8f3a0f57d379888d3ed287b7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6f8954f136abcf2f8f3a0f57d379888d3ed287b7",
      "tree": {
        "sha": "035753db6167ac83ebe62b8e209a170b6741e3f8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/035753db6167ac83ebe62b8e209a170b6741e3f8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f761119e6f23d9c5ac95b95d879669eaf839470d",
          "sha": "f761119e6f23d9c5ac95b95d879669eaf839470d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f761119e6f23d9c5ac95b95d879669eaf839470d"
        }
      ],
      "message": "sqlite: Refactor common writing code from WriteKey and ExecStatement\n\nWriteKey and ExecStatement use the same code for the actual execution of\nthe statement. This is refactored into a separate function, also called\nExecStatement, and the original ExecStatement renamed to\nExecEraseStatement as it is only used by the erase functions.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T21:57:15Z"
      },
      "sha": "6f8954f136abcf2f8f3a0f57d379888d3ed287b7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBhZjdjMmExMTgxOWEyMWUxMWFiZjM0YjQyMjljNWMyMTE1MGQ4Mjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0af7c2a11819a21e11abf34b4229c5c21150d827",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0af7c2a11819a21e11abf34b4229c5c21150d827",
      "tree": {
        "sha": "f73ddadf08edae16a7104f31f4e82e5bc6249348",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f73ddadf08edae16a7104f31f4e82e5bc6249348"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6f8954f136abcf2f8f3a0f57d379888d3ed287b7",
          "sha": "6f8954f136abcf2f8f3a0f57d379888d3ed287b7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6f8954f136abcf2f8f3a0f57d379888d3ed287b7"
        }
      ],
      "message": "sqlite: Inline BindBlobToStatement and SpanFromBlob",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-11-17T21:20:51Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2025-07-14T22:00:22Z"
      },
      "sha": "0af7c2a11819a21e11abf34b4229c5c21150d827"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20997907922,
      "node_id": "HRFPE_lADOABII587Buqg4zwAAAATjkqXS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20997907922",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/0af7c2a11819a21e11abf34b4229c5c21150d827",
      "created_at": "2025-11-17T21:26:02Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2221607401",
      "pull_request_review_id": 3041694144,
      "id": 2221607401,
      "node_id": "PRRC_kwDOABII586Eawnp",
      "diff_hunk": "@@ -58,44 +52,98 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsualtes a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));\n+        } else if constexpr (std::is_same_v<T, std::string>) {\n+            const char* text = (const char*)sqlite3_column_text(m_stmt, col);\n+            size_t size = sqlite3_column_bytes(m_stmt, col);\n+            std::string str_text(text, size);\n+            return str_text;\n+        } else if constexpr (ColumnBlob<T>) {\n+            return T(\n+                reinterpret_cast<T::element_type*>(sqlite3_column_blob(m_stmt, col)),\n+                static_cast<size_t>(sqlite3_column_bytes(m_stmt, col))\n+            );\n+        } else {\n+            // GCC <= 12 and Clang <= 16 don't like static_assert(false) in an else, so we use the following to achieve the same effect\n+            // From: https://devblogs.microsoft.com/oldnewthing/20200311-00/?p=103553\n+            static_assert(!sizeof(T*));",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 110,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "2c1edccfc5b5a1ef792248cba3b7291c3ee55fb6",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: you can  use `ALWAYS_FALSE` for this, so that the workaround docs for the  C++23 defect report are in one place only.",
      "created_at": "2025-07-22T08:07:39Z",
      "updated_at": "2025-07-22T08:07:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2221607401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2221607401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 130,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 132,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2223248647",
      "pull_request_review_id": 3044007634,
      "id": 2223248647,
      "node_id": "PRRC_kwDOABII586EhBUH",
      "diff_hunk": "@@ -58,44 +52,98 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsualtes a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));\n+        } else if constexpr (std::is_same_v<T, std::string>) {\n+            const char* text = (const char*)sqlite3_column_text(m_stmt, col);\n+            size_t size = sqlite3_column_bytes(m_stmt, col);\n+            std::string str_text(text, size);\n+            return str_text;\n+        } else if constexpr (ColumnBlob<T>) {\n+            return T(\n+                reinterpret_cast<T::element_type*>(sqlite3_column_blob(m_stmt, col)),\n+                static_cast<size_t>(sqlite3_column_bytes(m_stmt, col))\n+            );\n+        } else {\n+            // GCC <= 12 and Clang <= 16 don't like static_assert(false) in an else, so we use the following to achieve the same effect\n+            // From: https://devblogs.microsoft.com/oldnewthing/20200311-00/?p=103553\n+            static_assert(!sizeof(T*));",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 110,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "2c1edccfc5b5a1ef792248cba3b7291c3ee55fb6",
      "in_reply_to_id": 2221607401,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-07-22T17:01:15Z",
      "updated_at": "2025-07-22T17:01:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2223248647",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2223248647"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 130,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 132,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2226679396",
      "pull_request_review_id": 3049049509,
      "id": 2226679396,
      "node_id": "PRRC_kwDOABII586EuG5k",
      "diff_hunk": "@@ -36,7 +36,10 @@ class transaction_identifier\n     }\n \n public:\n+    using value_type = uint256::value_type;\n+\n     transaction_identifier() : m_wrapped{} {}\n+    transaction_identifier(std::span<const value_type> sp) : m_wrapped(sp) {}",
      "path": "src/util/transaction_identifier.h",
      "position": 1,
      "original_position": 7,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "15d21068ce60c85bb37774de4edc4a23e84f1901",
      "in_reply_to_id": null,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Is there any specific reason not to use `unsigned char` directly, like `std::span<const unsigned char > sp)` ?",
      "created_at": "2025-07-23T21:00:19Z",
      "updated_at": "2025-07-23T21:00:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2226679396",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2226679396"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2226706401",
      "pull_request_review_id": 3049088802,
      "id": 2226706401,
      "node_id": "PRRC_kwDOABII586EuNfh",
      "diff_hunk": "@@ -36,7 +36,10 @@ class transaction_identifier\n     }\n \n public:\n+    using value_type = uint256::value_type;\n+\n     transaction_identifier() : m_wrapped{} {}\n+    transaction_identifier(std::span<const value_type> sp) : m_wrapped(sp) {}",
      "path": "src/util/transaction_identifier.h",
      "position": 1,
      "original_position": 7,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "15d21068ce60c85bb37774de4edc4a23e84f1901",
      "in_reply_to_id": 2226679396,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In theory we could change `uint256`'s `value_type`, and we wouldn't need to make any changes here in that case.",
      "created_at": "2025-07-23T21:15:55Z",
      "updated_at": "2025-07-23T21:15:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2226706401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2226706401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2227638927",
      "pull_request_review_id": 3050397496,
      "id": 2227638927,
      "node_id": "PRRC_kwDOABII586ExxKP",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsualtes a sqlite3_stmt */",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 37,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "b2c824a3ce0877f2cb7cbed1731088ed8ba6171a",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\n    encapsualtes -> encapsulates [spelling error in comment â€œencapsualtesâ€ makes the word misspelled]\n",
      "created_at": "2025-07-24T07:13:54Z",
      "updated_at": "2025-07-24T07:58:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2227638927",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2227638927"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 61,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2227753763",
      "pull_request_review_id": 3050397496,
      "id": 2227753763,
      "node_id": "PRRC_kwDOABII586EyNMj",
      "diff_hunk": "@@ -36,7 +36,10 @@ class transaction_identifier\n     }\n \n public:\n+    using value_type = uint256::value_type;\n+\n     transaction_identifier() : m_wrapped{} {}\n+    transaction_identifier(std::span<const value_type> sp) : m_wrapped(sp) {}",
      "path": "src/util/transaction_identifier.h",
      "position": 1,
      "original_position": 7,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "15d21068ce60c85bb37774de4edc4a23e84f1901",
      "in_reply_to_id": 2226679396,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't understand this change. The commit message just says \"util: Add value_type and span constructor to (W)Txid\", but it doesn't say why or where this is needed. Compiling without this (locally) seems to pass.\n\nAlso, conceptually, it seems to go in the opposite direction that we want to go in. This makes implicit construction from any byte span to `transaction_identifier` possible again. The constructor `transaction_identifier(const uint256& wrapped)` is private and will still catch those cases, but if this implementation detail is changed in the future, I presume direct and implicit construction from uint256 will be possible again.\n\nI think it would be good to explain this change a bit better for reviewers.",
      "created_at": "2025-07-24T07:58:10Z",
      "updated_at": "2025-07-24T07:58:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2227753763",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2227753763"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2229151399",
      "pull_request_review_id": 3052609782,
      "id": 2229151399,
      "node_id": "PRRC_kwDOABII586E3ian",
      "diff_hunk": "@@ -36,7 +36,10 @@ class transaction_identifier\n     }\n \n public:\n+    using value_type = uint256::value_type;\n+\n     transaction_identifier() : m_wrapped{} {}\n+    transaction_identifier(std::span<const value_type> sp) : m_wrapped(sp) {}",
      "path": "src/util/transaction_identifier.h",
      "position": 1,
      "original_position": 7,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "15d21068ce60c85bb37774de4edc4a23e84f1901",
      "in_reply_to_id": 2226679396,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In `SQLiteStatement::Column<T>()`, one of the ways we construct the appropriate data from a blob is to do `reinterpret_cast<T::value_type>`. `Txid` met all of the requirements for using that constructor, except that it didn't have a `value_type`, hence this commit adding it.\r\n\r\nBut it looks like I didn't include that commit in this PR. Rather, it's https://github.com/bitcoin/bitcoin/pull/33034/commits/afe99b3b7df6c658fb4068c6418dfd7ebf151460 in #33034.",
      "created_at": "2025-07-24T17:40:19Z",
      "updated_at": "2025-07-24T17:40:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2229151399",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2229151399"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2229441917",
      "pull_request_review_id": 3053073285,
      "id": 2229441917,
      "node_id": "PRRC_kwDOABII586E4pV9",
      "diff_hunk": "@@ -36,7 +36,10 @@ class transaction_identifier\n     }\n \n public:\n+    using value_type = uint256::value_type;\n+\n     transaction_identifier() : m_wrapped{} {}\n+    transaction_identifier(std::span<const value_type> sp) : m_wrapped(sp) {}",
      "path": "src/util/transaction_identifier.h",
      "position": 1,
      "original_position": 7,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "15d21068ce60c85bb37774de4edc4a23e84f1901",
      "in_reply_to_id": 2226679396,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I see. Though, it may still be good to make this one `explicit` to avoid silent uint256 conversions in the future?\r\n\r\nAlso, `Txid::data` is `std::byte*`, so `value_type` should probably be `std::byte` as well.\r\n\r\nI haven't tried, but I presume both modifications should compile with afe99b3b7df6c658fb4068c6418dfd7ebf151460",
      "created_at": "2025-07-24T19:50:09Z",
      "updated_at": "2025-07-24T19:50:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2229441917",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2229441917"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2229546952",
      "pull_request_review_id": 3053247528,
      "id": 2229546952,
      "node_id": "PRRC_kwDOABII586E5C_I",
      "diff_hunk": "@@ -36,7 +36,10 @@ class transaction_identifier\n     }\n \n public:\n+    using value_type = uint256::value_type;\n+\n     transaction_identifier() : m_wrapped{} {}\n+    transaction_identifier(std::span<const value_type> sp) : m_wrapped(sp) {}",
      "path": "src/util/transaction_identifier.h",
      "position": 1,
      "original_position": 7,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "15d21068ce60c85bb37774de4edc4a23e84f1901",
      "in_reply_to_id": 2226679396,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I've dropped this commit from this PR and moved it to #33034. Also dropped `value_type` and made the constructor just take `span<const std::byte>` and that seems to work.",
      "created_at": "2025-07-24T20:49:51Z",
      "updated_at": "2025-07-24T20:49:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2229546952",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2229546952"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2229549000",
      "pull_request_review_id": 3053252230,
      "id": 2229549000,
      "node_id": "PRRC_kwDOABII586E5DfI",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsualtes a sqlite3_stmt */",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 37,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "b2c824a3ce0877f2cb7cbed1731088ed8ba6171a",
      "in_reply_to_id": 2227638927,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-07-24T20:50:47Z",
      "updated_at": "2025-07-24T20:50:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2229549000",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2229549000"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 61,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2481404565",
      "pull_request_review_id": 3404260829,
      "id": 2481404565,
      "node_id": "PRRC_kwDOABII586T5zqV",
      "diff_hunk": "",
      "path": "src/wallet/sqlite.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In d13ffed94ad5f5d488f8d72e4d5d7f1c3fb27c2b \"sqlite: Have SQLiteCursor store SQLiteStatement\"\n\nIt doesn't seem to be used anymore here; builds and tests fine without it.\n\n ```diff\n--- a/src/wallet/sqlite.h\n+++ b/src/wallet/sqlite.h\n@@ -12,7 +12,6 @@\n\n struct bilingual_str;\n\n-struct sqlite3_stmt;\n struct sqlite3;\n\n namespace wallet {\n```",
      "created_at": "2025-10-31T13:23:16Z",
      "updated_at": "2025-10-31T14:22:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2481404565",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2481404565"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2517689053",
      "pull_request_review_id": 3452618086,
      "id": 2517689053,
      "node_id": "PRRC_kwDOABII586WEOLd",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 41,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Looks like `m_db` can never be `nullptr` since it is initialized by the constructor to a presumably non-null value. Consider making this a reference `sqlite3& m_db;`. That would signal to the readers that it can never be null and will also make it impossible to have weird states of this class that somehow end up having a null member.",
      "created_at": "2025-11-12T10:04:52Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2517689053",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2517689053"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2517714796",
      "pull_request_review_id": 3452618086,
      "id": 2517714796,
      "node_id": "PRRC_kwDOABII586WEUds",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 50,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Just an observation:\n\nSome of the callers of `sqlite3_prepare_v2()` call `sqlite3_finalize()` on failure. The doc says that if prepare fails then [*ppStmt is set to NULL](https://sqlite.org/c3ref/prepare.html) and [Invoking sqlite3_finalize() on a NULL pointer is a harmless no-op](https://sqlite.org/c3ref/finalize.html).\n\nSo it is ok to omit the finalize call.",
      "created_at": "2025-11-12T10:12:57Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2517714796",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2517714796"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 72,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518277982",
      "pull_request_review_id": 3452618086,
      "id": 2518277982,
      "node_id": "PRRC_kwDOABII586WGd9e",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The class name is `SQLiteStatement`, is this intentionally `SQLiteDatabase`?",
      "created_at": "2025-11-12T13:17:36Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518277982",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518277982"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518281428",
      "pull_request_review_id": 3452618086,
      "id": 2518281428,
      "node_id": "PRRC_kwDOABII586WGezU",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think it would be useful to print the statement as well (`stmt_text`).",
      "created_at": "2025-11-12T13:18:44Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518281428",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518281428"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518298601",
      "pull_request_review_id": 3452618086,
      "id": 2518298601,
      "node_id": "PRRC_kwDOABII586WGi_p",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }",
      "path": "src/wallet/sqlite.cpp",
      "position": 60,
      "original_position": 61,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`Reset()` is not needed here?\n",
      "created_at": "2025-11-12T13:24:07Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518298601",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518298601"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": 79,
      "original_start_line": 79,
      "start_side": "RIGHT",
      "line": 82,
      "original_line": 82,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518340792",
      "pull_request_review_id": 3452618086,
      "id": 2518340792,
      "node_id": "PRRC_kwDOABII586WGtS4",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);",
      "path": "src/wallet/sqlite.cpp",
      "position": 94,
      "original_position": 94,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "From https://sqlite.org/c3ref/column_blob.html:\n> if the column index is out of range, the result is undefined\n\nMaybe at the beginning of the function, add:\n\n```cpp\nAssert(col < sqlite3_column_count());\n```\n\n",
      "created_at": "2025-11-12T13:35:36Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518340792",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518340792"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": 111,
      "original_start_line": 112,
      "start_side": "RIGHT",
      "line": 116,
      "original_line": 116,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518397420",
      "pull_request_review_id": 3452618086,
      "id": 2518397420,
      "node_id": "PRRC_kwDOABII586WG7Hs",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));",
      "path": "src/wallet/sqlite.cpp",
      "position": 96,
      "original_position": 96,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What happens if `T` is unsigned? Maybe add https://en.cppreference.com/w/cpp/types/is_signed.html here: `std::integral<T> && std::is_signed<T>`? (and leave it to drop to \"else assert always false\" for unsigned `T`s)",
      "created_at": "2025-11-12T13:52:18Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518397420",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518397420"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": 115,
      "original_start_line": 115,
      "start_side": "RIGHT",
      "line": 118,
      "original_line": 118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518476250",
      "pull_request_review_id": 3452618086,
      "id": 2518476250,
      "node_id": "PRRC_kwDOABII586WHOXa",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));\n+        } else if constexpr (std::is_same_v<T, std::string>) {\n+            const char* text = (const char*)sqlite3_column_text(m_stmt, col);\n+            size_t size = sqlite3_column_bytes(m_stmt, col);\n+            std::string str_text(text, size);\n+            return str_text;\n+        } else if constexpr (ColumnBlob<T>) {\n+            return T(\n+                reinterpret_cast<T::element_type*>(sqlite3_column_blob(m_stmt, col)),\n+                static_cast<size_t>(sqlite3_column_bytes(m_stmt, col))\n+            );\n+        } else {\n+            static_assert(ALWAYS_FALSE<T>);\n+        }\n+    }\n+};\n \n static std::optional<int> ReadPragmaInteger(sqlite3* db, const std::string& key, const std::string& description, bilingual_str& error)\n {\n     std::string stmt_text = strprintf(\"PRAGMA %s\", key);\n-    sqlite3_stmt* pragma_read_stmt{nullptr};\n-    int ret = sqlite3_prepare_v2(db, stmt_text.c_str(), -1, &pragma_read_stmt, nullptr);\n-    if (ret != SQLITE_OK) {\n-        sqlite3_finalize(pragma_read_stmt);\n-        error = Untranslated(strprintf(\"SQLiteDatabase: Failed to prepare the statement to fetch %s: %s\", description, sqlite3_errstr(ret)));\n-        return std::nullopt;\n-    }\n-    ret = sqlite3_step(pragma_read_stmt);\n+    SQLiteStatement pragma_read_stmt(db, stmt_text);",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 124,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Previously on error `ReadPragmaInteger()` would have returned `nullopt`. Now it would `throw`. Its only caller is `SQLiteDatabase::Verify()` which would have returned `false` and now would let the exception propagate. The only caller of `SQLiteDatabase::Verify()` is `MakeSQLiteDatabase()`. Before, on `Verify()` failure (return `false`) `MakeSQLiteDatabase()` would have set `status = DatabaseStatus::FAILED_VERIFY` and now (exception) it would set `status = DatabaseStatus::FAILED_LOAD`. Is this ok?",
      "created_at": "2025-11-12T14:14:55Z",
      "updated_at": "2025-11-12T16:24:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518476250",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518476250"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 138,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518504627",
      "pull_request_review_id": 3452618086,
      "id": 2518504627,
      "node_id": "PRRC_kwDOABII586WHVSz",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));\n+        } else if constexpr (std::is_same_v<T, std::string>) {\n+            const char* text = (const char*)sqlite3_column_text(m_stmt, col);\n+            size_t size = sqlite3_column_bytes(m_stmt, col);\n+            std::string str_text(text, size);\n+            return str_text;\n+        } else if constexpr (ColumnBlob<T>) {\n+            return T(\n+                reinterpret_cast<T::element_type*>(sqlite3_column_blob(m_stmt, col)),\n+                static_cast<size_t>(sqlite3_column_bytes(m_stmt, col))\n+            );\n+        } else {\n+            static_assert(ALWAYS_FALSE<T>);\n+        }\n+    }\n+};\n \n static std::optional<int> ReadPragmaInteger(sqlite3* db, const std::string& key, const std::string& description, bilingual_str& error)\n {\n     std::string stmt_text = strprintf(\"PRAGMA %s\", key);\n-    sqlite3_stmt* pragma_read_stmt{nullptr};\n-    int ret = sqlite3_prepare_v2(db, stmt_text.c_str(), -1, &pragma_read_stmt, nullptr);\n-    if (ret != SQLITE_OK) {\n-        sqlite3_finalize(pragma_read_stmt);\n-        error = Untranslated(strprintf(\"SQLiteDatabase: Failed to prepare the statement to fetch %s: %s\", description, sqlite3_errstr(ret)));\n-        return std::nullopt;\n-    }\n-    ret = sqlite3_step(pragma_read_stmt);\n+    SQLiteStatement pragma_read_stmt(db, stmt_text);\n+    int ret = pragma_read_stmt.Step();\n     if (ret != SQLITE_ROW) {\n-        sqlite3_finalize(pragma_read_stmt);\n         error = Untranslated(strprintf(\"SQLiteDatabase: Failed to fetch %s: %s\", description, sqlite3_errstr(ret)));\n         return std::nullopt;\n     }",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 130,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Now `ReadPragmaInteger()` would return `nullopt` on some errors and `throw` on others. What about making it to only `throw`? Then its return type would change from `std::optional<int>` to `int` and its callers would not need to check `if (!read_result.has_value()) ...`.\n\nI guess also `SQLiteStatement::Step()` can `throw` if the return value of `sqlite3_step()` is not `SQLITE_ROW` or `SQLITE_DONE`.",
      "created_at": "2025-11-12T14:21:58Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518504627",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518504627"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 139,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518594590",
      "pull_request_review_id": 3452618086,
      "id": 2518594590,
      "node_id": "PRRC_kwDOABII586WHrQe",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));\n+        } else if constexpr (std::is_same_v<T, std::string>) {\n+            const char* text = (const char*)sqlite3_column_text(m_stmt, col);\n+            size_t size = sqlite3_column_bytes(m_stmt, col);\n+            std::string str_text(text, size);\n+            return str_text;",
      "path": "src/wallet/sqlite.cpp",
      "position": 104,
      "original_position": 101,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`sqlite3_column_text()` can return `nullptr`, better check that. The previous caller did check:\n\n```diff\n-        const char* msg = (const char*)sqlite3_column_text(stmt, 0);\n-        if (!msg) {                                                                                               \n-            error = ...\n```",
      "created_at": "2025-11-12T14:43:59Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518594590",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518594590"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": 119,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 126,
      "original_line": 126,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518633025",
      "pull_request_review_id": 3452618086,
      "id": 2518633025,
      "node_id": "PRRC_kwDOABII586WH0pB",
      "diff_hunk": "@@ -575,35 +580,35 @@ DatabaseCursor::Status SQLiteCursor::Next(DataStream& key, DataStream& value)\n     value.clear();\n \n     // Leftmost column in result is index 0\n-    key.write(SpanFromBlob(m_cursor_stmt, 0));\n-    value.write(SpanFromBlob(m_cursor_stmt, 1));\n+    key.write(m_cursor_stmt->Column<std::span<const std::byte>>(0));\n+    value.write(m_cursor_stmt->Column<std::span<const std::byte>>(1));\n     return Status::MORE;\n }\n \n-SQLiteCursor::~SQLiteCursor()\n+SQLiteCursor::SQLiteCursor(sqlite3* db, const std::string& stmt_text)\n {\n-    sqlite3_clear_bindings(m_cursor_stmt);\n-    sqlite3_reset(m_cursor_stmt);\n-    int res = sqlite3_finalize(m_cursor_stmt);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"%s: cursor closed but could not finalize cursor statement: %s\\n\",\n-                  __func__, sqlite3_errstr(res));\n+    m_cursor_stmt = std::make_unique<SQLiteStatement>(db, stmt_text);\n+}",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 444,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit, here and in the other constructor:\n\n```cpp\nSQLiteCursor::SQLiteCursor(sqlite3* db, const std::string& stmt_text)\n    : m_cursor_stmt(std::make_unique<SQLiteStatement>(db, stmt_text)) {}\n```",
      "created_at": "2025-11-12T14:54:05Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518633025",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518633025"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 588,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 591,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518729492",
      "pull_request_review_id": 3452618086,
      "id": 2518729492,
      "node_id": "PRRC_kwDOABII586WIMMU",
      "diff_hunk": "@@ -432,12 +452,8 @@ void SQLiteBatch::Close()\n     };\n \n     for (const auto& [stmt_prepared, stmt_description] : statements) {\n-        int res = sqlite3_finalize(*stmt_prepared);\n-        if (res != SQLITE_OK) {\n-            LogPrintf(\"SQLiteBatch: Batch closed but could not finalize %s statement: %s\\n\",\n-                      stmt_description, sqlite3_errstr(res));\n-        }\n-        *stmt_prepared = nullptr;\n+        // Reset the unique_ptr to destroy the contained SQLiteStatement\n+        stmt_prepared->reset();\n     }",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 274,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The second element in the pair (`stmt_description`) is not used. This snippet can be reduced to:\n\n```cpp\n    for (auto stmt : {&m_read_stmt, &m_insert_stmt, &m_overwrite_stmt, &m_delete_stmt, &m_delete_prefix_stmt}) {\n        stmt->reset();\n    }                   \n```\n\nOr simple stupid:\n```cpp\n    m_read_stmt.reset();\n    m_insert_stmt.reset();\n    m_overwrite_stmt.reset();\n    m_delete_stmt.reset();\n    m_delete_prefix_stmt.reset();\n```",
      "created_at": "2025-11-12T15:18:58Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518729492",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518729492"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 426,
      "start_side": "LEFT",
      "line": null,
      "original_line": 457,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518767761",
      "pull_request_review_id": 3452618086,
      "id": 2518767761,
      "node_id": "PRRC_kwDOABII586WIViR",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);",
      "path": "src/wallet/sqlite.cpp",
      "position": 59,
      "original_position": 60,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Some of the callers of `sqlite3_finalize()` used to check its return value. Here in the destructor it is too late to signal an error to the caller.\n\nFrom: https://sqlite.org/c3ref/finalize.html\n> If the most recent evaluation of statement S failed, then sqlite3_finalize(S) returns the appropriate [error code](https://sqlite.org/rescode.html) or [extended error code](https://sqlite.org/rescode.html#extrc)\n\nI am not sure what is the best way to handle this. Ignoring the return value does not look good.\n\nMaybe assert that `sqlite3_finalize()` returns `SQLITE_OK`? And also somehow make sure that if \"the most recent evaluation of statement S failed\", then this is handled already, before the destructor is called. That would mean if `sqlite3_step()`, called from `Step()` fails (result is not `SQLITE_ROW` or `SQLITE_DONE`) then to call `sqlite3_finalize()` from inside `Step()`?",
      "created_at": "2025-11-12T15:28:27Z",
      "updated_at": "2025-11-12T16:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518767761",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518767761"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 81,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2525874952",
      "pull_request_review_id": 3462922237,
      "id": 2525874952,
      "node_id": "PRRC_kwDOABII586WjcsI",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);",
      "path": "src/wallet/sqlite.cpp",
      "position": 59,
      "original_position": 60,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518767761,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe (not tested):\r\n\r\n```cpp\r\n    int Step()\r\n    {\r\n        const int ret = sqlite3_step(m_stmt);\r\n        if (ret == SQLITE_ROW || ret == SQLITE_DONE) {\r\n            return ret;\r\n        }\r\n        sqlite3_finalize(m_stmt);\r\n        m_stmt = nullptr;\r\n        // then the destructor can assert(sqlite3_finalize(m_stmt) == SQLITE_OK);\r\n    }\r\n```\r\nRelated to https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2518504627",
      "created_at": "2025-11-14T06:02:56Z",
      "updated_at": "2025-11-14T06:02:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2525874952",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2525874952"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 81,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535526914",
      "pull_request_review_id": 3474573800,
      "id": 2535526914,
      "node_id": "PRRC_kwDOABII586XIRIC",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);",
      "path": "src/wallet/sqlite.cpp",
      "position": 59,
      "original_position": 60,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518767761,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> > If the most recent evaluation of statement S failed, then sqlite3_finalize(S) returns the appropriate [error code](https://sqlite.org/rescode.html) or [extended error code](https://sqlite.org/rescode.html#extrc)\r\n> \r\n> I am not sure what is the best way to handle this. Ignoring the return value does not look good.\r\n\r\nThis text reads to me as `sqlite3_finalize` propagating any previous errors, e.g. from `sqlite3_step`. Since any errors from that should already be handled, I think it's ok to ignore the result of finalize. I think the previous code is actually incorrect since the error result is not actually a result of finalize failing.",
      "created_at": "2025-11-17T21:11:47Z",
      "updated_at": "2025-11-17T21:11:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535526914",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535526914"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 81,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535561586",
      "pull_request_review_id": 3474617927,
      "id": 2535561586,
      "node_id": "PRRC_kwDOABII586XIZly",
      "diff_hunk": "",
      "path": "src/wallet/sqlite.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2481404565,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-17T21:26:15Z",
      "updated_at": "2025-11-17T21:26:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535561586",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535561586"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535561856",
      "pull_request_review_id": 3474618240,
      "id": 2535561856,
      "node_id": "PRRC_kwDOABII586XIZqA",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 41,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2517689053,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-17T21:26:22Z",
      "updated_at": "2025-11-17T21:26:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535561856",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535561856"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535562445",
      "pull_request_review_id": 3474618985,
      "id": 2535562445,
      "node_id": "PRRC_kwDOABII586XIZzN",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518277982,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-17T21:26:41Z",
      "updated_at": "2025-11-17T21:26:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535562445",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535562445"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535562616",
      "pull_request_review_id": 3474619165,
      "id": 2535562616,
      "node_id": "PRRC_kwDOABII586XIZ14",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 51,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518281428,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-17T21:26:45Z",
      "updated_at": "2025-11-17T21:26:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535562616",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535562616"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535562832",
      "pull_request_review_id": 3474619434,
      "id": 2535562832,
      "node_id": "PRRC_kwDOABII586XIZ5Q",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }",
      "path": "src/wallet/sqlite.cpp",
      "position": 60,
      "original_position": 61,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518298601,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Removed",
      "created_at": "2025-11-17T21:26:53Z",
      "updated_at": "2025-11-17T21:26:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535562832",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535562832"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": 79,
      "original_start_line": 79,
      "start_side": "RIGHT",
      "line": 82,
      "original_line": 82,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535563023",
      "pull_request_review_id": 3474619655,
      "id": 2535563023,
      "node_id": "PRRC_kwDOABII586XIZ8P",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);",
      "path": "src/wallet/sqlite.cpp",
      "position": 94,
      "original_position": 94,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518340792,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-17T21:26:58Z",
      "updated_at": "2025-11-17T21:26:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535563023",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535563023"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": 111,
      "original_start_line": 112,
      "start_side": "RIGHT",
      "line": 116,
      "original_line": 116,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535563262",
      "pull_request_review_id": 3474619942,
      "id": 2535563262,
      "node_id": "PRRC_kwDOABII586XIZ_-",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));",
      "path": "src/wallet/sqlite.cpp",
      "position": 96,
      "original_position": 96,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518397420,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-17T21:27:04Z",
      "updated_at": "2025-11-17T21:27:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535563262",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535563262"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": 115,
      "original_start_line": 115,
      "start_side": "RIGHT",
      "line": 118,
      "original_line": 118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535564145",
      "pull_request_review_id": 3474620924,
      "id": 2535564145,
      "node_id": "PRRC_kwDOABII586XIaNx",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));\n+        } else if constexpr (std::is_same_v<T, std::string>) {\n+            const char* text = (const char*)sqlite3_column_text(m_stmt, col);\n+            size_t size = sqlite3_column_bytes(m_stmt, col);\n+            std::string str_text(text, size);\n+            return str_text;\n+        } else if constexpr (ColumnBlob<T>) {\n+            return T(\n+                reinterpret_cast<T::element_type*>(sqlite3_column_blob(m_stmt, col)),\n+                static_cast<size_t>(sqlite3_column_bytes(m_stmt, col))\n+            );\n+        } else {\n+            static_assert(ALWAYS_FALSE<T>);\n+        }\n+    }\n+};\n \n static std::optional<int> ReadPragmaInteger(sqlite3* db, const std::string& key, const std::string& description, bilingual_str& error)\n {\n     std::string stmt_text = strprintf(\"PRAGMA %s\", key);\n-    sqlite3_stmt* pragma_read_stmt{nullptr};\n-    int ret = sqlite3_prepare_v2(db, stmt_text.c_str(), -1, &pragma_read_stmt, nullptr);\n-    if (ret != SQLITE_OK) {\n-        sqlite3_finalize(pragma_read_stmt);\n-        error = Untranslated(strprintf(\"SQLiteDatabase: Failed to prepare the statement to fetch %s: %s\", description, sqlite3_errstr(ret)));\n-        return std::nullopt;\n-    }\n-    ret = sqlite3_step(pragma_read_stmt);\n+    SQLiteStatement pragma_read_stmt(db, stmt_text);",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 124,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518476250,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I've changed this to catch the exception and return `std::nullopt`.",
      "created_at": "2025-11-17T21:27:27Z",
      "updated_at": "2025-11-17T21:27:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535564145",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535564145"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 138,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535564673",
      "pull_request_review_id": 3474621525,
      "id": 2535564673,
      "node_id": "PRRC_kwDOABII586XIaWB",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));\n+        } else if constexpr (std::is_same_v<T, std::string>) {\n+            const char* text = (const char*)sqlite3_column_text(m_stmt, col);\n+            size_t size = sqlite3_column_bytes(m_stmt, col);\n+            std::string str_text(text, size);\n+            return str_text;\n+        } else if constexpr (ColumnBlob<T>) {\n+            return T(\n+                reinterpret_cast<T::element_type*>(sqlite3_column_blob(m_stmt, col)),\n+                static_cast<size_t>(sqlite3_column_bytes(m_stmt, col))\n+            );\n+        } else {\n+            static_assert(ALWAYS_FALSE<T>);\n+        }\n+    }\n+};\n \n static std::optional<int> ReadPragmaInteger(sqlite3* db, const std::string& key, const std::string& description, bilingual_str& error)\n {\n     std::string stmt_text = strprintf(\"PRAGMA %s\", key);\n-    sqlite3_stmt* pragma_read_stmt{nullptr};\n-    int ret = sqlite3_prepare_v2(db, stmt_text.c_str(), -1, &pragma_read_stmt, nullptr);\n-    if (ret != SQLITE_OK) {\n-        sqlite3_finalize(pragma_read_stmt);\n-        error = Untranslated(strprintf(\"SQLiteDatabase: Failed to prepare the statement to fetch %s: %s\", description, sqlite3_errstr(ret)));\n-        return std::nullopt;\n-    }\n-    ret = sqlite3_step(pragma_read_stmt);\n+    SQLiteStatement pragma_read_stmt(db, stmt_text);\n+    int ret = pragma_read_stmt.Step();\n     if (ret != SQLITE_ROW) {\n-        sqlite3_finalize(pragma_read_stmt);\n         error = Untranslated(strprintf(\"SQLiteDatabase: Failed to fetch %s: %s\", description, sqlite3_errstr(ret)));\n         return std::nullopt;\n     }",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 130,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518504627,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Changed to catch the exception.",
      "created_at": "2025-11-17T21:27:42Z",
      "updated_at": "2025-11-17T21:27:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535564673",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535564673"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 139,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535566375",
      "pull_request_review_id": 3474623588,
      "id": 2535566375,
      "node_id": "PRRC_kwDOABII586XIawn",
      "diff_hunk": "@@ -58,44 +52,96 @@ static int TraceSqlCallback(unsigned code, void* context, void* param1, void* pa\n     return SQLITE_OK;\n }\n \n-static bool BindBlobToStatement(sqlite3_stmt* stmt,\n-                                int index,\n-                                std::span<const std::byte> blob,\n-                                const std::string& description)\n+template <typename T>\n+concept ColumnBlob = requires(T a, T::element_type* data, size_t size)\n {\n-    // Pass a pointer to the empty string \"\" below instead of passing the\n-    // blob.data() pointer if the blob.data() pointer is null. Passing a null\n-    // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n-    // instead of the empty blob value X'', which would mess up SQL comparisons.\n-    int res = sqlite3_bind_blob(stmt, index, blob.data() ? static_cast<const void*>(blob.data()) : \"\", blob.size(), SQLITE_STATIC);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n-        sqlite3_clear_bindings(stmt);\n-        sqlite3_reset(stmt);\n-        return false;\n+    T(data, size);\n+};\n+\n+/** RAII class that encapsulates a sqlite3_stmt */\n+class SQLiteStatement\n+{\n+private:\n+    sqlite3* m_db{nullptr};\n+    sqlite3_stmt* m_stmt{nullptr};\n+\n+public:\n+    explicit SQLiteStatement(sqlite3* db, const std::string& stmt_text)\n+        : m_db(db)\n+    {\n+        int res = sqlite3_prepare_v2(m_db, stmt_text.c_str(), -1, &m_stmt, nullptr);\n+        if (res != SQLITE_OK) {\n+            throw std::runtime_error(strprintf(\n+                \"SQLiteDatabase: Failed to prepare SQL statement: %s\\n\", sqlite3_errstr(res)));\n+        }\n     }\n \n-    return true;\n-}\n+    ~SQLiteStatement()\n+    {\n+        Reset();\n+        sqlite3_finalize(m_stmt);\n+    }\n+\n+    int Step()\n+    {\n+        return sqlite3_step(m_stmt);\n+    }\n+\n+    void Reset()\n+    {\n+        sqlite3_clear_bindings(m_stmt);\n+        sqlite3_reset(m_stmt);\n+    }\n+\n+    bool Bind(int index, std::span<const std::byte> data, const std::string& description)\n+    {\n+        // Pass a pointer to the empty string \"\" below instead of passing the\n+        // blob.data() pointer if the blob.data() pointer is null. Passing a null\n+        // data pointer to bind_blob would cause sqlite to bind the SQL NULL value\n+        // instead of the empty blob value X'', which would mess up SQL comparisons.\n+        int res = sqlite3_bind_blob(m_stmt, index, data.data() ? static_cast<const void*>(data.data()) : \"\", data.size(), SQLITE_STATIC);\n+        if (res != SQLITE_OK) {\n+            LogPrintf(\"Unable to bind %s to statement: %s\\n\", description, sqlite3_errstr(res));\n+            Reset();\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    template<typename T>\n+    T Column(int col)\n+    {\n+        if constexpr (std::integral<T> && sizeof(T) <= 4) {\n+            return sqlite3_column_int(m_stmt, col);\n+        } else if constexpr (std::integral<T> && sizeof(T) <= 8) {\n+            return static_cast<int64_t>(sqlite3_column_int64(m_stmt, col));\n+        } else if constexpr (std::is_same_v<T, std::string>) {\n+            const char* text = (const char*)sqlite3_column_text(m_stmt, col);\n+            size_t size = sqlite3_column_bytes(m_stmt, col);\n+            std::string str_text(text, size);\n+            return str_text;",
      "path": "src/wallet/sqlite.cpp",
      "position": 104,
      "original_position": 101,
      "commit_id": "0af7c2a11819a21e11abf34b4229c5c21150d827",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518594590,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done, returns an empty string now.\r\n\r\nBut the only time `sqlite3_column_text` should return NULL is if the column contains a NULL value. Empty strings are not stored as NULL.",
      "created_at": "2025-11-17T21:28:25Z",
      "updated_at": "2025-11-17T21:28:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535566375",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535566375"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": 119,
      "original_start_line": 119,
      "start_side": "RIGHT",
      "line": 126,
      "original_line": 126,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535566840",
      "pull_request_review_id": 3474624127,
      "id": 2535566840,
      "node_id": "PRRC_kwDOABII586XIa34",
      "diff_hunk": "@@ -575,35 +580,35 @@ DatabaseCursor::Status SQLiteCursor::Next(DataStream& key, DataStream& value)\n     value.clear();\n \n     // Leftmost column in result is index 0\n-    key.write(SpanFromBlob(m_cursor_stmt, 0));\n-    value.write(SpanFromBlob(m_cursor_stmt, 1));\n+    key.write(m_cursor_stmt->Column<std::span<const std::byte>>(0));\n+    value.write(m_cursor_stmt->Column<std::span<const std::byte>>(1));\n     return Status::MORE;\n }\n \n-SQLiteCursor::~SQLiteCursor()\n+SQLiteCursor::SQLiteCursor(sqlite3* db, const std::string& stmt_text)\n {\n-    sqlite3_clear_bindings(m_cursor_stmt);\n-    sqlite3_reset(m_cursor_stmt);\n-    int res = sqlite3_finalize(m_cursor_stmt);\n-    if (res != SQLITE_OK) {\n-        LogPrintf(\"%s: cursor closed but could not finalize cursor statement: %s\\n\",\n-                  __func__, sqlite3_errstr(res));\n+    m_cursor_stmt = std::make_unique<SQLiteStatement>(db, stmt_text);\n+}",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 444,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518633025,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-17T21:28:37Z",
      "updated_at": "2025-11-17T21:28:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535566840",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535566840"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 588,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 591,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535567070",
      "pull_request_review_id": 3474624374,
      "id": 2535567070,
      "node_id": "PRRC_kwDOABII586XIa7e",
      "diff_hunk": "@@ -432,12 +452,8 @@ void SQLiteBatch::Close()\n     };\n \n     for (const auto& [stmt_prepared, stmt_description] : statements) {\n-        int res = sqlite3_finalize(*stmt_prepared);\n-        if (res != SQLITE_OK) {\n-            LogPrintf(\"SQLiteBatch: Batch closed but could not finalize %s statement: %s\\n\",\n-                      stmt_description, sqlite3_errstr(res));\n-        }\n-        *stmt_prepared = nullptr;\n+        // Reset the unique_ptr to destroy the contained SQLiteStatement\n+        stmt_prepared->reset();\n     }",
      "path": "src/wallet/sqlite.cpp",
      "position": 1,
      "original_position": 274,
      "commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "original_commit_id": "1829b3512d7bf430ec44daa801eb8fadf46cd30b",
      "in_reply_to_id": 2518729492,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-17T21:28:43Z",
      "updated_at": "2025-11-17T21:28:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33033#discussion_r2535567070",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2535567070"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33033"
        }
      },
      "start_line": null,
      "original_start_line": 426,
      "start_side": "LEFT",
      "line": null,
      "original_line": 457,
      "side": "RIGHT"
    }
  ]
}