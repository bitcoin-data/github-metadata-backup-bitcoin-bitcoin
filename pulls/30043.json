{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043",
    "id": 1855120573,
    "node_id": "PR_kwDOABII585ukuS9",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/30043",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/30043.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/30043.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/86ca549b6820aa9c744442e793cc6da8b9c7e602",
    "number": 30043,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "net: Replace libnatpmp with built-in PCP implementation",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Continues #30005. Closes #17012..\r\n\r\nThis PR replaces NAT-PMP port mapping with its successor PCP (Port Control Protocol) from [RFC6887](https://datatracker.ietf.org/doc/html/rfc6887).  This adds, in addition to the existing IPv4 port mapping, support for IPv6 pinholing-that is, opening a port on the firewall to make it reachable.\r\n\r\nPCP is a simple UDP-based protocol, and the implementation is self-contained, so this gets rid of lthe libnatpnp dependency without adding a new one. It should otherwise be a drop-in replacement, and as PCP (effectively NATPMP v2) was standardized in 2013, router support shouldn't be any different. \r\n\r\nFor now `-pcp`, like `-natpmp`, is disabled by default, though in the future (not in this PR) we could consider enable it by default to increase the number of connectable nodes without adding significant attack surface.\r\n\r\nTo test:\r\n```bash\r\nbitcoind -regtest -pcp=1 -debug=net\r\n```\r\nThe option `-natpmp` is still accepted as an alias for `-pcp` (but gives a warning).\r\n\r\n(most of the changes in this PR are, ironically, removing the libnatpmp dependency and associated build system and build docs)\r\n\r\n## TODO\r\n\r\n- [x] Default gateway discovery on Linux / FreeBSD\r\n- [x] Default gateway discovery on Windows\r\n- [ ] Default gateway discovery on MacOS\r\n- [ ] (maye) split src/util/netif.h off into a separate PR https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2047432934\r\n- [ ] GUI setting migration https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2047432934",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      },
      {
        "id": 493267104,
        "node_id": "MDU6TGFiZWw0OTMyNjcxMDQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20release%20note",
        "name": "Needs release note",
        "description": "",
        "color": "d2db6d",
        "default": false
      },
      {
        "id": 6861582155,
        "node_id": "LA_kwDOABII588AAAABmPtvSw",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20CMake%20port",
        "name": "Needs CMake port",
        "description": "",
        "color": "0e8a16",
        "default": false
      }
    ],
    "created_at": "2024-05-05T18:35:03Z",
    "updated_at": "2024-05-17T19:42:50Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "62fc04b9826930a15f977d1f87f69d27379bb620",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "laanwj:2024-05-pcp",
      "ref": "2024-05-pcp",
      "sha": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 1750308,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNzUwMzA4",
        "name": "bitcoin",
        "full_name": "laanwj/bitcoin",
        "owner": {
          "login": "laanwj",
          "id": 126646,
          "node_id": "MDQ6VXNlcjEyNjY0Ng==",
          "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/laanwj",
          "html_url": "https://github.com/laanwj",
          "followers_url": "https://api.github.com/users/laanwj/followers",
          "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
          "organizations_url": "https://api.github.com/users/laanwj/orgs",
          "repos_url": "https://api.github.com/users/laanwj/repos",
          "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/laanwj/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/laanwj/bitcoin",
        "description": "Laanwj's Bitcoin Core fork - see README.md on \"readme\" branch",
        "fork": true,
        "url": "https://api.github.com/repos/laanwj/bitcoin",
        "archive_url": "https://api.github.com/repos/laanwj/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/laanwj/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/laanwj/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/laanwj/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/laanwj/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/laanwj/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/laanwj/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/laanwj/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/laanwj/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/laanwj/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/laanwj/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/laanwj/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/laanwj/bitcoin/events",
        "forks_url": "https://api.github.com/repos/laanwj/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/laanwj/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/laanwj/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/laanwj/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/laanwj/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/laanwj/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/laanwj/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/laanwj/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/laanwj/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/laanwj/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/laanwj/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/laanwj/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/laanwj/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/laanwj/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/laanwj/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/laanwj/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:laanwj/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/laanwj/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/laanwj/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/laanwj/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/laanwj/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/laanwj/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/laanwj/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/laanwj/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/laanwj/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/laanwj/bitcoin/hooks",
        "svn_url": "https://github.com/laanwj/bitcoin",
        "homepage": "",
        "forks_count": 14,
        "stargazers_count": 43,
        "watchers_count": 43,
        "size": 231293,
        "default_branch": "readme",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-05-17T16:18:18Z",
        "created_at": "2011-05-15T07:09:54Z",
        "updated_at": "2023-10-20T10:27:51Z"
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "2f53f2273da020d7fabd7c65a1bc7e69a31249b2",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35411,
        "stargazers_count": 76420,
        "watchers_count": 76420,
        "size": 258597,
        "default_branch": "master",
        "open_issues_count": 680,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-05-17T19:51:07Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-05-17T19:51:12Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 680,
    "deletions": 321,
    "changed_files": 43,
    "commits": 19,
    "review_comments": 15,
    "comments": 20
  },
  "events": [
    {
      "event": "labeled",
      "id": 12708075166,
      "node_id": "LE_lADOABII586H4P0UzwAAAAL1ddae",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12708075166",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T18:35:03Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "labeled",
      "id": 12708075167,
      "node_id": "LE_lADOABII586H4P0UzwAAAAL1ddaf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12708075167",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T18:35:03Z",
      "label": {
        "name": "Needs CMake port",
        "color": "0e8a16"
      }
    },
    {
      "event": "commented",
      "id": 2094906184,
      "node_id": "IC_kwDOABII58583btI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2094906184",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T18:35:05Z",
      "updated_at": "2024-05-16T15:48:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30043).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2095761769), [theuni](https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2096485412), [vasild](https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2061123015) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#30060](https://github.com/bitcoin/bitcoin/pull/30060) (ci: Roll clang in test-each-commit task by maflcko)\n* [#29852](https://github.com/bitcoin/bitcoin/pull/29852) ([WIP] build: remove need to test for endianness by fanquake)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2094906184",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T18:35:43Z",
      "updated_at": "2024-05-05T18:35:43Z",
      "source": {
        "issue": {
          "id": 2271221092,
          "node_id": "PR_kwDOABII585uIYi3",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30005",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30005/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30005/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30005/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/30005",
          "number": 30005,
          "state": "closed",
          "state_reason": null,
          "title": "[PoC, nomerge] PCP IPv4 portmap+IPv6 pinhole test",
          "body": "The overarching goal here is to increase the number of connectable nodes that are not in the big datacenters.\r\n\r\n**Context:** IPv6 doesn't have NAT. Computers behind a router tend to get a globally routable address. However, by default this address is usually completely firewalled for incoming connections, as a security measure. See issue #17012.\r\n\r\nThis is where \"pinholing\" comes in. By sending a request, a machine on the network can request a port to be opened. This is similar to requesting a port forward for IPv4 but simpler.\r\n\r\nThis PR implements the so-called PCP (Port Control Protocol) from [RFC6887](https://datatracker.ietf.org/doc/html/rfc6887). This is a simple UDP based protocol with fixed-size packets, so is safe to possibly even enable by default. Much simpler than UPnP which also has commands to open a pinhole, but relies on SSDP, HTTP, and XML parsing (and miniupnpc has had serious RCEs in the past). This implementation is self-contained, no external dependency is added.\r\n\r\nBefore integrating it into Bitcoin Core i would first like to investigate whether this implementation is correct and whether routers support it.  So this adds a binary, `ipv6-pinhole-test`, which:\r\n\r\n- Enumerates local publicly routable IPv6 addresses\r\n- Gets the default gateway to get the PCP endpoint\r\n- Requests pinholes for 100 seconds to port 1234 on all addreses, and prints the result.\r\n\r\ni've tested this on two routers myself--Turris Omnia and Fritz!Box, where it worked. Please help testing, by just running it behind the router of your choice!\r\n\r\nFor now, this is for Linux only. Implementing it for other platforms requires implementing a way to get the default route. i'll get to this later.\r\n\r\nBe careful with publicly posting the full output of this program-it will contain your IP address information.\r\n\r\n[skip ci]",
          "user": {
            "login": "laanwj",
            "id": 126646,
            "node_id": "MDQ6VXNlcjEyNjY0Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/laanwj",
            "html_url": "https://github.com/laanwj",
            "followers_url": "https://api.github.com/users/laanwj/followers",
            "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
            "organizations_url": "https://api.github.com/users/laanwj/orgs",
            "repos_url": "https://api.github.com/users/laanwj/repos",
            "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/laanwj/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 234878,
              "node_id": "MDU6TGFiZWwyMzQ4Nzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Linux/Unix",
              "name": "Linux/Unix",
              "color": "770000",
              "default": false
            },
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 19,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30005",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/30005",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/30005.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/30005.patch"
          },
          "closed_at": "2024-05-05T18:35:43Z",
          "created_at": "2024-04-30T11:35:27Z",
          "updated_at": "2024-05-05T18:35:43Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12708109392,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL1dlxQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12708109392",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T18:49:06Z"
    },
    {
      "event": "labeled",
      "id": 12708109531,
      "node_id": "LE_lADOABII586H4P0UzwAAAAL1dlzb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12708109531",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T18:49:11Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2094910598,
      "node_id": "IC_kwDOABII58583cyG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2094910598",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T18:49:12Z",
      "updated_at": "2024-05-05T18:49:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\nðŸš§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/24606743714</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2094910598",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12708115600,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL1dnSQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12708115600",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T18:53:00Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12708148684,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL1dvXM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12708148684",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T19:11:58Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12708290177,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL1eR6B",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12708290177",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T20:28:00Z"
    },
    {
      "event": "labeled",
      "id": 12708353739,
      "node_id": "LE_lADOABII586H4P0UzwAAAAL1ehbL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12708353739",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-05T20:45:32Z",
      "label": {
        "name": "Needs release note",
        "color": "d2db6d"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T01:11:11Z",
      "updated_at": "2024-05-06T01:11:11Z",
      "source": {
        "issue": {
          "id": 2267457457,
          "node_id": "PR_kwDOABII585t7f1G",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29984",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29984/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29984/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29984/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29984",
          "number": 29984,
          "state": "closed",
          "state_reason": null,
          "title": "net: Replace ifname check with IFF_LOOPBACK in Discover",
          "body": "Checking the interface name is kind of brittle. In the age of network namespaces and containers, there is no reason a loopback interface can't be called differently.\r\n\r\nCheck for the `IFF_LOOPBACK` flag to detect loopback interface instead.\r\n\r\nAlso remove a misleading comment in Discover's doc comment.",
          "user": {
            "login": "laanwj",
            "id": 126646,
            "node_id": "MDQ6VXNlcjEyNjY0Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/laanwj",
            "html_url": "https://github.com/laanwj",
            "followers_url": "https://api.github.com/users/laanwj/followers",
            "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
            "organizations_url": "https://api.github.com/users/laanwj/orgs",
            "repos_url": "https://api.github.com/users/laanwj/repos",
            "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/laanwj/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29984",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29984",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29984.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29984.patch"
          },
          "closed_at": "2024-05-07T02:29:08Z",
          "created_at": "2024-04-28T09:39:31Z",
          "updated_at": "2024-05-08T08:14:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T02:08:33Z",
      "updated_at": "2024-05-06T02:08:33Z",
      "source": {
        "issue": {
          "id": 2237756115,
          "node_id": "PR_kwDOABII585sXLG9",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29852",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29852/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29852/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29852/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29852",
          "number": 29852,
          "state": "open",
          "state_reason": null,
          "title": "[WIP] build: remove need to test for endianness",
          "body": "We can cherry-pick one commit from upstream leveldb, make the same change in crc32c, and then ultimately drop our build infra for testing endianness.\r\n\r\nNot for merging until subtrees are updated etc. Would also mean less code that we need to port to CMake.",
          "user": {
            "login": "fanquake",
            "id": 863730,
            "node_id": "MDQ6VXNlcjg2MzczMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fanquake",
            "html_url": "https://github.com/fanquake",
            "followers_url": "https://api.github.com/users/fanquake/followers",
            "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
            "organizations_url": "https://api.github.com/users/fanquake/orgs",
            "repos_url": "https://api.github.com/users/fanquake/repos",
            "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fanquake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 17,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29852",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29852",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29852.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29852.patch"
          },
          "created_at": "2024-04-11T13:40:34Z",
          "updated_at": "2024-05-06T02:08:33Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T03:11:44Z",
      "updated_at": "2024-05-06T03:11:44Z",
      "source": {
        "issue": {
          "id": 2182604130,
          "node_id": "PR_kwDOABII585pbmSj",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29641",
          "number": 29641,
          "state": "open",
          "state_reason": null,
          "title": "scripted-diff: Use LogInfo/LogDebug over LogPrintf/LogPrint",
          "body": "`LogPrintf/LogPrint` are problematic, because:\r\n\r\n* Their name is non-descriptive of what the function does (info logging or debug logging).\r\n* They are deprecated aliases, where code is using either the deprecated or non-deprecated alias, which is inconsistent and confusing.\r\n\r\nFix all issues by replacing the usage.\r\n\r\nWhile the diff is large and may cause merge conflicts or backport conflicts, I don't see the deprecated aliases being kept forever, so this will have to be done at some point. All conflicts should be trivial to solve, in any case.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29641",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29641",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29641.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29641.patch"
          },
          "created_at": "2024-03-12T20:21:40Z",
          "updated_at": "2024-05-13T09:22:02Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 2095761769,
      "node_id": "IC_kwDOABII58586slp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2095761769",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T11:08:46Z",
      "updated_at": "2024-05-06T11:08:46Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2095761769",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12714178084,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL10vYk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12714178084",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T12:14:40Z"
    },
    {
      "event": "commented",
      "id": 2096485412,
      "node_id": "IC_kwDOABII58589dQk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2096485412",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T16:49:54Z",
      "updated_at": "2024-05-06T17:25:26Z",
      "author_association": "MEMBER",
      "body": "Whoa :)\r\n\r\n(Concept ACK)",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2096485412",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "reviewed",
      "id": 2040718091,
      "node_id": "PRR_kwDOABII5855ouML",
      "url": null,
      "actor": null,
      "commit_id": "e7cc02b996fc9f6ae587bcffe1605d9a20c2cc73",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "RFC6887 appendix A describes how a router that supports NAP-PMP but not PCP, will return `UNSUPP_VERSION`. A log message could encourage users to try `-upnp` instead (if not already enabled). Or upgrade their ancient router firmware :-)\r\n\r\nGot distracted during review, will continue later. I'll look into how we can preserve a previously selected NatPMP checkbox in the GUI.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2040718091",
      "submitted_at": "2024-05-06T16:51:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
    },
    {
      "event": "commented",
      "id": 2096670310,
      "node_id": "IC_kwDOABII5858-KZm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2096670310",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T18:37:14Z",
      "updated_at": "2024-05-06T18:37:14Z",
      "author_association": "MEMBER",
      "body": "Regarding the custom lib/self-impl discussion in #30005: \r\nTaking a quick look at the implementation here, I think it's simple enough for us to maintain ourselves. If a nice canonical lib ever emerges we could always jump to it, as there are only a few basic functions and presumably we could probably switch them out close to 1:1.\r\n\r\nThat said, it is a little rough to review as\r\n- It needs to be compared to the letter of the spec, with the assumption that @laanwj is evil or has mis-implemented (I doubt that :)\r\n- It needs to be very defensive, though the attack surface seems quite minimal\r\n- It needs to be aware of real-world violators/benders/extenders of the spec (if any? I have no idea.)\r\n\r\nBut it seems worth the effort to me.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2096670310",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "mentioned",
      "id": 12718907040,
      "node_id": "MEE_lADOABII586H4P0UzwAAAAL2Gx6g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12718907040",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T18:37:15Z"
    },
    {
      "event": "subscribed",
      "id": 12718907071,
      "node_id": "SE_lADOABII586H4P0UzwAAAAL2Gx6_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12718907071",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-06T18:37:15Z"
    },
    {
      "event": "labeled",
      "id": 12723051091,
      "node_id": "LE_lADOABII586H4P0UzwAAAAL2WlpT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12723051091",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T04:16:58Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12725837606,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL2hN8m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12725837606",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T08:57:08Z"
    },
    {
      "event": "commented",
      "id": 2097797401,
      "node_id": "IC_kwDOABII5859CdkZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2097797401",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T08:59:20Z",
      "updated_at": "2024-05-07T08:59:20Z",
      "author_association": "MEMBER",
      "body": "Rebased for #29984",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2097797401",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "commented",
      "id": 2097968387,
      "node_id": "IC_kwDOABII5859DHUD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2097968387",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T10:18:35Z",
      "updated_at": "2024-05-07T10:28:09Z",
      "author_association": "MEMBER",
      "body": "> That said, it is a little rough to review as\r\n>  It needs to be compared to the letter of the spec, with the assumption that @laanwj is evil or has mis-implemented (I doubt that :)\r\n\r\nIf you're more comfortable comparing it against another implementation there's:\r\n- A kinda haphazard windows implementation here: https://github.com/moonlight-stream/GS-IPv6-Forwarder/blob/master/GSv6Fwd/pcp.cpp\r\n- Miniupnpd's pcp server implementation https://github.com/miniupnp/miniupnp/blob/master/miniupnpd/pcpserver.c\r\n\r\n> It needs to be aware of real-world violators/benders/extenders of the spec (if any? I have no idea.)\r\n\r\nMiniupnpd's is, likely, the most common server implementation in the wild. It's been tested against that. i'm hoping people will test this on various routers and conditions, there will be inevitable edge cases to iron out.\r\n\r\n> If a nice canonical lib ever emerges we could always jump to it\r\n\r\nMaybe, but at some point there's not much difference between implementing a simple request/reply protocol and using a library. At least the RFC is unambigiously documented, which can't be said of many FOSS ABI's. Also, @fanquake (and @gmaxwell in the past) has been hoping for a solution that doesn't introduce a library dependency.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2097968387",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "mentioned",
      "id": 12726955693,
      "node_id": "MEE_lADOABII586H4P0UzwAAAAL2le6t",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12726955693",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T10:18:37Z"
    },
    {
      "event": "subscribed",
      "id": 12726955727,
      "node_id": "SE_lADOABII586H4P0UzwAAAAL2le7P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12726955727",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T10:18:37Z"
    },
    {
      "event": "mentioned",
      "id": 12726955770,
      "node_id": "MEE_lADOABII586H4P0UzwAAAAL2le76",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12726955770",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T10:18:37Z"
    },
    {
      "event": "subscribed",
      "id": 12726955813,
      "node_id": "SE_lADOABII586H4P0UzwAAAAL2le8l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12726955813",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T10:18:37Z"
    },
    {
      "event": "mentioned",
      "id": 12727112562,
      "node_id": "MEE_lADOABII586H4P0UzwAAAAL2mFNy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12727112562",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T10:26:22Z"
    },
    {
      "event": "subscribed",
      "id": 12727112583,
      "node_id": "SE_lADOABII586H4P0UzwAAAAL2mFOH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12727112583",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T10:26:22Z"
    },
    {
      "event": "unlabeled",
      "id": 12727171507,
      "node_id": "UNLE_lADOABII586H4P0UzwAAAAL2mTmz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12727171507",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-07T10:30:00Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2043665469,
      "node_id": "PRR_kwDOABII5855z9w9",
      "url": null,
      "actor": null,
      "commit_id": "fe53862fd4dca2ce7d3208847ed9e917c30ccb27",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "davidgumberg",
        "id": 2257631,
        "node_id": "MDQ6VXNlcjIyNTc2MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2257631?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidgumberg",
        "html_url": "https://github.com/davidgumberg",
        "followers_url": "https://api.github.com/users/davidgumberg/followers",
        "following_url": "https://api.github.com/users/davidgumberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/davidgumberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/davidgumberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/davidgumberg/subscriptions",
        "organizations_url": "https://api.github.com/users/davidgumberg/orgs",
        "repos_url": "https://api.github.com/users/davidgumberg/repos",
        "events_url": "https://api.github.com/users/davidgumberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/davidgumberg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2043665469",
      "submitted_at": "2024-05-07T16:25:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
    },
    {
      "event": "commented",
      "id": 2100841942,
      "node_id": "IC_kwDOABII5859OE3W",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2100841942",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-08T15:26:35Z",
      "updated_at": "2024-05-08T15:26:35Z",
      "author_association": "MEMBER",
      "body": "Would prefer this in two steps (add PCP, then remove NAT-PMP)",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2100841942",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-08T16:00:32Z",
      "updated_at": "2024-05-08T16:00:32Z",
      "source": {
        "issue": {
          "id": 2285114805,
          "node_id": "PR_kwDOABII585u2ui5",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30060",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30060/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30060/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30060/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/30060",
          "number": 30060,
          "state": "closed",
          "state_reason": null,
          "title": "ci: Roll clang in test-each-commit task",
          "body": "Needed for https://github.com/bitcoin/bitcoin/pull/29077#issuecomment-2099704210",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30060",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/30060",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/30060.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/30060.patch"
          },
          "closed_at": "2024-05-15T08:31:36Z",
          "created_at": "2024-05-08T09:19:18Z",
          "updated_at": "2024-05-15T08:37:47Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 2102107669,
      "node_id": "IC_kwDOABII5859S54V",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2102107669",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-09T07:25:43Z",
      "updated_at": "2024-05-09T07:25:43Z",
      "author_association": "MEMBER",
      "body": "> Would prefer this in two steps (add PCP, then remove NAT-PMP)\r\n\r\ni'm not planning to do this, the build system commits are already set up this way, but doing it throughout would involve adding another setting in Qt just to remove it later. Same for adding a third mechanism in `portmap.cpp`. Agree with @sjors that having a forest of different port mapping settings is confusing to the user.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2102107669",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "mentioned",
      "id": 12753405161,
      "node_id": "MEE_lADOABII586H4P0UzwAAAAL4KYTp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12753405161",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-09T07:25:45Z"
    },
    {
      "event": "subscribed",
      "id": 12753405171,
      "node_id": "SE_lADOABII586H4P0UzwAAAAL4KYTz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12753405171",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-09T07:25:45Z"
    },
    {
      "event": "reviewed",
      "id": 2047432934,
      "node_id": "PRR_kwDOABII5856CVjm",
      "url": null,
      "actor": null,
      "commit_id": "b06edec229d5cfc8d0d1a19bd723852e6bcfd9d9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Tested on Ubuntu 24.04 I'm getting in bound via IPv4 and IPv6.\r\n\r\nWhen a GUI user previously had NAT-PMP selected there would be a `\"natpmp\": true` field in `settings.json`.\r\n\r\nWe need to rename this to `\"tcp\"` in order for the box to remain checked.\r\n\r\nMaybe @ryanofsky has an idea how to do this elegantly?\r\n\r\nA little hack that works is to put the following at the end of `ReadSettings()` in `settings.cpp`: \r\n\r\n```cpp\r\n    // Migrate settings:\r\n    if (values.contains(\"natpmp\")) {\r\n        auto el = values.extract(\"natpmp\");\r\n        el.key() = \"pcp\";\r\n        values.insert(std::move(el));\r\n    }\r\n```\r\n\r\nA bit nicer would be to have a `MigrateSettingsFile()` that's called between `ReadSettingsFile` and `WriteSettingsFile` in `init.cpp`.\r\n\r\n(not to be confused with `OptionsModel::checkAndMigrate()` which is called _before_ settings.json is read)\r\n\r\n---\r\n\r\nMaybe you can split `src/util/netif.h` off into a separate PR, along with b06edec229d5cfc8d0d1a19bd723852e6bcfd9d9.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2047432934",
      "submitted_at": "2024-05-09T09:56:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
    },
    {
      "event": "commented",
      "id": 2102707649,
      "node_id": "IC_kwDOABII5859VMXB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2102707649",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-09T13:53:04Z",
      "updated_at": "2024-05-09T13:53:04Z",
      "author_association": "MEMBER",
      "body": "In terms of which IPv6 address to use, my understanding is this:\r\n\r\n1. In the olden days the IPv6 address contained part of the MAC address. This ensured uniqueness, but was bad for mobile device privacy; no matter where you went, part of your IP address was constant. Such addresses always (?) contain `0xfffe`. See https://datatracker.ietf.org/doc/html/rfc7707\r\n2. A new standard was introduced that uses a hash of both the MAC address and the prefix, ensuring it's stable if you stay on the same network, but changes when you move. See https://datatracker.ietf.org/doc/html/rfc7217#page-19\r\n3. There's also temporary addresses, which are rotated every couple of hours. See https://datatracker.ietf.org/doc/html/rfc8981\r\n\r\nIf we were able to tell which one one is which, then I think we should pick only one, in order of preference: (2), (3), (1). This reflects our desire to actually get inbound connections, even after a shutdown, while at the same time not doxxing ourselves when on the move (mainly for laptops, perhaps mobile in the future).\r\n\r\nWe can easily detect type (1) by looking for `0xfffe` at the right position (and then least prefer it).\r\n\r\nI believe you can detect (2) by looking for `IFA_F_STABLE_PRIVACY` in `flags` of the `inet6_ifaddr` struct. It seems `getifaddrs` doesn't have access to that. Neither does `/proc/net/if_inet6` since https://patchwork.ozlabs.org/project/netdev/patch/1386680189-7852-1-git-send-email-jiri@resnulli.us/\r\n\r\nAfaik there's also no guarantee about the order of results.\r\n\r\nSo maybe we should just pick one at random rather than announce all three. This also seems orthogonal to PCP.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2102707649",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "reviewed",
      "id": 2048184349,
      "node_id": "PRR_kwDOABII5856FNAd",
      "url": null,
      "actor": null,
      "commit_id": "b06edec229d5cfc8d0d1a19bd723852e6bcfd9d9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Regarding gateway discovery on macOS and Windows, the NatPMP C code is probably as good a place to start as any: https://github.com/miniupnp/libnatpmp/blob/master/getgateway.c\r\n\r\nI tested that `-natpmp` works (before this PR) on macOS 14.4.1.\r\n\r\nYou already implemented the `USE_PROC_NET_ROUTE` approach, which unfortunately is the shortest of them.\r\n\r\nHere's another one: https://github.com/libpcp/pcp/blob/master/libpcp/src/net/gateway.c\r\n\r\nLife would be so much easier if RFC6887 had allowed you to send the request to some random destination on the internet and just have the router intercept it (with Hop Limit 1 for privacy).\r\n\r\nOne creative cross-platform way to find the default gateway is, like `traceroute`, to send an ICMP(v6) message towards a random IPv4/6 address (via TCP), with Hop Limit set to 1, wait for the `Destination Unreachable Message` response and get the origin IP. https://datatracker.ietf.org/doc/html/rfc792\r\n\r\nIf PCP servers announced themselves via DNS-Based Service Discovery [rfc6763](https://www.rfc-editor.org/rfc/rfc6763.html) that would also make things easier. But waiting for an amendment of / followup to rfc792 and all routers to implement it ... would take a while. And then you need support _that_ protocol (mostly fetching and parsing DNS TXT records).",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2048184349",
      "submitted_at": "2024-05-09T15:45:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
    },
    {
      "event": "labeled",
      "id": 12814729426,
      "node_id": "LE_lADOABII586H4P0UzwAAAAL70UDS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12814729426",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-15T10:05:44Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2112341321,
      "node_id": "IC_kwDOABII585958VJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2112341321",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-15T12:00:38Z",
      "updated_at": "2024-05-15T12:02:13Z",
      "author_association": "MEMBER",
      "body": "Thanks!\r\n\r\nOn Windows (Vista and higher, which is all we care about) getting the default gateway is straightforward, there's `GetBestRoute2` that does all the work. It's part of netioapi which we already need for interface enumeration. MacOS's sysctl is a bit uglier.\r\n\r\n> If PCP servers announced themselves via DNS-Based Service Discovery [rfc6763](https://www.rfc-editor.org/rfc/rfc6763.html) that would also make things easier.\r\n\r\ni don't think it really would, we'd need some special library for DNS access, getting TXT records isn't built into libc.\r\n\r\n> One creative cross-platform way to find the default gateway is, like traceroute, to send an ICMP(v6) message towards a random IPv4/6 address (via TCP), with Hop Limit set to 1, wait for the Destination Unreachable Message response and get the origin IP. \r\n\r\nIt's a clever idea, but sending/receiving ICMP needs raw socket privileges on many operating systems.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2112341321",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "commented",
      "id": 2114203144,
      "node_id": "IC_kwDOABII585-BC4I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2114203144",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T06:56:01Z",
      "updated_at": "2024-05-16T06:56:01Z",
      "author_association": "MEMBER",
      "body": "> Maybe you can split src/util/netif.h off into a separate PR, along with https://github.com/bitcoin/bitcoin/commit/b06edec229d5cfc8d0d1a19bd723852e6bcfd9d9.\r\n\r\nSure, could do that.\r\n\r\n> So maybe we should just pick one at random rather than announce all three. This also seems orthogonal to PCP.\r\n\r\nThanks, that's interesting.\r\n\r\nOne problem is that routers might fail to pinhole some of the addresses. For example, Fritz!Box refuses to open ports on temporary privacy ones, which aren't a distinguishable range or type (on purpose). Might end up having no open port at all, or only for a temporary address lifetime. So for this PR, i prefer to keep the \"announce all publicly routable\" that is the current `Discover()` behavior for now.\r\n\r\nFine with discussing changes to IPv6 address choosing behavior later, as you say, it's orthogonal to adding PCP. ",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2114203144",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGE0YjNhOGFjNmQ5ZTZiNzgwMzMxOTE5YjQ2YzUxNjcwYTFkMWM5Mzk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a4b3a8ac6d9e6b780331919b46c51670a1d1c939",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a4b3a8ac6d9e6b780331919b46c51670a1d1c939",
      "tree": {
        "sha": "5aa5661fb466a24cf20bf242aba33b34a7a871cf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5aa5661fb466a24cf20bf242aba33b34a7a871cf"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dd42a5ddea6a72e1e9cad54f8352c76b0b701973",
          "sha": "dd42a5ddea6a72e1e9cad54f8352c76b0b701973",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/dd42a5ddea6a72e1e9cad54f8352c76b0b701973"
        }
      ],
      "message": "crypto: Add missing WriteBE16 function\n\nAlso add fuzz test, mimicing the WriteLE16 one.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T07:40:55Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-04-28T19:39:20Z"
      },
      "sha": "a4b3a8ac6d9e6b780331919b46c51670a1d1c939"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDcxMGUzN2EyMDdkZDU0MzhhNzQ3N2U2YjEwMDZhNjk1YWRiMjllMWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/710e37a207dd5438a7477e6b1006a695adb29e1f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/710e37a207dd5438a7477e6b1006a695adb29e1f",
      "tree": {
        "sha": "7801a32b21c7bded937c34a71083953aedc53b9e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7801a32b21c7bded937c34a71083953aedc53b9e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a4b3a8ac6d9e6b780331919b46c51670a1d1c939",
          "sha": "a4b3a8ac6d9e6b780331919b46c51670a1d1c939",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a4b3a8ac6d9e6b780331919b46c51670a1d1c939"
        }
      ],
      "message": "util: Allow overriding base for ToIntegral\n\nStill default to 10, of course. Need this for parsing a hexadecimal integer.\n\nAdd unit test for ToIntegral with base 16. Make sure the new\nfunctionality is tested in the context that we need it (hex numbers).",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T07:40:55Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-04-28T20:46:27Z"
      },
      "sha": "710e37a207dd5438a7477e6b1006a695adb29e1f"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12828534687,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL8o-ef",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12828534687",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T07:43:21Z"
    },
    {
      "event": "commented",
      "id": 2114295253,
      "node_id": "IC_kwDOABII585-BZXV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2114295253",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T07:43:23Z",
      "updated_at": "2024-05-16T08:22:07Z",
      "author_association": "MEMBER",
      "body": "- Rebased for a trivial merge conflict related to clang installation in `.github/workflows/ci.yml`.\r\n- Needed to change the use of `bitcoin_config.h` to make the lint pass.\r\n- Split `netif.h` and `netif.cpp` creation into a seperate commit (could be a seperate PR later).\r\n- Addressed a few comments.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2114295253",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12828761197,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL8p1xt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12828761197",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T07:59:52Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12828906304,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL8qZNA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12828906304",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T08:10:46Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNhNWMzNGFhYTYyODU2NjZjYzdiYzNjNmUzN2FkNTE5MzZhODYzMzk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca5c34aaa6285666cc7bc3c6e37ad51936a86339",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ca5c34aaa6285666cc7bc3c6e37ad51936a86339",
      "tree": {
        "sha": "9dcc976acecab2a600e45afd10fb7037005d6bb7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9dcc976acecab2a600e45afd10fb7037005d6bb7"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/710e37a207dd5438a7477e6b1006a695adb29e1f",
          "sha": "710e37a207dd5438a7477e6b1006a695adb29e1f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/710e37a207dd5438a7477e6b1006a695adb29e1f"
        }
      ],
      "message": "net: Add netif.h utility header\n\nThis adds an utility header with two functions that will be needed for\nPCP, `QueryDefaultGateway` and `GetLocalAddresses`.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:16:58Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:16:41Z"
      },
      "sha": "ca5c34aaa6285666cc7bc3c6e37ad51936a86339"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGEyMjMwZDU4MmVjZThjYTU1N2M4ZTEwYWRlMDUwYWJjNGZhNGNiY2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a2230d582ece8ca557c8e10ade050abc4fa4cbca",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a2230d582ece8ca557c8e10ade050abc4fa4cbca",
      "tree": {
        "sha": "899f3e264e28958e346b109dac2fb585c55aabc3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/899f3e264e28958e346b109dac2fb585c55aabc3"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca5c34aaa6285666cc7bc3c6e37ad51936a86339",
          "sha": "ca5c34aaa6285666cc7bc3c6e37ad51936a86339",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ca5c34aaa6285666cc7bc3c6e37ad51936a86339"
        }
      ],
      "message": "net: Use GetLocalAddresses in Discover\n\nThis has the same code, it's unnecessary to duplicate it.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T14:14:43Z"
      },
      "sha": "a2230d582ece8ca557c8e10ade050abc4fa4cbca"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc1YTAwN2MyZDcwZmFiYzY1NzM2N2EzYmNjYWM2ZTlmNDQ4YTQyNjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/75a007c2d70fabc657367a3bccac6e9f448a4267",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/75a007c2d70fabc657367a3bccac6e9f448a4267",
      "tree": {
        "sha": "554cd4afb6992f577249c646cf6177048c17a358",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/554cd4afb6992f577249c646cf6177048c17a358"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a2230d582ece8ca557c8e10ade050abc4fa4cbca",
          "sha": "a2230d582ece8ca557c8e10ade050abc4fa4cbca",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a2230d582ece8ca557c8e10ade050abc4fa4cbca"
        }
      ],
      "message": "net: Add PCP implementation\n\nAdd a RFC 6887 Port Control Protocol (PCP) implementation, to replace\nnat-pmp.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:17:57Z"
      },
      "sha": "75a007c2d70fabc657367a3bccac6e9f448a4267"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg1NmEyYjE1ZmI1NzNkOWJjZDcwZTNkODQ5ODEzMmU3OWZjMmI3MGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/856a2b15fb573d9bcd70e3d8498132e79fc2b70a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/856a2b15fb573d9bcd70e3d8498132e79fc2b70a",
      "tree": {
        "sha": "6406c6591bf4b63ae391a46bda16088c6105cd5a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6406c6591bf4b63ae391a46bda16088c6105cd5a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/75a007c2d70fabc657367a3bccac6e9f448a4267",
          "sha": "75a007c2d70fabc657367a3bccac6e9f448a4267",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/75a007c2d70fabc657367a3bccac6e9f448a4267"
        }
      ],
      "message": "net: Replace libnatpmp with built-in PCP implementation in mapport",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T14:20:45Z"
      },
      "sha": "856a2b15fb573d9bcd70e3d8498132e79fc2b70a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGIxMzliZmQ4MzZkNjhhYzhjYjUzNTlmYTczYmMyYTZhNTRhNDAyYzk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b139bfd836d68ac8cb5359fa73bc2a6a54a402c9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b139bfd836d68ac8cb5359fa73bc2a6a54a402c9",
      "tree": {
        "sha": "16687e53b9674ec0a1de74e7a166d44ed2835673",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/16687e53b9674ec0a1de74e7a166d44ed2835673"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/856a2b15fb573d9bcd70e3d8498132e79fc2b70a",
          "sha": "856a2b15fb573d9bcd70e3d8498132e79fc2b70a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/856a2b15fb573d9bcd70e3d8498132e79fc2b70a"
        }
      ],
      "message": "qt: Change NAT-PMP option to PCP",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T17:17:53Z"
      },
      "sha": "b139bfd836d68ac8cb5359fa73bc2a6a54a402c9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDExM2Q5MjNjNjNkNmFkZGQ5MDQ3YTI4MzE0YmJmYTA2ODUxNjlmYWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/113d923c63d6addd9047a28314bbfa0685169fac",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/113d923c63d6addd9047a28314bbfa0685169fac",
      "tree": {
        "sha": "3894b4dafa6925115859db823efd844893249ad9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3894b4dafa6925115859db823efd844893249ad9"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b139bfd836d68ac8cb5359fa73bc2a6a54a402c9",
          "sha": "b139bfd836d68ac8cb5359fa73bc2a6a54a402c9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b139bfd836d68ac8cb5359fa73bc2a6a54a402c9"
        }
      ],
      "message": "build: Drop libnatpmp from build system",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T14:40:11Z"
      },
      "sha": "113d923c63d6addd9047a28314bbfa0685169fac"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIzMWJiZjFjZDYwZGM5MDQ1YmQwNDY0YjhjYmYwODM1NmFjOGZmZTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/231bbf1cd60dc9045bd0464b8cbf08356ac8ffe5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/231bbf1cd60dc9045bd0464b8cbf08356ac8ffe5",
      "tree": {
        "sha": "9614643d098994d74f56a2376a2c377b99bbbc5b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9614643d098994d74f56a2376a2c377b99bbbc5b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/113d923c63d6addd9047a28314bbfa0685169fac",
          "sha": "113d923c63d6addd9047a28314bbfa0685169fac",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/113d923c63d6addd9047a28314bbfa0685169fac"
        }
      ],
      "message": "depends: Drop natpmp and associated option from depends",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T14:46:49Z"
      },
      "sha": "231bbf1cd60dc9045bd0464b8cbf08356ac8ffe5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZmZTdhZjQxZmJlZjQ2OTE2NjA0MDlkY2UxMzVhZWNhNmYxZmQ0NWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ffe7af41fbef4691660409dce135aeca6f1fd45f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ffe7af41fbef4691660409dce135aeca6f1fd45f",
      "tree": {
        "sha": "2012e75aae4ae897a8d8a7e3630f929984f955fa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2012e75aae4ae897a8d8a7e3630f929984f955fa"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/231bbf1cd60dc9045bd0464b8cbf08356ac8ffe5",
          "sha": "231bbf1cd60dc9045bd0464b8cbf08356ac8ffe5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/231bbf1cd60dc9045bd0464b8cbf08356ac8ffe5"
        }
      ],
      "message": "doc: Remove mention of natpmp build options",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T14:49:16Z"
      },
      "sha": "ffe7af41fbef4691660409dce135aeca6f1fd45f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRkN2EwNzAyMmQ2ZWI5ZTQyZTNjNTVhZjVhNmViY2E5YTg5NmFkNWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4d7a07022d6eb9e42e3c55af5a6ebca9a896ad5f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4d7a07022d6eb9e42e3c55af5a6ebca9a896ad5f",
      "tree": {
        "sha": "9e45646bd99e6a7a3b586762a0119c01a0cce103",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9e45646bd99e6a7a3b586762a0119c01a0cce103"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ffe7af41fbef4691660409dce135aeca6f1fd45f",
          "sha": "ffe7af41fbef4691660409dce135aeca6f1fd45f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ffe7af41fbef4691660409dce135aeca6f1fd45f"
        }
      ],
      "message": "ci: Remove natpmp build option",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T14:54:12Z"
      },
      "sha": "4d7a07022d6eb9e42e3c55af5a6ebca9a896ad5f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZhYzk3ZmIwYjlmY2RmMGU5ZDgwZmRkNTllNDI5ZjVmMDFmNjFlNjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ac97fb0b9fcdf0e9d80fdd59e429f5f01f61e62",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6ac97fb0b9fcdf0e9d80fdd59e429f5f01f61e62",
      "tree": {
        "sha": "82fa78d5458257195be2de99c987af858bc92d3d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/82fa78d5458257195be2de99c987af858bc92d3d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4d7a07022d6eb9e42e3c55af5a6ebca9a896ad5f",
          "sha": "4d7a07022d6eb9e42e3c55af5a6ebca9a896ad5f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4d7a07022d6eb9e42e3c55af5a6ebca9a896ad5f"
        }
      ],
      "message": "doc: Mention -pcp instead of -natpmp",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T14:57:07Z"
      },
      "sha": "6ac97fb0b9fcdf0e9d80fdd59e429f5f01f61e62"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM5OTMzYTUzZjNhM2QyOWNmZWJkODI1MmE5YjRkZGNiNDhkMzk2NWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
      "tree": {
        "sha": "cac5126695f10dbc6687893c431f02a077bdbf27",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cac5126695f10dbc6687893c431f02a077bdbf27"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ac97fb0b9fcdf0e9d80fdd59e429f5f01f61e62",
          "sha": "6ac97fb0b9fcdf0e9d80fdd59e429f5f01f61e62",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6ac97fb0b9fcdf0e9d80fdd59e429f5f01f61e62"
        }
      ],
      "message": "test: -pcp=0 instead of natpmp=0",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T08:18:30Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-05T15:00:49Z"
      },
      "sha": "39933a53f3a3d29cfebd8252a9b4ddcb48d3965c"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12829057599,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL8q-I_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12829057599",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T08:19:47Z"
    },
    {
      "event": "unlabeled",
      "id": 12829976090,
      "node_id": "UNLE_lADOABII586H4P0UzwAAAAL8ueYa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12829976090",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T09:18:32Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 12830308505,
      "node_id": "UNLE_lADOABII586H4P0UzwAAAAL8vviZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12830308505",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T09:37:22Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2061123015,
      "node_id": "PRR_kwDOABII58562j3H",
      "url": null,
      "actor": null,
      "commit_id": "39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2061123015",
      "submitted_at": "2024-05-16T15:48:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
    },
    {
      "event": "commented",
      "id": 2115990626,
      "node_id": "IC_kwDOABII585-H3Ri",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2115990626",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T19:04:02Z",
      "updated_at": "2024-05-16T19:04:02Z",
      "author_association": "MEMBER",
      "body": "Replaced Linux-specific `QueryDefaultGateway` with @vasild's netlink implementation for Linux and FreeBSD. This may even generalize to more UNIX variants. \r\n\r\nWill tackle Windows next.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2115990626",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "mentioned",
      "id": 12838664718,
      "node_id": "MEE_lADOABII586H4P0UzwAAAAL9PnoO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12838664718",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T19:04:04Z"
    },
    {
      "event": "subscribed",
      "id": 12838664735,
      "node_id": "SE_lADOABII586H4P0UzwAAAAL9Pnof",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12838664735",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T19:04:04Z"
    },
    {
      "event": "commented",
      "id": 2116158791,
      "node_id": "IC_kwDOABII585-IgVH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2116158791",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T20:53:46Z",
      "updated_at": "2024-05-16T20:53:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\nðŸš§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/25069227736</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2116158791",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "labeled",
      "id": 12839755974,
      "node_id": "LE_lADOABII586H4P0UzwAAAAL9TyDG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12839755974",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T20:53:46Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDczZWY5ZjY4YTlkZTMzMzc4OGU4NWM3YjQzMTliYzUzYmMyODI0NzE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/73ef9f68a9de333788e85c7b4319bc53bc282471",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/73ef9f68a9de333788e85c7b4319bc53bc282471",
      "tree": {
        "sha": "c192c9e16da0f3e78b299300db93b5d94d9f4b8d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c192c9e16da0f3e78b299300db93b5d94d9f4b8d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
          "sha": "39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/39933a53f3a3d29cfebd8252a9b4ddcb48d3965c"
        }
      ],
      "message": "fixup: Use netlink socket to get default route on Linux and FreeBSD",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T08:14:44Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-05-16T18:17:57Z"
      },
      "sha": "73ef9f68a9de333788e85c7b4319bc53bc282471"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZjMDcyNzczMWNlYmY1MTNiZTY1ZDQwOGRiYzUwNjk1YmNmYjllYWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6c0727731cebf513be65d408dbc50695bcfb9eab",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6c0727731cebf513be65d408dbc50695bcfb9eab",
      "tree": {
        "sha": "fc961cb85d6dccd39c90fe6024ed6d659cc3f67b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fc961cb85d6dccd39c90fe6024ed6d659cc3f67b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/73ef9f68a9de333788e85c7b4319bc53bc282471",
          "sha": "73ef9f68a9de333788e85c7b4319bc53bc282471",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/73ef9f68a9de333788e85c7b4319bc53bc282471"
        }
      ],
      "message": "fixup: Revert \"util: Allow overriding base for ToIntegral\"\n\nThis reverts commit 710e37a207dd5438a7477e6b1006a695adb29e1f.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T08:14:44Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T18:22:17Z"
      },
      "sha": "6c0727731cebf513be65d408dbc50695bcfb9eab"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFjODAzZjFlZjdjZmYxYmJlNDRkYzg5MjQ5Mjk4N2YyNDIyMGQyZjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac803f1ef7cff1bbe44dc892492987f24220d2f7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ac803f1ef7cff1bbe44dc892492987f24220d2f7",
      "tree": {
        "sha": "7ca0267e3405032095b488691420cf0a78c0e215",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7ca0267e3405032095b488691420cf0a78c0e215"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6c0727731cebf513be65d408dbc50695bcfb9eab",
          "sha": "6c0727731cebf513be65d408dbc50695bcfb9eab",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6c0727731cebf513be65d408dbc50695bcfb9eab"
        }
      ],
      "message": "fixup: Remove build system check for linux/route.h",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T08:14:44Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-16T18:21:50Z"
      },
      "sha": "ac803f1ef7cff1bbe44dc892492987f24220d2f7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVkZjQwM2JlZTEyNWZiNGUwM2NjZGZlMDk0NzA1NGRhNWM2Y2E4Yzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/edf403bee125fb4e03ccdfe0947054da5c6ca8c8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/edf403bee125fb4e03ccdfe0947054da5c6ca8c8",
      "tree": {
        "sha": "703606eaec51c3a375a55d2618953d3e2a296c18",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/703606eaec51c3a375a55d2618953d3e2a296c18"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac803f1ef7cff1bbe44dc892492987f24220d2f7",
          "sha": "ac803f1ef7cff1bbe44dc892492987f24220d2f7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ac803f1ef7cff1bbe44dc892492987f24220d2f7"
        }
      ],
      "message": "fixup: std::mem* in pcp.cpp",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T08:14:44Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T06:55:22Z"
      },
      "sha": "edf403bee125fb4e03ccdfe0947054da5c6ca8c8"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12844468124,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL9lwec",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12844468124",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T08:15:35Z"
    },
    {
      "event": "commented",
      "id": 2117004469,
      "node_id": "IC_kwDOABII585-Luy1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117004469",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T08:18:39Z",
      "updated_at": "2024-05-17T14:30:51Z",
      "author_association": "MEMBER",
      "body": "Added a (mostly untested for now) Windows implementation of `QueryDefaultGateway`, if someone could test this it'd be very helpful. i will try in WINE later.\r\n\r\nEdit: Wine has only a stub for `GetBestRoute2`, so tested on Amazon EC2 actual windows, can't check PCP due to lack of a suitable router there, but IP address and default gateway finding works:\r\n```\r\n2024-05-17T14:17:48Z [net] pcp: gateway [IPv4]: 172.31.16.1\r\n2024-05-17T14:17:48Z [net] pcp: Requesting port mapping for addr 0.0.0.0 port 18444 from gateway 172.31.16.1                                                                                                                                   \r\n2024-05-17T14:17:48Z [net] pcp: Internal address after connect: 172.31.28.xxx                                                                             \r\n2024-05-17T14:17:51Z [net] pcp: gateway [IPv6]: fe80::58:f4ff:feca:xxxx%7\r\n2024-05-17T14:17:51Z [net] pcp: Requesting port mapping for addr 2600:1f1c:b80:8af0:e073:32d6:80b3:xxxx port 18444 from gateway fe80::58:f4ff:feca:xxxx%7\r\n2024-05-17T14:17:51Z [net] pcp: Internal address after connect: 2600:1f1c:b80:8af0:e073:32d6:80b3:xxxx\r\n```",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2117004469",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12844612544,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL9mTvA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12844612544",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T08:27:09Z"
    },
    {
      "event": "reviewed",
      "id": 2062857416,
      "node_id": "PRR_kwDOABII58569LTI",
      "url": null,
      "actor": null,
      "commit_id": "841deffd44d7a78452deab39adadbf991249128a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#pullrequestreview-2062857416",
      "submitted_at": "2024-05-17T09:56:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
    },
    {
      "event": "commented",
      "id": 2117698802,
      "node_id": "IC_kwDOABII585-OYTy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117698802",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T14:11:05Z",
      "updated_at": "2024-05-17T14:11:05Z",
      "author_association": "MEMBER",
      "body": "Do we have any information about real-world deployment of PCP vs NAT-PMP? I see PCP dates from 2013, but do we know if it was adopted immediately (and/or, how many older routing devices are in common use)?\r\n\r\nRFC 6887 Appendix A explains how one can be compatible with both, though I don't know how much work it would be to implement.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2117698802",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZmMzU2NjE0M2E3YWUzYmYwMDliOWU0NGU0OTIyMWRkM2U4MWFlM2U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ff3566143a7ae3bf009b9e44e49221dd3e81ae3e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ff3566143a7ae3bf009b9e44e49221dd3e81ae3e",
      "tree": {
        "sha": "8ce244bc1a9f44bd70ef4c7661d35d580e0d18b2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8ce244bc1a9f44bd70ef4c7661d35d580e0d18b2"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/edf403bee125fb4e03ccdfe0947054da5c6ca8c8",
          "sha": "edf403bee125fb4e03ccdfe0947054da5c6ca8c8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/edf403bee125fb4e03ccdfe0947054da5c6ca8c8"
        }
      ],
      "message": "fixup: win32 implementation for QueryDefaultGateway",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T14:19:04Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T07:52:54Z"
      },
      "sha": "ff3566143a7ae3bf009b9e44e49221dd3e81ae3e"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12849248423,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL93_in",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12849248423",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T14:19:10Z"
    },
    {
      "event": "commented",
      "id": 2117723501,
      "node_id": "IC_kwDOABII585-OeVt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117723501",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T14:22:21Z",
      "updated_at": "2024-05-17T14:23:06Z",
      "author_association": "MEMBER",
      "body": "i have no idea, also no idea how to get that information; to be honest if we can remotely avoid it, i'd prefer not to implement unnecessary compatibility stuff, with the added complexity that entails, this is already a lot to ask people to review as-is.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2117723501",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "commented",
      "id": 2117736423,
      "node_id": "IC_kwDOABII585-Ohfn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117736423",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T14:28:45Z",
      "updated_at": "2024-05-17T14:28:45Z",
      "author_association": "MEMBER",
      "body": "@laanwj Yeah, fair enough. Absent any reports of \"doesn't work on my router while nat-pmp worked\" (which we're quite unlikely to get) there is really no way to assess that.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2117736423",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "mentioned",
      "id": 12849395247,
      "node_id": "MEE_lADOABII586H4P0UzwAAAAL94jYv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12849395247",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T14:28:46Z"
    },
    {
      "event": "subscribed",
      "id": 12849395263,
      "node_id": "SE_lADOABII586H4P0UzwAAAAL94jY_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12849395263",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T14:28:46Z"
    },
    {
      "event": "commented",
      "id": 2117749832,
      "node_id": "IC_kwDOABII585-OkxI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117749832",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T14:35:58Z",
      "updated_at": "2024-05-17T14:43:48Z",
      "author_association": "MEMBER",
      "body": "> Yeah, fair enough. Absent any reports of \"doesn't work on my router while nat-pmp worked\" (which we're quite unlikely to get) there is really no way to assess that.\r\n\r\nFor what it's worth, initial support for PCP was added in miniupnpd in [2013](https://github.com/miniupnp/miniupnp/commit/9e1ffd5cd9836053cfd83d95014c729ad0e36872). So the implementation wasn't lagging much behind the standard. Of course, not all routers use miniupnpd but it's extremely common.\r\n\r\nIf we get reports like that, we can decide to re-add NAT-PMP in a similar way as the current code., without reintroducing the dependency. It's not that different, it can share the gateway finding code, for one.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#issuecomment-2117749832",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30043"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg2Y2E1NDliNjgyMGFhOWM3NDQ0NDJlNzkzY2M2ZGE4YjljN2U2MDI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "tree": {
        "sha": "e965d0a3ddf904ff9c262c5046355fb6c87f61ba",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e965d0a3ddf904ff9c262c5046355fb6c87f61ba"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ff3566143a7ae3bf009b9e44e49221dd3e81ae3e",
          "sha": "ff3566143a7ae3bf009b9e44e49221dd3e81ae3e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ff3566143a7ae3bf009b9e44e49221dd3e81ae3e"
        }
      ],
      "message": "fixup: send right size, silence signed comparison warning (hopefully)",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T16:18:12Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2024-05-17T15:45:46Z"
      },
      "sha": "86ca549b6820aa9c744442e793cc6da8b9c7e602"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12850791054,
      "node_id": "HRFPE_lADOABII586H4P0UzwAAAAL994KO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12850791054",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T16:18:19Z"
    },
    {
      "event": "unlabeled",
      "id": 12852678828,
      "node_id": "UNLE_lADOABII586H4P0UzwAAAAL-FFCs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12852678828",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-17T19:42:50Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1590975165",
      "pull_request_review_id": 2040718091,
      "id": 1590975165,
      "node_id": "PRRC_kwDOABII585e1Fq9",
      "diff_hunk": "@@ -760,8 +757,8 @@ void InitParameterInteraction(ArgsManager& args)\n         // do not map ports or try to retrieve public IP when not listening (pointless)\n         if (args.SoftSetBoolArg(\"-upnp\", false))\n             LogPrintf(\"%s: parameter interaction: -listen=0 -> setting -upnp=0\\n\", __func__);\n-        if (args.SoftSetBoolArg(\"-natpmp\", false)) {",
      "path": "src/init.cpp",
      "position": 25,
      "original_position": 29,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "a2d67c320f8a28da98e6c8352bd67648a9b831a8",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "a2d67c320f8a28da98e6c8352bd67648a9b831a8: I think you need to keep this (and above) until `-natpmp` is removed.",
      "created_at": "2024-05-06T12:53:51Z",
      "updated_at": "2024-05-06T16:51:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1590975165",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1590975165"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 764,
      "original_line": 764,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1592075348",
      "pull_request_review_id": 2042519681,
      "id": 1592075348,
      "node_id": "PRRC_kwDOABII585e5SRU",
      "diff_hunk": "@@ -760,8 +757,8 @@ void InitParameterInteraction(ArgsManager& args)\n         // do not map ports or try to retrieve public IP when not listening (pointless)\n         if (args.SoftSetBoolArg(\"-upnp\", false))\n             LogPrintf(\"%s: parameter interaction: -listen=0 -> setting -upnp=0\\n\", __func__);\n-        if (args.SoftSetBoolArg(\"-natpmp\", false)) {",
      "path": "src/init.cpp",
      "position": 25,
      "original_position": 29,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "a2d67c320f8a28da98e6c8352bd67648a9b831a8",
      "in_reply_to_id": 1590975165,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, good point.",
      "created_at": "2024-05-07T08:59:41Z",
      "updated_at": "2024-05-07T08:59:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1592075348",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1592075348"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 764,
      "original_line": 764,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1592765102",
      "pull_request_review_id": 2043665469,
      "id": 1592765102,
      "node_id": "PRRC_kwDOABII585e76qu",
      "diff_hunk": "@@ -0,0 +1,236 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <util/pcp.h>\n+\n+#include <crypto/common.h>\n+#include <logging.h>\n+#include <netaddress.h>\n+#include <random.h>\n+#include <util/netif.h>\n+#include <util/readwritefile.h>\n+#include <util/sock.h>\n+#include <util/strencodings.h>\n+\n+// RFC 6887 Port Control Protocol (PCP) implementation.\n+// PCP uses network byte order (big-endian).\n+// References to sections and figures in the code below refer to https://datatracker.ietf.org/doc/html/rfc6887.\n+\n+//! Mapping of PCP result code to string (7.4).\n+static const std::map<uint8_t, std::string> PCP_RESULT_STR{\n+    {0,  \"SUCCESS\"},\n+    {1,  \"UNSUPP_VERSION\"},\n+    {2,  \"NOT_AUTHORIZED\"},\n+    {3,  \"MALFORMED_REQUEST\"},\n+    {4,  \"UNSUPP_OPCODE\"},\n+    {5,  \"UNSUPP_OPTION\"},\n+    {6,  \"MALFORMED_OPTION\"},\n+    {7,  \"NETWORK_FAILURE\"},\n+    {8,  \"NO_RESOURCES\"},\n+    {9,  \"UNSUPP_PROTOCOL\"},\n+    {10, \"USER_EX_QUOTA\"},\n+    {11, \"CANNOT_PROVIDE_EXTERNAL\"},\n+    {12, \"ADDRESS_MISMATCH\"},\n+    {13, \"EXCESSIVE_REMOTE_PEER\"},\n+};\n+\n+std::string PCPResultString(uint8_t result_code)\n+{\n+    auto result_i = PCP_RESULT_STR.find(result_code);\n+    return strprintf(\"%s (code %d)\", result_i == PCP_RESULT_STR.end() ? \"(unknown)\" : result_i->second,  result_code);\n+}\n+\n+//! Wrap address in IPv6 according to RFC. wrapped_addr needs to be able to store 16 bytes.\n+[[nodiscard]] static bool PCPWrapAddress(uint8_t *wrapped_addr, const CNetAddr &addr)\n+{\n+    if (addr.IsIPv4()) {\n+        struct in_addr addr4;\n+        if (!addr.GetInAddr(&addr4)) return false;\n+        // Section 5: \"When the address field holds an IPv4 address, an IPv4-mapped IPv6 address [RFC4291] is used (::ffff:0:0/96).\"\n+        memcpy(wrapped_addr, IPV4_IN_IPV6_PREFIX.data(), IPV4_IN_IPV6_PREFIX.size());\n+        memcpy(wrapped_addr + IPV4_IN_IPV6_PREFIX.size(), &addr4, ADDR_IPV4_SIZE);\n+        return true;\n+    } else if (addr.IsIPv6()) {\n+        struct in6_addr addr6;\n+        if (!addr.GetIn6Addr(&addr6)) return false;\n+        memcpy(wrapped_addr, &addr6, ADDR_IPV6_SIZE);\n+        return true;\n+    } else {\n+        return false;\n+    }\n+}\n+\n+//! Unwrap PCP-encoded address.\n+static CNetAddr PCPUnwrapAddress(const uint8_t *wrapped_addr)\n+{\n+    if (memcmp(wrapped_addr, IPV4_IN_IPV6_PREFIX.data(), IPV4_IN_IPV6_PREFIX.size()) == 0) {\n+        struct in_addr addr4;\n+        memcpy(&addr4, wrapped_addr + IPV4_IN_IPV6_PREFIX.size(), ADDR_IPV4_SIZE);\n+        return CNetAddr(addr4);\n+    } else {\n+        struct in6_addr addr6;\n+        memcpy(&addr6, wrapped_addr, ADDR_IPV6_SIZE);\n+        return CNetAddr(addr6);\n+    }\n+}\n+\n+std::optional<MappingResult> PCPRequestPortMap(const PCPMappingNonce &nonce, const CNetAddr &gateway, const CNetAddr &bind, uint16_t port, uint32_t lifetime, int num_tries, bool option_prefer_failure)\n+{\n+    struct sockaddr_storage dest_addr, bind_addr;\n+    socklen_t dest_addrlen = sizeof(struct sockaddr_storage), bind_addrlen = sizeof(struct sockaddr_storage);\n+\n+    LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"pcp: Requesting port mapping for addr %s port %d from gateway %s\\n\", bind.ToStringAddr(), port, gateway.ToStringAddr());",
      "path": "src/util/pcp.cpp",
      "position": null,
      "original_position": 83,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "fe53862fd4dca2ce7d3208847ed9e917c30ccb27",
      "in_reply_to_id": null,
      "user": {
        "login": "davidgumberg",
        "id": 2257631,
        "node_id": "MDQ6VXNlcjIyNTc2MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2257631?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidgumberg",
        "html_url": "https://github.com/davidgumberg",
        "followers_url": "https://api.github.com/users/davidgumberg/followers",
        "following_url": "https://api.github.com/users/davidgumberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/davidgumberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/davidgumberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/davidgumberg/subscriptions",
        "organizations_url": "https://api.github.com/users/davidgumberg/orgs",
        "repos_url": "https://api.github.com/users/davidgumberg/repos",
        "events_url": "https://api.github.com/users/davidgumberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/davidgumberg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit:\r\n```suggestion\r\n    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: Requesting port mapping for addr %s port %d from gateway %s\\n\", bind.ToStringAddr(), port, gateway.ToStringAddr());\r\n```",
      "created_at": "2024-05-07T16:25:32Z",
      "updated_at": "2024-05-07T16:25:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1592765102",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1592765102"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 83,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595141704",
      "pull_request_review_id": 2047432934,
      "id": 1595141704,
      "node_id": "PRRC_kwDOABII585fE-5I",
      "diff_hunk": "@@ -108,9 +108,7 @@ OptionsDialog::OptionsDialog(QWidget* parent, bool enableWallet)\n #ifndef USE_UPNP\n     ui->mapPortUpnp->setEnabled(false);\n #endif\n-#ifndef USE_NATPMP\n-    ui->mapPortNatpmp->setEnabled(false);\n-#endif\n+    ui->mapPortPCP->setEnabled(false);",
      "path": "src/qt/optionsdialog.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "73037f27fc21765414c298b171dfdeee130c549b",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "73037f27fc21765414c298b171dfdeee130c549b: needs to be `true`, but you can actually drop this line.",
      "created_at": "2024-05-09T08:29:52Z",
      "updated_at": "2024-05-09T09:56:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1595141704",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595141704"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 111,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595145827",
      "pull_request_review_id": 2047432934,
      "id": 1595145827,
      "node_id": "PRRC_kwDOABII585fE_5j",
      "diff_hunk": "@@ -326,12 +326,12 @@\n         </widget>\n        </item>\n        <item>\n-        <widget class=\"QCheckBox\" name=\"mapPortNatpmp\">\n+        <widget class=\"QCheckBox\" name=\"mapPortPCP\">\n          <property name=\"toolTip\">\n-          <string>Automatically open the Bitcoin client port on the router. This only works when your router supports NAT-PMP and it is enabled. The external port could be random.</string>\n+          <string>Automatically open the Bitcoin client port on the router. This only works when your router supports PCP and it is enabled. The external port could be random.</string>",
      "path": "src/qt/forms/optionsdialog.ui",
      "position": null,
      "original_position": 8,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "73037f27fc21765414c298b171dfdeee130c549b",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "73037f27fc21765414c298b171dfdeee130c549b: maybe add: \"PCP is the successor to NAT-PMP.\", in case someone who didn't read the release notes is confused why that option disappeared.",
      "created_at": "2024-05-09T08:34:02Z",
      "updated_at": "2024-05-09T09:56:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1595145827",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595145827"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 331,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595583401",
      "pull_request_review_id": 2048184349,
      "id": 1595583401,
      "node_id": "PRRC_kwDOABII585fGqup",
      "diff_hunk": "@@ -47,105 +44,73 @@ static std::atomic<MapPortProtoFlag> g_mapport_current_proto{MapPortProtoFlag::N\n using namespace std::chrono_literals;\n static constexpr auto PORT_MAPPING_REANNOUNCE_PERIOD{20min};\n static constexpr auto PORT_MAPPING_RETRY_PERIOD{5min};\n+static constexpr auto PORT_MAPPING_REANNOUNCE_MARGIN{60s};\n \n-#ifdef USE_NATPMP\n-static uint16_t g_mapport_external_port = 0;\n-static bool NatpmpInit(natpmp_t* natpmp)\n+static bool ProcessPCP()\n {\n-    const int r_init = initnatpmp(natpmp, /* detect gateway automatically */ 0, /* forced gateway - NOT APPLIED*/ 0);\n-    if (r_init == 0) return true;\n-    LogPrintf(\"natpmp: initnatpmp() failed with %d error.\\n\", r_init);\n-    return false;\n-}\n+    // The same nonce is used for all mappings, this is allowed by the spec, and simplifies keeping track of them.\n+    PCPMappingNonce pcp_nonce;\n+    GetRandBytes(pcp_nonce);\n \n-static bool NatpmpDiscover(natpmp_t* natpmp, struct in_addr& external_ipv4_addr)\n-{\n-    const int r_send = sendpublicaddressrequest(natpmp);\n-    if (r_send == 2 /* OK */) {\n-        int r_read;\n-        natpmpresp_t response;\n-        do {\n-            r_read = readnatpmpresponseorretry(natpmp, &response);\n-        } while (r_read == NATPMP_TRYAGAIN);\n-\n-        if (r_read == 0) {\n-            external_ipv4_addr = response.pnu.publicaddress.addr;\n-            return true;\n-        } else if (r_read == NATPMP_ERR_NOGATEWAYSUPPORT) {\n-            LogPrintf(\"natpmp: The gateway does not support NAT-PMP.\\n\");\n+    bool ret = false;\n+    const uint16_t private_port = GetListenPort();\n+    // Request reannounce period plus safety margin.\n+    const uint32_t requested_lifetime = std::chrono::seconds(PORT_MAPPING_REANNOUNCE_PERIOD + PORT_MAPPING_REANNOUNCE_MARGIN).count();\n+    std::chrono::seconds sleep_time;\n+\n+    do {\n+        uint32_t actual_lifetime = requested_lifetime;\n+        ret = false; // Set to true if any mapping succeeds.\n+\n+        // IPv4\n+        std::optional<CNetAddr> gateway4 = QueryDefaultGateway(NET_IPV4);\n+        if (!gateway4) {\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: Could not determine IPv4 default gateway\\n\");\n         } else {\n-            LogPrintf(\"natpmp: readnatpmpresponseorretry() for public address failed with %d error.\\n\", r_read);\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: gateway [IPv4]: %s\\n\", gateway4->ToStringAddr());\n+\n+            // Open a port mapping on whatever local address we have toward the gateway.\n+            struct in_addr inaddr_any;\n+            inaddr_any.s_addr = htonl(INADDR_ANY);\n+            std::optional<MappingResult> res = PCPRequestPortMap(pcp_nonce, *gateway4, CNetAddr(inaddr_any), private_port, requested_lifetime);\n+            if (res) {\n+                LogPrintLevel(BCLog::NET, BCLog::Level::Info, \"pcp: ExternalIPv4Address:port = %s\\n\", res->external.ToStringAddrPort());\n+                AddLocal(res->external, LOCAL_MAPPED);\n+                ret = true;\n+                actual_lifetime = std::min(actual_lifetime, res->lifetime);\n+            }\n         }\n-    } else {\n-        LogPrintf(\"natpmp: sendpublicaddressrequest() failed with %d error.\\n\", r_send);\n-    }\n \n-    return false;\n-}\n-\n-static bool NatpmpMapping(natpmp_t* natpmp, const struct in_addr& external_ipv4_addr, uint16_t private_port, bool& external_ip_discovered)\n-{\n-    const uint16_t suggested_external_port = g_mapport_external_port ? g_mapport_external_port : private_port;\n-    const int r_send = sendnewportmappingrequest(natpmp, NATPMP_PROTOCOL_TCP, private_port, suggested_external_port, 3600 /*seconds*/);\n-    if (r_send == 12 /* OK */) {\n-        int r_read;\n-        natpmpresp_t response;\n-        do {\n-            r_read = readnatpmpresponseorretry(natpmp, &response);\n-        } while (r_read == NATPMP_TRYAGAIN);\n-\n-        if (r_read == 0) {\n-            auto pm = response.pnu.newportmapping;\n-            if (private_port == pm.privateport && pm.lifetime > 0) {\n-                g_mapport_external_port = pm.mappedpublicport;\n-                const CService external{external_ipv4_addr, pm.mappedpublicport};\n-                if (!external_ip_discovered && fDiscover) {\n-                    AddLocal(external, LOCAL_MAPPED);\n-                    external_ip_discovered = true;\n+        // IPv6\n+        std::optional<CNetAddr> gateway6 = QueryDefaultGateway(NET_IPV6);\n+        if (!gateway6) {\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: Could not determine IPv6 default gateway\\n\");",
      "path": "src/mapport.cpp",
      "position": 119,
      "original_position": 119,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "6cf4809c6b93e1720dfdfe4e3320cfd8939686b6",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "6cf4809c6b93e1720dfdfe4e3320cfd8939686b6: This is `::Warning` worthy.",
      "created_at": "2024-05-09T15:10:12Z",
      "updated_at": "2024-05-09T15:45:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1595583401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595583401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 85,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1602742155",
      "pull_request_review_id": 2059790357,
      "id": 1602742155,
      "node_id": "PRRC_kwDOABII585fh-eL",
      "diff_hunk": "@@ -47,105 +44,73 @@ static std::atomic<MapPortProtoFlag> g_mapport_current_proto{MapPortProtoFlag::N\n using namespace std::chrono_literals;\n static constexpr auto PORT_MAPPING_REANNOUNCE_PERIOD{20min};\n static constexpr auto PORT_MAPPING_RETRY_PERIOD{5min};\n+static constexpr auto PORT_MAPPING_REANNOUNCE_MARGIN{60s};\n \n-#ifdef USE_NATPMP\n-static uint16_t g_mapport_external_port = 0;\n-static bool NatpmpInit(natpmp_t* natpmp)\n+static bool ProcessPCP()\n {\n-    const int r_init = initnatpmp(natpmp, /* detect gateway automatically */ 0, /* forced gateway - NOT APPLIED*/ 0);\n-    if (r_init == 0) return true;\n-    LogPrintf(\"natpmp: initnatpmp() failed with %d error.\\n\", r_init);\n-    return false;\n-}\n+    // The same nonce is used for all mappings, this is allowed by the spec, and simplifies keeping track of them.\n+    PCPMappingNonce pcp_nonce;\n+    GetRandBytes(pcp_nonce);\n \n-static bool NatpmpDiscover(natpmp_t* natpmp, struct in_addr& external_ipv4_addr)\n-{\n-    const int r_send = sendpublicaddressrequest(natpmp);\n-    if (r_send == 2 /* OK */) {\n-        int r_read;\n-        natpmpresp_t response;\n-        do {\n-            r_read = readnatpmpresponseorretry(natpmp, &response);\n-        } while (r_read == NATPMP_TRYAGAIN);\n-\n-        if (r_read == 0) {\n-            external_ipv4_addr = response.pnu.publicaddress.addr;\n-            return true;\n-        } else if (r_read == NATPMP_ERR_NOGATEWAYSUPPORT) {\n-            LogPrintf(\"natpmp: The gateway does not support NAT-PMP.\\n\");\n+    bool ret = false;\n+    const uint16_t private_port = GetListenPort();\n+    // Request reannounce period plus safety margin.\n+    const uint32_t requested_lifetime = std::chrono::seconds(PORT_MAPPING_REANNOUNCE_PERIOD + PORT_MAPPING_REANNOUNCE_MARGIN).count();\n+    std::chrono::seconds sleep_time;\n+\n+    do {\n+        uint32_t actual_lifetime = requested_lifetime;\n+        ret = false; // Set to true if any mapping succeeds.\n+\n+        // IPv4\n+        std::optional<CNetAddr> gateway4 = QueryDefaultGateway(NET_IPV4);\n+        if (!gateway4) {\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: Could not determine IPv4 default gateway\\n\");\n         } else {\n-            LogPrintf(\"natpmp: readnatpmpresponseorretry() for public address failed with %d error.\\n\", r_read);\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: gateway [IPv4]: %s\\n\", gateway4->ToStringAddr());\n+\n+            // Open a port mapping on whatever local address we have toward the gateway.\n+            struct in_addr inaddr_any;\n+            inaddr_any.s_addr = htonl(INADDR_ANY);\n+            std::optional<MappingResult> res = PCPRequestPortMap(pcp_nonce, *gateway4, CNetAddr(inaddr_any), private_port, requested_lifetime);\n+            if (res) {\n+                LogPrintLevel(BCLog::NET, BCLog::Level::Info, \"pcp: ExternalIPv4Address:port = %s\\n\", res->external.ToStringAddrPort());\n+                AddLocal(res->external, LOCAL_MAPPED);\n+                ret = true;\n+                actual_lifetime = std::min(actual_lifetime, res->lifetime);\n+            }\n         }\n-    } else {\n-        LogPrintf(\"natpmp: sendpublicaddressrequest() failed with %d error.\\n\", r_send);\n-    }\n \n-    return false;\n-}\n-\n-static bool NatpmpMapping(natpmp_t* natpmp, const struct in_addr& external_ipv4_addr, uint16_t private_port, bool& external_ip_discovered)\n-{\n-    const uint16_t suggested_external_port = g_mapport_external_port ? g_mapport_external_port : private_port;\n-    const int r_send = sendnewportmappingrequest(natpmp, NATPMP_PROTOCOL_TCP, private_port, suggested_external_port, 3600 /*seconds*/);\n-    if (r_send == 12 /* OK */) {\n-        int r_read;\n-        natpmpresp_t response;\n-        do {\n-            r_read = readnatpmpresponseorretry(natpmp, &response);\n-        } while (r_read == NATPMP_TRYAGAIN);\n-\n-        if (r_read == 0) {\n-            auto pm = response.pnu.newportmapping;\n-            if (private_port == pm.privateport && pm.lifetime > 0) {\n-                g_mapport_external_port = pm.mappedpublicport;\n-                const CService external{external_ipv4_addr, pm.mappedpublicport};\n-                if (!external_ip_discovered && fDiscover) {\n-                    AddLocal(external, LOCAL_MAPPED);\n-                    external_ip_discovered = true;\n+        // IPv6\n+        std::optional<CNetAddr> gateway6 = QueryDefaultGateway(NET_IPV6);\n+        if (!gateway6) {\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: Could not determine IPv6 default gateway\\n\");",
      "path": "src/mapport.cpp",
      "position": 119,
      "original_position": 119,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "6cf4809c6b93e1720dfdfe4e3320cfd8939686b6",
      "in_reply_to_id": 1595583401,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's hidden as debug because at the moment this is shown when the user doesn't have IPv6. Could boost this to warning if we do the address check first, then don't bother looking for a default gateway if there's none. Will do that.",
      "created_at": "2024-05-16T07:13:39Z",
      "updated_at": "2024-05-16T07:13:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1602742155",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1602742155"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 85,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1602763394",
      "pull_request_review_id": 2059823939,
      "id": 1602763394,
      "node_id": "PRRC_kwDOABII585fiDqC",
      "diff_hunk": "@@ -108,9 +108,7 @@ OptionsDialog::OptionsDialog(QWidget* parent, bool enableWallet)\n #ifndef USE_UPNP\n     ui->mapPortUpnp->setEnabled(false);\n #endif\n-#ifndef USE_NATPMP\n-    ui->mapPortNatpmp->setEnabled(false);\n-#endif\n+    ui->mapPortPCP->setEnabled(false);",
      "path": "src/qt/optionsdialog.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "73037f27fc21765414c298b171dfdeee130c549b",
      "in_reply_to_id": 1595141704,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Whoops, yes, it's `setEnabled`, not setting the default value ðŸ˜… .",
      "created_at": "2024-05-16T07:28:29Z",
      "updated_at": "2024-05-16T07:28:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1602763394",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1602763394"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 111,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1602770267",
      "pull_request_review_id": 2059835406,
      "id": 1602770267,
      "node_id": "PRRC_kwDOABII585fiFVb",
      "diff_hunk": "@@ -47,105 +44,73 @@ static std::atomic<MapPortProtoFlag> g_mapport_current_proto{MapPortProtoFlag::N\n using namespace std::chrono_literals;\n static constexpr auto PORT_MAPPING_REANNOUNCE_PERIOD{20min};\n static constexpr auto PORT_MAPPING_RETRY_PERIOD{5min};\n+static constexpr auto PORT_MAPPING_REANNOUNCE_MARGIN{60s};\n \n-#ifdef USE_NATPMP\n-static uint16_t g_mapport_external_port = 0;\n-static bool NatpmpInit(natpmp_t* natpmp)\n+static bool ProcessPCP()\n {\n-    const int r_init = initnatpmp(natpmp, /* detect gateway automatically */ 0, /* forced gateway - NOT APPLIED*/ 0);\n-    if (r_init == 0) return true;\n-    LogPrintf(\"natpmp: initnatpmp() failed with %d error.\\n\", r_init);\n-    return false;\n-}\n+    // The same nonce is used for all mappings, this is allowed by the spec, and simplifies keeping track of them.\n+    PCPMappingNonce pcp_nonce;\n+    GetRandBytes(pcp_nonce);\n \n-static bool NatpmpDiscover(natpmp_t* natpmp, struct in_addr& external_ipv4_addr)\n-{\n-    const int r_send = sendpublicaddressrequest(natpmp);\n-    if (r_send == 2 /* OK */) {\n-        int r_read;\n-        natpmpresp_t response;\n-        do {\n-            r_read = readnatpmpresponseorretry(natpmp, &response);\n-        } while (r_read == NATPMP_TRYAGAIN);\n-\n-        if (r_read == 0) {\n-            external_ipv4_addr = response.pnu.publicaddress.addr;\n-            return true;\n-        } else if (r_read == NATPMP_ERR_NOGATEWAYSUPPORT) {\n-            LogPrintf(\"natpmp: The gateway does not support NAT-PMP.\\n\");\n+    bool ret = false;\n+    const uint16_t private_port = GetListenPort();\n+    // Request reannounce period plus safety margin.\n+    const uint32_t requested_lifetime = std::chrono::seconds(PORT_MAPPING_REANNOUNCE_PERIOD + PORT_MAPPING_REANNOUNCE_MARGIN).count();\n+    std::chrono::seconds sleep_time;\n+\n+    do {\n+        uint32_t actual_lifetime = requested_lifetime;\n+        ret = false; // Set to true if any mapping succeeds.\n+\n+        // IPv4\n+        std::optional<CNetAddr> gateway4 = QueryDefaultGateway(NET_IPV4);\n+        if (!gateway4) {\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: Could not determine IPv4 default gateway\\n\");\n         } else {\n-            LogPrintf(\"natpmp: readnatpmpresponseorretry() for public address failed with %d error.\\n\", r_read);\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: gateway [IPv4]: %s\\n\", gateway4->ToStringAddr());\n+\n+            // Open a port mapping on whatever local address we have toward the gateway.\n+            struct in_addr inaddr_any;\n+            inaddr_any.s_addr = htonl(INADDR_ANY);\n+            std::optional<MappingResult> res = PCPRequestPortMap(pcp_nonce, *gateway4, CNetAddr(inaddr_any), private_port, requested_lifetime);\n+            if (res) {\n+                LogPrintLevel(BCLog::NET, BCLog::Level::Info, \"pcp: ExternalIPv4Address:port = %s\\n\", res->external.ToStringAddrPort());\n+                AddLocal(res->external, LOCAL_MAPPED);\n+                ret = true;\n+                actual_lifetime = std::min(actual_lifetime, res->lifetime);\n+            }\n         }\n-    } else {\n-        LogPrintf(\"natpmp: sendpublicaddressrequest() failed with %d error.\\n\", r_send);\n-    }\n \n-    return false;\n-}\n-\n-static bool NatpmpMapping(natpmp_t* natpmp, const struct in_addr& external_ipv4_addr, uint16_t private_port, bool& external_ip_discovered)\n-{\n-    const uint16_t suggested_external_port = g_mapport_external_port ? g_mapport_external_port : private_port;\n-    const int r_send = sendnewportmappingrequest(natpmp, NATPMP_PROTOCOL_TCP, private_port, suggested_external_port, 3600 /*seconds*/);\n-    if (r_send == 12 /* OK */) {\n-        int r_read;\n-        natpmpresp_t response;\n-        do {\n-            r_read = readnatpmpresponseorretry(natpmp, &response);\n-        } while (r_read == NATPMP_TRYAGAIN);\n-\n-        if (r_read == 0) {\n-            auto pm = response.pnu.newportmapping;\n-            if (private_port == pm.privateport && pm.lifetime > 0) {\n-                g_mapport_external_port = pm.mappedpublicport;\n-                const CService external{external_ipv4_addr, pm.mappedpublicport};\n-                if (!external_ip_discovered && fDiscover) {\n-                    AddLocal(external, LOCAL_MAPPED);\n-                    external_ip_discovered = true;\n+        // IPv6\n+        std::optional<CNetAddr> gateway6 = QueryDefaultGateway(NET_IPV6);\n+        if (!gateway6) {\n+            LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"pcp: Could not determine IPv6 default gateway\\n\");",
      "path": "src/mapport.cpp",
      "position": 119,
      "original_position": 119,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "6cf4809c6b93e1720dfdfe4e3320cfd8939686b6",
      "in_reply_to_id": 1595583401,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Will keep this open but leave it as-is for now. For IPv4 i'm not currently sure how to check if we have (Internet) networking besides checking for a default gateway, and i'd like to keep the two paths reasonably symmetric. Just checking for publicly routable addresses isn't going to cut it for IPv4.",
      "created_at": "2024-05-16T07:33:03Z",
      "updated_at": "2024-05-16T07:33:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1602770267",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1602770267"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 85,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1603565742",
      "pull_request_review_id": 2061123015,
      "id": 1603565742,
      "node_id": "PRRC_kwDOABII585flHiu",
      "diff_hunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <util/netif.h>\n+\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/readwritefile.h>\n+#include <util/sock.h>\n+#include <util/strencodings.h>\n+\n+#ifdef HAVE_LINUX_ROUTE_H\n+\n+#include <linux/route.h>\n+\n+std::optional<CNetAddr> QueryDefaultGateway(Network network)",
      "path": "src/util/netif.cpp",
      "position": 24,
      "original_position": 19,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The following patch uses a netlink socket to get the information from the kernel, that is supported on (at least) Linux and FreeBSD>=13.2:\r\n\r\n<details>\r\n<summary>[patch] get default gateway using a netlink socket</summary>\r\n\r\n```diff\r\n--- a/src/test/netbase_tests.cpp\r\n+++ b/src/test/netbase_tests.cpp\r\n@@ -1,25 +1,34 @@\r\n // Copyright (c) 2012-2022 The Bitcoin Core developers\r\n // Distributed under the MIT software license, see the accompanying\r\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n \r\n+#include <compat/compat.h>\r\n #include <net_permissions.h>\r\n #include <netaddress.h>\r\n #include <netbase.h>\r\n #include <netgroup.h>\r\n #include <protocol.h>\r\n #include <serialize.h>\r\n #include <streams.h>\r\n #include <test/util/setup_common.h>\r\n #include <util/strencodings.h>\r\n+#include <util/syserror.h>\r\n #include <util/translation.h>\r\n \r\n #include <string>\r\n \r\n #include <boost/test/unit_test.hpp>\r\n \r\n+#ifdef __linux__\r\n+#include <linux/rtnetlink.h>\r\n+#elif defined(__FreeBSD__)\r\n+#include <netlink/netlink.h>\r\n+#include <netlink/netlink_route.h>\r\n+#endif\r\n+\r\n using namespace std::literals;\r\n \r\n BOOST_FIXTURE_TEST_SUITE(netbase_tests, BasicTestingSetup)\r\n \r\n static CNetAddr ResolveIP(const std::string& ip)\r\n {\r\n@@ -610,7 +619,100 @@ BOOST_AUTO_TEST_CASE(isbadport)\r\n             ++total_bad_ports;\r\n         }\r\n     }\r\n     BOOST_CHECK_EQUAL(total_bad_ports, 80);\r\n }\r\n \r\n+std::optional<CNetAddr> QueryDefaultGateway(Network network)\r\n+{\r\n+    Assume(network == NET_IPV4 || network == NET_IPV6);\r\n+\r\n+    // Create a netlink socket.\r\n+\r\n+    const int s{socket(AF_NETLINK, SOCK_DGRAM, NETLINK_ROUTE)};\r\n+    if (s < 0) {\r\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"socket(AF_NETLINK): %s\\n\", SysErrorString(errno));\r\n+        return std::nullopt;\r\n+    }\r\n+    Sock sock{static_cast<SOCKET>(s)};\r\n+\r\n+    // Send request.\r\n+\r\n+    struct {\r\n+        nlmsghdr hdr; ///< Request header.\r\n+        rtmsg data; ///< Request data, a \"route message\".\r\n+        nlattr dst_hdr; ///< One attribute, conveying the route destination address.\r\n+        char dst_data[16]; ///< Route destination address. To query the default route we use 0.0.0.0/0 or [::]/0. For IPv4 the first 4 bytes are used.\r\n+    } request;\r\n+\r\n+    // Whether to use the first 4 or 16 bytes from request.attr_dst_data.\r\n+    const size_t dst_data_len = network == NET_IPV4 ? 4 : 16;\r\n+\r\n+    memset(&request, 0x0, sizeof(request));\r\n+\r\n+    request.hdr.nlmsg_type = RTM_GETROUTE;\r\n+    request.hdr.nlmsg_flags = NLM_F_REQUEST;\r\n+#ifdef __linux__\r\n+    request.hdr.nlmsg_flags |= NLM_F_DUMP;\r\n+#endif\r\n+    request.hdr.nlmsg_len = NLMSG_LENGTH(sizeof(rtmsg) + sizeof(nlattr) + dst_data_len);\r\n+    request.hdr.nlmsg_seq = 0; // Sequence number, used to match which reply is to which request. Irrelevant for us because we send just one request.\r\n+    request.data.rtm_family = network == NET_IPV4 ? AF_INET : AF_INET6;\r\n+    request.data.rtm_dst_len = 0; // Prefix length.\r\n+#ifdef __FreeBSD__\r\n+    request.data.rtm_flags = RTM_F_PREFIX;\r\n+#endif\r\n+    request.dst_hdr.nla_type = RTA_DST;\r\n+    request.dst_hdr.nla_len = sizeof(nlattr) + dst_data_len;\r\n+\r\n+    if (sock.Send(&request, sizeof(request), 0) != sizeof(request)) {\r\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"send() to netlink socket: %s\\n\", SysErrorString(errno));\r\n+        return std::nullopt;\r\n+    }\r\n+\r\n+    // Receive response.\r\n+\r\n+    char response[4096];\r\n+    ssize_t response_len;\r\n+    do {\r\n+        response_len = sock.Recv(response, sizeof(response), 0);\r\n+    } while (response_len < 0 && (errno == EINTR || errno == EAGAIN));\r\n+    if (response_len < 0) {\r\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"recv() from netlink socket: %s\\n\", SysErrorString(errno));\r\n+        return std::nullopt;\r\n+    }\r\n+\r\n+    for (nlmsghdr* hdr = (nlmsghdr*)response; NLMSG_OK(hdr, response_len); hdr = NLMSG_NEXT(hdr, response_len)) {\r\n+        rtmsg* r = (rtmsg*)NLMSG_DATA(hdr);\r\n+        int remaining_len = RTM_PAYLOAD(hdr);\r\n+        // Iterate over the attributes.\r\n+        for (rtattr* attr = RTM_RTA(r); RTA_OK(attr, remaining_len); attr = RTA_NEXT(attr, remaining_len)) {\r\n+            if (attr->rta_type == RTA_GATEWAY) {\r\n+                if (network == NET_IPV4) {\r\n+                    Assume(sizeof(in_addr) == RTA_PAYLOAD(attr));\r\n+                    return CNetAddr{in_addr{.s_addr = *static_cast<decltype(in_addr::s_addr)*>(RTA_DATA(attr))}};\r\n+                } else {\r\n+                    Assume(sizeof(in6_addr) == RTA_PAYLOAD(attr));\r\n+                    in6_addr gw;\r\n+                    std::memcpy(&gw, RTA_DATA(attr), sizeof(gw));\r\n+                    return CNetAddr{gw};\r\n+                }\r\n+            }\r\n+        }\r\n+    }\r\n+\r\n+    return std::nullopt;\r\n+}\r\n+\r\n+BOOST_AUTO_TEST_CASE(netlink)\r\n+{\r\n+    for (const auto net : {NET_IPV4, NET_IPV6}) {\r\n+        const auto gw{QueryDefaultGateway(net)};\r\n+        if (gw.has_value()) {\r\n+            printf(\"Default %s gateway: %s\\n\", GetNetworkName(net).c_str(), gw->ToStringAddr().c_str());\r\n+        } else {\r\n+            printf(\"No %s default gateway.\\n\", GetNetworkName(net).c_str());\r\n+        }\r\n+    }\r\n+}\r\n+\r\n BOOST_AUTO_TEST_SUITE_END()\r\n```\r\n</details>\r\n\r\nI find the netlink interface a somewhat difficult to grasp.\r\n\r\nhttps://man7.org/linux/man-pages/man7/netlink.7.html\r\nhttps://man7.org/linux/man-pages/man7/rtnetlink.7.html\r\nhttps://man7.org/linux/man-pages/man3/rtnetlink.3.html\r\nhttps://stackoverflow.com/questions/11788326/extract-current-route-from-netlink-message-code-attached\r\nhttps://www.rfc-editor.org/rfc/rfc3549",
      "created_at": "2024-05-16T15:10:54Z",
      "updated_at": "2024-05-16T15:48:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1603565742",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1603565742"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1603770501",
      "pull_request_review_id": 2061450460,
      "id": 1603770501,
      "node_id": "PRRC_kwDOABII585fl5iF",
      "diff_hunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <util/netif.h>\n+\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/readwritefile.h>\n+#include <util/sock.h>\n+#include <util/strencodings.h>\n+\n+#ifdef HAVE_LINUX_ROUTE_H\n+\n+#include <linux/route.h>\n+\n+std::optional<CNetAddr> QueryDefaultGateway(Network network)",
      "path": "src/util/netif.cpp",
      "position": 24,
      "original_position": 19,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
      "in_reply_to_id": 1603565742,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Huh interesting. i didn't know netlink worked for multiple operating systems, that's much better.",
      "created_at": "2024-05-16T17:31:16Z",
      "updated_at": "2024-05-16T17:31:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1603770501",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1603770501"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1603876259",
      "pull_request_review_id": 2061615847,
      "id": 1603876259,
      "node_id": "PRRC_kwDOABII585fmTWj",
      "diff_hunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <util/netif.h>\n+\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/readwritefile.h>\n+#include <util/sock.h>\n+#include <util/strencodings.h>\n+\n+#ifdef HAVE_LINUX_ROUTE_H\n+\n+#include <linux/route.h>\n+\n+std::optional<CNetAddr> QueryDefaultGateway(Network network)",
      "path": "src/util/netif.cpp",
      "position": 24,
      "original_position": 19,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
      "in_reply_to_id": 1603565742,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "~~Is it possible to get the `scope_id` for IPv6 addresses? At least my router gives me an link-scope address.~~\r\n\r\nEdit: on linux this is `RTA_OIF`, it appears",
      "created_at": "2024-05-16T18:37:25Z",
      "updated_at": "2024-05-16T19:00:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1603876259",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1603876259"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1604635967",
      "pull_request_review_id": 2062804021,
      "id": 1604635967,
      "node_id": "PRRC_kwDOABII585fpM0_",
      "diff_hunk": "@@ -0,0 +1,116 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <util/netif.h>\n+\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/readwritefile.h>\n+#include <util/sock.h>\n+#include <util/strencodings.h>\n+\n+#ifdef HAVE_LINUX_ROUTE_H\n+\n+#include <linux/route.h>\n+\n+std::optional<CNetAddr> QueryDefaultGateway(Network network)",
      "path": "src/util/netif.cpp",
      "position": 24,
      "original_position": 19,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "39933a53f3a3d29cfebd8252a9b4ddcb48d3965c",
      "in_reply_to_id": 1603565742,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Here is a standalone program to get the default gateway using a netlink socket:\r\n\r\n<details>\r\n<summary>netlink_get_default_route.cc</summary>\r\n\r\n```cc\r\n#include <arpa/inet.h>\r\n#include <assert.h>\r\n#include <errno.h>\r\n#include <net/if.h>\r\n#include <netinet/in.h>\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <string.h>\r\n#include <sys/socket.h>\r\n#include <sys/types.h>\r\n#include <unistd.h>\r\n\r\n#ifdef __linux__\r\n#include <linux/rtnetlink.h>\r\n#elif defined(__FreeBSD__)\r\n#include <netlink/netlink.h>\r\n#include <netlink/netlink_route.h>\r\n#endif\r\n\r\nvoid QueryDefaultGateway(sa_family_t family)\r\n{\r\n    // Create a netlink socket.\r\n\r\n    int sock = socket(AF_NETLINK, SOCK_DGRAM, NETLINK_ROUTE);\r\n    if (sock < 0) {\r\n        perror(\"socket(AF_NETLINK)\");\r\n        return;\r\n    }\r\n\r\n    // Send request.\r\n\r\n    struct {\r\n        nlmsghdr hdr; ///< Request header.\r\n        rtmsg data; ///< Request data, a \"route message\".\r\n        nlattr dst_hdr; ///< One attribute, conveying the route destination address.\r\n        char dst_data[16]; ///< Route destination address. To query the default route we use 0.0.0.0/0 or [::]/0. For IPv4 the first 4 bytes are used.\r\n    } request{};\r\n\r\n    // Whether to use the first 4 or 16 bytes from request.attr_dst_data.\r\n    const size_t dst_data_len = family == AF_INET ? 4 : 16;\r\n\r\n    request.hdr.nlmsg_type = RTM_GETROUTE;\r\n    request.hdr.nlmsg_flags = NLM_F_REQUEST;\r\n#ifdef __linux__\r\n    // XXX some strange behavior:\r\n    // Linux IPv4 - this must be present, otherwise no gateway is found\r\n    // Linux IPv6 - this must be present, otherwise no gateway is found\r\n    // FreeBSD IPv4 - does not matter, the gateway is found with or without this\r\n    // FreeBSD IPv6 - this must be absent, otherwise no gateway is found\r\n    request.hdr.nlmsg_flags |= NLM_F_DUMP;\r\n#endif\r\n    request.hdr.nlmsg_len = NLMSG_LENGTH(sizeof(rtmsg) + sizeof(nlattr) + dst_data_len);\r\n    request.hdr.nlmsg_seq = 0; // Sequence number, used to match which reply is to which request. Irrelevant for us because we send just one request.\r\n    request.data.rtm_family = family;\r\n    request.data.rtm_dst_len = 0; // Prefix length.\r\n    //request.data.rtm_table = RT_TABLE_MAIN;\r\n    //request.data.rtm_protocol = RTPROT_STATIC;\r\n    //request.data.rtm_scope = RT_SCOPE_UNIVERSE;\r\n    //request.data.rtm_type = RTN_UNICAST;\r\n#ifdef __FreeBSD__\r\n    // XXX some strange behavior:\r\n    // Linux IPv4 - this must be absent, otherwise no gateway is found\r\n    // Linux IPv6 - this must be absent, otherwise no gateway is found\r\n    // FreeBSD IPv4 - does not matter, the gateway is found with or without this\r\n    // FreeBSD IPv6 - this must be present, otherwise no gateway is found\r\n    request.data.rtm_flags = RTM_F_PREFIX;\r\n#endif\r\n    request.dst_hdr.nla_type = RTA_DST;\r\n    request.dst_hdr.nla_len = sizeof(nlattr) + dst_data_len;\r\n\r\n    if (send(sock, &request, request.hdr.nlmsg_len, 0) != request.hdr.nlmsg_len) {\r\n        fprintf(stderr, \"send() failed to send %u bytes\\n\", request.hdr.nlmsg_len);\r\n        close(sock);\r\n        return;\r\n    }\r\n\r\n    // Receive response.\r\n\r\n    char response[4096];\r\n    ssize_t response_len;\r\n    do {\r\n        response_len = recv(sock, response, sizeof(response), 0);\r\n    } while (response_len < 0 && (errno == EINTR || errno == EAGAIN));\r\n    if (response_len < 0) {\r\n        fprintf(stderr, \"recv(): %s\\n\", strerror(errno));\r\n        close(sock);\r\n        return;\r\n    }\r\n\r\n    for (nlmsghdr *hdr = (nlmsghdr*)response; NLMSG_OK(hdr, response_len); hdr = NLMSG_NEXT(hdr, response_len)) {\r\n        rtmsg* r = (rtmsg*)NLMSG_DATA(hdr);\r\n        int remaining_len = RTM_PAYLOAD(hdr);\r\n\r\n        // Iterate over the attributes.\r\n        rtattr* rta_gateway = nullptr;\r\n        int scope_id = 0;\r\n        for (rtattr *attr = RTM_RTA(r); RTA_OK(attr, remaining_len); attr = RTA_NEXT(attr, remaining_len)) {\r\n            if (attr->rta_type == RTA_GATEWAY) {\r\n                rta_gateway = attr;\r\n            } else if (attr->rta_type == RTA_OIF) {\r\n                assert(sizeof(int) == RTA_PAYLOAD(attr));\r\n                memcpy(&scope_id, RTA_DATA(attr), sizeof(scope_id));\r\n            }\r\n        }\r\n\r\n        // Found gateway?\r\n        if (rta_gateway != nullptr) {\r\n            char buf[256];\r\n            printf(\"%s gateway: %s\",\r\n                   family == AF_INET ? \"IPv4\" : \"IPv6\",\r\n                   inet_ntop(r->rtm_family, RTA_DATA(rta_gateway), buf, sizeof(buf)));\r\n            if (family == AF_INET6) {\r\n                printf(\", scope id: %d\\n\", scope_id);\r\n            } else {\r\n                printf(\"\\n\");\r\n            }\r\n        }\r\n    }\r\n\r\n    close(sock);\r\n}\r\n\r\nint main(int argc, char** argv)\r\n{\r\n    QueryDefaultGateway(AF_INET);\r\n    QueryDefaultGateway(AF_INET6);\r\n    return 0;\r\n}\r\n```\r\n</details>\r\n\r\nIdeally the `#ifdef __linux__` / `#ifdef __FreeBSD__` parts should not be needed. I am not sure if this is due to the above program doing something wrong or is due to a difference in Linux vs FreeBSD implementations. @AlexanderChernikov, @markjdb, any ideas?",
      "created_at": "2024-05-17T09:30:22Z",
      "updated_at": "2024-05-17T09:30:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1604635967",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1604635967"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1604672913",
      "pull_request_review_id": 2062857416,
      "id": 1604672913,
      "node_id": "PRRC_kwDOABII585fpV2R",
      "diff_hunk": "@@ -0,0 +1,206 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <util/netif.h>\n+\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/check.h>\n+#include <util/sock.h>\n+#include <util/syserror.h>\n+\n+#if defined(__linux__) || defined(__FreeBSD__)\n+\n+#if defined(__linux__)\n+#include <linux/rtnetlink.h>\n+#elif defined(__FreeBSD__)\n+#include <netlink/netlink.h>\n+#include <netlink/netlink_route.h>\n+#endif\n+\n+std::optional<CNetAddr> QueryDefaultGateway(Network network)\n+{\n+    Assume(network == NET_IPV4 || network == NET_IPV6);\n+\n+    // Create a netlink socket.\n+    const int s{socket(AF_NETLINK, SOCK_DGRAM, NETLINK_ROUTE)};\n+    if (s < 0) {\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"socket(AF_NETLINK): %s\\n\", SysErrorString(errno));\n+        return std::nullopt;\n+    }\n+    Sock sock{static_cast<SOCKET>(s)};\n+\n+    // Send request.\n+    struct {\n+        nlmsghdr hdr; ///< Request header.\n+        rtmsg data; ///< Request data, a \"route message\".\n+        nlattr dst_hdr; ///< One attribute, conveying the route destination address.\n+        char dst_data[16]; ///< Route destination address. To query the default route we use 0.0.0.0/0 or [::]/0. For IPv4 the first 4 bytes are used.\n+    } request{};\n+\n+    // Whether to use the first 4 or 16 bytes from request.attr_dst_data.\n+    const size_t dst_data_len = network == NET_IPV4 ? 4 : 16;\n+\n+    request.hdr.nlmsg_type = RTM_GETROUTE;\n+    request.hdr.nlmsg_flags = NLM_F_REQUEST;\n+#ifdef __linux__\n+    request.hdr.nlmsg_flags |= NLM_F_DUMP;\n+#endif\n+    request.hdr.nlmsg_len = NLMSG_LENGTH(sizeof(rtmsg) + sizeof(nlattr) + dst_data_len);\n+    request.hdr.nlmsg_seq = 0; // Sequence number, used to match which reply is to which request. Irrelevant for us because we send just one request.\n+    request.data.rtm_family = network == NET_IPV4 ? AF_INET : AF_INET6;\n+    request.data.rtm_dst_len = 0; // Prefix length.\n+#ifdef __FreeBSD__\n+    request.data.rtm_flags = RTM_F_PREFIX;\n+#endif\n+    request.dst_hdr.nla_type = RTA_DST;\n+    request.dst_hdr.nla_len = sizeof(nlattr) + dst_data_len;\n+\n+    if (sock.Send(&request, sizeof(request), 0) != sizeof(request)) {\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"send() to netlink socket: %s\\n\", SysErrorString(errno));",
      "path": "src/util/netif.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "841deffd44d7a78452deab39adadbf991249128a",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I realized that in the IPv4 case this would send the trailing 16-4=12 bytes from `request.dst_data[]`. This seems harmless, but better send exactly what's needed:\r\n\r\n```suggestion\r\n    if (sock.Send(&request, request.hdr.nlmsg_len, 0) != request.hdr.nlmsg_len) {\r\n        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"send() to netlink socket: %s\\n\", SysErrorString(errno));\r\n```\r\n\r\nAlso, I am not sure if we should worry about partial writes with netlink sockets, maybe the send can be interrupted? There is a convenience method `Sock::SendComplete()`:\r\n\r\n```cc\r\n    try {\r\n        CThreadInterrupt intr;\r\n        sock.SendComplete(Span{reinterpret_cast<const unsigned char*>(&request), request.hdr.nlmsg_len}, 5s, intr);\r\n    } catch (const std::runtime_error& e) {\r\n        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"writing to netlink socket: %s\\n\", e.what());\r\n        return std::nullopt;\r\n    }\r\n```",
      "created_at": "2024-05-17T09:56:08Z",
      "updated_at": "2024-05-17T09:56:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1604672913",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1604672913"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": 62,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1604736981",
      "pull_request_review_id": 2062948610,
      "id": 1604736981,
      "node_id": "PRRC_kwDOABII585fplfV",
      "diff_hunk": "@@ -0,0 +1,206 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <util/netif.h>\n+\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/check.h>\n+#include <util/sock.h>\n+#include <util/syserror.h>\n+\n+#if defined(__linux__) || defined(__FreeBSD__)\n+\n+#if defined(__linux__)\n+#include <linux/rtnetlink.h>\n+#elif defined(__FreeBSD__)\n+#include <netlink/netlink.h>\n+#include <netlink/netlink_route.h>\n+#endif\n+\n+std::optional<CNetAddr> QueryDefaultGateway(Network network)\n+{\n+    Assume(network == NET_IPV4 || network == NET_IPV6);\n+\n+    // Create a netlink socket.\n+    const int s{socket(AF_NETLINK, SOCK_DGRAM, NETLINK_ROUTE)};\n+    if (s < 0) {\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"socket(AF_NETLINK): %s\\n\", SysErrorString(errno));\n+        return std::nullopt;\n+    }\n+    Sock sock{static_cast<SOCKET>(s)};\n+\n+    // Send request.\n+    struct {\n+        nlmsghdr hdr; ///< Request header.\n+        rtmsg data; ///< Request data, a \"route message\".\n+        nlattr dst_hdr; ///< One attribute, conveying the route destination address.\n+        char dst_data[16]; ///< Route destination address. To query the default route we use 0.0.0.0/0 or [::]/0. For IPv4 the first 4 bytes are used.\n+    } request{};\n+\n+    // Whether to use the first 4 or 16 bytes from request.attr_dst_data.\n+    const size_t dst_data_len = network == NET_IPV4 ? 4 : 16;\n+\n+    request.hdr.nlmsg_type = RTM_GETROUTE;\n+    request.hdr.nlmsg_flags = NLM_F_REQUEST;\n+#ifdef __linux__\n+    request.hdr.nlmsg_flags |= NLM_F_DUMP;\n+#endif\n+    request.hdr.nlmsg_len = NLMSG_LENGTH(sizeof(rtmsg) + sizeof(nlattr) + dst_data_len);\n+    request.hdr.nlmsg_seq = 0; // Sequence number, used to match which reply is to which request. Irrelevant for us because we send just one request.\n+    request.data.rtm_family = network == NET_IPV4 ? AF_INET : AF_INET6;\n+    request.data.rtm_dst_len = 0; // Prefix length.\n+#ifdef __FreeBSD__\n+    request.data.rtm_flags = RTM_F_PREFIX;\n+#endif\n+    request.dst_hdr.nla_type = RTA_DST;\n+    request.dst_hdr.nla_len = sizeof(nlattr) + dst_data_len;\n+\n+    if (sock.Send(&request, sizeof(request), 0) != sizeof(request)) {\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"send() to netlink socket: %s\\n\", SysErrorString(errno));",
      "path": "src/util/netif.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "86ca549b6820aa9c744442e793cc6da8b9c7e602",
      "original_commit_id": "841deffd44d7a78452deab39adadbf991249128a",
      "in_reply_to_id": 1604672913,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's a datagram (packet socket), so *partial* writes and reads cannot happen. Every send is interpreted as a new packet. Using `SendComplete` would be a bug.\r\n\r\nTruncated and corrupted packets could happen in the case of UDP, but as NETLINK is a communication interface with the kernel, that would be rare. No retries are needed. Would still want to detect it and error out gracefully, though, for robustness.\r\n\r\n> I realized that in the IPv4 case this would send the trailing 16-4=12 bytes from request.dst_data[]. This seems harmless, but better send exactly what's needed\r\n\r\nAgreed, will change that.",
      "created_at": "2024-05-17T10:32:41Z",
      "updated_at": "2024-05-17T10:35:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30043#discussion_r1604736981",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1604736981"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30043"
        }
      },
      "start_line": null,
      "original_start_line": 62,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    }
  ]
}