{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624",
    "id": 2546204820,
    "node_id": "PR_kwDOABII586XxACU",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32624",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32624.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32624.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/3ea15fe0b462417ff19d91b504626ee072091759",
    "number": 32624,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "fuzz: wallet: add target for `MigrateToDescriptor`",
    "user": {
      "login": "brunoerg",
      "id": 19480819,
      "node_id": "MDQ6VXNlcjE5NDgwODE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brunoerg",
      "html_url": "https://github.com/brunoerg",
      "followers_url": "https://api.github.com/users/brunoerg/followers",
      "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
      "organizations_url": "https://api.github.com/users/brunoerg/orgs",
      "repos_url": "https://api.github.com/users/brunoerg/repos",
      "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/brunoerg/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This PR adds fuzz coverage for the scriptpubkeyman migration (`MigrateToDescriptor`). Note that it's a test for the migration of the scriptpubkey manager, not for the whole migration process as tried in #29694, because:\r\n1) The wallet migration deals with DBs which is expensive for fuzzing (was getting around 3 exec/s);\r\n2) Mocking would require lots of refactors.\r\n\r\nThis target loads keys, HDChain (even inactive ones), watch only and might add tons of different scripts, then calls `MigrateToDescriptor`. It does not play with encrypted stuff because it would make the target super slow. Also, after the migration there are some assertions that would work as a regression test for https://github.com/bitcoin/bitcoin/pull/31452, for example.",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      },
      {
        "id": 9554944034,
        "node_id": "LA_kwDOABII588AAAACOYTgIg",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Fuzzing",
        "name": "Fuzzing",
        "description": "",
        "color": "0e8a16",
        "default": false
      }
    ],
    "created_at": "2025-05-27T11:34:05Z",
    "updated_at": "2026-01-23T16:16:56Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "42794efc01c5378734b921cd87cec036f0b7afda",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "brunoerg:2025-05-fuzz-spkm-migration",
      "ref": "2025-05-fuzz-spkm-migration",
      "sha": "3ea15fe0b462417ff19d91b504626ee072091759",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 267841305,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNjc4NDEzMDU=",
        "name": "bitcoin",
        "full_name": "brunoerg/bitcoin",
        "owner": {
          "login": "brunoerg",
          "id": 19480819,
          "node_id": "MDQ6VXNlcjE5NDgwODE5",
          "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/brunoerg",
          "html_url": "https://github.com/brunoerg",
          "followers_url": "https://api.github.com/users/brunoerg/followers",
          "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
          "organizations_url": "https://api.github.com/users/brunoerg/orgs",
          "repos_url": "https://api.github.com/users/brunoerg/repos",
          "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/brunoerg/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/brunoerg/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/brunoerg/bitcoin",
        "archive_url": "https://api.github.com/repos/brunoerg/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/brunoerg/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/brunoerg/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/brunoerg/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/brunoerg/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/brunoerg/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/brunoerg/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/brunoerg/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/brunoerg/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/brunoerg/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/brunoerg/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/brunoerg/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/brunoerg/bitcoin/events",
        "forks_url": "https://api.github.com/repos/brunoerg/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/brunoerg/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/brunoerg/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/brunoerg/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/brunoerg/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/brunoerg/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/brunoerg/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/brunoerg/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/brunoerg/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/brunoerg/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/brunoerg/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/brunoerg/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/brunoerg/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/brunoerg/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/brunoerg/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/brunoerg/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:brunoerg/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/brunoerg/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/brunoerg/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/brunoerg/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/brunoerg/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/brunoerg/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/brunoerg/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/brunoerg/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/brunoerg/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/brunoerg/bitcoin/hooks",
        "svn_url": "https://github.com/brunoerg/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 6,
        "watchers_count": 6,
        "size": 283642,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-23T16:03:52Z",
        "created_at": "2020-05-29T11:30:10Z",
        "updated_at": "2025-12-22T13:23:26Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "5b8c204275aa1335fe9c336a2bd1d397b49a8ac6",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38773,
        "stargazers_count": 87750,
        "watchers_count": 87750,
        "size": 302261,
        "default_branch": "master",
        "open_issues_count": 749,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-23T15:10:57Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-23T17:00:05Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 148,
    "deletions": 1,
    "changed_files": 1,
    "commits": 1,
    "review_comments": 20,
    "comments": 9
  },
  "events": [
    {
      "event": "commented",
      "id": 2912180479,
      "node_id": "IC_kwDOABII586tlFj_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2912180479",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-27T11:34:08Z",
      "updated_at": "2026-01-23T16:04:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32624.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Approach ACK | [w0xlt](https://github.com/bitcoin/bitcoin/pull/32624#pullrequestreview-2872882290) |\n| Stale ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-2981783017), [marcofleon](https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-3542072403) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-2912180479",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "labeled",
      "id": 17828722949,
      "node_id": "LE_lADOABII5864ZLtizwAAAAQmrLkF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17828722949",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-27T11:34:27Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "labeled",
      "id": 17829463926,
      "node_id": "LE_lADOABII5864ZLtizwAAAAQmuAd2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17829463926",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-27T12:21:50Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2870919331,
      "node_id": "PRR_kwDOABII586rHsCj",
      "url": null,
      "actor": null,
      "commit_id": "08b574dde2c5f13a4c9dadcb9d8bded158c59623",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-05-27T12:41:33Z",
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#pullrequestreview-2870919331",
      "submitted_at": "2025-05-27T12:41:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17830066594,
      "node_id": "HRFPE_lADOABII5864ZLtizwAAAAQmwTmi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17830066594",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "5f2fb4dd333f8d1db27c78414afc84454e6ee4a5",
      "commit_url": "https://api.github.com/repos/brunoerg/bitcoin/commits/5f2fb4dd333f8d1db27c78414afc84454e6ee4a5",
      "created_at": "2025-05-27T12:55:29Z"
    },
    {
      "event": "commented",
      "id": 2912418699,
      "node_id": "IC_kwDOABII586tl_uL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2912418699",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-27T12:56:50Z",
      "updated_at": "2025-05-27T12:56:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "08b574dde2c5f13a4c9dadcb9d8bded158c59623..5f2fb4dd333f8d1db27c78414afc84454e6ee4a5: Address https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2109086986",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-2912418699",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "unlabeled",
      "id": 17831169434,
      "node_id": "UNLE_lADOABII5864ZLtizwAAAAQm0g2a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17831169434",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-27T13:49:53Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2872882290,
      "node_id": "PRR_kwDOABII586rPLRy",
      "url": null,
      "actor": null,
      "commit_id": "5f2fb4dd333f8d1db27c78414afc84454e6ee4a5",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-05-27T22:26:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#pullrequestreview-2872882290",
      "submitted_at": "2025-05-27T22:26:25Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
    },
    {
      "event": "review_requested",
      "id": 18010732438,
      "node_id": "RRE_lADOABII5864ZLtizwAAAAQxhfeW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18010732438",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-05T21:39:46Z",
      "requested_reviewer": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18174842614,
      "node_id": "HRFPE_lADOABII5864ZLtizwAAAAQ7Thb2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18174842614",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "73439a78f355f7d37c20d07b8a2a9127c32ca637",
      "commit_url": "https://api.github.com/repos/brunoerg/bitcoin/commits/73439a78f355f7d37c20d07b8a2a9127c32ca637",
      "created_at": "2025-06-16T17:11:48Z"
    },
    {
      "event": "reviewed",
      "id": 2935740537,
      "node_id": "PRR_kwDOABII586u-9h5",
      "url": null,
      "actor": null,
      "commit_id": "73439a78f355f7d37c20d07b8a2a9127c32ca637",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-06-17T13:42:25Z",
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#pullrequestreview-2935740537",
      "submitted_at": "2025-06-17T13:42:25Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18194263448,
      "node_id": "HRFPE_lADOABII5864ZLtizwAAAAQ8dm2Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18194263448",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "commit_url": "https://api.github.com/repos/brunoerg/bitcoin/commits/6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "created_at": "2025-06-17T16:12:27Z"
    },
    {
      "event": "commented",
      "id": 2981783017,
      "node_id": "IC_kwDOABII586xumXp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2981783017",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-17T20:44:59Z",
      "updated_at": "2025-06-17T20:44:59Z",
      "author_association": "MEMBER",
      "body": "lgtm ACK 6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-2981783017",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "review_requested",
      "id": 18198144105,
      "node_id": "RRE_lADOABII5864ZLtizwAAAAQ8saRp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18198144105",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-17T20:45:03Z",
      "requested_reviewer": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_request_removed",
      "id": 20433792496,
      "node_id": "RRRE_lADOABII5864ZLtizwAAAATB8u3w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20433792496",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:12:35Z",
      "requested_reviewer": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 20433792545,
      "node_id": "RRE_lADOABII5864ZLtizwAAAATB8u4h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20433792545",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:12:35Z",
      "requested_reviewer": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 20433793717,
      "node_id": "RRE_lADOABII5864ZLtizwAAAATB8vK1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20433793717",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:12:39Z",
      "requested_reviewer": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 3384382564,
      "node_id": "PRR_kwDOABII587JuZRk",
      "url": null,
      "actor": null,
      "commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-27T16:26:48Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#pullrequestreview-3384382564",
      "submitted_at": "2025-10-27T16:26:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
    },
    {
      "event": "review_requested",
      "id": 20530393757,
      "node_id": "RRE_lADOABII5864ZLtizwAAAATHtPKd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20530393757",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T16:26:52Z",
      "requested_reviewer": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "closed",
      "id": 20530466744,
      "node_id": "CE_lADOABII5864ZLtizwAAAATHtg-4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20530466744",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T16:29:47Z"
    },
    {
      "event": "reopened",
      "id": 20530468190,
      "node_id": "REE_lADOABII5864ZLtizwAAAATHthVe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20530468190",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T16:29:51Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20531353641,
      "node_id": "HRFPE_lADOABII5864ZLtizwAAAATHw5gp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20531353641",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6ced804488d9eca4b3da8daa4e8c9145109b3384",
      "commit_url": "https://api.github.com/repos/brunoerg/bitcoin/commits/6ced804488d9eca4b3da8daa4e8c9145109b3384",
      "created_at": "2025-10-27T17:06:11Z"
    },
    {
      "event": "commented",
      "id": 3452454600,
      "node_id": "IC_kwDOABII587NyEbI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3452454600",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T17:16:58Z",
      "updated_at": "2025-10-27T17:16:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "Force-pushed addressing https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2466310562. Thanks, @marcofleon.",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-3452454600",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "mentioned",
      "id": 20531601037,
      "node_id": "MEE_lADOABII5864ZLtizwAAAATHx16N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20531601037",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T17:17:00Z"
    },
    {
      "event": "subscribed",
      "id": 20531601135,
      "node_id": "SE_lADOABII5864ZLtizwAAAATHx17v",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20531601135",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T17:17:00Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20532626017,
      "node_id": "HRFPE_lADOABII5864ZLtizwAAAATH1wJh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20532626017",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "commit_url": "https://api.github.com/repos/brunoerg/bitcoin/commits/6436ad7f2f93774cb719c89965800b51f546420c",
      "created_at": "2025-10-27T18:05:34Z"
    },
    {
      "event": "commented",
      "id": 3452644870,
      "node_id": "IC_kwDOABII587Nyy4G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3452644870",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-27T18:06:11Z",
      "updated_at": "2025-10-27T18:06:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "There was one more case that I forgot to count in. We should consider the split chain support when verifying the result (`desc_spkms`). Force-pushed fixing it ([6ced804](https://github.com/bitcoin/bitcoin/commit/6ced804488d9eca4b3da8daa4e8c9145109b3384) to [6436ad7](https://github.com/bitcoin/bitcoin/commit/6436ad7f2f93774cb719c89965800b51f546420c)). ",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-3452644870",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "labeled",
      "id": 20610072785,
      "node_id": "LE_lADOABII5864ZLtizwAAAATMdMDR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20610072785",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-30T13:56:14Z",
      "label": {
        "name": "Fuzzing",
        "color": "0e8a16"
      }
    },
    {
      "event": "reviewed",
      "id": 3457317631,
      "node_id": "PRR_kwDOABII587OEnr_",
      "url": null,
      "actor": null,
      "commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-13T04:52:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "Left some questions below.\n\nAlso, [coverage report](https://marcofleon.github.io/coverage/spkm_migration/) after about a day of fuzzing.",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#pullrequestreview-3457317631",
      "submitted_at": "2025-11-13T04:52:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20925666247,
      "node_id": "HRFPE_lADOABII5864ZLtizwAAAATfRFPH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20925666247",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6227441b782b50403571d3d97e8aa174c95fc511",
      "commit_url": "https://api.github.com/repos/brunoerg/bitcoin/commits/6227441b782b50403571d3d97e8aa174c95fc511",
      "created_at": "2025-11-13T19:40:42Z"
    },
    {
      "event": "commented",
      "id": 3529446791,
      "node_id": "IC_kwDOABII587SXxWH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3529446791",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-13T19:46:21Z",
      "updated_at": "2025-11-13T19:46:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "Force-pushed [6436ad7](https://github.com/bitcoin/bitcoin/commit/6436ad7f2f93774cb719c89965800b51f546420c) to [6227441](https://github.com/bitcoin/bitcoin/commit/6227441b782b50403571d3d97e8aa174c95fc511):\r\n\r\n- Added `PKHash` for `LoadWatchOnly`\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2521415641\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2521400460",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-3529446791",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "labeled",
      "id": 20926603015,
      "node_id": "LE_lADOABII5864ZLtizwAAAATfUp8H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20926603015",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-13T20:28:18Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20926767119,
      "node_id": "HRFPE_lADOABII5864ZLtizwAAAATfVSAP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20926767119",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "51917d94e657024cc0af8aa748a9d5d39a617e85",
      "commit_url": "https://api.github.com/repos/brunoerg/bitcoin/commits/51917d94e657024cc0af8aa748a9d5d39a617e85",
      "created_at": "2025-11-13T20:38:47Z"
    },
    {
      "event": "unlabeled",
      "id": 20927644583,
      "node_id": "UNLE_lADOABII5864ZLtizwAAAATfYoOn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20927644583",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-13T21:29:19Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3542072403,
      "node_id": "IC_kwDOABII587TH7xT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3542072403",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-17T14:17:46Z",
      "updated_at": "2025-11-17T14:17:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "Nice, lgtm ACK 51917d94e657024cc0af8aa748a9d5d39a617e85",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-3542072403",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "review_requested",
      "id": 20988470941,
      "node_id": "RRE_lADOABII5864ZLtizwAAAATjAqad",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20988470941",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-17T14:17:51Z",
      "requested_reviewer": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 3559651569,
      "node_id": "IC_kwDOABII587UK_jx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3559651569",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-20T19:16:39Z",
      "updated_at": "2025-11-20T19:16:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "@maflcko friendly review ping :)",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-3559651569",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "mentioned",
      "id": 21079412308,
      "node_id": "MEE_lADOABII5864ZLtizwAAAATobk5U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21079412308",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-20T19:16:41Z"
    },
    {
      "event": "subscribed",
      "id": 21079412346,
      "node_id": "SE_lADOABII5864ZLtizwAAAATobk56",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21079412346",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-20T19:16:41Z"
    },
    {
      "event": "reviewed",
      "id": 3642677281,
      "node_id": "PRR_kwDOABII587ZHtgh",
      "url": null,
      "actor": null,
      "commit_id": "51917d94e657024cc0af8aa748a9d5d39a617e85",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-09T07:56:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "Left a few observations and questions below.",
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#pullrequestreview-3642677281",
      "submitted_at": "2026-01-09T07:56:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
    },
    {
      "event": "labeled",
      "id": 22240379622,
      "node_id": "LE_lADOABII5864ZLtizwAAAAUtoULm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22240379622",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T11:23:28Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDNlYTE1ZmUwYjQ2MjQxN2ZmMTlkOTFiNTA0NjI2ZWUwNzIwOTE3NTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3ea15fe0b462417ff19d91b504626ee072091759",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3ea15fe0b462417ff19d91b504626ee072091759",
      "tree": {
        "sha": "9ecc8219da3571df387dbcdc023f50195b2d5d46",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9ecc8219da3571df387dbcdc023f50195b2d5d46"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5b8c204275aa1335fe9c336a2bd1d397b49a8ac6",
          "sha": "5b8c204275aa1335fe9c336a2bd1d397b49a8ac6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5b8c204275aa1335fe9c336a2bd1d397b49a8ac6"
        }
      ],
      "message": "fuzz: wallet: add target for `MigrateToDescriptor`",
      "committer": {
        "name": "Bruno Garcia",
        "email": "brunoely.gc@gmail.com",
        "date": "2026-01-23T16:03:39Z"
      },
      "author": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-03-09T09:22:50Z"
      },
      "sha": "3ea15fe0b462417ff19d91b504626ee072091759"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22246879199,
      "node_id": "HRFPE_lADOABII5864ZLtizwAAAAUuBG_f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22246879199",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "commit_url": "https://api.github.com/repos/brunoerg/bitcoin/commits/3ea15fe0b462417ff19d91b504626ee072091759",
      "created_at": "2026-01-23T16:03:53Z"
    },
    {
      "event": "commented",
      "id": 3790973124,
      "node_id": "IC_kwDOABII587h9ajE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3790973124",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T16:04:02Z",
      "updated_at": "2026-01-23T16:04:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased.",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#issuecomment-3790973124",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32624"
    },
    {
      "event": "unlabeled",
      "id": 22247172257,
      "node_id": "UNLE_lADOABII5864ZLtizwAAAAUuCOih",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22247172257",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T16:16:53Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2109086986",
      "pull_request_review_id": 2870919331,
      "id": 2109086986,
      "node_id": "PRRC_kwDOABII5859th0K",
      "diff_hunk": "@@ -50,6 +52,13 @@ void initialize_spkm()\n     MOCKED_DESC_CONVERTER.Init();\n }\n \n+void initialize_spkm_migration()\n+{\n+    static const auto testing_setup{MakeNoLogFileContext<const TestingSetup>()};\n+    g_setup = testing_setup.get();\n+    SelectParams(ChainType::MAIN);",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 18,
      "commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "original_commit_id": "08b574dde2c5f13a4c9dadcb9d8bded158c59623",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "why is this needed? Isn't the chain already `MAIN`?",
      "created_at": "2025-05-27T12:41:33Z",
      "updated_at": "2025-05-27T12:41:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2109086986",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2109086986"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2109117905",
      "pull_request_review_id": 2870965692,
      "id": 2109117905,
      "node_id": "PRRC_kwDOABII5859tpXR",
      "diff_hunk": "@@ -50,6 +52,13 @@ void initialize_spkm()\n     MOCKED_DESC_CONVERTER.Init();\n }\n \n+void initialize_spkm_migration()\n+{\n+    static const auto testing_setup{MakeNoLogFileContext<const TestingSetup>()};\n+    g_setup = testing_setup.get();\n+    SelectParams(ChainType::MAIN);",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 18,
      "commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "original_commit_id": "08b574dde2c5f13a4c9dadcb9d8bded158c59623",
      "in_reply_to_id": 2109086986,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Just removed it. Redudant.",
      "created_at": "2025-05-27T12:56:08Z",
      "updated_at": "2025-05-27T12:56:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2109117905",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2109117905"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2152315042",
      "pull_request_review_id": 2935740537,
      "id": 2152315042,
      "node_id": "PRRC_kwDOABII586ASbii",
      "diff_hunk": "@@ -205,5 +212,136 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+    WalletContext context;\n+    auto& args{g_setup->m_args};\n+    context.args = const_cast<ArgsManager*>(&args);\n+    context.chain = g_setup->m_node.chain.get();",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 41,
      "commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "original_commit_id": "73439a78f355f7d37c20d07b8a2a9127c32ca637",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "unused?",
      "created_at": "2025-06-17T13:42:25Z",
      "updated_at": "2025-06-17T13:42:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2152315042",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2152315042"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": 222,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2152663826",
      "pull_request_review_id": 2936300578,
      "id": 2152663826,
      "node_id": "PRRC_kwDOABII586ATwsS",
      "diff_hunk": "@@ -205,5 +212,136 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+    WalletContext context;\n+    auto& args{g_setup->m_args};\n+    context.args = const_cast<ArgsManager*>(&args);\n+    context.chain = g_setup->m_node.chain.get();",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 41,
      "commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "original_commit_id": "73439a78f355f7d37c20d07b8a2a9127c32ca637",
      "in_reply_to_id": 2152315042,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, thanks. It was a leftover from a previous approach, just removed it.",
      "created_at": "2025-06-17T16:13:08Z",
      "updated_at": "2025-06-17T16:13:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2152663826",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2152663826"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": 222,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2466295904",
      "pull_request_review_id": 3384382564,
      "id": 2466295904,
      "node_id": "PRRC_kwDOABII586TALBg",
      "diff_hunk": "@@ -205,5 +212,132 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key && !pub_key->IsFullyValid()) return;\n+    if (legacy_data.LoadWatchOnly(GetScriptForDestination(WitnessV0KeyHash{*pub_key}))) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};\n+    LIMITED_WHILE(good_data && fuzzed_data_provider.ConsumeBool(), 30) {\n+        CallOneOf(\n+            fuzzed_data_provider,\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                auto pub_key{key.GetPubKey()};\n+                CScript script;\n+                CallOneOf(\n+                    fuzzed_data_provider,\n+                    [&] {\n+                        script = GetScriptForDestination(CTxDestination{PKHash(pub_key)});\n+                    },\n+                    [&] {\n+                        script = GetScriptForDestination(WitnessV0KeyHash(pub_key));\n+                    },\n+                    [&] {\n+                        std::optional<CScript> script_opt{ConsumeDeserializable<CScript>(fuzzed_data_provider)};\n+                        if (!script_opt) {\n+                            good_data = false;\n+                            return;\n+                        }\n+                        script = script_opt.value();\n+                    }\n+                );\n+                if (fuzzed_data_provider.ConsumeBool()) script = GetScriptForDestination(ScriptHash(script));\n+                if (!legacy_data.HaveCScript(CScriptID(script)) && legacy_data.AddCScript(script)) added_script++;\n+            },\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                const auto num_keys{fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, MAX_PUBKEYS_PER_MULTISIG)};\n+                std::vector<CPubKey> pubkeys;\n+                pubkeys.emplace_back(key.GetPubKey());\n+                for (size_t i = 1; i < num_keys; i++) {\n+                    if (fuzzed_data_provider.ConsumeBool()) {\n+                        pubkeys.emplace_back(key.GetPubKey());\n+                    } else {\n+                        CKey private_key{ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool())};\n+                        if (!private_key.IsValid()) return;\n+                        pubkeys.emplace_back(private_key.GetPubKey());\n+                    }\n+                }\n+                if (pubkeys.size() < num_keys) return;\n+                CScript multisig_script{GetScriptForMultisig(num_keys, pubkeys)};\n+                if (!legacy_data.HaveCScript(CScriptID(multisig_script)) && legacy_data.AddCScript(multisig_script)) {\n+                    added_script++;\n+                }\n+            }\n+        );\n+    }\n+\n+    auto result{legacy_data.MigrateToDescriptor()};\n+    size_t added_size{keys.size() + static_cast<size_t>(add_hd_chain) + static_cast<size_t>(add_inactive_hd_chain)};\n+    if (added_script > 0) {\n+        assert(result->desc_spkms.size() >= added_size);\n+    } else {\n+        assert(result->desc_spkms.size() == added_size);",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 172,
      "original_position": 152,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "in_reply_to_id": null,
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "<details>\n<summary>immediate crash on this assertion here</summary>\n\n```bash\nfuzz: ../../../../src/wallet/test/fuzz/scriptpubkeyman.cpp:335: void wallet::(anonymous namespace)::spkm_migration_fuzz_target(FuzzBufferType): Assertion `result->desc_spkms.size() == added_size' failed.\n==1736884== ERROR: libFuzzer: deadly signal\n    #0 0x5650eb34b2a4 in __sanitizer_print_stack_trace (/root/bitcoin/fuzzbuild/bin/fuzz+0x9fd2a4) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #1 0x5650eb3211d8 in fuzzer::PrintStackTrace() (/root/bitcoin/fuzzbuild/bin/fuzz+0x9d31d8) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #2 0x5650eb3075f3 in fuzzer::Fuzzer::CrashCallback() (/root/bitcoin/fuzzbuild/bin/fuzz+0x9b95f3) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #3 0x7f07fa81d04f  (/lib/x86_64-linux-gnu/libc.so.6+0x3c04f) (BuildId: 58254ca972028402bc40624f81388d85ec95f70d)\n    #4 0x7f07fa86be2b  (/lib/x86_64-linux-gnu/libc.so.6+0x8ae2b) (BuildId: 58254ca972028402bc40624f81388d85ec95f70d)\n    #5 0x7f07fa81cfb1 in raise (/lib/x86_64-linux-gnu/libc.so.6+0x3bfb1) (BuildId: 58254ca972028402bc40624f81388d85ec95f70d)\n    #6 0x7f07fa807471 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x26471) (BuildId: 58254ca972028402bc40624f81388d85ec95f70d)\n    #7 0x7f07fa807394  (/lib/x86_64-linux-gnu/libc.so.6+0x26394) (BuildId: 58254ca972028402bc40624f81388d85ec95f70d)\n    #8 0x7f07fa815eb1 in __assert_fail (/lib/x86_64-linux-gnu/libc.so.6+0x34eb1) (BuildId: 58254ca972028402bc40624f81388d85ec95f70d)\n    #9 0x5650eb6cd1c5 in wallet::(anonymous namespace)::spkm_migration_fuzz_target(std::span<unsigned char const, 18446744073709551615ul>) /root/bitcoin/fuzzbuild/src/test/fuzz/../../../../src/wallet/test/fuzz/scriptpubkeyman.cpp:335:9\n    #10 0x5650eb6df861 in std::function<void (std::span<unsigned char const, 18446744073709551615ul>)>::operator()(std::span<unsigned char const, 18446744073709551615ul>) const /usr/bin/../lib/gcc/x86_64-linux-gnu/12/../../../../include/c++/12/bits/std_function.h:591:9\n    #11 0x5650eb6df861 in test_one_input(std::span<unsigned char const, 18446744073709551615ul>) /root/bitcoin/fuzzbuild/src/test/fuzz/util/../../../../../src/test/fuzz/fuzz.cpp:88:5\n    #12 0x5650eb6df861 in LLVMFuzzerTestOneInput /root/bitcoin/fuzzbuild/src/test/fuzz/util/../../../../../src/test/fuzz/fuzz.cpp:216:5\n    #13 0x5650eb308a00 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/root/bitcoin/fuzzbuild/bin/fuzz+0x9baa00) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #14 0x5650eb308135 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/root/bitcoin/fuzzbuild/bin/fuzz+0x9ba135) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #15 0x5650eb3098c5 in fuzzer::Fuzzer::MutateAndTestOne() (/root/bitcoin/fuzzbuild/bin/fuzz+0x9bb8c5) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #16 0x5650eb30a4c5 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/root/bitcoin/fuzzbuild/bin/fuzz+0x9bc4c5) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #17 0x5650eb2f86ef in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/root/bitcoin/fuzzbuild/bin/fuzz+0x9aa6ef) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #18 0x5650eb321aa2 in main (/root/bitcoin/fuzzbuild/bin/fuzz+0x9d3aa2) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n    #19 0x7f07fa808249  (/lib/x86_64-linux-gnu/libc.so.6+0x27249) (BuildId: 58254ca972028402bc40624f81388d85ec95f70d)\n    #20 0x7f07fa808304 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x27304) (BuildId: 58254ca972028402bc40624f81388d85ec95f70d)\n    #21 0x5650eb2edae0 in _start (/root/bitcoin/fuzzbuild/bin/fuzz+0x99fae0) (BuildId: 714ae02d0bf0aee30b5aead68737ef9e6f49c96a)\n\nNOTE: libFuzzer has rudimentary signal handlers.\n      Combine libFuzzer with AddressSanitizer or similar for better crash reports.\nSUMMARY: libFuzzer: deadly signal\nMS: 1 InsertByte-; base unit: 2068efd5f9f44e2724a628cd896cc4911f0f66a7\n0xff,0x0,0xfd,0xfb,0x0,0x0,0x0,0xd7,0x52,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x40,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x87,0x0,0x0,0x0,0x0,0x0,0x6f,0x0,0x0,0x13,0x87,0x87,0x87,0x87,0x28,\n\\377\\000\\375\\373\\000\\000\\000\\327R\\207\\207\\207\\207\\207\\207\\207\\207\\207@\\207\\207\\207\\207\\207\\207\\207\\207\\207\\207\\000\\000\\000\\000\\000o\\000\\000\\023\\207\\207\\207\\207(\nartifact_prefix='./'; Test unit written to ./crash-e661f705f50b682bb8c4b81ce95935565c579253\nBase64: /wD9+wAAANdSh4eHh4eHh4eHQIeHh4eHh4eHh4cAAAAAAG8AABOHh4eHKA==\n```\n\n</details>\n\nSomething being miscounted for `added_size` I would assume?",
      "created_at": "2025-10-27T16:21:24Z",
      "updated_at": "2025-10-27T16:26:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2466295904",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2466295904"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 337,
      "original_line": 337,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2466310562",
      "pull_request_review_id": 3384382564,
      "id": 2466310562,
      "node_id": "PRRC_kwDOABII586TAOmi",
      "diff_hunk": "@@ -205,5 +212,132 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key && !pub_key->IsFullyValid()) return;",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 80,
      "commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "original_commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "in_reply_to_id": null,
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Shouldn't this be `||`? Wouldn't want to dereference if `pub_key` is null.",
      "created_at": "2025-10-27T16:26:19Z",
      "updated_at": "2025-10-27T16:26:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2466310562",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2466310562"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2466434070",
      "pull_request_review_id": 3384578408,
      "id": 2466434070,
      "node_id": "PRRC_kwDOABII586TAswW",
      "diff_hunk": "@@ -205,5 +212,132 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key && !pub_key->IsFullyValid()) return;",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 80,
      "commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "original_commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "in_reply_to_id": 2466310562,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, nice find! ",
      "created_at": "2025-10-27T17:05:55Z",
      "updated_at": "2025-10-27T17:05:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2466434070",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2466434070"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2466463098",
      "pull_request_review_id": 3384622424,
      "id": 2466463098,
      "node_id": "PRRC_kwDOABII586TAz16",
      "diff_hunk": "@@ -205,5 +212,132 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key && !pub_key->IsFullyValid()) return;\n+    if (legacy_data.LoadWatchOnly(GetScriptForDestination(WitnessV0KeyHash{*pub_key}))) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};\n+    LIMITED_WHILE(good_data && fuzzed_data_provider.ConsumeBool(), 30) {\n+        CallOneOf(\n+            fuzzed_data_provider,\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                auto pub_key{key.GetPubKey()};\n+                CScript script;\n+                CallOneOf(\n+                    fuzzed_data_provider,\n+                    [&] {\n+                        script = GetScriptForDestination(CTxDestination{PKHash(pub_key)});\n+                    },\n+                    [&] {\n+                        script = GetScriptForDestination(WitnessV0KeyHash(pub_key));\n+                    },\n+                    [&] {\n+                        std::optional<CScript> script_opt{ConsumeDeserializable<CScript>(fuzzed_data_provider)};\n+                        if (!script_opt) {\n+                            good_data = false;\n+                            return;\n+                        }\n+                        script = script_opt.value();\n+                    }\n+                );\n+                if (fuzzed_data_provider.ConsumeBool()) script = GetScriptForDestination(ScriptHash(script));\n+                if (!legacy_data.HaveCScript(CScriptID(script)) && legacy_data.AddCScript(script)) added_script++;\n+            },\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                const auto num_keys{fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, MAX_PUBKEYS_PER_MULTISIG)};\n+                std::vector<CPubKey> pubkeys;\n+                pubkeys.emplace_back(key.GetPubKey());\n+                for (size_t i = 1; i < num_keys; i++) {\n+                    if (fuzzed_data_provider.ConsumeBool()) {\n+                        pubkeys.emplace_back(key.GetPubKey());\n+                    } else {\n+                        CKey private_key{ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool())};\n+                        if (!private_key.IsValid()) return;\n+                        pubkeys.emplace_back(private_key.GetPubKey());\n+                    }\n+                }\n+                if (pubkeys.size() < num_keys) return;\n+                CScript multisig_script{GetScriptForMultisig(num_keys, pubkeys)};\n+                if (!legacy_data.HaveCScript(CScriptID(multisig_script)) && legacy_data.AddCScript(multisig_script)) {\n+                    added_script++;\n+                }\n+            }\n+        );\n+    }\n+\n+    auto result{legacy_data.MigrateToDescriptor()};\n+    size_t added_size{keys.size() + static_cast<size_t>(add_hd_chain) + static_cast<size_t>(add_inactive_hd_chain)};\n+    if (added_script > 0) {\n+        assert(result->desc_spkms.size() >= added_size);\n+    } else {\n+        assert(result->desc_spkms.size() == added_size);",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 172,
      "original_position": 152,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "6d29c9a6d1b4239a0844791d4a53599ae3a79cd0",
      "in_reply_to_id": 2466295904,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Interesting how I didn't get it but I think this is related to https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2466310562. The check was wrong so it was playing with not-fully-valid keys. \r\n\r\nedit: there is one more reason I'm checking out.",
      "created_at": "2025-10-27T17:16:40Z",
      "updated_at": "2025-10-27T17:22:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2466463098",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2466463098"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 337,
      "original_line": 337,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2521400460",
      "pull_request_review_id": 3457317631,
      "id": 2521400460,
      "node_id": "PRRC_kwDOABII586WSYSM",
      "diff_hunk": "@@ -204,5 +211,137 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    if (legacy_data.LoadWatchOnly(GetScriptForDestination(WitnessV0KeyHash{*pub_key}))) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};\n+    LIMITED_WHILE(good_data && fuzzed_data_provider.ConsumeBool(), 30) {\n+        CallOneOf(\n+            fuzzed_data_provider,\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                auto pub_key{key.GetPubKey()};\n+                CScript script;\n+                CallOneOf(\n+                    fuzzed_data_provider,\n+                    [&] {\n+                        script = GetScriptForDestination(CTxDestination{PKHash(pub_key)});\n+                    },\n+                    [&] {\n+                        script = GetScriptForDestination(WitnessV0KeyHash(pub_key));\n+                    },\n+                    [&] {\n+                        std::optional<CScript> script_opt{ConsumeDeserializable<CScript>(fuzzed_data_provider)};\n+                        if (!script_opt) {\n+                            good_data = false;\n+                            return;\n+                        }\n+                        script = script_opt.value();\n+                    }\n+                );\n+                if (fuzzed_data_provider.ConsumeBool()) script = GetScriptForDestination(ScriptHash(script));\n+                if (!legacy_data.HaveCScript(CScriptID(script)) && legacy_data.AddCScript(script)) added_script++;\n+            },\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                const auto num_keys{fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, MAX_PUBKEYS_PER_MULTISIG)};\n+                std::vector<CPubKey> pubkeys;\n+                pubkeys.emplace_back(key.GetPubKey());\n+                for (size_t i = 1; i < num_keys; i++) {\n+                    if (fuzzed_data_provider.ConsumeBool()) {\n+                        pubkeys.emplace_back(key.GetPubKey());\n+                    } else {\n+                        CKey private_key{ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool())};\n+                        if (!private_key.IsValid()) return;\n+                        pubkeys.emplace_back(private_key.GetPubKey());\n+                    }\n+                }\n+                if (pubkeys.size() < num_keys) return;\n+                CScript multisig_script{GetScriptForMultisig(num_keys, pubkeys)};\n+                if (!legacy_data.HaveCScript(CScriptID(multisig_script)) && legacy_data.AddCScript(multisig_script)) {\n+                    added_script++;\n+                }\n+            }\n+        );\n+    }\n+\n+    auto result{legacy_data.MigrateToDescriptor()};\n+    auto hd_chain_version{legacy_data.GetHDChain().nVersion};",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 148,
      "commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "original_commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "in_reply_to_id": null,
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Adding this and modifying `added_chains` based on it does fix the crash I was seeing before. But shouldn't we save this variable before doing the migration? To make the assertion below actually verify the correctness. \n\nI haven't looked at the migration code in depth, so this might be fine. Just figured if we're checking `added_size` against the result then it's better if it's based on the pre-migration state.",
      "created_at": "2025-11-13T04:38:28Z",
      "updated_at": "2025-11-13T04:52:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2521400460",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2521400460"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 331,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2521415641",
      "pull_request_review_id": 3457317631,
      "id": 2521415641,
      "node_id": "PRRC_kwDOABII586WSb_Z",
      "diff_hunk": "@@ -204,5 +211,137 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    if (legacy_data.LoadWatchOnly(GetScriptForDestination(WitnessV0KeyHash{*pub_key}))) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};\n+    LIMITED_WHILE(good_data && fuzzed_data_provider.ConsumeBool(), 30) {\n+        CallOneOf(\n+            fuzzed_data_provider,\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                auto pub_key{key.GetPubKey()};\n+                CScript script;\n+                CallOneOf(\n+                    fuzzed_data_provider,\n+                    [&] {\n+                        script = GetScriptForDestination(CTxDestination{PKHash(pub_key)});\n+                    },\n+                    [&] {\n+                        script = GetScriptForDestination(WitnessV0KeyHash(pub_key));\n+                    },\n+                    [&] {\n+                        std::optional<CScript> script_opt{ConsumeDeserializable<CScript>(fuzzed_data_provider)};\n+                        if (!script_opt) {\n+                            good_data = false;\n+                            return;\n+                        }\n+                        script = script_opt.value();\n+                    }\n+                );\n+                if (fuzzed_data_provider.ConsumeBool()) script = GetScriptForDestination(ScriptHash(script));\n+                if (!legacy_data.HaveCScript(CScriptID(script)) && legacy_data.AddCScript(script)) added_script++;\n+            },\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                const auto num_keys{fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, MAX_PUBKEYS_PER_MULTISIG)};\n+                std::vector<CPubKey> pubkeys;\n+                pubkeys.emplace_back(key.GetPubKey());\n+                for (size_t i = 1; i < num_keys; i++) {\n+                    if (fuzzed_data_provider.ConsumeBool()) {\n+                        pubkeys.emplace_back(key.GetPubKey());\n+                    } else {\n+                        CKey private_key{ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool())};\n+                        if (!private_key.IsValid()) return;\n+                        pubkeys.emplace_back(private_key.GetPubKey());\n+                    }\n+                }\n+                if (pubkeys.size() < num_keys) return;\n+                CScript multisig_script{GetScriptForMultisig(num_keys, pubkeys)};\n+                if (!legacy_data.HaveCScript(CScriptID(multisig_script)) && legacy_data.AddCScript(multisig_script)) {\n+                    added_script++;\n+                }\n+            }\n+        );\n+    }\n+\n+    auto result{legacy_data.MigrateToDescriptor()};",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 162,
      "original_position": 147,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "in_reply_to_id": null,
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "No null check after this? Doesn't seem to ever return null based on the coverage report, but could still be worth having to avoid potential undefined behavior.",
      "created_at": "2025-11-13T04:43:24Z",
      "updated_at": "2025-11-13T04:52:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2521415641",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2521415641"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 327,
      "original_line": 327,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2521443581",
      "pull_request_review_id": 3457317631,
      "id": 2521443581,
      "node_id": "PRRC_kwDOABII586WSiz9",
      "diff_hunk": "@@ -204,5 +211,137 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    if (legacy_data.LoadWatchOnly(GetScriptForDestination(WitnessV0KeyHash{*pub_key}))) watch_only = true;",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 81,
      "commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "original_commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "in_reply_to_id": null,
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Is it worth testing other script types here as well? Not super familiar with the wallet code, so disregard if irrelevant.",
      "created_at": "2025-11-13T04:50:52Z",
      "updated_at": "2025-11-13T04:52:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2521443581",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2521443581"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2523702039",
      "pull_request_review_id": 3460089034,
      "id": 2523702039,
      "node_id": "PRRC_kwDOABII586WbKMX",
      "diff_hunk": "@@ -204,5 +211,137 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    if (legacy_data.LoadWatchOnly(GetScriptForDestination(WitnessV0KeyHash{*pub_key}))) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};\n+    LIMITED_WHILE(good_data && fuzzed_data_provider.ConsumeBool(), 30) {\n+        CallOneOf(\n+            fuzzed_data_provider,\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                auto pub_key{key.GetPubKey()};\n+                CScript script;\n+                CallOneOf(\n+                    fuzzed_data_provider,\n+                    [&] {\n+                        script = GetScriptForDestination(CTxDestination{PKHash(pub_key)});\n+                    },\n+                    [&] {\n+                        script = GetScriptForDestination(WitnessV0KeyHash(pub_key));\n+                    },\n+                    [&] {\n+                        std::optional<CScript> script_opt{ConsumeDeserializable<CScript>(fuzzed_data_provider)};\n+                        if (!script_opt) {\n+                            good_data = false;\n+                            return;\n+                        }\n+                        script = script_opt.value();\n+                    }\n+                );\n+                if (fuzzed_data_provider.ConsumeBool()) script = GetScriptForDestination(ScriptHash(script));\n+                if (!legacy_data.HaveCScript(CScriptID(script)) && legacy_data.AddCScript(script)) added_script++;\n+            },\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                const auto num_keys{fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, MAX_PUBKEYS_PER_MULTISIG)};\n+                std::vector<CPubKey> pubkeys;\n+                pubkeys.emplace_back(key.GetPubKey());\n+                for (size_t i = 1; i < num_keys; i++) {\n+                    if (fuzzed_data_provider.ConsumeBool()) {\n+                        pubkeys.emplace_back(key.GetPubKey());\n+                    } else {\n+                        CKey private_key{ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool())};\n+                        if (!private_key.IsValid()) return;\n+                        pubkeys.emplace_back(private_key.GetPubKey());\n+                    }\n+                }\n+                if (pubkeys.size() < num_keys) return;\n+                CScript multisig_script{GetScriptForMultisig(num_keys, pubkeys)};\n+                if (!legacy_data.HaveCScript(CScriptID(multisig_script)) && legacy_data.AddCScript(multisig_script)) {\n+                    added_script++;\n+                }\n+            }\n+        );\n+    }\n+\n+    auto result{legacy_data.MigrateToDescriptor()};\n+    auto hd_chain_version{legacy_data.GetHDChain().nVersion};",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 148,
      "commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "original_commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "in_reply_to_id": 2521400460,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Nice catch, we can simply check `hd_chain.nVersion` instead of having `auto hd_chain_version{legacy_data.GetHDChain().nVersion};`. We could also add an assert to ensure these two values are the same.",
      "created_at": "2025-11-13T14:31:33Z",
      "updated_at": "2025-11-13T14:31:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2523702039",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2523702039"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 331,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2523711918",
      "pull_request_review_id": 3460102954,
      "id": 2523711918,
      "node_id": "PRRC_kwDOABII586WbMmu",
      "diff_hunk": "@@ -204,5 +211,137 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    if (legacy_data.LoadWatchOnly(GetScriptForDestination(WitnessV0KeyHash{*pub_key}))) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};\n+    LIMITED_WHILE(good_data && fuzzed_data_provider.ConsumeBool(), 30) {\n+        CallOneOf(\n+            fuzzed_data_provider,\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                auto pub_key{key.GetPubKey()};\n+                CScript script;\n+                CallOneOf(\n+                    fuzzed_data_provider,\n+                    [&] {\n+                        script = GetScriptForDestination(CTxDestination{PKHash(pub_key)});\n+                    },\n+                    [&] {\n+                        script = GetScriptForDestination(WitnessV0KeyHash(pub_key));\n+                    },\n+                    [&] {\n+                        std::optional<CScript> script_opt{ConsumeDeserializable<CScript>(fuzzed_data_provider)};\n+                        if (!script_opt) {\n+                            good_data = false;\n+                            return;\n+                        }\n+                        script = script_opt.value();\n+                    }\n+                );\n+                if (fuzzed_data_provider.ConsumeBool()) script = GetScriptForDestination(ScriptHash(script));\n+                if (!legacy_data.HaveCScript(CScriptID(script)) && legacy_data.AddCScript(script)) added_script++;\n+            },\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                const auto num_keys{fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, MAX_PUBKEYS_PER_MULTISIG)};\n+                std::vector<CPubKey> pubkeys;\n+                pubkeys.emplace_back(key.GetPubKey());\n+                for (size_t i = 1; i < num_keys; i++) {\n+                    if (fuzzed_data_provider.ConsumeBool()) {\n+                        pubkeys.emplace_back(key.GetPubKey());\n+                    } else {\n+                        CKey private_key{ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool())};\n+                        if (!private_key.IsValid()) return;\n+                        pubkeys.emplace_back(private_key.GetPubKey());\n+                    }\n+                }\n+                if (pubkeys.size() < num_keys) return;\n+                CScript multisig_script{GetScriptForMultisig(num_keys, pubkeys)};\n+                if (!legacy_data.HaveCScript(CScriptID(multisig_script)) && legacy_data.AddCScript(multisig_script)) {\n+                    added_script++;\n+                }\n+            }\n+        );\n+    }\n+\n+    auto result{legacy_data.MigrateToDescriptor()};",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 162,
      "original_position": 147,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "in_reply_to_id": 2521415641,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "No null check because we always expect it to succeed given how the harness is built, but will add a check just to avoid UB.",
      "created_at": "2025-11-13T14:34:07Z",
      "updated_at": "2025-11-13T14:34:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2523711918",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2523711918"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 327,
      "original_line": 327,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2524678860",
      "pull_request_review_id": 3461345558,
      "id": 2524678860,
      "node_id": "PRRC_kwDOABII586We4rM",
      "diff_hunk": "@@ -204,5 +211,137 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    if (legacy_data.LoadWatchOnly(GetScriptForDestination(WitnessV0KeyHash{*pub_key}))) watch_only = true;",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 1,
      "original_position": 81,
      "commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "original_commit_id": "6436ad7f2f93774cb719c89965800b51f546420c",
      "in_reply_to_id": 2521443581,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I can also add `PKHash`, but for watch only loading I don't think worth adding more types. Wouldn't reflect its usage in practice.",
      "created_at": "2025-11-13T19:28:13Z",
      "updated_at": "2025-11-13T19:28:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2524678860",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2524678860"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675106949",
      "pull_request_review_id": 3642677281,
      "id": 2675106949,
      "node_id": "PRRC_kwDOABII586fcuSF",
      "diff_hunk": "@@ -204,5 +211,142 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 43,
      "original_position": 33,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "51917d94e657024cc0af8aa748a9d5d39a617e85",
      "in_reply_to_id": null,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`SeedRandomStateForTest(SeedRand::ZEROS)` call appears to be unused in this target. Or is there something I am not seeing?",
      "created_at": "2026-01-09T07:13:38Z",
      "updated_at": "2026-01-09T07:56:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2675106949",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675106949"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 208,
      "original_line": 208,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675130592",
      "pull_request_review_id": 3642677281,
      "id": 2675130592,
      "node_id": "PRRC_kwDOABII586fc0Dg",
      "diff_hunk": "@@ -204,5 +211,142 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    auto version{fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE};\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = version;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    auto script_dest{GetScriptForDestination(WitnessV0KeyHash{*pub_key})};\n+    if (fuzzed_data_provider.ConsumeBool()) {\n+        script_dest = GetScriptForDestination(CTxDestination{PKHash(*pub_key)});\n+    }\n+    if (legacy_data.LoadWatchOnly(script_dest)) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 99,
      "original_position": 89,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "51917d94e657024cc0af8aa748a9d5d39a617e85",
      "in_reply_to_id": null,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "'good_data' is only cleared when a custom script deserialization fails. other failures leave it true(like when `AddCScript` returns false).  \r\nIs it intentional to leave a potentially incomplete state in those other cases?",
      "created_at": "2026-01-09T07:24:17Z",
      "updated_at": "2026-01-09T07:56:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2675130592",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675130592"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 264,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675190688",
      "pull_request_review_id": 3642677281,
      "id": 2675190688,
      "node_id": "PRRC_kwDOABII586fdCug",
      "diff_hunk": "@@ -204,5 +211,142 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    auto version{fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE};\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = version;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    auto script_dest{GetScriptForDestination(WitnessV0KeyHash{*pub_key})};\n+    if (fuzzed_data_provider.ConsumeBool()) {\n+        script_dest = GetScriptForDestination(CTxDestination{PKHash(*pub_key)});\n+    }\n+    if (legacy_data.LoadWatchOnly(script_dest)) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};\n+    LIMITED_WHILE(good_data && fuzzed_data_provider.ConsumeBool(), 30) {\n+        CallOneOf(\n+            fuzzed_data_provider,\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                auto pub_key{key.GetPubKey()};\n+                CScript script;\n+                CallOneOf(\n+                    fuzzed_data_provider,\n+                    [&] {\n+                        script = GetScriptForDestination(CTxDestination{PKHash(pub_key)});\n+                    },\n+                    [&] {\n+                        script = GetScriptForDestination(WitnessV0KeyHash(pub_key));\n+                    },\n+                    [&] {\n+                        std::optional<CScript> script_opt{ConsumeDeserializable<CScript>(fuzzed_data_provider)};\n+                        if (!script_opt) {\n+                            good_data = false;\n+                            return;\n+                        }\n+                        script = script_opt.value();\n+                    }\n+                );\n+                if (fuzzed_data_provider.ConsumeBool()) script = GetScriptForDestination(ScriptHash(script));\n+                if (!legacy_data.HaveCScript(CScriptID(script)) && legacy_data.AddCScript(script)) added_script++;\n+            },\n+            [&] {\n+                CKey key;\n+                if (!keys.empty()) {\n+                    key = PickValue(fuzzed_data_provider, keys);\n+                } else {\n+                    key = ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool());\n+                }\n+                if (!key.IsValid()) return;\n+                const auto num_keys{fuzzed_data_provider.ConsumeIntegralInRange<size_t>(1, MAX_PUBKEYS_PER_MULTISIG)};\n+                std::vector<CPubKey> pubkeys;\n+                pubkeys.emplace_back(key.GetPubKey());\n+                for (size_t i = 1; i < num_keys; i++) {\n+                    if (fuzzed_data_provider.ConsumeBool()) {\n+                        pubkeys.emplace_back(key.GetPubKey());\n+                    } else {\n+                        CKey private_key{ConsumePrivateKey(fuzzed_data_provider, /*compressed=*/fuzzed_data_provider.ConsumeBool())};\n+                        if (!private_key.IsValid()) return;\n+                        pubkeys.emplace_back(private_key.GetPubKey());\n+                    }\n+                }\n+                if (pubkeys.size() < num_keys) return;\n+                CScript multisig_script{GetScriptForMultisig(num_keys, pubkeys)};\n+                if (!legacy_data.HaveCScript(CScriptID(multisig_script)) && legacy_data.AddCScript(multisig_script)) {\n+                    added_script++;\n+                }\n+            }\n+        );\n+    }\n+\n+    auto result{legacy_data.MigrateToDescriptor()};\n+    assert(result);\n+    size_t added_chains{static_cast<size_t>(add_hd_chain) + static_cast<size_t>(add_inactive_hd_chain)};\n+    if ((add_hd_chain && version >= CHDChain::VERSION_HD_CHAIN_SPLIT) || (!add_hd_chain && add_inactive_hd_chain)) {",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 165,
      "original_position": 155,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "51917d94e657024cc0af8aa748a9d5d39a617e85",
      "in_reply_to_id": null,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There might be a small issue with how `version` is used in the assertion here. The `version` variable is initialized at line 244 and only assigned to the active HD chain when `add_hd_chain` is true (line 249). However, when `add_inactive_hd_chain` is true, the inactive chain gets its own version choice at line 257.\r\n\r\nChallenge arises when `add_hd_chain` is false but `add_inactive_hd_chain` is true. In this scenario, condition `(!add_hd_chain && add_inactive_hd_chain)` would trigger `added_chains *= 2`, but this doesn't account for whether the `inactive` chain's version is actually VERSION_HD_CHAIN_SPLIT or not , as it just assumes any inactive chain should double the count.\r\n\r\nIf you consider or think that these sequence of events might cause assertion miscalculations then maybe a solution might be store and checking the inactive chain's version separately or checking `hd_chain.nVersion` directly after it's set. \r\n",
      "created_at": "2026-01-09T07:48:32Z",
      "updated_at": "2026-01-09T08:00:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2675190688",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2675190688"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 330,
      "original_line": 330,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2677672120",
      "pull_request_review_id": 3645623686,
      "id": 2677672120,
      "node_id": "PRRC_kwDOABII586fmgi4",
      "diff_hunk": "@@ -204,5 +211,142 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    auto version{fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE};\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = version;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    auto script_dest{GetScriptForDestination(WitnessV0KeyHash{*pub_key})};\n+    if (fuzzed_data_provider.ConsumeBool()) {\n+        script_dest = GetScriptForDestination(CTxDestination{PKHash(*pub_key)});\n+    }\n+    if (legacy_data.LoadWatchOnly(script_dest)) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 99,
      "original_position": 89,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "51917d94e657024cc0af8aa748a9d5d39a617e85",
      "in_reply_to_id": 2675130592,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, see https://github.com/bitcoin/bitcoin/pull/28815.",
      "created_at": "2026-01-09T21:29:02Z",
      "updated_at": "2026-01-09T21:29:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2677672120",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2677672120"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 264,
      "original_line": 264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2677676453",
      "pull_request_review_id": 3645628387,
      "id": 2677676453,
      "node_id": "PRRC_kwDOABII586fmhml",
      "diff_hunk": "@@ -204,5 +211,142 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 43,
      "original_position": 33,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "51917d94e657024cc0af8aa748a9d5d39a617e85",
      "in_reply_to_id": 2675106949,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What do you mean with unused? It is to avoid instability when it is using the global random state.",
      "created_at": "2026-01-09T21:31:18Z",
      "updated_at": "2026-01-09T21:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2677676453",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2677676453"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 208,
      "original_line": 208,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2680962023",
      "pull_request_review_id": 3649267060,
      "id": 2680962023,
      "node_id": "PRRC_kwDOABII586fzDvn",
      "diff_hunk": "@@ -204,5 +211,142 @@ FUZZ_TARGET(scriptpubkeyman, .init = initialize_spkm)\n     (void)spk_manager->GetKeyPoolSize();\n }\n \n+FUZZ_TARGET(spkm_migration, .init = initialize_spkm_migration)\n+{\n+    SeedRandomStateForTest(SeedRand::ZEROS);\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+    const auto& node{g_setup->m_node};\n+    Chainstate& chainstate{node.chainman->ActiveChainstate()};\n+\n+    std::unique_ptr<CWallet> wallet_ptr{std::make_unique<CWallet>(node.chain.get(), \"\", CreateMockableWalletDatabase())};\n+    wallet_ptr->chainStateFlushed(ChainstateRole::NORMAL, CBlockLocator{});\n+    CWallet& wallet{*wallet_ptr};\n+    wallet.m_keypool_size = 1;\n+    {\n+        LOCK(wallet.cs_wallet);\n+        wallet.UnsetWalletFlag(WALLET_FLAG_DESCRIPTORS);\n+        wallet.SetLastBlockProcessed(chainstate.m_chain.Height(), chainstate.m_chain.Tip()->GetBlockHash());\n+    }\n+\n+    auto& legacy_data{*wallet.GetOrCreateLegacyDataSPKM()};\n+\n+    std::vector<CKey> keys;\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 30) {\n+        const auto key{ConsumePrivateKey(fuzzed_data_provider)};\n+        if (!key.IsValid()) return;\n+        auto pub_key{key.GetPubKey()};\n+        if (!pub_key.IsFullyValid()) return;\n+        if (legacy_data.LoadKey(key, pub_key) && std::find(keys.begin(), keys.end(), key) == keys.end()) keys.push_back(key);\n+    }\n+\n+    bool add_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    CHDChain hd_chain;\n+    auto version{fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE};\n+    CKey hd_key;\n+    if (add_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = version;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.LoadHDChain(hd_chain);\n+    }\n+\n+    bool add_inactive_hd_chain{fuzzed_data_provider.ConsumeBool() && !keys.empty()};\n+    if (add_inactive_hd_chain) {\n+        hd_key = PickValue(fuzzed_data_provider, keys);\n+        hd_chain.nVersion = fuzzed_data_provider.ConsumeBool() ? CHDChain::VERSION_HD_CHAIN_SPLIT : CHDChain::VERSION_HD_BASE;\n+        hd_chain.seed_id = hd_key.GetPubKey().GetID();\n+        legacy_data.AddInactiveHDChain(hd_chain);\n+    }\n+\n+    bool watch_only = false;\n+    const auto pub_key = ConsumeDeserializable<CPubKey>(fuzzed_data_provider);\n+    if (!pub_key || !pub_key->IsFullyValid()) return;\n+    auto script_dest{GetScriptForDestination(WitnessV0KeyHash{*pub_key})};\n+    if (fuzzed_data_provider.ConsumeBool()) {\n+        script_dest = GetScriptForDestination(CTxDestination{PKHash(*pub_key)});\n+    }\n+    if (legacy_data.LoadWatchOnly(script_dest)) watch_only = true;\n+\n+    size_t added_script{0};\n+    bool good_data{true};",
      "path": "src/wallet/test/fuzz/scriptpubkeyman.cpp",
      "position": 99,
      "original_position": 89,
      "commit_id": "3ea15fe0b462417ff19d91b504626ee072091759",
      "original_commit_id": "51917d94e657024cc0af8aa748a9d5d39a617e85",
      "in_reply_to_id": 2675130592,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Did not know that. Thanks for the context.",
      "created_at": "2026-01-12T05:59:33Z",
      "updated_at": "2026-01-12T05:59:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32624#discussion_r2680962023",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2680962023"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32624"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 264,
      "original_line": 264,
      "side": "RIGHT"
    }
  ]
}