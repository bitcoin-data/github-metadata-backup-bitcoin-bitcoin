{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845",
    "id": 20767925,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MjA3Njc5MjU=",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/4845",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/4845.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/4845.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
    "number": 4845,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "Switch testing framework from MAIN to new UNITTEST network",
    "user": {
      "login": "SergioDemianLerner",
      "id": 1752347,
      "node_id": "MDQ6VXNlcjE3NTIzNDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SergioDemianLerner",
      "html_url": "https://github.com/SergioDemianLerner",
      "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
      "following_url": "https://api.github.com/users/SergioDemianLerner/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/SergioDemianLerner/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/SergioDemianLerner/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
      "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
      "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
      "events_url": "https://api.github.com/users/SergioDemianLerner/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is our third attempt to improve the testing framework taking into account all previous comments and suggestions. The two previous attempts are: pull requests #4688 and #4732.\n\nSummary: For several reasons the current test framework does not allow to easily incorporate new unit tests that append specially crafted blocks to the blockchain using ProcessBlock().\nAfter we proposed a solution in #4688 @gmaxwell and @laanwj suggested not implementing the changes because many files not directly related to the testing framework were modified by the patch.\nIn the pull request #4732 we implement @gmaxwell suggestion that the test framework should run under the RegTest network parameters and not under the main network parameters. It was discovered that 10 unit cases are designed for the MAIN net, RegTest inherits from TestNet, which has many differences, so switching is not simple nor desired. @mikehearn and @laanwj proposed using a special new network called UNITTEST to be as similar to the real net as possible. We implemented this final suggestion.\n\nIn this pull request we implement UNITTEST. We reintroduced the criticized possibility to disable PoW check, but we did it under Params().SkipProofOfWorkCheck(). This method is a const virtual function that returns false for MAIN net, so there is no possibility that it is switched to true, under normal circumstances. This change does not extend the attack surface in any way.\n\nThe child network UNITTEST overrides SkipProofOfWorkCheck() to provide the skipping functionality.\nTo allow test cases to modify network parameters, we've added the ModifiableParams() global variable and associated abstract interface, with setters. These setters are only available if the current network is UNITTEST. Again, there is no way to modify the network parameters if the current network is not UNITTEST.\n\nAs in the previous pull requests, we've:\n\na. fixed the bug in miner_tests.cpp which leaves in the memory pool invalid transactions (mempool.clear() missing).\nb. Added 7 unit tests:\n\nToCheckBlockUpgradeMajority (untested before)\nEnforceBlockUpgradeMajority (untested before)\nRejectBlockOutdatedMajority (untested before)\n\"bad-cb-height\"\n\"bad-version\"\n\"time-too-old\"\n\"bad-txns-nonfinal\"\n\nSergio Demian Lerner & Timo Hanke\n",
    "labels": [],
    "active_lock_reason": "resolved",
    "created_at": "2014-09-04T19:46:54Z",
    "updated_at": "2021-09-08T10:41:18Z",
    "closed_at": "2014-10-08T07:11:23Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merge_commit_sha": "e481efe165d9a05c1c0edc09d4d6f1135b4b2486",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "UnitTest:master",
      "ref": "master",
      "sha": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "user": {
        "login": "UnitTest",
        "id": 8619840,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjg2MTk4NDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8619840?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/UnitTest",
        "html_url": "https://github.com/UnitTest",
        "followers_url": "https://api.github.com/users/UnitTest/followers",
        "following_url": "https://api.github.com/users/UnitTest/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/UnitTest/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/UnitTest/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/UnitTest/subscriptions",
        "organizations_url": "https://api.github.com/users/UnitTest/orgs",
        "repos_url": "https://api.github.com/users/UnitTest/repos",
        "events_url": "https://api.github.com/users/UnitTest/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/UnitTest/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 23556368,
        "node_id": "MDEwOlJlcG9zaXRvcnkyMzU1NjM2OA==",
        "name": "bitcoin",
        "full_name": "UnitTest/bitcoin",
        "owner": {
          "login": "UnitTest",
          "id": 8619840,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjg2MTk4NDA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8619840?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/UnitTest",
          "html_url": "https://github.com/UnitTest",
          "followers_url": "https://api.github.com/users/UnitTest/followers",
          "following_url": "https://api.github.com/users/UnitTest/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/UnitTest/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/UnitTest/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/UnitTest/subscriptions",
          "organizations_url": "https://api.github.com/users/UnitTest/orgs",
          "repos_url": "https://api.github.com/users/UnitTest/repos",
          "events_url": "https://api.github.com/users/UnitTest/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/UnitTest/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/UnitTest/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/UnitTest/bitcoin",
        "archive_url": "https://api.github.com/repos/UnitTest/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/UnitTest/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/UnitTest/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/UnitTest/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/UnitTest/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/UnitTest/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/UnitTest/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/UnitTest/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/UnitTest/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/UnitTest/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/UnitTest/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/UnitTest/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/UnitTest/bitcoin/events",
        "forks_url": "https://api.github.com/repos/UnitTest/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/UnitTest/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/UnitTest/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/UnitTest/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/UnitTest/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/UnitTest/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/UnitTest/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/UnitTest/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/UnitTest/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/UnitTest/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/UnitTest/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/UnitTest/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/UnitTest/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/UnitTest/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/UnitTest/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/UnitTest/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:UnitTest/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/UnitTest/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/UnitTest/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/UnitTest/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/UnitTest/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/UnitTest/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/UnitTest/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/UnitTest/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/UnitTest/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/UnitTest/bitcoin/hooks",
        "svn_url": "https://github.com/UnitTest/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "TypeScript",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 36825,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2014-09-09T16:31:15Z",
        "created_at": "2014-09-01T21:33:28Z",
        "updated_at": "2018-08-21T19:00:40Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "b4cd0975fbc93063473a4d9a09e2b2fe3c4ad489",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35474,
        "stargazers_count": 70605,
        "watchers_count": 70605,
        "size": 236222,
        "default_branch": "master",
        "open_issues_count": 667,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-02T12:42:51Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-08-02T13:04:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 371,
    "deletions": 4,
    "changed_files": 12,
    "commits": 2,
    "review_comments": 18,
    "comments": 11
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNTdjMzVjYjQ3YTJhYTZjZWFlNmM4N2E4Mzg2YmIxZWExODZmNmQ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "tree": {
        "sha": "34b0b63b9f1ba41f255e28ca0ca8eda8d0be2c44",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/34b0b63b9f1ba41f255e28ca0ca8eda8d0be2c44"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2e731f24b5a5c894e013a6d752f1cd409303e916",
          "sha": "2e731f24b5a5c894e013a6d752f1cd409303e916",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2e731f24b5a5c894e013a6d752f1cd409303e916"
        }
      ],
      "message": "Switch testing framework from MAIN to new UNITTEST network\n\nUNITTEST inherites from MAIN but allows synamically changing its parameters using the ModifiableParams() interface",
      "committer": {
        "name": "SergioDemianLerner",
        "email": "Sergio.d.Lerner@gmail.com",
        "date": "2014-09-04T19:23:42Z"
      },
      "author": {
        "name": "SergioDemianLerner",
        "email": "Sergio.d.Lerner@gmail.com",
        "date": "2014-09-04T19:23:42Z"
      },
      "sha": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5"
    },
    {
      "event": "mentioned",
      "id": 161401333,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTYxNDAxMzMz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/161401333",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-04T19:46:54Z"
    },
    {
      "event": "subscribed",
      "id": 161401334,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE2MTQwMTMzNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/161401334",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-04T19:46:54Z"
    },
    {
      "event": "mentioned",
      "id": 161401335,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTYxNDAxMzM1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/161401335",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-04T19:46:54Z"
    },
    {
      "event": "subscribed",
      "id": 161401336,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE2MTQwMTMzNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/161401336",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-04T19:46:54Z"
    },
    {
      "event": "mentioned",
      "id": 161401337,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTYxNDAxMzM3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/161401337",
      "actor": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-04T19:46:54Z"
    },
    {
      "event": "subscribed",
      "id": 161401338,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE2MTQwMTMzOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/161401338",
      "actor": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-04T19:46:54Z"
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NDc6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NDk6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NTI6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NTQ6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NTg6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NjA6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NjQ6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NjY6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1Njg6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMTU1MzM1NzA6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "commented",
      "id": 54606011,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU0NjA2MDEx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/54606011",
      "actor": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-05T09:57:53Z",
      "updated_at": "2014-09-05T09:57:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "Looking good! Most of my comments are minor style points. :+1: \n",
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-54606011",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZGE0YWExOWQzY2FmYzE2NDRmNWMyOGM2ODc3NDFhNmMyNTViOWE2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "tree": {
        "sha": "06da96093a4c7d6179791ea2e0a087fb3c23795f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/06da96093a4c7d6179791ea2e0a087fb3c23795f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
          "sha": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5"
        }
      ],
      "message": "Suggested corrections on comments, variable names.\nAlso new test case testing the PoW skip in UNITTEST.",
      "committer": {
        "name": "SergioDemianLerner",
        "email": "Sergio.d.Lerner@gmail.com",
        "date": "2014-09-09T16:29:24Z"
      },
      "author": {
        "name": "SergioDemianLerner",
        "email": "Sergio.d.Lerner@gmail.com",
        "date": "2014-09-09T16:29:24Z"
      },
      "sha": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6"
    },
    {
      "event": "commented",
      "id": 54999007,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU0OTk5MDA3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/54999007",
      "actor": {
        "login": "BitcoinPullTester",
        "id": 2110907,
        "node_id": "MDQ6VXNlcjIxMTA5MDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2110907?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BitcoinPullTester",
        "html_url": "https://github.com/BitcoinPullTester",
        "followers_url": "https://api.github.com/users/BitcoinPullTester/followers",
        "following_url": "https://api.github.com/users/BitcoinPullTester/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BitcoinPullTester/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BitcoinPullTester/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BitcoinPullTester/subscriptions",
        "organizations_url": "https://api.github.com/users/BitcoinPullTester/orgs",
        "repos_url": "https://api.github.com/users/BitcoinPullTester/repos",
        "events_url": "https://api.github.com/users/BitcoinPullTester/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BitcoinPullTester/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-09T16:40:52Z",
      "updated_at": "2014-09-09T16:40:52Z",
      "author_association": "NONE",
      "body": "Automatic sanity-testing: FAILED BUILD/TEST, see http://jenkins.bluematt.me/pull-tester/p4845_eda4aa19d3cafc1644f5c28c687741a6c255b9a6/ for binaries and test log.\n\nThis could happen for one of several reasons:\n1. It chanages paths in makefile.linux-mingw or otherwise changes build scripts in a way that made them incompatible with the automated testing scripts (please tweak those patches in qa/pull-tester)\n2. It adds/modifies tests which test network rules (thanks for doing that), which conflicts with a patch applied at test time\n3. It does not build on either Linux i386 or Win32 (via MinGW cross compile)\n4. The test suite fails on either Linux i386 or Win32\n5. The block test-cases failed (lookup the first bNN identifier which failed in https://github.com/TheBlueMatt/test-scripts/blob/master/FullBlockTestGenerator.java)\n\nIf you believe this to be in error, please ping BlueMatt on freenode or TheBlueMatt here.\n\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.\n",
      "user": {
        "login": "BitcoinPullTester",
        "id": 2110907,
        "node_id": "MDQ6VXNlcjIxMTA5MDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2110907?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BitcoinPullTester",
        "html_url": "https://github.com/BitcoinPullTester",
        "followers_url": "https://api.github.com/users/BitcoinPullTester/followers",
        "following_url": "https://api.github.com/users/BitcoinPullTester/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BitcoinPullTester/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BitcoinPullTester/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BitcoinPullTester/subscriptions",
        "organizations_url": "https://api.github.com/users/BitcoinPullTester/orgs",
        "repos_url": "https://api.github.com/users/BitcoinPullTester/repos",
        "events_url": "https://api.github.com/users/BitcoinPullTester/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BitcoinPullTester/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-54999007",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "commented",
      "id": 55013118,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU1MDEzMTE4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55013118",
      "actor": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-09T18:31:32Z",
      "updated_at": "2014-09-09T18:31:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "Great, thanks! I didn't try running the tests myself but the code looks good to me.\n",
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-55013118",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "commented",
      "id": 55189148,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU1MTg5MTQ4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55189148",
      "actor": {
        "login": "SergioDemianLerner",
        "id": 1752347,
        "node_id": "MDQ6VXNlcjE3NTIzNDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SergioDemianLerner",
        "html_url": "https://github.com/SergioDemianLerner",
        "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
        "following_url": "https://api.github.com/users/SergioDemianLerner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SergioDemianLerner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SergioDemianLerner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
        "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
        "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
        "events_url": "https://api.github.com/users/SergioDemianLerner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-10T21:54:42Z",
      "updated_at": "2014-09-10T21:54:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "I would like to know if there is a plan to add this patch to master or a reason not to. I have another patch waiting with more test cases that requires this patch to work! Thanks.\n",
      "user": {
        "login": "SergioDemianLerner",
        "id": 1752347,
        "node_id": "MDQ6VXNlcjE3NTIzNDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SergioDemianLerner",
        "html_url": "https://github.com/SergioDemianLerner",
        "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
        "following_url": "https://api.github.com/users/SergioDemianLerner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SergioDemianLerner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SergioDemianLerner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
        "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
        "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
        "events_url": "https://api.github.com/users/SergioDemianLerner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-55189148",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "commented",
      "id": 55199096,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU1MTk5MDk2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55199096",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-10T23:20:56Z",
      "updated_at": "2014-09-10T23:20:56Z",
      "author_association": "MEMBER",
      "body": "I haven't reviewed all code, but the changes to the existing core code and tests do seem safe to me.\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-55199096",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "commented",
      "id": 57145753,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTQ1NzUz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57145753",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-29T11:05:17Z",
      "updated_at": "2014-09-29T11:05:17Z",
      "author_association": "MEMBER",
      "body": "Had to be rebased for the clang code formatting change, as well as some other (base)chainparams changes.\nRebased version here: https://github.com/laanwj/bitcoin/tree/2014_09_unittest_master\n",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-57145753",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "commented",
      "id": 57146007,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTQ2MDA3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57146007",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-29T11:08:11Z",
      "updated_at": "2014-09-29T11:16:57Z",
      "author_association": "MEMBER",
      "body": "I'm not too happy about a virtual being introduced into CChainParams. Can we avoid this?\n\n```\nvirtual bool SkipProofOfWorkCheck() const { return false; }\n```\n\nEdit: yes we can, see 4705902\n",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-57146007",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "commented",
      "id": 57146969,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTQ2OTY5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57146969",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-09-29T11:20:06Z",
      "updated_at": "2014-09-29T11:20:06Z",
      "author_association": "MEMBER",
      "body": "ACK - will merge after you've sanity-checked my rebased version.\n",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-57146969",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "referenced",
      "id": 173116070,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDE3MzExNjA3MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/173116070",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ad51e14583fbf6d53d5a2b22a0a0dbe4a51a9a7d",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ad51e14583fbf6d53d5a2b22a0a0dbe4a51a9a7d",
      "created_at": "2014-10-02T07:54:34Z"
    },
    {
      "event": "commented",
      "id": 57598338,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3NTk4MzM4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57598338",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-10-02T08:33:32Z",
      "updated_at": "2014-10-02T10:13:05Z",
      "author_association": "MEMBER",
      "body": "Oops - this was marked by Travis as ok, but is failing the windows tests now after I tried to merge.\n\nSee\n- https://travis-ci.org/bitcoin/bitcoin/jobs/36845581\n- https://travis-ci.org/bitcoin/bitcoin/jobs/36845582\n\nLots of:\n\n```\ntest/miner_tests.cpp(82): error in \"CreateNewBlock_validity\": check ProcessBlock(state, __null, pblock) failed\ntest/miner_tests.cpp(83): error in \"CreateNewBlock_validity\": check state.IsValid() failed\ntest/miner_tests.cpp(82): error in \"CreateNewBlock_validity\": check ProcessBlock(state, __null, pblock) failed\ntest/miner_tests.cpp(83): error in \"CreateNewBlock_validity\": check state.IsValid() failed\ntest/miner_tests.cpp(82): error in \"CreateNewBlock_validity\": check ProcessBlock(state, __null, pblock) failed\ntest/miner_tests.cpp(83): error in \"CreateNewBlock_validity\": check state.IsValid() failed\ntest/miner_tests.cpp(82): error in \"CreateNewBlock_validity\": check ProcessBlock(state, __null, pblock) failed\ntest/miner_tests.cpp(83): error in \"CreateNewBlock_validity\": check state.IsValid() failed\n```\n\nSee #5030.\n",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-57598338",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "referenced",
      "id": 173131142,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDE3MzEzMTE0Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/173131142",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8d132431b4f6a7676482815231cd923d9047d541",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8d132431b4f6a7676482815231cd923d9047d541",
      "created_at": "2014-10-02T08:40:18Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-10-02T09:25:43Z",
      "updated_at": "2014-10-02T09:25:43Z",
      "source": {
        "issue": {
          "id": 44666161,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MjIxMjg3OTA=",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/5030",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/5030/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/5030/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/5030/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/5030",
          "number": 5030,
          "state": "closed",
          "state_reason": null,
          "title": "Switch testing framework from MAIN to new UNITTEST network (rebase)",
          "body": "See #4845.\nTrying to figure out why this breaks the tests now.\n",
          "user": {
            "login": "laanwj",
            "id": 126646,
            "node_id": "MDQ6VXNlcjEyNjY0Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/laanwj",
            "html_url": "https://github.com/laanwj",
            "followers_url": "https://api.github.com/users/laanwj/followers",
            "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
            "organizations_url": "https://api.github.com/users/laanwj/orgs",
            "repos_url": "https://api.github.com/users/laanwj/repos",
            "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/laanwj/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 14,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/5030",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/5030",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/5030.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/5030.patch"
          },
          "closed_at": "2014-10-02T13:28:46Z",
          "created_at": "2014-10-02T09:25:30Z",
          "updated_at": "2021-09-08T10:41:21Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 57634438,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU3NjM0NDM4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57634438",
      "actor": {
        "login": "SergioDemianLerner",
        "id": 1752347,
        "node_id": "MDQ6VXNlcjE3NTIzNDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SergioDemianLerner",
        "html_url": "https://github.com/SergioDemianLerner",
        "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
        "following_url": "https://api.github.com/users/SergioDemianLerner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SergioDemianLerner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SergioDemianLerner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
        "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
        "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
        "events_url": "https://api.github.com/users/SergioDemianLerner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-10-02T14:06:14Z",
      "updated_at": "2014-10-02T14:06:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "@laanwj I asked TheBlueMatt before about this problem. I could not replicate the problem, but It think that in some platforms the order in which the test cases are executed is different. Ohh, you already discovered this in  #5030\n",
      "user": {
        "login": "SergioDemianLerner",
        "id": 1752347,
        "node_id": "MDQ6VXNlcjE3NTIzNDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SergioDemianLerner",
        "html_url": "https://github.com/SergioDemianLerner",
        "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
        "following_url": "https://api.github.com/users/SergioDemianLerner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SergioDemianLerner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SergioDemianLerner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
        "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
        "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
        "events_url": "https://api.github.com/users/SergioDemianLerner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-57634438",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "mentioned",
      "id": 173263213,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTczMjYzMjEz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/173263213",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-10-02T14:06:14Z"
    },
    {
      "event": "subscribed",
      "id": 173263214,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE3MzI2MzIxNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/173263214",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-10-02T14:06:14Z"
    },
    {
      "event": "commented",
      "id": 58318987,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzE4OTg3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/58318987",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-10-08T07:11:23Z",
      "updated_at": "2014-10-08T07:11:39Z",
      "author_association": "MEMBER",
      "body": "Closing this. The modifiable parameters part has been merged (see #5030). The blocksv2 test case that relies on being executed in a specific order w/ miner_tests has not, as that's not acceptable (as it makes the test framework non-deterministic, and makes it impossible to run testcases separately). Please find a different solution for that.\n",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#issuecomment-58318987",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/4845"
    },
    {
      "event": "closed",
      "id": 175594105,
      "node_id": "MDExOkNsb3NlZEV2ZW50MTc1NTk0MTA1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/175594105",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2014-10-08T07:11:23Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2016-09-28T08:28:58Z",
      "updated_at": "2016-09-28T08:28:58Z",
      "source": {
        "issue": {
          "id": 173720619,
          "node_id": "MDExOlB1bGxSZXF1ZXN0ODMwNjA5OTI=",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8623",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8623/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8623/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8623/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/8623",
          "number": 8623,
          "state": "closed",
          "state_reason": null,
          "title": "chainparams: Added parametric halving interval for regtest-only mode",
          "body": "Make halving interval parametric using configuration\n\nIn order to test all the possible scenarios that can be faced before or after an halving it can be useful to set in regtest mode the halving interval.\nSo I've just added a parameter (-halvinginterval) that can be passed to bitcoind daemon in regtest mode in order to override the default halving interval.\n",
          "user": {
            "login": "daddinuz",
            "id": 7901246,
            "node_id": "MDQ6VXNlcjc5MDEyNDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7901246?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/daddinuz",
            "html_url": "https://github.com/daddinuz",
            "followers_url": "https://api.github.com/users/daddinuz/followers",
            "following_url": "https://api.github.com/users/daddinuz/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/daddinuz/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/daddinuz/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/daddinuz/subscriptions",
            "organizations_url": "https://api.github.com/users/daddinuz/orgs",
            "repos_url": "https://api.github.com/users/daddinuz/repos",
            "events_url": "https://api.github.com/users/daddinuz/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/daddinuz/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "NONE",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 13,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8623",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/8623",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/8623.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/8623.patch"
          },
          "closed_at": "2016-10-18T19:07:44Z",
          "created_at": "2016-08-29T08:18:15Z",
          "updated_at": "2021-09-08T12:40:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "locked",
      "id": 5271445348,
      "node_id": "LOE_lADOABII584CgIYrzwAAAAE6M99k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5271445348",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T10:41:18Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17160881",
      "pull_request_review_id": null,
      "id": 17160881,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTYwODgx",
      "diff_hunk": "@@ -2330,6 +2330,7 @@ bool AcceptBlockHeader(CBlockHeader& block, CValidationState& state, CBlockIndex\n         nHeight = pindexPrev->nHeight+1;\n \n         // Check proof of work\n+        if (!Params().SkipProofOfWorkCheck())",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "Diapolo",
        "id": 1419649,
        "node_id": "MDQ6VXNlcjE0MTk2NDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1419649?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Diapolo",
        "html_url": "https://github.com/Diapolo",
        "followers_url": "https://api.github.com/users/Diapolo/followers",
        "following_url": "https://api.github.com/users/Diapolo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Diapolo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Diapolo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Diapolo/subscriptions",
        "organizations_url": "https://api.github.com/users/Diapolo/orgs",
        "repos_url": "https://api.github.com/users/Diapolo/repos",
        "events_url": "https://api.github.com/users/Diapolo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Diapolo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This looks weird, is it missing an indentation below or some brackets?\n",
      "created_at": "2014-09-05T08:06:29Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17160881",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17160881"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164307",
      "pull_request_review_id": null,
      "id": 17164307,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0MzA3",
      "diff_hunk": "@@ -214,8 +214,50 @@ class CRegTestParams : public CTestNetParams {\n };\n static CRegTestParams regTestParams;\n \n+//\n+// Regression test",
      "path": "src/chainparams.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Would be good to s/Reg/Unit/ here to keep things distinct. Regtest is for programs that drive the app externally over the wire, unit tests is for, well, unit tests.\n",
      "created_at": "2014-09-05T09:47:23Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164307",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164307"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164341",
      "pull_request_review_id": null,
      "id": 17164341,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0MzQx",
      "diff_hunk": "@@ -2330,6 +2330,7 @@ bool AcceptBlockHeader(CBlockHeader& block, CValidationState& state, CBlockIndex\n         nHeight = pindexPrev->nHeight+1;\n \n         // Check proof of work\n+        if (!Params().SkipProofOfWorkCheck())",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Or just fold it into the expression with &&\n",
      "created_at": "2014-09-05T09:48:16Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164341",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164341"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164396",
      "pull_request_review_id": null,
      "id": 17164396,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0Mzk2",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 33,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Indentation. Also watch for whitespace around function parameter lists and so on. You might want to call the variable \"diffValue\" as \"dif\" is not a common way to abbreviate a word like difficulty.\n",
      "created_at": "2014-09-05T09:50:05Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164396",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164396"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164424",
      "pull_request_review_id": null,
      "id": 17164424,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0NDI0",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so ",
      "path": "src/test/blockv2_tests.cpp",
      "position": 46,
      "original_position": 45,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "s/RegTest/Unittest/\n\nIndentation is wrong.\n",
      "created_at": "2014-09-05T09:51:02Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164424",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164424"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 46,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164473",
      "pull_request_review_id": null,
      "id": 17164473,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0NDcz",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;",
      "path": "src/test/blockv2_tests.cpp",
      "position": 90,
      "original_position": 71,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'd feel better when things like this are scoped_ptr<>. Raw pointers in C++ are too easy to mess up.\n",
      "created_at": "2014-09-05T09:52:14Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164473",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164473"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 90,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164535",
      "pull_request_review_id": null,
      "id": 17164535,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0NTM1",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent",
      "path": "src/test/blockv2_tests.cpp",
      "position": 113,
      "original_position": 93,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This line confuses me. You're setting hashPrevBlock to the hash of the containing block, no? Or that's what it looks like. I don't see where the blocks parent is being modified.\n",
      "created_at": "2014-09-05T09:53:41Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164535",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164535"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 113,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164582",
      "pull_request_review_id": null,
      "id": 17164582,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0NTgy",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    \n+    \n+    // Now create exactly 1000 blocks v2\n+    \n+    // First check that the supermajority threshold is exactly 1000 blocks\n+    BOOST_CHECK(Params().ToCheckBlockUpgradeMajority()==1000);  // \n+    BOOST_CHECK(Params().EnforceBlockUpgradeMajority()==750);\n+    BOOST_CHECK(Params().RejectBlockOutdatedMajority()==950);\n+    \n+    // Over the last 1000 blocks, 750 blocks must be v2 to switch to v2-only mode.\n+    // Here we're testing only the last 750, not any subset.\n+    \n+    LogPrintf(\"Blockv2test BIP30 repetition begin\\n\");  \n+\n+    // First, if we try to add a block v2 with the same coinbase tx, we should get\n+    // \"bad-txns-BIP30\" because the coinbase tx has the same hash as the previous.\n+    // Unluckily, even if ConnectBlock returns a \"bad-txns-BIP30\", ActivateBestChainStep clears\n+    // the state, so we get true here and the \"bad-txns-BIP30\" reason is lost.\n+    // We verify instead that the chain height has not been incremented.\n+    \n+    CValidationState state7;",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 114,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It might make sense to refactor this \"add a block, did it work\" logic into a function.\n",
      "created_at": "2014-09-05T09:54:39Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164582",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164582"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 141,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164596",
      "pull_request_review_id": null,
      "id": 17164596,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0NTk2",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    \n+    \n+    // Now create exactly 1000 blocks v2\n+    \n+    // First check that the supermajority threshold is exactly 1000 blocks\n+    BOOST_CHECK(Params().ToCheckBlockUpgradeMajority()==1000);  // \n+    BOOST_CHECK(Params().EnforceBlockUpgradeMajority()==750);\n+    BOOST_CHECK(Params().RejectBlockOutdatedMajority()==950);\n+    \n+    // Over the last 1000 blocks, 750 blocks must be v2 to switch to v2-only mode.\n+    // Here we're testing only the last 750, not any subset.\n+    \n+    LogPrintf(\"Blockv2test BIP30 repetition begin\\n\");  \n+\n+    // First, if we try to add a block v2 with the same coinbase tx, we should get\n+    // \"bad-txns-BIP30\" because the coinbase tx has the same hash as the previous.\n+    // Unluckily, even if ConnectBlock returns a \"bad-txns-BIP30\", ActivateBestChainStep clears\n+    // the state, so we get true here and the \"bad-txns-BIP30\" reason is lost.",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 111,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This \"reason got lost\" thing sounds like a bug. Is it? No worries about fixing it in this patch if so, I'm just interested.\n",
      "created_at": "2014-09-05T09:55:09Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164596",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164596"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164636",
      "pull_request_review_id": null,
      "id": 17164636,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0NjM2",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    \n+    \n+    // Now create exactly 1000 blocks v2\n+    \n+    // First check that the supermajority threshold is exactly 1000 blocks\n+    BOOST_CHECK(Params().ToCheckBlockUpgradeMajority()==1000);  // \n+    BOOST_CHECK(Params().EnforceBlockUpgradeMajority()==750);\n+    BOOST_CHECK(Params().RejectBlockOutdatedMajority()==950);\n+    \n+    // Over the last 1000 blocks, 750 blocks must be v2 to switch to v2-only mode.\n+    // Here we're testing only the last 750, not any subset.\n+    \n+    LogPrintf(\"Blockv2test BIP30 repetition begin\\n\");  \n+\n+    // First, if we try to add a block v2 with the same coinbase tx, we should get\n+    // \"bad-txns-BIP30\" because the coinbase tx has the same hash as the previous.\n+    // Unluckily, even if ConnectBlock returns a \"bad-txns-BIP30\", ActivateBestChainStep clears\n+    // the state, so we get true here and the \"bad-txns-BIP30\" reason is lost.\n+    // We verify instead that the chain height has not been incremented.\n+    \n+    CValidationState state7;\n+    PreviousHeight = chainActive.Height();\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000); //\n+    pblock->nVersion = 2;\n+    BOOST_CHECK(ProcessBlock(state7, NULL, pblock)); // should we care about the return value?\n+    BOOST_CHECK(state7.IsValid());\n+    BOOST_CHECK(PreviousHeight == chainActive.Height()); // we check the block has not been added.\n+    \n+    LogPrintf(\"Blockv2test 750 v2 blocks  begin\\n\");    \n+    for (int i=0;i<750;i++) \n+    {\n+        \n+        LogPrintf(\"Blockv2test block %d begin\\n\",i);    \n+\n+        CheckSubsidyHalving(pblocktemplate,pblock);\t\n+       \n+        // We add a value to the height to make is NOT equal to the actual height.\n+        SetBlockDefaultAttributesAndHeight(pblock,true,1000); // blocks version 2 without height are allowed! for only 750 blocks\n+        pblock->nVersion = 2;\n+        CValidationState state;\n+                    \n+        PreviousHeight = chainActive.Height();\n+        BOOST_CHECK(ProcessBlock(state, NULL, pblock));\n+        BOOST_CHECK(state.IsValid());\n+        BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\n+        pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    }\n+\n+    LogPrintf(\"Blockv2test v2 without height rejected begin\\n\"); \n+    \n+    // Now we try to add a block v2, with an invalid height and it should be rejected. We use 2000 because is not in the range [1000..1750].\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,true,2000); // \n+    pblock->nVersion = 2;\n+    CValidationState state0;\n+    BOOST_CHECK(ProcessBlock(state0, NULL, pblock)==false);\n+    BOOST_CHECK(!state0.IsValid());\n+    BOOST_CHECK(state0.GetRejectReason()==\"bad-cb-height\"); \n+    // Do not update parent since block has failed\n+    \n+    LogPrintf(\"Blockv2test v2 with height accepted begin\\n\");    \n+    \n+    \n+    // Now we add a block with height, must be ok.\n+    for (int i=0;i<200;i++) \n+    {\n+        \n+        LogPrintf(\"Blockv2test v2block %d begin\\n\",i);      \n+        CheckSubsidyHalving(pblocktemplate,pblock);\n+        SetBlockDefaultAttributesAndHeight(pblock,true,0);\n+        pblock->nVersion = 2;\n+        CValidationState state;\n+        PreviousHeight = chainActive.Height();\n+        BOOST_CHECK(ProcessBlock(state, NULL, pblock));\n+        BOOST_CHECK(state.IsValid());\n+        BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\n+\n+        pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    }\n+\n+    \n+    LogPrintf(\"Blockv2test block v1 rejected\\n\");   \n+    // Now we add 200 additional blocks, until we get 950 (the threshold were v1 blocks are not accepted anymore)",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 177,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "s/were/where/\n",
      "created_at": "2014-09-05T09:56:13Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164636",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164636"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164653",
      "pull_request_review_id": null,
      "id": 17164653,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0NjUz",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    \n+    \n+    // Now create exactly 1000 blocks v2\n+    \n+    // First check that the supermajority threshold is exactly 1000 blocks\n+    BOOST_CHECK(Params().ToCheckBlockUpgradeMajority()==1000);  // \n+    BOOST_CHECK(Params().EnforceBlockUpgradeMajority()==750);\n+    BOOST_CHECK(Params().RejectBlockOutdatedMajority()==950);\n+    \n+    // Over the last 1000 blocks, 750 blocks must be v2 to switch to v2-only mode.\n+    // Here we're testing only the last 750, not any subset.\n+    \n+    LogPrintf(\"Blockv2test BIP30 repetition begin\\n\");  \n+\n+    // First, if we try to add a block v2 with the same coinbase tx, we should get\n+    // \"bad-txns-BIP30\" because the coinbase tx has the same hash as the previous.\n+    // Unluckily, even if ConnectBlock returns a \"bad-txns-BIP30\", ActivateBestChainStep clears\n+    // the state, so we get true here and the \"bad-txns-BIP30\" reason is lost.\n+    // We verify instead that the chain height has not been incremented.\n+    \n+    CValidationState state7;\n+    PreviousHeight = chainActive.Height();\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000); //\n+    pblock->nVersion = 2;\n+    BOOST_CHECK(ProcessBlock(state7, NULL, pblock)); // should we care about the return value?\n+    BOOST_CHECK(state7.IsValid());\n+    BOOST_CHECK(PreviousHeight == chainActive.Height()); // we check the block has not been added.\n+    \n+    LogPrintf(\"Blockv2test 750 v2 blocks  begin\\n\");    \n+    for (int i=0;i<750;i++) \n+    {\n+        \n+        LogPrintf(\"Blockv2test block %d begin\\n\",i);    \n+\n+        CheckSubsidyHalving(pblocktemplate,pblock);\t\n+       \n+        // We add a value to the height to make is NOT equal to the actual height.\n+        SetBlockDefaultAttributesAndHeight(pblock,true,1000); // blocks version 2 without height are allowed! for only 750 blocks\n+        pblock->nVersion = 2;\n+        CValidationState state;\n+                    \n+        PreviousHeight = chainActive.Height();\n+        BOOST_CHECK(ProcessBlock(state, NULL, pblock));\n+        BOOST_CHECK(state.IsValid());\n+        BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\n+        pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    }\n+\n+    LogPrintf(\"Blockv2test v2 without height rejected begin\\n\"); \n+    \n+    // Now we try to add a block v2, with an invalid height and it should be rejected. We use 2000 because is not in the range [1000..1750].\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,true,2000); // \n+    pblock->nVersion = 2;\n+    CValidationState state0;\n+    BOOST_CHECK(ProcessBlock(state0, NULL, pblock)==false);\n+    BOOST_CHECK(!state0.IsValid());\n+    BOOST_CHECK(state0.GetRejectReason()==\"bad-cb-height\"); \n+    // Do not update parent since block has failed\n+    \n+    LogPrintf(\"Blockv2test v2 with height accepted begin\\n\");    \n+    \n+    \n+    // Now we add a block with height, must be ok.\n+    for (int i=0;i<200;i++) \n+    {\n+        \n+        LogPrintf(\"Blockv2test v2block %d begin\\n\",i);      \n+        CheckSubsidyHalving(pblocktemplate,pblock);\n+        SetBlockDefaultAttributesAndHeight(pblock,true,0);\n+        pblock->nVersion = 2;\n+        CValidationState state;\n+        PreviousHeight = chainActive.Height();\n+        BOOST_CHECK(ProcessBlock(state, NULL, pblock));\n+        BOOST_CHECK(state.IsValid());\n+        BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\n+\n+        pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    }\n+\n+    \n+    LogPrintf(\"Blockv2test block v1 rejected\\n\");   \n+    // Now we add 200 additional blocks, until we get 950 (the threshold were v1 blocks are not accepted anymore)",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 177,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Also looks like this comment should be attached to the block above, I think. You're not adding 200 blocks at this point, that was just done.\n",
      "created_at": "2014-09-05T09:56:43Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164653",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164653"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164670",
      "pull_request_review_id": null,
      "id": 17164670,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0Njcw",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    \n+    \n+    // Now create exactly 1000 blocks v2\n+    \n+    // First check that the supermajority threshold is exactly 1000 blocks\n+    BOOST_CHECK(Params().ToCheckBlockUpgradeMajority()==1000);  // \n+    BOOST_CHECK(Params().EnforceBlockUpgradeMajority()==750);\n+    BOOST_CHECK(Params().RejectBlockOutdatedMajority()==950);\n+    \n+    // Over the last 1000 blocks, 750 blocks must be v2 to switch to v2-only mode.\n+    // Here we're testing only the last 750, not any subset.\n+    \n+    LogPrintf(\"Blockv2test BIP30 repetition begin\\n\");  \n+\n+    // First, if we try to add a block v2 with the same coinbase tx, we should get\n+    // \"bad-txns-BIP30\" because the coinbase tx has the same hash as the previous.\n+    // Unluckily, even if ConnectBlock returns a \"bad-txns-BIP30\", ActivateBestChainStep clears\n+    // the state, so we get true here and the \"bad-txns-BIP30\" reason is lost.\n+    // We verify instead that the chain height has not been incremented.\n+    \n+    CValidationState state7;\n+    PreviousHeight = chainActive.Height();\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000); //\n+    pblock->nVersion = 2;\n+    BOOST_CHECK(ProcessBlock(state7, NULL, pblock)); // should we care about the return value?\n+    BOOST_CHECK(state7.IsValid());\n+    BOOST_CHECK(PreviousHeight == chainActive.Height()); // we check the block has not been added.\n+    \n+    LogPrintf(\"Blockv2test 750 v2 blocks  begin\\n\");    \n+    for (int i=0;i<750;i++) \n+    {\n+        \n+        LogPrintf(\"Blockv2test block %d begin\\n\",i);    \n+\n+        CheckSubsidyHalving(pblocktemplate,pblock);\t\n+       \n+        // We add a value to the height to make is NOT equal to the actual height.\n+        SetBlockDefaultAttributesAndHeight(pblock,true,1000); // blocks version 2 without height are allowed! for only 750 blocks\n+        pblock->nVersion = 2;\n+        CValidationState state;\n+                    \n+        PreviousHeight = chainActive.Height();\n+        BOOST_CHECK(ProcessBlock(state, NULL, pblock));\n+        BOOST_CHECK(state.IsValid());\n+        BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\n+        pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    }\n+\n+    LogPrintf(\"Blockv2test v2 without height rejected begin\\n\"); \n+    \n+    // Now we try to add a block v2, with an invalid height and it should be rejected. We use 2000 because is not in the range [1000..1750].\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,true,2000); // \n+    pblock->nVersion = 2;\n+    CValidationState state0;\n+    BOOST_CHECK(ProcessBlock(state0, NULL, pblock)==false);\n+    BOOST_CHECK(!state0.IsValid());\n+    BOOST_CHECK(state0.GetRejectReason()==\"bad-cb-height\"); \n+    // Do not update parent since block has failed\n+    \n+    LogPrintf(\"Blockv2test v2 with height accepted begin\\n\");    \n+    \n+    \n+    // Now we add a block with height, must be ok.\n+    for (int i=0;i<200;i++) \n+    {\n+        \n+        LogPrintf(\"Blockv2test v2block %d begin\\n\",i);      \n+        CheckSubsidyHalving(pblocktemplate,pblock);\n+        SetBlockDefaultAttributesAndHeight(pblock,true,0);\n+        pblock->nVersion = 2;\n+        CValidationState state;\n+        PreviousHeight = chainActive.Height();\n+        BOOST_CHECK(ProcessBlock(state, NULL, pblock));\n+        BOOST_CHECK(state.IsValid());\n+        BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\n+\n+        pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    }\n+\n+    \n+    LogPrintf(\"Blockv2test block v1 rejected\\n\");   \n+    // Now we add 200 additional blocks, until we get 950 (the threshold were v1 blocks are not accepted anymore)\n+    // Now we try to add a block v1, it should be rejected, even if it hash the height field\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,true,0);\n+    pblock->nVersion = 1;\n+    CValidationState state2;\n+    BOOST_CHECK(ProcessBlock(state2, NULL, pblock)==false);\n+    BOOST_CHECK(!state2.IsValid());\n+    BOOST_CHECK(state2.GetRejectReason()==\"bad-version\");\n+    // Do not update parent since block has failed\n+    \n+    \n+    \n+    // Some other missing tests, added here as bonus...",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 190,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could these be in separate unit tests?\n",
      "created_at": "2014-09-05T09:57:18Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164670",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164670"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164774",
      "pull_request_review_id": null,
      "id": 17164774,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0Nzc0",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent",
      "path": "src/test/blockv2_tests.cpp",
      "position": 113,
      "original_position": 93,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is weird and surprising, but it's just copied from miner_tests.cpp.\n",
      "created_at": "2014-09-05T09:59:59Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164774",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164774"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 113,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164883",
      "pull_request_review_id": null,
      "id": 17164883,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTY0ODgz",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    \n+    \n+    // Now create exactly 1000 blocks v2\n+    \n+    // First check that the supermajority threshold is exactly 1000 blocks\n+    BOOST_CHECK(Params().ToCheckBlockUpgradeMajority()==1000);  // \n+    BOOST_CHECK(Params().EnforceBlockUpgradeMajority()==750);\n+    BOOST_CHECK(Params().RejectBlockOutdatedMajority()==950);\n+    \n+    // Over the last 1000 blocks, 750 blocks must be v2 to switch to v2-only mode.\n+    // Here we're testing only the last 750, not any subset.\n+    \n+    LogPrintf(\"Blockv2test BIP30 repetition begin\\n\");  \n+\n+    // First, if we try to add a block v2 with the same coinbase tx, we should get\n+    // \"bad-txns-BIP30\" because the coinbase tx has the same hash as the previous.\n+    // Unluckily, even if ConnectBlock returns a \"bad-txns-BIP30\", ActivateBestChainStep clears\n+    // the state, so we get true here and the \"bad-txns-BIP30\" reason is lost.",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 111,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No, it's not a bug. Receiving a single block can cause zero or multiple blocks to be connected, and ActivateBestChain's responsibility is just switching the best block whatsoever.\n\nFeedback about failures causes a reject message to be sent to the peer from which we received the actual block (not necessarily the same as from whom we got the block that caused the reorg), for which we remember the peerid. It would be useful to generalize this mechanism to have generic callbacks available about block validation (for example for BIP23 rejection reasons), which could also be used here.\n",
      "created_at": "2014-09-05T10:02:52Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17164883",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17164883"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17170397",
      "pull_request_review_id": null,
      "id": 17170397,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTcwMzk3",
      "diff_hunk": "@@ -2330,6 +2330,7 @@ bool AcceptBlockHeader(CBlockHeader& block, CValidationState& state, CBlockIndex\n         nHeight = pindexPrev->nHeight+1;\n \n         // Check proof of work\n+        if (!Params().SkipProofOfWorkCheck())",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "SergioDemianLerner",
        "id": 1752347,
        "node_id": "MDQ6VXNlcjE3NTIzNDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SergioDemianLerner",
        "html_url": "https://github.com/SergioDemianLerner",
        "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
        "following_url": "https://api.github.com/users/SergioDemianLerner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SergioDemianLerner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SergioDemianLerner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
        "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
        "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
        "events_url": "https://api.github.com/users/SergioDemianLerner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's missing indentation below.\nBut this is on purpose: I want critical consensus code not even look as modified so everyone can evaluate security at eyesight.\n",
      "created_at": "2014-09-05T12:50:38Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17170397",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17170397"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17170489",
      "pull_request_review_id": null,
      "id": 17170489,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTcwNDg5",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 33,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "SergioDemianLerner",
        "id": 1752347,
        "node_id": "MDQ6VXNlcjE3NTIzNDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SergioDemianLerner",
        "html_url": "https://github.com/SergioDemianLerner",
        "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
        "following_url": "https://api.github.com/users/SergioDemianLerner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SergioDemianLerner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SergioDemianLerner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
        "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
        "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
        "events_url": "https://api.github.com/users/SergioDemianLerner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "difValue is a difference from the current block height, not for difficulty. I can rename it to heightDifference.\n",
      "created_at": "2014-09-05T12:53:08Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17170489",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17170489"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17170842",
      "pull_request_review_id": null,
      "id": 17170842,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3MTcwODQy",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;\n+    CScript script;\n+    uint256 hash;\n+    int PreviousHeight;\n+\n+    \n+    LOCK(cs_main);\n+        \n+    \n+    // Simple block creation, nothing special yet.\n+    pblocktemplate = CreateNewBlock(scriptPubKey);   \n+    CBlock *pblock = &pblocktemplate->block; // pointer for convenience\n+   \n+    LogPrintf(\"Blockv2test block v1 add begin\\n\");  \n+    // First create a block v1, check that it is accepted. The block has an invalid height\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000);\n+    pblock->nVersion = 1;\n+    CValidationState state1;\n+    PreviousHeight = chainActive.Height();\n+    BOOST_CHECK(ProcessBlock(state1, NULL, pblock));\n+    BOOST_CHECK(state1.IsValid());\n+    BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\t\n+    pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    \n+    \n+    // Now create exactly 1000 blocks v2\n+    \n+    // First check that the supermajority threshold is exactly 1000 blocks\n+    BOOST_CHECK(Params().ToCheckBlockUpgradeMajority()==1000);  // \n+    BOOST_CHECK(Params().EnforceBlockUpgradeMajority()==750);\n+    BOOST_CHECK(Params().RejectBlockOutdatedMajority()==950);\n+    \n+    // Over the last 1000 blocks, 750 blocks must be v2 to switch to v2-only mode.\n+    // Here we're testing only the last 750, not any subset.\n+    \n+    LogPrintf(\"Blockv2test BIP30 repetition begin\\n\");  \n+\n+    // First, if we try to add a block v2 with the same coinbase tx, we should get\n+    // \"bad-txns-BIP30\" because the coinbase tx has the same hash as the previous.\n+    // Unluckily, even if ConnectBlock returns a \"bad-txns-BIP30\", ActivateBestChainStep clears\n+    // the state, so we get true here and the \"bad-txns-BIP30\" reason is lost.\n+    // We verify instead that the chain height has not been incremented.\n+    \n+    CValidationState state7;\n+    PreviousHeight = chainActive.Height();\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,false,5000); //\n+    pblock->nVersion = 2;\n+    BOOST_CHECK(ProcessBlock(state7, NULL, pblock)); // should we care about the return value?\n+    BOOST_CHECK(state7.IsValid());\n+    BOOST_CHECK(PreviousHeight == chainActive.Height()); // we check the block has not been added.\n+    \n+    LogPrintf(\"Blockv2test 750 v2 blocks  begin\\n\");    \n+    for (int i=0;i<750;i++) \n+    {\n+        \n+        LogPrintf(\"Blockv2test block %d begin\\n\",i);    \n+\n+        CheckSubsidyHalving(pblocktemplate,pblock);\t\n+       \n+        // We add a value to the height to make is NOT equal to the actual height.\n+        SetBlockDefaultAttributesAndHeight(pblock,true,1000); // blocks version 2 without height are allowed! for only 750 blocks\n+        pblock->nVersion = 2;\n+        CValidationState state;\n+                    \n+        PreviousHeight = chainActive.Height();\n+        BOOST_CHECK(ProcessBlock(state, NULL, pblock));\n+        BOOST_CHECK(state.IsValid());\n+        BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\n+        pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    }\n+\n+    LogPrintf(\"Blockv2test v2 without height rejected begin\\n\"); \n+    \n+    // Now we try to add a block v2, with an invalid height and it should be rejected. We use 2000 because is not in the range [1000..1750].\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,true,2000); // \n+    pblock->nVersion = 2;\n+    CValidationState state0;\n+    BOOST_CHECK(ProcessBlock(state0, NULL, pblock)==false);\n+    BOOST_CHECK(!state0.IsValid());\n+    BOOST_CHECK(state0.GetRejectReason()==\"bad-cb-height\"); \n+    // Do not update parent since block has failed\n+    \n+    LogPrintf(\"Blockv2test v2 with height accepted begin\\n\");    \n+    \n+    \n+    // Now we add a block with height, must be ok.\n+    for (int i=0;i<200;i++) \n+    {\n+        \n+        LogPrintf(\"Blockv2test v2block %d begin\\n\",i);      \n+        CheckSubsidyHalving(pblocktemplate,pblock);\n+        SetBlockDefaultAttributesAndHeight(pblock,true,0);\n+        pblock->nVersion = 2;\n+        CValidationState state;\n+        PreviousHeight = chainActive.Height();\n+        BOOST_CHECK(ProcessBlock(state, NULL, pblock));\n+        BOOST_CHECK(state.IsValid());\n+        BOOST_CHECK((PreviousHeight+1) == chainActive.Height()); // to differentiate from orphan blocks, which also get accepted in ProcessBlock()\n+\n+        pblock->hashPrevBlock = pblock->GetHash(); // update parent\n+    }\n+\n+    \n+    LogPrintf(\"Blockv2test block v1 rejected\\n\");   \n+    // Now we add 200 additional blocks, until we get 950 (the threshold were v1 blocks are not accepted anymore)\n+    // Now we try to add a block v1, it should be rejected, even if it hash the height field\n+    CheckSubsidyHalving(pblocktemplate,pblock);\t\n+    SetBlockDefaultAttributesAndHeight(pblock,true,0);\n+    pblock->nVersion = 1;\n+    CValidationState state2;\n+    BOOST_CHECK(ProcessBlock(state2, NULL, pblock)==false);\n+    BOOST_CHECK(!state2.IsValid());\n+    BOOST_CHECK(state2.GetRejectReason()==\"bad-version\");\n+    // Do not update parent since block has failed\n+    \n+    \n+    \n+    // Some other missing tests, added here as bonus...",
      "path": "src/test/blockv2_tests.cpp",
      "position": null,
      "original_position": 190,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "SergioDemianLerner",
        "id": 1752347,
        "node_id": "MDQ6VXNlcjE3NTIzNDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SergioDemianLerner",
        "html_url": "https://github.com/SergioDemianLerner",
        "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
        "following_url": "https://api.github.com/users/SergioDemianLerner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/SergioDemianLerner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/SergioDemianLerner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
        "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
        "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
        "events_url": "https://api.github.com/users/SergioDemianLerner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, but since they create v2 blocks, they can only be run after the previous v2 majority tests. So there is a hidden dependence.\n",
      "created_at": "2014-09-05T13:02:30Z",
      "updated_at": "2014-09-09T16:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17170842",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17170842"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17395663",
      "pull_request_review_id": null,
      "id": 17395663,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3Mzk1NjYz",
      "diff_hunk": "@@ -0,0 +1,232 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+// Tests the majority rule which states that after 1000 v2 blocks no v1 block can go\n+BOOST_AUTO_TEST_SUITE(blockv2_tests)\n+\n+static CScript scriptPubKey = CScript() << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\") << OP_CHECKSIG;\n+\n+static void SetEmptyBlock(CBlock * pblock)\n+{\n+        pblock->nVersion = 2;\n+        pblock->nTime = chainActive.Tip()->GetMedianTimePast()+1;\n+        pblock->nNonce = 0;\n+}\n+        \n+static void SetBlockDefaultAttributesAndHeight(CBlock * pblock,bool addHeight,int difValue)\n+{\n+        SetEmptyBlock(pblock);\n+\n+        // Add the coinbase\n+        CMutableTransaction txCoinbase(pblock->vtx[0]);\n+        \n+        if (addHeight) \n+            txCoinbase.vin[0].scriptSig = (CScript() << (chainActive.Height()+1+difValue) << 0);\n+            else\n+            txCoinbase.vin[0].scriptSig = (CScript() << difValue << 0); // At least size 2, this is a protocol spec\n+            \n+        txCoinbase.vout[0].scriptPubKey = CScript();\n+        pblock->vtx[0] = CTransaction(txCoinbase);\n+        pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+}\n+\n+void CheckSubsidyHalving(CBlockTemplate * &pblocktemplate, CBlock * &pblock)\n+{\n+    if ((chainActive.Height()+1) % Params().SubsidyHalvingInterval() == 0)\n+        {\n+            // The RegTest network has a low subsidy halving interval (150) so \n+            // we must recompute the coinbase subsidy if we reach the boundary.\n+\n+            // preserve parent hash\n+            uint256 prevParent = pblock->hashPrevBlock;\n+            delete pblocktemplate;\n+            pblocktemplate = CreateNewBlock(scriptPubKey);   \n+            pblock = &pblocktemplate->block; // pointer for convenience\n+            pblock->hashPrevBlock = prevParent;\n+        }\n+}\n+\n+void Blockv2test()\n+{\n+    assert(Params().NetworkID() == CBaseChainParams::UNITTEST); \n+    ModifiableParams()->setSkipProofOfWorkCheck(true);\n+    \n+    // We don't know the state of the block-chain here: it depends on which other tests are run before this test.\n+    // See https://github.com/bitcoin/bitcoin/pull/4688 for a patch that allows the re-creation of the block-chain\n+    // for each testcase that requires it.\n+\n+    // If miner_tests.cpp is run before, the chain will be 100 blocks long, and all of them will be v1\n+\n+    \n+    LogPrintf(\"Blockv2test testcase starts\\n\"); \n+        \n+    CBlockTemplate *pblocktemplate;",
      "path": "src/test/blockv2_tests.cpp",
      "position": 90,
      "original_position": 71,
      "commit_id": "eda4aa19d3cafc1644f5c28c687741a6c255b9a6",
      "original_commit_id": "357c35cb47a2aa6ceae6c87a8386bb1ea186f6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "+1\n",
      "created_at": "2014-09-10T23:19:09Z",
      "updated_at": "2014-09-10T23:19:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/4845#discussion_r17395663",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17395663"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/4845"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 90,
      "original_line": null,
      "side": "RIGHT"
    }
  ]
}