{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
    "id": 837470043,
    "node_id": "PR_kwDOABII584x6sdb",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/24230",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/24230.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/24230.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/38c93e6a8e573dbdf3fc4d14be7483961e18a576",
    "number": 24230,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "indexes: Stop using node internal types and locking cs_main, improve sync logic",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR lets indexing code mostly run outside of the node process. It also improves indexing sync logic, which is moved out of indexing code to a new [`node::SyncChain()`](https://github.com/ryanofsky/bitcoin/blob/8d8cdcb37005030f646ba3c45f7f54f556efb8bf/src/node/chain.h#L24-L39) function.\r\n\r\nAlmost all the commits in this PR are small refactoring changes that move code from `src/index/` to `src/node/`, or replace references to node types like `CBlockIndex`, `CChain`, `CChainState` in index code. There are only two commits affecting indexing sync logic which make complicated or substantive changes:\r\n\r\n- [`8746b35301c5` indexes: Rewrite chain sync logic, remove racy init](https://github.com/bitcoin/bitcoin/pull/24230/commits/8746b35301c5f65ff3200555fb2b82417fd2c758)\r\n- [`ad88f50ddd12` indexes: Initialize indexes without holding cs_main](https://github.com/bitcoin/bitcoin/pull/24230/commits/ad88f50ddd129dddd974bbf9fd7d86ec86b65508)\r\n\r\n\r\nThe commit messages have more details about these and other changes. Followups to this PR will reuse indexing sync code for wallets (#15719, #11756) and let indexes run in separate processes (#10102)",
    "labels": [
      {
        "id": 97470796,
        "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
        "name": "UTXO Db and Indexes",
        "color": "fbca04",
        "default": false
      }
    ],
    "created_at": "2022-02-01T16:56:28Z",
    "updated_at": "2024-03-20T07:00:21Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "291a58210aa599c780eebe5eed499a3c93ba1229",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "ryanofsky:pr/indexy",
      "ref": "pr/indexy",
      "sha": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 69901633,
        "node_id": "MDEwOlJlcG9zaXRvcnk2OTkwMTYzMw==",
        "name": "bitcoin",
        "full_name": "ryanofsky/bitcoin",
        "owner": {
          "login": "ryanofsky",
          "id": 7133040,
          "node_id": "MDQ6VXNlcjcxMzMwNDA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/ryanofsky",
          "html_url": "https://github.com/ryanofsky",
          "followers_url": "https://api.github.com/users/ryanofsky/followers",
          "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
          "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
          "repos_url": "https://api.github.com/users/ryanofsky/repos",
          "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/ryanofsky/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/ryanofsky/bitcoin",
        "archive_url": "https://api.github.com/repos/ryanofsky/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/ryanofsky/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/ryanofsky/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/ryanofsky/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/ryanofsky/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/ryanofsky/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/ryanofsky/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/ryanofsky/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/ryanofsky/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/ryanofsky/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/ryanofsky/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/ryanofsky/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/ryanofsky/bitcoin/events",
        "forks_url": "https://api.github.com/repos/ryanofsky/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/ryanofsky/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/ryanofsky/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/ryanofsky/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/ryanofsky/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/ryanofsky/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/ryanofsky/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/ryanofsky/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/ryanofsky/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/ryanofsky/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/ryanofsky/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/ryanofsky/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/ryanofsky/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/ryanofsky/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/ryanofsky/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/ryanofsky/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:ryanofsky/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/ryanofsky/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/ryanofsky/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/ryanofsky/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/ryanofsky/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/ryanofsky/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/ryanofsky/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/ryanofsky/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/ryanofsky/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/ryanofsky/bitcoin/hooks",
        "svn_url": "https://github.com/ryanofsky/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 9,
        "stargazers_count": 12,
        "watchers_count": 12,
        "size": 249947,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-03-19T17:23:01Z",
        "created_at": "2016-10-03T19:05:43Z",
        "updated_at": "2024-01-25T23:52:08Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "9a459e3ab9f983aabc9942e0989f790c9a511b9f",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34868,
        "stargazers_count": 74907,
        "watchers_count": 74907,
        "size": 253279,
        "default_branch": "master",
        "open_issues_count": 698,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-03-20T00:32:46Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-03-20T07:59:28Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 808,
    "deletions": 468,
    "changed_files": 26,
    "commits": 21,
    "review_comments": 194,
    "comments": 43
  },
  "events": [
    {
      "event": "labeled",
      "id": 5990149603,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFlCm3j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5990149603",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T17:49:48Z",
      "label": {
        "name": "Build system",
        "color": "5319e7"
      }
    },
    {
      "event": "labeled",
      "id": 5990149608,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFlCm3o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5990149608",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T17:49:48Z",
      "label": {
        "name": "interfaces",
        "color": "83c9fc"
      }
    },
    {
      "event": "labeled",
      "id": 5990149610,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFlCm3q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5990149610",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T17:49:48Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "labeled",
      "id": 5990149613,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFlCm3t",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5990149613",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T17:49:48Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "labeled",
      "id": 5990149620,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFlCm30",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5990149620",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T17:49:48Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "labeled",
      "id": 5990149623,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFlCm33",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5990149623",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T17:49:48Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "labeled",
      "id": 5990178183,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFlCt2H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5990178183",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T17:54:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "renamed",
      "id": 5991434894,
      "node_id": "RTE_lADOABII585C0HhYzwAAAAFlHgqO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5991434894",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T21:44:35Z",
      "rename": {
        "from": "indexes: Stop using node API and locking cs_main, improve sync logic",
        "to": "indexes: Stop using node internal types and locking cs_main, improve sync logic"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5991438192,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFlHhdw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5991438192",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T21:45:18Z"
    },
    {
      "event": "commented",
      "id": 1027319018,
      "node_id": "IC_kwDOABII5849O6Tq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027319018",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T21:47:46Z",
      "updated_at": "2022-02-01T21:47:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 8d8cdcb37005030f646ba3c45f7f54f556efb8bf -> 1fcfc73ba4e8180a8667868529774ab7b302ab5d ([`pr/indexy.1`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.1) -> [`pr/indexy.2`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.2), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.1-rebase..pr/indexy.2)) due to conflict with #22932. Also fixed some bugs in the last commit ðŸ™„\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1027319018",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 5991548944,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAFlH8gQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5991548944",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T22:07:08Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1027553252,
      "node_id": "IC_kwDOABII5849Pzfk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027553252",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T04:02:54Z",
      "updated_at": "2024-03-20T07:00:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/24230).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [fjahr](https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1038093095), [mzumsande](https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1014141911), [jamesob](https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1196377214), [aureleoules](https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1252096494), [josibake](https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1913572083) |\n| Approach ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1786770579) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29671](https://github.com/bitcoin/bitcoin/pull/29671) (index: avoid \"failed to commit\" errors on initialization by fjahr)\n* [#29652](https://github.com/bitcoin/bitcoin/pull/29652) (wallet: Avoid potentially writing incorrect best block locator by ryanofsky)\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo/LogDebug over LogPrintf/LogPrint by maflcko)\n* [#28955](https://github.com/bitcoin/bitcoin/pull/28955) (index: block filters sync, reduce disk read operations by caching last header by furszy)\n* [#19463](https://github.com/bitcoin/bitcoin/pull/19463) (Prune locks by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1027553252",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T06:51:39Z",
      "updated_at": "2022-02-02T06:51:39Z",
      "source": {
        "issue": {
          "id": 1113845812,
          "node_id": "PR_kwDOABII584xjnwj",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24150",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24150/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24150/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24150/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24150",
          "number": 24150,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: move index class members from protected to private",
          "body": "Simplify the index base and child classes and improve encapsulation and clarity by making fully overridden virtual member functions `private`. In the child classes, this allows having only public and private members. This change also help contributors add virtual functions into the correct section. Also rename the `GetName()` getters to `GetIndexName()` for clarity and easier grepping/reviewing.\r\n\r\nSome context:\r\n\r\nA base class virtual function doesn't need to be accessible to be overridden, but it can only be `private` if fully overridden, e.g. no inherited base implementation is used by the child classes.\r\n\r\nReferences:\r\n\r\n- https://en.cppreference.com/w/cpp/language/virtual: \"Base::vf does not need to be accessible or visible to be overridden. (Base::vf can be declared private, or Base can be inherited using private inheritance.)\"\r\n\r\n- \"An implementation member should be protected if it provides an operation or data that a derived class will need to use in its own implementation. Otherwise, implementation members should be private.\" - C++ Primer (Lippman, Lajoie, Moo)\r\n\r\n- Herb Sutter in http://www.gotw.ca/publications/mill18.htm: \"Make virtual functions private, and only if derived classes need to invoke the base implementation of a virtual function, make the virtual function protected. Prefer to make interfaces non-virtual using the Template pattern.\"\r\n",
          "user": {
            "login": "jonatack",
            "id": 2415484,
            "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonatack",
            "html_url": "https://github.com/jonatack",
            "followers_url": "https://api.github.com/users/jonatack/followers",
            "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
            "organizations_url": "https://api.github.com/users/jonatack/orgs",
            "repos_url": "https://api.github.com/users/jonatack/repos",
            "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonatack/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 16,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24150",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24150",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24150.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24150.patch"
          },
          "closed_at": "2023-04-25T11:08:34Z",
          "created_at": "2022-01-25T12:45:21Z",
          "updated_at": "2023-04-25T11:08:35Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T07:14:04Z",
      "updated_at": "2022-02-02T07:14:04Z",
      "source": {
        "issue": {
          "id": 1112699037,
          "node_id": "PR_kwDOABII584xf5t0",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24138",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24138/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24138/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24138/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24138",
          "number": 24138,
          "state": "closed",
          "state_reason": null,
          "title": "index: Commit MuHash and best block together for coinstatsindex",
          "body": "Fixes #24076\r\n\r\nCoinstatsindex currently writes the MuHash (`DB_MUHASH`) to disk in `CoinStatsIndex::WriteBlock()` and `CoinStatsIndex::ReverseBlock()`, but the best synced block is written in `BaseIndex::Commit()`. These are called at different points in time, both during the ThreadSync phase, and also after the initial sync is finished and validation callbacks (`BlockConnected()` vs `ChainStateFlushed()`) perform the syncing.\r\n\r\nAs a result, the index DB is temporarily in an inconsistent state, and if bitcoind is terminated uncleanly (so that there is no time to call `Commit()` by receiving an interrupt or by flushing the chainstate) this leads to problems:\r\nOn the next startup, `Init()` will read the best block and a MuHash that corresponds to a different (higher) block. Indexing will  be picked up at the the best block processing some blocks again, but since MuHash is a rolling hash, it will process some utxos twice and the muhashes for all future blocks will be wrong, as was observed in #24076.\r\n\r\nFix this by always committing `DB_MUHASH` together with `DB_BEST_BLOCK`.\r\n\r\nNote that the block data for the index is still written at different times, but this does not corrupt the index - at worst, these entries will be processed another time and overwritten after an unclean shutdown and restart.",
          "user": {
            "login": "mzumsande",
            "id": 48763452,
            "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
            "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mzumsande",
            "html_url": "https://github.com/mzumsande",
            "followers_url": "https://api.github.com/users/mzumsande/followers",
            "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
            "organizations_url": "https://api.github.com/users/mzumsande/orgs",
            "repos_url": "https://api.github.com/users/mzumsande/repos",
            "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/mzumsande/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24138",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24138",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24138.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24138.patch"
          },
          "closed_at": "2022-03-09T10:45:32Z",
          "created_at": "2022-01-24T14:10:20Z",
          "updated_at": "2023-03-09T10:18:14Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T07:53:14Z",
      "updated_at": "2022-02-02T07:53:14Z",
      "source": {
        "issue": {
          "id": 1109818164,
          "node_id": "PR_kwDOABII584xWdaD",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24117",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24117/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24117/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24117/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24117",
          "number": 24117,
          "state": "closed",
          "state_reason": null,
          "title": "index: make indices robust against init aborts",
          "body": "When an index thread receives an interrupt during init before it got to index anything (so `m_best_block_index == nullptr` still), it will still try to commit previous \"work\" before stopping the thread. That means that `BaseIndex::CommitInternal()` calls `GetLocator(nullptr)`, which returns an locator to the tip ([code](https://github.com/bitcoin/bitcoin/blob/06b6369766137756648b3cb62c8f385cca234e69/src/chain.cpp#L31-L32)), and saves it to the index DB.\r\nOn the next startup, this locator will be read and it will be assumed that we have successfully synced the index to the tip, when in reality we have indexed nothing.\r\nIn the case of coinstatsindex, this would lead to a shutdown of bitcoind without any indication what went wrong. For the other indexes, there would be no immediate shutdown, but the index would be corrupt.\r\n\r\nThis PR fixes this by not committing when `m_best_block_index==nullptr`, and it also adds an error log message to the silent coinstatsindex shutdown path.\r\n\r\nThis is another small bug found by `feature_init.py` - the second commit enables blockfilterindex and coinstatsindex for this test, enabling coinstatsindex without the first commit would have led to frequent failures.",
          "user": {
            "login": "mzumsande",
            "id": 48763452,
            "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
            "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mzumsande",
            "html_url": "https://github.com/mzumsande",
            "followers_url": "https://api.github.com/users/mzumsande/followers",
            "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
            "organizations_url": "https://api.github.com/users/mzumsande/orgs",
            "repos_url": "https://api.github.com/users/mzumsande/repos",
            "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/mzumsande/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 11,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24117",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24117",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24117.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24117.patch"
          },
          "closed_at": "2022-02-15T18:58:31Z",
          "created_at": "2022-01-20T22:16:34Z",
          "updated_at": "2023-10-13T15:24:44Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T09:56:54Z",
      "updated_at": "2022-02-02T09:56:54Z",
      "source": {
        "issue": {
          "id": 1095974571,
          "node_id": "PR_kwDOABII584wpHIz",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23997",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23997/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23997/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23997/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/23997",
          "number": 23997,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: avoid rescans under assumed-valid blocks",
          "body": "This is part of the [assumeutxo project](https://github.com/bitcoin/bitcoin/projects/11) (parent PR: #15606) \r\n\r\n---\r\n\r\nRefuse to load a wallet if it requires a rescan lower than the height of assumed-valid blocks.\r\n\r\nOf course in live code right now, `BLOCK_ASSUMED_VALID` block index entries don't exist since they're a unique flag introduced by the use of UTXO snapshots, so this is prophylactic code exercised only by unittests.",
          "user": {
            "login": "jamesob",
            "id": 73197,
            "node_id": "MDQ6VXNlcjczMTk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jamesob",
            "html_url": "https://github.com/jamesob",
            "followers_url": "https://api.github.com/users/jamesob/followers",
            "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
            "organizations_url": "https://api.github.com/users/jamesob/orgs",
            "repos_url": "https://api.github.com/users/jamesob/repos",
            "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jamesob/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 19,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23997",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/23997",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/23997.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/23997.patch"
          },
          "closed_at": "2022-07-18T18:40:27Z",
          "created_at": "2022-01-07T04:30:10Z",
          "updated_at": "2023-08-08T11:48:02Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T16:17:58Z",
      "updated_at": "2022-02-02T16:17:58Z",
      "source": {
        "issue": {
          "id": 947066883,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NjkyMTExNzg4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22485",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22485/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22485/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22485/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/22485",
          "number": 22485,
          "state": "closed",
          "state_reason": null,
          "title": "doc: BaseIndex sync behavior with empty datadir",
          "body": "Make a note about a potentially confusing behavior with `BaseIndex::m_synced`;\r\nif the user starts bitcoind with an empty datadir and an index enabled,\r\nBaseIndex will consider itself synced (as a degenerate case). This affects\r\nhow indices are built during IBD (relying solely on BlockConnected signals vs.\r\nusing ThreadSync()).",
          "user": {
            "login": "jamesob",
            "id": 73197,
            "node_id": "MDQ6VXNlcjczMTk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jamesob",
            "html_url": "https://github.com/jamesob",
            "followers_url": "https://api.github.com/users/jamesob/followers",
            "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
            "organizations_url": "https://api.github.com/users/jamesob/orgs",
            "repos_url": "https://api.github.com/users/jamesob/repos",
            "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jamesob/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22485",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/22485",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/22485.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/22485.patch"
          },
          "closed_at": "2022-07-21T17:56:09Z",
          "created_at": "2021-07-18T16:04:45Z",
          "updated_at": "2023-07-21T10:13:51Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T17:51:49Z",
      "updated_at": "2022-02-02T17:51:49Z",
      "source": {
        "issue": {
          "id": 860798104,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NjE3NTgwNjM4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21726",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21726/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21726/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21726/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/21726",
          "number": 21726,
          "state": "closed",
          "state_reason": null,
          "title": "Improve Indices on pruned nodes via prune blockers",
          "body": "# Motivation\r\nThe main motivation of this change and only behavior change noticeable by user is to allow running `coinstatsindex` on pruned nodes as has been requested [here for example](https://twitter.com/benthecarman/status/1388170854140452870?s=20).\r\n\r\n# Background\r\n`coinstatsindex` on pruned nodes can be enabled in a much simpler than it is done here but it comes with downside. The ability to run `blockfilterindex`on pruned nodes was added in #15946 but it also added the `blockfilterindex` as a dependency to `validation` and it introduced two new circular dependencies. Enabling `coinstatsindex` on pruned nodes in a similar way would add it as a dependency as well and introduce another circular dependency. \r\n\r\nInstead, this PR introduces a `m_prune_blockers` map to `BlockManager` as a flexible approach to block pruning. Entities like `blockfilterindex`, for example, can add a key and a height to block pruning over that height. These entities need to update that value to allow more pruning when they are ready.\r\n\r\n# Alternative approach\r\nUpon completing the first draft of this PR I found #19463 as an alternative that follows the same but follows a very different approach. I am listing the main differences here as I see them:\r\n- Usage of globals\r\n- Blocks pruning with a start and a stop height\r\n- Can persist blockers across restarts\r\n- Blockers can be set/unset via RPCs\r\n\r\nPersonally, I don't think any of these are necessary to be added here but if the general approach or specific features are more appealing to reviewers I am happy to change to a solution based on that PR or port over specific parts of it here.",
          "user": {
            "login": "fjahr",
            "id": 1322187,
            "node_id": "MDQ6VXNlcjEzMjIxODc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjahr",
            "html_url": "https://github.com/fjahr",
            "followers_url": "https://api.github.com/users/fjahr/followers",
            "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
            "organizations_url": "https://api.github.com/users/fjahr/orgs",
            "repos_url": "https://api.github.com/users/fjahr/repos",
            "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fjahr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 38,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21726",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/21726",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/21726.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/21726.patch"
          },
          "closed_at": "2022-04-26T18:43:10Z",
          "created_at": "2021-04-18T23:56:49Z",
          "updated_at": "2023-08-13T10:20:04Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T20:25:11Z",
      "updated_at": "2022-02-02T20:25:11Z",
      "source": {
        "issue": {
          "id": 694197606,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDgwNjEwMDYw",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19888",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19888/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19888/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19888/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19888",
          "number": 19888,
          "state": "closed",
          "state_reason": null,
          "title": "rpc, test: Improve getblockstats for unspendables",
          "body": "Fixes #19885\r\n\r\nThe genesis block does not have undo data saved to disk so the RPC errored because of that.",
          "user": {
            "login": "fjahr",
            "id": 1322187,
            "node_id": "MDQ6VXNlcjEzMjIxODc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjahr",
            "html_url": "https://github.com/fjahr",
            "followers_url": "https://api.github.com/users/fjahr/followers",
            "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
            "organizations_url": "https://api.github.com/users/fjahr/orgs",
            "repos_url": "https://api.github.com/users/fjahr/repos",
            "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fjahr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 21,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19888",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19888",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19888.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19888.patch"
          },
          "closed_at": "2022-12-05T22:47:13Z",
          "created_at": "2020-09-05T22:25:38Z",
          "updated_at": "2023-12-05T12:20:54Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5998576824,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFliwS4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5998576824",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T20:52:33Z"
    },
    {
      "event": "commented",
      "id": 1028349864,
      "node_id": "IC_kwDOABII5849S1-o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1028349864",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T20:55:28Z",
      "updated_at": "2022-02-02T20:55:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 1fcfc73ba4e8180a8667868529774ab7b302ab5d -> c5be433bf3f1a2b5b96cbe00608eff24136e6f51 ([`pr/indexy.2`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.2) -> [`pr/indexy.3`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.3), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.2..pr/indexy.3)) fixing asan error https://cirrus-ci.com/task/5137882733084672 and lint error https://cirrus-ci.com/task/5208251477262336. Did not look into tsan failure https://cirrus-ci.com/task/4574932779663360 and multiprocess blockfilter_index_tests segfault https://cirrus-ci.com/task/4856407756374016, but I think they may be addressed by the asan fix",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1028349864",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T23:54:23Z",
      "updated_at": "2022-02-02T23:54:23Z",
      "source": {
        "issue": {
          "id": 421531882,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MjYxNTYxNTQ3",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15606",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15606/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15606/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15606/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/15606",
          "number": 15606,
          "state": "closed",
          "state_reason": null,
          "title": "assumeutxo",
          "body": "**See the proposal for assumeutxo [here](https://github.com/jamesob/assumeutxo-docs/tree/2019-04-proposal/proposal).**\r\n\r\nTesting instructions can be found below the \"Progress\" section.\r\n\r\n---\r\n\r\n### Progress\r\n\r\nAll items here have corresponding commits here, but are unchecked if they haven't been merged yet.\r\n\r\n- [x] **Chainstate interface**\r\n  - https://github.com/bitcoin/bitcoin/pull/15976\r\n- [x] **Localize chainstate data**\r\n  - https://github.com/bitcoin/bitcoin/pull/16443\r\n- [x] **Share block data**\r\n  - https://github.com/bitcoin/bitcoin/pull/16194\r\n- [x] **Deglobalize chainstate**\r\n  - https://github.com/bitcoin/bitcoin/pull/15948\r\n- [x] **UpdateTip/CheckBlockIndex** modifications\r\n  - https://github.com/bitcoin/bitcoin/pull/21526\r\n- [x] **ChainstateManager**\r\n  - https://github.com/bitcoin/bitcoin/pull/17737\r\n- [x] **Mempool**\r\n  - https://github.com/bitcoin/bitcoin/pull/22415\r\n- [x] **LoadBlockIndex**\r\n  - https://github.com/bitcoin/bitcoin/pull/23174\r\n- [x] **Init/teardown**\r\n  - https://github.com/bitcoin/bitcoin/pull/24232\r\n  - https://github.com/bitcoin/bitcoin/pull/25667\r\n  - https://github.com/bitcoin/bitcoin/pull/25740\r\n- [x] **Wallet**: includes avoiding rescans when assumed-valid block data is in use\r\n  - https://github.com/bitcoin/bitcoin/pull/23997\r\n  - https://github.com/bitcoin/bitcoin/pull/26282\r\n- [ ] **P2P**: minor changes are made to `init.cpp` and `net_processing.cpp` to make simultaneous IBD across multiple chainstates work.\r\n  - #24008 \r\n- [ ] **Pruning**: implement correct pruning behavior when using a background chainstate\r\n- [ ] **Blockfile separation**: to prevent \"fragmentation\" in blockfile storage, have background chainstates use separate blockfiles from active snapshot chainstates to avoid interleaving heights and impairing pruning.\r\n- [ ] **Indexing**: all existing `CValidationInterface` events are given with an additional parameter, ChainstateRole, and all indexers ignore events from ChainstateRole::ASSUMEDVALID so that indexation only happens sequentially.\r\n- [ ] Raise error when both `-reindex` and assumeutxo are in use.\r\n- [ ] **RPC**: introduce RPC commands `dumptxoutset`, `loadtxoutset`, and (the probably temporary) `monitorsnapshot`.\r\n  - https://github.com/bitcoin/bitcoin/pull/16899\r\n- [ ] **Release docs & first assumeutxo commitment**: add notes and a particular assumeutxo hash value for first AU-enabled release.\r\n  - This will complete the project and allow use of UTXO snapshots for faster node bootstrap.\r\n- [ ] *(optional)* **Coinscache optimization**: allow flushing chainstate data without emptying the coins cache; results in better performance after UTXO snapshot load.\r\n  - https://github.com/bitcoin/bitcoin/pull/17487\r\n  - https://github.com/bitcoin/bitcoin/pull/27008\r\n\r\n---\r\n\r\n### Testing\r\n\r\n#### For fun (~5min)\r\n\r\nIf you want to do a quick test, you can run `./contrib/devtools/test_utxo_snapshots.sh` and follow the instructions. This is mostly obviated by the functional tests, though.\r\n\r\n#### For real (longer)\r\n\r\nIf you'd like to experience a real usage of assumeutxo, you can do that too.\r\nI've cut a new snapshot at height 788'000 (http://img.jameso.be/utxo-788000.dat - but you can do it yourself with `./contrib/devtools/utxo_snapshot.sh` if you want). Download that, and then create a datadir for testing:\r\n```sh\r\n$ cd ~/src/bitcoin  # or whatever\r\n\r\n# get the snapshot\r\n$ curl http://img.jameso.be/utxo-788000.dat > utxo-788000.dat\r\n\r\n# you'll want to do this if you like copy/pasting \r\n$ export AU_DATADIR=/home/${USER}/au-test # or wherever\r\n\r\n$ mkdir ${AU_DATADIR}\r\n$ vim ${AU_DATADIR}/bitcoin.conf\r\n\r\ndbcache=8000  # or, you know, something high\r\nblockfilterindex=1\r\ncoinstatsindex=1\r\nprune=3000\r\nlogthreadnames=1\r\n```\r\nObtain this branch, build it, and then start bitcoind:\r\n```sh\r\n$ git remote add jamesob https://github.com/jamesob/bitcoin\r\n$ git fetch jamesob utxo-dumpload-compressed\r\n$ git checkout jamesob/utxo-dumpload-compressed\r\n\r\n$ ./configure $conf_args && make  # (whatever you like to do here)\r\n\r\n# start 'er up and watch the logs\r\n$ ./src/bitcoind -datadir=${AU_DATADIR}\r\n```\r\nThen, in some other window, load the snapshot\r\n```sh\r\n$ ./src/bitcoin-cli -datadir=${AU_DATADIR} loadtxoutset $(pwd)/utxo-788000.dat\r\n```\r\n\r\nYou'll see some log messages about headers retrieval and waiting to see the snapshot in the headers chain. Once you get the full headers chain, you'll spend a decent amount of time (~10min) loading the snapshot, checking it, and flushing it to disk. After all that happens, you should be syncing to tip in pretty short order, and you'll see the occasional `[background validation]` log message go by.\r\n\r\nIn yet another window, you can check out chainstate status with\r\n```sh\r\n$ ./src/bitcoin-cli -datadir=${AU_DATADIR} getchainstates\r\n```\r\nas well as usual favorites like `getblockchaininfo`.\r\n\r\n---\r\n\r\n### Original change description\r\n\r\nFor those unfamiliar with assumeutxo, here's a brief summary from [the issue](https://github.com/bitcoin/bitcoin/issues/15605) (where any conceptual discussion not specific to this implementation should happen):\r\n\r\n> assumeutxo would be a way to initialize a node using a headers chain and a serialized version of the UTXO state which was generated from another node at some block height. A client making use of this UTXO \"snapshot\" would specify a hash and expect the content of the resulting UTXO set to yield this hash after deserialization. \r\n> \r\n> This would allow users to bootstrap a usable pruned node & wallet far more quickly (and with less disk usage) than waiting for a full initial block download to complete, since we only have to sync blocks between the base of the snapshot and the current network tip. Needless to say this is at expense of accepting a different trust model, though how different this really ends up being from `assumevalid` in effect is worth debate.\r\n\r\nIn short, this is an interesting change because it would allow nodes to get up and running within minutes given a ~3GB file (at time of writing) under an almost identical trust model to assumevalid.\r\n\r\nIn this implementation, I add a few RPC commands: `dumptxoutset` creates a UTXO snapshot and writes it to disk, and `loadtxoutset` intakes a snapshot from disk, constructs and activates chainstate based on it, and continues a from-scratch initial block download in the background for the sole purpose of validating the snapshot. Once the snapshot is validated, we throw away the chainstate used for background validation.\r\n\r\nThe assumeutxo procedure as implemented is as follows:\r\n\r\n1. A UTXO snapshot is loaded with the `loadtxoutset <path>` RPC command.\r\n1. A new chainstate (`CChainState`) is initialized using `ChainstateManager::ActivateSnapshot()`:\r\n   1. The serialized UTXO data is read in and various sanity checks are performed, e.g. compare expected coin count, recompute the hash and compare it with assumeutxo hash in source code.\r\n   1. We \"fast forward\" `new_chainstate->m_chain` to have a tip at the base of the snapshot (with or without block data). Lacking block data, we fake the `nTx` counts of the constituent `CBlockIndex` entries.\r\n   1. `LoadChainTip()` is called on the new snapshot and it is installed as our active chainstate.\r\n1. The new assumed-valid chainstate is now our active, and so that enters IBD until it is synced to the network's tip. Presumably the snapshot would be taken relatively close to the current tip but far enough away to avoid meaningful reorgs, say 10,000 blocks deep.\r\n1. Once the active chainstate is out of IBD, our old validation chain continues IBD \"in the background\" while the active chainstate services requests from most of the system.\r\n1. Once the background validation chainstate reaches a height equal the base of the snapshot, we take the hash of its UTXO set and ensure it equals the expected hash based on the snapshot. If the hashes are equivalent, we delete the validation chainstate and move on without event; if they aren't, we log loudly and fall back to the validation chainstate (we should probably just shut down).\r\n\r\nThe implicit assumption is that the background validation chain will always be a subset of the assumed-valid snapshot chain while the latter is active. We don't properly handle reorgs that go deeper than the base of the snapshot.\r\n\r\n### Changes (already merged/outdated)\r\n\r\n![chainstate-beforeafter (1)](https://user-images.githubusercontent.com/73197/54435797-a16b0780-4707-11e9-89c3-c90b5686804d.png)\r\n \r\nThe crux of this change is in removing any assumptions in the codebase that there is a single chainstate, i.e. any references to global variables `chainActive`, `pcoinsTip`, et al. need to be replaced with functions that return the relevant chainstate data at that moment in time. This change also takes `CChainState` to its logical conclusion by making it more self-contained - any references to globals like `chainActive` are removed with class-local references (`m_chain`).\r\n\r\nA few minor notes on the implementation:\r\n\r\n- When we attempt to load a wallet with a BestBlock locator lower than the base of a snapshot and the snapshot has not yet been validated, we refuse to load the wallet.\r\n\r\n- For additional notes, see [the new assumeutxo docs](https://github.com/jamesob/bitcoin/blob/utxo-dumpload-compressed/doc/assumeutxo.md).",
          "user": {
            "login": "jamesob",
            "id": 73197,
            "node_id": "MDQ6VXNlcjczMTk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jamesob",
            "html_url": "https://github.com/jamesob",
            "followers_url": "https://api.github.com/users/jamesob/followers",
            "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
            "organizations_url": "https://api.github.com/users/jamesob/orgs",
            "repos_url": "https://api.github.com/users/jamesob/repos",
            "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jamesob/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64583,
              "node_id": "MDU6TGFiZWw2NDU4Mw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
              "name": "Feature",
              "color": "7cf575",
              "default": false
            },
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 66,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15606",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/15606",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/15606.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/15606.patch"
          },
          "closed_at": "2023-05-08T15:09:24Z",
          "created_at": "2019-03-15T13:58:22Z",
          "updated_at": "2023-05-08T15:09:24Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6006105745,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFl_eaR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6006105745",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-03T22:38:40Z"
    },
    {
      "event": "commented",
      "id": 1029467943,
      "node_id": "IC_kwDOABII5849XG8n",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1029467943",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-03T22:39:45Z",
      "updated_at": "2022-02-03T22:39:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated c5be433bf3f1a2b5b96cbe00608eff24136e6f51 -> 3ab1ebeff4328dc1a456a3323d8a41f0200d7be2 ([`pr/indexy.3`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.3) -> [`pr/indexy.4`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.4), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.3..pr/indexy.4)) fixing `blockfilter_index_initial_sync` crash that I could not produce locally but I believe was causing CI failures https://cirrus-ci.com/task/6670649857933312, https://cirrus-ci.com/task/5755856183623680, and https://cirrus-ci.com/task/4981799997669376",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1029467943",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-04T03:55:42Z",
      "updated_at": "2022-02-04T03:55:42Z",
      "source": {
        "issue": {
          "id": 1122906469,
          "node_id": "PR_kwDOABII584yBEua",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24247",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24247/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24247/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24247/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24247",
          "number": 24247,
          "state": "closed",
          "state_reason": null,
          "title": "p2p: Split network logging into two categories",
          "body": "\r\nThis PR is to resolve issue 20576. It focuses on introducing different levels of net logging. As a starting point, as mentioned in the issue https://github.com/bitcoin/bitcoin/issues/20576 , it creates separate lower-frequency, important peer-level events (netpeers) from very high-frequency message-level passing (netmessages).",
          "user": {
            "login": "anshu-khare-design",
            "id": 58921119,
            "node_id": "MDQ6VXNlcjU4OTIxMTE5",
            "avatar_url": "https://avatars.githubusercontent.com/u/58921119?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/anshu-khare-design",
            "html_url": "https://github.com/anshu-khare-design",
            "followers_url": "https://api.github.com/users/anshu-khare-design/followers",
            "following_url": "https://api.github.com/users/anshu-khare-design/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/anshu-khare-design/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/anshu-khare-design/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/anshu-khare-design/subscriptions",
            "organizations_url": "https://api.github.com/users/anshu-khare-design/orgs",
            "repos_url": "https://api.github.com/users/anshu-khare-design/repos",
            "events_url": "https://api.github.com/users/anshu-khare-design/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/anshu-khare-design/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "NONE",
          "locked": true,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24247",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24247",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24247.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24247.patch"
          },
          "closed_at": "2022-02-05T16:18:54Z",
          "created_at": "2022-02-03T10:26:37Z",
          "updated_at": "2023-02-06T10:11:25Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-05T21:28:18Z",
      "updated_at": "2022-02-05T21:28:18Z",
      "source": {
        "issue": {
          "id": 1124984013,
          "node_id": "PR_kwDOABII584yHy_v",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24273",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24273/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24273/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24273/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24273",
          "number": 24273,
          "state": "closed",
          "state_reason": null,
          "title": "p2p: Split network logging into two categories #24247",
          "body": "This PR is to resolve issue 20576. It focuses on introducing different levels of net logging. As a starting point, as mentioned in the issue https://github.com/bitcoin/bitcoin/issues/20576 , it creates separate lower-frequency, important peer-level events (netpeers) from very high-frequency message-level passing (netmessages).",
          "user": {
            "login": "anshu-khare-design",
            "id": 58921119,
            "node_id": "MDQ6VXNlcjU4OTIxMTE5",
            "avatar_url": "https://avatars.githubusercontent.com/u/58921119?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/anshu-khare-design",
            "html_url": "https://github.com/anshu-khare-design",
            "followers_url": "https://api.github.com/users/anshu-khare-design/followers",
            "following_url": "https://api.github.com/users/anshu-khare-design/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/anshu-khare-design/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/anshu-khare-design/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/anshu-khare-design/subscriptions",
            "organizations_url": "https://api.github.com/users/anshu-khare-design/orgs",
            "repos_url": "https://api.github.com/users/anshu-khare-design/repos",
            "events_url": "https://api.github.com/users/anshu-khare-design/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/anshu-khare-design/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "NONE",
          "locked": true,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24273",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24273",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24273.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24273.patch"
          },
          "closed_at": "2022-04-14T06:59:02Z",
          "created_at": "2022-02-05T17:17:36Z",
          "updated_at": "2023-04-14T14:43:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 876022016,
      "node_id": "PRR_kwDOABII5840NwkA",
      "url": null,
      "actor": null,
      "commit_id": "3ab1ebeff4328dc1a456a3323d8a41f0200d7be2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Some questions and comments while reviewing the first 8 commits.\r\n\r\nMy brain got friend while trying to understand 15398b1677362f4d98ffc786f1ae9976ad595ea8, even with `--color-moved` and probably because the original logic is also a bit confusing. So I'll try that again later.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-876022016",
      "submitted_at": "2022-02-08T15:31:18Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6030825011,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFndxYz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6030825011",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-09T01:00:16Z"
    },
    {
      "event": "reviewed",
      "id": 876331979,
      "node_id": "PRR_kwDOABII5840O8PL",
      "url": null,
      "actor": null,
      "commit_id": "d27072d58207b2648d8f1bf273389aee86db3001",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Updated 3ab1ebeff4328dc1a456a3323d8a41f0200d7be2 -> d27072d58207b2648d8f1bf273389aee86db3001 ([`pr/indexy.4`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.4) -> [`pr/indexy.5`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.5), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.4..pr/indexy.5)) with various suggested changes and a few other tweaks, all minor\r\n\r\n> My brain got friend while trying to understand [15398b1](https://github.com/bitcoin/bitcoin/commit/15398b1677362f4d98ffc786f1ae9976ad595ea8), even with `--color-moved` and probably because the original logic is also a bit confusing. So I'll try that again later.\r\n\r\nThis is good feedback. I split the commit up into two parts, so the boilerplate code moving part is separate from the other changes which are a little less obvious.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-876331979",
      "submitted_at": "2022-02-09T01:10:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "commented",
      "id": 1033225564,
      "node_id": "IC_kwDOABII5849lcVc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1033225564",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-09T01:10:26Z",
      "updated_at": "2022-02-09T01:10:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the review!",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1033225564",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6031301837,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFnflzN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6031301837",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-09T03:32:18Z"
    },
    {
      "event": "commented",
      "id": 1033309727,
      "node_id": "IC_kwDOABII5849lw4f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1033309727",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-09T03:33:42Z",
      "updated_at": "2022-02-09T03:33:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated d27072d58207b2648d8f1bf273389aee86db3001 -> 2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5 ([`pr/indexy.5`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.5) -> [`pr/indexy.6`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.6), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.5..pr/indexy.6)) to fix ubsan error https://cirrus-ci.com/task/5606579763412992?logs=ci#L4848",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1033309727",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "reviewed",
      "id": 877470452,
      "node_id": "PRR_kwDOABII5840TSL0",
      "url": null,
      "actor": null,
      "commit_id": "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "In b0220aa8bb0ab3164415734e47c57a2f5204a97c you're getting rid of `BaseIndex::Init()`, moving its prune checking code to `BaseIndex::Start()`, other parts to `blockConnected` and still more to `checkBlocks()` and `attachChain()` in interface.cpp. Is there way to do that across multiple commits?\r\n\r\nI also find the commit description \"Remove pruned data checking code\" ambiguous, since it's not being removed at all. It's not even moved out of the indexer.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-877470452",
      "submitted_at": "2022-02-09T14:19:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6037317853,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFn2ijd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6037317853",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-09T21:02:15Z"
    },
    {
      "event": "reviewed",
      "id": 878029336,
      "node_id": "PRR_kwDOABII5840VaoY",
      "url": null,
      "actor": null,
      "commit_id": "9acc7fc39d89e31ea6b46c9fda4c539b82cced8c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Updated 2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5 -> 9acc7fc39d89e31ea6b46c9fda4c539b82cced8c ([`pr/indexy.6`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.6) -> [`pr/indexy.7`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.7), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.6..pr/indexy.7)) tweaking commit description and reverting status flags change.\r\n\r\n> In [b0220aa](https://github.com/bitcoin/bitcoin/commit/b0220aa8bb0ab3164415734e47c57a2f5204a97c) you're getting rid of `BaseIndex::Init()`, moving its prune checking code to `BaseIndex::Start()`, other parts to `blockConnected` and still more to `checkBlocks()` and `attachChain()` in interface.cpp. Is there way to do that across multiple commits?\r\n> \r\n> I also find the commit description \"Remove pruned data checking code\" ambiguous, since it's not being removed at all. It's not even moved out of the indexer.\r\n\r\nRenamed to just say it's removing index Init method. I wonder if you are reviewing the code with --color-moved? The bulk of the init function is checking for pruned blocks and is moving unchanged. The other part is just initializing `m_best_block_index` and `m_synced` members.\r\n\r\nIt might be possible to move each of those those two parts of the Init function in different commits, but this would no longer be atomically setting `m_best_block_index` and `m_synced` and checking for pruned blocks with `cs_main` held. Also attachChain would have weird functionality in the interim.\r\n\r\nI wonder if there is something specific which is confusing about this commit, or if you just don't like the boilerplate it adds? Calling `attachChain` to call `blockConnected` to set `m_synced` and `m_best_block_index` is obviously a more roundabout way to set `m_synced` and `m_best_block_index`, but it does actually make sense later as the `blockConnected` method is filled out in the following commits.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-878029336",
      "submitted_at": "2022-02-09T21:05:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "commented",
      "id": 1034759315,
      "node_id": "IC_kwDOABII5849rSyT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1034759315",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-10T10:38:27Z",
      "updated_at": "2022-02-10T12:16:30Z",
      "author_association": "MEMBER",
      "body": "I did review with `--color-moved=dimmed_zebra`, though without `dimmed_zebra` it's slightly more clear and a bigger monitor helps too.\r\n\r\nIt helped to notice that `Init()` is only called from `Start()`. The first four lines that set `locator` are just moved.\r\n\r\nThe two lines after that, which obtain the lock and set `active_chain` are turned into a new function `checkBlocks()` which is called from another new function `attachChain()`.  The end of the original `Init()` function comes back in that the only way `attachChain` can return null is with a prune violation. The middle part is more complicated.\r\n\r\nOne job of `Init()` was to set `m_best_block_index` and `m_synced`. That task has been moved to `blockConnected()`, which is called once by `attachChain()`. That part is a bit hard to follow, though it does look right. Part of the problem is that you need to understand the original logic. \r\n\r\nOnce those two are set, it continue on to find a prune violation. That part is a clear move to `checkBlocks`.\r\n\r\nYou might be able to introduce `checkBlocks()` in a commit before this. If wouldn't make things simpler, but the diff would be more focussed on the boiler plate changes.\r\n\r\n> I wonder if there is something specific which is confusing about this commit, or if you just don't like the boilerplate it adds?\r\n\r\nI'm probably fine with the end result; we'll see when I get to later commits, but I'm not worried about that. It's indeed the change itself that's a bit confusing.\r\n\r\n2504811223597b211aa52b86a6386f4c02286d50: although I can follow along fine, it might make sense to split out the `IgnoreBlockConnected` and `IgnoreChainStateFlushed` helpers first (instead of \"framing\" it as a rename)",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1034759315",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "reviewed",
      "id": 878775522,
      "node_id": "PRR_kwDOABII5840YQzi",
      "url": null,
      "actor": null,
      "commit_id": "9acc7fc39d89e31ea6b46c9fda4c539b82cced8c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Reviewed a couple more commits.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-878775522",
      "submitted_at": "2022-02-10T13:59:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6047181056,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFocKkA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6047181056",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-11T01:12:40Z"
    },
    {
      "event": "reviewed",
      "id": 879038361,
      "node_id": "PRR_kwDOABII5840ZQ-Z",
      "url": null,
      "actor": null,
      "commit_id": "3c9fa85865c3d766b367e6f2842928112d362fc1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks again for the review and suggestions!\r\n\r\nUpdated 9acc7fc39d89e31ea6b46c9fda4c539b82cced8c -> 3c9fa85865c3d766b367e6f2842928112d362fc1 ([`pr/indexy.7`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.7) -> [`pr/indexy.8`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.8), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.7..pr/indexy.8)) just making internal changes to commits and commit descriptions. Final code is the same except for a new `const` modifier.\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1034759315\r\n\r\n> You might be able to introduce `checkBlocks()` in a commit before this.\r\n\r\nThanks, this is a good suggestion. I moved it to a new earlier commit.\r\n\r\n> [2504811](https://github.com/bitcoin/bitcoin/commit/2504811223597b211aa52b86a6386f4c02286d50): although I can follow along fine, it might make sense to split out the `IgnoreBlockConnected` and `IgnoreChainStateFlushed` helpers first (instead of \"framing\" it as a rename)\r\n\r\nI'm actually not sure what suggestion would be but definitely feel free to tell me what to change or send a commit (in case it is easier to show the change than explain it)\r\n\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-879038361",
      "submitted_at": "2022-02-11T01:16:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "commented",
      "id": 1038093095,
      "node_id": "IC_kwDOABII58494Asn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1038093095",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-13T12:53:45Z",
      "updated_at": "2022-02-13T12:53:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, will start reviewing soon",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1038093095",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "referenced",
      "id": 6063085464,
      "node_id": "REFE_lADOABII585C0HhYzwAAAAFpY1eY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6063085464",
      "actor": {
        "login": "uvhw",
        "id": 90206684,
        "node_id": "MDQ6VXNlcjkwMjA2Njg0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90206684?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/uvhw",
        "html_url": "https://github.com/uvhw",
        "followers_url": "https://api.github.com/users/uvhw/followers",
        "following_url": "https://api.github.com/users/uvhw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/uvhw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/uvhw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/uvhw/subscriptions",
        "organizations_url": "https://api.github.com/users/uvhw/orgs",
        "repos_url": "https://api.github.com/users/uvhw/repos",
        "events_url": "https://api.github.com/users/uvhw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/uvhw/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "47d44ccc3e772b8ab0e64f98cc9a402c6783c54d",
      "commit_url": "https://api.github.com/repos/uvhw/Bitcoin-Foundation/commits/47d44ccc3e772b8ab0e64f98cc9a402c6783c54d",
      "created_at": "2022-02-14T00:05:50Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6072176676,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFp7hAk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6072176676",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T05:48:57Z"
    },
    {
      "event": "reviewed",
      "id": 880993870,
      "node_id": "PRR_kwDOABII5840guZO",
      "url": null,
      "actor": null,
      "commit_id": "7ae0a4639d25e31eb1d9bd1e01d93cadc3e90a6c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Updated 3c9fa85865c3d766b367e6f2842928112d362fc1 -> 7ae0a4639d25e31eb1d9bd1e01d93cadc3e90a6c ([`pr/indexy.8`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.8) -> [`pr/indexy.9`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.9), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.8..pr/indexy.9)) with no code changes, just adding a few comments and more information to some commit messages",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-880993870",
      "submitted_at": "2022-02-15T05:51:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "labeled",
      "id": 6077884491,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFqRShL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6077884491",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T19:57:00Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 883137628,
      "node_id": "PRR_kwDOABII5840o5xc",
      "url": null,
      "actor": null,
      "commit_id": "7ae0a4639d25e31eb1d9bd1e01d93cadc3e90a6c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Reviewed up to commit f56a851e11321ede9c5bcb43cd067c17f9efab39 (\"Move Rewind logic out of Rewind to blockDisconnected and ThreadSync\"), below some comments.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-883137628",
      "submitted_at": "2022-02-15T22:55:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6086485121,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFqyGSB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6086485121",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-16T23:30:13Z"
    },
    {
      "event": "reviewed",
      "id": 883961380,
      "node_id": "PRR_kwDOABII5840sC4k",
      "url": null,
      "actor": null,
      "commit_id": "72c29827f8adbc988be26c2002a8feedf9adc15a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Great feedback! Thanks for the reviews!\r\n\r\nRebased 7ae0a4639d25e31eb1d9bd1e01d93cadc3e90a6c -> 72c29827f8adbc988be26c2002a8feedf9adc15a ([`pr/indexy.9`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.9) -> [`pr/indexy.10`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.10), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.9-rebase..pr/indexy.10)) due to conflict with #24117, also making various changes suggested during review\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-883961380",
      "submitted_at": "2022-02-16T23:33:17Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "unlabeled",
      "id": 6086875510,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAFqzll2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6086875510",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-17T01:20:40Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-02T06:22:13Z",
      "updated_at": "2022-03-02T06:22:13Z",
      "source": {
        "issue": {
          "id": 1155605977,
          "node_id": "PR_kwDOABII584zvhhY",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24455",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24455/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24455/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24455/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24455",
          "number": 24455,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Split ArgsManager out of util/system",
          "body": "By splitting `ArgsManager` and related functions out of the grab-bag `util/system` file, this enables more specific includes, ~referencing `ArgsManager` without pulling in `gArgs`~, and eliminate a circular dependency between `chainparamsbase` and `utils/system`.\r\n\r\nThe proposed new modules are:\r\n* util/args_manager - ArgsManager and related functions\r\n* util/args - gArgs only - separate to support the goal of limiting the scope of `gArgs`\r\n* util/system - a variety of file system and sytem-related functions\r\n\r\nOther notable points:\r\n* I find it a bit concerning that `ArgsManager::ReadConfigFiles` calls `ClearPathCache` and `CheckDataDirOption` on `gArgs` rather than the current `ArgsManager` instance in the status quo.\r\n\r\nThe new files are nearly unchanged from their sources, so `git diff master --color-moved=dimmed-zebra` could be helpful.",
          "user": {
            "login": "Empact",
            "id": 5470,
            "node_id": "MDQ6VXNlcjU0NzA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Empact",
            "html_url": "https://github.com/Empact",
            "followers_url": "https://api.github.com/users/Empact/followers",
            "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
            "organizations_url": "https://api.github.com/users/Empact/orgs",
            "repos_url": "https://api.github.com/users/Empact/repos",
            "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Empact/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 12,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24455",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24455",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24455.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24455.patch"
          },
          "closed_at": "2022-05-17T06:53:21Z",
          "created_at": "2022-03-01T17:21:40Z",
          "updated_at": "2023-05-17T10:02:07Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 889137556,
      "node_id": "PRR_kwDOABII5840_ymU",
      "url": null,
      "actor": null,
      "commit_id": "72c29827f8adbc988be26c2002a8feedf9adc15a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, made it through all commits\r\n\r\nSome minor comments below.\r\n\r\nI did some light testing for the final version, and one thing I noticed that the Index Sync now seems to block everything else and makes it impossible to abort gracefully: The wallet is not loaded (so that RPC calls are disabled), and also interrupting bitcoind with SIGINT would not work for me any more.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-889137556",
      "submitted_at": "2022-03-05T20:43:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-07T19:45:38Z",
      "updated_at": "2022-03-07T19:45:38Z",
      "source": {
        "issue": {
          "id": 1160699957,
          "node_id": "I_kwDOABII585FLuA1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24487",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24487/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24487/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24487/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/24487",
          "number": 24487,
          "state": "closed",
          "state_reason": "completed",
          "title": "Automatic wallet rescan skipped after abort",
          "body": "I ran bitcoin-qt with an old wallet, causing it to rescan, then stopped it with a SIGINT signal, resulting in the following log. Nothing unexpected, so far:\r\n```\r\n2022-03-05T16:01:03Z init message: Loading walletâ€¦\r\n2022-03-05T16:01:03Z BerkeleyEnvironment::Open: LogDir=â€¦/.bitcoin/database ErrorFile=â€¦/.bitcoin/db.log\r\n2022-03-05T15:57:18Z [walletname.dat] Wallet File Version = 159900\r\n2022-03-05T15:57:18Z [walletname.dat] Keys: 2397 plaintext, 0 encrypted, 2397 w/ metadata, 2397 total. Unknown wallet records: 0\r\n2022-03-05T15:57:18Z [walletname.dat] Wallet completed loading in              65ms\r\n2022-03-05T15:57:18Z init message: Rescanningâ€¦\r\n2022-03-05T15:57:18Z [walletname.dat] Rescanning last 134072 blocks (from block 591711)...\r\n2022-03-05T15:57:18Z [walletname.dat] Rescan started from block 000000000000000000075fcc1872da61f45bcfd0e0bb36b7c8cb45e7a328ad41...\r\n2022-03-05T15:58:18Z [walletname.dat] Still rescanning. At block 593552. Progress=0.632716\r\n2022-03-05T15:59:18Z [walletname.dat] Still rescanning. At block 595458. Progress=0.638084\r\n2022-03-05T15:59:37Z [walletname.dat] Rescan interrupted by shutdown request at block 596080. Progress=0.639932\r\n2022-03-05T15:59:37Z Error: Failed to rescan the wallet during initialization\r\n2022-03-05T15:59:41Z GUI: initializeResult : Initialization result:  false\r\n2022-03-05T15:59:41Z GUI: requestShutdown : Requesting shutdown\r\n2022-03-05T15:59:41Z GUI: Running Shutdown in thread\r\n2022-03-05T15:59:41Z Shutdown: In progress...\r\n2022-03-05T15:59:41Z scheduler thread exit\r\n2022-03-05T15:59:42Z Shutdown: done\r\n2022-03-05T15:59:42Z GUI: Shutdown finished\r\n2022-03-05T15:59:42Z GUI: ~InitExecutor : Stopping thread\r\n2022-03-05T15:59:42Z GUI: ~InitExecutor : Stopped thread\r\n```\r\n\r\nHowever, the next time it was launched, the rescan didn't continue, nor did it start over. It seems to have been skipped?\r\n```\r\n2022-03-05T16:01:03Z init message: Loading walletâ€¦\r\n2022-03-05T16:01:03Z BerkeleyEnvironment::Open: LogDir=â€¦/.bitcoin/database ErrorFile=â€¦/.bitcoin/db.log\r\n2022-03-05T16:01:03Z [walletname.dat] Wallet File Version = 159900\r\n2022-03-05T16:01:03Z [walletname.dat] Keys: 2397 plaintext, 0 encrypted, 2397 w/ metadata, 2397 total. Unknown wallet records: 0\r\n2022-03-05T16:01:03Z [walletname.dat] Wallet completed loading in              91ms\r\n2022-03-05T16:01:03Z [walletname.dat] setKeyPool.size() = 2000\r\n2022-03-05T16:01:03Z [walletname.dat] mapWallet.size() = 378\r\n2022-03-05T16:01:03Z [walletname.dat] m_address_book.size() = 183\r\n2022-03-05T16:01:03Z Loaded 2 addresses from \"anchors.dat\"\r\n```\r\n\r\nI didn't investigate deeply, but could it be that despite the failed rescan, the new tip block was stored in the wallet? if so, this would be confusing.",
          "user": {
            "login": "laanwj",
            "id": 126646,
            "node_id": "MDQ6VXNlcjEyNjY0Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/laanwj",
            "html_url": "https://github.com/laanwj",
            "followers_url": "https://api.github.com/users/laanwj/followers",
            "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
            "organizations_url": "https://api.github.com/users/laanwj/orgs",
            "repos_url": "https://api.github.com/users/laanwj/repos",
            "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/laanwj/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64585,
              "node_id": "MDU6TGFiZWw2NDU4NQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
              "name": "Bug",
              "color": "FBBAAB",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 8,
          "closed_at": "2022-04-28T18:54:41Z",
          "created_at": "2022-03-06T19:53:52Z",
          "updated_at": "2023-04-28T09:59:11Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-08T02:12:44Z",
      "updated_at": "2022-03-08T02:12:44Z",
      "source": {
        "issue": {
          "id": 1155641022,
          "node_id": "PR_kwDOABII584zvowQ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24456",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24456/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24456/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24456/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24456",
          "number": 24456,
          "state": "closed",
          "state_reason": null,
          "title": "blockman: Properly guard blockfile members",
          "body": "Logically a rebase of: #15191\r\nBased on and split off from: #22564\r\n\r\nLast commit arose out of review: https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697576048",
          "user": {
            "login": "dongcarl",
            "id": 3445290,
            "node_id": "MDQ6VXNlcjM0NDUyOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dongcarl",
            "html_url": "https://github.com/dongcarl",
            "followers_url": "https://api.github.com/users/dongcarl/followers",
            "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
            "organizations_url": "https://api.github.com/users/dongcarl/orgs",
            "repos_url": "https://api.github.com/users/dongcarl/repos",
            "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dongcarl/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            },
            {
              "id": 219890555,
              "node_id": "MDU6TGFiZWwyMTk4OTA1NTU=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Block%20storage",
              "name": "Block storage",
              "color": "000000",
              "default": false
            },
            {
              "id": 749416508,
              "node_id": "MDU6TGFiZWw3NDk0MTY1MDg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Up%20for%20grabs",
              "name": "Up for grabs",
              "color": "99a810",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24456",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24456",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24456.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24456.patch"
          },
          "closed_at": "2022-05-04T15:32:38Z",
          "created_at": "2022-03-01T18:00:10Z",
          "updated_at": "2023-05-04T09:59:57Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-09T03:21:57Z",
      "updated_at": "2022-03-09T03:21:57Z",
      "source": {
        "issue": {
          "id": 954220384,
          "node_id": "MDExOlB1bGxSZXF1ZXN0Njk4MTUwMTI0",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22564/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22564/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22564/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/22564",
          "number": 22564,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Move mutable globals cleared in `::UnloadBlockIndex` to `BlockManager`",
          "body": "Fixes #22964\r\n\r\n-----\r\n\r\nThis is a small part of the work to accomplish what I described in 972c5166ee685447a6d4bf5e501b07a0871fba85:\r\n```\r\nOver time, we should probably move these mutable global state variables\r\ninto ChainstateManager or CChainState so it's easier to reason about\r\ntheir lifecycles.\r\n```\r\n\r\n`::UnloadBlockIndex` manually resets a subset of our mutable globals in addition to unloading the `ChainstateManager` and clearing the mempool. The need for this manual reset (AFAICT) arises out of the fact that many of these globals are closely related to the block index (hence `::UnloadBlockIndex`), and need to be reset with it.\r\n\r\nI've shot this \"manual reset\" gun at my foot several times while doing the de-globalize chainman work.\r\n\r\nThankfully, now that we have a `BlockManager` class that owns the block index, these globals should be moved under that class so that they can live and die with the block index. These moves, along with making the block index non-heap-based, eliminates:\r\n1. https://github.com/bitcoin/bitcoin/commit/3585b521392c5b2c855c3ba6dc9b7d2a171b3710 The need to reason about when we need to manually call `::UnloadBlockIndex` (this decision can at times seem almost arbitrary)\r\n2. https://github.com/bitcoin/bitcoin/commit/f741623c25455c20bff9eb1ddd10a4ac84dc5655 The need to have an `::UnloadBlockIndex` or explicit `~ChainstateManager` at all",
          "user": {
            "login": "dongcarl",
            "id": 3445290,
            "node_id": "MDQ6VXNlcjM0NDUyOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dongcarl",
            "html_url": "https://github.com/dongcarl",
            "followers_url": "https://api.github.com/users/dongcarl/followers",
            "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
            "organizations_url": "https://api.github.com/users/dongcarl/orgs",
            "repos_url": "https://api.github.com/users/dongcarl/repos",
            "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dongcarl/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/54",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/54",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/54/labels",
            "id": 7150037,
            "node_id": "MI_kwDOABII584AbRnV",
            "number": 54,
            "state": "closed",
            "title": "24.0",
            "description": "",
            "creator": {
              "login": "laanwj",
              "id": 126646,
              "node_id": "MDQ6VXNlcjEyNjY0Ng==",
              "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/laanwj",
              "html_url": "https://github.com/laanwj",
              "followers_url": "https://api.github.com/users/laanwj/followers",
              "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
              "organizations_url": "https://api.github.com/users/laanwj/orgs",
              "repos_url": "https://api.github.com/users/laanwj/repos",
              "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/laanwj/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 159,
            "created_at": "2021-09-14T08:27:02Z",
            "updated_at": "2022-11-29T15:44:44Z",
            "closed_at": "2022-11-29T15:44:44Z"
          },
          "locked": true,
          "comments": 38,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/22564",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/22564.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/22564.patch"
          },
          "closed_at": "2022-04-28T10:17:08Z",
          "created_at": "2021-07-27T19:58:39Z",
          "updated_at": "2023-04-28T09:59:12Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6209760963,
      "node_id": "LE_lADOABII585C0HhYzwAAAAFyIW7D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6209760963",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-09T12:54:40Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1062953979,
      "node_id": "IC_kwDOABII584_W2P7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1062953979",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-09T14:04:47Z",
      "updated_at": "2022-03-09T14:04:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "This pull seems related to areas I've been looking at, will review.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1062953979",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "commented",
      "id": 1064748312,
      "node_id": "IC_kwDOABII584_dsUY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1064748312",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T03:59:27Z",
      "updated_at": "2022-03-11T03:59:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I did some light testing for the final version, and one thing I noticed that the Index Sync now seems to block everything else and makes it impossible to abort gracefully: The wallet is not loaded (so that RPC calls are disabled), and also interrupting bitcoind with SIGINT would not work for me any more.\r\n\r\n@mzumsande I've been trying to reproduce this by modifying the syncchain method, but as far as I can tell, interrupt logic seems to be working as expected. Can you provide more specific steps to reproduce this? It also would help to see log output particularly near \"thread exit\" and \"Shutdown: In progress...\" lines.  If you can get gdb `thread apply all bt` output after sending SIGINT, that would provide a good picture, too.\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1064748312",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "mentioned",
      "id": 6222225396,
      "node_id": "MEE_lADOABII585C0HhYzwAAAAFy35_0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6222225396",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T03:59:27Z"
    },
    {
      "event": "subscribed",
      "id": 6222225401,
      "node_id": "SE_lADOABII585C0HhYzwAAAAFy35_5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6222225401",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T03:59:27Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6222384542,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFy4g2e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6222384542",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T04:54:18Z"
    },
    {
      "event": "reviewed",
      "id": 906746169,
      "node_id": "PRR_kwDOABII5842C9k5",
      "url": null,
      "actor": null,
      "commit_id": "4d387545bcc9ea7c158fd6278154c200c2cbec13",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the review!\r\n\r\nRebased 72c29827f8adbc988be26c2002a8feedf9adc15a -> 4d387545bcc9ea7c158fd6278154c200c2cbec13 ([`pr/indexy.10`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.10) -> [`pr/indexy.11`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.11), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.10-rebase..pr/indexy.11)) due to conflict with #24138. Also made a few updates suggested in review.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-906746169",
      "submitted_at": "2022-03-11T04:57:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T06:36:39Z",
      "updated_at": "2022-03-11T06:36:39Z",
      "source": {
        "issue": {
          "id": 1164555115,
          "node_id": "PR_kwDOABII5840NCRQ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24515",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24515/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24515/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24515/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24515",
          "number": 24515,
          "state": "closed",
          "state_reason": null,
          "title": "Only load BlockMan in BlockMan member functions ",
          "body": "The only important commit is \"Only load BlockMan in BlockMan member functions\", everything else is all just small style changes.\r\n\r\nHere's the commit message, reproduced:\r\n```\r\nThis commit effectively splits the \"load block index itself\" logic from\r\n\"derive Chainstate variables from loaded block index\" logic.\r\n\r\nThis means that BlockManager::LoadBlockIndex{,DB} will only load what's\r\nrelevant to the BlockManager.\r\n```",
          "user": {
            "login": "dongcarl",
            "id": 3445290,
            "node_id": "MDQ6VXNlcjM0NDUyOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dongcarl",
            "html_url": "https://github.com/dongcarl",
            "followers_url": "https://api.github.com/users/dongcarl/followers",
            "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
            "organizations_url": "https://api.github.com/users/dongcarl/orgs",
            "repos_url": "https://api.github.com/users/dongcarl/repos",
            "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dongcarl/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 219890555,
              "node_id": "MDU6TGFiZWwyMTk4OTA1NTU=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Block%20storage",
              "name": "Block storage",
              "color": "000000",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 5,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24515",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24515",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24515.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24515.patch"
          },
          "closed_at": "2022-03-17T06:26:21Z",
          "created_at": "2022-03-09T23:24:28Z",
          "updated_at": "2023-03-17T10:19:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T06:45:08Z",
      "updated_at": "2022-03-11T06:45:08Z",
      "source": {
        "issue": {
          "id": 1164262817,
          "node_id": "PR_kwDOABII5840MF26",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24513",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24513/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24513/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24513/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24513",
          "number": 24513,
          "state": "closed",
          "state_reason": null,
          "title": "CChainState -> Chainstate",
          "body": "Alright alright alright, I know: we hate refactors. We especially hate cosmetic refactors. \r\n\r\nNobody knows better than I that changing broad swaths of code out from under our already-abused collaborators, only to send a cascade of rebase bankruptcies, is annoying at best and sadistic at worst. And for a rename! The indignation!\r\n\r\nBut just for a second, imagine yourself. Programming `bitcoin/bitcoin`, on a sandy beach beneath a lapis lazuli sky. You go to type the name of what is probably the most commonly used data structure in the codebase, and you *only hit shift once*. \r\n\r\nWhat could you do in such a world? You could do anything. [The only limit is yourself.](https://zombo.com/)\r\n\r\n---\r\n\r\nSo maybe you like the idea of this patch but really don't want to deal with rebasing. You're in luck! \r\n\r\nHere're the commands that will bail you out of rebase bankruptcy:\r\n\r\n```sh\r\ngit rebase -i $(git merge-base HEAD master) \\\r\n  -x 'sed -i \"s/CChainState/Chainstate/g\" $(git ls-files | grep -E \".*\\.(py|cpp|h)$\") && git commit --amend --no-edit'\r\n# <commit changed?>\r\ngit add -u && git rebase --continue\r\n```\r\n\r\n---\r\n\r\n~~Anyway I'm not sure how serious I am about this, but I figured it was worth proposing.~~ I have decided I am very serious about this.\r\n\r\nMaybe we can have nice things every once in a while?\r\n",
          "user": {
            "login": "jamesob",
            "id": 73197,
            "node_id": "MDQ6VXNlcjczMTk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jamesob",
            "html_url": "https://github.com/jamesob",
            "followers_url": "https://api.github.com/users/jamesob/followers",
            "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
            "organizations_url": "https://api.github.com/users/jamesob/orgs",
            "repos_url": "https://api.github.com/users/jamesob/repos",
            "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jamesob/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 17,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24513",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24513",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24513.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24513.patch"
          },
          "closed_at": "2022-09-13T14:43:18Z",
          "created_at": "2022-03-09T17:56:35Z",
          "updated_at": "2023-09-13T12:10:43Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "unlabeled",
      "id": 6222762381,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAFy59GN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6222762381",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T06:52:50Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6222783922,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAFy6CWy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6222783922",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T06:59:05Z"
    },
    {
      "event": "commented",
      "id": 1064830434,
      "node_id": "IC_kwDOABII584_eAXi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1064830434",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T07:00:22Z",
      "updated_at": "2022-03-11T07:00:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 4d387545bcc9ea7c158fd6278154c200c2cbec13 -> 016304173ef6864e3c2f1104bd5ffe7595721ca6 ([`pr/indexy.11`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.11) -> [`pr/indexy.12`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.12), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.11..pr/indexy.12)) with lock fix for tsan error https://cirrus-ci.com/task/6456107408293888, and link fix for bitcoin-chainstate error https://cirrus-ci.com/task/4538559129452544\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1064830434",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "commented",
      "id": 1065308102,
      "node_id": "IC_kwDOABII584_f0_G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1065308102",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T17:04:48Z",
      "updated_at": "2022-03-11T17:04:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "> @mzumsande I've been trying to reproduce this by modifying the syncchain method, but as far as I can tell, interrupt logic seems to be working as expected. Can you provide more specific steps to reproduce this? It also would help to see log output particularly near \"thread exit\" and \"Shutdown: In progress...\" lines. If you can get gdb `thread apply all bt` output after sending SIGINT, that would provide a good picture, too.\r\n\r\nI tried to reproduce this again, but couldn't anymore. I must have made some error during my tests the last time.\r\nI again tried to interrupt the index sync with SIGINT, SIGKILL and invalidateblock during sync, and everything worked fine. Sorry for the noise.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1065308102",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "mentioned",
      "id": 6226275318,
      "node_id": "MEE_lADOABII585C0HhYzwAAAAFzHWv2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6226275318",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T17:04:48Z"
    },
    {
      "event": "subscribed",
      "id": 6226275328,
      "node_id": "SE_lADOABII585C0HhYzwAAAAFzHWwA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6226275328",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T17:04:48Z"
    },
    {
      "event": "commented",
      "id": 1065330061,
      "node_id": "IC_kwDOABII584_f6WN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1065330061",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-11T17:31:46Z",
      "updated_at": "2022-03-11T17:31:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Sorry for the noise.\r\n\r\nNo, thank you for testing! This was a good exercise for me to try to reproduce. I could see there is a real underlying issue because index sync threads can be greedy in their use of cs_main, and because index sync threads start before wallets are loaded, and wallet loading does not seem to be interruptible, Ctrl-C could become less usable if wallets take longer to load.\r\n\r\nThis PR should be improving the issue, not making it worse, because it is locking cs_main strictly less than previously during index sync. But thread scheduling is not always straightforward, and it's possible even releasing a lock could lead to worse latency, so this is something good to look out for and test.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1065330061",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "reviewed",
      "id": 908199949,
      "node_id": "PRR_kwDOABII5842IggN",
      "url": null,
      "actor": null,
      "commit_id": "016304173ef6864e3c2f1104bd5ffe7595721ca6",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "",
      "user": {
        "login": "maxim85200",
        "id": 99647687,
        "node_id": "U_kgDOBfCAxw",
        "avatar_url": "https://avatars.githubusercontent.com/u/99647687?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maxim85200",
        "html_url": "https://github.com/maxim85200",
        "followers_url": "https://api.github.com/users/maxim85200/followers",
        "following_url": "https://api.github.com/users/maxim85200/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maxim85200/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maxim85200/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maxim85200/subscriptions",
        "organizations_url": "https://api.github.com/users/maxim85200/orgs",
        "repos_url": "https://api.github.com/users/maxim85200/repos",
        "events_url": "https://api.github.com/users/maxim85200/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maxim85200/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-908199949",
      "submitted_at": "2022-03-13T23:28:00Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "comment_deleted",
      "id": 6232730469,
      "node_id": "CDE_lADOABII585C0HhYzwAAAAFzf-tl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6232730469",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-14T05:48:35Z"
    },
    {
      "event": "labeled",
      "id": 6256618034,
      "node_id": "LE_lADOABII585C0HhYzwAAAAF07Goy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6256618034",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-17T07:37:40Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6266055243,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAF1fGpL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6266055243",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-18T13:05:43Z"
    },
    {
      "event": "commented",
      "id": 1072393295,
      "node_id": "IC_kwDOABII584_62xP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1072393295",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-18T13:08:08Z",
      "updated_at": "2022-03-18T13:08:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 016304173ef6864e3c2f1104bd5ffe7595721ca6 -> 23d07effca30157779d7d9d324f1ee1a41324e07 ([`pr/indexy.12`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.12) -> [`pr/indexy.13`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.13), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.12-rebase..pr/indexy.13)) due to conflict with #24515",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1072393295",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 6266858741,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAF1iKz1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6266858741",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-18T15:08:09Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6268224836,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAF1nYVE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6268224836",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-18T19:09:33Z"
    },
    {
      "event": "commented",
      "id": 1072729670,
      "node_id": "IC_kwDOABII584_8I5G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1072729670",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-18T19:16:31Z",
      "updated_at": "2022-03-18T19:16:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 23d07effca30157779d7d9d324f1ee1a41324e07 -> d14e89f701b224977bef3ccde233d86271f7ed9b ([`pr/indexy.13`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.13) -> [`pr\r\n/indexy.14`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.14), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.13..pr/indexy.14)) to fix tsan race in coinstatsindex_unclean_shutdown test https://cirrus-ci.com/task/5516517512052736?logs=ci#L4877, and probably (couldn't reproduce these) fix msan and centos segfaults in the same test https://cirrus-ci.com/task/6642417418895360?logs=ci and https://cirrus-ci.com/task/4953567558631424?logs=ci\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1072729670",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-21T19:25:16Z",
      "updated_at": "2022-03-21T19:25:16Z",
      "source": {
        "issue": {
          "id": 1175808754,
          "node_id": "PR_kwDOABII5840wxLl",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24630",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24630/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24630/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24630/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24630",
          "number": 24630,
          "state": "closed",
          "state_reason": null,
          "title": "index: reset indexes when running reindex-chainstate",
          "body": "This resets the index dbs when running `-reindex-chainstate` as was previously done only for `-reindex`.\r\n\r\nIt fixes two bugs with `-reindex-chainstate` in conjunction with the indices:\r\n1. `coinstatsindex` gets corrupted:\r\n`reindex-chainstate`  leads to `BlockConnected()` signals to the index for each block that is reprocessed:\r\nIf the index db is not reset, the running hash `DB_MUHASH` is not reset either and it will include data from each block twice after the reindexing, so the MuHash will be incorrect. I added a test for this that fails on master.\r\n\r\n2. `blockfilterindex` duplicates the flatfile data:\r\nIt has a variable `DB_FILTER_POS` for the current position which would not get reset. As a result, the filterdata would be written twice to disk in succession.\r\n\r\n`txindex` has no running variable like the other two indexes, but I think that conceptually it makes sense to reset the index db here as well.",
          "user": {
            "login": "mzumsande",
            "id": 48763452,
            "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
            "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mzumsande",
            "html_url": "https://github.com/mzumsande",
            "followers_url": "https://api.github.com/users/mzumsande/followers",
            "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
            "organizations_url": "https://api.github.com/users/mzumsande/orgs",
            "repos_url": "https://api.github.com/users/mzumsande/repos",
            "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/mzumsande/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 15,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24630",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24630",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24630.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24630.patch"
          },
          "closed_at": "2022-04-21T14:16:37Z",
          "created_at": "2022-03-21T18:55:29Z",
          "updated_at": "2023-04-21T14:44:52Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 914866406,
      "node_id": "PRR_kwDOABII5842h8Dm",
      "url": null,
      "actor": null,
      "commit_id": "d14e89f701b224977bef3ccde233d86271f7ed9b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nI've read through the code and built each commit locally. \r\n\r\nAt a high level I think this is a great change - the more \"peripheral\" parts of the system we can put on the other side of the `Chain` interface, the easier it is to carve off those parts both in terms of process separation (limiting \"contagion\" risk of non-essential code) and deeper modularization (allowing for more straightforward progression of e.g. libbitcoinkernel). The indexing system is a great candidate for this kind of change, and I'm really glad to see this PR doing it.\r\n\r\nThat said, it took me a while to get through the changes. I think there's some potentially unnecessary churn within the commits (noted below). While the code quality is very good, behavioral equivalence with existing code is not immediately obvious to me when reading through the changes (given there are just so many of them), and so to have confidence that this PR isn't really changing any behavior, I'm really going to need to dig in and do some testing as well as review the coverage of the existing functional tests.\r\n\r\n---\r\n\r\nI reviewed all commits except for 4e0b09777b, which I found hard to follow - but I'm going to give it another look as I read it near the end of the day and maybe my brain was just fried.\r\n\r\nThe only other general note I had was on\r\n\r\n- [x] 8c0c231840 indexes: Rewrite chain sync logic, remove racy init\r\n\r\nFor easier reviewability it would be nice to absorb this into prior commits if possible; i.e.\r\navoid introducing the `Ignore*` methods only to take them away in this commit. Creates\r\na lot of churn to review. But would be curious to know if this is particularly difficult\r\nto do for some reason.\r\n\r\nFor what it's worth, the code in this commit much clearer than previous equivalents of\r\n`SyncChain`. Again there seems to be some churn in `attachChain()` that would save on\r\nunnecessary review of prior commits.\r\n\r\nThe `NotificationsHandlerImpl` could use some doc; I've had a hard time\r\ndetermining generally how it fits in and e.g. what the `connect` parameter\r\ndoes.\r\n\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-914866406",
      "submitted_at": "2022-03-24T13:56:58Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6320824888,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAF4wCI4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6320824888",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-28T18:33:57Z"
    },
    {
      "event": "reviewed",
      "id": 922143453,
      "node_id": "PRR_kwDOABII58429srd",
      "url": null,
      "actor": null,
      "commit_id": "d14e89f701b224977bef3ccde233d86271f7ed9b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the review!\r\n\r\nUpdated d14e89f701b224977bef3ccde233d86271f7ed9b -> 8d3fd88ee31569e8c5d7e33f584b222a4ef3cd1e ([`pr/indexy.14`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.14) -> [`pr/indexy.15`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.15), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.14..pr/indexy.15)) with suggestions.\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-914866406\r\n\r\n> so to have confidence that this PR isn't really changing any behavior, I'm really going to need to dig in and do some testing as well as review the coverage of the existing functional tests.\r\n\r\nTo be sure, I don't think it's hugely important for these commits not to change behavior. It's just that the code is complicated, and it already works, so if the cleanups avoid changing behavior it is easier to have some confidence that they work, too, and don't introduce larger problems. The goal is to avoid introducing bugs, and keeping behavior unchanged is just a way of achieving that.\r\n\r\n> I reviewed all commits except for [4e0b097](https://github.com/bitcoin/bitcoin/commit/4e0b09777beb772c76b711b5cde3ead5979d725e), which I found hard to follow\r\n\r\nYeah, that commit has a lot of annoying detail. The main thing it does is change rewind code to stop calling `CustomRemove` in a loop, and instead call `blockDisconnected` in a loop, with `blockDisconnected` calling `customRemove`. This get the `blockDisconnected` method to be functional enough so the rewind loop can be moved out of indexing code entirely, and left to the node.\r\n\r\n> The only other general note I had was on\r\n> \r\n>     * [x]  [8c0c231](https://github.com/bitcoin/bitcoin/commit/8c0c231840b6a88e470da69c6885e6b6dd088df5) indexes: Rewrite chain sync logic, remove racy init\r\n> \r\n> \r\n> For easier reviewability it would be nice to absorb this into prior commits if possible; i.e. avoid introducing the `Ignore*` methods only to take them away in this commit. Creates a lot of churn to review. But would be curious to know if this is particularly difficult to do for some reason.\r\n\r\nThis is a really interesting idea and I'm going to give it a try and see what it looks like. I don't think it would actually eliminate much churn, because if you look at the src/index/ code that is removed in 8c0c231840b6a88e470da69c6885e6b6dd088df5, it's basically not touched by the earlier commits. But the surrounding code is definitely changed a lot in earlier commits, so if the code that's going to be removed is removed earlier, the changes in surrounding code may be easier to understand.\r\n\r\n> The `NotificationsHandlerImpl` could use some doc; I've had a hard time determining generally how it fits in and e.g. what the `connect` parameter does.\r\n\r\nThis got messy due to some threading bugs but I added comments and simplified some things. No more connect parameter!",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-922143453",
      "submitted_at": "2022-03-28T18:36:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-09T23:09:24Z",
      "updated_at": "2022-04-09T23:09:24Z",
      "source": {
        "issue": {
          "id": 1197725869,
          "node_id": "PR_kwDOABII58415G23",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24811",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24811/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24811/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24811/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24811",
          "number": 24811,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Prepare for moving ArgsManager out of util/system",
          "body": "This comprises the preparation commits for #24455, which are relatively succinct, for easier review.",
          "user": {
            "login": "Empact",
            "id": 5470,
            "node_id": "MDQ6VXNlcjU0NzA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Empact",
            "html_url": "https://github.com/Empact",
            "followers_url": "https://api.github.com/users/Empact/followers",
            "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
            "organizations_url": "https://api.github.com/users/Empact/orgs",
            "repos_url": "https://api.github.com/users/Empact/repos",
            "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Empact/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24811",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24811",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24811.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24811.patch"
          },
          "closed_at": "2022-05-15T17:57:48Z",
          "created_at": "2022-04-08T19:36:55Z",
          "updated_at": "2023-11-18T12:18:58Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-19T01:55:25Z",
      "updated_at": "2022-04-19T01:55:25Z",
      "source": {
        "issue": {
          "id": 1207535962,
          "node_id": "PR_kwDOABII5842YxdB",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24915",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24915/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24915/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24915/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24915",
          "number": 24915,
          "state": "closed",
          "state_reason": null,
          "title": "lint: Convert lint-circular-dependencies.sh to Python",
          "body": "Here is a port of `/test/lint/lint-circular-dependencies.sh` to a Python-script as part of the request of https://github.com/bitcoin/bitcoin/issues/24783.\r\n\r\nIt aims to provide the same output as the bash version.\r\n",
          "user": {
            "login": "Smlep",
            "id": 16785985,
            "node_id": "MDQ6VXNlcjE2Nzg1OTg1",
            "avatar_url": "https://avatars.githubusercontent.com/u/16785985?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Smlep",
            "html_url": "https://github.com/Smlep",
            "followers_url": "https://api.github.com/users/Smlep/followers",
            "following_url": "https://api.github.com/users/Smlep/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Smlep/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Smlep/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Smlep/subscriptions",
            "organizations_url": "https://api.github.com/users/Smlep/orgs",
            "repos_url": "https://api.github.com/users/Smlep/repos",
            "events_url": "https://api.github.com/users/Smlep/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Smlep/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24915",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24915",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24915.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24915.patch"
          },
          "closed_at": "2022-04-25T17:37:41Z",
          "created_at": "2022-04-18T22:59:37Z",
          "updated_at": "2023-04-26T14:45:48Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-20T15:03:03Z",
      "updated_at": "2022-04-20T15:03:03Z",
      "source": {
        "issue": {
          "id": 1209417768,
          "node_id": "PR_kwDOABII5842elkM",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24931",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24931/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24931/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24931/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24931",
          "number": 24931,
          "state": "closed",
          "state_reason": null,
          "title": "Strengthen thread safety assertions",
          "body": "This changes `LOCK(mutex)` for non-global, non-recursive mutexes to be annotated with the negative capability for the mutex it refers to, to prevent . clang applies negative capabilities recursively, so this helps avoid forgetting to annotate functions.\r\n\r\nThis can't reasonably be used for globals, because clang would require every function to be annotated with `EXCLUSIVE_LOCKS_REQUIRED(!g_mutex)` for each global mutex; so this introduces a trivial `GlobalMutex` subclass of `Mutex`, and reduces the annotations for both `GlobalMutex`  to `LOCKS_EXCLUDED` which only catches trivial errors (eg (`LOCK(x); LOCK(x);`).",
          "user": {
            "login": "ajtowns",
            "id": 127186,
            "node_id": "MDQ6VXNlcjEyNzE4Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ajtowns",
            "html_url": "https://github.com/ajtowns",
            "followers_url": "https://api.github.com/users/ajtowns/followers",
            "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
            "organizations_url": "https://api.github.com/users/ajtowns/orgs",
            "repos_url": "https://api.github.com/users/ajtowns/repos",
            "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ajtowns/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 22,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24931",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24931",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24931.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24931.patch"
          },
          "closed_at": "2022-06-10T14:45:06Z",
          "created_at": "2022-04-20T09:25:52Z",
          "updated_at": "2023-06-10T10:05:50Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6493038425,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGDA-dZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6493038425",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-25T19:23:39Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6493856649,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGDEGOJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6493856649",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-25T21:55:22Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6493893784,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGDEPSY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6493893784",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-25T22:04:00Z"
    },
    {
      "event": "unlabeled",
      "id": 6494230527,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGDFhf_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6494230527",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-25T23:34:39Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 6501916249,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGDi15Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6501916249",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-26T20:49:11Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 964591461,
      "node_id": "PRR_kwDOABII5845fn9l",
      "url": null,
      "actor": null,
      "commit_id": "1819bdb7cb0634dad2e07daccfe7e8a122a943d6",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-964591461",
      "submitted_at": "2022-05-06T12:38:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "commented",
      "id": 1123085722,
      "node_id": "IC_kwDOABII585C8O2a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1123085722",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-11T01:36:59Z",
      "updated_at": "2022-05-11T01:36:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-922143453   \r\n\r\n> > For easier reviewability it would be nice to absorb this into prior commits if possible; i.e. avoid introducing the `Ignore*` methods only to take them away in this commit. Creates a lot of churn to review. But would be curious to know if this is particularly difficult to do for some reason.\r\n> \r\n> This is a really interesting idea and I'm going to give it a try and see what it looks like.\r\n\r\nI've been working on this on and off for weeks and I think I hit a breaking point. My branch is at https://github.com/ryanofsky/bitcoin/commits/wcr-export.2 and the main commit is https://github.com/ryanofsky/bitcoin/commit/2da7ac7d159056f3563b0cb845a2a8e9d64c548d. I backported the synchronous attachChain implementation from a later commit to that earlier commit to avoid the need for the the IgnoreBlockConnected and IgnoreChainFlushed methods\r\n\r\nBut this wrecked absolute havoc on the PR. I got through maybe 60% of the rebase and have had to fix countless conflicts and test failures so far. Then I realized the approach is inherently more messy and complicated because instead of:\r\n\r\n1. Moving the sync thread from indexing code to node code\r\n2. Replacing the racy sync implementation with non-racy sync implementation\r\n\r\nit requires:\r\n\r\n1. Adding non-racy sync thread in the node running after the racy sync thread in the index\r\n2. Moving indexing functionality to racy sync thread to the non-racy sync thread\r\n3. Deleting the non-racy sync thread\r\n\r\nStep 2 seemed doable but was causing lots of bugs and headaches and was leading to bigger commits, making me prefer the original approach more.\r\n\r\nI think the original approach is better by comparison. Yes, there are a few lines in the IgnoreBlockConnected and IgnoreChainFlushed methods which have to be touched up even though they are deleted later. But I don't think there is a good way around this churn that doesn't require changing indexing code and changing the sync implementation in the same commit, when the original approach is able to do these things separately.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1123085722",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-11T02:06:26Z",
      "updated_at": "2022-05-11T02:06:26Z",
      "source": {
        "issue": {
          "id": 1227811224,
          "node_id": "PR_kwDOABII5843aZ6-",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25074",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25074/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25074/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25074/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25074",
          "number": 25074,
          "state": "closed",
          "state_reason": null,
          "title": "index: During sync, commit best block after indexing",
          "body": "This changes the periodic commit of the best block during the index sync phase to use the already indexed predecessor of the current block index, instead of committing the current one that will only be indexed (by calling `WriteBlock()`) after committing the best block.\r\n \r\nThe previous code would leave the index database in an inconsistent state until the block is actually indexed - if an unclean shutdown happened at just this point in time, the index could get corrupted because at next startup, we'd assume that we have already indexed this block.",
          "user": {
            "login": "mzumsande",
            "id": 48763452,
            "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
            "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mzumsande",
            "html_url": "https://github.com/mzumsande",
            "followers_url": "https://api.github.com/users/mzumsande/followers",
            "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
            "organizations_url": "https://api.github.com/users/mzumsande/orgs",
            "repos_url": "https://api.github.com/users/mzumsande/repos",
            "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/mzumsande/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25074",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25074",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25074.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25074.patch"
          },
          "closed_at": "2022-05-19T13:00:39Z",
          "created_at": "2022-05-06T12:34:40Z",
          "updated_at": "2023-05-19T10:02:25Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6586676744,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGImLYI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6586676744",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-11T03:59:13Z"
    },
    {
      "event": "reviewed",
      "id": 968592395,
      "node_id": "PRR_kwDOABII5845u4wL",
      "url": null,
      "actor": null,
      "commit_id": "3b3f66ec486d6a77175d26e9edd324666e65855a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 8d3fd88ee31569e8c5d7e33f584b222a4ef3cd1e -> 988c62598b5d388474e6181dfd793b7ad7d141ad ([`pr/indexy.15`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.15) -> [`pr/indexy.16`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.16), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.15-rebase..pr/indexy.16)) with no conflicts.\r\nRebased 988c62598b5d388474e6181dfd793b7ad7d141ad -> 3b3f66ec486d6a77175d26e9edd324666e65855a ([`pr/indexy.16`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.16) -> [`pr/indexy.17`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.17), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.16-rebase..pr/indexy.17)) due to conflict with #24915\r\nRebased 3b3f66ec486d6a77175d26e9edd324666e65855a -> 2693249ffeab7bf6c41d7b6df16208dfbae5c33a ([`pr/indexy.17`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.17) -> [`pr/indexy.18`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.18), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.17-rebase..pr/indexy.18)) due to conflicts with #21726 and #25079\r\nUpdated 2693249ffeab7bf6c41d7b6df16208dfbae5c33a -> fd6568f6888bc86985ce626731cd0f9db35889b8 ([`pr/indexy.18`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.18) -> [`pr/indexy.19`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.19), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.18..pr/indexy.19)) to fix prune lock test errors https://cirrus-ci.com/task/4831256402722816?logs=functional_tests#L2561 and https://cirrus-ci.com/task/4690518914367488?logs=ci#L3346, and circular dependency error https://cirrus-ci.com/task/5112731379433472?logs=lint#L849",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-968592395",
      "submitted_at": "2022-05-11T03:59:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "unlabeled",
      "id": 6587002325,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGIna3V",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6587002325",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-11T05:35:05Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6592477816,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGI8Tp4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6592477816",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-11T17:49:57Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-12T07:24:11Z",
      "updated_at": "2022-05-12T07:24:11Z",
      "source": {
        "issue": {
          "id": 1232955625,
          "node_id": "PR_kwDOABII5843qu1s",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25109",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25109/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25109/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25109/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25109",
          "number": 25109,
          "state": "closed",
          "state_reason": null,
          "title": "Strengthen AssertLockNotHeld assertions",
          "body": "This changes `AssertLockNotHeld` so that it is annotated with the negative capability for the mutex it refers to. clang applies negative capabilities recursively, so this helps avoid forgetting to annotate functions.\r\n\r\nNote that this can't reasonably be used for globals, because clang would require every function to be annotated with `EXCLUSIVE_LOCKS_REQUIRED(!g_mutex)` for each global mutex. At present, the only global mutexes that use `AssertLockNotHeld` are `RecursiveMutex` so we treat that as an exception in order to avoid having to add an excessive number of negative annotations.",
          "user": {
            "login": "ajtowns",
            "id": 127186,
            "node_id": "MDQ6VXNlcjEyNzE4Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ajtowns",
            "html_url": "https://github.com/ajtowns",
            "followers_url": "https://api.github.com/users/ajtowns/followers",
            "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
            "organizations_url": "https://api.github.com/users/ajtowns/orgs",
            "repos_url": "https://api.github.com/users/ajtowns/repos",
            "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ajtowns/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25109",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25109",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25109.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25109.patch"
          },
          "closed_at": "2022-05-16T12:19:23Z",
          "created_at": "2022-05-11T17:15:03Z",
          "updated_at": "2023-05-16T10:01:51Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-12T18:36:27Z",
      "updated_at": "2022-05-12T18:36:27Z",
      "source": {
        "issue": {
          "id": 1221092345,
          "node_id": "I_kwDOABII585IyGP5",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25031",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25031/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25031/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25031/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/25031",
          "number": 25031,
          "state": "closed",
          "state_reason": "completed",
          "title": "Intermittent win64 CI failure in feature_index_prune.py",
          "body": "https://cirrus-ci.com/task/6532449864777728\r\n\r\nWin64 native  [msvc] task\r\n\r\n```\r\n test  2022-04-29T14:22:15.843000Z TestFramework (WARNING): Not cleaning up dir C:\\Users\\ContainerAdministrator\\AppData\\Local\\Temp\\test_runner_â‚¿_ðŸƒ_20220429_140215\\feature_index_prune_242 \r\n\r\n test  2022-04-29T14:22:15.843000Z TestFramework (ERROR): Test failed. Test logging available at C:\\Users\\ContainerAdministrator\\AppData\\Local\\Temp\\test_runner_â‚¿_ðŸƒ_20220429_140215\\feature_index_prune_242/test_framework.log \r\n\r\n test  2022-04-29T14:22:15.843000Z TestFramework (ERROR): \r\n node0 stderr Error: basic block filter index best block of the index goes beyond pruned data. Please disable the index or reindex (which will download the whole blockchain again) \r\n node1 stderr Error: coinstatsindex best block of the index goes beyond pruned data. Please disable the index or reindex (which will download the whole blockchain again) \r\n node2 stderr Error: basic block filter index best block of the index goes beyond pruned data. Please disable the index or reindex (which will download the whole blockchain again) \r\n",
          "user": {
            "login": "jonatack",
            "id": 2415484,
            "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonatack",
            "html_url": "https://github.com/jonatack",
            "followers_url": "https://api.github.com/users/jonatack/followers",
            "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
            "organizations_url": "https://api.github.com/users/jonatack/orgs",
            "repos_url": "https://api.github.com/users/jonatack/repos",
            "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonatack/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64585,
              "node_id": "MDU6TGFiZWw2NDU4NQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
              "name": "Bug",
              "color": "FBBAAB",
              "default": false
            },
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 7,
          "closed_at": "2022-05-15T07:21:10Z",
          "created_at": "2022-04-29T15:30:33Z",
          "updated_at": "2023-05-15T10:01:45Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-12T19:39:37Z",
      "updated_at": "2022-05-12T19:39:37Z",
      "source": {
        "issue": {
          "id": 1146268991,
          "node_id": "PR_kwDOABII584zQLtw",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24410",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24410/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24410/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24410/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24410",
          "number": 24410,
          "state": "closed",
          "state_reason": null,
          "title": "[kernel 2a/n] Split hashing/index `GetUTXOStats` codepaths, decouple from `coinstatsindex`",
          "body": "Part of: #24303\r\nDepends on: #24322\r\n\r\nThe `GetUTXOStats` function has 2 codepaths:\r\n  - One which queries the `CoinStatsIndex` for the UTXO hash\r\n  - One which actually performs the hashing\r\n\r\nFor `libbitcoinkernel`, the only place where we call `GetUTXOStats` is in `PopulateAndValidateSnapshots`, which uses the `SHA256D` hash, and is therefore unable to use the `CoinStatsIndex` since that only provides `MuHash` hashes. Not that I think indices necessarily belong in `libbitcoinkernel` anyway.\r\n\r\nThis PR separates these 2 aforementioned codepaths of `GetUTXOStats`, uses the hashing codepath in `PopulateAndValidateSnapshots`, and removes the need to link in `index/coinstatsindex.cpp` and `node/coinstats.cpp`.\r\n\r\n-----\r\n\r\nLogistically, this PR:\r\n- Extracts out the `index_requested` and `hash_type` members of `CoinStats`, which served as \"in-params\" to `GetUTXOStats` embedded within the `CoinStats` struct. This allows `CoinStats` to only consist of \"out-param\" members, and be returned by `GetUTXOStats` without needing to be an \"in-out\" param\r\n- Introduce the purely virtual `UTXOHashers` class, with 3 implementations: `SHA256DHasher`, `MuHashHasher`, and `NullHasher`. These replace the existing template-based polymorphism.\r\n- Split `GetUTXOStats` into:\r\n    - `CalculateUTXOStatsWithHasher(UTXOHasher&, ...)`, and\r\n    - `LookupUTXOStatsWithIndex(CoinStatsIndex&, ...)`\r\n- Use `CalculateUTXOStatsWithHasher` directly where appropriate (`src/validation.cpp` and `src/fuzz`)\r\n- Move `GetUTXOStats` to `rpc/blockchain`, which is the only place that depends on `GetUTXOStats`'s weird fallback behaviour\r\n- Move `LookupUTXOStatsWithIndex` to `index/coinstatsindex`\r\n\r\nCode organization:\r\n- `src/`\r\n  - `kernel/` â†’ only contains the hashing codepath\r\n    - `coinstats.cpp` â†’ hashing codepath implementations\r\n    - `coinstats.h` â†’ header for `kernel/coinstats.cpp`\r\n  - `index/` â†’ only contains the index codepath\r\n    - `coinstatsindex.cpp` â†’ index codepath implementations\r\n    - `coinstatsindex.h`\r\n  - `validation.cpp` â†’ only uses the hashing codepath\r\n  - `rpc/blockchain.cpp` â†’ uses both the hashing and index codepath, old `GetUTXOStats` fallback logic moved here as static\r\n  - `test/fuzz/coins_view.cpp` â†’ only uses the hashing codepath\r\n\r\n\r\nTODOs:\r\n- [x] Commit messages could be fleshed out more\r\n\r\nWould love any feedback!",
          "user": {
            "login": "dongcarl",
            "id": 3445290,
            "node_id": "MDQ6VXNlcjM0NDUyOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dongcarl",
            "html_url": "https://github.com/dongcarl",
            "followers_url": "https://api.github.com/users/dongcarl/followers",
            "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
            "organizations_url": "https://api.github.com/users/dongcarl/orgs",
            "repos_url": "https://api.github.com/users/dongcarl/repos",
            "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dongcarl/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 61889416,
              "node_id": "MDU6TGFiZWw2MTg4OTQxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system",
              "name": "Build system",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 31,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24410",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24410",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24410.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24410.patch"
          },
          "closed_at": "2022-05-24T12:43:54Z",
          "created_at": "2022-02-21T22:16:08Z",
          "updated_at": "2023-10-04T12:13:07Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-12T21:34:33Z",
      "updated_at": "2022-05-12T21:34:33Z",
      "source": {
        "issue": {
          "id": 1219390378,
          "node_id": "PR_kwDOABII5842-0QR",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25021",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25021/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25021/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25021/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25021",
          "number": 25021,
          "state": "closed",
          "state_reason": null,
          "title": "test: fix intermittent wallet_encryption failures on win64 task",
          "body": "- Fix intermittent failures like https://cirrus-ci.com/task/4571677035069440 and https://cirrus-ci.com/task/6566987122868224\r\n- Document and tidy up RPC walletpassphrase MAX_SLEEP_TIME/nSleepTime\r\n- Add test logging and an assertion and use named args ",
          "user": {
            "login": "jonatack",
            "id": 2415484,
            "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonatack",
            "html_url": "https://github.com/jonatack",
            "followers_url": "https://api.github.com/users/jonatack/followers",
            "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
            "organizations_url": "https://api.github.com/users/jonatack/orgs",
            "repos_url": "https://api.github.com/users/jonatack/repos",
            "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonatack/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 234877,
              "node_id": "MDU6TGFiZWwyMzQ4Nzc=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Windows",
              "name": "Windows",
              "color": "884400",
              "default": false
            },
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 44,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25021",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25021",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25021.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25021.patch"
          },
          "closed_at": "2022-08-20T07:20:16Z",
          "created_at": "2022-04-28T22:32:32Z",
          "updated_at": "2023-08-20T10:21:02Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6615974670,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGKV8MO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6615974670",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-16T13:05:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 974477399,
      "node_id": "PRR_kwDOABII5846FVhX",
      "url": null,
      "actor": null,
      "commit_id": "fd6568f6888bc86985ce626731cd0f9db35889b8",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-974477399",
      "submitted_at": "2022-05-16T19:39:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6628546723,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGLF5ij",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6628546723",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-18T01:28:01Z"
    },
    {
      "event": "reviewed",
      "id": 976258445,
      "node_id": "PRR_kwDOABII5846MIWN",
      "url": null,
      "actor": null,
      "commit_id": "699877a6c682eafde30b5c6eefa069a1ab7e58f4",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Rebased fd6568f6888bc86985ce626731cd0f9db35889b8 -> 699877a6c682eafde30b5c6eefa069a1ab7e58f4 ([`pr/indexy.19`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.19) -> [`pr/indexy.20`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.20), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.19-rebase..pr/indexy.20)) due to conflict with #25109",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-976258445",
      "submitted_at": "2022-05-18T01:38:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "unlabeled",
      "id": 6628786590,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGLG0Ge",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6628786590",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-18T02:49:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 6643088092,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGL9Xrc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6643088092",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-19T14:31:23Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6645015219,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGMEuKz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6645015219",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-19T18:44:01Z"
    },
    {
      "event": "commented",
      "id": 1132072521,
      "node_id": "IC_kwDOABII585Deg5J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1132072521",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-19T18:44:56Z",
      "updated_at": "2022-05-19T18:44:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 699877a6c682eafde30b5c6eefa069a1ab7e58f4 -> 3d33427d7ce832a763d1dc6a264244440c14fe1e ([`pr/indexy.20`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.20) -> [`pr/indexy.21`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.21), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.20-rebase..pr/indexy.21)) due to conflict with #25074",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1132072521",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 6645820326,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGMHyum",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6645820326",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-19T20:50:03Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-23T21:45:07Z",
      "updated_at": "2022-05-23T21:45:07Z",
      "source": {
        "issue": {
          "id": 1245716041,
          "node_id": "PR_kwDOABII5844Umrw",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25193",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25193/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25193/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25193/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25193",
          "number": 25193,
          "state": "closed",
          "state_reason": null,
          "title": "indexes: Read the locator's top block during init, allow interaction with reindex-chainstate",
          "body": "This makes two improvements to the index init phase:\r\n\r\n**1) Prevent index corruption in case a reorg happens when the index was switched off**:\r\nThis is done by reading in the top block stored in the locator instead of looking for a fork point already in `BaseIndex::Init()`.\r\nBefore, we'd just go back to the fork point by calling `FindForkInGlobalIndex()`, which would have corrupted the coinstatsindex because its saved muhash needs to be reverted step by step by un-applying all blocks in between, which wasn't done before. This is now being done a bit later in  `ThreadSync()`, which has existing logic to call the custom `Rewind()` method when going back along the chain to the forking point (thanks ryanofsky for pointing this out to me!).\r\n\r\n**2) Allow using the `-reindex-chainstate` option without needing to disabling indexes**:\r\nWith `BaseIndex::Init()` not calling `FindForkInGlobalIndex()` anymore, we can allow `reindex-chainstate` with active indexes. `reindex-chainstate` deletes the chain and rebuilds it later in `ThreadImport`, so there is no chain available during `BaseIndex::Init()`, which would lead to problems (see #24789).\r\nBut now we'll only need the chain a bit later in `BaseIndex::ThreadSync`, which will wait for the reindex-chainstate in `ThreadImport` to finish and will continue syncing after that.",
          "user": {
            "login": "mzumsande",
            "id": 48763452,
            "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
            "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mzumsande",
            "html_url": "https://github.com/mzumsande",
            "followers_url": "https://api.github.com/users/mzumsande/followers",
            "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
            "organizations_url": "https://api.github.com/users/mzumsande/orgs",
            "repos_url": "https://api.github.com/users/mzumsande/repos",
            "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/mzumsande/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 15,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25193",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25193",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25193.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25193.patch"
          },
          "closed_at": "2023-05-17T17:27:55Z",
          "created_at": "2022-05-23T21:27:22Z",
          "updated_at": "2023-09-16T08:26:41Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6669215998,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGNhCj-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6669215998",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-24T13:39:55Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6722782398,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGQtYS-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6722782398",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-01T20:21:15Z"
    },
    {
      "event": "commented",
      "id": 1144096475,
      "node_id": "IC_kwDOABII585EMYbb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1144096475",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-01T20:21:47Z",
      "updated_at": "2022-06-01T20:21:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 3d33427d7ce832a763d1dc6a264244440c14fe1e -> acfb6089041e7ba18f8778eb97e07d1bba2b5686 ([`pr/indexy.21`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.21) -> [`pr/indexy.22`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.22), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.21-rebase..pr/indexy.22)) due to conflict with #24410",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1144096475",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 6723355103,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGQvkHf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6723355103",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-01T21:48:33Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-02T14:18:43Z",
      "updated_at": "2022-06-02T14:18:43Z",
      "source": {
        "issue": {
          "id": 1206247497,
          "node_id": "PR_kwDOABII5842Uktn",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24897",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24897/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24897/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24897/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24897",
          "number": 24897,
          "state": "closed",
          "state_reason": null,
          "title": "[Draft / POC] Silent Payments",
          "body": "This PR proposes an early version of [Silent Payment](https://gist.github.com/RubenSomsen/c43b79517e7cb701ebf77eec6dbb46b8) (author:@RubenSomsen).\r\nIn this scheme, the recipient generates a public address, but the sender tweaks the address and the recipient detects the payment by verifying all transactions on the blockchain. An example use case would be private donations.\r\n\r\nThe purpose of this PR is not a final version, but to start the discussion and get benchmarks based on a real implementation.\r\n\r\nThis version is built on top of [#994](https://github.com/bitcoin-core/secp256k1/pull/994) (bitcoin-core/secp256k1) for x-only ECDH support and #23480 (bitcoin/bitcoin) for `rawtr()`. Each new silent transaction detected is stored in wallet as a `rawtr()` descriptor. \r\n\r\nIn this implementation, the sender can tweak the recipient address by passing the `silent_payment` option to send RPC. The transaction output will be different from the address entered.\r\n\r\nFor example `./src/bitcoin-cli -regtest -named send outputs=\"[{\\\"bcrt1pwlh5xuyrpgfunwyww8cfu78yfs2yqyevl7yturavahh5kgxwdd2q5hzgfu\\\": 1.1}]\" fee_rate=1 options=\"{ \\\"silent_payment\\\": true}\"`.\r\n\r\nwill generate `vout` with completely unrelated outputs:\r\n\r\n```\r\n\"vout\": [\r\n    {\r\n      \"value\": 1.10000000,\r\n      \"n\": 0,\r\n      \"scriptPubKey\": {\r\n        \"desc\": \"rawtr(65b19890c5ca40edb816d26f5f48cd9f3ed51121613b1c2405adc1a6dbbc824a)#8myx9tcu\",\r\n        \"address\": \"bcrt1pvkce3yx9efqwmwqk6fh47jxdnuld2yfpvya3cfq94hq6dkausf9qrfjkgz\",\r\n\r\n      }\r\n    },\r\n    {\r\n      \"value\": 2.02499835,\r\n      \"n\": 1,\r\n      \"scriptPubKey\": {\r\n        \"desc\": \"rawtr(c45cb3d500bbf8f0c8841e8e011b008781d826c16ee348edb822c0f97419bc4d)#26hcce63\",\r\n        \"address\": \"bcrt1pc3wt84gqh0u0pjyyr68qzxcqs7qasfkpdm353mdcytq0jaqeh3xsuvlykg\",\r\n      }\r\n    }\r\n  ]\r\n```\r\n\r\nAny wallet, as long as it has access to private keys, can send silent payments. Thus, this excludes watch-only wallets or wallets with external signers .\r\n\r\nBut the recipient's wallet needs a new flag called `SILENT_PAYMENT`. This flag allows an additional scan that verifies that the wallet keys match the silent payment scheme. When it detects a silent payment that belongs to the wallet, it is stored in a `rawtr()` descriptor.\r\n\r\n`./src/bitcoin-cli -regtest -named createwallet wallet_name=\"recipient\" silent_payment=true`\r\n\r\nTherefore, scanning each address for each transaction is potentially prohibitive overhead, so the node can be initialized with `keypool=1` or a descriptor with range [0,1] can be imported into a blank wallet. Until there is more benchmark data, it is the safest option. The proposal recommends one static address.\r\n\r\nI've been running some silent payments on signet using wallets with default keypool and default range, I haven't noticed any relevant performance drops on the signet node.\r\nApparently this implementation is working as expected but I can't guarantee that the scheme is implemented correctly or safely, so I'm opening this PR for reviews, modifications and improvements.\r\n\r\nThere is a new functional test (`test/functional/wallet_silentpayment.py`) that can help to better understand the implementation.",
          "user": {
            "login": "w0xlt",
            "id": 94266259,
            "node_id": "U_kgDOBZ5jkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/w0xlt",
            "html_url": "https://github.com/w0xlt",
            "followers_url": "https://api.github.com/users/w0xlt/followers",
            "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
            "organizations_url": "https://api.github.com/users/w0xlt/orgs",
            "repos_url": "https://api.github.com/users/w0xlt/repos",
            "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/w0xlt/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 61889416,
              "node_id": "MDU6TGFiZWw2MTg4OTQxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system",
              "name": "Build system",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 159815356,
              "node_id": "MDU6TGFiZWwxNTk4MTUzNTY=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Upstream",
              "name": "Upstream",
              "color": "bfd4f2",
              "default": false
            },
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            },
            {
              "id": 1482182044,
              "node_id": "MDU6TGFiZWwxNDgyMTgyMDQ0",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Descriptors",
              "name": "Descriptors",
              "description": "",
              "color": "e9f76c",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 86,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24897",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24897",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24897.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24897.patch"
          },
          "closed_at": "2023-06-05T13:18:14Z",
          "created_at": "2022-04-17T00:37:23Z",
          "updated_at": "2023-06-27T11:03:39Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-02T17:41:22Z",
      "updated_at": "2022-06-02T17:41:22Z",
      "source": {
        "issue": {
          "id": 1249685386,
          "node_id": "PR_kwDOABII5844hvKw",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25222",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25222/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25222/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25222/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25222",
          "number": 25222,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Pass reference to LookUpStats",
          "body": "I find it confusing to have an interface that accepts nullptr, but immediately crashes the program when someone does pass nullptr.\r\n\r\nFix that.\r\n\r\nAlso some include fixups.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25222",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25222",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25222.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25222.patch"
          },
          "closed_at": "2022-09-13T12:19:40Z",
          "created_at": "2022-05-26T14:59:28Z",
          "updated_at": "2023-09-13T12:10:42Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-02T17:59:44Z",
      "updated_at": "2022-06-02T17:59:44Z",
      "source": {
        "issue": {
          "id": 1247071697,
          "node_id": "PR_kwDOABII5844ZBvy",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25203",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25203/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25203/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25203/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25203",
          "number": 25203,
          "state": "open",
          "state_reason": null,
          "title": "Severity-based logging -- parent PR",
          "body": "This is a parent PR for continuing updates to severity-based logging. See https://github.com/bitcoin/bitcoin/issues/20576 for motivation and https://github.com/bitcoin/bitcoin/pull/25306 for discussion.\r\n\r\n- [x] https://github.com/bitcoin/bitcoin/pull/24464\r\n- [x] https://github.com/bitcoin/bitcoin/pull/25286\r\n- [x] #25306\r\n- [x] https://github.com/bitcoin/bitcoin/issues/25614\r\n- [x] https://github.com/bitcoin/bitcoin/pull/26957\r\n- [x] https://github.com/bitcoin/bitcoin/pull/27632\r\n- #27231 \r\n- print the wallet name more clearly in wallet logging to distinguish it from category/level\r\n- unconditionally log `Info` severity level messages\r\n- replace the hardcoded `LogLevelsList()` vector with a programmatic one derived from the `Level` enum class\r\n- convert `GetLogCategory()` to `std::optional`\r\n- deduplicate the `LogCategory` code\r\n- update to severity-based logging in the following areas, dropping the use of `LogPrintf` and `LogPrint`: addrdb, addrman, banman, i2p, mempool, netbase, net, net_processing, timedata, torcontrol\r\n- when we're ready to drop the other logging macros, rename `LogPrintLevel` to simply `Log`, which will be the only log macro needed after migration from the other macros is complete\r\n",
          "user": {
            "login": "jonatack",
            "id": 2415484,
            "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonatack",
            "html_url": "https://github.com/jonatack",
            "followers_url": "https://api.github.com/users/jonatack/followers",
            "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
            "organizations_url": "https://api.github.com/users/jonatack/orgs",
            "repos_url": "https://api.github.com/users/jonatack/repos",
            "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonatack/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 19,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25203",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25203",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25203.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25203.patch"
          },
          "created_at": "2022-05-24T20:08:49Z",
          "updated_at": "2024-01-11T17:13:42Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-08T02:49:19Z",
      "updated_at": "2022-06-08T02:49:19Z",
      "source": {
        "issue": {
          "id": 1238159102,
          "node_id": "PR_kwDOABII58437rQt",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25152",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25152/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25152/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25152/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25152",
          "number": 25152,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Split util/system into exception, shell, and fs-specific files",
          "body": "This is an attempt to significantly improve code organization while making changes as simple as possible to review.\r\n\r\nHere I split four files out of `util/system`:\r\n* `util/exception`, holding `PrintExceptionContinue`\r\n* `util/shell`, holding `ShellEscape`, `runCommand`\r\n* `util/fs`, holding various file, folder, and path-specific functions (building on `fs.h` and `filesystem`)\r\n* `util/args`, holding `ArgsManager` and related functions\r\n\r\nThe goal was to minimize review burden, so I made an effort to minimize the diffs and only modify the code when it was easy to confirm that the change would not have negative consequences.\r\n\r\nThat said, sourcing all of the windows-related headers was not straightforward, so I expect I'll need to touch this up to correct any issues there.",
          "user": {
            "login": "Empact",
            "id": 5470,
            "node_id": "MDQ6VXNlcjU0NzA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Empact",
            "html_url": "https://github.com/Empact",
            "followers_url": "https://api.github.com/users/Empact/followers",
            "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
            "organizations_url": "https://api.github.com/users/Empact/orgs",
            "repos_url": "https://api.github.com/users/Empact/repos",
            "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Empact/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25152",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25152",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25152.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25152.patch"
          },
          "closed_at": "2023-03-14T11:37:18Z",
          "created_at": "2022-05-17T06:52:25Z",
          "updated_at": "2024-03-13T12:38:20Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-11T23:54:36Z",
      "updated_at": "2022-06-11T23:54:36Z",
      "source": {
        "issue": {
          "id": 1268315381,
          "node_id": "PR_kwDOABII5845gZfQ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25338",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25338/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25338/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25338/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25338",
          "number": 25338,
          "state": "closed",
          "state_reason": null,
          "title": "scripted-diff: Avoid incompatibility with CMake AUTOUIC feature",
          "body": "Working on [migration](https://github.com/hebasto/bitcoin/pull/3) from Autotools to CMake build system, I found that our current code base needs to be adjusted.\r\n\r\nCMake [allows](https://cmake.org/cmake/help/latest/prop_tgt/AUTOUIC.html) to\r\n> handle the Qt `uic` code generator automatically\r\n\r\nWhen using this feature, statements like `#include \"ui_<ui_base>.h\"` are processed in a special way.\r\n\r\nThe `node/ui_interface.h` unintentionally breaks this feature. Of course, it is possible to provide a list of source files to be excluded from `AUTOUIC`. But, unfortunately, this approach does not work for the `qt/sendcoinsdialog.cpp` source file, where there are both https://github.com/bitcoin/bitcoin/blob/b71d37da2c8c8d2a9cef020731767a6929db54b4/src/qt/sendcoinsdialog.cpp#L10 and https://github.com/bitcoin/bitcoin/blob/b71d37da2c8c8d2a9cef020731767a6929db54b4/src/qt/sendcoinsdialog.cpp#L24",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 8,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25338",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25338",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25338.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25338.patch"
          },
          "closed_at": "2022-06-15T06:12:15Z",
          "created_at": "2022-06-11T16:14:42Z",
          "updated_at": "2023-06-15T10:06:30Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6810588799,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGV8VZ_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6810588799",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T08:01:05Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6812916819,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGWFNxT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6812916819",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T13:17:39Z"
    },
    {
      "event": "commented",
      "id": 1156464432,
      "node_id": "IC_kwDOABII585E7j8w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1156464432",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T13:19:41Z",
      "updated_at": "2022-06-15T13:19:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased acfb6089041e7ba18f8778eb97e07d1bba2b5686 -> 4b1ab00331f2e62cddfcb8bb23a0c41be8af3dbd ([`pr/indexy.22`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.22) -> [`pr/indexy.23`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.23), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.22-rebase..pr/indexy.23)) due to conflict with #25338 and silent conflict with #24931",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1156464432",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 6813452380,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGWHQhc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6813452380",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T14:17:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1156738032,
      "node_id": "IC_kwDOABII585E8mvw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1156738032",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T17:22:23Z",
      "updated_at": "2022-06-15T17:22:23Z",
      "author_association": "MEMBER",
      "body": "```\r\nSUMMARY: ThreadSanitizer: data race src/./serialize.h:418:84 in void Wrapper<VarIntFormatter<(VarIntMode)0>, unsigned int const&>::Serialize<CDataStream>(CDataStream&) const\r\n```\r\n\r\nhttps://cirrus-ci.com/task/6321104825352192?logs=ci#L3331",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1156738032",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 6814843565,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGWMkKt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6814843565",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T17:22:51Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "unlabeled",
      "id": 6814843567,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGWMkKv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6814843567",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T17:22:51Z",
      "label": {
        "name": "Build system",
        "color": "5319e7"
      }
    },
    {
      "event": "unlabeled",
      "id": 6814843568,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGWMkKw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6814843568",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T17:22:51Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "unlabeled",
      "id": 6814843569,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGWMkKx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6814843569",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T17:22:51Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "unlabeled",
      "id": 6814843572,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGWMkK0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6814843572",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T17:22:51Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "unlabeled",
      "id": 6814843573,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGWMkK1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6814843573",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T17:22:51Z",
      "label": {
        "name": "interfaces",
        "color": "83c9fc"
      }
    },
    {
      "event": "commented",
      "id": 1156772546,
      "node_id": "IC_kwDOABII585E8vLC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1156772546",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T18:01:19Z",
      "updated_at": "2022-06-15T18:01:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "In general, if there are two threads accessing a variable, and you know the second thread will not access the variable until the first thread is done accessing it, does it matter if no mutex is locked while accessing the variable?\r\n\r\nData race appears to happen reading / writing the `BlockFilterIndex::m_next_filter_pos.nPos` member variable. The variable is incremented in `BlockFilterIndex::CustomAppend` after blockfilter data is written, and it's read in `BlockFilterIndex::CustomCommit` with apparently no synchronization between the two functions. I think there's probably not a real race here. These methods are called from the index sync thread initially, and then the validation thread after that so they are called from two different threads, but the different calls should be synchronized through the validation queue, so I don't think a lock should be necessary just to read this variable. But maybe just adding a lock is the path of least resistance\r\n\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1156772546",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "labeled",
      "id": 6815257044,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGWOJHU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6815257044",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-15T18:32:21Z",
      "label": {
        "name": "Refactoring",
        "color": "E6F6D6"
      }
    },
    {
      "event": "reviewed",
      "id": 1014141911,
      "node_id": "PRR_kwDOABII5848cpPX",
      "url": null,
      "actor": null,
      "commit_id": "4b1ab00331f2e62cddfcb8bb23a0c41be8af3dbd",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "What do you think about splitting out incremental chunks of this to get more review and help things move forward?\r\nI agree with the general approach (as most other reviewers do) and would be confident to ACK the first couple of commits, but I find some of the changes are nontrivial in the details - by the time I'd get to the latest commits I already lost track about the details of the first ones.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1014141911",
      "submitted_at": "2022-06-23T02:21:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1017279086,
      "node_id": "PRR_kwDOABII5848onJu",
      "url": null,
      "actor": null,
      "commit_id": "4b1ab00331f2e62cddfcb8bb23a0c41be8af3dbd",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1014141911\r\n\r\n> What do you think about splitting out incremental chunks of this to get more review and help things move forward?\r\n\r\nThis sounds good I'd be happy to split this up. Any suggestion about which commits would be good to include in a smaller initial PR?",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1017279086",
      "submitted_at": "2022-06-23T16:02:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-24T02:51:40Z",
      "updated_at": "2022-06-24T02:51:40Z",
      "source": {
        "issue": {
          "id": 1283118470,
          "node_id": "PR_kwDOABII5846R8GJ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25462",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25462/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25462/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25462/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25462",
          "number": 25462,
          "state": "closed",
          "state_reason": null,
          "title": "index: ignore BlockConnected if pindex is in chain",
          "body": "This change avoids unnecessary calls to `Rewind`, `WriteBlock`, and `SetBestBlockIndex` if the pindex is an ancestor of m_best_block_index. As the commit message describes, this can happen if the sync thread is almost done catching up, the tip is updated, the sync thread catches up to the new tip and sets m_synced to true, then the BlockConnected event for the new tip comes through. This leads to `WriteBlock` being called twice for the tip (though if more than 1 block is connected, WriteBlock would be called twice for each of them). For the blockfilterindex, this means that the filter file will contain a duplicate entry. The other indices seem to handle this fine. Because the blockfilterindex is not corrupted and the occurrence might be unlikely, I wasn't sure if this was a valuable patch or not (though IMO current behavior is not \"correct\"), so looking for Concept ACK or NACK. I was able to test that the filter file stores a dupe entry by adding some small sleeps.",
          "user": {
            "login": "Crypt-iQ",
            "id": 15145615,
            "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Crypt-iQ",
            "html_url": "https://github.com/Crypt-iQ",
            "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
            "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
            "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
            "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
            "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25462",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25462",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25462.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25462.patch"
          },
          "closed_at": "2022-06-27T12:47:48Z",
          "created_at": "2022-06-24T00:50:17Z",
          "updated_at": "2023-06-27T10:08:15Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1165625977,
      "node_id": "IC_kwDOABII585Fegp5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1165625977",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-24T14:22:37Z",
      "updated_at": "2022-06-24T14:22:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Any suggestion about which commits would be good to include in a smaller initial PR?\r\n\r\nMaybe the first 7 commits, which mostly reduce the use of internal types within the existing index code. The commits after that move things to node, which could be another PR.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1165625977",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6896956439,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGbFzQX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6896956439",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-28T20:02:55Z"
    },
    {
      "event": "reviewed",
      "id": 1022302955,
      "node_id": "PRR_kwDOABII58487xrr",
      "url": null,
      "actor": null,
      "commit_id": "8ca844e3ad924cf85918a5509f58b0eb9ab4c454",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Updated 4b1ab00331f2e62cddfcb8bb23a0c41be8af3dbd -> 8ca844e3ad924cf85918a5509f58b0eb9ab4c454 ([`pr/indexy.23`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.23) -> [`pr/indexy.24`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.24), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.23..pr/indexy.24)) avoiding word locator as suggested and halting sync thread if CustomInit call fails, as suggested",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1022302955",
      "submitted_at": "2022-06-28T20:04:25Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-28T20:14:51Z",
      "updated_at": "2022-06-28T20:14:51Z",
      "source": {
        "issue": {
          "id": 1287832272,
          "node_id": "PR_kwDOABII5846hZTb",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25494",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25494/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25494/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25494/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25494",
          "number": 25494,
          "state": "closed",
          "state_reason": null,
          "title": "indexes: Stop using node internal types",
          "body": "Start transitioning index code away from using internal node types like `CBlockIndex` and `CChain` so index code is less coupled to node code and index code will later be able to stop locking cs_main and sync without having to deal with validationinterface race conditions, and so new indexes are easier to write and can run as plugins or separate processes.\r\n\r\nThis PR contains the first 7 commits from https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1165625977 which have been split off for easier review. Previous review comments can be found in #24230",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25494",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25494",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25494.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25494.patch"
          },
          "closed_at": "2022-07-19T20:43:39Z",
          "created_at": "2022-06-28T20:14:51Z",
          "updated_at": "2023-05-18T18:01:16Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1169189298,
      "node_id": "IC_kwDOABII585FsGmy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169189298",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-28T20:16:47Z",
      "updated_at": "2022-06-28T20:16:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > Any suggestion about which commits would be good to include in a smaller initial PR?\r\n> \r\n> Maybe the first 7 commits, which mostly reduce the use of internal types within the existing index code. The commits after that move things to node, which could be another PR.\r\n\r\nThanks! Done in #25494",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1169189298",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-29T01:50:40Z",
      "updated_at": "2022-06-29T01:50:40Z",
      "source": {
        "issue": {
          "id": 1263730107,
          "node_id": "PR_kwDOABII5845REBZ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25297",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25297/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25297/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25297/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25297",
          "number": 25297,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: group independent db writes on single batched db transaction",
          "body": "The block connection process, same as many other wallet processes, contains plenty individual db writes.\r\n\r\nThis PR batches all the db transaction that occurs along each wallet workflow. Dumping all the information to disk at once atomically at the end of the process.\r\n\r\nThen, for BDB, fixed places where we are flushing to db directly on individual writes. e.g we do it in the in the chain sync/scan process, when an output that belongs to the wallet is found if the address is not inside the address book.â€¨\r\n\r\nPlus, in several places across the wallet flows, we create new `WalletBatch` objects. Which, internally, mean: Increasing the db references number, try to open the db and, for SQLite, setup and bind the statements.\r\nThis PR avoids all this overhead by sharing the same db handler instance through each entire workflow.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 10,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25297",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25297",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25297.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25297.patch"
          },
          "closed_at": "2023-11-18T18:12:38Z",
          "created_at": "2022-06-07T18:55:49Z",
          "updated_at": "2023-11-18T18:12:39Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "unlabeled",
      "id": 6919208914,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGcar_S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6919208914",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-01T15:01:14Z",
      "label": {
        "name": "Refactoring",
        "color": "E6F6D6"
      }
    },
    {
      "event": "labeled",
      "id": 6919301236,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGcbCh0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6919301236",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-01T15:12:58Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-16T01:40:00Z",
      "updated_at": "2022-07-16T01:40:00Z",
      "source": {
        "issue": {
          "id": 1306608078,
          "node_id": "PR_kwDOABII5847gFlM",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25623",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25623/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25623/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25623/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25623",
          "number": 25623,
          "state": "closed",
          "state_reason": null,
          "title": "[kernel 3e/n] Decouple `CDBWrapper` and its kernel users from `ArgsManager`",
          "body": "This is part of the `libbitcoinkernel` project: #24303, https://github.com/bitcoin/bitcoin/projects/18\r\n\r\nThis PR is **_NOT_** dependent on any other PRs.\r\n\r\n-----\r\n\r\nThis PR introduces `::Options` structs and `ApplyArgsManOptions` functions for `CDBWrapper` and its wrappers and descendants in `libbitcoinkernel`. Namely `CBlockTreeDB` and `CCoinsViewDB`.\r\n\r\n`libbitcoinkernel` code can now instantiate these classes by filling in an `::Options` struct without referencing `gArgs`, and non-`libbitcoinkernel` code can use `ApplyArgsManOptions` with a local `ArgsManager`.\r\n\r\nThe `::Options` struct and `ApplyArgsManOptions` duo has been used in many previous `libbitcoinkernel` `ArgsManager` decoupling PRs. See: https://github.com/bitcoin/bitcoin/projects/18",
          "user": {
            "login": "dongcarl",
            "id": 3445290,
            "node_id": "MDQ6VXNlcjM0NDUyOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dongcarl",
            "html_url": "https://github.com/dongcarl",
            "followers_url": "https://api.github.com/users/dongcarl/followers",
            "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
            "organizations_url": "https://api.github.com/users/dongcarl/orgs",
            "repos_url": "https://api.github.com/users/dongcarl/repos",
            "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dongcarl/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 12,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25623",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25623",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25623.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25623.patch"
          },
          "closed_at": "2022-09-26T18:50:10Z",
          "created_at": "2022-07-15T22:52:47Z",
          "updated_at": "2023-09-26T12:12:14Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 7015238688,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGiJAwg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7015238688",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T20:05:01Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "referenced",
      "id": 7023784086,
      "node_id": "REFE_lADOABII585C0HhYzwAAAAGipnCW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7023784086",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "92c8e1849dceea6d4f7de2b58f4c50e5e50762ea",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/92c8e1849dceea6d4f7de2b58f4c50e5e50762ea",
      "created_at": "2022-07-19T20:43:37Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7024218362,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGirRD6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7024218362",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T22:04:33Z"
    },
    {
      "event": "commented",
      "id": 1189597325,
      "node_id": "IC_kwDOABII585G59CN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1189597325",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T22:05:50Z",
      "updated_at": "2022-07-19T22:05:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 8ca844e3ad924cf85918a5509f58b0eb9ab4c454 -> 8360eaa0b283ef525d99288bb9763e568cf430bf ([`pr/indexy.24`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.24) -> [`pr/indexy.25`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.25) after base PR #25494 merge",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1189597325",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 7024699976,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGitGpI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7024699976",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T23:21:38Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1189851823,
      "node_id": "IC_kwDOABII585G67Kv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1189851823",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-20T05:41:51Z",
      "updated_at": "2022-07-20T05:41:51Z",
      "author_association": "MEMBER",
      "body": "```\r\nindex/coinstatsindex.cpp:20:13: error: using decl 'ReadBlockFromDisk' is unused [misc-unused-using-decls,-warnings-as-errors]\r\nusing node::ReadBlockFromDisk;\r\n            ^\r\n/tmp/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/index/coinstatsindex.cpp:20:13: note: remove the using\r\nusing node::ReadBlockFromDisk;\r\n~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~\r\n437 warnings generated.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1189851823",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "labeled",
      "id": 7040879728,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGjq0xw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7040879728",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-21T19:20:38Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7067465808,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGlQPhQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7067465808",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-26T19:04:17Z"
    },
    {
      "event": "commented",
      "id": 1195871814,
      "node_id": "IC_kwDOABII585HR45G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1195871814",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-26T19:05:16Z",
      "updated_at": "2022-07-26T19:05:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 8360eaa0b283ef525d99288bb9763e568cf430bf -> ad9f581fcc7b6e73697f59eb03d10e91d16a09b4 ([`pr/indexy.25`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.25) -> [`pr/indexy.26`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.26), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.25-rebase..pr/indexy.26)) due to conflict with #22485\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1195871814",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "reviewed",
      "id": 1049878909,
      "node_id": "PRR_kwDOABII584-k-F9",
      "url": null,
      "actor": null,
      "commit_id": "ad9f581fcc7b6e73697f59eb03d10e91d16a09b4",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Partial review. This is a tough one so far because logic improvements/changes are intermingled with the (ideally more mechanical) BaseIndex -> BaseIndexNotifications move. Maybe the logic changes are necessary to enable the process separation, and it just can't get any clearer than this.\r\n\r\nI'm in the process of manually testing IBD with txindex, coinstatsindex enabled.\r\n\r\n- [x] 20f2973ae2 indexes, refactor: Remove index prune_violation code\r\n- [x] 151bad5de4 indexes, refactor: Remove index Init method\r\n- [x] 8d0bcf4033 indexes, refactor: Remove index validation interface and block locator code\r\n- [x] fa6efbff7f indexes, refactor: Stop incorrectly calling Interupt() and Stop() in BaseIndex destructor\r\n- [x] e62683db04 indexes, refactor: Add Commit CBlockLocator& argument\r\n- [x] e1e040fdd4 indexes, refactor: Remove remaining CBlockIndex* uses in index Rewind methods\r\n- [x] 16f6a9900a indexes, refactor: Remove remaining CBlockIndex* uses in index CustomAppend methods\r\n\r\nCommit message incorrect: \"Move CustomAppend call from BaseIndex::ThreadSync to BaseIndex::ThreadSync\"\r\n\r\n- [x] bc71b09151 indexes, refactor: Move more new block logic out of ThreadSync to blockConnected\r\n- [x] 627887a9b9 indexes, refactor: Move Commit logic out of ThreadSync to notification handlers\r\n- [-] ac1369650d indexes, refactor: Move Rewind logic out of Rewind to blockDisconnected and ThreadSync\r\n\r\nMaybe just too late in the day, but really couldn't understand the contents of this commit, too much for me.\r\n\r\n- [x] 3038c883fd indexes, refactor: Move CustomInit and error handling code out of ThreadSync to notification handlers\r\n- [ ] 01297836c7 indexes, refactor: Move sync thread from index to node\r\n\r\nIn progress; sadly, my diff tool doesn't consider the contents of ThreadSync() to have been moved.\r\n\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1049878909",
      "submitted_at": "2022-07-26T20:33:11Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "unlabeled",
      "id": 7068018621,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGlSWe9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7068018621",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-26T20:44:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-27T06:43:20Z",
      "updated_at": "2022-07-27T06:43:20Z",
      "source": {
        "issue": {
          "id": 1314840503,
          "node_id": "PR_kwDOABII58478PT1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25673",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25673/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25673/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25673/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25673",
          "number": 25673,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: make member functions const when applicable",
          "body": "I have added a clang-tidy check: 'readability-make-member-function-const'.\r\n> Finds non-static member functions that can be made const because the functions donâ€™t use this in a non-const way.\r\n\r\nI believe this makes the code more maintainable.\r\n\r\nI used clang-tidy with `--fix-errors` and the check `readability-make-member-function-const` to generate the refactor commit.",
          "user": {
            "login": "aureleoules",
            "id": 22493292,
            "node_id": "MDQ6VXNlcjIyNDkzMjky",
            "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aureleoules",
            "html_url": "https://github.com/aureleoules",
            "followers_url": "https://api.github.com/users/aureleoules/followers",
            "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
            "organizations_url": "https://api.github.com/users/aureleoules/orgs",
            "repos_url": "https://api.github.com/users/aureleoules/repos",
            "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/aureleoules/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 10,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25673",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25673",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25673.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25673.patch"
          },
          "closed_at": "2022-10-12T19:04:18Z",
          "created_at": "2022-07-22T10:38:28Z",
          "updated_at": "2023-11-02T12:17:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-27T07:00:33Z",
      "updated_at": "2022-07-27T07:00:33Z",
      "source": {
        "issue": {
          "id": 1311099634,
          "node_id": "PR_kwDOABII5847vFZL",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25648",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25648/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25648/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25648/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25648",
          "number": 25648,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Remove all policy globals",
          "body": "This change is good because:\r\n\r\n* It moves module-specific init-logic out of the bloated init.cpp\r\n* It removes a global from validation.cpp and places it into the data structure that needs it (mempool)",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25648",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25648",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25648.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25648.patch"
          },
          "closed_at": "2022-08-03T08:47:37Z",
          "created_at": "2022-07-20T13:25:03Z",
          "updated_at": "2023-09-26T12:12:13Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 7116903829,
      "node_id": "LE_lADOABII585C0HhYzwAAAAGoM1WV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7116903829",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-03T09:24:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7131147072,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGpDKtA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7131147072",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-04T20:09:54Z"
    },
    {
      "event": "reviewed",
      "id": 1060774316,
      "node_id": "PRR_kwDOABII584_OiGs",
      "url": null,
      "actor": null,
      "commit_id": "ad9f581fcc7b6e73697f59eb03d10e91d16a09b4",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Rebased ad9f581fcc7b6e73697f59eb03d10e91d16a09b4 -> d83caa15e9b46227da9ad9a36da493bcf1de891b ([`pr/indexy.26`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.26) -> [`pr/indexy.27`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.27), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.26-rebase..pr/indexy.27)) due to conflict with #25648, with suggested improvements.\r\n\r\n---\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1049878909\r\n\r\n> Partial review. This is a tough one so far because logic improvements/changes are intermingled with the (ideally more mechanical) BaseIndex -> BaseIndexNotifications move. Maybe the logic changes are necessary to enable the process separation, and it just can't get any clearer than this.\r\n\r\nI broke down the commits just to be able to demonstrate that new code and old code are equivalent, but I don't think you have to care about perfect equivalence to review the PR. If you just want to review final code, I think it's safe to do that and still provide a valid ACK  for the PR without checking the math for equivalence.\r\n\r\n> I'm in the process of manually testing IBD with txindex, coinstatsindex enabled.\r\n\r\nThanks! This is very useful.\r\n\r\n>     * [x]  [16f6a99](https://github.com/bitcoin/bitcoin/commit/16f6a9900abead79f6a437ca1badc9d0db6f4b5b) indexes, refactor: Remove remaining CBlockIndex* uses in index CustomAppend methods\r\n> \r\n> Commit message incorrect: \"Move CustomAppend call from BaseIndex::ThreadSync to BaseIndex::ThreadSync\"\r\n\r\nThanks! Should have been \"from ThreadSync to blockConnected\"\r\n\r\n>     * [-] [ac13696](https://github.com/bitcoin/bitcoin/commit/ac1369650de26f325076340017745c67bdb34900) indexes, refactor: Move Rewind logic out of Rewind to blockDisconnected and ThreadSync\r\n> \r\n> Maybe just too late in the day, but really couldn't understand the contents of this commit, too much for me.\r\n\r\nI simplified the commit a little and added some comments. This is good feedback and it's helps me to know if there are particularly confusing commits like this. In general, I think if you run across any code that doesn't make sense after a few minutes, it probably needs to be clarified or explained better.\r\n\r\n>     * [ ]  [0129783](https://github.com/bitcoin/bitcoin/commit/01297836c7ac40823e5d3a95fe044074dd8c9767) indexes, refactor: Move sync thread from index to node\r\n> \r\n> In progress; sadly, my diff tool doesn't consider the contents of ThreadSync() to have been moved.\r\n\r\nMy git diff with `algorithm = histogram` `colorMoved = dimmed_zebra` and `colorMovedWs = ignore-all-space` shows this as mostly moved. But when I'm reviewing code like this that is moving and changing, I just use git-diff to identify the moves source and destination. Then I paste the moved before and after versions into meld to look at the actual changes. It works pretty work for big chunks of code like this.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1060774316",
      "submitted_at": "2022-08-04T20:11:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "unlabeled",
      "id": 7131466543,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAGpEYsv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7131466543",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-04T21:10:55Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-05T04:13:58Z",
      "updated_at": "2022-08-05T04:13:58Z",
      "source": {
        "issue": {
          "id": 1328770688,
          "node_id": "PR_kwDOABII5848qFdU",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25781/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25781/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25781/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25781",
          "number": 25781,
          "state": "closed",
          "state_reason": null,
          "title": "Remove almost all blockstorage globals",
          "body": "It seems preferable to assign globals to a class (in this case `BlockManager`), than to leave them dangling. This should clarify scope for code-readers, as well as clarifying unit test behaviour.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25781",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25781.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25781.patch"
          },
          "closed_at": "2023-03-15T22:53:41Z",
          "created_at": "2022-08-04T15:02:21Z",
          "updated_at": "2023-03-23T09:30:47Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1210725837,
      "node_id": "IC_kwDOABII585IKjXN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1210725837",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-10T14:07:42Z",
      "updated_at": "2022-08-10T14:07:42Z",
      "author_association": "MEMBER",
      "body": "```\r\nmusing decl 'ReadBlockFromDisk' is unused [misc-unused-using-decls,-warnings-as-errors]ï¿½[0m\r\nusing node::ReadBlockFromDisk;",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1210725837",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7190327730,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAGsk7Gy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7190327730",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-15T17:36:22Z"
    },
    {
      "event": "commented",
      "id": 1215466441,
      "node_id": "IC_kwDOABII585IcovJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1215466441",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-15T17:37:03Z",
      "updated_at": "2022-08-15T17:37:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated d83caa15e9b46227da9ad9a36da493bcf1de891b -> 781c4d775880de4190eecb93442148e2d28e61b2 ([`pr/indexy.27`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.27) -> [`pr/indexy.28`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.28), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.27..pr/indexy.28)) adding mutex to fix blockfilterindex tsan errors https://cirrus-ci.com/task/4753821174857728?logs=ci#L3850 and dropped unused using declaration\r\n\r\n---\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1210725837\r\n\r\n> ```\r\n> using decl 'ReadBlockFromDisk' is unused [misc-unused-using-decls,-warnings-as-errors]\r\n> ```\r\n\r\nThanks, fixed",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1215466441",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-17T17:38:23Z",
      "updated_at": "2022-08-17T17:38:23Z",
      "source": {
        "issue": {
          "id": 1341891304,
          "node_id": "PR_kwDOABII5849VJRd",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25862",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25862/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25862/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25862/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25862",
          "number": 25862,
          "state": "closed",
          "state_reason": null,
          "title": "refactor, kernel: Remove gArgs accesses from dbwrapper and txdb",
          "body": "Code in the libbitcoin_kernel library should not be calling `ArgsManager` methods or trying to read options from the command line. Instead it should just get options values from simple structs and function arguments that are passed in externally. This PR removes `gArgs` accesses from `dbwrapper` and `txdb` modules by defining appropriate options structs, and is a followup to PR's #25290 #25487 #25527 which remove other `ArgsManager` calls from kernel modules.\r\n\r\nThis PR does not change behavior in any way. It is a simpler alternative to #25623 because the only thing it does is remove `gArgs` references from kernel code. It avoids other unnecessary changes like adding options to the kernel API (they can be added separately later).",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25862",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25862",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25862.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25862.patch"
          },
          "closed_at": "2023-02-17T21:55:24Z",
          "created_at": "2022-08-17T14:51:35Z",
          "updated_at": "2024-02-17T12:33:05Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-01T21:35:06Z",
      "updated_at": "2022-09-01T21:35:06Z",
      "source": {
        "issue": {
          "id": 1358692456,
          "node_id": "PR_kwDOABII584-M_rV",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25971",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25971/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25971/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25971/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25971",
          "number": 25971,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Use std::string for thread and index names",
          "body": "As a follow-up to https://github.com/bitcoin/bitcoin/pull/25967#discussion_r959637189, this PR changes the return type of [`BaseIndex::GetName()`](https://github.com/bitcoin/bitcoin/blob/fa5c224d444802dabec5841009e029b9754c92f1/src/index/base.h#L120) to `const std::string&` instead of `const char*`. The first commit is not essential for this change, but since the code is touched and index names are commonly used to specify thread names, I've made the same update there.\r\n\r\nNo behaviour change, just refactoring to further phase out C-style strings.\r\n\r\nNote: `util::ThreadRename()` used to take an rvalue ref, but since it then passes this to `SetInternalName()` by value, I don't think there's any benefit to having both an rvalue and lvalue ref function so I just changed it into lvalue ref. Not 100% sure I'm missing something?",
          "user": {
            "login": "stickies-v",
            "id": 69010457,
            "node_id": "MDQ6VXNlcjY5MDEwNDU3",
            "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/stickies-v",
            "html_url": "https://github.com/stickies-v",
            "followers_url": "https://api.github.com/users/stickies-v/followers",
            "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
            "organizations_url": "https://api.github.com/users/stickies-v/orgs",
            "repos_url": "https://api.github.com/users/stickies-v/repos",
            "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/stickies-v/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 12,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25971",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25971",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25971.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25971.patch"
          },
          "closed_at": "2022-09-16T10:41:22Z",
          "created_at": "2022-09-01T11:26:58Z",
          "updated_at": "2023-09-22T12:11:55Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 7377249226,
      "node_id": "LE_lADOABII585C0HhYzwAAAAG3t-PK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7377249226",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-13T14:27:19Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-19T17:18:35Z",
      "updated_at": "2022-09-19T17:18:35Z",
      "source": {
        "issue": {
          "id": 1269783119,
          "node_id": "I_kwDOABII585Lr1pP",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25365",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25365/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25365/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25365/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/25365",
          "number": 25365,
          "state": "closed",
          "state_reason": "completed",
          "title": "ThreadSanitizer: data race on vptr (ctor/dtor vs virtual call) in BaseIndex",
          "body": "https://cirrus-ci.com/task/6564394053140480?logs=ci#L3875:\r\n```bash\r\nWARNING: ThreadSanitizer: data race on vptr (ctor/dtor vs virtual call) (pid=24158)\r\n  Write of size 8 at 0x7ffe0efae9f8 by main thread:\r\n    #0 BaseIndex::~BaseIndex() src/index/base.cpp:53:1 (test_bitcoin+0xcc6b69)\r\n    #1 CoinStatsIndex::~CoinStatsIndex() src/./index/coinstatsindex.h:17:7 (test_bitcoin+0x3b9b21)\r\n    #2 coinstatsindex_tests::coinstatsindex_initial_sync::test_method() src/test/coinstatsindex_tests.cpp:84:1 (test_bitcoin+0x3b9b21)\r\n    #3 coinstatsindex_tests::coinstatsindex_initial_sync_invoker() src/test/coinstatsindex_tests.cpp:32:1 (test_bitcoin+0x3b814b)\r\n    #4 boost::detail::function::void_function_invoker0<void (*)(), void>::invoke(boost::detail::function::function_buffer&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/function/function_template.hpp:117:11 (test_bitcoin+0x2bbf1d)\r\n    #5 boost::function0<void>::operator()() const /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/function/function_template.hpp:763:14 (test_bitcoin+0x220877)\r\n    #6 boost::detail::forward::operator()() /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:1388:32 (test_bitcoin+0x220877)\r\n    #7 boost::detail::function::function_obj_invoker0<boost::detail::forward, int>::invoke(boost::detail::function::function_buffer&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/function/function_template.hpp:137:18 (test_bitcoin+0x220877)\r\n    #8 boost::function0<int>::operator()() const /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/function/function_template.hpp:763:14 (test_bitcoin+0x1ae59e)\r\n    #9 int boost::detail::do_invoke<boost::shared_ptr<boost::detail::translator_holder_base>, boost::function<int ()> >(boost::shared_ptr<boost::detail::translator_holder_base> const&, boost::function<int ()> const&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:301:30 (test_bitcoin+0x1ae59e)\r\n    #10 boost::execution_monitor::catch_signals(boost::function<int ()> const&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:903:16 (test_bitcoin+0x1ae59e)\r\n    #11 boost::execution_monitor::execute(boost::function<int ()> const&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:1301:16 (test_bitcoin+0x1ae8c0)\r\n    #12 boost::execution_monitor::vexecute(boost::function<void ()> const&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:1397:5 (test_bitcoin+0x1aa21b)\r\n    #13 boost::unit_test::unit_test_monitor_t::execute_and_translate(boost::function<void ()> const&, unsigned long) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/unit_test_monitor.ipp:49:9 (test_bitcoin+0x1aa21b)\r\n    #14 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/framework.ipp:815:44 (test_bitcoin+0x1ddb63)\r\n    #15 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/framework.ipp:784:58 (test_bitcoin+0x1de1d8)\r\n    #16 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/framework.ipp:784:58 (test_bitcoin+0x1de1d8)\r\n    #17 boost::unit_test::framework::run(unsigned long, bool) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/framework.ipp:1721:29 (test_bitcoin+0x1a8e66)\r\n    #18 boost::unit_test::unit_test_main(boost::unit_test::test_suite* (*)(int, char**), int, char**) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/unit_test_main.ipp:250:9 (test_bitcoin+0x1c19c6)\r\n    #19 main /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/unit_test_main.ipp:306:12 (test_bitcoin+0x1c1ff6)\r\n  Previous read of size 8 at 0x7ffe0efae9f8 by thread T1 (mutexes: write M603):\r\n    #0 BaseIndex::SetBestBlockIndex(CBlockIndex const*)::$_1::operator()() const src/index/base.cpp:388:9 (test_bitcoin+0xcc74e6)\r\n    #1 BaseIndex::SetBestBlockIndex(CBlockIndex const*) src/index/base.cpp:388:9 (test_bitcoin+0xcc74e6)\r\n    #2 BaseIndex::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*) src/index/base.cpp:273:9 (test_bitcoin+0xcc9759)\r\n    #3 CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_8::operator()() const::'lambda'(CValidationInterface&)::operator()(CValidationInterface&) const src/validationinterface.cpp:225:79 (test_bitcoin+0x10223a4)\r\n    #4 void MainSignalsImpl::Iterate<CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_8::operator()() const::'lambda'(CValidationInterface&)>(CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_8::operator()() const::'lambda'(CValidationInterface&)&&) src/validationinterface.cpp:86:17 (test_bitcoin+0x10223a4)\r\n    #5 CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_8::operator()() const src/validationinterface.cpp:225:22 (test_bitcoin+0x10223a4)\r\n    #6 CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9::operator()() const src/validationinterface.cpp:227:5 (test_bitcoin+0x10223a4)\r\n    #7 decltype(static_cast<CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9&>(fp)()) std::__1::__invoke<CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9&>(CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9&) /usr/lib/llvm-13/bin/../include/c++/v1/type_traits:3918:1 (test_bitcoin+0x10223a4)\r\n    #8 void std::__1::__invoke_void_return_wrapper<void, true>::__call<CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9&>(CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9&) /usr/lib/llvm-13/bin/../include/c++/v1/__functional/invoke.h:61:9 (test_bitcoin+0x10223a4)\r\n    #9 std::__1::__function::__alloc_func<CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9, std::__1::allocator<CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9>, void ()>::operator()() /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:171:16 (test_bitcoin+0x10223a4)\r\n    #10 std::__1::__function::__func<CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9, std::__1::allocator<CMainSignals::BlockConnected(std::__1::shared_ptr<CBlock const> const&, CBlockIndex const*)::$_9>, void ()>::operator()() /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:345:12 (test_bitcoin+0x10223a4)\r\n    #11 std::__1::__function::__value_func<void ()>::operator()() const /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:498:16 (test_bitcoin+0x10b6b71)\r\n    #12 std::__1::function<void ()>::operator()() const /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:1175:12 (test_bitcoin+0x10b6b71)\r\n    #13 SingleThreadedSchedulerClient::ProcessQueue() src/scheduler.cpp:175:5 (test_bitcoin+0x10b6b71)\r\n    #14 SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1::operator()() const src/scheduler.cpp:144:41 (test_bitcoin+0x10b8875)\r\n    #15 decltype(static_cast<SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1&>(fp)()) std::__1::__invoke<SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1&>(SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1&) /usr/lib/llvm-13/bin/../include/c++/v1/type_traits:3918:1 (test_bitcoin+0x10b8875)\r\n    #16 void std::__1::__invoke_void_return_wrapper<void, true>::__call<SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1&>(SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1&) /usr/lib/llvm-13/bin/../include/c++/v1/__functional/invoke.h:61:9 (test_bitcoin+0x10b8875)\r\n    #17 std::__1::__function::__alloc_func<SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1, std::__1::allocator<SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1>, void ()>::operator()() /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:171:16 (test_bitcoin+0x10b8875)\r\n    #18 std::__1::__function::__func<SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1, std::__1::allocator<SingleThreadedSchedulerClient::MaybeScheduleProcessQueue()::$_1>, void ()>::operator()() /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:345:12 (test_bitcoin+0x10b8875)\r\n    #19 std::__1::__function::__value_func<void ()>::operator()() const /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:498:16 (test_bitcoin+0x10b5b5c)\r\n    #20 std::__1::function<void ()>::operator()() const /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:1175:12 (test_bitcoin+0x10b5b5c)\r\n    #21 CScheduler::serviceQueue() src/scheduler.cpp:62:17 (test_bitcoin+0x10b5b5c)\r\n    #22 ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0::operator()() const src/test/util/setup_common.cpp:160:110 (test_bitcoin+0xa4e7b8)\r\n    #23 decltype(static_cast<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0&>(fp)()) std::__1::__invoke<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0&>(ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0&) /usr/lib/llvm-13/bin/../include/c++/v1/type_traits:3918:1 (test_bitcoin+0xa4e7b8)\r\n    #24 void std::__1::__invoke_void_return_wrapper<void, true>::__call<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0&>(ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0&) /usr/lib/llvm-13/bin/../include/c++/v1/__functional/invoke.h:61:9 (test_bitcoin+0xa4e7b8)\r\n    #25 std::__1::__function::__alloc_func<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0, std::__1::allocator<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0>, void ()>::operator()() /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:171:16 (test_bitcoin+0xa4e7b8)\r\n    #26 std::__1::__function::__func<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0, std::__1::allocator<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0>, void ()>::operator()() /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:345:12 (test_bitcoin+0xa4e7b8)\r\n    #27 std::__1::__function::__value_func<void ()>::operator()() const /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:498:16 (test_bitcoin+0x115760f)\r\n    #28 std::__1::function<void ()>::operator()() const /usr/lib/llvm-13/bin/../include/c++/v1/__functional/function.h:1175:12 (test_bitcoin+0x115760f)\r\n    #29 util::TraceThread(char const*, std::__1::function<void ()>) src/util/thread.cpp:18:9 (test_bitcoin+0x115760f)\r\n    #30 decltype(static_cast<void (*>(fp)(static_cast<char const*>(fp0), static_cast<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0>(fp0))) std::__1::__invoke<void (*)(char const*, std::__1::function<void ()>), char const*, ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0>(void (*&&)(char const*, std::__1::function<void ()>), char const*&&, ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0&&) /usr/lib/llvm-13/bin/../include/c++/v1/type_traits:3918:1 (test_bitcoin+0xa4e3b1)\r\n    #31 void std::__1::__thread_execute<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(char const*, std::__1::function<void ()>), char const*, ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0, 2ul, 3ul>(std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(char const*, std::__1::function<void ()>), char const*, ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0>&, std::__1::__tuple_indices<2ul, 3ul>) /usr/lib/llvm-13/bin/../include/c++/v1/thread:280:5 (test_bitcoin+0xa4e3b1)\r\n    #32 void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(char const*, std::__1::function<void ()>), char const*, ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0> >(void*) /usr/lib/llvm-13/bin/../include/c++/v1/thread:291:5 (test_bitcoin+0xa4e3b1)\r\n  Location is stack of main thread.\r\n  Location is global '??' at 0x7ffe0ef91000 ([stack]+0x00000001d9f8)\r\n  Mutex M603 (0x558df2c934a0) created at:\r\n    #0 pthread_mutex_init <null> (test_bitcoin+0x11cf6f)\r\n    #1 std::__1::recursive_mutex::recursive_mutex() <null> (libc++.so.1+0x49fb3)\r\n    #2 __libc_start_main <null> (libc.so.6+0x29eba)\r\n  Thread T1 'b-scheduler' (tid=24216, running) created by main thread at:\r\n    #0 pthread_create <null> (test_bitcoin+0x11b7fd)\r\n    #1 std::__1::__libcpp_thread_create(unsigned long*, void* (*)(void*), void*) /usr/lib/llvm-13/bin/../include/c++/v1/__threading_support:443:10 (test_bitcoin+0xa47a76)\r\n    #2 std::__1::thread::thread<void (&)(char const*, std::__1::function<void ()>), char const (&) [10], ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0, void>(void (&)(char const*, std::__1::function<void ()>), char const (&) [10], ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0&&) /usr/lib/llvm-13/bin/../include/c++/v1/thread:307:16 (test_bitcoin+0xa47a76)\r\n    #3 ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&) src/test/util/setup_common.cpp:160:42 (test_bitcoin+0xa47a76)\r\n    #4 TestingSetup::TestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&) src/test/util/setup_common.cpp:198:7 (test_bitcoin+0xa47ed9)\r\n    #5 TestChain100Setup::TestChain100Setup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&) src/test/util/setup_common.cpp:246:7 (test_bitcoin+0xa48be3)\r\n    #6 coinstatsindex_tests::coinstatsindex_initial_sync::coinstatsindex_initial_sync() src/test/coinstatsindex_tests.cpp:32:1 (test_bitcoin+0x3b7c8b)\r\n    #7 coinstatsindex_tests::coinstatsindex_initial_sync_invoker() src/test/coinstatsindex_tests.cpp:32:1 (test_bitcoin+0x3b7c8b)\r\n    #8 boost::detail::function::void_function_invoker0<void (*)(), void>::invoke(boost::detail::function::function_buffer&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/function/function_template.hpp:117:11 (test_bitcoin+0x2bbf1d)\r\n    #9 boost::function0<void>::operator()() const /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/function/function_template.hpp:763:14 (test_bitcoin+0x220877)\r\n    #10 boost::detail::forward::operator()() /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:1388:32 (test_bitcoin+0x220877)\r\n    #11 boost::detail::function::function_obj_invoker0<boost::detail::forward, int>::invoke(boost::detail::function::function_buffer&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/function/function_template.hpp:137:18 (test_bitcoin+0x220877)\r\n    #12 boost::function0<int>::operator()() const /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/function/function_template.hpp:763:14 (test_bitcoin+0x1ae59e)\r\n    #13 int boost::detail::do_invoke<boost::shared_ptr<boost::detail::translator_holder_base>, boost::function<int ()> >(boost::shared_ptr<boost::detail::translator_holder_base> const&, boost::function<int ()> const&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:301:30 (test_bitcoin+0x1ae59e)\r\n    #14 boost::execution_monitor::catch_signals(boost::function<int ()> const&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:903:16 (test_bitcoin+0x1ae59e)\r\n    #15 boost::execution_monitor::execute(boost::function<int ()> const&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:1301:16 (test_bitcoin+0x1ae8c0)\r\n    #16 boost::execution_monitor::vexecute(boost::function<void ()> const&) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/execution_monitor.ipp:1397:5 (test_bitcoin+0x1aa21b)\r\n    #17 boost::unit_test::unit_test_monitor_t::execute_and_translate(boost::function<void ()> const&, unsigned long) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/unit_test_monitor.ipp:49:9 (test_bitcoin+0x1aa21b)\r\n    #18 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/framework.ipp:815:44 (test_bitcoin+0x1ddb63)\r\n    #19 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/framework.ipp:784:58 (test_bitcoin+0x1de1d8)\r\n    #20 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/framework.ipp:784:58 (test_bitcoin+0x1de1d8)\r\n    #21 boost::unit_test::framework::run(unsigned long, bool) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/framework.ipp:1721:29 (test_bitcoin+0x1a8e66)\r\n    #22 boost::unit_test::unit_test_main(boost::unit_test::test_suite* (*)(int, char**), int, char**) /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/unit_test_main.ipp:250:9 (test_bitcoin+0x1c19c6)\r\n    #23 main /tmp/cirrus-ci-build/depends/x86_64-pc-linux-gnu/include/boost/test/impl/unit_test_main.ipp:306:12 (test_bitcoin+0x1c1ff6)\r\nSUMMARY: ThreadSanitizer: data race on vptr (ctor/dtor vs virtual call) src/index/base.cpp:53:1 in BaseIndex::~BaseIndex()\r\n==================\r\nExit status: 2\r\n```",
          "user": {
            "login": "fanquake",
            "id": 863730,
            "node_id": "MDQ6VXNlcjg2MzczMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fanquake",
            "html_url": "https://github.com/fanquake",
            "followers_url": "https://api.github.com/users/fanquake/followers",
            "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
            "organizations_url": "https://api.github.com/users/fanquake/orgs",
            "repos_url": "https://api.github.com/users/fanquake/repos",
            "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fanquake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64585,
              "node_id": "MDU6TGFiZWw2NDU4NQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
              "name": "Bug",
              "color": "FBBAAB",
              "default": false
            },
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 14,
          "closed_at": "2022-10-13T03:42:41Z",
          "created_at": "2022-06-13T18:11:10Z",
          "updated_at": "2023-10-13T12:14:30Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7427073244,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAG6sCTc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7427073244",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-21T03:23:39Z"
    },
    {
      "event": "commented",
      "id": 1253157852,
      "node_id": "IC_kwDOABII585Ksavc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1253157852",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-21T03:24:58Z",
      "updated_at": "2022-09-21T03:24:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 781c4d775880de4190eecb93442148e2d28e61b2 -> 8c66a7cc9a22b350dcdc03cec04c123b45ba7f8a ([`pr/indexy.28`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.28) -> [`pr/indexy.29`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.29), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.28-rebase..pr/indexy.29)) due to conflicts with #25222, #24513, and #25971",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1253157852",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 7427359321,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAG6tIJZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7427359321",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-21T04:46:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-29T15:46:29Z",
      "updated_at": "2022-09-29T15:46:29Z",
      "source": {
        "issue": {
          "id": 1388014081,
          "node_id": "PR_kwDOABII584_tU3E",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26188",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26188/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26188/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26188/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26188",
          "number": 26188,
          "state": "closed",
          "state_reason": null,
          "title": "test: silence TSAN false positive in coinstatsindex_initial_sync",
          "body": "Silence false positives from TSAN about unsynchronized calls to `BaseIndex::~BaseIndex()` and `BaseIndex::SetBestBlockIndex()`. They are synchronized, but beyond the comprehension of TSAN - by `SyncWithValidationInterfaceQueue()`, called from `BaseIndex::BlockUntilSyncedToCurrentChain()`.\r\n\r\nFixes https://github.com/bitcoin/bitcoin/issues/25365\r\n",
          "user": {
            "login": "vasild",
            "id": 266751,
            "node_id": "MDQ6VXNlcjI2Njc1MQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vasild",
            "html_url": "https://github.com/vasild",
            "followers_url": "https://api.github.com/users/vasild/followers",
            "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
            "organizations_url": "https://api.github.com/users/vasild/orgs",
            "repos_url": "https://api.github.com/users/vasild/repos",
            "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/vasild/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 13,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26188",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26188",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26188.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26188.patch"
          },
          "closed_at": "2022-10-13T03:43:02Z",
          "created_at": "2022-09-27T16:09:25Z",
          "updated_at": "2023-10-13T12:14:26Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-30T08:40:57Z",
      "updated_at": "2022-09-30T08:40:57Z",
      "source": {
        "issue": {
          "id": 1392079136,
          "node_id": "I_kwDOABII585S-XEg",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26210",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26210/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26210/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26210/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/26210",
          "number": 26210,
          "state": "open",
          "state_reason": null,
          "title": "Remove RegisterValidationInterface()",
          "body": "`RegisterValidationInterface()` takes a bare pointer, remembers it and other threads use it afterwards. This puts a burden on the caller to properly maintain the lifetime of the object which adds complexity and is a source of bugs (https://github.com/bitcoin/bitcoin/issues/25365, https://github.com/bitcoin/bitcoin/pull/26188#discussion_r982751603).\r\n\r\n`shared_ptr` exists with the purpose of resolving that problem exactly. We already have `RegisterSharedValidationInterface()`. I think it should be possible to replace all usages of `RegisterValidationInterface()` with the \"Shared\" alternative. It is used in:\r\n\r\n* `BaseIndex::Start()` passing `this`, is already suggested in [#25365](https://github.com/bitcoin/bitcoin/issues/25365#issuecomment-1251314646) (see last paragraph), [#24230](https://github.com/bitcoin/bitcoin/pull/24230) \"already does this\".\r\n\r\n* `AppInitMain()` passing `g_zmq_notification_interface` which is a global raw ptr, can be changed to global `shared_ptr`.\r\n\r\n* `AppInitMain()` passing `node.peerman.get()` which is `unique_ptr`. Extracting the raw pointer from `unique_ptr`, saving it somewhere else and using it from other threads defeats the purpose of using `unique_ptr` because we must now manually manage the lifetime of the object. `NodeContext::peerman` should be changed from `unique_ptr` to `shared_ptr`.\r\n\r\nThis should make it possible to remove `RegisterValidationInterface()` and `UnregisterValidationInterface()` (which is already deprecated).\r\n\r\nChasing concept ACK.",
          "user": {
            "login": "vasild",
            "id": 266751,
            "node_id": "MDQ6VXNlcjI2Njc1MQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vasild",
            "html_url": "https://github.com/vasild",
            "followers_url": "https://api.github.com/users/vasild/followers",
            "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
            "organizations_url": "https://api.github.com/users/vasild/orgs",
            "repos_url": "https://api.github.com/users/vasild/repos",
            "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/vasild/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 2,
          "created_at": "2022-09-30T08:40:56Z",
          "updated_at": "2022-09-30T15:00:45Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-30T22:34:56Z",
      "updated_at": "2022-09-30T22:34:56Z",
      "source": {
        "issue": {
          "id": 1392433889,
          "node_id": "PR_kwDOABII584_8Cso",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26215",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26215/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26215/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26215/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26215",
          "number": 26215,
          "state": "closed",
          "state_reason": null,
          "title": "index: Improve BaseIndex::BlockUntilSyncedToCurrentChain reliability",
          "body": "Since commit f08c9fb0c6a799e3cb75ca5f763a746471625beb from PR https://github.com/bitcoin/bitcoin/pull/21726, index  `BlockUntilSyncedToCurrentChain` behavior has been less reliable, and there has also been a race condition in the `coinstatsindex_initial_sync` unit test.\r\n\r\nIt seems better for `BlockUntilSyncedToCurrentChain` to actually wait for the last connected block to be fully processed, than to be able to return before prune locks are set, so this switches the order of `m_best_block_index = block;` and `UpdatePruneLock` statements in `SetBestBlockIndex` to make it more reliable.\r\n\r\nAlso since commit f08c9fb0c6a799e3cb75ca5f763a746471625beb, there has been a race condition in the `coinstatsindex_initial_sync` test. Before that commit, the atomic index best block pointer `m_best_block_index` was updated as the last step of `BaseIndex::BlockConnected`, so `BlockUntilSyncedToCurrentChain` could safely be used in tests to wait for the last `BlockConnected` notification to be finished before stopping and destroying the index.  But after that commit, calling `BlockUntilSyncedToCurrentChain` is no longer sufficient, and there is a race between the test shutdown code which destroys the index object and the new code introduced in that commit calling `AllowPrune()` and `GetName()` on the index object. Reproducibility instructions for this are in https://github.com/bitcoin/bitcoin/issues/25365#issuecomment-1259744133\r\n\r\nThis commit fixes the `coinstatsindex_initial_sync` race condition, even though it will require an additional change to silence TSAN false positives, https://github.com/bitcoin/bitcoin/pull/26188, after it is fixed. So this partially addresses but does not resolve the bug reporting TSAN errors https://github.com/bitcoin/bitcoin/issues/25365.\r\n\r\nThere is no known race condition outside of test code currently, because the bitcoind `Shutdown` function calls `FlushBackgroundCallbacks` not `BlockUntilSyncedToCurrentChain` to safely shut down.\r\n\r\nCo-authored-by: vasild\r\nCo-authored-by: MarcoFalke",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/54",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/54",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/54/labels",
            "id": 7150037,
            "node_id": "MI_kwDOABII584AbRnV",
            "number": 54,
            "state": "closed",
            "title": "24.0",
            "description": "",
            "creator": {
              "login": "laanwj",
              "id": 126646,
              "node_id": "MDQ6VXNlcjEyNjY0Ng==",
              "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/laanwj",
              "html_url": "https://github.com/laanwj",
              "followers_url": "https://api.github.com/users/laanwj/followers",
              "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
              "organizations_url": "https://api.github.com/users/laanwj/orgs",
              "repos_url": "https://api.github.com/users/laanwj/repos",
              "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/laanwj/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 159,
            "created_at": "2021-09-14T08:27:02Z",
            "updated_at": "2022-11-29T15:44:44Z",
            "closed_at": "2022-11-29T15:44:44Z"
          },
          "locked": true,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26215",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26215",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26215.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26215.patch"
          },
          "closed_at": "2022-10-10T06:23:20Z",
          "created_at": "2022-09-30T13:21:03Z",
          "updated_at": "2023-10-13T12:14:25Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 7551858847,
      "node_id": "LE_lADOABII585C0HhYzwAAAAHCIDif",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7551858847",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-10T08:21:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7584779126,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAHEFot2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7584779126",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-13T20:17:53Z"
    },
    {
      "event": "commented",
      "id": 1278132877,
      "node_id": "IC_kwDOABII585MLsKN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1278132877",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-13T20:18:40Z",
      "updated_at": "2022-10-13T20:18:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 8c66a7cc9a22b350dcdc03cec04c123b45ba7f8a -> b25b01352ec29a5657813be3ba88c321b7c8fa2b ([`pr/indexy.29`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.29) -> [`pr/indexy.30`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.30), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.29-rebase..pr/indexy.30)) due to conflicts with #26215 and #23549",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1278132877",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 7584824214,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAHEFzuW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7584824214",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-13T20:24:09Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-13T22:16:51Z",
      "updated_at": "2022-10-13T22:16:51Z",
      "source": {
        "issue": {
          "id": 1404156314,
          "node_id": "PR_kwDOABII585Ai6IR",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26292",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26292/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26292/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26292/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26292",
          "number": 26292,
          "state": "closed",
          "state_reason": null,
          "title": "util: move threadinterrupt into util/",
          "body": "Alongside thread and threadnames. It's part of libbitcoin_util.",
          "user": {
            "login": "fanquake",
            "id": 863730,
            "node_id": "MDQ6VXNlcjg2MzczMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fanquake",
            "html_url": "https://github.com/fanquake",
            "followers_url": "https://api.github.com/users/fanquake/followers",
            "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
            "organizations_url": "https://api.github.com/users/fanquake/orgs",
            "repos_url": "https://api.github.com/users/fanquake/repos",
            "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fanquake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26292",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26292",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26292.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26292.patch"
          },
          "closed_at": "2022-11-22T09:53:04Z",
          "created_at": "2022-10-11T07:42:39Z",
          "updated_at": "2023-11-22T12:19:27Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-26T11:01:51Z",
      "updated_at": "2022-10-26T11:01:51Z",
      "source": {
        "issue": {
          "id": 1423467415,
          "node_id": "PR_kwDOABII585BjXau",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26390",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26390/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26390/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26390/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26390",
          "number": 26390,
          "state": "closed",
          "state_reason": null,
          "title": "index: Compare deserialized block hash with the block hash from the blockindex",
          "body": "There is already an integrity check for the blockfilter but there aren't any integrity checks for the block hash that's stored with the blockfilter. We can add this check by comparing the deserialized block hash from the disk with the block hash provided to us by the blockindex.",
          "user": {
            "login": "kcalvinalvin",
            "id": 37185887,
            "node_id": "MDQ6VXNlcjM3MTg1ODg3",
            "avatar_url": "https://avatars.githubusercontent.com/u/37185887?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kcalvinalvin",
            "html_url": "https://github.com/kcalvinalvin",
            "followers_url": "https://api.github.com/users/kcalvinalvin/followers",
            "following_url": "https://api.github.com/users/kcalvinalvin/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/kcalvinalvin/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/kcalvinalvin/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/kcalvinalvin/subscriptions",
            "organizations_url": "https://api.github.com/users/kcalvinalvin/orgs",
            "repos_url": "https://api.github.com/users/kcalvinalvin/repos",
            "events_url": "https://api.github.com/users/kcalvinalvin/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/kcalvinalvin/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 749416508,
              "node_id": "MDU6TGFiZWw3NDk0MTY1MDg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Up%20for%20grabs",
              "name": "Up for grabs",
              "color": "99a810",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26390",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26390.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26390.patch"
          },
          "closed_at": "2023-09-20T16:35:47Z",
          "created_at": "2022-10-26T05:40:05Z",
          "updated_at": "2023-09-20T16:35:57Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-31T07:19:18Z",
      "updated_at": "2022-10-31T07:19:18Z",
      "source": {
        "issue": {
          "id": 1429064895,
          "node_id": "PR_kwDOABII585B19-8",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26426",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26426/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26426/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26426/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26426",
          "number": 26426,
          "state": "open",
          "state_reason": null,
          "title": "WIP: Fix coinstatsindex overflow issue",
          "body": "Closes #26362\r\n\r\nThis changes cumulative values in coinstatsindex to be per-block instead. This is still work in progress and needs further testing and cleanup. Please refer to #26362 for conceptual discussion for now.",
          "user": {
            "login": "fjahr",
            "id": 1322187,
            "node_id": "MDQ6VXNlcjEzMjIxODc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjahr",
            "html_url": "https://github.com/fjahr",
            "followers_url": "https://api.github.com/users/fjahr/followers",
            "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
            "organizations_url": "https://api.github.com/users/fjahr/orgs",
            "repos_url": "https://api.github.com/users/fjahr/repos",
            "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fjahr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26426",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26426",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26426.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26426.patch"
          },
          "created_at": "2022-10-31T00:01:54Z",
          "updated_at": "2024-01-05T10:44:50Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-04T11:53:20Z",
      "updated_at": "2022-11-04T11:53:20Z",
      "source": {
        "issue": {
          "id": 1427424394,
          "node_id": "PR_kwDOABII585Bwjtt",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26415",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26415/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26415/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26415/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26415",
          "number": 26415,
          "state": "closed",
          "state_reason": null,
          "title": "rpc,rest,zmq: faster getblock, NotifyBlock and rest_block by reading raw block",
          "body": "For the `getblock` endpoint with `verbosity=0`, the  `rest_block` REST endpoint for `bin` and `hex`, and zmq `NotifyBlock` we don't have to deserialize the block since we're just sending the raw data. This PR uses `ReadRawBlockFromDisk` instead of `ReadBlockFromDisk` to serve these requests, and only deserializes for `verbosity > 0` and `json` REST requests. See benchmarks in https://github.com/bitcoin/bitcoin/pull/26684.\r\n\r\nBenchmarked using ApacheBench. Requesting block 750,000 in binary 10k times on a single core (set `-rest=1` in config):\r\n`ab -n 10000 -c 1 \"http://127.0.0.1:8332/rest/block/0000000000000000000592a974b1b9f087cb77628bb4a097d5c2c11b3476a58e.bin\"`\r\n\r\nOn master, mean time 15ms.\r\nOn this branch, mean time 1ms.\r\n\r\nFor RPC\r\n```\r\necho '{\"jsonrpc\": \"1.0\", \"id\": \"curltest\", \"method\": \"getblock\", \"params\": [\"0000000000000000000592a974b1b9f087cb77628bb4a097d5c2c11b3476a58e\", 0]}' > /tmp/data.json\r\nab -p /tmp/data.json -n 1000 -c 1 -A user:password \"http://127.0.0.1:8332/\"\r\n```\r\nOn master, mean time 32ms\r\nOn this branch, mean time 13ms",
          "user": {
            "login": "andrewtoth",
            "id": 237213,
            "node_id": "MDQ6VXNlcjIzNzIxMw==",
            "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/andrewtoth",
            "html_url": "https://github.com/andrewtoth",
            "followers_url": "https://api.github.com/users/andrewtoth/followers",
            "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
            "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
            "repos_url": "https://api.github.com/users/andrewtoth/repos",
            "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 13,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26415",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26415",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26415.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26415.patch"
          },
          "closed_at": "2024-03-12T17:18:11Z",
          "created_at": "2022-10-28T15:27:04Z",
          "updated_at": "2024-03-12T17:45:26Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-16T23:52:21Z",
      "updated_at": "2022-11-16T23:52:21Z",
      "source": {
        "issue": {
          "id": 652920165,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ1OTI3NjM1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19463",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19463/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19463/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19463/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19463",
          "number": 19463,
          "state": "open",
          "state_reason": null,
          "title": "Prune locks",
          "body": "This adds the ability to have any number of internal or external locks to prevent pruning specific block ranges.\r\n\r\nSome examples where this would be useful:\r\n\r\n* Ensuring any known Core wallet won't become unable to sync due to pruning when it is unloaded. (Included in this PR)\r\n* Ensuring pruning doesn't go too far for a desired-functional wallet backup. (Questionable, since you probably lose the node if you need the backup anyway?)\r\n* Allowing users to temporarily disable block indexes and filters, without pruning cutting them off from catching up later.\r\n* Avoiding pruning out from under external wallets (Armory, EPS, etc) that might need block data.\r\n* External block indexes/filters, etc.\r\n\r\nBy design, users retain complete control over prune locks, and can delete them out from under applications using them. This is to avoid circumstances where a prune lock has been set, by an application that may no longer be used.\r\n",
          "user": {
            "login": "luke-jr",
            "id": 1095675,
            "node_id": "MDQ6VXNlcjEwOTU2NzU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/luke-jr",
            "html_url": "https://github.com/luke-jr",
            "followers_url": "https://api.github.com/users/luke-jr/followers",
            "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
            "organizations_url": "https://api.github.com/users/luke-jr/orgs",
            "repos_url": "https://api.github.com/users/luke-jr/repos",
            "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/luke-jr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 219890555,
              "node_id": "MDU6TGFiZWwyMTk4OTA1NTU=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Block%20storage",
              "name": "Block storage",
              "color": "000000",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 19,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19463",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19463",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19463.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19463.patch"
          },
          "created_at": "2020-07-08T04:03:17Z",
          "updated_at": "2024-03-15T10:46:09Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 7866795478,
      "node_id": "LE_lADOABII585C0HhYzwAAAAHU5cXW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7866795478",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-22T11:15:26Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7904201573,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAHXIItl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7904201573",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-28T15:40:23Z"
    },
    {
      "event": "commented",
      "id": 1329448150,
      "node_id": "IC_kwDOABII585PPcTW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1329448150",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-28T17:08:16Z",
      "updated_at": "2022-11-28T17:08:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased b25b01352ec29a5657813be3ba88c321b7c8fa2b -> f8a26680e902820dc3ee84e1fa91f80c3668a10f ([`pr/indexy.30`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.30) -> [`pr/indexy.31`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.31), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.30-rebase..pr/indexy.31)) due to conflicts with #25957 and #26292",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1329448150",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 7905322404,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAHXMaWk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7905322404",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-28T17:44:49Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1196377214,
      "node_id": "PRR_kwDOABII585HT0R-",
      "url": null,
      "actor": null,
      "commit_id": "f8a26680e902820dc3ee84e1fa91f80c3668a10f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "### Partial review\r\n\r\nI put about 8 hours into reviewing commits locally.\r\nEvery time I review this PR I seem to drop off earlier and earlier - not a great\r\ntestament to the health of my brain I guess.\r\n\r\nFunny enough I had forgotten I'd written this in a previous review, but it still\r\ncaptures my sentiments pretty exactly:\r\n\r\n> At a high level I think this is a great change - the more \"peripheral\" parts\r\n> of the system we can put on the other side of the Chain interface, the easier\r\n> it is to carve off those parts both in terms of process separation (limiting\r\n> \"contagion\" risk of non-essential code) and deeper modularization (allowing\r\n> for more straightforward progression of e.g. libbitcoinkernel). The indexing\r\n> system is a great candidate for this kind of change, and I'm really glad to\r\n> see this PR doing it.\r\n>\r\n> That said, it took me a while to get through the changes. ~~I think there's some\r\n> potentially unnecessary churn within the commits (noted below).~~ While the code\r\n> quality is very good, behavioral equivalence with existing code is not\r\n> immediately obvious to me when reading through the changes (given there are just\r\n> so many of them), and so to have confidence that this PR isn't really changing\r\n> any behavior, I'm really going to need to dig in and do some testing as well as\r\n> review the coverage of the existing functional tests.\r\n\r\nI'd really like to sign off on this code, but I don't feel like I have the\r\nhorsepower to actually review the latter part of the changeset with much\r\nconfidence. It'd almost be easier to review the entire thing squashed down IMO.\r\nIf I ACK'd as-is, I'd be leaning on correctness verification via manual testing\r\nand verifying functional coverage.\r\n\r\nI feel bad because you've put a ton of work into this PR, and I don't\r\nwant to be throwing out \"stop energy;\" I'm just having a really tough time\r\nreading through this and convincing myself that I understand it's correct.\r\n\r\n---\r\n\r\nCould we somehow characterize in the PR description the general strategy\r\nexplaining what's happening in the middle commits - i.e.  why exactly are we\r\nwanting to move code out of ThreadSync and into notification handler classes? I\r\nunderstand that this probably has to do with keeping node code on the node, but\r\ngetting some kind of clear definition in the PR description might help. I.e.\r\nwhich processes/threads which classes are executed on.\r\n\r\nI don't have a good model that helps me understand, e.g., why we want to avoid\r\n`FatalError()` in `ThreadSync()` and instead set `block_info.error`.\r\n\r\n### Raw notes\r\n\r\n- [x] 257ef9f7b9 indexes, refactor: Remove index prune_violation code\r\n\r\nSimple change; introduces `hasDataFromTipDown()` and moves. Some variable\r\nrenames.\r\n\r\n- [x] 2f71f52b9b indexes, refactor: Remove index Init method\r\n\r\nOne of the keys to reviewing this commit is to compare Init() with\r\nattachChain().\r\n\r\nBasically, this move index initialization from `Index::Init()` into a combination of\r\n`attachChain()` and the first `blockConnected()` call. BlockConnected events are\r\nmoved from being called within the same process to the BaseIndexNotifications\r\nobject which is attached to the Chain instance and holds a reference to the\r\nindex object itself.\r\n\r\n- [x] ecedecac38 indexes, refactor: Remove index validationinterface hooks\r\n- [x] 5e07d66a6d indexes, refactor: Stop incorrectly calling Interupt() and Stop() in BaseIndex destructor\r\n- [x] c2ab79db68 indexes, refactor: Add Commit CBlockLocator& argument\r\n- [x] f3d1bdae0e indexes, refactor: Remove remaining CBlockIndex* uses in index Rewind methods\r\n\r\nPerhaps useful to keep in mind that the motivation for moving Rewind() from a\r\nrange of blocks to a single block at a time (Remove()) is to avoid usage of\r\nCBlockIndex* entries.\r\n\r\n- [x] a6d1c22dc1 indexes, refactor: Remove remaining CBlockIndex* uses in index CustomAppend methods\r\n- [x] 8b63269e7c indexes, refactor: Move more new block logic out of ThreadSync to blockConnected\r\n- [x] 1df5b0b6f9 indexes, refactor: Move Commit logic out of ThreadSync to notification handlers\r\n\r\nNice improvement to avoid duplicating commit/chainStateFlushed logic.\r\n\r\n- [ ] 15f8349271 indexes, refactor: Move Rewind logic out of Rewind to blockDisconnected and ThreadSync\r\n\r\nMinor typo in the commit message: \"This main thing\" -> \"The main thing\".\r\n\r\nThis is the hardest commit for me to follow. It's distributing the contents\r\nof `Rewind()` over `ThreadSync()` and `blockDisconnected()`.\r\n\r\nI'm not sure how to decompose this to make it easier to follow, but it's a real\r\nchallenge for me to feel confident about this not changing behavior.\r\n\r\n- [ ] ed79c47c13 indexes, refactor: Move CustomInit and error handling code out of ThreadSync to notification handlers\r\n\r\nI don't have a good model that helps me understand, e.g., why we want to avoid\r\n`FatalError()` in `ThreadSync()` and instead set `block_info.error`.\r\n\r\n- [x] 2897678732 indexes: Add blockfilterindex mutex\r\n- [x] 53a1aa56af indexes, refactor: Move sync thread from index to node\r\n\r\nMove-only stuff is pretty clear. So now the initial index sync is going to\r\nhappen all in the node process? Would there be a way to offload this to the\r\nindex processes?\r\n\r\n- [x] ac61e33545 indexes, refactor: Remove SyncWithValidationInterfaceQueue call\r\n- [ ] 2eceaee59f indexes: Rewrite chain sync logic, remove racy init\r\n- [ ] e2f6c6ddf7 indexes: Initialize indexes without holding cs_main\r\n- [ ] 3543161c82 indexes, refactor: Remove UndoReadFromDisk calls from indexing code\r\n- [ ] 5cadd3636e indexes, refactor: Remove remaining CBlockIndex* pointers from indexing code\r\n- [ ] f8a26680e9 Remove direct index -> node dependency",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1196377214",
      "submitted_at": "2022-11-29T18:43:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "commented",
      "id": 1331628048,
      "node_id": "IC_kwDOABII585PXwgQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1331628048",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-30T04:24:25Z",
      "updated_at": "2022-11-30T04:24:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the feedback, and for trying to tackle this. This is just a quick response and I will work more on this later.\r\n\r\n> I don't feel like I have the horsepower to actually review the latter part of the changeset with much confidence. It'd almost be easier to review the entire thing squashed down IMO. If I ACK'd as-is, I'd be leaning on correctness verification via manual testing and verifying functional coverage.\r\n\r\nYes, this I think this is a good approach, and I think I recommended it previously. The best way to review the whole PR is to look at the squashed code, and make sure it indexing blocks correctly. There's no reason to pore over the individual commits, they are meant to be illustrative, and to communicate which code changes are intended to change application behavior, and which code changes which are intended to be refactoring.\r\n\r\nThe way I would review this would be to read commit descriptions in sequence, look over the code in each commit and make sure it doing what's described with no obvious surprises, and that things that are being described move in a coherent direction and make sense.\r\n\r\nThen I'd review final squashed code in detail and look closely at the final implementation for bugs.\r\n \r\n> I feel bad because you've put a ton of work into this PR, and I don't want to be throwing out \"stop energy;\" I'm just having a really tough time reading through this and convincing myself that I understand it's correct.\r\n> \r\n> Could we somehow characterize in the PR description the general strategy explaining what's happening in the middle commits - i.e. why exactly are we wanting to move code out of ThreadSync and into notification handler classes? I understand that this probably has to do with keeping node code on the node, but getting some kind of clear definition in the PR description might help. I.e. which processes/threads which classes are executed on.\r\n\r\nI'll work on this but the answer is that just that if every individual index and every individual wallet is individually rereading the same blocks on startup it is worse for performance and responsiveness than if they tell the node what blocks they need to read, and let it feed them the data. It can also deduplicate code between wallets and indexes, provide better feedback about overall sync progress, and make it straightforward to write new clients that need to be informed about connected and disconnected blocks and stay in sync with the chain.\r\n\r\n> I don't have a good model that helps me understand, e.g., why we want to avoid `FatalError()` in `ThreadSync()` and instead set `block_info.error`.\r\n\r\nProbably this is an example of something that I need to document better in the context of a specific commit, but in general failure to sync a specific index (or wallet) should just result in failure to load that index not necessarily a fatal error that should bring down the node.\r\n\r\n> * [ ]  [15f8349](https://github.com/bitcoin/bitcoin/commit/15f83492713abefea3f6ffc7e4c100a6177cc462) indexes, refactor: Move Rewind logic out of Rewind to blockDisconnected and ThreadSync\r\n> \r\n> This is the hardest commit for me to follow. It's distributing the contents of `Rewind()` over `ThreadSync()` and `blockDisconnected()`.\r\n> \r\n> I'm not sure how to decompose this to make it easier to follow, but it's a real challenge for me to feel confident about this not changing behavior.\r\n\r\nI don't think this is something that's especially important to check or feel confident about. This reminds me of high school physics tests that would sometimes punish you for showing extra work. If you skipped steps and just started from an equation that seemed like it might give a right answer, that could be a safer than actually thinking about the problem and showing extra work that grader could find fault with.\r\n\r\nIn this case, if I'm looking at a PR that has combination of refactoring changes and behavioral changes, I think it is helpful to know which changes are which, and what the intent is behind various changes, even if in the end I am only looking for serious bugs, and I'm not tediously verifying that there is no behavior change _whatsoever_.\r\n \r\n> Move-only stuff is pretty clear. So now the initial index sync is going to happen all in the node process? Would there be a way to offload this to the index processes?\r\n\r\nIf concern is about performance, this PR by itself shouldn't affect that,  since attachChain is keeping the one thread per index, all threads racing each other to reread the same blocks synchronization model. Moving the block reading code out of the indexes just allows for more coordination and better performance and monitoring in the future.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1331628048",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-12-26T23:53:43Z",
      "updated_at": "2022-12-26T23:53:43Z",
      "source": {
        "issue": {
          "id": 1510785035,
          "node_id": "PR_kwDOABII585GMXxQ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26752",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26752/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26752/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26752/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26752",
          "number": 26752,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Remove `mempool_sequence` from interface methods",
          "body": "This PR removes `mempool_sequence` from `transactionRemovedFromMempool` and `transactionAddedToMempool`.\r\n\r\n`mempool_sequence` is  not used in these methods, only in ZMQ notifications.",
          "user": {
            "login": "w0xlt",
            "id": 94266259,
            "node_id": "U_kgDOBZ5jkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/w0xlt",
            "html_url": "https://github.com/w0xlt",
            "followers_url": "https://api.github.com/users/w0xlt/followers",
            "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
            "organizations_url": "https://api.github.com/users/w0xlt/orgs",
            "repos_url": "https://api.github.com/users/w0xlt/repos",
            "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/w0xlt/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26752",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26752",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26752.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26752.patch"
          },
          "closed_at": "2023-01-04T17:54:27Z",
          "created_at": "2022-12-26T09:28:29Z",
          "updated_at": "2024-01-05T12:23:53Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-01T01:52:38Z",
      "updated_at": "2023-01-01T01:52:38Z",
      "source": {
        "issue": {
          "id": 1515110645,
          "node_id": "PR_kwDOABII585Ga5IP",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26780",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26780/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26780/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26780/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26780",
          "number": 26780,
          "state": "closed",
          "state_reason": null,
          "title": "rpc: simplify scan blocks",
          "body": "Coming from https://github.com/bitcoin/bitcoin/pull/23549#pullrequestreview-1105712566\r\n\r\nThe current `scanblocks` flow walks-through every block in the active chain\r\nuntil hits the chain tip or processes 10k blocks, then calls `lookupFilterRange`\r\nfunction to obtain all filters from that particular range.\r\n\r\nThis is only done to obtain the heights range to look up the block\r\nfilters. Which is unneeded.\r\n\r\nAs `scanblocks` only lookup block filters in the active chain, we can\r\ndirectly calculate the lookup range heights, by using the chain tip,\r\nwithout requiring to traverse the chain block by block.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26780",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26780",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26780.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26780.patch"
          },
          "closed_at": "2023-05-01T13:10:37Z",
          "created_at": "2022-12-31T12:38:13Z",
          "updated_at": "2023-05-01T13:12:08Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 8154179866,
      "node_id": "LE_lADOABII585C0HhYzwAAAAHmBuka",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8154179866",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-04T20:02:37Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1252096494,
      "node_id": "PRR_kwDOABII585KoXnu",
      "url": null,
      "actor": null,
      "commit_id": "f8a26680e902820dc3ee84e1fa91f80c3668a10f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\n257ef9f7b9537c5305a9d92afba541a73ec6c8c0: Now that the chunk of code is in a function, we can directly `return` the boolean and cleanup the logic.\r\n\r\n```diff\r\ndiff --git a/src/node/interfaces.cpp b/src/node/interfaces.cpp\r\nindex 8c9a0b013..c05b5954a 100644\r\n--- a/src/node/interfaces.cpp\r\n+++ b/src/node/interfaces.cpp\r\n@@ -729,35 +729,31 @@ public:\r\n     bool hasDataFromTipDown(const CBlockIndex* start_block) override {\r\n         LOCK(::cs_main);\r\n         const CChain& active_chain = Assert(m_node.chainman)->ActiveChain();\r\n-        bool prune_violation = false;\r\n         if (!start_block) {\r\n             // make sure we have all block data back to the genesis\r\n-            prune_violation = m_node.chainman->m_blockman.GetFirstStoredBlock(*active_chain.Tip()) != active_chain.Genesis();\r\n+            return m_node.chainman->m_blockman.GetFirstStoredBlock(*active_chain.Tip()) == active_chain.Genesis();\r\n         }\r\n         // in case the index has a best block set and is not fully synced\r\n         // check if we have the required blocks to continue building the index\r\n-        else {\r\n-            const CBlockIndex* block_to_test = start_block;\r\n-            if (!active_chain.Contains(block_to_test)) {\r\n-                // if the bestblock is not part of the mainchain, find the fork\r\n-                // and make sure we have all data down to the fork\r\n-                block_to_test = active_chain.FindFork(block_to_test);\r\n-            }\r\n-            const CBlockIndex* block = active_chain.Tip();\r\n-            prune_violation = true;\r\n-            // check backwards from the tip if we have all block data until we reach the indexes bestblock\r\n-            while (block_to_test && block && (block->nStatus & BLOCK_HAVE_DATA)) {\r\n-                if (block_to_test == block) {\r\n-                    prune_violation = false;\r\n-                    break;\r\n-                }\r\n-                // block->pprev must exist at this point, since block_to_test is part of the chain\r\n-                // and thus must be encountered when going backwards from the tip\r\n-                assert(block->pprev);\r\n-                block = block->pprev;\r\n+        const CBlockIndex* block_to_test = start_block;\r\n+        if (!active_chain.Contains(block_to_test)) {\r\n+            // if the bestblock is not part of the mainchain, find the fork\r\n+            // and make sure we have all data down to the fork\r\n+            block_to_test = active_chain.FindFork(block_to_test);\r\n+        }\r\n+        const CBlockIndex* block = active_chain.Tip();\r\n+        // check backwards from the tip if we have all block data until we reach the indexes bestblock\r\n+        while (block_to_test && block && (block->nStatus & BLOCK_HAVE_DATA)) {\r\n+            if (block_to_test == block) {\r\n+                return true;\r\n             }\r\n+            // block->pprev must exist at this point, since block_to_test is part of the chain\r\n+            // and thus must be encountered when going backwards from the tip\r\n+            assert(block->pprev);\r\n+            block = block->pprev;\r\n         }\r\n-        return !prune_violation;\r\n+\r\n+        return false;\r\n     }\r\n     std::unique_ptr<Handler> handleNotifications(std::shared_ptr<Notifications> notifications) override\r\n     {\r\n```",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1252096494",
      "submitted_at": "2023-01-17T17:25:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8325331860,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAHwOnuU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8325331860",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-20T21:32:34Z"
    },
    {
      "event": "unlabeled",
      "id": 8325510989,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAHwPTdN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8325510989",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-20T22:03:41Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-21T00:40:07Z",
      "updated_at": "2023-01-21T00:40:07Z",
      "source": {
        "issue": {
          "id": 1536107685,
          "node_id": "PR_kwDOABII585HhxXW",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26903",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26903/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26903/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26903/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26903",
          "number": 26903,
          "state": "closed",
          "state_reason": null,
          "title": "Fix BaseIndex::Commit false error",
          "body": "Previously an ERROR was logged every time an index was initialized. Now we only record an error on actual error.\r\n",
          "user": {
            "login": "pstratem",
            "id": 620611,
            "node_id": "MDQ6VXNlcjYyMDYxMQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pstratem",
            "html_url": "https://github.com/pstratem",
            "followers_url": "https://api.github.com/users/pstratem/followers",
            "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
            "organizations_url": "https://api.github.com/users/pstratem/orgs",
            "repos_url": "https://api.github.com/users/pstratem/repos",
            "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/pstratem/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 749416508,
              "node_id": "MDU6TGFiZWw3NDk0MTY1MDg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Up%20for%20grabs",
              "name": "Up for grabs",
              "color": "99a810",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 11,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26903",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26903",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26903.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26903.patch"
          },
          "closed_at": "2023-09-26T15:41:17Z",
          "created_at": "2023-01-17T10:10:04Z",
          "updated_at": "2023-09-27T21:00:18Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-21T00:43:27Z",
      "updated_at": "2023-01-21T00:43:27Z",
      "source": {
        "issue": {
          "id": 1535194638,
          "node_id": "PR_kwDOABII585HevPF",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26900",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26900/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26900/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26900/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26900",
          "number": 26900,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Add BlockManager getters",
          "body": "Requested in https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1061323795, but adding getters seems unrelated from removing globals, so I split it out for now.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26900",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26900",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26900.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26900.patch"
          },
          "closed_at": "2023-01-27T16:35:08Z",
          "created_at": "2023-01-16T16:20:58Z",
          "updated_at": "2024-03-19T12:39:11Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-21T01:30:57Z",
      "updated_at": "2023-01-21T01:30:57Z",
      "source": {
        "issue": {
          "id": 1513046367,
          "node_id": "PR_kwDOABII585GT-tn",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26763",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26763/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26763/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26763/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26763",
          "number": 26763,
          "state": "closed",
          "state_reason": null,
          "title": "ci: Treat IWYU violations as errors",
          "body": "Fixes the https://github.com/bitcoin/bitcoin/pull/24831#discussion_r861835262:\r\n> Not sure if this is setting the return code to non-zero if it fails?",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 16,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26763",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26763",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26763.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26763.patch"
          },
          "closed_at": "2023-02-02T20:09:08Z",
          "created_at": "2022-12-28T18:17:13Z",
          "updated_at": "2024-02-02T12:27:25Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1264607249,
      "node_id": "PRR_kwDOABII585LYGAR",
      "url": null,
      "actor": null,
      "commit_id": "137bbe1478833ccc63f39f794816d35de14025b8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1264607249",
      "submitted_at": "2023-01-21T09:28:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-24T07:17:07Z",
      "updated_at": "2023-01-24T07:17:07Z",
      "source": {
        "issue": {
          "id": 1525874732,
          "node_id": "PR_kwDOABII585G_d-D",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26857/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26857",
          "number": 26857,
          "state": "closed",
          "state_reason": null,
          "title": "OP_VAULT draft",
          "body": "This is a draft for a consensus change enabling on-chain vaults, as detailed in the BIP: https://github.com/bitcoin/bips/pull/1421\r\n\r\nIn short, it introduces two opcodes, `OP_VAULT` and `OP_UNVAULT`, that facilitate constructing vaults which\r\n\r\n- allow multiple deposits,\r\n- allow partial unvaultings and recursive re-vaults,\r\n- allow batch operations (recoveries and unvaultings) using vaults with compatible parameters,\r\n- support dynamic withdrawal target specification, and\r\n- support robust fee management.\r\n\r\nFor the last item, the proposal has a hard dependency on package relay and ephemeral anchors.\r\n\r\nThe code as-written here lacks specific activation mechanism, and there's probably some policy/wallet stuff missing,\r\n but in substance it is implemented and comes with some interesting functional tests.\r\n",
          "user": {
            "login": "jamesob",
            "id": 73197,
            "node_id": "MDQ6VXNlcjczMTk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jamesob",
            "html_url": "https://github.com/jamesob",
            "followers_url": "https://api.github.com/users/jamesob/followers",
            "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
            "organizations_url": "https://api.github.com/users/jamesob/orgs",
            "repos_url": "https://api.github.com/users/jamesob/repos",
            "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jamesob/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 192202000,
              "node_id": "MDU6TGFiZWwxOTIyMDIwMDA=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Consensus",
              "name": "Consensus",
              "color": "009800",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26857",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26857",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26857.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26857.patch"
          },
          "closed_at": "2023-03-21T16:41:32Z",
          "created_at": "2023-01-09T16:02:53Z",
          "updated_at": "2023-03-21T16:41:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-25T16:47:02Z",
      "updated_at": "2023-01-25T16:47:02Z",
      "source": {
        "issue": {
          "id": 1556671710,
          "node_id": "PR_kwDOABII585Ig7Js",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26966",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26966/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26966/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26966/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26966",
          "number": 26966,
          "state": "open",
          "state_reason": null,
          "title": "index: blockfilter initial sync speedup, parallelize process",
          "body": "-- Focus is on #28955 first --\r\n\r\nThe current procedure for building the block filter index involves processing filters one at a time;\r\nReading blocks, undo data, and previous headers from disk sequentially.\r\n\r\nThis PR introduces a new mechanism to perform the work concurrently. Dividing the filters\r\ngeneration workload among a pool of workers that can be configured by the user,\r\nsignificantly increasing the speed of the index construction process.\r\n\r\nThe same concurrent processing model has been applied to the transactions index as well.\r\n\r\nThe newly introduced init flag `-indexworkers=<n>` enables the concurrent sync\r\nbehavior.\r\nWhere \"n\" is the number of worker threads that will be spawned at startup to create ranges\r\nof block filters during the initial sync process. Destroying the workers pool once the\r\ninitial sync completes.\r\nNote: by default, the parallelized sync process is not enabled.\r\n\r\nNow the juicy part:\r\nIn my computer, with the node in debug mode and on IBD, with `-indexworkers=4`, the\r\nblock filter index generation took less than an hour. While, in master, the sync took more than 7 hours.\r\n\r\nImportant Note:\r\nAs the access to the block data on disk is protected by `cs_main`, this new feature runs substantially\r\nfaster when the node is not in IBD.\r\n\r\nFootnote:\r\nThis is part of a larger project :).",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 13,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26966",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26966",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26966.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26966.patch"
          },
          "created_at": "2023-01-25T13:36:23Z",
          "updated_at": "2024-03-17T22:13:18Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 8375576980,
      "node_id": "LE_lADOABII585C0HhYzwAAAAHzOSmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8375576980",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-27T17:30:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8491043790,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAH6GwvO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8491043790",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T15:25:45Z"
    },
    {
      "event": "unlabeled",
      "id": 8491613160,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAH6I7vo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8491613160",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T16:22:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8492747066,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAH6NQk6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8492747066",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-10T18:42:45Z"
    },
    {
      "event": "labeled",
      "id": 8551782798,
      "node_id": "LE_lADOABII585C0HhYzwAAAAH9udmO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8551782798",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-17T23:35:50Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8631652625,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAICfJER",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8631652625",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-28T21:30:11Z"
    },
    {
      "event": "unlabeled",
      "id": 8632089717,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAICgzx1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8632089717",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-28T22:33:38Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-01T07:59:01Z",
      "updated_at": "2023-03-01T07:59:01Z",
      "source": {
        "issue": {
          "id": 1590648067,
          "node_id": "PR_kwDOABII585KSHhz",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27125",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27125/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27125/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27125/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27125",
          "number": 27125,
          "state": "closed",
          "state_reason": null,
          "title": "refactor, kernel: Decouple ArgsManager from blockstorage",
          "body": "The libbitcoin_kernel library should not rely on the `ArgsManager`, but rather use option structs that can be passed to the various classes it uses. This PR removes reliance on the `ArgsManager` from the `blockstorage.*` files. Like similar prior work, it uses the options struct in the `BlockManager` that can be populated with `ArgsManager` values.\r\n\r\nSome related prior work: https://github.com/bitcoin/bitcoin/pull/26889 https://github.com/bitcoin/bitcoin/pull/25862 https://github.com/bitcoin/bitcoin/pull/25527 https://github.com/bitcoin/bitcoin/pull/25487\r\n\r\nRelated PR removing blockstorage globals: https://github.com/bitcoin/bitcoin/pull/25781",
          "user": {
            "login": "TheCharlatan",
            "id": 8421793,
            "node_id": "MDQ6VXNlcjg0MjE3OTM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TheCharlatan",
            "html_url": "https://github.com/TheCharlatan",
            "followers_url": "https://api.github.com/users/TheCharlatan/followers",
            "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
            "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
            "repos_url": "https://api.github.com/users/TheCharlatan/repos",
            "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 35,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27125",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27125",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27125.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27125.patch"
          },
          "closed_at": "2023-05-11T09:29:03Z",
          "created_at": "2023-02-19T11:10:11Z",
          "updated_at": "2023-05-11T09:29:03Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-04T16:41:14Z",
      "updated_at": "2023-04-04T16:41:14Z",
      "source": {
        "issue": {
          "id": 1653866076,
          "node_id": "PR_kwDOABII585NlaIF",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27419",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27419/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27419/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27419/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27419",
          "number": 27419,
          "state": "closed",
          "state_reason": null,
          "title": "move-only: Extract common/args from util/system",
          "body": "This pull request is part of the `libbitcoinkernel` project https://github.com/bitcoin/bitcoin/issues/24303 https://github.com/bitcoin/bitcoin/projects/18 and more specifically its \"Step 2: Decouple most non-consensus code from libbitcoinkernel\". It is part of a series of patches splitting up the `util/system` files. Its preceding pull request is https://github.com/bitcoin/bitcoin/pull/27254.\r\n\r\nThe pull request contains an extraction of ArgsManager related functions from util/system into their own common/ file.\r\n\r\nThe background of this commit is an ongoing effort to decouple the libbitcoinkernel library from the ArgsManager. The ArgsManager belongs into the common library, since the kernel library should not depend on it. See [doc/design/libraries.md](https://github.com/bitcoin/bitcoin/blob/master/doc/design/libraries.md) for more information on this rationale.\r\n",
          "user": {
            "login": "TheCharlatan",
            "id": 8421793,
            "node_id": "MDQ6VXNlcjg0MjE3OTM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TheCharlatan",
            "html_url": "https://github.com/TheCharlatan",
            "followers_url": "https://api.github.com/users/TheCharlatan/followers",
            "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
            "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
            "repos_url": "https://api.github.com/users/TheCharlatan/repos",
            "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/60",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60/labels",
            "id": 9286970,
            "node_id": "MI_kwDOABII584AjbU6",
            "number": 60,
            "state": "closed",
            "title": "26.0",
            "description": "",
            "creator": {
              "login": "fanquake",
              "id": 863730,
              "node_id": "MDQ6VXNlcjg2MzczMA==",
              "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/fanquake",
              "html_url": "https://github.com/fanquake",
              "followers_url": "https://api.github.com/users/fanquake/followers",
              "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
              "organizations_url": "https://api.github.com/users/fanquake/orgs",
              "repos_url": "https://api.github.com/users/fanquake/repos",
              "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/fanquake/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 116,
            "created_at": "2023-04-15T11:36:05Z",
            "updated_at": "2023-12-08T10:41:40Z",
            "closed_at": "2023-12-04T13:27:46Z"
          },
          "locked": false,
          "comments": 14,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27419",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27419",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27419.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27419.patch"
          },
          "closed_at": "2023-04-21T10:19:53Z",
          "created_at": "2023-04-04T13:12:04Z",
          "updated_at": "2023-04-21T10:19:54Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-21T01:32:43Z",
      "updated_at": "2023-04-21T01:32:43Z",
      "source": {
        "issue": {
          "id": 1669545174,
          "node_id": "PR_kwDOABII585OZMXO",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27469",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27469/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27469/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27469/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27469",
          "number": 27469,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: improve IBD sync time by skipping block scanning prior birth time",
          "body": "During initial block download, the node's wallet(s) scans every arriving block looking for data that it owns.\r\nThis process can be resource-intensive, as it involves sequentially scanning all transactions within each\r\narriving block.\r\n\r\nTo avoid wasting processing power, we can skip blocks that occurred before the wallet's creation time, \r\nsince these blocks are guaranteed not to contain any relevant wallet data.\r\n\r\nThis has direct implications (an speed improvement) on the underlying blockchain synchronization process\r\nas well. The reason is that the validation interface queue is limited to 10 tasks per time. This means that no\r\nmore than 10 blocks can be waiting for the wallet(s) to be processed while we are synchronizing the chain\r\n(activating the best chain to be more precise).\r\nWhich can be a bottleneck if blocks arrive and are processed faster from the network than what they are \r\nprocessed by the wallet(s).\r\n\r\nSo, by skipping not relevant blocks in the wallet's IBD scanning process, we will also improve the chain \r\nsynchronization time.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 17,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27469",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27469",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27469.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27469.patch"
          },
          "closed_at": "2023-05-27T01:35:47Z",
          "created_at": "2023-04-15T19:32:14Z",
          "updated_at": "2023-05-31T05:58:26Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 9066328795,
      "node_id": "LE_lADOABII585C0HhYzwAAAAIcZTLb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9066328795",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-21T10:39:05Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9148573885,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAIhTCi9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9148573885",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-02T18:20:18Z"
    },
    {
      "event": "unlabeled",
      "id": 9149376593,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAIhWGhR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9149376593",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-02T19:59:18Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-05T03:50:19Z",
      "updated_at": "2023-05-05T03:50:19Z",
      "source": {
        "issue": {
          "id": 1696736253,
          "node_id": "PR_kwDOABII585P0RGI",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27576",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27576/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27576/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27576/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27576",
          "number": 27576,
          "state": "closed",
          "state_reason": null,
          "title": "kernel: Remove args, settings, chainparams, chainparamsbase from kernel library",
          "body": "This pull request is part of the `libbitcoinkernel` project https://github.com/bitcoin/bitcoin/issues/27587 https://github.com/bitcoin/bitcoin/projects/18 and more specifically its \"Step 2: Decouple most non-consensus code from libbitcoinkernel\".\r\n\r\n---\r\n\r\nThis completes the removal of the node's chainparams, chainparamsbase, args and settings files and their respective classes from the kernel library. This is the last pull request in a long series working towards decoupling the `ArgsManager` and the `gArgs` global from kernel code. These prior pull requests are: https://github.com/bitcoin/bitcoin/pull/26177 https://github.com/bitcoin/bitcoin/pull/27125 https://github.com/bitcoin/bitcoin/pull/25527 https://github.com/bitcoin/bitcoin/pull/25487 https://github.com/bitcoin/bitcoin/pull/25290\r\n\r\n",
          "user": {
            "login": "TheCharlatan",
            "id": 8421793,
            "node_id": "MDQ6VXNlcjg0MjE3OTM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TheCharlatan",
            "html_url": "https://github.com/TheCharlatan",
            "followers_url": "https://api.github.com/users/TheCharlatan/followers",
            "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
            "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
            "repos_url": "https://api.github.com/users/TheCharlatan/repos",
            "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27576",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27576",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27576.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27576.patch"
          },
          "closed_at": "2023-06-09T18:59:02Z",
          "created_at": "2023-05-04T21:36:34Z",
          "updated_at": "2023-06-13T13:22:49Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-08T23:06:52Z",
      "updated_at": "2023-05-08T23:06:52Z",
      "source": {
        "issue": {
          "id": 1700441577,
          "node_id": "PR_kwDOABII585QAqXJ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27596",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27596/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27596/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27596/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27596",
          "number": 27596,
          "state": "closed",
          "state_reason": null,
          "title": "assumeutxo (2)",
          "body": "- Background and FAQ: https://github.com/jamesob/assumeutxo-docs/tree/2019-04-proposal/proposal\r\n- Prior progress/project: https://github.com/bitcoin/bitcoin/projects/11\r\n- Replaces https://github.com/bitcoin/bitcoin/pull/15606, which was closed due to Github slowness. Original description and commentary can be found there.\r\n\r\n---\r\n\r\nThis changeset finishes the first phase of the assumeutxo project. It makes UTXO snapshots loadable via RPC (`loadtxoutset`) and adds `assumeutxo` parameters to chainparams. It contains all the remaining changes necessary to both use an assumedvalid snapshot chainstate and do a full validation sync in the background.\r\n\r\nThis may look like a lot to review, but note that\r\n- ~200 lines are a (non-essential) demo shell script\r\n- Many lines are functional test, documentation, and relatively dilute RPC code.\r\n\r\nSo it shouldn't be as burdensome to review as the linecount might suggest.\r\n\r\n- **P2P**: minor changes are made to `init.cpp` and `net_processing.cpp` to make simultaneous IBD across multiple chainstates work.\r\n- **Pruning**: implement correct pruning behavior when using a background chainstate\r\n- **Blockfile separation**: to prevent \"fragmentation\" in blockfile storage, have background chainstates use separate blockfiles from active snapshot chainstates to avoid interleaving heights and impairing pruning.\r\n- **Indexing**: some `CValidationInterface` events are given with an additional parameter, ChainstateRole, and all indexers ignore events from ChainstateRole::ASSUMEDVALID so that indexation only happens sequentially.\r\n- Have `-reindex` properly wipe snapshot chainstates.\r\n- **RPC**: introduce RPC commands `loadtxoutset` and (hidden) `getchainstates`.\r\n- **Release docs & first assumeutxo commitment**: add notes and a particular assumeutxo hash value for first AU-enabled release.\r\n  - This will complete the project and allow use of UTXO snapshots for faster node bootstrap.\r\n\r\nThe next phase, if it were to be pursued, would be coming up with a way to distribute the UTXO snapshots over the P2P network.\r\n\r\n---\r\n\r\n### UTXO snapshots\r\n\r\nCreate your own with `./contrib/devtools/utxo_snapshot.sh`, e.g. \r\n```shell\r\n./contrib/devtools/utxo_snapshot.sh 788000 utxo.dat ./src/bitcoin-cli -datadir=$(pwd)/testdata`)\r\n```\r\nor use the pre-generated ones listed below.\r\n\r\n- Testnet: **2'500'000** (Sjors):\r\n  - torrent: `magnet:?xt=urn:btih:511e09f4bf853aefab00de5c070b1e031f0ecbe9&dn=utxo-testnet-2500000.dat&tr=udp%3A%2F%2Ftracker.bitcoin.sprovoost.nl%3A6969`\r\n  - sha256: `79db4b025448cc0ac388d8589a28eab02de53055d181e34eb47391717aa16388`\r\n- Signet: **160'000** (Sjors):\r\n  - torrent: `magnet:?xt=urn:btih:9da986cb27b3980ea7fd06b21e199b148d486880&dn=utxo-signet-160000.dat&tr=udp%3A%2F%2Ftracker.bitcoin.sprovoost.nl%3A6969`\r\n  - sha256: `eeeca845385ba91e84ef58c09d38f98f246a24feadaad57fe1e5874f3f92ef8c`\r\n- Mainnet: **800'000** (Sjors):\r\n  - Note: this needs the following commit cherry-picked in: https://github.com/Sjors/bitcoin/commit/24deb2022b822f22fba9fcbee201e37a83225eb2\r\n  - torrent: `magnet:?xt=urn:btih:50ee955bef37f5ec3e5b0df4cf0288af3d715a2e&dn=utxo-800000.dat&tr=udp%3A%2F%2Ftracker.bitcoin.sprovoost.nl%3A6969`\r\n\r\n### Testing\r\n\r\n#### For fun (~5min)\r\n\r\nIf you want to do a quick test, you can run `./contrib/devtools/test_utxo_snapshots.sh` and follow the instructions. This is mostly obviated by the functional tests, though.\r\n\r\n#### For real (longer)\r\n\r\nIf you'd like to experience a real usage of assumeutxo, you can do that too.\r\nI've cut a new snapshot at height 788'000 (http://img.jameso.be/utxo-788000.dat - but you can do it yourself with `./contrib/devtools/utxo_snapshot.sh` if you want). Download that, and then create a datadir for testing:\r\n```sh\r\n$ cd ~/src/bitcoin  # or whatever\r\n\r\n# get the snapshot\r\n$ curl http://img.jameso.be/utxo-788000.dat > utxo-788000.dat\r\n\r\n# you'll want to do this if you like copy/pasting \r\n$ export AU_DATADIR=/home/${USER}/au-test # or wherever\r\n\r\n$ mkdir ${AU_DATADIR}\r\n$ vim ${AU_DATADIR}/bitcoin.conf\r\n\r\ndbcache=8000  # or, you know, something high\r\nblockfilterindex=1\r\ncoinstatsindex=1\r\nprune=3000\r\nlogthreadnames=1\r\n```\r\nObtain this branch, build it, and then start bitcoind:\r\n```sh\r\n$ git remote add jamesob https://github.com/jamesob/bitcoin\r\n$ git fetch jamesob assumeutxo\r\n$ git checkout jamesob/assumeutxo\r\n\r\n$ ./configure $conf_args && make  # (whatever you like to do here)\r\n\r\n# start 'er up and watch the logs\r\n$ ./src/bitcoind -datadir=${AU_DATADIR}\r\n```\r\nThen, in some other window, load the snapshot\r\n```sh\r\n$ ./src/bitcoin-cli -datadir=${AU_DATADIR} loadtxoutset $(pwd)/utxo-788000.dat\r\n```\r\n\r\nYou'll see some log messages about headers retrieval and waiting to see the snapshot in the headers chain. Once you get the full headers chain, you'll spend a decent amount of time (~10min) loading the snapshot, checking it, and flushing it to disk. After all that happens, you should be syncing to tip in pretty short order, and you'll see the occasional `[background validation]` log message go by.\r\n\r\nIn yet another window, you can check out chainstate status with\r\n```sh\r\n$ ./src/bitcoin-cli -datadir=${AU_DATADIR} getchainstates\r\n```\r\nas well as usual favorites like `getblockchaininfo`.",
          "user": {
            "login": "jamesob",
            "id": 73197,
            "node_id": "MDQ6VXNlcjczMTk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jamesob",
            "html_url": "https://github.com/jamesob",
            "followers_url": "https://api.github.com/users/jamesob/followers",
            "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
            "organizations_url": "https://api.github.com/users/jamesob/orgs",
            "repos_url": "https://api.github.com/users/jamesob/repos",
            "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jamesob/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 57,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27596",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27596",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27596.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27596.patch"
          },
          "closed_at": "2023-10-02T21:10:18Z",
          "created_at": "2023-05-08T15:08:28Z",
          "updated_at": "2024-02-07T05:42:03Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-09T14:55:04Z",
      "updated_at": "2023-05-09T14:55:04Z",
      "source": {
        "issue": {
          "id": 1702212340,
          "node_id": "PR_kwDOABII585QGncm",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27607",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27607/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27607/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27607/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27607",
          "number": 27607,
          "state": "closed",
          "state_reason": null,
          "title": "index: make startup more efficient",
          "body": "Simplifies index startup code, eliminating the `g_indexes_ready_to_sync` variable, \r\ndeduplicating code and moving the prune violation check out of the `BaseIndex` class.\r\n\r\nAlso makes startup more efficient by running the prune violation check once for all indexes\r\ninstead of once for each index, and by delaying the prune violation check and moving it off\r\nof the main thread so the node can start up faster and perform the block data availability\r\nverification even when the '-reindex\" or the \"-reindex-chainstate\" flags are enabled (which\r\nhasn't  being possible so far).",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 21,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27607",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27607",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27607.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27607.patch"
          },
          "closed_at": "2023-07-10T15:56:33Z",
          "created_at": "2023-05-09T14:55:04Z",
          "updated_at": "2023-07-20T23:00:15Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1418909211,
      "node_id": "PRR_kwDOABII585UktYb",
      "url": null,
      "actor": null,
      "commit_id": "d7eef9f49a827e96337febcf20a22b392dc7b51e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1418909211",
      "submitted_at": "2023-05-09T15:24:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "labeled",
      "id": 9220785846,
      "node_id": "LE_lADOABII585C0HhYzwAAAAIlmga2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9220785846",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-11T10:33:34Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-18T21:01:15Z",
      "updated_at": "2023-06-18T21:01:15Z",
      "source": {
        "issue": {
          "id": 813494821,
          "node_id": "MDU6SXNzdWU4MTM0OTQ4MjE=",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21267",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21267/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21267/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21267/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/21267",
          "number": 21267,
          "state": "open",
          "state_reason": null,
          "title": "Allow for rescan using block filters with pruned node",
          "body": "After #15946 it should be possible to do a rescan using block filters with a pruned node. Blocks that are not stored could be requested from peers.",
          "user": {
            "login": "benthecarman",
            "id": 15256660,
            "node_id": "MDQ6VXNlcjE1MjU2NjYw",
            "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/benthecarman",
            "html_url": "https://github.com/benthecarman",
            "followers_url": "https://api.github.com/users/benthecarman/followers",
            "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
            "organizations_url": "https://api.github.com/users/benthecarman/orgs",
            "repos_url": "https://api.github.com/users/benthecarman/repos",
            "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/benthecarman/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64583,
              "node_id": "MDU6TGFiZWw2NDU4Mw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
              "name": "Feature",
              "color": "7cf575",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 11,
          "created_at": "2021-02-22T13:19:46Z",
          "updated_at": "2023-06-22T22:43:03Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-05T21:34:38Z",
      "updated_at": "2023-07-05T21:34:38Z",
      "source": {
        "issue": {
          "id": 1786918639,
          "node_id": "PR_kwDOABII585UkLN9",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28026",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28026/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28026/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28026/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28026",
          "number": 28026,
          "state": "closed",
          "state_reason": null,
          "title": "test: bugfix, synchronize indexes synchronously",
          "body": "Fixing the current CI failures.\r\n\r\nThe tests objective is to exercise the chain synchronization code, \r\nverifying that the indexes are able to catch up with the chain-tip.\r\nTherefore, there is no need to run the process on a worker thread.\r\n\r\nNote:\r\nAfter #27607, the `BaseIndex::Start` method will be almost empty.\r\nOnly containing the `ThreadSync` call, allowing us to extract the\r\nthread ownership from the index class and place it into an external\r\nstructure (probably, the thread pool introduced in #26966).",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 14,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28026",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28026",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28026.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28026.patch"
          },
          "closed_at": "2023-07-07T13:29:55Z",
          "created_at": "2023-07-03T23:18:55Z",
          "updated_at": "2023-07-07T13:49:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9815573109,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJJDcJ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9815573109",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-13T21:00:35Z"
    },
    {
      "event": "unlabeled",
      "id": 9815818359,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJJEYB3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9815818359",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-13T21:40:01Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9816309700,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJJGP_E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9816309700",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-13T23:16:54Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T01:22:30Z",
      "updated_at": "2023-07-14T01:22:30Z",
      "source": {
        "issue": {
          "id": 1794835202,
          "node_id": "PR_kwDOABII585U_Njk",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28052",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28052/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28052/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28052/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28052",
          "number": 28052,
          "state": "open",
          "state_reason": null,
          "title": "blockstorage: XOR blocksdir *.dat files",
          "body": "Currently the *.dat files in the blocksdir store the data received from remote peers as-is. This may be problematic when a program other than Bitcoin Core tries to interpret them by accident. For example, an anti-virus program or other program may scan them and move them into quarantine, or delete them, or corrupt them. This may cause Bitcoin Core to fail a reorg, or fail to reply to block requests (via P2P, RPC, REST, ...).\r\n\r\nFix this, similar to https://github.com/bitcoin/bitcoin/pull/6650, by rolling a random XOR pattern over the dat files when writing or reading them.\r\n\r\nObviously this can only protect against programs that accidentally and unintentionally are trying to mess with the dat files. Any program that intentionally wants to mess with the dat files can still trivially do so.\r\n\r\nThe XOR pattern is only applied when the blocksdir is freshly created, and there is an option to disable it (on creation), so that people can disable it, if needed.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 219890555,
              "node_id": "MDU6TGFiZWwyMTk4OTA1NTU=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Block%20storage",
              "name": "Block storage",
              "color": "000000",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 19,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28052",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28052",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28052.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28052.patch"
          },
          "created_at": "2023-07-08T08:07:53Z",
          "updated_at": "2024-03-12T15:55:23Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T01:24:46Z",
      "updated_at": "2023-07-14T01:24:46Z",
      "source": {
        "issue": {
          "id": 1794480203,
          "node_id": "PR_kwDOABII585U9_dX",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28051",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28051/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28051/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28051/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28051",
          "number": 28051,
          "state": "closed",
          "state_reason": null,
          "title": "Get rid of shutdown.cpp/shutdown.h, use SignalInterrupt directly",
          "body": "This change drops `shutdown.h` and `shutdown.cpp` files, replacing them with a `NodeContext::shutdown` member which is used to trigger shutdowns directly. This gets rid of an unnecessary layer of indirection, and allows getting rid of the `kernel::g_context` global.\r\n\r\nAdditionally, this PR tries to improve error handling of `SignalInterrupt` code by marking relevant methods `[[nodiscard]]` to avoid the possibility of uncaught exceptions mentioned https://github.com/bitcoin/bitcoin/pull/27861#discussion_r1255496707.\r\n\r\nBehavior is changing In a few cases which are noted in individual commit messages. Particularly: GUI code more consistently interrupts RPCs when it is shutting down, shutdown state no longer persists between unit tests, the stop RPC now returns an RPC error if requesting shutdown fails instead of aborting, and other failed shutdown calls now log errors instead of aborting.\r\n\r\nThis PR is a net reduction in lines of code, but in some cases the explicit error handling and lack of global shutdown functions do make it more verbose. The verbosity can be seen as good thing if it discourages more code from directly triggering shutdowns, and instead encourages code to return errors or send notifications that could be translated into shutdowns. Probably a number of existing shutdown calls could just be replaced by better error handling.",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 15,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28051",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28051",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28051.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28051.patch"
          },
          "closed_at": "2023-12-14T20:14:13Z",
          "created_at": "2023-07-07T22:26:18Z",
          "updated_at": "2023-12-14T20:14:14Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9825217160,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJJoOqI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9825217160",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T19:41:34Z"
    },
    {
      "event": "commented",
      "id": 1636342363,
      "node_id": "IC_kwDOABII585hiJpb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1636342363",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T19:49:39Z",
      "updated_at": "2023-07-14T19:49:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "This is rebased after #27607, which allowed making a lot of simplifications and improvements. Also, I think the PR is better organized now, so I think I could split off the first commit or first few commits into a separate PR if reviewers would find that helpful.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1636342363",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "commented",
      "id": 1636628331,
      "node_id": "IC_kwDOABII585hjPdr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1636628331",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-15T02:21:57Z",
      "updated_at": "2023-07-15T02:21:57Z",
      "author_association": "MEMBER",
      "body": "I'll start another review early next week.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1636628331",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9840974404,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJKkVpE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9840974404",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-17T18:04:29Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9853979536,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJLV8uQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9853979536",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-18T18:22:35Z"
    },
    {
      "event": "unlabeled",
      "id": 9855056936,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJLaDwo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9855056936",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-18T20:12:00Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-28T12:56:45Z",
      "updated_at": "2023-07-28T12:56:45Z",
      "source": {
        "issue": {
          "id": 1405651308,
          "node_id": "PR_kwDOABII585An4JL",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26296",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26296/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26296/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26296/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26296",
          "number": 26296,
          "state": "closed",
          "state_reason": null,
          "title": "ci: Integrate `bitcoin-tidy` clang-tidy plugin",
          "body": "Demo of integrating the [bitcoin-tidy](https://github.com/theuni/bitcoin-tidy-plugin), [clang-tidy plugin](https://clang.llvm.org/extra/clang-tidy/) written by theuni into our tidy CI job.\r\n\r\nThe plugin currently has a single check, `bitcoin-unterminated-logprintf`. This would replace our current Python driven, `git-grep`-based, `.cpp` file only, lint-logs linter.",
          "user": {
            "login": "fanquake",
            "id": 863730,
            "node_id": "MDQ6VXNlcjg2MzczMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fanquake",
            "html_url": "https://github.com/fanquake",
            "followers_url": "https://api.github.com/users/fanquake/followers",
            "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
            "organizations_url": "https://api.github.com/users/fanquake/orgs",
            "repos_url": "https://api.github.com/users/fanquake/repos",
            "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fanquake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 52,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26296",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26296",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26296.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26296.patch"
          },
          "closed_at": "2023-08-07T15:14:22Z",
          "created_at": "2022-10-12T06:35:04Z",
          "updated_at": "2023-12-04T22:53:31Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-01T17:02:26Z",
      "updated_at": "2023-08-01T17:02:26Z",
      "source": {
        "issue": {
          "id": 1830961084,
          "node_id": "PR_kwDOABII585W5KNz",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28195",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28195/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28195/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28195/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28195",
          "number": 28195,
          "state": "closed",
          "state_reason": null,
          "title": "blockstorage: Drop legacy -txindex check",
          "body": "The only reason for the check was to print a warning about an increase in storage use. Now that 22.x is EOL and everyone should have migrated (or decided to not care about storage use), remove the check.\r\n\r\nAlso, a move-only commit is included. (Rebased from https://github.com/bitcoin/bitcoin/pull/22242)",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 219890555,
              "node_id": "MDU6TGFiZWwyMTk4OTA1NTU=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Block%20storage",
              "name": "Block storage",
              "color": "000000",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28195",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28195",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28195.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28195.patch"
          },
          "closed_at": "2023-09-05T10:37:45Z",
          "created_at": "2023-08-01T10:29:42Z",
          "updated_at": "2023-09-05T10:41:51Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1559173712,
      "node_id": "PRR_kwDOABII585c7xpQ",
      "url": null,
      "actor": null,
      "commit_id": "e025bb3f8d229969fdfe16e3c20191a5382c0443",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1559173712",
      "submitted_at": "2023-08-02T14:42:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1559236426,
      "node_id": "PRR_kwDOABII585c8A9K",
      "url": null,
      "actor": null,
      "commit_id": "e025bb3f8d229969fdfe16e3c20191a5382c0443",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1559236426",
      "submitted_at": "2023-08-02T15:10:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9991462118,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJTiZzm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9991462118",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-02T19:06:35Z"
    },
    {
      "event": "commented",
      "id": 1662828515,
      "node_id": "IC_kwDOABII585jHL_j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1662828515",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-02T19:11:41Z",
      "updated_at": "2023-08-02T19:11:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated e025bb3f8d229969fdfe16e3c20191a5382c0443 -> c553d9f0b0f796c30124fddb920b5e8b5b32de11 ([`pr/indexy.41`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.41) -> [`pr/indexy.42`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.42), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.41..pr/indexy.42)) to avoid race condition pointed out by furszy in an intermediate commit: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282110542 which could potentially lead to an assert failure if there was a reorg as indexes are starting up.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1662828515",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-05T06:50:23Z",
      "updated_at": "2023-08-05T06:50:23Z",
      "source": {
        "issue": {
          "id": 1837354188,
          "node_id": "PR_kwDOABII585XOtuA",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28218",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28218/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28218/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28218/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28218",
          "number": 28218,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Make IsInitialBlockDownload & NotifyHeaderTip not require a Chainstate",
          "body": "This change makes `IsInitialBlockDownload` and `NotifyHeaderTip` functions no longer tied to individual `Chainstate` objects. It makes them work with the `ChainstateManager` object instead so code is simpler and it is no longer possible to call them incorrectly with an inactive `Chainstate`.\r\n\r\nThis change also makes `m_cached_finished_ibd` caching easier to reason about, because now there is only one cached value instead of two (for background and snapshot chainstates) so the cached IBD state now no longer gets reset when a snapshot is loaded.\r\n\r\nThere should be no change in behavior because these functions were always called on the active `ChainState` objects.\r\n\r\nThese changes were discussed previously https://github.com/bitcoin/bitcoin/pull/27746#discussion_r1246868905 and https://github.com/bitcoin/bitcoin/pull/27746#discussion_r1237552792 as possible followups for that PR.",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28218",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28218",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28218.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28218.patch"
          },
          "closed_at": "2023-08-21T09:55:55Z",
          "created_at": "2023-08-04T21:14:06Z",
          "updated_at": "2023-08-21T09:55:55Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 10026516679,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJVoIDH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10026516679",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-07T16:35:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10090173345,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJZa9Oh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10090173345",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-14T18:47:21Z"
    },
    {
      "event": "unlabeled",
      "id": 10090545187,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJZcYAj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10090545187",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-14T19:31:35Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-15T02:11:12Z",
      "updated_at": "2023-08-15T02:11:12Z",
      "source": {
        "issue": {
          "id": 1843493325,
          "node_id": "PR_kwDOABII585XjLWx",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28246",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28246/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28246/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28246/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28246",
          "number": 28246,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Use CTxDestination in CRecipient instead of just scriptPubKey",
          "body": "For silent payments, we want to provide a `SilentPaymentsDestination` to be used as the recipient, which requires `CRecipient` to use something other than just the `scriptPubKey` as we cannot know the output script for a silent payment prior to transaction creation. `CTxDestination` seems like the obvious place to add a `SilentPaymentsDestination` as it is our internal representation of an address.\r\n\r\nIn order to still allow paying to arbitrary scriptPubKeys (e.g. for data carrier outputs, or the user hand crafted a raw transaction that they have given to `fundrawtransaction`), `CNoDestination` is changed to contain raw scripts.\r\n\r\nAdditionally, P2PK scripts are now interpreted as a new `PubKeyDestination` rather than `PKHash`. This results in some things that would have given an address for P2PK scripts to no longer do so. This is arguably more correct.\r\n\r\n`ExtractDestination`'s behavior is slightly changed for the above. It now returns `true` for those destinations that have addresses, so P2PK scripts now result in `false`. Even though it returns false for `CNoDestination`, the script will now be included in that `CNoDestination`.\r\n\r\nBuilds on #28244",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64585,
              "node_id": "MDU6TGFiZWw2NDU4NQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
              "name": "Bug",
              "color": "FBBAAB",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 21,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28246",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28246",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28246.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28246.patch"
          },
          "closed_at": "2023-09-19T16:49:00Z",
          "created_at": "2023-08-09T15:16:28Z",
          "updated_at": "2023-10-25T12:50:58Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-15T02:14:36Z",
      "updated_at": "2023-08-15T02:14:36Z",
      "source": {
        "issue": {
          "id": 1843062887,
          "node_id": "PR_kwDOABII585XhuK3",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28244",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28244/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28244/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28244/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28244",
          "number": 28244,
          "state": "closed",
          "state_reason": null,
          "title": "Break up script/standard.{h/cpp}",
          "body": "Some future work needs to touch things in script/standard.{h/cpp}, however it is unclear if it is safe to do so as they are included in several different places that could effect standardness and consensus. It contains a mix of policy parameters, consensus parameters, and utilities only used by the wallet. This PR breaks up the various components and renames the files to clearly separate everything.\r\n\r\n* `CTxDestination` is moved to a new file `src/addresstype.{cpp/h}`\r\n* `TaprootSpendData` and `TaprootBuilder` (and their utility functions and structs) are moved to `SigningProvider` as these are used only during signing.\r\n* `CScriptID` is moved to `script/script.h` to be next to `CScript`.\r\n* `MANDATORY_SCRIPT_VERIFY_FLAGS` is moved to `interpreter.h`\r\n* The parameters `DEFAULT_ACCEPT_DATACARRIER` and `MAX_OP_RETURN_RELAY` are moved to `policy.h`\r\n* `standard.{cpp/h}` is renamed to `solver.{cpp/h}` since that's all that's left in the file after the above moves",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28244",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28244",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28244.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28244.patch"
          },
          "closed_at": "2023-08-17T11:54:27Z",
          "created_at": "2023-08-09T11:43:57Z",
          "updated_at": "2023-08-30T02:14:20Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-15T05:18:25Z",
      "updated_at": "2023-08-15T05:18:25Z",
      "source": {
        "issue": {
          "id": 1816230792,
          "node_id": "PR_kwDOABII585WHu-Q",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28122",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28122/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28122/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28122/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28122",
          "number": 28122,
          "state": "open",
          "state_reason": null,
          "title": "Silent Payments: Implement BIP352",
          "body": "This PR is part of integrating silent payments into Bitcoin Core. The project is tracked in https://github.com/bitcoin/bitcoin/issues/28536\r\n\r\n## BIP352\r\n\r\nThis PR focuses strictly on the BIP logic and attempts to separate it from the wallet and transaction implementation details. This is accomplished by working directly with public and private keys, instead of needing a wallet backend and transactions for testing. Labels for the receiver are optional and thus deferred for a later PR.\r\n\r\nTest vectors from the BIP are included as unit tests.\r\n\r\nBefore reviewing, it is strongly recommended you read https://github.com/bitcoin/bips/pull/1458 and take a look at the reference python implementation on the BIP.\r\n",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 249581124,
              "node_id": "MDU6TGFiZWwyNDk1ODExMjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Privacy",
              "name": "Privacy",
              "color": "5319e7",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 32,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28122",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28122",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28122.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28122.patch"
          },
          "created_at": "2023-07-21T18:36:37Z",
          "updated_at": "2024-03-19T06:23:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 10107191617,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJab4FB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10107191617",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-16T11:19:34Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1681939421,
      "node_id": "IC_kwDOABII585kQFvd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1681939421",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-17T09:25:03Z",
      "updated_at": "2023-08-17T09:25:03Z",
      "author_association": "MEMBER",
      "body": "Maybe a silent merge conflict in a functional test, see CI?\r\n\r\n```\r\nï¿½[0mï¿½[0;31mfeature_index_prune.py                                 | âœ– Failed  | 2401 s",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1681939421",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "labeled",
      "id": 10119795464,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJbL9MI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10119795464",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-17T13:52:24Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10147452383,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJc1dXf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10147452383",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-21T15:56:16Z"
    },
    {
      "event": "unlabeled",
      "id": 10148353408,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJc45WA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10148353408",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-21T17:17:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 10148675541,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJc6H_V",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10148675541",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-21T17:49:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1593654901,
      "node_id": "PRR_kwDOABII585e_T51",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Left two comments for the initial commits, will continue.\r\n\r\nHave to admit that the first two commits consume some time to grasp again. I find myself re-thinking the same topics over and over.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1593654901",
      "submitted_at": "2023-08-24T14:40:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1595753171,
      "node_id": "PRR_kwDOABII585fHULT",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1595753171",
      "submitted_at": "2023-08-25T14:02:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1599095636,
      "node_id": "PRR_kwDOABII585fUENU",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Reviewed till 432febc3.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1599095636",
      "submitted_at": "2023-08-28T20:55:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1599149979,
      "node_id": "PRR_kwDOABII585fUReb",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1599149979",
      "submitted_at": "2023-08-28T21:34:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1599180216,
      "node_id": "PRR_kwDOABII585fUY24",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1599180216",
      "submitted_at": "2023-08-28T21:51:28Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1603545676,
      "node_id": "PRR_kwDOABII585flCpM",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1603545676",
      "submitted_at": "2023-08-30T21:46:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1603550524,
      "node_id": "PRR_kwDOABII585flD08",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1603550524",
      "submitted_at": "2023-08-30T21:58:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1604787730,
      "node_id": "PRR_kwDOABII585fpx4S",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1604787730",
      "submitted_at": "2023-08-31T13:40:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1605000586,
      "node_id": "PRR_kwDOABII585fql2K",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1605000586",
      "submitted_at": "2023-08-31T15:12:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "reviewed",
      "id": 1605007986,
      "node_id": "PRR_kwDOABII585fqnpy",
      "url": null,
      "actor": null,
      "commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1605007986",
      "submitted_at": "2023-08-31T15:15:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "labeled",
      "id": 10282573021,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJk45zd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10282573021",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-05T11:42:16Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10287100506,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJlKLJa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10287100506",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-05T18:59:44Z"
    },
    {
      "event": "reviewed",
      "id": 1600647210,
      "node_id": "PRR_kwDOABII585fZ_Aq",
      "url": null,
      "actor": null,
      "commit_id": "855dedc6fc4d2be0acac5ee0f52184761c495355",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for reviewing! I think I've caught up with all the unanswered comments. Also rebased due to conflict\r\n\r\nRebased f74b34f2d4d30f6895cfbeed2ec655a60290e990 -> 855dedc6fc4d2be0acac5ee0f52184761c495355 ([`pr/indexy.44`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.44) -> [`pr/indexy.45`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.45), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.44-rebase..pr/indexy.45)) due to conflict with #28195, and implementing various review suggestions",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1600647210",
      "submitted_at": "2023-09-05T19:00:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "unlabeled",
      "id": 10287598985,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJlME2J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10287598985",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-05T20:04:44Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-07T15:17:43Z",
      "updated_at": "2023-09-07T15:17:43Z",
      "source": {
        "issue": {
          "id": 1886102201,
          "node_id": "PR_kwDOABII585Zyzcs",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28427",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28427/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28427/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28427/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28427",
          "number": 28427,
          "state": "closed",
          "state_reason": null,
          "title": "index: coinstats reorg, fail when block cannot be reversed",
          "body": "Found it while reviewing https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1310863359.\r\n\r\nDuring a reorg, continuing execution when a block cannot be reversed leaves the\r\ncoinstats index in an inconsistent state.\r\nThis was surely overlooked when 'CustomRewind' was implemented.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/60",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60/labels",
            "id": 9286970,
            "node_id": "MI_kwDOABII584AjbU6",
            "number": 60,
            "state": "closed",
            "title": "26.0",
            "description": "",
            "creator": {
              "login": "fanquake",
              "id": 863730,
              "node_id": "MDQ6VXNlcjg2MzczMA==",
              "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/fanquake",
              "html_url": "https://github.com/fanquake",
              "followers_url": "https://api.github.com/users/fanquake/followers",
              "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
              "organizations_url": "https://api.github.com/users/fanquake/orgs",
              "repos_url": "https://api.github.com/users/fanquake/repos",
              "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/fanquake/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 116,
            "created_at": "2023-04-15T11:36:05Z",
            "updated_at": "2023-12-08T10:41:40Z",
            "closed_at": "2023-12-04T13:27:46Z"
          },
          "locked": false,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28427",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28427",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28427.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28427.patch"
          },
          "closed_at": "2023-09-12T08:45:05Z",
          "created_at": "2023-09-07T15:17:43Z",
          "updated_at": "2023-09-12T08:45:05Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-11T21:14:47Z",
      "updated_at": "2023-09-11T21:14:47Z",
      "source": {
        "issue": {
          "id": 1890832581,
          "node_id": "PR_kwDOABII585aClSK",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28451",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28451/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28451/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28451/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28451",
          "number": 28451,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Remove unused SER_DISK, SER_NETWORK, CDataStream",
          "body": "Seems odd to have code that is completely dead.\r\n\r\nFix this by removing all of it.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignee": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "ryanofsky",
              "id": 7133040,
              "node_id": "MDQ6VXNlcjcxMzMwNDA=",
              "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/ryanofsky",
              "html_url": "https://github.com/ryanofsky",
              "followers_url": "https://api.github.com/users/ryanofsky/followers",
              "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
              "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
              "repos_url": "https://api.github.com/users/ryanofsky/repos",
              "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 8,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28451",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28451",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28451.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28451.patch"
          },
          "closed_at": "2023-11-30T16:12:03Z",
          "created_at": "2023-09-11T16:07:31Z",
          "updated_at": "2023-11-30T17:18:51Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 10343562931,
      "node_id": "REFE_lADOABII585C0HhYzwAAAAJohj6z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10343562931",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "fd69ffbbfb3e08b474b33540e56cf4f81e5c21d4",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/fd69ffbbfb3e08b474b33540e56cf4f81e5c21d4",
      "created_at": "2023-09-12T08:45:03Z"
    },
    {
      "event": "labeled",
      "id": 10345019009,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJonHaB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10345019009",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T10:34:18Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10350112723,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJo6i_T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10350112723",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T18:13:53Z"
    },
    {
      "event": "commented",
      "id": 1716209239,
      "node_id": "IC_kwDOABII585mS0ZX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1716209239",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T18:18:17Z",
      "updated_at": "2023-09-12T18:18:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 855dedc6fc4d2be0acac5ee0f52184761c495355 -> 0d37538507e31468d24ac3249dc09ba6f44d4439 ([`pr/indexy.45`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.45) -> [`pr/indexy.46`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.46), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.45-rebase..pr/indexy.46)) due to conflicts with #28427\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1716209239",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 10350511427,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJo8EVD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10350511427",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T19:02:01Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 10351302126,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJo_FXu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10351302126",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T20:32:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T22:11:38Z",
      "updated_at": "2023-09-12T22:11:38Z",
      "source": {
        "issue": {
          "id": 1892267223,
          "node_id": "PR_kwDOABII585aHdJD",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28458",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28458/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28458/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28458/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28458",
          "number": 28458,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Remove unused GetType() from CBufferedFile and CAutoFile",
          "body": "This refactor is required for https://github.com/bitcoin/bitcoin/pull/28052 and https://github.com/bitcoin/bitcoin/pull/28451\r\n\r\nThus, split it out.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/60",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60/labels",
            "id": 9286970,
            "node_id": "MI_kwDOABII584AjbU6",
            "number": 60,
            "state": "closed",
            "title": "26.0",
            "description": "",
            "creator": {
              "login": "fanquake",
              "id": 863730,
              "node_id": "MDQ6VXNlcjg2MzczMA==",
              "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/fanquake",
              "html_url": "https://github.com/fanquake",
              "followers_url": "https://api.github.com/users/fanquake/followers",
              "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
              "organizations_url": "https://api.github.com/users/fanquake/orgs",
              "repos_url": "https://api.github.com/users/fanquake/repos",
              "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/fanquake/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 116,
            "created_at": "2023-04-15T11:36:05Z",
            "updated_at": "2023-12-08T10:41:40Z",
            "closed_at": "2023-12-04T13:27:46Z"
          },
          "locked": false,
          "comments": 2,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28458",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28458",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28458.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28458.patch"
          },
          "closed_at": "2023-09-14T08:56:29Z",
          "created_at": "2023-09-12T11:00:48Z",
          "updated_at": "2023-09-14T09:04:27Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 10370662732,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJqI8FM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10370662732",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T10:45:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10371782193,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJqNNYx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10371782193",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T12:36:50Z"
    },
    {
      "event": "commented",
      "id": 1719371249,
      "node_id": "IC_kwDOABII585me4Xx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1719371249",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T12:37:07Z",
      "updated_at": "2023-09-14T14:06:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased 0d37538507e31468d24ac3249dc09ba6f44d4439 -> 84f38664060bba6326a51c4303e44b524aaf7c85 ([`pr/indexy.46`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.46) -> [`pr/indexy.47`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.47), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.46-rebase..pr/indexy.47)) due to conflict with #28458\r\nUpdated 84f38664060bba6326a51c4303e44b524aaf7c85 -> e09e18601db94107992dfb086c77081ffc5e01ec ([`pr/indexy.47`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.47) -> [`pr/indexy.48`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.48), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.47..pr/indexy.48)) fixing compile error from bad rebase conflict resolution (https://cirrus-ci.com/task/4702319267282944)",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1719371249",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 10371933466,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJqNyUa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10371933466",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T12:50:30Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10372592340,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAAJqQTLU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10372592340",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T13:46:44Z"
    },
    {
      "event": "unlabeled",
      "id": 10374539066,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAAJqXuc6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10374539066",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T16:27:17Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T19:30:30Z",
      "updated_at": "2023-09-14T19:30:30Z",
      "source": {
        "issue": {
          "id": 1896789482,
          "node_id": "PR_kwDOABII585aWtqv",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28483",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28483/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28483/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28483/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28483",
          "number": 28483,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Return CAutoFile from BlockManager::Open*File()",
          "body": "This is required for https://github.com/bitcoin/bitcoin/pull/28052, but makes sense on its own, because offloading logic to `CAutoFile` instead of re-implementing it allows to delete code and complexity.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 1,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28483",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28483",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28483.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28483.patch"
          },
          "closed_at": "2023-09-26T13:02:24Z",
          "created_at": "2023-09-14T15:13:51Z",
          "updated_at": "2023-12-04T23:58:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 10407010715,
      "node_id": "REFE_lADOABII585C0HhYzwAAAAJsTmGb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10407010715",
      "actor": {
        "login": "Frank-GER",
        "id": 87550788,
        "node_id": "MDQ6VXNlcjg3NTUwNzg4",
        "avatar_url": "https://avatars.githubusercontent.com/u/87550788?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Frank-GER",
        "html_url": "https://github.com/Frank-GER",
        "followers_url": "https://api.github.com/users/Frank-GER/followers",
        "following_url": "https://api.github.com/users/Frank-GER/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Frank-GER/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Frank-GER/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Frank-GER/subscriptions",
        "organizations_url": "https://api.github.com/users/Frank-GER/orgs",
        "repos_url": "https://api.github.com/users/Frank-GER/repos",
        "events_url": "https://api.github.com/users/Frank-GER/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Frank-GER/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "5f3d90b597980b814c8b8468587bfc31e8db9b02",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/5f3d90b597980b814c8b8468587bfc31e8db9b02",
      "created_at": "2023-09-19T07:53:35Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-21T18:45:29Z",
      "updated_at": "2023-09-21T18:45:29Z",
      "source": {
        "issue": {
          "id": 1907083935,
          "node_id": "PR_kwDOABII585a5S31",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28516",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28516/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28516/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28516/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28516",
          "number": 28516,
          "state": "closed",
          "state_reason": null,
          "title": "validation: assumeutxo params for testnet and signet",
          "body": "Based on #27596. This adds snapshot parameters for testnet block 2,500,000 and signet block 160,000.\r\n\r\nYou can generate the snapshots yourself using `./contrib/devtools/utxo_snapshot.sh` or download my torrent:\r\n* testnet: `magnet:?xt=urn:btih:511e09f4bf853aefab00de5c070b1e031f0ecbe9&dn=utxo-testnet-2500000.dat&tr=udp%3A%2F%2Ftracker.bitcoin.sprovoost.nl%3A6969`\r\n* signet: `magnet:?xt=urn:btih:9da986cb27b3980ea7fd06b21e199b148d486880&dn=utxo-signet-160000.dat&tr=udp%3A%2F%2Ftracker.bitcoin.sprovoost.nl%3A6969`\r\n\r\nIt would be a good idea to test:\r\n1. That you can produce the same snapshot files, sha256 sums:\r\n\r\n```\r\neeeca845385ba91e84ef58c09d38f98f246a24feadaad57fe1e5874f3f92ef8c utxo-signet-160000.dat\r\n79db4b025448cc0ac388d8589a28eab02de53055d181e34eb47391717aa16388 utxo-testnet-2500000.dat\r\n```\r\n\r\n2. That the snapshots work\r\n\r\n---\r\n\r\nNot part of this PR:\r\n\r\nI also have a branch with a mainnet snapshot at height 800,000. It can be used for testing, but I'm not proposing it for merge just yet. I think more testing and conceptual discussion should happen first.\r\n* branch: [2023/09/assume_mainnet](https://github.com/Sjors/bitcoin/tree/2023/09/assume_mainnet)\r\n* torrent: `magnet:?xt=urn:btih:50ee955bef37f5ec3e5b0df4cf0288af3d715a2e&dn=utxo-800000.dat&tr=udp%3A%2F%2Ftracker.bitcoin.sprovoost.nl%3A6969`",
          "user": {
            "login": "Sjors",
            "id": 10217,
            "node_id": "MDQ6VXNlcjEwMjE3",
            "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Sjors",
            "html_url": "https://github.com/Sjors",
            "followers_url": "https://api.github.com/users/Sjors/followers",
            "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
            "organizations_url": "https://api.github.com/users/Sjors/orgs",
            "repos_url": "https://api.github.com/users/Sjors/repos",
            "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Sjors/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28516",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28516",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28516.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28516.patch"
          },
          "closed_at": "2023-09-30T12:53:22Z",
          "created_at": "2023-09-21T14:12:54Z",
          "updated_at": "2023-09-30T12:53:22Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 10475576470,
      "node_id": "LE_lADOABII585C0HhYzwAAAAJwZJyW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10475576470",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T13:52:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1868061457,
      "node_id": "IC_kwDOABII585vWFsR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1868061457",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-22T20:51:52Z",
      "updated_at": "2023-12-22T20:51:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1868061457",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "reviewed",
      "id": 1786770579,
      "node_id": "PRR_kwDOABII585qf_ST",
      "url": null,
      "actor": null,
      "commit_id": "e09e18601db94107992dfb086c77081ffc5e01ec",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK\r\n\r\nThis change looks good, albeit its daunting length. The only thing I am still not sure about is the commit \"indexes: Initialize indexes without holding cs_main\" c8fde60faad36d454cdd1300184a5169499f9e90 and if there is some observable improvement. Maybe this commit could be left for another PR? Or does it achieve something that is strictly needed for this PR?\r\n\r\nThe amount of churn in the commits is a bit unfortunate, but I don't have suggestions on how to improve this. Some of the nits I left are also resolved by later commits, so feel free to ignore them.\r\n\r\n",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1786770579",
      "submitted_at": "2024-01-03T10:45:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-18T18:49:36Z",
      "updated_at": "2024-01-18T18:49:36Z",
      "source": {
        "issue": {
          "id": 2014832404,
          "node_id": "PR_kwDOABII585gk1DX",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28960",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28960/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28960/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28960/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28960",
          "number": 28960,
          "state": "closed",
          "state_reason": null,
          "title": "kernel: Remove dependency on CScheduler",
          "body": "By defining a virtual interface class for the scheduler client, users of the kernel can now define their own event consuming infrastructure, without having to spawn threads or rely on the scheduler design.\r\n\r\nRemoving `CScheduler` also allows removing the thread and exception modules from the kernel library. \r\n\r\nTo make the `CMainSignals` class easier to use from a kernel library perspective, remove its global instantiation and adopt RAII practices.\r\n\r\nRenames `CMainSignals` to `ValidationSignals`, which more accurately describes its purpose and scope.\r\n\r\nAlso make the `ValidationSignals` in the `ChainstateManager` and CTxMemPool` optional. This could be useful in the future for using or testing these classes without having to instantiate any form of signal handling.\r\n\r\n---\r\n\r\nThis PR is part of the [libbitcoinkernel project](https://github.com/bitcoin/bitcoin/issues/27587). It improves the kernel API and removes two modules from the kernel library.",
          "user": {
            "login": "TheCharlatan",
            "id": 8421793,
            "node_id": "MDQ6VXNlcjg0MjE3OTM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TheCharlatan",
            "html_url": "https://github.com/TheCharlatan",
            "followers_url": "https://api.github.com/users/TheCharlatan/followers",
            "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
            "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
            "repos_url": "https://api.github.com/users/TheCharlatan/repos",
            "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/66",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/66",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/66/labels",
            "id": 10314936,
            "node_id": "MI_kwDOABII584AnWS4",
            "number": 66,
            "state": "open",
            "title": "28.0",
            "creator": {
              "login": "DrahtBot",
              "id": 39886733,
              "node_id": "MDQ6VXNlcjM5ODg2NzMz",
              "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/DrahtBot",
              "html_url": "https://github.com/DrahtBot",
              "followers_url": "https://api.github.com/users/DrahtBot/followers",
              "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
              "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
              "repos_url": "https://api.github.com/users/DrahtBot/repos",
              "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 9,
            "closed_issues": 3,
            "created_at": "2023-12-15T12:08:23Z",
            "updated_at": "2024-03-18T15:01:14Z"
          },
          "locked": false,
          "comments": 30,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28960",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28960",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28960.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28960.patch"
          },
          "closed_at": "2024-03-09T01:58:15Z",
          "created_at": "2023-11-28T16:27:42Z",
          "updated_at": "2024-03-09T01:58:16Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1913572083,
      "node_id": "IC_kwDOABII585yDsrz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1913572083",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-28T12:00:30Z",
      "updated_at": "2024-01-28T12:00:30Z",
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nFound this from https://github.com/bitcoin/bitcoin/blob/5fbcc8f0560cce36abafb8467339276b7c0d62b6/src/index/base.cpp#L87 while working with the indexing code.",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1913572083",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGExZDFiYzJmZTBmZTBkNWQwZGFlZDVkNjY4YzM4NDhiM2NiMTIzZjk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a1d1bc2fe0fe0d5d0daed5d668c3848b3cb123f9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a1d1bc2fe0fe0d5d0daed5d668c3848b3cb123f9",
      "tree": {
        "sha": "0abf07bb55f30d685e3afad9d719bb62ddd91b22",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0abf07bb55f30d685e3afad9d719bb62ddd91b22"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c38157b9b9ad2d3043bd904e572b0a8ef2b276fb",
          "sha": "c38157b9b9ad2d3043bd904e572b0a8ef2b276fb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c38157b9b9ad2d3043bd904e572b0a8ef2b276fb"
        }
      ],
      "message": "indexes, doc: Document current m_best_block_index behavior\n\nTry to document race conditions and corner cases and idiosyncracies in current\nindexing code to make upcoming changes easier to understand.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2023-07-14T20:07:58Z"
      },
      "sha": "a1d1bc2fe0fe0d5d0daed5d668c3848b3cb123f9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDAyOWU1MjMyNTEzMDI3ODVmMzY1MmUwNDVjZjg1MjQyYzUwY2Y3OGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/029e523251302785f3652e045cf85242c50cf78d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/029e523251302785f3652e045cf85242c50cf78d",
      "tree": {
        "sha": "e9c33f59842613136dfc76e0306d16f599e26e19",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e9c33f59842613136dfc76e0306d16f599e26e19"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a1d1bc2fe0fe0d5d0daed5d668c3848b3cb123f9",
          "sha": "a1d1bc2fe0fe0d5d0daed5d668c3848b3cb123f9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a1d1bc2fe0fe0d5d0daed5d668c3848b3cb123f9"
        }
      ],
      "message": "indexes: Avoid race, make -reindex-chainstate more efficient\n\nAvoid a race condition in index startup where indexes set m_synced = true too\nearly, while there are still notifications from previously connected blocks in\nthe validationinterface queue, causing those blocks to trigger the Rewind()\ncall in the BaseIndex::BlockConnected notification handler, and pointlessly\nremove and then re-append the same blocks.\n\nThis race condition was easy to reproduce just by running the\ntest/functional/feature_coinstatsindex.py \"Test that the index works with\n-reindex-chainstate\" test.\n\nThis change also allows simplifying code and getting rid of the \"WARNING: Block %s\ndoes not connect to an ancestor of known best chain (tip=%s); not updating\nindex\" warning.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2023-07-17T16:26:30Z"
      },
      "sha": "029e523251302785f3652e045cf85242c50cf78d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI2OGMyZGQyOTc0NDA4MDdiYTE0NDY5ODM5N2IzNmRhNzRiMDYxNmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/268c2dd297440807ba144698397b36da74b0616e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/268c2dd297440807ba144698397b36da74b0616e",
      "tree": {
        "sha": "01cc3c083cdf5ef29f184a94b9252e46183767ff",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/01cc3c083cdf5ef29f184a94b9252e46183767ff"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/029e523251302785f3652e045cf85242c50cf78d",
          "sha": "029e523251302785f3652e045cf85242c50cf78d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/029e523251302785f3652e045cf85242c50cf78d"
        }
      ],
      "message": "indexes, refactor: Remove index RegisterValidationInterface call\n\nAdd new interfaces::Chain::attachChain method and start moving index sync logic\nout of src/index/ to src/node/. In this commit, move code that registers for\nindex validationinterface notifications. In later commits, move the actual sync\nthread and add real blockConnected, blockDisconnected, and chainStateFlushed\nimplementations.\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-18T06:06:46Z"
      },
      "sha": "268c2dd297440807ba144698397b36da74b0616e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZkMjljYjI1ZWU0NGRiNTFkNTI2MDRjOWM2ODU5ZTQ5M2QxZTA4YWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fd29cb25ee44db51d52604c9c6859e493d1e08ac",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fd29cb25ee44db51d52604c9c6859e493d1e08ac",
      "tree": {
        "sha": "13b0194a261661b39d0b0442dfdbf12662be5efa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/13b0194a261661b39d0b0442dfdbf12662be5efa"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/268c2dd297440807ba144698397b36da74b0616e",
          "sha": "268c2dd297440807ba144698397b36da74b0616e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/268c2dd297440807ba144698397b36da74b0616e"
        }
      ],
      "message": "indexes, refactor: Remove index validationinterface hooks\n\nSplit up and rename validationinterface callback functions\nBaseIndex::BlockConnected to BaseIndex::IgnoreBlockConnected and\nBaseIndex::ChainStateFlushed to BaseIndex IgnoreChainStateFlushed.\n\nMost of the code in these functions was just ignoring spurious notifications,\nso leave that code in place, but move the rest of the code to\nBaseIndexNotifications::blockConnected and\nBaseIndexNotifications::chainStateFlushed. In an upcoming commit the spurious\nnotifications will be dropped and the new BaseIndex::Ignore... methods will be\ndeleted entirely.\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-18T06:06:46Z"
      },
      "sha": "fd29cb25ee44db51d52604c9c6859e493d1e08ac"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQyYjQ5YmZhYmE5NTU3NDI3MDEzNTY1Yjc3M2U0MjdjMDViZDAyZjk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/42b49bfaba9557427013565b773e427c05bd02f9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/42b49bfaba9557427013565b773e427c05bd02f9",
      "tree": {
        "sha": "5927495ec480ca3e298dc217b87d47e06a316310",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5927495ec480ca3e298dc217b87d47e06a316310"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fd29cb25ee44db51d52604c9c6859e493d1e08ac",
          "sha": "fd29cb25ee44db51d52604c9c6859e493d1e08ac",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fd29cb25ee44db51d52604c9c6859e493d1e08ac"
        }
      ],
      "message": "indexes, refactor: Stop incorrectly calling Interupt() and Stop() in BaseIndex destructor\n\nThis code never worked and was never used. Now that an m_handler member is\nadded, the incorrect usage is easier to detect and an assert can be added.\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-30T16:46:43Z"
      },
      "sha": "42b49bfaba9557427013565b773e427c05bd02f9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDliNzRkYzBmOTk0OWU5ODVjNTUzM2YyMGQ4YjhmN2FlMzFlOWMyYjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b74dc0f9949e985c5533f20d8b8f7ae31e9c2b0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9b74dc0f9949e985c5533f20d8b8f7ae31e9c2b0",
      "tree": {
        "sha": "76a66784bee8de24446e50b42651922577930b9e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/76a66784bee8de24446e50b42651922577930b9e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/42b49bfaba9557427013565b773e427c05bd02f9",
          "sha": "42b49bfaba9557427013565b773e427c05bd02f9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/42b49bfaba9557427013565b773e427c05bd02f9"
        }
      ],
      "message": "indexes, refactor: Add Commit CBlockLocator& argument\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-21T17:31:23Z"
      },
      "sha": "9b74dc0f9949e985c5533f20d8b8f7ae31e9c2b0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGE2MDg4MzhiOGM3OWZjNjJhNmQ1NTVlNTk2MmU3YjY1N2Y2ZDJlODA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a608838b8c79fc62a6d555e5962e7b657f6d2e80",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a608838b8c79fc62a6d555e5962e7b657f6d2e80",
      "tree": {
        "sha": "054a007f5175dda6d8fb963180dbc276a235042b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/054a007f5175dda6d8fb963180dbc276a235042b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b74dc0f9949e985c5533f20d8b8f7ae31e9c2b0",
          "sha": "9b74dc0f9949e985c5533f20d8b8f7ae31e9c2b0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9b74dc0f9949e985c5533f20d8b8f7ae31e9c2b0"
        }
      ],
      "message": "indexes, refactor: Remove remaining CBlockIndex* uses in index Rewind methods\n\nMove backwards ReadBlockFromDisk code from CoinStatsIndex::CustomRewind\nto BaseIndex::Rewind\n\nMove undo UndoReadFromDisk code from CoinStatsIndex::ReverseBlock to\nBaseIndex::Rewind\n\nThis commit does change behavior slightly. Since the new CustomRemove\nmethods only take a single block at a time instead of a range of\ndisconnected blocks, when they call CopyHeightIndexToHashIndex they will\nnow do an index seek for each removed block instead of only seeking once\nto the height of the earliest removed block. Seeking instead of scanning\nis a little worse for performance if there is a >1 block reorg, but\nprobably not noticable unless the reorg is very deep.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-24T04:20:41Z"
      },
      "sha": "a608838b8c79fc62a6d555e5962e7b657f6d2e80"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk4ZDA1MDkxM2I4YzBhMzUwOGRiZDc4MmI1YmY1MGE1MDc4Y2ViOGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/98d050913b8c0a3508dbd782b5bf50a5078ceb8b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/98d050913b8c0a3508dbd782b5bf50a5078ceb8b",
      "tree": {
        "sha": "fbc1efd546f47a7941b18684f5763f7af9ca76a8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fbc1efd546f47a7941b18684f5763f7af9ca76a8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a608838b8c79fc62a6d555e5962e7b657f6d2e80",
          "sha": "a608838b8c79fc62a6d555e5962e7b657f6d2e80",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a608838b8c79fc62a6d555e5962e7b657f6d2e80"
        }
      ],
      "message": "indexes, refactor: Stop requiring CBlockIndex type to call IsBIP30Unspendable\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-24T20:02:09Z"
      },
      "sha": "98d050913b8c0a3508dbd782b5bf50a5078ceb8b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGUwYjQxMWY5ZjE2MjE1OWFlYTk1M2M0NWUxNjBhZTVjY2IxNTQ5Yzc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e0b411f9f162159aea953c45e160ae5ccb1549c7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e0b411f9f162159aea953c45e160ae5ccb1549c7",
      "tree": {
        "sha": "1eb4841857a15a419a9259243500fb1278b31a9f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1eb4841857a15a419a9259243500fb1278b31a9f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/98d050913b8c0a3508dbd782b5bf50a5078ceb8b",
          "sha": "98d050913b8c0a3508dbd782b5bf50a5078ceb8b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/98d050913b8c0a3508dbd782b5bf50a5078ceb8b"
        }
      ],
      "message": "indexes, refactor: Remove remaining CBlockIndex* uses in index CustomAppend methods\n\nMove UndoReadFromBlock calls from BlockFilterIndex::CustomAppend and\nCoinStatsIndex::CustomAppend to BaseIndexNotifications::blockConnected\n\nMove CustomAppend call from BaseIndex::ThreadSync to blockConnected\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-24T20:02:09Z"
      },
      "sha": "e0b411f9f162159aea953c45e160ae5ccb1549c7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFiOWRhMjJhOThkZDYxOTM0MTIyMDUwNTRiNTAwYTYxYThiMTQwMTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1b9da22a98dd6193412205054b500a61a8b14016",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1b9da22a98dd6193412205054b500a61a8b14016",
      "tree": {
        "sha": "ada943ce9080e92fb25999c7918d6b01ef8959ce",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ada943ce9080e92fb25999c7918d6b01ef8959ce"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e0b411f9f162159aea953c45e160ae5ccb1549c7",
          "sha": "e0b411f9f162159aea953c45e160ae5ccb1549c7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e0b411f9f162159aea953c45e160ae5ccb1549c7"
        }
      ],
      "message": "indexes, refactor: Move more new block logic out of ThreadSync to blockConnected\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-26T04:56:15Z"
      },
      "sha": "1b9da22a98dd6193412205054b500a61a8b14016"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdmNDNjMjVmMDFlY2UwODc5NWFlYTM2OGE4ODE1NjlmYWI1YzM5YzE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7f43c25f01ece08795aea368a881569fab5c39c1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7f43c25f01ece08795aea368a881569fab5c39c1",
      "tree": {
        "sha": "e9dffa9ab11f46d31a470b9b35ca7f6b50449709",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e9dffa9ab11f46d31a470b9b35ca7f6b50449709"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1b9da22a98dd6193412205054b500a61a8b14016",
          "sha": "1b9da22a98dd6193412205054b500a61a8b14016",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1b9da22a98dd6193412205054b500a61a8b14016"
        }
      ],
      "message": "indexes, refactor: Move Commit logic out of ThreadSync to notification handlers\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2023-07-17T17:07:16Z"
      },
      "sha": "7f43c25f01ece08795aea368a881569fab5c39c1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDEwOGZkNmEzMTA1YTM0MTFiZjY3ZTk5OTZiMDJkZjFhODM1MGMyODk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/108fd6a3105a3411bf67e9996b02df1a8350c289",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/108fd6a3105a3411bf67e9996b02df1a8350c289",
      "tree": {
        "sha": "abed739a84f5f4740bfb3189a6a6332dccf42a11",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/abed739a84f5f4740bfb3189a6a6332dccf42a11"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7f43c25f01ece08795aea368a881569fab5c39c1",
          "sha": "7f43c25f01ece08795aea368a881569fab5c39c1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7f43c25f01ece08795aea368a881569fab5c39c1"
        }
      ],
      "message": "indexes, refactor: Move Rewind logic out of Rewind to blockDisconnected and ThreadSync\n\nThis main thing this commit code does is change rewind code to stop calling\n`CustomRemove` in a loop, and instead call `blockDisconnected` in a loop, with\n`blockDisconnected` calling `customRemove`. This fills out the\n`blockDisconnected` method, so the rewind loop can later be moved out of\nindexing code entirely, and left to the node code.\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2023-08-02T18:17:24Z"
      },
      "sha": "108fd6a3105a3411bf67e9996b02df1a8350c289"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQwMTg1NDU2OTNiZGZhNjI0OWI1MDc5MzY1ODU1ODA4ZjNhNjVlM2I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4018545693bdfa6249b5079365855808f3a65e3b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4018545693bdfa6249b5079365855808f3a65e3b",
      "tree": {
        "sha": "b79fadeeb16360cb936891e223e8342117bcd4da",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b79fadeeb16360cb936891e223e8342117bcd4da"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/108fd6a3105a3411bf67e9996b02df1a8350c289",
          "sha": "108fd6a3105a3411bf67e9996b02df1a8350c289",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/108fd6a3105a3411bf67e9996b02df1a8350c289"
        }
      ],
      "message": "indexes, refactor: Move CustomInit and error handling code out of ThreadSync to notification handlers\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-30T20:19:14Z"
      },
      "sha": "4018545693bdfa6249b5079365855808f3a65e3b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk3YjYzMWFkODM5ZGI4MWU0NDQ1ZjExYWEzMTJjMTdlYjI1MTM1NTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/97b631ad839db81e4445f11aa312c17eb2513552",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/97b631ad839db81e4445f11aa312c17eb2513552",
      "tree": {
        "sha": "8e5cb39695aec227327f0067df6cb9e6b595f969",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8e5cb39695aec227327f0067df6cb9e6b595f969"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4018545693bdfa6249b5079365855808f3a65e3b",
          "sha": "4018545693bdfa6249b5079365855808f3a65e3b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4018545693bdfa6249b5079365855808f3a65e3b"
        }
      ],
      "message": "indexes: Add blockfilterindex mutex\n\nAdd BlockFilterIndex::m_filter_mutex to avoid TSAN errors in next commit moving\nindex sync thread from indexes to node. This mutex was previously neccessary,\nbut TSAN did not detect errors until the sync thread was moved.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-08-15T17:12:32Z"
      },
      "sha": "97b631ad839db81e4445f11aa312c17eb2513552"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhmMzE0NmQ0YmI0MWM5ODc3NGRjN2M4YThiZjA5ZmIxNTM0ZTQ1NzI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8f3146d4bb41c98774dc7c8a8bf09fb1534e4572",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8f3146d4bb41c98774dc7c8a8bf09fb1534e4572",
      "tree": {
        "sha": "77ab592f6737de7eb16ed9c3ff0733b8aa4386f4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/77ab592f6737de7eb16ed9c3ff0733b8aa4386f4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/97b631ad839db81e4445f11aa312c17eb2513552",
          "sha": "97b631ad839db81e4445f11aa312c17eb2513552",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/97b631ad839db81e4445f11aa312c17eb2513552"
        }
      ],
      "message": "indexes, refactor: Move sync thread from index to node\n\nNo changes in behavior, this change is mostly move-only.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-30T13:01:16Z"
      },
      "sha": "8f3146d4bb41c98774dc7c8a8bf09fb1534e4572"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc2ZTY5ZGE0NjJhYzhjOWI3MzIyODg1OGJkNmQxMGZjN2Y5ZTZmMjU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/76e69da462ac8c9b73228858bd6d10fc7f9e6f25",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/76e69da462ac8c9b73228858bd6d10fc7f9e6f25",
      "tree": {
        "sha": "afac4dd05a57ef7a1493e9b4f6a954a165a7b838",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/afac4dd05a57ef7a1493e9b4f6a954a165a7b838"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8f3146d4bb41c98774dc7c8a8bf09fb1534e4572",
          "sha": "8f3146d4bb41c98774dc7c8a8bf09fb1534e4572",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8f3146d4bb41c98774dc7c8a8bf09fb1534e4572"
        }
      ],
      "message": "indexes, refactor: Remove SyncWithValidationInterfaceQueue call\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-30T22:38:58Z"
      },
      "sha": "76e69da462ac8c9b73228858bd6d10fc7f9e6f25"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZmYTllNDUyYWM3Y2ZlMDhkZWVjYWFlNDA5ZWNhMzM2OWRjY2NiNzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ffa9e452ac7cfe08deecaae409eca3369dcccb76",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ffa9e452ac7cfe08deecaae409eca3369dcccb76",
      "tree": {
        "sha": "d394dca16d6aeae54910d496f1b81b8b123bce5d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d394dca16d6aeae54910d496f1b81b8b123bce5d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/76e69da462ac8c9b73228858bd6d10fc7f9e6f25",
          "sha": "76e69da462ac8c9b73228858bd6d10fc7f9e6f25",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/76e69da462ac8c9b73228858bd6d10fc7f9e6f25"
        }
      ],
      "message": "indexes: Rewrite chain sync logic, simplify index sync code\n\nAdd SyncChain method and improve Chain::attachChain behavior so it no longer\nsends notifications from the sync thread at the same time as notifications from\nvalidationinterface queue. This allows BaseIndex::m_ready variable and\nsurrounding logic to be dropped and indexing code to be simplified.\n\nIt is also a potential performance improvement since it avoids holding cs_main\nwhile processing all indexing notifications. Previously cs_main was held while\nsending some notifications in the attachChain sync thread.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-13T12:18:06Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-31T21:42:49Z"
      },
      "sha": "ffa9e452ac7cfe08deecaae409eca3369dcccb76"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12109332247,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAALRxb8X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12109332247",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-13T21:22:41Z"
    },
    {
      "event": "reviewed",
      "id": 1934647017,
      "node_id": "PRR_kwDOABII585zUF7p",
      "url": null,
      "actor": null,
      "commit_id": "e09e18601db94107992dfb086c77081ffc5e01ec",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Rebased e09e18601db94107992dfb086c77081ffc5e01ec -> 6d3a10d9fbad43114317008445435b73896157d8 ([`pr/indexy.48`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.48) -> [`pr/indexy.49`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.49), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.48-rebase..pr/indexy.49)) due to various conflicts ",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#pullrequestreview-1934647017",
      "submitted_at": "2024-03-13T21:23:17Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
    },
    {
      "event": "unlabeled",
      "id": 12109692936,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAALRy0AI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12109692936",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-13T22:04:14Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 12111310357,
      "node_id": "LE_lADOABII585C0HhYzwAAAALR4-4V",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12111310357",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T02:19:36Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1996271416,
      "node_id": "IC_kwDOABII5852_K84",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1996271416",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T02:19:37Z",
      "updated_at": "2024-03-14T02:19:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\nðŸš§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/22632176621</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1996271416",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T04:15:06Z",
      "updated_at": "2024-03-14T04:15:06Z",
      "source": {
        "issue": {
          "id": 2182604130,
          "node_id": "PR_kwDOABII585pbmSj",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29641",
          "number": 29641,
          "state": "open",
          "state_reason": null,
          "title": "scripted-diff: Use LogInfo/LogDebug over LogPrintf/LogPrint",
          "body": "`LogPrintf/LogPrint` are problematic, because:\r\n\r\n* They are deprecated aliases, where code is using either the deprecated or non-deprecated alias, which is inconsistent and confusing.\r\n* Their name is non-descriptive of what the function does (info logging or debug logging).\r\n\r\nFix all issues by replacing the usage.\r\n\r\nWhile the diff is large and may cause merge conflicts or backport conflicts, I don't see the deprecated aliases being kept forever, so this will have to be done at some point. All conflicts should be trivial to solve, in any case.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29641",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29641",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29641.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29641.patch"
          },
          "created_at": "2024-03-12T20:21:40Z",
          "updated_at": "2024-03-20T00:26:59Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T07:24:51Z",
      "updated_at": "2024-03-14T07:24:51Z",
      "source": {
        "issue": {
          "id": 2014355259,
          "node_id": "PR_kwDOABII585gjLxA",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28955",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28955/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28955/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28955/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28955",
          "number": 28955,
          "state": "open",
          "state_reason": null,
          "title": "index: block filters sync, reduce disk read operations by caching last header",
          "body": "Work decoupled from #26966 per request.\r\n\r\nThe aim is to remove an unnecessary disk read operation that currently takes place with every new arriving block (or scanned block during background sync). Instead of reading the last filter header from disk merely to access its hash for constructing the next filter, this work caches it, occupying just 32 more bytes in memory.\r\n\r\nAlso, reduces `cs_main` lock contention during the index initial sync process. And, simplifies the indexes initialization and shutdown procedure.\r\n\r\nTesting Note:\r\nTo compare the changes, added a pretty basic benchmark in the second commit. Alternatively, could also test the changes by timing the block filter sync from scratch on any network; start the node with `-blockfilterindex` and monitor the logs until the syncing process finish.\r\n\r\nLocal Benchmark Results:\r\n\r\n*Master (c252a0fc0f4dc7d262b971a5e7ff01508159193b):\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|      132,042,516.60 |                7.57 |    0.3% |      7.79 | `BlockFilterIndexSync`\r\n\r\n*PR (43a212cfdac6c64e82b601c664443d022f191520):\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|      126,915,841.60 |                7.88 |    0.6% |      7.51 | `BlockFilterIndexSync`\r\n",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 11,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28955",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28955",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28955.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28955.patch"
          },
          "created_at": "2023-11-28T12:42:40Z",
          "updated_at": "2024-03-19T16:28:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 12121719395,
      "node_id": "REFE_lADOABII585C0HhYzwAAAALSgsJj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12121719395",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e295db870c676aa521e9ff1649514949940809cf",
      "commit_url": "https://api.github.com/repos/ryanofsky/bitcoin/commits/e295db870c676aa521e9ff1649514949940809cf",
      "created_at": "2024-03-14T17:28:11Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T17:30:24Z",
      "updated_at": "2024-03-14T17:30:24Z",
      "source": {
        "issue": {
          "id": 2186906515,
          "node_id": "PR_kwDOABII585pqQpc",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29652",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29652/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29652/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29652/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29652",
          "number": 29652,
          "state": "open",
          "state_reason": null,
          "title": "wallet: Avoid potentially writing incorrect best block locator",
          "body": "This PR updates the `CWallet::chainStateFlushed` method to write the `m_last_block_processed` locator to the database as the wallet's best block instead of the chain tip locator.\r\n\r\nSaving the last block processed locator as the best block is less fragile than saving `chainStateFlushed` locator as best block.\r\n\r\nRight now wallet code relies on `blockConnected` notifications being sent before `chainStateFlushed` notifications, and on the `chainStateFlushed` locator pointing to the last connected block. But this is a fragile assumption that can be easily broken by `ActivateBestChain`/`ConnectTrace` changes, and in fact is currently broken (since d96c59cc5cd2f73f1f55c133c52208671fe75ef3 from #25740) when the assumeutxo snapshot block is validated. In that case the background validation `chainStateFlushed` notification is sent _before_ the `blockConnected` notification so writing the locator as the best block would record a best block that was never processed. This specific change does not cause a problem for the wallet, because the wallet ignores events from the background validation chainstate. But nothing prevents similar out-of-order `chainStateFlushed` notifications from being sent in the future, so it is safer for the wallet to not rely on the chain tip sent in `chainStateFlushed` notifications.\r\n\r\nA good followup to this change would probably be to drop the `ChainStateFlushed` locator argument entirely so it is not misused in the future. Indexing code already stopped using this locator argument a long time ago for identifying the best block (in 4368384f1d267b011e03a805f934f5c47e2ca1b2 from #14121), though it is currently using the locator argument to log diagnostic warnings.",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29652",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29652",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29652.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29652.patch"
          },
          "created_at": "2024-03-14T17:30:23Z",
          "updated_at": "2024-03-19T00:39:31Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 12122053260,
      "node_id": "REFE_lADOABII585C0HhYzwAAAALSh9qM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12122053260",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "c5583a35f3fa63c3fa0a015faa74dd54115464ad",
      "commit_url": "https://api.github.com/repos/ryanofsky/bitcoin/commits/c5583a35f3fa63c3fa0a015faa74dd54115464ad",
      "created_at": "2024-03-14T17:58:29Z"
    },
    {
      "event": "referenced",
      "id": 12122497351,
      "node_id": "REFE_lADOABII585C0HhYzwAAAALSjqFH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12122497351",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "560063156a9ead2e21f9de4ee301d564a24488bd",
      "commit_url": "https://api.github.com/repos/ryanofsky/bitcoin/commits/560063156a9ead2e21f9de4ee301d564a24488bd",
      "created_at": "2024-03-14T18:42:05Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZjMzM1ZTJmMjRiYmY0NmU5N2I2NzQ0YTdiYjI0YjQzYWJhMjE2OWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6c335e2f24bbf46e97b6744a7bb24b43aba2169d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6c335e2f24bbf46e97b6744a7bb24b43aba2169d",
      "tree": {
        "sha": "c8372d4d6e60191f847a5b98dacc65aa12c4b3f4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c8372d4d6e60191f847a5b98dacc65aa12c4b3f4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ffa9e452ac7cfe08deecaae409eca3369dcccb76",
          "sha": "ffa9e452ac7cfe08deecaae409eca3369dcccb76",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ffa9e452ac7cfe08deecaae409eca3369dcccb76"
        }
      ],
      "message": "indexes: Initialize indexes without holding cs_main\n\nIn attachChain, avoid locking cs_main while calling prepare_sync method to run\nindex CustomInit code.\n\nThis is implemented by unconditionally spawning index sync threads, instead of\nonly spawning them conditionally when the index best block is not the chain\ntip. An alternative implementation could avoid the cost of spawning the sync\nthread by calling prepare_sync from the validationinterface notification\nthread. But this would be slightly more complex, and also potentially slower if\nany current or future index takes longer to initialize, since it would\ninitialize serially instead of in parallel with other index and node init code.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-15T17:20:31Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-15T17:20:31Z"
      },
      "sha": "6c335e2f24bbf46e97b6744a7bb24b43aba2169d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDEyZTdkYmMwOTZiODJmNzBiYzcwMzQ3NDFiOTBiMTZhMDM4Y2FmYjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/12e7dbc096b82f70bc7034741b90b16a038cafb1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/12e7dbc096b82f70bc7034741b90b16a038cafb1",
      "tree": {
        "sha": "9c7248c419d9ed9a4b5fefb2bcb130b4c36b4fcc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9c7248c419d9ed9a4b5fefb2bcb130b4c36b4fcc"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6c335e2f24bbf46e97b6744a7bb24b43aba2169d",
          "sha": "6c335e2f24bbf46e97b6744a7bb24b43aba2169d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6c335e2f24bbf46e97b6744a7bb24b43aba2169d"
        }
      ],
      "message": "indexes, refactor: Remove UndoReadFromDisk calls from indexing code\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-15T17:23:54Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-15T17:23:54Z"
      },
      "sha": "12e7dbc096b82f70bc7034741b90b16a038cafb1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU3MmEyMjZiODFhNWFmY2Q4MzdkNDI3Y2FhZGMyYzdiNDZhNDM0N2M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e72a226b81a5afcd837d427caadc2c7b46a4347c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e72a226b81a5afcd837d427caadc2c7b46a4347c",
      "tree": {
        "sha": "b9c08818c9f9a642ac8a5e9d46080afdd44e4f62",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b9c08818c9f9a642ac8a5e9d46080afdd44e4f62"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/12e7dbc096b82f70bc7034741b90b16a038cafb1",
          "sha": "12e7dbc096b82f70bc7034741b90b16a038cafb1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/12e7dbc096b82f70bc7034741b90b16a038cafb1"
        }
      ],
      "message": "indexes, refactor: Remove remaining CBlockIndex* pointers from indexing code\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-15T17:23:54Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-02-01T04:42:04Z"
      },
      "sha": "e72a226b81a5afcd837d427caadc2c7b46a4347c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM4YzkzZTZhOGU1NzNkYmRmM2ZjNGQxNGJlNzQ4Mzk2MWUxOGE1NzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "tree": {
        "sha": "8dd5169275b9f294be357da663707d9a21d07c17",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8dd5169275b9f294be357da663707d9a21d07c17"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e72a226b81a5afcd837d427caadc2c7b46a4347c",
          "sha": "e72a226b81a5afcd837d427caadc2c7b46a4347c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e72a226b81a5afcd837d427caadc2c7b46a4347c"
        }
      ],
      "message": "Remove direct index -> node dependency\n\nReplace last m_blockman.UpdatePruneLock call with\ninterfaces::Chain::updatePruneLock call.",
      "committer": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-15T17:52:11Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2024-03-15T17:52:11Z"
      },
      "sha": "38c93e6a8e573dbdf3fc4d14be7483961e18a576"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12135315772,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAALTUjk8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12135315772",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T18:23:57Z"
    },
    {
      "event": "commented",
      "id": 2000222994,
      "node_id": "IC_kwDOABII5853OPsS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2000222994",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T18:26:03Z",
      "updated_at": "2024-03-15T18:26:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 6d3a10d9fbad43114317008445435b73896157d8 -> 10e986b100e87768f8137765019afae57319f0bb ([`pr/indexy.49`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.49) -> [`pr/indexy.50`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.50), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.49..pr/indexy.50)) with updates to fix silent conflicts with assumeutxo which were causing feature_assumeutxo.py test failures (https://github.com/bitcoin/bitcoin/runs/22632176621)\r\n\r\nThe PR conflicted in a few ways with assumeutxo:\r\n\r\n- Assumeutxo sends new `BlockConnected`/`ChainstateFlushed` notifications from the assumed-valid chain which need to be ignored by indexing code, and weren't in being ignored in the previous version of this PR.\r\n\r\n- Assumeutxo restarts indexes after a snapshot is loaded, which broke commit \"indexes, refactor: Remove index RegisterValidationInterface call\" because it was not expecting `BaseIndex::Init` to be called after an index had been started, and was not resetting some new variables there.\r\n\r\n- Assumeutxo sends a `ChainStateFlushed` notification for the snapshot block after validating it but _before_ it sends a `BlockConnected` notification for that block. This caused feature_assumeutxo.py to fail starting from commit \"indexes: Avoid race, make -reindex-chainstate more efficient.\"\r\n\r\n  This assumeutxo change seems pretty unfortunate and required a workaround to ignore the flush notification. The workaround is less than ideal however, and it would be better to send the notifications in right order: connected first, flushed second. There is more information about this issue in #29652.\r\n\r\n\r\n\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-2000222994",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-18T01:52:33Z",
      "updated_at": "2024-03-18T01:52:33Z",
      "source": {
        "issue": {
          "id": 2190831417,
          "node_id": "PR_kwDOABII585p3mHO",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29671",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29671/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29671/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29671/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29671",
          "number": 29671,
          "state": "open",
          "state_reason": null,
          "title": "index: avoid \"failed to commit\" errors on initialization",
          "body": "In the index sync thread, when initializing an index for the first time, stop callng BaseIndex::Commit when m_best_block_index is null, to avoid a spurious \"failed to commit\" error from that function. This error started happening in commit https://github.com/bitcoin/bitcoin/commit/7878f97bf15b6e7c9b47d1c0d96419b97e1bdcbd from https://github.com/bitcoin/bitcoin/pull/25494 and was reported by pstratem in https://github.com/bitcoin/bitcoin/pull/26903 with an alternate fix.\r\n",
          "user": {
            "login": "fjahr",
            "id": 1322187,
            "node_id": "MDQ6VXNlcjEzMjIxODc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjahr",
            "html_url": "https://github.com/fjahr",
            "followers_url": "https://api.github.com/users/fjahr/followers",
            "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
            "organizations_url": "https://api.github.com/users/fjahr/orgs",
            "repos_url": "https://api.github.com/users/fjahr/repos",
            "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fjahr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29671",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29671",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29671.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29671.patch"
          },
          "created_at": "2024-03-17T19:39:00Z",
          "updated_at": "2024-03-20T00:03:49Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12155974385,
      "node_id": "HRFPE_lADOABII585C0HhYzwAAAALUjXLx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12155974385",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-18T17:00:48Z"
    },
    {
      "event": "commented",
      "id": 2004476450,
      "node_id": "IC_kwDOABII5853eeIi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2004476450",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-18T17:06:44Z",
      "updated_at": "2024-03-18T17:06:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 10e986b100e87768f8137765019afae57319f0bb -> 38c93e6a8e573dbdf3fc4d14be7483961e18a576 ([`pr/indexy.50`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.50) -> [`pr/indexy.51`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.51), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.50..pr/indexy.51)) reorganizing sync code to be in src/node instead of src/kernel and making many changes to minimize diffs",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-2004476450",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24230"
    },
    {
      "event": "unlabeled",
      "id": 12160497289,
      "node_id": "UNLE_lADOABII585C0HhYzwAAAALU0naJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12160497289",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-18T22:45:19Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801627743",
      "pull_request_review_id": 876022016,
      "id": 801627743,
      "node_id": "PRRC_kwDOABII584vx95f",
      "diff_hunk": "@@ -67,6 +68,20 @@ class FoundBlock\n     mutable bool found = false;\n };\n \n+//! Block data sent with blockConnected, blockDisconnected notifications.\n+struct BlockInfo {\n+    const uint256& hash;\n+    const uint256* prev_hash = nullptr;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 15,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "dc4675ddaca8d0d1d40847191cb21ccd116a6a3c",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "dc4675ddaca8d0d1d40847191cb21ccd116a6a3c : why bother with a pointer here? To make it consistent with `phashBlock` in `CBlockIndex`? I assume it's not just to shave 31 bytes of the `BlockInfo` size?",
      "created_at": "2022-02-08T13:26:37Z",
      "updated_at": "2022-02-08T15:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801627743",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801627743"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801653113",
      "pull_request_review_id": 876022016,
      "id": 801653113,
      "node_id": "PRRC_kwDOABII584vyEF5",
      "diff_hunk": "@@ -345,9 +350,9 @@ void BaseIndex::Interrupt()\n     m_interrupt();\n }\n \n-bool BaseIndex::Start(CChainState& active_chainstate)\n+bool BaseIndex::Start()\n {\n-    m_chainstate = &active_chainstate;\n+    m_chainstate = &m_chain->context()->chainman->ActiveChainstate();",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ae26ae5d3a1d32ce212d66477b71a5ac03354338",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ae26ae5d3a1d32ce212d66477b71a5ac03354338: you're using `context()` here, but `src/interfaces/chain.h` suggests that should only be done in a test. Does this need a TODO? Is this resolved in one of the followup PRs?",
      "created_at": "2022-02-08T13:52:54Z",
      "updated_at": "2022-02-08T15:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801653113",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801653113"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801675097",
      "pull_request_review_id": 876022016,
      "id": 801675097,
      "node_id": "PRRC_kwDOABII584vyJdZ",
      "diff_hunk": "@@ -209,22 +210,23 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n     return data_size;\n }\n \n-bool BlockFilterIndex::WriteBlock(const CBlock& block, const CBlockIndex* pindex)\n+bool BlockFilterIndex::CustomAppend(const interfaces::BlockInfo& block)\n {\n     CBlockUndo block_undo;\n     uint256 prev_header;\n \n-    if (pindex->nHeight > 0) {\n+    if (block.height > 0) {\n+        const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_chainstate->m_blockman.LookupBlockIndex(block.hash));",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "515a1dbce29078a1e90dc3f97bf25b309face9bb",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "515a1dbce29078a1e90dc3f97bf25b309face9bb: this might warrant a TODO (or note in the commit message) that this `CBlockIndex` is going away in a later commit.",
      "created_at": "2022-02-08T14:14:33Z",
      "updated_at": "2022-02-08T15:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801675097",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801675097"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 219,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801691396",
      "pull_request_review_id": 876022016,
      "id": 801691396,
      "node_id": "PRRC_kwDOABII584vyNcE",
      "diff_hunk": "@@ -28,7 +30,7 @@ struct IndexSummary {\n  * CValidationInterface and ensures blocks are indexed sequentially according\n  * to their position in the active chain.\n  */\n-class BaseIndex : public CValidationInterface",
      "path": "src/index/base.h",
      "position": 32,
      "original_position": 16,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "15398b1677362f4d98ffc786f1ae9976ad595ea8",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "15398b1677362f4d98ffc786f1ae9976ad595ea8: comment above needs update",
      "created_at": "2022-02-08T14:29:51Z",
      "updated_at": "2022-02-08T15:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801691396",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801691396"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 40,
      "original_line": 40,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801711644",
      "pull_request_review_id": 876022016,
      "id": 801711644,
      "node_id": "PRRC_kwDOABII584vySYc",
      "diff_hunk": "@@ -81,6 +81,8 @@ struct BlockInfo {\n     unsigned undo_pos = 0;\n     const CBlock* data = nullptr;\n     const CBlockUndo* undo_data = nullptr;\n+    //! Block is from the tip of the chain (always true except during initial sync)",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "15398b1677362f4d98ffc786f1ae9976ad595ea8",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "15398b1677362f4d98ffc786f1ae9976ad595ea8 nit: \"and reindex\" (I haven't checked if re-index nukes all the indexes, or if it leaves them alone until the previous best block is reached again)",
      "created_at": "2022-02-08T14:46:41Z",
      "updated_at": "2022-02-08T15:31:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801711644",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801711644"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801842132",
      "pull_request_review_id": 876331979,
      "id": 801842132,
      "node_id": "PRRC_kwDOABII584vyyPU",
      "diff_hunk": "@@ -67,6 +68,20 @@ class FoundBlock\n     mutable bool found = false;\n };\n \n+//! Block data sent with blockConnected, blockDisconnected notifications.\n+struct BlockInfo {\n+    const uint256& hash;\n+    const uint256* prev_hash = nullptr;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 15,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "dc4675ddaca8d0d1d40847191cb21ccd116a6a3c",
      "in_reply_to_id": 801627743,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801627743\r\n\r\n> [dc4675d](https://github.com/bitcoin/bitcoin/commit/dc4675ddaca8d0d1d40847191cb21ccd116a6a3c) : why bother with a pointer here? To make it consistent with `phashBlock` in `CBlockIndex`? I assume it's not just to shave 31 bytes of the `BlockInfo` size?\r\n\r\nYes, hash is a reference and prev_hash is a pointer to minimize copying and make the struct small. C++ doesn't provide named arguments, so I'm defining the struct as a substitute for named arguments, to make block connected and disconnected declarations more readable and the argument list easier to change in the future.\r\n\r\nThe field types are the same as the argument types that would be used otherwise. `const uint256& hash` could be replaced by `uint256 hash`, and  `const uint256* prev_hash` could be `std::optional<uint256>`, and `const CBlock*` could be `shared_ptr<CBlock>`, but the various block connected and disconnected method implementations don't benefit from getting copies instead of references, or optional instead of pointers, or smart pointers instead of plain pointers, so I'm opting for the cheapest and simplest passing style in each case.",
      "created_at": "2022-02-08T16:45:22Z",
      "updated_at": "2022-02-09T01:10:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801842132",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801842132"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912127",
      "pull_request_review_id": 876331979,
      "id": 801912127,
      "node_id": "PRRC_kwDOABII584vzDU_",
      "diff_hunk": "@@ -345,9 +350,9 @@ void BaseIndex::Interrupt()\n     m_interrupt();\n }\n \n-bool BaseIndex::Start(CChainState& active_chainstate)\n+bool BaseIndex::Start()\n {\n-    m_chainstate = &active_chainstate;\n+    m_chainstate = &m_chain->context()->chainman->ActiveChainstate();",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ae26ae5d3a1d32ce212d66477b71a5ac03354338",
      "in_reply_to_id": 801653113,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801653113\r\n\r\n> [ae26ae5](https://github.com/bitcoin/bitcoin/commit/ae26ae5d3a1d32ce212d66477b71a5ac03354338): you're using `context()` here, but `src/interfaces/chain.h` suggests that should only be done in a test. Does this need a TODO? Is this resolved in one of the followup PRs?\r\n\r\nGood catch. Now removed this in the last commit and added comment about it being temporary",
      "created_at": "2022-02-08T17:56:52Z",
      "updated_at": "2022-02-09T01:10:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801912127",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912127"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912871",
      "pull_request_review_id": 876331979,
      "id": 801912871,
      "node_id": "PRRC_kwDOABII584vzDgn",
      "diff_hunk": "@@ -209,22 +210,23 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n     return data_size;\n }\n \n-bool BlockFilterIndex::WriteBlock(const CBlock& block, const CBlockIndex* pindex)\n+bool BlockFilterIndex::CustomAppend(const interfaces::BlockInfo& block)\n {\n     CBlockUndo block_undo;\n     uint256 prev_header;\n \n-    if (pindex->nHeight > 0) {\n+    if (block.height > 0) {\n+        const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_chainstate->m_blockman.LookupBlockIndex(block.hash));",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "515a1dbce29078a1e90dc3f97bf25b309face9bb",
      "in_reply_to_id": 801675097,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801675097\r\n\r\n> [515a1db](https://github.com/bitcoin/bitcoin/commit/515a1dbce29078a1e90dc3f97bf25b309face9bb): this might warrant a TODO (or note in the commit message) that this `CBlockIndex` is going away in a later commit.\r\n\r\nGood suggestion, added comments to clarify",
      "created_at": "2022-02-08T17:57:40Z",
      "updated_at": "2022-02-09T01:10:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801912871",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912871"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 219,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913300",
      "pull_request_review_id": 876331979,
      "id": 801913300,
      "node_id": "PRRC_kwDOABII584vzDnU",
      "diff_hunk": "@@ -28,7 +30,7 @@ struct IndexSummary {\n  * CValidationInterface and ensures blocks are indexed sequentially according\n  * to their position in the active chain.\n  */\n-class BaseIndex : public CValidationInterface",
      "path": "src/index/base.h",
      "position": 32,
      "original_position": 16,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "15398b1677362f4d98ffc786f1ae9976ad595ea8",
      "in_reply_to_id": 801691396,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801691396\r\n\r\n> [15398b1](https://github.com/bitcoin/bitcoin/commit/15398b1677362f4d98ffc786f1ae9976ad595ea8): comment above needs update\r\n\r\nGood catch, updated",
      "created_at": "2022-02-08T17:58:12Z",
      "updated_at": "2022-02-09T01:10:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801913300",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913300"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 40,
      "original_line": 40,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913814",
      "pull_request_review_id": 876331979,
      "id": 801913814,
      "node_id": "PRRC_kwDOABII584vzDvW",
      "diff_hunk": "@@ -81,6 +81,8 @@ struct BlockInfo {\n     unsigned undo_pos = 0;\n     const CBlock* data = nullptr;\n     const CBlockUndo* undo_data = nullptr;\n+    //! Block is from the tip of the chain (always true except during initial sync)",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "15398b1677362f4d98ffc786f1ae9976ad595ea8",
      "in_reply_to_id": 801711644,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801711644\r\n\r\n> [15398b1](https://github.com/bitcoin/bitcoin/commit/15398b1677362f4d98ffc786f1ae9976ad595ea8) nit: \"and reindex\" (I haven't checked if re-index nukes all the indexes, or if it leaves them alone until the previous best block is reached again)\r\n\r\nRephrased the comment to avoid the word sync. This isn't referring to IBD or reindexing globally. It's just referring to notifications from the attachChain / ThreadSync code that runs when the index is loaded. For example if we added an RPC method to start and stop indexes. `chain_tip` would be false for the blocks read after the index was first started, until the sync thread caught up. This would be independent of whether node itself was syncing to the network.",
      "created_at": "2022-02-08T17:58:47Z",
      "updated_at": "2022-02-09T01:10:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801913814",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913814"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802668917",
      "pull_request_review_id": 877470452,
      "id": 802668917,
      "node_id": "PRRC_kwDOABII584v18F1",
      "diff_hunk": "@@ -0,0 +1,24 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <chain.h>\n+#include <interfaces/chain.h>\n+#include <uint256.h>\n+\n+namespace node {\n+interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* index, const CBlock* data)\n+{\n+    interfaces::BlockInfo info{index ? *index->phashBlock : uint256::ZERO};\n+    if (index) {\n+        info.prev_hash = index->pprev ? index->pprev->phashBlock : nullptr;\n+        info.height = index->nHeight;\n+        LOCK(::cs_main);\n+        info.file_number = index->nStatus & (BLOCK_HAVE_DATA | BLOCK_HAVE_UNDO) ? index->nFile : -1;",
      "path": "src/node/chain.cpp",
      "position": null,
      "original_position": 17,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "11310351345e844ae22f9bc00bed00eff7197500",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "11310351345e844ae22f9bc00bed00eff7197500 : this constraint of `BLOCK_HAVE_DATA | BLOCK_HAVE_UNDO` makes sense in the context of indexes, because an index is updated after a block is connected, at which point it will always have undo data. But if we ever need it in other places, it seems a bit odd. Maybe add a comment? Alternatively maybe we should just add `nStatus` or bools for the individual flags we care about? ",
      "created_at": "2022-02-09T13:37:52Z",
      "updated_at": "2022-02-09T14:19:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r802668917",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802668917"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802678422",
      "pull_request_review_id": 877470452,
      "id": 802678422,
      "node_id": "PRRC_kwDOABII584v1-aW",
      "diff_hunk": "@@ -38,6 +38,12 @@ namespace interfaces {\n class Handler;\n class Wallet;\n \n+//! Hash/height pair to help track and identify blocks.\n+struct BlockKey {",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 5,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ade3f4306bba6e40197d645774097c78a5e0681a",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ade3f4306bba6e40197d645774097c78a5e0681a: this is a nice addition, e.g. `block->hash` is more readable than before when `block` would be a hash.",
      "created_at": "2022-02-09T13:48:02Z",
      "updated_at": "2022-02-09T14:19:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r802678422",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802678422"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803070756",
      "pull_request_review_id": 878029336,
      "id": 803070756,
      "node_id": "PRRC_kwDOABII584v3eMk",
      "diff_hunk": "@@ -0,0 +1,24 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <chain.h>\n+#include <interfaces/chain.h>\n+#include <uint256.h>\n+\n+namespace node {\n+interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* index, const CBlock* data)\n+{\n+    interfaces::BlockInfo info{index ? *index->phashBlock : uint256::ZERO};\n+    if (index) {\n+        info.prev_hash = index->pprev ? index->pprev->phashBlock : nullptr;\n+        info.height = index->nHeight;\n+        LOCK(::cs_main);\n+        info.file_number = index->nStatus & (BLOCK_HAVE_DATA | BLOCK_HAVE_UNDO) ? index->nFile : -1;",
      "path": "src/node/chain.cpp",
      "position": null,
      "original_position": 17,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "11310351345e844ae22f9bc00bed00eff7197500",
      "in_reply_to_id": 802668917,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> [1131035](https://github.com/bitcoin/bitcoin/commit/11310351345e844ae22f9bc00bed00eff7197500) : this constraint of `BLOCK_HAVE_DATA | BLOCK_HAVE_UNDO` makes sense in the context of indexes, because an index is updated after a block is connected, at which point it will always have undo data. But if we ever need it in other places, it seems a bit odd. Maybe add a comment? Alternatively maybe we should just add `nStatus` or bools for the individual flags we care about?\r\n\r\nI guess I'll drop this. I assumed one wouldn't be present without the other, and was basing it on the thing [`CDiskBlockIndex` is doing](https://github.com/bitcoin/bitcoin/blob/5e8e0b3d7f6055e326bda61e60712b530e8920f0/src/chain.h#L392). Most intermediate code which uses this is deleted in the end anyway.",
      "created_at": "2022-02-09T20:41:57Z",
      "updated_at": "2022-02-09T21:05:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803070756",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803070756"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803628739",
      "pull_request_review_id": 878775522,
      "id": 803628739,
      "node_id": "PRRC_kwDOABII584v5mbD",
      "diff_hunk": "@@ -367,11 +390,15 @@ bool BaseIndex::Start()\n \n void BaseIndex::Stop()\n {\n-    UnregisterValidationInterface(this);\n+    Interrupt();\n \n     if (m_thread_sync.joinable()) {\n         m_thread_sync.join();\n     }\n+\n+    // Call handler destructor after releasing m_mutex, because notification\n+    // threads and disconnect code may need to lock the mutex.\n+    auto handler = WITH_LOCK(m_mutex, return std::move(m_handler));",
      "path": "src/index/base.cpp",
      "position": 638,
      "original_position": 177,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2504811223597b211aa52b86a6386f4c02286d50",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "2504811223597b211aa52b86a6386f4c02286d50 : IIUC this makes it so the `Handler` that's in `m_handler` (before its moved) is destroyed when this function is done. Why is it insufficient to just call `m_handler->disconnect()`  and have it be destroyed along with `BaseIndex`?\r\n\r\nI guess that's what \"because ... disconnect code may need to lock the mutex\" refers to, but it's not super clear to me why this is.\r\n\r\nRelated to the next d148f9e2abc05c83b60f1d92bcd7884174fa9ae3 where you assert that `m_handler` really needs to be gone by the time destructor on `BaseIndex` is called.",
      "created_at": "2022-02-10T12:36:29Z",
      "updated_at": "2022-02-10T13:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803628739",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803628739"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 437,
      "original_line": 437,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803639220",
      "pull_request_review_id": 878775522,
      "id": 803639220,
      "node_id": "PRRC_kwDOABII584v5o-0",
      "diff_hunk": "@@ -254,7 +254,7 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     // In case we reorg beyond the pruned depth, ReadBlockFromDisk would\n     // throw and lead to a graceful shutdown\n     m_best_block_index = new_tip;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "0cefaaab906e3de84a4e2c5a15e27e56255e17ac",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "0cefaaab906e3de84a4e2c5a15e27e56255e17ac: I guess you can now defer this until after `commit()`?",
      "created_at": "2022-02-10T12:49:25Z",
      "updated_at": "2022-02-10T13:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803639220",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803639220"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 256,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803655628",
      "pull_request_review_id": 878775522,
      "id": 803655628,
      "node_id": "PRRC_kwDOABII584v5s_M",
      "diff_hunk": "@@ -263,39 +263,21 @@ static bool CopyHeightIndexToHashIndex(CDBIterator& db_it, CDBBatch& batch,\n     return true;\n }\n \n-bool CoinStatsIndex::CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip)\n+bool CoinStatsIndex::CustomRemove(const interfaces::BlockInfo& block)\n {\n     CDBBatch batch(*m_db);\n     std::unique_ptr<CDBIterator> db_it(m_db->NewIterator());\n \n     // During a reorg, we need to copy all hash digests for blocks that are\n     // getting disconnected from the height index to the hash index so we can\n     // still find them when the height index entries are overwritten.\n-    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, new_tip.height, current_tip.height)) {\n+    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, block.height - 1, block.height)) {\n         return false;\n     }\n \n     if (!m_db->WriteBatch(batch)) return false;\n \n-    {\n-        LOCK(cs_main);\n-        CBlockIndex* iter_tip{m_chainstate->m_blockman.LookupBlockIndex(current_tip.hash)};\n-        CBlockIndex* new_tip_index{m_chainstate->m_blockman.LookupBlockIndex(new_tip.hash)};\n-        const auto& consensus_params{Params().GetConsensus()};\n-\n-        do {\n-            CBlock block;\n-\n-            if (!ReadBlockFromDisk(block, iter_tip, consensus_params)) {\n-                return error(\"%s: Failed to read block %s from disk\",\n-                             __func__, iter_tip->GetBlockHash().ToString());\n-            }\n-\n-            ReverseBlock(block, iter_tip);\n-\n-            iter_tip = iter_tip->GetAncestor(iter_tip->nHeight - 1);\n-        } while (new_tip_index != iter_tip);\n-    }\n+    ReverseBlock(block);",
      "path": "src/index/coinstatsindex.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d6ebc941f641d68eabe4c3243eb6769dd2d13cf5",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "d6ebc941f641d68eabe4c3243eb6769dd2d13cf5: this refactor of `CustomRewind ` from iterating over blocks to `CustomRemove` which just takes a single block might be worth doing in a separate commit.",
      "created_at": "2022-02-10T13:07:09Z",
      "updated_at": "2022-02-10T13:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803655628",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803655628"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 271,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803672787",
      "pull_request_review_id": 878775522,
      "id": 803672787,
      "node_id": "PRRC_kwDOABII584v5xLT",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b : Why this extra condition?",
      "created_at": "2022-02-10T13:27:25Z",
      "updated_at": "2022-02-10T13:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803672787",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803672787"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803675866",
      "pull_request_review_id": 878775522,
      "id": 803675866,
      "node_id": "PRRC_kwDOABII584v5x7a",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 26,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b  This seems new...",
      "created_at": "2022-02-10T13:31:03Z",
      "updated_at": "2022-02-10T13:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803675866",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803675866"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803678322",
      "pull_request_review_id": 878775522,
      "id": 803678322,
      "node_id": "PRRC_kwDOABII584v5yhy",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n         FatalError(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n-        return;\n-    } else {\n+        return m_index.Interrupt();\n+    }\n+    if (m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b : this also seems new. Maybe belongs in the next commit?",
      "created_at": "2022-02-10T13:33:56Z",
      "updated_at": "2022-02-10T13:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803678322",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803678322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803700112",
      "pull_request_review_id": 878775522,
      "id": 803700112,
      "node_id": "PRRC_kwDOABII584v532Q",
      "diff_hunk": "@@ -195,10 +197,10 @@ void BaseIndex::ThreadSync()\n                 LOCK(cs_main);\n                 const CBlockIndex* pindex_next = NextSyncBlock(pindex, m_chainstate->m_chain);\n                 if (!pindex_next) {\n-                    m_best_block_index = pindex;\n-                    m_synced = true;\n-                    // No need to handle errors in Commit. See rationale above.\n-                    Commit(GetLocator(*m_chain, pindex->GetBlockHash()));\n+                    assert(pindex);\n+                    notifications->blockConnected(node::MakeBlockInfo(pindex));\n+                    assert(m_synced);\n+                    notifications->chainStateFlushed(GetLocator(*m_chain, pindex->GetBlockHash()));",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "e359c2666cfd205c2ea84c241bccf565670365c0",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "e359c2666cfd205c2ea84c241bccf565670365c0: I'm a bit puzzled about what `chainStateFlushed` is for in the context of indexing. Right now it doesn't do much other than call `Commit()`. But we weren't calling it here before.\r\n\r\nThe commit title says \"... to chainStateFlushed\" but in reality that function is untouched and only `blockConnected` is changed.",
      "created_at": "2022-02-10T13:57:07Z",
      "updated_at": "2022-02-10T13:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803700112",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803700112"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803815653",
      "pull_request_review_id": 879038361,
      "id": 803815653,
      "node_id": "PRRC_kwDOABII584v6UDl",
      "diff_hunk": "@@ -367,11 +390,15 @@ bool BaseIndex::Start()\n \n void BaseIndex::Stop()\n {\n-    UnregisterValidationInterface(this);\n+    Interrupt();\n \n     if (m_thread_sync.joinable()) {\n         m_thread_sync.join();\n     }\n+\n+    // Call handler destructor after releasing m_mutex, because notification\n+    // threads and disconnect code may need to lock the mutex.\n+    auto handler = WITH_LOCK(m_mutex, return std::move(m_handler));",
      "path": "src/index/base.cpp",
      "position": 638,
      "original_position": 177,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2504811223597b211aa52b86a6386f4c02286d50",
      "in_reply_to_id": 803628739,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803628739\r\n\r\n> [2504811](https://github.com/bitcoin/bitcoin/commit/2504811223597b211aa52b86a6386f4c02286d50) : IIUC this makes it so the `Handler` that's in `m_handler` (before its moved) is destroyed when this function is done. Why is it insufficient to just call `m_handler->disconnect()` and have it be destroyed along with `BaseIndex`?\r\n> \r\n> I guess that's what \"because ... disconnect code may need to lock the mutex\" refers to, but it's not super clear to me why this is.\r\n\r\nThanks, wrote a more descriptive comment. The disconnect code waits for the last notification to be processed, so if the last notification need to lock m_mutex for any reason there would be a deadlock if this code wasn't releasing it.",
      "created_at": "2022-02-10T15:45:40Z",
      "updated_at": "2022-02-11T01:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803815653",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803815653"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 437,
      "original_line": 437,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803815987",
      "pull_request_review_id": 879038361,
      "id": 803815987,
      "node_id": "PRRC_kwDOABII584v6UIz",
      "diff_hunk": "@@ -254,7 +254,7 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     // In case we reorg beyond the pruned depth, ReadBlockFromDisk would\n     // throw and lead to a graceful shutdown\n     m_best_block_index = new_tip;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "0cefaaab906e3de84a4e2c5a15e27e56255e17ac",
      "in_reply_to_id": 803639220,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803639220\r\n\r\n> [0cefaaa](https://github.com/bitcoin/bitcoin/commit/0cefaaab906e3de84a4e2c5a15e27e56255e17ac): I guess you can now defer this until after `commit()`?\r\n\r\nI guess you're suggesting this code could commit first and update `m_best_block_index` later. I think this may be true currently, but I don't think it's necessarily safe to assume that other indexing code (particularly in `CustomInit` methods) doesn't care about the `m_best_block_index` value or won't depend on it in the future.\r\n\r\nAnyway, the indexing commit code is pretty low quality--it's bad about creating multiple batches, and sharing state inappropriately, and not being atomic--but I'm changing it as little as possible because it's mostly orthogonal to this PR. I do think the PR should make it a little easier to improve committing in the future since at least now it's passing the locator explicitly and it changes the base Commit method to call the custom Commit method instead of the other way around, so the control flow is simpler.",
      "created_at": "2022-02-10T15:45:58Z",
      "updated_at": "2022-02-11T01:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803815987",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803815987"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 256,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803816180",
      "pull_request_review_id": 879038361,
      "id": 803816180,
      "node_id": "PRRC_kwDOABII584v6UL0",
      "diff_hunk": "@@ -195,10 +197,10 @@ void BaseIndex::ThreadSync()\n                 LOCK(cs_main);\n                 const CBlockIndex* pindex_next = NextSyncBlock(pindex, m_chainstate->m_chain);\n                 if (!pindex_next) {\n-                    m_best_block_index = pindex;\n-                    m_synced = true;\n-                    // No need to handle errors in Commit. See rationale above.\n-                    Commit(GetLocator(*m_chain, pindex->GetBlockHash()));\n+                    assert(pindex);\n+                    notifications->blockConnected(node::MakeBlockInfo(pindex));\n+                    assert(m_synced);\n+                    notifications->chainStateFlushed(GetLocator(*m_chain, pindex->GetBlockHash()));",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "e359c2666cfd205c2ea84c241bccf565670365c0",
      "in_reply_to_id": 803700112,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803700112\r\n\r\n> [e359c26](https://github.com/bitcoin/bitcoin/commit/e359c2666cfd205c2ea84c241bccf565670365c0): I'm a bit puzzled about what `chainStateFlushed` is for in the context of indexing.\r\n\r\nIt just calls Commit() to update the best block locator on disk and flush whatever custom state the index may want to save in CustomCommit().\r\n\r\n> Right now it doesn't do much other than call `Commit()`. But we weren't calling it here before.\r\n\r\nIn commit e359c2666cfd205c2ea84c241bccf565670365c0, previous line 201 `Commit(...);` is changing to `notifications->chainStateFlushed(...);` so there should be preserving behavior\r\n\r\n> The commit title says \"... to chainStateFlushed\" but in reality that function is untouched and only `blockConnected` is changed.\r\n\r\nI'm happy to change commit subject and I made some tweaks, but it would help to have more specific suggestions to know what to change. The format of these commits subject lines generally is \"index: Remove [part of indexing code that doesn't belong in indexing]\" or \"index: Move [part of indexing code out of the code that will be moved to the node later]\", so if I rename this subject line I might need to rename the other \"index: Move\" subject lines too. \r\n\r\nIt is often hard to describe changes commits are making in just a few words. The subject lines here are trying to describe the *goal* of each commit, and the commit bodies are trying to itemize the actual changes. A lot of the changes in different commits are pretty similar to each other, so the subject lines are also trying focus on what makes  commits distinct from each other.",
      "created_at": "2022-02-10T15:46:08Z",
      "updated_at": "2022-02-11T01:16:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803816180",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803816180"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803816320",
      "pull_request_review_id": 879038361,
      "id": 803816320,
      "node_id": "PRRC_kwDOABII584v6UOA",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803672787,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803672787\r\n\r\n> [b8be01a](https://github.com/bitcoin/bitcoin/commit/b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b) : Why this extra condition?\r\n\r\nGood catch. This change makes more sense in the earlier commit adding this code, so I moved it. (It wasn't needed before this commit just because IgnoreBlockConnected was always returning true in this case before this commit.)",
      "created_at": "2022-02-10T15:46:16Z",
      "updated_at": "2022-02-11T01:16:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803816320",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803816320"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803816498",
      "pull_request_review_id": 879038361,
      "id": 803816498,
      "node_id": "PRRC_kwDOABII584v6UQy",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 26,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803675866,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803675866\r\n\r\n> [b8be01a](https://github.com/bitcoin/bitcoin/commit/b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b) This seems new...\r\n\r\nThis is not actually new, it's moved from BlockFilterIndex::CustomAppend and CoinStatsIndex::CustomAppend below. The different UndoReadFromDisk calls are being consolidated here",
      "created_at": "2022-02-10T15:46:25Z",
      "updated_at": "2022-02-11T01:16:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803816498",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803816498"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803816718",
      "pull_request_review_id": 879038361,
      "id": 803816718,
      "node_id": "PRRC_kwDOABII584v6UUO",
      "diff_hunk": "@@ -263,39 +263,21 @@ static bool CopyHeightIndexToHashIndex(CDBIterator& db_it, CDBBatch& batch,\n     return true;\n }\n \n-bool CoinStatsIndex::CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip)\n+bool CoinStatsIndex::CustomRemove(const interfaces::BlockInfo& block)\n {\n     CDBBatch batch(*m_db);\n     std::unique_ptr<CDBIterator> db_it(m_db->NewIterator());\n \n     // During a reorg, we need to copy all hash digests for blocks that are\n     // getting disconnected from the height index to the hash index so we can\n     // still find them when the height index entries are overwritten.\n-    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, new_tip.height, current_tip.height)) {\n+    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, block.height - 1, block.height)) {\n         return false;\n     }\n \n     if (!m_db->WriteBatch(batch)) return false;\n \n-    {\n-        LOCK(cs_main);\n-        CBlockIndex* iter_tip{m_chainstate->m_blockman.LookupBlockIndex(current_tip.hash)};\n-        CBlockIndex* new_tip_index{m_chainstate->m_blockman.LookupBlockIndex(new_tip.hash)};\n-        const auto& consensus_params{Params().GetConsensus()};\n-\n-        do {\n-            CBlock block;\n-\n-            if (!ReadBlockFromDisk(block, iter_tip, consensus_params)) {\n-                return error(\"%s: Failed to read block %s from disk\",\n-                             __func__, iter_tip->GetBlockHash().ToString());\n-            }\n-\n-            ReverseBlock(block, iter_tip);\n-\n-            iter_tip = iter_tip->GetAncestor(iter_tip->nHeight - 1);\n-        } while (new_tip_index != iter_tip);\n-    }\n+    ReverseBlock(block);",
      "path": "src/index/coinstatsindex.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d6ebc941f641d68eabe4c3243eb6769dd2d13cf5",
      "in_reply_to_id": 803655628,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803655628\r\n\r\n> [d6ebc94](https://github.com/bitcoin/bitcoin/commit/d6ebc941f641d68eabe4c3243eb6769dd2d13cf5): this refactor of `CustomRewind ` from iterating over blocks to `CustomRemove` which just takes a single block might be worth doing in a separate commit.\r\n\r\n~Good suggestion, split this commit~",
      "created_at": "2022-02-10T15:46:38Z",
      "updated_at": "2022-02-15T05:33:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803816718",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803816718"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 271,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803837847",
      "pull_request_review_id": 879038361,
      "id": 803837847,
      "node_id": "PRRC_kwDOABII584v6ZeX",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n         FatalError(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n-        return;\n-    } else {\n+        return m_index.Interrupt();\n+    }\n+    if (m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803678322,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803678322\r\n\r\n> [b8be01a](https://github.com/bitcoin/bitcoin/commit/b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b) : this also seems new. Maybe belongs in the next commit?\r\n\r\nThis `if (m_synced)` condition just preserves existing behavior. Now that `ThreadSync` is calling `blockConnected`, `m_synced` is no longer always true at this point. For some reason I don't know (but don't want to change) `ThreadSync` code didn't previously update `m_best_block_index` while it was reading and connecting blocks, and I didn't want to change that. This behavior might have been intended for performance reasons, or error handling reasons, or maybe so RPC indexing status would only report best block of indexing data that had actually been flushed to disk. But in any case nothing should be changing here.",
      "created_at": "2022-02-10T16:06:11Z",
      "updated_at": "2022-02-11T01:16:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803837847",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/803837847"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/804287560",
      "pull_request_review_id": 879698638,
      "id": 804287560,
      "node_id": "PRRC_kwDOABII584v8HRI",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n         FatalError(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n-        return;\n-    } else {\n+        return m_index.Interrupt();\n+    }\n+    if (m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803678322,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803678322\r\n\r\n> [b8be01a](https://github.com/bitcoin/bitcoin/commit/b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b) : this also seems new. Maybe belongs in the next commit?\r\n\r\nMaybe I should add a comment here like \"Don't update m_best_block_index between flushes if not synced. Unclear why best block is not updated in this case, but this has been longstanding behavior since syncing was introduced in #13033 so care should be taken if changing this.\"",
      "created_at": "2022-02-11T01:27:43Z",
      "updated_at": "2022-02-11T01:27:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r804287560",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/804287560"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/805348610",
      "pull_request_review_id": 880993870,
      "id": 805348610,
      "node_id": "PRRC_kwDOABII584wAKUC",
      "diff_hunk": "@@ -367,11 +390,15 @@ bool BaseIndex::Start()\n \n void BaseIndex::Stop()\n {\n-    UnregisterValidationInterface(this);\n+    Interrupt();\n \n     if (m_thread_sync.joinable()) {\n         m_thread_sync.join();\n     }\n+\n+    // Call handler destructor after releasing m_mutex, because notification\n+    // threads and disconnect code may need to lock the mutex.\n+    auto handler = WITH_LOCK(m_mutex, return std::move(m_handler));",
      "path": "src/index/base.cpp",
      "position": 638,
      "original_position": 177,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2504811223597b211aa52b86a6386f4c02286d50",
      "in_reply_to_id": 803628739,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803628739\r\n\r\n> Thanks, wrote a more descriptive comment.\r\n\r\nActually fixed now. I messed up the last push and did not include this change.",
      "created_at": "2022-02-13T15:10:58Z",
      "updated_at": "2022-02-15T05:51:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r805348610",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/805348610"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 437,
      "original_line": 437,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/805349847",
      "pull_request_review_id": 880993870,
      "id": 805349847,
      "node_id": "PRRC_kwDOABII584wAKnX",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n         FatalError(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n-        return;\n-    } else {\n+        return m_index.Interrupt();\n+    }\n+    if (m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803678322,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803678322\r\n\r\n> Maybe I should add a comment\r\n\r\nAdded now\r\n\r\n",
      "created_at": "2022-02-13T15:20:33Z",
      "updated_at": "2022-02-15T05:51:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r805349847",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/805349847"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/806464030",
      "pull_request_review_id": 880993870,
      "id": 806464030,
      "node_id": "PRRC_kwDOABII584wEaoe",
      "diff_hunk": "@@ -263,39 +263,21 @@ static bool CopyHeightIndexToHashIndex(CDBIterator& db_it, CDBBatch& batch,\n     return true;\n }\n \n-bool CoinStatsIndex::CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip)\n+bool CoinStatsIndex::CustomRemove(const interfaces::BlockInfo& block)\n {\n     CDBBatch batch(*m_db);\n     std::unique_ptr<CDBIterator> db_it(m_db->NewIterator());\n \n     // During a reorg, we need to copy all hash digests for blocks that are\n     // getting disconnected from the height index to the hash index so we can\n     // still find them when the height index entries are overwritten.\n-    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, new_tip.height, current_tip.height)) {\n+    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, block.height - 1, block.height)) {\n         return false;\n     }\n \n     if (!m_db->WriteBatch(batch)) return false;\n \n-    {\n-        LOCK(cs_main);\n-        CBlockIndex* iter_tip{m_chainstate->m_blockman.LookupBlockIndex(current_tip.hash)};\n-        CBlockIndex* new_tip_index{m_chainstate->m_blockman.LookupBlockIndex(new_tip.hash)};\n-        const auto& consensus_params{Params().GetConsensus()};\n-\n-        do {\n-            CBlock block;\n-\n-            if (!ReadBlockFromDisk(block, iter_tip, consensus_params)) {\n-                return error(\"%s: Failed to read block %s from disk\",\n-                             __func__, iter_tip->GetBlockHash().ToString());\n-            }\n-\n-            ReverseBlock(block, iter_tip);\n-\n-            iter_tip = iter_tip->GetAncestor(iter_tip->nHeight - 1);\n-        } while (new_tip_index != iter_tip);\n-    }\n+    ReverseBlock(block);",
      "path": "src/index/coinstatsindex.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d6ebc941f641d68eabe4c3243eb6769dd2d13cf5",
      "in_reply_to_id": 803655628,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: [#24230 (comment)](https://github.com/bitcoin/bitcoin/pull/24230#discussion_r803655628)\r\n\r\n > [d6ebc94](https://github.com/bitcoin/bitcoin/commit/d6ebc941f641d68eabe4c3243eb6769dd2d13cf5): this refactor of `CustomRewind ` from iterating over blocks to `CustomRemove` which just takes a single block might be worth doing in a separate commit.\r\n\r\nI tried this but couldn't actually figure out how how to do it in a good way. I updated the commit description and I want the commit to reflect fact that block read and block undo read is moving from custom indexes up to the BaseIndex::Rewind. If I add the loop in base class without removing it from the custom indexes, it's less clear that code is just moving.",
      "created_at": "2022-02-15T05:46:12Z",
      "updated_at": "2022-02-15T05:51:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r806464030",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/806464030"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 271,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/806939378",
      "pull_request_review_id": 883137628,
      "id": 806939378,
      "node_id": "PRRC_kwDOABII584wGOry",
      "diff_hunk": "@@ -67,6 +68,20 @@ class FoundBlock\n     mutable bool found = false;\n };\n \n+//! Block data sent with blockConnected, blockDisconnected notifications.\n+struct BlockInfo {\n+    const uint256& hash;\n+    const uint256* prev_hash = nullptr;\n+    int height = -1;\n+    int file_number = -1;\n+    unsigned data_pos = 0;\n+    unsigned undo_pos = 0;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 19,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "dc4675ddaca8d0d1d40847191cb21ccd116a6a3c",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "commit dc4675ddaca8d0d1d40847191cb21ccd116a6a3c:\r\nLooks like `undo_pos` is never being used.",
      "created_at": "2022-02-15T15:12:03Z",
      "updated_at": "2022-02-15T22:55:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r806939378",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/806939378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/806961991",
      "pull_request_review_id": 883137628,
      "id": 806961991,
      "node_id": "PRRC_kwDOABII584wGUNH",
      "diff_hunk": "@@ -211,19 +220,16 @@ void BaseIndex::ThreadSync()\n bool BaseIndex::Commit()\n {\n     CDBBatch batch(GetDB());\n-    if (!CommitInternal(batch) || !GetDB().WriteBatch(batch)) {\n+    bool success = CustomCommit(batch);\n+    if (success) {\n+        GetDB().WriteBestBlock(batch, GetLocator(*m_chain, m_best_block_index.load()->GetBlockHash()));",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f631a1b16ac2f58f47942c7cf51fbe8445694f65",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "f631a1b16ac2f58f47942c7cf51fbe8445694f65: \r\nI think that this might be a slight change in behavior: If `m_best_block_index` is nullptr here (which is possible if we get an  interrupt early in init), this will segfault now. Though the old behavior (that a locator to the tip was returned) was not ideal either, see #24117. ",
      "created_at": "2022-02-15T15:26:27Z",
      "updated_at": "2022-02-15T22:55:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r806961991",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/806961991"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807318089",
      "pull_request_review_id": 883137628,
      "id": 807318089,
      "node_id": "PRRC_kwDOABII584wHrJJ",
      "diff_hunk": "@@ -244,8 +245,28 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     assert(current_tip == m_best_block_index);\n     assert(current_tip->GetAncestor(new_tip->nHeight) == new_tip);\n \n-    if (!CustomRewind({current_tip->GetBlockHash(), current_tip->nHeight}, {new_tip->GetBlockHash(), new_tip->nHeight})) {\n-        return false;\n+    const Consensus::Params& consensus_params = Params().GetConsensus();\n+    CBlock block;\n+    CBlockUndo block_undo;\n+\n+    for (const CBlockIndex* iter_tip = current_tip; iter_tip != new_tip; iter_tip = iter_tip->pprev) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "3450df4d01608bd29f443aab3df1eed45108b3b2",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "3450df4d01608bd29f443aab3df1eed45108b3b2: I think this incremental processing will mean that in case of a deeper reorg, intermediate blocks are processed twice in `CopyHeightIndexToHashIndex` now, as new_tip and current_tip. Also, there willl be some extra calls to `ReadBlockFromDisk` also for txindex now (which doesn't implement `CustomRemove` logic). But this seems fine to me.",
      "created_at": "2022-02-15T21:10:44Z",
      "updated_at": "2022-02-15T22:55:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807318089",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807318089"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 252,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807321009",
      "pull_request_review_id": 883137628,
      "id": 807321009,
      "node_id": "PRRC_kwDOABII584wHr2x",
      "diff_hunk": "@@ -118,7 +118,7 @@ class BaseIndex\n \n     /// Rewind index to an earlier chain tip during a chain reorg. The tip must\n     /// be an ancestor of the current best block.\n-    [[nodiscard]] virtual bool CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip) { return true; }\n+    [[nodiscard]] virtual bool CustomRemove(const interfaces::BlockInfo& block) { return true; }",
      "path": "src/index/base.h",
      "position": 140,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "3450df4d01608bd29f443aab3df1eed45108b3b2",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "3450df4d01608bd29f443aab3df1eed45108b3b2: The comment above could be adjusted, CustomRemove now rewinds just one block.",
      "created_at": "2022-02-15T21:14:57Z",
      "updated_at": "2022-02-15T22:55:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807321009",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807321009"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 143,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807331690",
      "pull_request_review_id": 883137628,
      "id": 807331690,
      "node_id": "PRRC_kwDOABII584wHudq",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n         FatalError(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n-        return;\n-    } else {\n+        return m_index.Interrupt();\n+    }\n+    if (m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803678322,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "My impression is that in the old code, the ThreadSync the strategy was to update `m_best_block_index` exactly before calling `Commit()` (and using `pindex` instead of `m_best_block_index` for everything else). So updating it after each `WriteBlock` call was just unnecessary.",
      "created_at": "2022-02-15T21:30:25Z",
      "updated_at": "2022-02-15T22:55:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807331690",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807331690"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807335711",
      "pull_request_review_id": 883137628,
      "id": 807335711,
      "node_id": "PRRC_kwDOABII584wHvcf",
      "diff_hunk": "@@ -92,6 +94,12 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         }\n         block_info.undo_data = &block_undo;\n     }\n+    int64_t current_time = GetTime();\n+    if (m_last_log_time + SYNC_LOG_INTERVAL < current_time) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "36a9a550debc7324954765e60aefc33ab1456e5c",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "36a9a550debc7324954765e60aefc33ab1456e5c: This should probably be conditional on `!m_index.m_synced`, otherwise there would be additional log messages after the index is synced (after most new blocks, since `SYNC_LOG_INTERVAL=30s`).",
      "created_at": "2022-02-15T21:36:06Z",
      "updated_at": "2022-02-15T22:55:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807335711",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807335711"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807356962",
      "pull_request_review_id": 883137628,
      "id": 807356962,
      "node_id": "PRRC_kwDOABII584wH0oi",
      "diff_hunk": "@@ -351,10 +360,12 @@ bool BaseIndex::IgnoreChainStateFlushed(const CBlockLocator& locator)\n     // event, log a warning and let the queue clear.\n     const CBlockIndex* best_block_index = m_best_block_index.load();\n     if (best_block_index->GetAncestor(locator_tip_index->nHeight) != locator_tip_index) {\n-        LogPrintf(\"%s: WARNING: Locator contains block (hash=%s) not on known best \" /* Continued */\n-                  \"chain (tip=%s); not writing index locator\\n\",\n-                  __func__, locator_tip_hash.ToString(),\n-                  best_block_index->GetBlockHash().ToString());\n+        if (m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 170,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f56a851e11321ede9c5bcb43cd067c17f9efab39",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "f56a851e11321ede9c5bcb43cd067c17f9efab39: Adding the condition `if (m_synced)` seems unnecessary at this point, `IgnoreChainStateFlushed` returns right at the beginning if not synced.",
      "created_at": "2022-02-15T22:06:56Z",
      "updated_at": "2022-02-15T22:55:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807356962",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807356962"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 363,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807384378",
      "pull_request_review_id": 883137628,
      "id": 807384378,
      "node_id": "PRRC_kwDOABII584wH7U6",
      "diff_hunk": "@@ -125,6 +139,25 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n \n void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block)\n {\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_synced && !block.chain_tip) return;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f56a851e11321ede9c5bcb43cd067c17f9efab39",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "f56a851e11321ede9c5bcb43cd067c17f9efab39: why the additional `!block.chain_tip` condition? I'd assume if we happen to experience a reorg during initial sync and disconnect the tip, `block.chain_tip=true` and we don't return, but we wouldn't want to process this.\r\nPossibly related: If, at this commit, I am in the middle of syncing an index and at the same time call `invalidateblock` for the tip, my node coredumps with \"`leveldb/db/db_iter.cc:65: virtual leveldb::Slice leveldb::{anonymous}::DBIter::key() const: Assertion `valid_' failed.`\"",
      "created_at": "2022-02-15T22:51:10Z",
      "updated_at": "2022-02-15T22:55:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807384378",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807384378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807538892",
      "pull_request_review_id": 883961380,
      "id": 807538892,
      "node_id": "PRRC_kwDOABII584wIhDM",
      "diff_hunk": "@@ -67,6 +68,20 @@ class FoundBlock\n     mutable bool found = false;\n };\n \n+//! Block data sent with blockConnected, blockDisconnected notifications.\n+struct BlockInfo {\n+    const uint256& hash;\n+    const uint256* prev_hash = nullptr;\n+    int height = -1;\n+    int file_number = -1;\n+    unsigned data_pos = 0;\n+    unsigned undo_pos = 0;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 19,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "dc4675ddaca8d0d1d40847191cb21ccd116a6a3c",
      "in_reply_to_id": 806939378,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r806939378\r\n\r\n> commit [dc4675d](https://github.com/bitcoin/bitcoin/commit/dc4675ddaca8d0d1d40847191cb21ccd116a6a3c): Looks like `undo_pos` is never being used.\r\n\r\nGreat catch! Removed",
      "created_at": "2022-02-16T04:55:41Z",
      "updated_at": "2022-02-16T23:33:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807538892",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807538892"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807539156",
      "pull_request_review_id": 883961380,
      "id": 807539156,
      "node_id": "PRRC_kwDOABII584wIhHU",
      "diff_hunk": "@@ -211,19 +220,16 @@ void BaseIndex::ThreadSync()\n bool BaseIndex::Commit()\n {\n     CDBBatch batch(GetDB());\n-    if (!CommitInternal(batch) || !GetDB().WriteBatch(batch)) {\n+    bool success = CustomCommit(batch);\n+    if (success) {\n+        GetDB().WriteBestBlock(batch, GetLocator(*m_chain, m_best_block_index.load()->GetBlockHash()));",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f631a1b16ac2f58f47942c7cf51fbe8445694f65",
      "in_reply_to_id": 806961991,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r806961991\r\n\r\n> [f631a1b](https://github.com/bitcoin/bitcoin/commit/f631a1b16ac2f58f47942c7cf51fbe8445694f65): I think that this might be a slight change in behavior: If `m_best_block_index` is nullptr here (which is possible if we get an interrupt early in init), this will segfault now. Though the old behavior (that a locator to the tip was returned) was not ideal either, see #24117.\r\n\r\nAbsolutely. Rebasing on your fix from #24117, I believe this should be fixed here as well.\r\n",
      "created_at": "2022-02-16T04:56:22Z",
      "updated_at": "2022-02-16T23:33:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807539156",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807539156"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807539516",
      "pull_request_review_id": 883961380,
      "id": 807539516,
      "node_id": "PRRC_kwDOABII584wIhM8",
      "diff_hunk": "@@ -244,8 +245,28 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     assert(current_tip == m_best_block_index);\n     assert(current_tip->GetAncestor(new_tip->nHeight) == new_tip);\n \n-    if (!CustomRewind({current_tip->GetBlockHash(), current_tip->nHeight}, {new_tip->GetBlockHash(), new_tip->nHeight})) {\n-        return false;\n+    const Consensus::Params& consensus_params = Params().GetConsensus();\n+    CBlock block;\n+    CBlockUndo block_undo;\n+\n+    for (const CBlockIndex* iter_tip = current_tip; iter_tip != new_tip; iter_tip = iter_tip->pprev) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "3450df4d01608bd29f443aab3df1eed45108b3b2",
      "in_reply_to_id": 807318089,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807318089\r\n\r\n> [3450df4](https://github.com/bitcoin/bitcoin/commit/3450df4d01608bd29f443aab3df1eed45108b3b2): I think this incremental processing will mean that in case of a deeper reorg, intermediate blocks are processed twice in `CopyHeightIndexToHashIndex` now, as new_tip and current_tip. \r\n\r\nYes, exactly. I fixed commit message to describe this instead of saying \"This commit does not change behavior in any way\"\r\n\r\n> Also, there willl be some extra calls to `ReadBlockFromDisk` also for txindex now (which doesn't implement `CustomRemove` logic). But this seems fine to me.\r\n\r\nOh, this part was not intentional. Changed to remove these block reads. They are wasteful for BlockFilterIndex as well as TxIndex",
      "created_at": "2022-02-16T04:57:19Z",
      "updated_at": "2022-02-16T23:33:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807539516",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807539516"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 252,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807539753",
      "pull_request_review_id": 883961380,
      "id": 807539753,
      "node_id": "PRRC_kwDOABII584wIhQp",
      "diff_hunk": "@@ -118,7 +118,7 @@ class BaseIndex\n \n     /// Rewind index to an earlier chain tip during a chain reorg. The tip must\n     /// be an ancestor of the current best block.\n-    [[nodiscard]] virtual bool CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip) { return true; }\n+    [[nodiscard]] virtual bool CustomRemove(const interfaces::BlockInfo& block) { return true; }",
      "path": "src/index/base.h",
      "position": 140,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "3450df4d01608bd29f443aab3df1eed45108b3b2",
      "in_reply_to_id": 807321009,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807321009\r\n\r\n\r\n> 3450df4d01608bd29f443aab3df1eed45108b3b2: The comment above could be adjusted, CustomRemove now rewinds just one block.\r\n\r\nThanks, now noted in comment\r\n\r\n",
      "created_at": "2022-02-16T04:58:06Z",
      "updated_at": "2022-02-16T23:33:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807539753",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807539753"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 143,
      "original_line": 143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807540234",
      "pull_request_review_id": 883961380,
      "id": 807540234,
      "node_id": "PRRC_kwDOABII584wIhYK",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n         FatalError(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n-        return;\n-    } else {\n+        return m_index.Interrupt();\n+    }\n+    if (m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803678322,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r805349847\r\n\r\n> My impression is that in the old code, the ThreadSync the strategy was to update `m_best_block_index` exactly before calling `Commit()` (and using `pindex` instead of `m_best_block_index` for everything else). So updating it after each `WriteBlock` call was just unnecessary.\r\n\r\nI don't think this implies it's unnecessary unless you are assuming `ChainStateFlushed` (which calls `Commit`) is always called immediately after `BlockConnected`, which I think may not always be the case (i.e. during IBD). I'd actually be more worried about removing the `m_best_block_index` assignment here than I would be about assigning it unconditionally. I'd be happy to review another PR which changes this (and happy to rebase this PR on top) but in general I would like to not change `m_best_block_index` semantics in this PR unless it really helps things and we can be very sure it's safe.",
      "created_at": "2022-02-16T04:59:29Z",
      "updated_at": "2022-02-16T23:33:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807540234",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807540234"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807540622",
      "pull_request_review_id": 883961380,
      "id": 807540622,
      "node_id": "PRRC_kwDOABII584wIheO",
      "diff_hunk": "@@ -92,6 +94,12 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         }\n         block_info.undo_data = &block_undo;\n     }\n+    int64_t current_time = GetTime();\n+    if (m_last_log_time + SYNC_LOG_INTERVAL < current_time) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "36a9a550debc7324954765e60aefc33ab1456e5c",
      "in_reply_to_id": 807335711,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807335711\r\n\r\n> [36a9a55](https://github.com/bitcoin/bitcoin/commit/36a9a550debc7324954765e60aefc33ab1456e5c): This should probably be conditional on `!m_index.m_synced`, otherwise there would be additional log messages after the index is synced (after most new blocks, since `SYNC_LOG_INTERVAL=30s`).\r\n\r\nYes, good catch. Added this",
      "created_at": "2022-02-16T05:00:42Z",
      "updated_at": "2022-02-16T23:33:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807540622",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807540622"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807540885",
      "pull_request_review_id": 883961380,
      "id": 807540885,
      "node_id": "PRRC_kwDOABII584wIhiV",
      "diff_hunk": "@@ -125,6 +139,25 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n \n void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block)\n {\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_synced && !block.chain_tip) return;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f56a851e11321ede9c5bcb43cd067c17f9efab39",
      "in_reply_to_id": 807384378,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807384378\r\n\r\n> [f56a851](https://github.com/bitcoin/bitcoin/commit/f56a851e11321ede9c5bcb43cd067c17f9efab39): why the additional `!block.chain_tip` condition? \r\n\r\nOh no. This is just a bug. It should say `if (!m_index.m_synced && block.chain_tip)`. During sync notifications can come from two different sources;\r\n\r\n1 - The sync thread (with chain_tip = false)\r\n2 - The validation interface (with chain_tip = true)\r\n\r\nWe just want to ignore sync notifications from the validation interface like the comment above says.\r\n\r\n> I'd assume if we happen to experience a reorg during initial sync and disconnect the tip, `block.chain_tip=true` and we don't return, but we wouldn't want to process this.\r\n\r\nMost of the time we won't want to process this but sometimes we might if the reorg happens right at the end of the sync. We just want to process this whenever being called from the sync thread, and not process it when not called from the sync thread during sync. After sync, we always want to process it.\r\n\r\n>  Possibly related: If, at this commit, I am in the middle of syncing an index and at the same time call `invalidateblock` for the tip, my node coredumps with \"`leveldb/db/db_iter.cc:65: virtual leveldb::Slice leveldb::{anonymous}::DBIter::key() const: Assertion `valid_' failed.`\"\r\n\r\nInteresting, it does sound related. I would be curious to know if is fixed now. And maybe I could make this into a test. I'm curious if you made changes to somehow pause the sync to emulate a reorg happening at the same time?",
      "created_at": "2022-02-16T05:01:25Z",
      "updated_at": "2022-02-16T23:33:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807540885",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807540885"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807541075",
      "pull_request_review_id": 883961380,
      "id": 807541075,
      "node_id": "PRRC_kwDOABII584wIhlT",
      "diff_hunk": "@@ -351,10 +360,12 @@ bool BaseIndex::IgnoreChainStateFlushed(const CBlockLocator& locator)\n     // event, log a warning and let the queue clear.\n     const CBlockIndex* best_block_index = m_best_block_index.load();\n     if (best_block_index->GetAncestor(locator_tip_index->nHeight) != locator_tip_index) {\n-        LogPrintf(\"%s: WARNING: Locator contains block (hash=%s) not on known best \" /* Continued */\n-                  \"chain (tip=%s); not writing index locator\\n\",\n-                  __func__, locator_tip_hash.ToString(),\n-                  best_block_index->GetBlockHash().ToString());\n+        if (m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 170,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f56a851e11321ede9c5bcb43cd067c17f9efab39",
      "in_reply_to_id": 807356962,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807356962\r\n\r\n> [f56a851](https://github.com/bitcoin/bitcoin/commit/f56a851e11321ede9c5bcb43cd067c17f9efab39): Adding the condition `if (m_synced)` seems unnecessary at this point, `IgnoreChainStateFlushed` returns right at the beginning if not synced.\r\n\r\nOh, this is actually correct, but the check above should have been removed. The syncing here get simpler after the \r\n\"Rewrite chain sync logic, remove racy init\" commit, but right now chainStateFlushed notification events from the validation interface (not the sync thread) can happen at random times while the sync thread is still syncing, so the check avoids printing in this case while still not committing anything.",
      "created_at": "2022-02-16T05:01:57Z",
      "updated_at": "2022-02-16T23:33:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r807541075",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/807541075"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 363,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810294690",
      "pull_request_review_id": 887694486,
      "id": 810294690,
      "node_id": "PRRC_kwDOABII584wTB2i",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n         FatalError(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n-        return;\n-    } else {\n+        return m_index.Interrupt();\n+    }\n+    if (m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803678322,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I meant \"updating it after each WriteBlock _in the ThreadSync phase_\" is unnecessary. During the Sync phase, validation callbacks are ignored, and ThreadSync does the work - considering that the ThreadSync code in master makes sure that `m_best_block_index` is updated right before each possible `Commit()` call, and never used otherwise (pindex is used for that), I think that an earlier update of `m_best_block_index` after the [`WriteBlock`](https://github.com/bitcoin/bitcoin/blob/5d254a234d8c1569b0161264cc6d5d8d0ce0d864/src/index/base.cpp#L187) call within `ThreadSync` is just not necessary.\r\nSo I was just trying to explain why the longstanding behavior in master makes sense to me. I'm not suggesting to change anything here.",
      "created_at": "2022-02-18T19:45:15Z",
      "updated_at": "2022-02-18T19:45:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r810294690",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810294690"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810300757",
      "pull_request_review_id": 887702246,
      "id": 810300757,
      "node_id": "PRRC_kwDOABII584wTDVV",
      "diff_hunk": "@@ -125,6 +139,25 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n \n void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block)\n {\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_synced && !block.chain_tip) return;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f56a851e11321ede9c5bcb43cd067c17f9efab39",
      "in_reply_to_id": 807384378,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Interesting, it does sound related. I would be curious to know if is fixed now. And maybe I could make this into a test. I'm curious if you made changes to somehow pause the sync to emulate a reorg happening at the same time?\r\n\r\nYes, I don't encounter this anymore now. What I did was manual testing on regtest (just adding a `std::this_thread::sleep_for` to `ThreadSync`, giving me the possibility to time my `invalidateblock`) - I don't know if it is possible to somehow make an automated test for this that is not racy.",
      "created_at": "2022-02-18T19:54:28Z",
      "updated_at": "2022-02-18T19:54:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r810300757",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810300757"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810328899",
      "pull_request_review_id": 887742060,
      "id": 810328899,
      "node_id": "PRRC_kwDOABII584wTKND",
      "diff_hunk": "@@ -75,17 +76,28 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n \n     const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n-    if (best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n         FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n                    __func__, m_index.GetName());\n         return;\n     }\n \n-    if (!m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n         FatalError(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n-        return;\n-    } else {\n+        return m_index.Interrupt();\n+    }\n+    if (m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b8be01a7ef20672fd5faf4f6b82cf5d3fa2a717b",
      "in_reply_to_id": 803678322,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ok. Current behavior in master (which should not be changed here) still does not make sense to me. I don't think it's wrong (though it could be wrong), I just mean it seems inconsistent and strange.\r\n",
      "created_at": "2022-02-18T20:45:51Z",
      "updated_at": "2022-02-18T20:45:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r810328899",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810328899"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/811456743",
      "pull_request_review_id": 889137556,
      "id": 811456743,
      "node_id": "PRRC_kwDOABII584wXdjn",
      "diff_hunk": "@@ -134,6 +134,9 @@ class Chain\n     //! pruned), and contains transactions.\n     virtual bool haveBlockOnDisk(int height) = 0;\n \n+    //! Get tip information.\n+    virtual bool getTip(const FoundBlock& block={}) = 0;",
      "path": "src/interfaces/chain.h",
      "position": 24,
      "original_position": 5,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "fb164ac88e8e5f7b7bb448637a06da6ae299e578",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fb164ac88e8e5f7b7bb448637a06da6ae299e578\r\nI think `getTip()` here and in `interfaces.cpp` could move to the next commit (\"Remove SyncWithValidationInterfaceQueue call\") where they are used.",
      "created_at": "2022-02-21T22:23:30Z",
      "updated_at": "2022-03-05T20:43:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r811456743",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/811456743"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 146,
      "original_line": 146,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/819115023",
      "pull_request_review_id": 889137556,
      "id": 819115023,
      "node_id": "PRRC_kwDOABII584w0rQP",
      "diff_hunk": "@@ -226,17 +226,17 @@ void BaseIndex::ThreadSync()\n     }\n }\n \n-bool BaseIndex::Commit()\n+bool BaseIndex::Commit(const CBlockLocator& locator)\n {\n     // Don't commit anything if we haven't indexed any block yet\n-    // (this could happen if init is interrupted).\n-    if (m_best_block_index == nullptr) {\n+    // (this could happen if init is interrupted).A",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 46,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "cec20142450117a40e64a77b8447e0f6294ec9e9",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "cec20142450117a40e64a77b8447e0f6294ec9e9: remove \"A\"",
      "created_at": "2022-03-03T22:28:32Z",
      "updated_at": "2022-03-05T20:45:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r819115023",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/819115023"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820139296",
      "pull_request_review_id": 889137556,
      "id": 820139296,
      "node_id": "PRRC_kwDOABII584w4lUg",
      "diff_hunk": "@@ -426,11 +442,8 @@ bool BaseIndex::Start()\n         LOCK(m_mutex);\n         m_notifications = std::move(notifications);\n         m_handler = std::move(handler);\n-    }\n-\n-    const CBlockIndex* index = m_best_block_index.load();\n-    if (!CustomInit(index ? std::make_optional(interfaces::BlockKey{index->GetBlockHash(), index->nHeight}) : std::nullopt)) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 79,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c1bdcdf3388792b7c17e576170167f0be883fa4a",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "c1bdcdf3388792b7c17e576170167f0be883fa4a: The commit message (\"Move Commit and...\") doesn't describe what's being done here, maybe something like \"Move CustomInit out of Start and error handling code out of ThreadSync to notification handlers\"?",
      "created_at": "2022-03-05T19:22:41Z",
      "updated_at": "2022-03-05T20:43:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r820139296",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820139296"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 400,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820141011",
      "pull_request_review_id": 889137556,
      "id": 820141011,
      "node_id": "PRRC_kwDOABII584w4lvT",
      "diff_hunk": "@@ -426,11 +442,8 @@ bool BaseIndex::Start()\n         LOCK(m_mutex);\n         m_notifications = std::move(notifications);\n         m_handler = std::move(handler);\n-    }\n-\n-    const CBlockIndex* index = m_best_block_index.load();\n-    if (!CustomInit(index ? std::make_optional(interfaces::BlockKey{index->GetBlockHash(), index->nHeight}) : std::nullopt)) {\n-        return false;\n+        assert(m_notifications->m_init_result);\n+        if (!m_notifications->m_init_result) return false;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 82,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c1bdcdf3388792b7c17e576170167f0be883fa4a",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "c1bdcdf3388792b7c17e576170167f0be883fa4a: why both an assert and a conditional? Or did you mean `m_init_result.value()` in the second line? Maybe also consider being explicit (`has_value()`) for the `std::optional<bool>` in the assert to avoid confusion.",
      "created_at": "2022-03-05T19:40:29Z",
      "updated_at": "2022-03-05T20:43:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r820141011",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820141011"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824373054",
      "pull_request_review_id": 906746169,
      "id": 824373054,
      "node_id": "PRRC_kwDOABII584xIu8-",
      "diff_hunk": "@@ -134,6 +134,9 @@ class Chain\n     //! pruned), and contains transactions.\n     virtual bool haveBlockOnDisk(int height) = 0;\n \n+    //! Get tip information.\n+    virtual bool getTip(const FoundBlock& block={}) = 0;",
      "path": "src/interfaces/chain.h",
      "position": 24,
      "original_position": 5,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "fb164ac88e8e5f7b7bb448637a06da6ae299e578",
      "in_reply_to_id": 811456743,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r811456743\r\n\r\n> [fb164ac](https://github.com/bitcoin/bitcoin/commit/fb164ac88e8e5f7b7bb448637a06da6ae299e578) I think `getTip()` here and in `interfaces.cpp` could move to the next commit\r\n\r\nGood catch. Moved this.",
      "created_at": "2022-03-11T04:14:56Z",
      "updated_at": "2022-03-11T04:57:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r824373054",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824373054"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 146,
      "original_line": 146,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824373325",
      "pull_request_review_id": 906746169,
      "id": 824373325,
      "node_id": "PRRC_kwDOABII584xIvBN",
      "diff_hunk": "@@ -226,17 +226,17 @@ void BaseIndex::ThreadSync()\n     }\n }\n \n-bool BaseIndex::Commit()\n+bool BaseIndex::Commit(const CBlockLocator& locator)\n {\n     // Don't commit anything if we haven't indexed any block yet\n-    // (this could happen if init is interrupted).\n-    if (m_best_block_index == nullptr) {\n+    // (this could happen if init is interrupted).A",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 46,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "cec20142450117a40e64a77b8447e0f6294ec9e9",
      "in_reply_to_id": 819115023,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r819115023\r\n\r\n> cec20142450117a40e64a77b8447e0f6294ec9e9: remove \"A\"\r\n\r\nThanks, fixed this.",
      "created_at": "2022-03-11T04:15:46Z",
      "updated_at": "2022-03-11T04:57:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r824373325",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824373325"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824373760",
      "pull_request_review_id": 906746169,
      "id": 824373760,
      "node_id": "PRRC_kwDOABII584xIvIA",
      "diff_hunk": "@@ -426,11 +442,8 @@ bool BaseIndex::Start()\n         LOCK(m_mutex);\n         m_notifications = std::move(notifications);\n         m_handler = std::move(handler);\n-    }\n-\n-    const CBlockIndex* index = m_best_block_index.load();\n-    if (!CustomInit(index ? std::make_optional(interfaces::BlockKey{index->GetBlockHash(), index->nHeight}) : std::nullopt)) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 79,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c1bdcdf3388792b7c17e576170167f0be883fa4a",
      "in_reply_to_id": 820139296,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r820139296\r\n\r\n> [c1bdcdf](https://github.com/bitcoin/bitcoin/commit/c1bdcdf3388792b7c17e576170167f0be883fa4a): The commit message (\"Move Commit and...\") doesn't describe what's being done here, maybe something like \"Move CustomInit out of Start and error handling code out of ThreadSync to notification handlers\"?\r\n\r\nThanks, fixed this now.",
      "created_at": "2022-03-11T04:17:20Z",
      "updated_at": "2022-03-11T04:57:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r824373760",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824373760"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 400,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824373902",
      "pull_request_review_id": 906746169,
      "id": 824373902,
      "node_id": "PRRC_kwDOABII584xIvKO",
      "diff_hunk": "@@ -426,11 +442,8 @@ bool BaseIndex::Start()\n         LOCK(m_mutex);\n         m_notifications = std::move(notifications);\n         m_handler = std::move(handler);\n-    }\n-\n-    const CBlockIndex* index = m_best_block_index.load();\n-    if (!CustomInit(index ? std::make_optional(interfaces::BlockKey{index->GetBlockHash(), index->nHeight}) : std::nullopt)) {\n-        return false;\n+        assert(m_notifications->m_init_result);\n+        if (!m_notifications->m_init_result) return false;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 82,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c1bdcdf3388792b7c17e576170167f0be883fa4a",
      "in_reply_to_id": 820141011,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r820141011\r\n\r\n> c1bdcdf3388792b7c17e576170167f0be883fa4a: why both an assert and a conditional? Or did you mean `m_init_result.value()` in the second line? Maybe also consider being explicit (`has_value()`) for the `std::optional<bool>` in the assert to avoid confusion.\r\n\r\nGood catch. I was intending to use * operator, but I followed your suggestion instead since that seems more readable.\r\n\r\nNote: bug here was wasn't actually present in the full PR. Bug was temporarily introduced here in commit c1bdcdf3388792b7c17e576170167f0be883fa4a, but fixed by later commit fb164ac88e8e5f7b7bb448637a06da6ae299e578",
      "created_at": "2022-03-11T04:17:45Z",
      "updated_at": "2022-03-11T04:57:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r824373902",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/824373902"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830350296",
      "pull_request_review_id": 914866406,
      "id": 830350296,
      "node_id": "PRRC_kwDOABII584xfiPY",
      "diff_hunk": "@@ -0,0 +1,23 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <chain.h>\n+#include <interfaces/chain.h>\n+#include <uint256.h>\n+\n+namespace node {\n+interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* index, const CBlock* data)\n+{\n+    interfaces::BlockInfo info{index ? *index->phashBlock : uint256::ZERO};",
      "path": "src/node/chain.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "cf5d3404484b08939992566cca0f1151d050a921",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "cf5d3404484b08939992566cca0f1151d050a921\r\n\r\nDo we ever expect that `index` will be null? Based on the calls to `MakeBlockInfo`, it doesn't look like it. Make sense to just accept a reference here?\r\n\r\nEdit: okay, I see - in a later commit (when we add `attachChain`), this may be passed a nullptr if we're initializing the handler with an empty datadir.",
      "created_at": "2022-03-18T21:05:03Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r830350296",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830350296"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831443151",
      "pull_request_review_id": 914866406,
      "id": 831443151,
      "node_id": "PRRC_kwDOABII584xjtDP",
      "diff_hunk": "@@ -87,10 +90,8 @@ class BaseIndex : public CValidationInterface\n \n     void ChainStateFlushed(const CBlockLocator& locator) override;\n \n-    const CBlockIndex* CurrentIndex() { return m_best_block_index.load(); };\n-\n     /// Initialize internal state from the database and block index.\n-    [[nodiscard]] virtual bool Init();\n+    [[nodiscard]] virtual bool CustomInit(const std::optional<interfaces::BlockKey>& block) { return true; }",
      "path": "src/index/base.h",
      "position": 131,
      "original_position": 18,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "15daa47ee06b9f334dd2862856f41a2ad4b34a3d",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "15daa47ee06b9f334dd2862856f41a2ad4b34a3d\r\n\r\nSad to see a Russ PR that's introducing a new method with PascalCase, but I guess we're matching existing style... :stuck_out_tongue: ",
      "created_at": "2022-03-21T18:55:03Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r831443151",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/831443151"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 133,
      "original_line": 133,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832336236",
      "pull_request_review_id": 914866406,
      "id": 832336236,
      "node_id": "PRRC_kwDOABII584xnHFs",
      "diff_hunk": "@@ -425,13 +410,13 @@ bool CoinStatsIndex::ReverseBlock(const CBlock& block, const CBlockIndex* pindex\n     }\n \n     // Remove the new UTXOs that were created from the block\n-    for (size_t i = 0; i < block.vtx.size(); ++i) {\n-        const auto& tx{block.vtx.at(i)};\n+    for (size_t i = 0; i < block.data->vtx.size(); ++i) {",
      "path": "src/index/coinstatsindex.cpp",
      "position": 153,
      "original_position": 89,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "0e80167cc848364a456bbfd4cba12891a5f06b35",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "0e80167cc848364a456bbfd4cba12891a5f06b35\r\n\r\nMaybe worth doing `Assert(block.data)->vtx.size()` here? Possibly also with `.undo_data` below.",
      "created_at": "2022-03-22T15:29:38Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r832336236",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832336236"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 420,
      "original_line": 420,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832554320",
      "pull_request_review_id": 914866406,
      "id": 832554320,
      "node_id": "PRRC_kwDOABII584xn8VQ",
      "diff_hunk": "@@ -182,7 +173,7 @@ bool CoinStatsIndex::CustomAppend(const interfaces::BlockInfo& block)\n \n             // The coinbase tx has no undo data since no former output is spent\n             if (!tx->IsCoinBase()) {\n-                const auto& tx_undo{block_undo.vtxundo.at(i - 1)};\n+                const auto& tx_undo{block.undo_data->vtxundo.at(i - 1)};",
      "path": "src/index/coinstatsindex.cpp",
      "position": 39,
      "original_position": 33,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "afce60462f6d4ebc7b470ac2860c5d905e406ec7",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "afce60462f6d4ebc7b470ac2860c5d905e406ec7\r\n\r\nMight consider `Assert(...)` here.",
      "created_at": "2022-03-22T19:34:10Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r832554320",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832554320"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 179,
      "original_line": 179,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832560945",
      "pull_request_review_id": 914866406,
      "id": 832560945,
      "node_id": "PRRC_kwDOABII584xn98x",
      "diff_hunk": "@@ -92,6 +94,15 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         }\n         block_info.undo_data = &block_undo;\n     }\n+    int64_t current_time = 0;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "bf6a0f8ae87a3ea4aec2c5a080f86fc44e0bd19e",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "bf6a0f8ae87a3ea4aec2c5a080f86fc44e0bd19e\r\n\r\nHmm... note to other reviewers, I guess: it wasn't obvious to me that this is equivalent to the original code because it seems like if `m_synced` is somehow set between the conditional below and the next usage of `current_time` (line 117 at time of writing), then this code will behave differently than the original code (i.e. `current_time == 0` but is used in the second conditional). But I read through and verified that an `m_synced` set doesn't happen in between.\r\n\r\nWould be nice to be able to verify that `current_time != 0` in the second usage (line 117), but not mandatory IMO.",
      "created_at": "2022-03-22T19:42:51Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r832560945",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832560945"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832576147",
      "pull_request_review_id": 914866406,
      "id": 832576147,
      "node_id": "PRRC_kwDOABII584xoBqT",
      "diff_hunk": "@@ -195,10 +197,10 @@ void BaseIndex::ThreadSync()\n                 LOCK(cs_main);\n                 const CBlockIndex* pindex_next = NextSyncBlock(pindex, m_chainstate->m_chain);\n                 if (!pindex_next) {\n-                    m_best_block_index = pindex;\n-                    m_synced = true;\n-                    // No need to handle errors in Commit. See rationale above.\n-                    Commit(GetLocator(*m_chain, pindex->GetBlockHash()));\n+                    assert(pindex);\n+                    notifications->blockConnected(node::MakeBlockInfo(pindex));\n+                    assert(m_synced);\n+                    notifications->chainStateFlushed(GetLocator(*m_chain, pindex->GetBlockHash()));",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "e359c2666cfd205c2ea84c241bccf565670365c0",
      "in_reply_to_id": 803700112,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I guess this line could technically result in a double `Commit()` call at some point (based on `blockConnected` -> `m_last_locator_write_time` conditional), but even if that's true it would only happen once per locator-sync-interval AFAICT. So not a big deal.",
      "created_at": "2022-03-22T20:02:18Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r832576147",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832576147"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833397453",
      "pull_request_review_id": 914866406,
      "id": 833397453,
      "node_id": "PRRC_kwDOABII584xrKLN",
      "diff_hunk": "@@ -62,19 +62,9 @@ class BaseIndex\n     /// The last block in the chain that the index is in sync with.\n     std::atomic<const CBlockIndex*> m_best_block_index{nullptr};\n \n-    std::thread m_thread_sync;\n-    CThreadInterrupt m_interrupt;\n-\n     /// Read best block locator and check that data needed to sync has not been pruned.\n     bool Init();\n \n-    /// Sync the index with the block index starting from the current best block.\n-    /// Intended to be run in its own thread, m_thread_sync, and can be\n-    /// interrupted with m_interrupt. Once the index gets in sync, the m_synced\n-    /// flag is set and the BlockConnected ValidationInterface callback takes\n-    /// over and the sync thread exits.",
      "path": "src/index/base.h",
      "position": 63,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c4e0a9dd457018d78dc6be29251aec9d649af56c",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "c4e0a9dd457018d78dc6be29251aec9d649af56c\r\n\r\nEdit: this criticism is invalidated by later commit 8c0c231840b6a88e470da69c6885e6b6dd088df5\r\n\r\nNow that we've removed the doc here, it'd be nice to have some kind of indication in the `attachChain()` doc (or even inline in the body of the function) that that function is now responsible for starting and setting `m_thread_sync`; as it stands in this commit there isn't any external indication of that.\r\n",
      "created_at": "2022-03-23T15:22:20Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833397453",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833397453"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 85,
      "original_line": 85,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833400046",
      "pull_request_review_id": 914866406,
      "id": 833400046,
      "node_id": "PRRC_kwDOABII584xrKzu",
      "diff_hunk": "@@ -275,6 +275,8 @@ class Chain\n         bool disconnect_data = false;\n         //! Include undo data with block disconnected notifications.\n         bool disconnect_undo_data = false;\n+        //! Name to use for sync thread.",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c4e0a9dd457018d78dc6be29251aec9d649af56c",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "c4e0a9dd457018d78dc6be29251aec9d649af56c\r\n\r\n\"sync thread\" in the context of `Chain` is a little ambiguous IMO; maybe say \"index sync thread\"?",
      "created_at": "2022-03-23T15:24:36Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833400046",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833400046"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 278,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833430610",
      "pull_request_review_id": 914866406,
      "id": 833430610,
      "node_id": "PRRC_kwDOABII584xrSRS",
      "diff_hunk": "@@ -286,6 +289,9 @@ class Chain\n     //! Register handler for notifications.\n     virtual std::unique_ptr<Handler> handleNotifications(std::shared_ptr<Notifications> notifications) = 0;\n \n+    //! Wait for pending notifications.\n+    virtual void waitForNotifications() = 0;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 15,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d39c6d00627ddf746e1c37a4d6e07f0a24586034",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "d39c6d00627ddf746e1c37a4d6e07f0a24586034\r\n\r\nThe naming here given the use is somewhat misleading to me; naively, one possible meaning of \"waitForNotifications\" is that we're just waiting for a single notification to come in. What this really does is wait for the validation interface queue to clear, i.e. for any pending indexation to complete. I think something like `waitForEmptyIndexQueue()` or similar might be less confusing.",
      "created_at": "2022-03-23T15:49:03Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833430610",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833430610"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 293,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833664122",
      "pull_request_review_id": 914866406,
      "id": 833664122,
      "node_id": "PRRC_kwDOABII584xsLR6",
      "diff_hunk": "@@ -729,68 +729,43 @@ class ChainImpl : public Chain\n     }\n     std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override\n     {\n+        // Lock cs_main while finding forks and determining which blocks to\n+        // rescan. Release cs_main while processing blocks and while calling\n+        // RegisterSharedValidationInterface in the notifications thread.\n+        //\n+        // To prevent older, stale notifications being received, it is important\n+        // to connect the notifications proxy asynchronously inside the\n+        // validation queue, so older notifications in the queue are cleared\n+        // before the proxy becomes active.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be added to the queue after the queue entry which connects the proxy.\n+        AssertLockNotHeld(::cs_main);\n         LOCK(cs_main);\n         const CChainState& active = Assert(m_node.chainman)->ActiveChainstate();\n         const CBlockIndex* locator_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);\n         interfaces::BlockInfo block_info = node::MakeBlockInfo(locator_block);\n         block_info.chain_tip = locator_block == active.m_chain.Tip();\n-        // Need to register the ValidationInterface and call blockConnected\n-        // both while holding cs_main, so that callbacks are not missed if\n-        // blockConnected sets m_synced to true.\n         notifications->blockConnected(block_info);\n         if (!block_info.chain_tip && !checkBlocks(locator_block)) return nullptr;\n-        auto handler = std::make_unique<NotificationsHandlerImpl>(notifications);\n-        if (!block_info.chain_tip) handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name, [&active, locator_block, notifications, handler = handler.get()] {\n-            SetSyscallSandboxPolicy(SyscallSandboxPolicy::TX_INDEX);\n-            const CBlockIndex* pindex = locator_block;\n-            auto& consensus_params = Params().GetConsensus();\n-            while (!handler->m_interrupt) {\n-                {\n-                    LOCK(cs_main);\n-                    const CBlockIndex* pindex_next = NextSyncBlock(pindex, active.m_chain);\n-                    if (!pindex_next) {\n-                        assert(pindex);\n-                        notifications->blockConnected(node::MakeBlockInfo(pindex));\n-                        notifications->chainStateFlushed(active.m_chain.GetLocator(pindex));\n-                        break;\n-                    }\n-                    if (pindex_next->pprev != pindex) {\n-                        const CBlockIndex* current_tip = pindex;\n-                        const CBlockIndex* new_tip = pindex_next->pprev;\n-                        for (const CBlockIndex* iter_tip = current_tip; iter_tip != new_tip; iter_tip = iter_tip->pprev) {\n-                            CBlock block;\n-                            interfaces::BlockInfo block_info = node::MakeBlockInfo(iter_tip);\n-                            block_info.chain_tip = false;\n-                            if (!ReadBlockFromDisk(block, iter_tip, consensus_params)) {\n-                                block_info.error = strprintf(\"%s: Failed to read block %s from disk\",\n-                                        __func__, iter_tip->GetBlockHash().ToString());\n-                            } else {\n-                                block_info.data = &block;\n-                            }\n-                            notifications->blockDisconnected(block_info);\n-                            if (handler->m_interrupt) break;\n-                        }\n-                    }\n-                    pindex = pindex_next;\n-                }\n-\n-                CBlock block;\n-                interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex);\n-                block_info.chain_tip = false;\n-                if (!ReadBlockFromDisk(block, pindex, consensus_params)) {\n-                    block_info.error = strprintf(\"%s: Failed to read block %s from disk\",\n-                            __func__, pindex->GetBlockHash().ToString());\n-                } else {\n-                    block_info.data = &block;\n-                }\n-                notifications->blockConnected(block_info);\n-            }\n-        });\n+        auto handler = std::make_unique<NotificationsHandlerImpl>(notifications, /*connect=*/false);\n+        if (block_info.chain_tip) {\n+            CallFunctionInValidationInterfaceQueue([proxy = handler->m_proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); });\n+        } else {\n+            handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name,\n+                [&active, locator_block, notifications, &interrupt = handler->m_interrupt, proxy = handler->m_proxy] {\n+                SetSyscallSandboxPolicy(SyscallSandboxPolicy::TX_INDEX);\n+                SyncChain(active.m_chain, locator_block, notifications, interrupt,\n+                          /*on_sync=*/[proxy] { CallFunctionInValidationInterfaceQueue([proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); }); });\n+            });\n+        }\n         return handler;\n     }\n     std::unique_ptr<Handler> handleNotifications(std::shared_ptr<Notifications> notifications) override\n     {\n-        return std::make_unique<NotificationsHandlerImpl>(std::move(notifications));\n+        return std::make_unique<NotificationsHandlerImpl>(std::move(notifications), /*connect=*/true);",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "8c0c231840b6a88e470da69c6885e6b6dd088df5",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "8c0c231840b6a88e470da69c6885e6b6dd088df5\r\n\r\nI'm confused about what this is doing - why is `connect` true here but false in the call above?",
      "created_at": "2022-03-23T19:47:52Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833664122",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833664122"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 768,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833685301",
      "pull_request_review_id": 914866406,
      "id": 833685301,
      "node_id": "PRRC_kwDOABII584xsQc1",
      "diff_hunk": "@@ -746,21 +755,20 @@ class ChainImpl : public Chain\n         LOCK(cs_main);\n         const CChainState& active = Assert(m_node.chainman)->ActiveChainstate();\n         const CBlockIndex* locator_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);\n-        interfaces::BlockInfo block_info = node::MakeBlockInfo(locator_block);\n-        block_info.chain_tip = locator_block == active.m_chain.Tip();\n-        notifications->blockConnected(block_info);\n-        if (!block_info.chain_tip && !checkBlocks(locator_block)) return nullptr;\n-        auto handler = std::make_unique<NotificationsHandlerImpl>(notifications, /*connect=*/false);\n-        if (block_info.chain_tip) {\n-            CallFunctionInValidationInterfaceQueue([proxy = handler->m_proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); });\n-        } else {\n-            handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name,\n-                [&active, locator_block, notifications, &interrupt = handler->m_interrupt, proxy = handler->m_proxy] {\n-                SetSyscallSandboxPolicy(SyscallSandboxPolicy::TX_INDEX);\n-                SyncChain(active.m_chain, locator_block, notifications, interrupt,\n-                          /*on_sync=*/[proxy] { CallFunctionInValidationInterfaceQueue([proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); }); });\n-            });\n+        block_info.emplace(MakeBlockInfo(locator_block));\n+        block_info->chain_tip = locator_block == active.m_chain.Tip();\n+        if (!block_info->chain_tip && !checkBlocks(locator_block)) return nullptr;\n+        handler = std::make_unique<NotificationsHandlerImpl>(notifications, /*connect=*/false);\n+        handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name,\n+            [&block_info, &promise, &active, locator_block, notifications, &interrupt = handler->m_interrupt, proxy = handler->m_proxy] {\n+            SetSyscallSandboxPolicy(SyscallSandboxPolicy::TX_INDEX);\n+            notifications->blockConnected(*block_info);\n+            promise.set_value();\n+            SyncChain(active.m_chain, locator_block, notifications, interrupt,\n+                      /*on_sync=*/[proxy] { CallFunctionInValidationInterfaceQueue([proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); }); });\n+        });\n         }\n+        promise.get_future().wait();",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c7729d1f0ccb17c39c42ee5c7881d469d150c101",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "c7729d1f0ccb17c39c42ee5c7881d469d150c101\r\n\r\nJust so I'm sure I understand, this has the effect of blocking the init thread until the first `blockConnected` call is completed?",
      "created_at": "2022-03-23T20:16:47Z",
      "updated_at": "2022-03-24T13:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833685301",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/833685301"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 845,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835611937",
      "pull_request_review_id": 922143453,
      "id": 835611937,
      "node_id": "PRRC_kwDOABII584xzm0h",
      "diff_hunk": "@@ -746,21 +755,20 @@ class ChainImpl : public Chain\n         LOCK(cs_main);\n         const CChainState& active = Assert(m_node.chainman)->ActiveChainstate();\n         const CBlockIndex* locator_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);\n-        interfaces::BlockInfo block_info = node::MakeBlockInfo(locator_block);\n-        block_info.chain_tip = locator_block == active.m_chain.Tip();\n-        notifications->blockConnected(block_info);\n-        if (!block_info.chain_tip && !checkBlocks(locator_block)) return nullptr;\n-        auto handler = std::make_unique<NotificationsHandlerImpl>(notifications, /*connect=*/false);\n-        if (block_info.chain_tip) {\n-            CallFunctionInValidationInterfaceQueue([proxy = handler->m_proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); });\n-        } else {\n-            handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name,\n-                [&active, locator_block, notifications, &interrupt = handler->m_interrupt, proxy = handler->m_proxy] {\n-                SetSyscallSandboxPolicy(SyscallSandboxPolicy::TX_INDEX);\n-                SyncChain(active.m_chain, locator_block, notifications, interrupt,\n-                          /*on_sync=*/[proxy] { CallFunctionInValidationInterfaceQueue([proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); }); });\n-            });\n+        block_info.emplace(MakeBlockInfo(locator_block));\n+        block_info->chain_tip = locator_block == active.m_chain.Tip();\n+        if (!block_info->chain_tip && !checkBlocks(locator_block)) return nullptr;\n+        handler = std::make_unique<NotificationsHandlerImpl>(notifications, /*connect=*/false);\n+        handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name,\n+            [&block_info, &promise, &active, locator_block, notifications, &interrupt = handler->m_interrupt, proxy = handler->m_proxy] {\n+            SetSyscallSandboxPolicy(SyscallSandboxPolicy::TX_INDEX);\n+            notifications->blockConnected(*block_info);\n+            promise.set_value();\n+            SyncChain(active.m_chain, locator_block, notifications, interrupt,\n+                      /*on_sync=*/[proxy] { CallFunctionInValidationInterfaceQueue([proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); }); });\n+        });\n         }\n+        promise.get_future().wait();",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c7729d1f0ccb17c39c42ee5c7881d469d150c101",
      "in_reply_to_id": 833685301,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833685301\r\n\r\n> [c7729d1](https://github.com/bitcoin/bitcoin/commit/c7729d1f0ccb17c39c42ee5c7881d469d150c101)\r\n> \r\n> Just so I'm sure I understand, this has the effect of blocking the init thread until the first `blockConnected` call is completed?\r\n\r\nYes, added comment. The wallet or index calling attachChain needs be able to find out the sync starting point or last block synced. An alternate approach would be for attachChain to return the starting block. This is approach I took earlier in #15719 https://github.com/bitcoin/bitcoin/blob/2b898a0456d742911c1f74229c9fc64a0012ca42/src/interfaces/chain.h#L260-L261, but it seems like would made things more complicated for callers by adding an output argument, and requiring the caller to update m_synced and m_best_block from multiple places instead of only inside blockConnected.",
      "created_at": "2022-03-25T21:10:24Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835611937",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835611937"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 845,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612081",
      "pull_request_review_id": 922143453,
      "id": 835612081,
      "node_id": "PRRC_kwDOABII584xzm2x",
      "diff_hunk": "@@ -729,68 +729,43 @@ class ChainImpl : public Chain\n     }\n     std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override\n     {\n+        // Lock cs_main while finding forks and determining which blocks to\n+        // rescan. Release cs_main while processing blocks and while calling\n+        // RegisterSharedValidationInterface in the notifications thread.\n+        //\n+        // To prevent older, stale notifications being received, it is important\n+        // to connect the notifications proxy asynchronously inside the\n+        // validation queue, so older notifications in the queue are cleared\n+        // before the proxy becomes active.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be added to the queue after the queue entry which connects the proxy.\n+        AssertLockNotHeld(::cs_main);\n         LOCK(cs_main);\n         const CChainState& active = Assert(m_node.chainman)->ActiveChainstate();\n         const CBlockIndex* locator_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);\n         interfaces::BlockInfo block_info = node::MakeBlockInfo(locator_block);\n         block_info.chain_tip = locator_block == active.m_chain.Tip();\n-        // Need to register the ValidationInterface and call blockConnected\n-        // both while holding cs_main, so that callbacks are not missed if\n-        // blockConnected sets m_synced to true.\n         notifications->blockConnected(block_info);\n         if (!block_info.chain_tip && !checkBlocks(locator_block)) return nullptr;\n-        auto handler = std::make_unique<NotificationsHandlerImpl>(notifications);\n-        if (!block_info.chain_tip) handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name, [&active, locator_block, notifications, handler = handler.get()] {\n-            SetSyscallSandboxPolicy(SyscallSandboxPolicy::TX_INDEX);\n-            const CBlockIndex* pindex = locator_block;\n-            auto& consensus_params = Params().GetConsensus();\n-            while (!handler->m_interrupt) {\n-                {\n-                    LOCK(cs_main);\n-                    const CBlockIndex* pindex_next = NextSyncBlock(pindex, active.m_chain);\n-                    if (!pindex_next) {\n-                        assert(pindex);\n-                        notifications->blockConnected(node::MakeBlockInfo(pindex));\n-                        notifications->chainStateFlushed(active.m_chain.GetLocator(pindex));\n-                        break;\n-                    }\n-                    if (pindex_next->pprev != pindex) {\n-                        const CBlockIndex* current_tip = pindex;\n-                        const CBlockIndex* new_tip = pindex_next->pprev;\n-                        for (const CBlockIndex* iter_tip = current_tip; iter_tip != new_tip; iter_tip = iter_tip->pprev) {\n-                            CBlock block;\n-                            interfaces::BlockInfo block_info = node::MakeBlockInfo(iter_tip);\n-                            block_info.chain_tip = false;\n-                            if (!ReadBlockFromDisk(block, iter_tip, consensus_params)) {\n-                                block_info.error = strprintf(\"%s: Failed to read block %s from disk\",\n-                                        __func__, iter_tip->GetBlockHash().ToString());\n-                            } else {\n-                                block_info.data = &block;\n-                            }\n-                            notifications->blockDisconnected(block_info);\n-                            if (handler->m_interrupt) break;\n-                        }\n-                    }\n-                    pindex = pindex_next;\n-                }\n-\n-                CBlock block;\n-                interfaces::BlockInfo block_info = node::MakeBlockInfo(pindex);\n-                block_info.chain_tip = false;\n-                if (!ReadBlockFromDisk(block, pindex, consensus_params)) {\n-                    block_info.error = strprintf(\"%s: Failed to read block %s from disk\",\n-                            __func__, pindex->GetBlockHash().ToString());\n-                } else {\n-                    block_info.data = &block;\n-                }\n-                notifications->blockConnected(block_info);\n-            }\n-        });\n+        auto handler = std::make_unique<NotificationsHandlerImpl>(notifications, /*connect=*/false);\n+        if (block_info.chain_tip) {\n+            CallFunctionInValidationInterfaceQueue([proxy = handler->m_proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); });\n+        } else {\n+            handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name,\n+                [&active, locator_block, notifications, &interrupt = handler->m_interrupt, proxy = handler->m_proxy] {\n+                SetSyscallSandboxPolicy(SyscallSandboxPolicy::TX_INDEX);\n+                SyncChain(active.m_chain, locator_block, notifications, interrupt,\n+                          /*on_sync=*/[proxy] { CallFunctionInValidationInterfaceQueue([proxy] { if (proxy->connect()) RegisterSharedValidationInterface(proxy); }); });\n+            });\n+        }\n         return handler;\n     }\n     std::unique_ptr<Handler> handleNotifications(std::shared_ptr<Notifications> notifications) override\n     {\n-        return std::make_unique<NotificationsHandlerImpl>(std::move(notifications));\n+        return std::make_unique<NotificationsHandlerImpl>(std::move(notifications), /*connect=*/true);",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "8c0c231840b6a88e470da69c6885e6b6dd088df5",
      "in_reply_to_id": 833664122,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833664122\r\n\r\n> [8c0c231](https://github.com/bitcoin/bitcoin/commit/8c0c231840b6a88e470da69c6885e6b6dd088df5)\r\n> \r\n> I'm confused about what this is doing - why is `connect` true here but false in the call above?\r\n\r\nSorry, this logic got messy because the notifications proxy now gets registered and unregistered from different threads, and could disconnected from the handler before the register call could happen, and I was trying to deal with cirrus TSAN errors. I rewrote it so it should understandable now.\r\n\r\nTo answer the question, connect was true for the older handleNotifications method because it doesn't care about stale notifications and just wants to connect right away, but false for attachChain because it delays registration to avoid sending stale notifications.",
      "created_at": "2022-03-25T21:10:41Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835612081",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612081"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 768,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612218",
      "pull_request_review_id": 922143453,
      "id": 835612218,
      "node_id": "PRRC_kwDOABII584xzm46",
      "diff_hunk": "@@ -286,6 +289,9 @@ class Chain\n     //! Register handler for notifications.\n     virtual std::unique_ptr<Handler> handleNotifications(std::shared_ptr<Notifications> notifications) = 0;\n \n+    //! Wait for pending notifications.\n+    virtual void waitForNotifications() = 0;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 15,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d39c6d00627ddf746e1c37a4d6e07f0a24586034",
      "in_reply_to_id": 833430610,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833430610\r\n\r\n> [d39c6d0](https://github.com/bitcoin/bitcoin/commit/d39c6d00627ddf746e1c37a4d6e07f0a24586034)\r\n> \r\n> The naming here given the use is somewhat misleading to me; naively, one possible meaning of \"waitForNotifications\" is that we're just waiting for a single notification to come in. What this really does is wait for the validation interface queue to clear, i.e. for any pending indexation to complete. I think something like `waitForEmptyIndexQueue()` or similar might be less confusing.\r\n\r\nChanged from `waitForNotifications` to `waitForPendingNotifications` now. This new name is less consistent with the `waitForNotificationsIfTipChanged` method name immediately below, but it is less ambiguous.\r\n\r\nI think `waitForEmptyIndexQueue()` would be misleading because the queue doesn't need to be empty for this to return. It just waits for currently pending notifications to be processed, not new notifications. It just marks a point in the stream, so the queue may never need to be empty at any point.",
      "created_at": "2022-03-25T21:10:57Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835612218",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612218"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 293,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612361",
      "pull_request_review_id": 922143453,
      "id": 835612361,
      "node_id": "PRRC_kwDOABII584xzm7J",
      "diff_hunk": "@@ -275,6 +275,8 @@ class Chain\n         bool disconnect_data = false;\n         //! Include undo data with block disconnected notifications.\n         bool disconnect_undo_data = false;\n+        //! Name to use for sync thread.",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c4e0a9dd457018d78dc6be29251aec9d649af56c",
      "in_reply_to_id": 833400046,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833400046\r\n\r\n> [c4e0a9d](https://github.com/bitcoin/bitcoin/commit/c4e0a9dd457018d78dc6be29251aec9d649af56c)\r\n> \r\n> \"sync thread\" in the context of `Chain` is a little ambiguous IMO; maybe say \"index sync thread\"?\r\n\r\nChanged comment to \"Name to use for attachChain sync thread\". I would like to use the new attachChain method for wallets as well as indexes (#15719) so this is avoiding the word \"index\".",
      "created_at": "2022-03-25T21:11:16Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835612361",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612361"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 278,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612595",
      "pull_request_review_id": 922143453,
      "id": 835612595,
      "node_id": "PRRC_kwDOABII584xzm-z",
      "diff_hunk": "@@ -62,19 +62,9 @@ class BaseIndex\n     /// The last block in the chain that the index is in sync with.\n     std::atomic<const CBlockIndex*> m_best_block_index{nullptr};\n \n-    std::thread m_thread_sync;\n-    CThreadInterrupt m_interrupt;\n-\n     /// Read best block locator and check that data needed to sync has not been pruned.\n     bool Init();\n \n-    /// Sync the index with the block index starting from the current best block.\n-    /// Intended to be run in its own thread, m_thread_sync, and can be\n-    /// interrupted with m_interrupt. Once the index gets in sync, the m_synced\n-    /// flag is set and the BlockConnected ValidationInterface callback takes\n-    /// over and the sync thread exits.",
      "path": "src/index/base.h",
      "position": 63,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c4e0a9dd457018d78dc6be29251aec9d649af56c",
      "in_reply_to_id": 833397453,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r833397453\r\n\r\n> [c4e0a9d](https://github.com/bitcoin/bitcoin/commit/c4e0a9dd457018d78dc6be29251aec9d649af56c)\r\n> \r\n> Edit: this criticism is invalidated by later commit [8c0c231](https://github.com/bitcoin/bitcoin/commit/8c0c231840b6a88e470da69c6885e6b6dd088df5)\r\n> \r\n> Now that we've removed the doc here, it'd be nice to have some kind of indication in the `attachChain()` doc (or even inline in the body of the function) that that function is now responsible for starting and setting `m_thread_sync`; as it stands in this commit there isn't any external indication of that.\r\n\r\nTo improve this, I added some comments and an assert to this commit.",
      "created_at": "2022-03-25T21:11:42Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835612595",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612595"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 85,
      "original_line": 85,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612736",
      "pull_request_review_id": 922143453,
      "id": 835612736,
      "node_id": "PRRC_kwDOABII584xznBA",
      "diff_hunk": "@@ -92,6 +94,15 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         }\n         block_info.undo_data = &block_undo;\n     }\n+    int64_t current_time = 0;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "bf6a0f8ae87a3ea4aec2c5a080f86fc44e0bd19e",
      "in_reply_to_id": 832560945,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r832560945\r\n\r\n> Would be nice to be able to verify that `current_time != 0` in the second usage (line 117), but not mandatory IMO.\r\n\r\nThanks. I added a direct assert that m_synced value didn't change. This is an even stricter check, and ensures that the Commit() call still happens and doesn't get skipped.",
      "created_at": "2022-03-25T21:12:00Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835612736",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612736"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612836",
      "pull_request_review_id": 922143453,
      "id": 835612836,
      "node_id": "PRRC_kwDOABII584xznCk",
      "diff_hunk": "@@ -182,7 +173,7 @@ bool CoinStatsIndex::CustomAppend(const interfaces::BlockInfo& block)\n \n             // The coinbase tx has no undo data since no former output is spent\n             if (!tx->IsCoinBase()) {\n-                const auto& tx_undo{block_undo.vtxundo.at(i - 1)};\n+                const auto& tx_undo{block.undo_data->vtxundo.at(i - 1)};",
      "path": "src/index/coinstatsindex.cpp",
      "position": 39,
      "original_position": 33,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "afce60462f6d4ebc7b470ac2860c5d905e406ec7",
      "in_reply_to_id": 832554320,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r832554320\r\n\r\n> [afce604](https://github.com/bitcoin/bitcoin/commit/afce60462f6d4ebc7b470ac2860c5d905e406ec7)\r\n> \r\n> Might consider `Assert(...)` here.\r\n\r\nAdded asserts above",
      "created_at": "2022-03-25T21:12:13Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835612836",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612836"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 179,
      "original_line": 179,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612911",
      "pull_request_review_id": 922143453,
      "id": 835612911,
      "node_id": "PRRC_kwDOABII584xznDv",
      "diff_hunk": "@@ -425,13 +410,13 @@ bool CoinStatsIndex::ReverseBlock(const CBlock& block, const CBlockIndex* pindex\n     }\n \n     // Remove the new UTXOs that were created from the block\n-    for (size_t i = 0; i < block.vtx.size(); ++i) {\n-        const auto& tx{block.vtx.at(i)};\n+    for (size_t i = 0; i < block.data->vtx.size(); ++i) {",
      "path": "src/index/coinstatsindex.cpp",
      "position": 153,
      "original_position": 89,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "0e80167cc848364a456bbfd4cba12891a5f06b35",
      "in_reply_to_id": 832336236,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r832336236\r\n\r\n> [0e80167](https://github.com/bitcoin/bitcoin/commit/0e80167cc848364a456bbfd4cba12891a5f06b35)\r\n> \r\n> Maybe worth doing `Assert(block.data)->vtx.size()` here? Possibly also with `.undo_data` below.\r\n\r\nMakes sense, added asserts",
      "created_at": "2022-03-25T21:12:26Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835612911",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835612911"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 420,
      "original_line": 420,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835613042",
      "pull_request_review_id": 922143453,
      "id": 835613042,
      "node_id": "PRRC_kwDOABII584xznFy",
      "diff_hunk": "@@ -87,10 +90,8 @@ class BaseIndex : public CValidationInterface\n \n     void ChainStateFlushed(const CBlockLocator& locator) override;\n \n-    const CBlockIndex* CurrentIndex() { return m_best_block_index.load(); };\n-\n     /// Initialize internal state from the database and block index.\n-    [[nodiscard]] virtual bool Init();\n+    [[nodiscard]] virtual bool CustomInit(const std::optional<interfaces::BlockKey>& block) { return true; }",
      "path": "src/index/base.h",
      "position": 131,
      "original_position": 18,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "15daa47ee06b9f334dd2862856f41a2ad4b34a3d",
      "in_reply_to_id": 831443151,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r831443151\r\n\r\n> [15daa47](https://github.com/bitcoin/bitcoin/commit/15daa47ee06b9f334dd2862856f41a2ad4b34a3d)\r\n> \r\n> Sad to see a Russ PR that's introducing a new method with PascalCase, but I guess we're matching existing style... stuck_out_tongue\r\n\r\nYeah I like it for new classes mostly. I'm happy you are using this convention in validation code since validation code has lots of standalone functions, and knowing whether you are calling method or a function can really tell you something. In index code there aren't too many standalone functions.",
      "created_at": "2022-03-25T21:12:41Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835613042",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835613042"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 133,
      "original_line": 133,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835614943",
      "pull_request_review_id": 922143453,
      "id": 835614943,
      "node_id": "PRRC_kwDOABII584xznjf",
      "diff_hunk": "@@ -0,0 +1,23 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <chain.h>\n+#include <interfaces/chain.h>\n+#include <uint256.h>\n+\n+namespace node {\n+interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* index, const CBlock* data)\n+{\n+    interfaces::BlockInfo info{index ? *index->phashBlock : uint256::ZERO};",
      "path": "src/node/chain.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "cf5d3404484b08939992566cca0f1151d050a921",
      "in_reply_to_id": 830350296,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r830350296\r\n\r\n> Edit: okay, I see - in a later commit (when we add `attachChain`), this may be passed a nullptr if we're initializing the handler with an empty datadir.\r\n\r\nRight, in cases where CChain::Tip() is null this just returns a struct with all default values. Alternative would be to return `optional<BlockInfo>` and pass around `optional<BlockInfo>` variables more places. But this would force code to handle nullopt as a special case when in practice the struct values are ignored anyway and the defaults are fine. It's similar to using INT_MAX if you mean to represent infinity. It doesn't capture the meaning perfectly, but the semantics are close enough that it can make sense if it gets rid of special cases and makes code simpler.",
      "created_at": "2022-03-25T21:16:47Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835614943",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835614943"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835616966",
      "pull_request_review_id": 922143453,
      "id": 835616966,
      "node_id": "PRRC_kwDOABII584xzoDG",
      "diff_hunk": "@@ -195,10 +197,10 @@ void BaseIndex::ThreadSync()\n                 LOCK(cs_main);\n                 const CBlockIndex* pindex_next = NextSyncBlock(pindex, m_chainstate->m_chain);\n                 if (!pindex_next) {\n-                    m_best_block_index = pindex;\n-                    m_synced = true;\n-                    // No need to handle errors in Commit. See rationale above.\n-                    Commit(GetLocator(*m_chain, pindex->GetBlockHash()));\n+                    assert(pindex);\n+                    notifications->blockConnected(node::MakeBlockInfo(pindex));\n+                    assert(m_synced);\n+                    notifications->chainStateFlushed(GetLocator(*m_chain, pindex->GetBlockHash()));",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "e359c2666cfd205c2ea84c241bccf565670365c0",
      "in_reply_to_id": 803700112,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"indexes, refactor: Move Commit logic out of ThreadSync to notification handlers\" (7add4807d84e89daec20042559b076f9941b9c1a)\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r832576147\r\n\r\n> I guess this line could technically result in a double `Commit()` call at some point (based on `blockConnected` -> `m_last_locator_write_time` conditional), but even if that's true it would only happen once per locator-sync-interval AFAICT. So not a big deal.\r\n\r\nThis shouldn't happen because the new `notifications->blockConnected` call is not passing any block data (`block.data == nullptr`, so the `blockConnected` implementation just updates `m_synced` and `m_best_block_index` and doesn't do anything else with the block).\r\n\r\nI added more documentation about different types of `blockConnected` calls in `interfaces/chain.h` but the idea is that a `blockConnected` call with `block.data != nullptr` provides information about a new block that is being connected and needs to be processed, and a call with `block.data == nullptr` just tells you the last block that was already connected, which is useful at the beginning or end of a sync.",
      "created_at": "2022-03-25T21:21:13Z",
      "updated_at": "2022-03-28T18:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r835616966",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/835616966"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866785619",
      "pull_request_review_id": 964591461,
      "id": 866785619,
      "node_id": "PRRC_kwDOABII584zqhlT",
      "diff_hunk": "@@ -101,8 +113,16 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     // best block is not updated here before sync, but this has been\n     // longstanding behavior since syncing was introduced in #13033 so care\n     // should be taken if changing m_best_block_index semantics.\n-    if (m_index.m_synced) {\n+    assert(synced == m_index.m_synced);\n+    if (synced) {\n         m_index.m_best_block_index = pindex;\n+    } else if (m_last_locator_write_time + SYNC_LOCATOR_WRITE_INTERVAL < current_time || m_index.m_interrupt) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1819bdb7cb0634dad2e07daccfe7e8a122a943d6",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "commit 1819bdb7cb0634dad2e07daccfe7e8a122a943d6:\r\nI think that this changed behavior slightly because it changes the order of indexing the block (`CustomAppend`) and periodically updating the index' best block (`Commit`)  - which is better because the indexed data on disk wouldn't be in an inconsistent state temporarily. I opened #25074 to fix this on master.",
      "created_at": "2022-05-06T12:38:31Z",
      "updated_at": "2022-05-06T12:38:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r866785619",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866785619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 119,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/869810783",
      "pull_request_review_id": 968592395,
      "id": 869810783,
      "node_id": "PRRC_kwDOABII584z2EJf",
      "diff_hunk": "@@ -101,8 +113,16 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n     // best block is not updated here before sync, but this has been\n     // longstanding behavior since syncing was introduced in #13033 so care\n     // should be taken if changing m_best_block_index semantics.\n-    if (m_index.m_synced) {\n+    assert(synced == m_index.m_synced);\n+    if (synced) {\n         m_index.m_best_block_index = pindex;\n+    } else if (m_last_locator_write_time + SYNC_LOCATOR_WRITE_INTERVAL < current_time || m_index.m_interrupt) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1819bdb7cb0634dad2e07daccfe7e8a122a943d6",
      "in_reply_to_id": 866785619,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r866785619\r\n\r\n> commit [1819bdb](https://github.com/bitcoin/bitcoin/commit/1819bdb7cb0634dad2e07daccfe7e8a122a943d6): I think that this changed behavior slightly because it changes the order of indexing the block (`CustomAppend`) \r\n\r\nThanks. Good catch and I reviewed your PR\r\n",
      "created_at": "2022-05-11T02:13:12Z",
      "updated_at": "2022-05-11T03:59:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r869810783",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/869810783"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 119,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874092009",
      "pull_request_review_id": 974477399,
      "id": 874092009,
      "node_id": "PRRC_kwDOABII5840GZXp",
      "diff_hunk": "@@ -659,9 +717,96 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    bool checkBlocks(const CBlockIndex* locator_block) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n+        const CChain& active_chain = Assert(m_node.chainman)->ActiveChain();\n+        bool prune_violation = false;\n+        if (!locator_block) {\n+            // make sure we have all block data back to the genesis\n+            prune_violation = m_node.chainman->m_blockman.GetFirstStoredBlock(*active_chain.Tip()) != active_chain.Genesis();\n+        }\n+        // in case the index has a best block set and is not fully synced\n+        // check if we have the required blocks to continue building the index\n+        else {\n+            const CBlockIndex* block_to_test = locator_block;\n+            if (!active_chain.Contains(block_to_test)) {\n+                // if the bestblock is not part of the mainchain, find the fork\n+                // and make sure we have all data down to the fork\n+                block_to_test = active_chain.FindFork(block_to_test);\n+            }\n+            const CBlockIndex* block = active_chain.Tip();\n+            prune_violation = true;\n+            // check backwards from the tip if we have all block data until we reach the indexes bestblock\n+            while (block_to_test && block && (block->nStatus & BLOCK_HAVE_DATA)) {\n+                if (block_to_test == block) {\n+                    prune_violation = false;\n+                    break;\n+                }\n+                // block->pprev must exist at this point, since block_to_test is part of the chain\n+                // and thus must be encountered when going backwards from the tip\n+                assert(block->pprev);\n+                block = block->pprev;\n+            }\n+        }\n+        return !prune_violation;\n+    }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override\n+    {\n+        std::unique_ptr<NotificationsHandlerImpl> handler;\n+        std::optional<interfaces::BlockInfo> block_info;\n+        // std::promise to wait for the first blockConnected notification, so\n+        // caller is notified about the starting block before this returns.\n+        // It might be good in the future to return without waiting for this,\n+        // and allow more initialization code to run in parallel.\n+        std::promise<void> promise;\n+        {\n+        // Lock cs_main while finding forks and determining which blocks to\n+        // rescan. Release cs_main while processing blocks and while calling\n+        // RegisterSharedValidationInterface in the notifications thread.\n+        //\n+        // To prevent older, stale notifications currently in the validation\n+        // queue from being received, it is important to not to register for\n+        // notifications immediately, but to delay registration with\n+        // CallFunctionInValidationInterfaceQueue, registering the notification\n+        // proxy inside the queue, so older notifications in the queue before it\n+        // get processed before the proxy is registered.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be added to the queue after the queue entry which connects the proxy.\n+        AssertLockNotHeld(::cs_main);\n+        LOCK(cs_main);\n+        const CChainState& active = Assert(m_node.chainman)->ActiveChainstate();\n+        const CBlockIndex* locator_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 222,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "fd6568f6888bc86985ce626731cd0f9db35889b8",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "One general point (if it's too unrelated to this PR, we could also discuss it elsewhere):\r\n\r\nI think that the current way of initialising indexes by calling `FindForkInGlobalIndex()` for the saved locator and setting this as the best block is not compatible with indexes that have state beyond the best block, such as coinstatsindex:\r\nFor this index, we need to call `CustomRemove()` (or `Rewind` on master) to revert the actions of each block and adjust the muhash. This is not done during Init, so the coinstatsindex currently cannot deal with the situation where the saved best block of the index is not part of the best chain.\r\n\r\nOne solution for this would be not to call `FindForkInGlobalIndex` but instead read in the first block stored in the locator and then revert blocks step by step up to the fork point - this is necessary for coinstatsindex, but it adds the additional requirement that all blocks between the forkpoint and the saved block must be available, which is something that e.g. txindex doesn't really need.  \r\n\r\nI did a rough implementation for fixing the coinstatsindex init sequence in [this branch](https://github.com/mzumsande/bitcoin/tree/202205_index_init_rewind), which I think works but (at least on first glance) seems to be really incompatible with the approach here, so I wouldn't just PR it.\r\n\r\nWhat do you think about this problem?",
      "created_at": "2022-05-16T19:39:22Z",
      "updated_at": "2022-05-16T19:47:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r874092009",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874092009"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 828,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874121855",
      "pull_request_review_id": 974518738,
      "id": 874121855,
      "node_id": "PRRC_kwDOABII5840Ggp_",
      "diff_hunk": "@@ -659,9 +717,96 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    bool checkBlocks(const CBlockIndex* locator_block) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n+        const CChain& active_chain = Assert(m_node.chainman)->ActiveChain();\n+        bool prune_violation = false;\n+        if (!locator_block) {\n+            // make sure we have all block data back to the genesis\n+            prune_violation = m_node.chainman->m_blockman.GetFirstStoredBlock(*active_chain.Tip()) != active_chain.Genesis();\n+        }\n+        // in case the index has a best block set and is not fully synced\n+        // check if we have the required blocks to continue building the index\n+        else {\n+            const CBlockIndex* block_to_test = locator_block;\n+            if (!active_chain.Contains(block_to_test)) {\n+                // if the bestblock is not part of the mainchain, find the fork\n+                // and make sure we have all data down to the fork\n+                block_to_test = active_chain.FindFork(block_to_test);\n+            }\n+            const CBlockIndex* block = active_chain.Tip();\n+            prune_violation = true;\n+            // check backwards from the tip if we have all block data until we reach the indexes bestblock\n+            while (block_to_test && block && (block->nStatus & BLOCK_HAVE_DATA)) {\n+                if (block_to_test == block) {\n+                    prune_violation = false;\n+                    break;\n+                }\n+                // block->pprev must exist at this point, since block_to_test is part of the chain\n+                // and thus must be encountered when going backwards from the tip\n+                assert(block->pprev);\n+                block = block->pprev;\n+            }\n+        }\n+        return !prune_violation;\n+    }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override\n+    {\n+        std::unique_ptr<NotificationsHandlerImpl> handler;\n+        std::optional<interfaces::BlockInfo> block_info;\n+        // std::promise to wait for the first blockConnected notification, so\n+        // caller is notified about the starting block before this returns.\n+        // It might be good in the future to return without waiting for this,\n+        // and allow more initialization code to run in parallel.\n+        std::promise<void> promise;\n+        {\n+        // Lock cs_main while finding forks and determining which blocks to\n+        // rescan. Release cs_main while processing blocks and while calling\n+        // RegisterSharedValidationInterface in the notifications thread.\n+        //\n+        // To prevent older, stale notifications currently in the validation\n+        // queue from being received, it is important to not to register for\n+        // notifications immediately, but to delay registration with\n+        // CallFunctionInValidationInterfaceQueue, registering the notification\n+        // proxy inside the queue, so older notifications in the queue before it\n+        // get processed before the proxy is registered.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be added to the queue after the queue entry which connects the proxy.\n+        AssertLockNotHeld(::cs_main);\n+        LOCK(cs_main);\n+        const CChainState& active = Assert(m_node.chainman)->ActiveChainstate();\n+        const CBlockIndex* locator_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 222,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "fd6568f6888bc86985ce626731cd0f9db35889b8",
      "in_reply_to_id": 874092009,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> I think that the current way of initialising indexes by calling FindForkInGlobalIndex() for the saved locator and setting this as the best block\r\n\r\nYou're right but this is easy to fix by just replacing `FindForkInGlobalIndex()` call with a `LookupBlockIndex` call. There should be no need to add additional remove/rewind calls, though. Existing code should be aware of forks and how to handle them.",
      "created_at": "2022-05-16T20:19:30Z",
      "updated_at": "2022-05-16T20:19:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r874121855",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874121855"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 828,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874801114",
      "pull_request_review_id": 975451115,
      "id": 874801114,
      "node_id": "PRRC_kwDOABII5840JGfa",
      "diff_hunk": "@@ -659,9 +717,96 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    bool checkBlocks(const CBlockIndex* locator_block) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n+        const CChain& active_chain = Assert(m_node.chainman)->ActiveChain();\n+        bool prune_violation = false;\n+        if (!locator_block) {\n+            // make sure we have all block data back to the genesis\n+            prune_violation = m_node.chainman->m_blockman.GetFirstStoredBlock(*active_chain.Tip()) != active_chain.Genesis();\n+        }\n+        // in case the index has a best block set and is not fully synced\n+        // check if we have the required blocks to continue building the index\n+        else {\n+            const CBlockIndex* block_to_test = locator_block;\n+            if (!active_chain.Contains(block_to_test)) {\n+                // if the bestblock is not part of the mainchain, find the fork\n+                // and make sure we have all data down to the fork\n+                block_to_test = active_chain.FindFork(block_to_test);\n+            }\n+            const CBlockIndex* block = active_chain.Tip();\n+            prune_violation = true;\n+            // check backwards from the tip if we have all block data until we reach the indexes bestblock\n+            while (block_to_test && block && (block->nStatus & BLOCK_HAVE_DATA)) {\n+                if (block_to_test == block) {\n+                    prune_violation = false;\n+                    break;\n+                }\n+                // block->pprev must exist at this point, since block_to_test is part of the chain\n+                // and thus must be encountered when going backwards from the tip\n+                assert(block->pprev);\n+                block = block->pprev;\n+            }\n+        }\n+        return !prune_violation;\n+    }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override\n+    {\n+        std::unique_ptr<NotificationsHandlerImpl> handler;\n+        std::optional<interfaces::BlockInfo> block_info;\n+        // std::promise to wait for the first blockConnected notification, so\n+        // caller is notified about the starting block before this returns.\n+        // It might be good in the future to return without waiting for this,\n+        // and allow more initialization code to run in parallel.\n+        std::promise<void> promise;\n+        {\n+        // Lock cs_main while finding forks and determining which blocks to\n+        // rescan. Release cs_main while processing blocks and while calling\n+        // RegisterSharedValidationInterface in the notifications thread.\n+        //\n+        // To prevent older, stale notifications currently in the validation\n+        // queue from being received, it is important to not to register for\n+        // notifications immediately, but to delay registration with\n+        // CallFunctionInValidationInterfaceQueue, registering the notification\n+        // proxy inside the queue, so older notifications in the queue before it\n+        // get processed before the proxy is registered.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be added to the queue after the queue entry which connects the proxy.\n+        AssertLockNotHeld(::cs_main);\n+        LOCK(cs_main);\n+        const CChainState& active = Assert(m_node.chainman)->ActiveChainstate();\n+        const CBlockIndex* locator_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 222,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "fd6568f6888bc86985ce626731cd0f9db35889b8",
      "in_reply_to_id": 874092009,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Great, thanks! I missed that `NextSyncBlock()` goes back to the fork point already in master during sync. If it's that easy to fix, I might open a PR vs master. Here, this can be resolved.",
      "created_at": "2022-05-17T13:16:38Z",
      "updated_at": "2022-05-17T13:16:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r874801114",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874801114"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 828,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/875392405",
      "pull_request_review_id": 976258445,
      "id": 875392405,
      "node_id": "PRRC_kwDOABII5840LW2V",
      "diff_hunk": "@@ -659,9 +717,96 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    bool checkBlocks(const CBlockIndex* locator_block) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n+        const CChain& active_chain = Assert(m_node.chainman)->ActiveChain();\n+        bool prune_violation = false;\n+        if (!locator_block) {\n+            // make sure we have all block data back to the genesis\n+            prune_violation = m_node.chainman->m_blockman.GetFirstStoredBlock(*active_chain.Tip()) != active_chain.Genesis();\n+        }\n+        // in case the index has a best block set and is not fully synced\n+        // check if we have the required blocks to continue building the index\n+        else {\n+            const CBlockIndex* block_to_test = locator_block;\n+            if (!active_chain.Contains(block_to_test)) {\n+                // if the bestblock is not part of the mainchain, find the fork\n+                // and make sure we have all data down to the fork\n+                block_to_test = active_chain.FindFork(block_to_test);\n+            }\n+            const CBlockIndex* block = active_chain.Tip();\n+            prune_violation = true;\n+            // check backwards from the tip if we have all block data until we reach the indexes bestblock\n+            while (block_to_test && block && (block->nStatus & BLOCK_HAVE_DATA)) {\n+                if (block_to_test == block) {\n+                    prune_violation = false;\n+                    break;\n+                }\n+                // block->pprev must exist at this point, since block_to_test is part of the chain\n+                // and thus must be encountered when going backwards from the tip\n+                assert(block->pprev);\n+                block = block->pprev;\n+            }\n+        }\n+        return !prune_violation;\n+    }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override\n+    {\n+        std::unique_ptr<NotificationsHandlerImpl> handler;\n+        std::optional<interfaces::BlockInfo> block_info;\n+        // std::promise to wait for the first blockConnected notification, so\n+        // caller is notified about the starting block before this returns.\n+        // It might be good in the future to return without waiting for this,\n+        // and allow more initialization code to run in parallel.\n+        std::promise<void> promise;\n+        {\n+        // Lock cs_main while finding forks and determining which blocks to\n+        // rescan. Release cs_main while processing blocks and while calling\n+        // RegisterSharedValidationInterface in the notifications thread.\n+        //\n+        // To prevent older, stale notifications currently in the validation\n+        // queue from being received, it is important to not to register for\n+        // notifications immediately, but to delay registration with\n+        // CallFunctionInValidationInterfaceQueue, registering the notification\n+        // proxy inside the queue, so older notifications in the queue before it\n+        // get processed before the proxy is registered.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be added to the queue after the queue entry which connects the proxy.\n+        AssertLockNotHeld(::cs_main);\n+        LOCK(cs_main);\n+        const CChainState& active = Assert(m_node.chainman)->ActiveChainstate();\n+        const CBlockIndex* locator_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 222,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "fd6568f6888bc86985ce626731cd0f9db35889b8",
      "in_reply_to_id": 874092009,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r874801114\r\n\r\n> Great, thanks! I missed that `NextSyncBlock()` goes back to the fork point already in master during sync. If it's that easy to fix, I might open a PR vs master. Here, this can be resolved.\r\n\r\nYes, this is a good catch and test on your branch looks good, but the fix could be simpler and more generic.\r\n\r\nJust to close the thread, the issue described here is pre-existing, and basically orthogonal to this PR even if it conflicts a little. The issue just happens if there is a reorg away from the last block that was indexed while the index is shut down.",
      "created_at": "2022-05-18T01:29:11Z",
      "updated_at": "2022-05-18T01:38:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r875392405",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/875392405"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 828,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902995335",
      "pull_request_review_id": 1014141911,
      "id": 902995335,
      "node_id": "PRRC_kwDOABII58410p2H",
      "diff_hunk": "@@ -264,6 +265,9 @@ class Chain\n         virtual void chainStateFlushed(const CBlockLocator& locator) {}\n     };\n \n+    //! Check if all blocks needed to sync from locator are present.",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 12,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "bc39508eb83b33e620a81ca89ed3bade90344840",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "bc39508eb83b33e620a81ca89ed3bade90344840 (\"Remove index prune_violation code\"):\r\nI'm not sure if it's helpful to talk about a locator (which is more of a list of blocks) and call it `locator_block` here, since checkBlocks just accepts a single BlockIndex - it may currently be derived from a locator, but that info isn't really required here - if we stopped using locators and just saved single block hashes, `checkBlocks` wouldn't be affected at all.",
      "created_at": "2022-06-21T19:33:43Z",
      "updated_at": "2022-06-23T02:21:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r902995335",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902995335"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/904452837",
      "pull_request_review_id": 1014141911,
      "id": 904452837,
      "node_id": "PRRC_kwDOABII58416Nrl",
      "diff_hunk": "@@ -754,6 +779,53 @@ class ChainImpl : public Chain\n         notifications->blockConnected(block_info);\n         if (!block_info.chain_tip && !checkBlocks(locator_block)) return nullptr;\n         auto handler = std::make_unique<NotificationsHandlerImpl>(notifications);\n+        assert(!handler->m_thread_sync.joinable());\n+        if (!block_info.chain_tip) handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name, [&active, locator_block, notifications, handler = handler.get()] {",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1091e79d7bb57da3b96814fe26101e0bf75e1108",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "1091e79d7bb57da3b96814fe26101e0bf75e1108 (Move sync thread from index to node)\r\n\r\nI think it would be good to abort early and not start the sync process if `CustomInit` of the initial `blockConnected` call failed (because the index might be corrupted). This is the behavior on master, and otherwise the syncing logic could commit some work like syncing another block, and while we'd still terminate with an InitError because `m_init_result=false` after that, this error might no longer occur at the next startup - the index might now be silently corrupted.",
      "created_at": "2022-06-23T02:03:13Z",
      "updated_at": "2022-06-23T02:30:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r904452837",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/904452837"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 783,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905206741",
      "pull_request_review_id": 1017279086,
      "id": 905206741,
      "node_id": "PRRC_kwDOABII58419FvV",
      "diff_hunk": "@@ -754,6 +779,53 @@ class ChainImpl : public Chain\n         notifications->blockConnected(block_info);\n         if (!block_info.chain_tip && !checkBlocks(locator_block)) return nullptr;\n         auto handler = std::make_unique<NotificationsHandlerImpl>(notifications);\n+        assert(!handler->m_thread_sync.joinable());\n+        if (!block_info.chain_tip) handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name, [&active, locator_block, notifications, handler = handler.get()] {",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1091e79d7bb57da3b96814fe26101e0bf75e1108",
      "in_reply_to_id": 904452837,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r904452837\r\n\r\n> I think it would be good to abort early and not start the sync process if `CustomInit` of the initial `blockConnected` call failed (because the index might be corrupted).\r\n\r\nGood point. I think I'm missing a `if (!*m_init_result) return m_index.Interrupt();` line after initializing `m_init_result` in `blockConnected()`",
      "created_at": "2022-06-23T15:59:39Z",
      "updated_at": "2022-06-23T16:02:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r905206741",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905206741"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 783,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908873600",
      "pull_request_review_id": 1022302955,
      "id": 908873600,
      "node_id": "PRRC_kwDOABII5842LE-A",
      "diff_hunk": "@@ -754,6 +779,53 @@ class ChainImpl : public Chain\n         notifications->blockConnected(block_info);\n         if (!block_info.chain_tip && !checkBlocks(locator_block)) return nullptr;\n         auto handler = std::make_unique<NotificationsHandlerImpl>(notifications);\n+        assert(!handler->m_thread_sync.joinable());\n+        if (!block_info.chain_tip) handler->m_thread_sync = std::thread(&util::TraceThread, options.thread_name, [&active, locator_block, notifications, handler = handler.get()] {",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1091e79d7bb57da3b96814fe26101e0bf75e1108",
      "in_reply_to_id": 904452837,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r905206741\r\n\r\nAdded `m_index.Interrupt()` call on failure",
      "created_at": "2022-06-28T19:37:51Z",
      "updated_at": "2022-06-28T20:04:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r908873600",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908873600"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 783,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908874686",
      "pull_request_review_id": 1022302955,
      "id": 908874686,
      "node_id": "PRRC_kwDOABII5842LFO-",
      "diff_hunk": "@@ -264,6 +265,9 @@ class Chain\n         virtual void chainStateFlushed(const CBlockLocator& locator) {}\n     };\n \n+    //! Check if all blocks needed to sync from locator are present.",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 12,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "bc39508eb83b33e620a81ca89ed3bade90344840",
      "in_reply_to_id": 902995335,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r902995335\r\n\r\nRenamed from locator_block to start_block",
      "created_at": "2022-06-28T19:39:21Z",
      "updated_at": "2022-06-28T20:04:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r908874686",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908874686"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929172598",
      "pull_request_review_id": 1049878909,
      "id": 929172598,
      "node_id": "PRRC_kwDOABII5843Ygx2",
      "diff_hunk": "@@ -717,6 +717,39 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    bool checkBlocks(const CBlockIndex* start_block) override {",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "a035b6500f427cb535058c6718ff41edd961fdc3",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/a035b6500f427cb535058c6718ff41edd961fdc3\r\n\r\n`checkBlocks` is pretty vague; maybe `hasDataFromTipDown()`?",
      "created_at": "2022-07-25T18:21:15Z",
      "updated_at": "2022-07-26T20:33:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r929172598",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929172598"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 720,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929193830",
      "pull_request_review_id": 1049878909,
      "id": 929193830,
      "node_id": "PRRC_kwDOABII5843Yl9m",
      "diff_hunk": "@@ -163,6 +167,7 @@ void BaseIndex::ThreadSync()\n \n             CBlock block;\n             interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex);\n+            block_info.chain_tip = false;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 75,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "de311f9f9ecb64dc83c070e3824c086b918cb09a",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/de311f9f9ecb64dc83c070e3824c086b918cb09a\r\n\r\nI don't understand what this change does - it isn't obvious to me from the surrounding code that `pindex` isn't the tip.",
      "created_at": "2022-07-25T18:48:42Z",
      "updated_at": "2022-07-26T20:33:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r929193830",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929193830"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 170,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929243005",
      "pull_request_review_id": 1049878909,
      "id": 929243005,
      "node_id": "PRRC_kwDOABII5843Yx99",
      "diff_hunk": "@@ -756,6 +756,9 @@ class ChainImpl : public Chain\n         const CBlockIndex* start_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);\n         interfaces::BlockInfo block_info = kernel::MakeBlockInfo(start_block);\n         block_info.chain_tip = start_block == active.m_chain.Tip();\n+        // Need to register the ValidationInterface and call blockConnected\n+        // both while holding cs_main, so that callbacks are not missed if\n+        // blockConnected sets m_synced to true.",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "43e03ec21fc2da2bd76912e3aa6981899030c8c2",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/43e03ec21fc2da2bd76912e3aa6981899030c8c2\r\n\r\nIs this comment related to the changes in this commit? It seems like this corresponds to the previous commit.",
      "created_at": "2022-07-25T19:51:27Z",
      "updated_at": "2022-07-26T20:33:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r929243005",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929243005"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 761,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930258487",
      "pull_request_review_id": 1049878909,
      "id": 930258487,
      "node_id": "PRRC_kwDOABII5843cp43",
      "diff_hunk": "@@ -69,6 +71,37 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n             m_index.m_synced = true;\n         }\n     }\n+\n+    if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n+\n+    const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+        FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n+                   __func__, m_index.GetName());\n+        return;\n+    }\n+\n+    if (!m_index.CustomAppend(block)) {",
      "path": "src/index/base.cpp",
      "position": 126,
      "original_position": 23,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "43e03ec21fc2da2bd76912e3aa6981899030c8c2",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/43e03ec21fc2da2bd76912e3aa6981899030c8c2\r\n\r\nFWIW, inverting the conditional here makes it harder to verify the diff because now this block of logic isn't move-only.",
      "created_at": "2022-07-26T17:52:00Z",
      "updated_at": "2022-07-26T20:33:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r930258487",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930258487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 140,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930306784",
      "pull_request_review_id": 1049878909,
      "id": 930306784,
      "node_id": "PRRC_kwDOABII5843c1rg",
      "diff_hunk": "@@ -251,8 +252,28 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     assert(current_tip == m_best_block_index);\n     assert(current_tip->GetAncestor(new_tip->nHeight) == new_tip);\n \n-    if (!CustomRewind({current_tip->GetBlockHash(), current_tip->nHeight}, {new_tip->GetBlockHash(), new_tip->nHeight})) {\n-        return false;\n+    const Consensus::Params& consensus_params = Params().GetConsensus();\n+    CBlock block;\n+    CBlockUndo block_undo;\n+\n+    for (const CBlockIndex* iter_tip = current_tip; iter_tip != new_tip; iter_tip = iter_tip->pprev) {\n+        interfaces::BlockInfo block_info = node::MakeBlockInfo(iter_tip);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "00b2300f919060a89bca74f0a908602a6a716f6d",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/00b2300f919060a89bca74f0a908602a6a716f6d\r\n\r\nThis commit fails to compile because `MakeBlockInfo()` is in the `kernel` namespace. I guess this code is moved later on, which resolves the compilation failure.",
      "created_at": "2022-07-26T18:47:19Z",
      "updated_at": "2022-07-26T20:33:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r930306784",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930306784"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 260,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930311965",
      "pull_request_review_id": 1049878909,
      "id": 930311965,
      "node_id": "PRRC_kwDOABII5843c28d",
      "diff_hunk": "@@ -158,6 +174,7 @@ void BaseIndex::ThreadSync()\n     const CBlockIndex* pindex = m_best_block_index.load();\n     if (!m_synced) {\n         auto& consensus_params = Params().GetConsensus();\n+        auto notifications = WITH_LOCK(m_mutex, return m_notifications);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "5605e4e1310d244892447755c1194195c2e866da",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/5605e4e1310d244892447755c1194195c2e866da#\r\n\r\nJust making sure this should actually be a copy and not a reference.",
      "created_at": "2022-07-26T18:54:02Z",
      "updated_at": "2022-07-26T20:33:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r930311965",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930311965"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 177,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930369320",
      "pull_request_review_id": 1049878909,
      "id": 930369320,
      "node_id": "PRRC_kwDOABII5843dE8o",
      "diff_hunk": "@@ -134,6 +148,25 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n \n void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block)\n {\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_synced && block.chain_tip) return;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ac1369650de26f325076340017745c67bdb34900",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/ac1369650de26f325076340017745c67bdb34900\r\n\r\nIs this new behavior or inherited?",
      "created_at": "2022-07-26T20:10:24Z",
      "updated_at": "2022-07-26T20:33:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r930369320",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930369320"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 153,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936973455",
      "pull_request_review_id": 1060774316,
      "id": 936973455,
      "node_id": "PRRC_kwDOABII58432RSP",
      "diff_hunk": "@@ -717,6 +717,39 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    bool checkBlocks(const CBlockIndex* start_block) override {",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "a035b6500f427cb535058c6718ff41edd961fdc3",
      "in_reply_to_id": 929172598,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r929172598\r\n\r\n> `checkBlocks` is pretty vague; maybe `hasDataFromTipDown()`?\r\n\r\nThanks, renamed",
      "created_at": "2022-08-03T17:47:22Z",
      "updated_at": "2022-08-04T20:11:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r936973455",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936973455"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 720,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936974376",
      "pull_request_review_id": 1060774316,
      "id": 936974376,
      "node_id": "PRRC_kwDOABII58432Rgo",
      "diff_hunk": "@@ -163,6 +167,7 @@ void BaseIndex::ThreadSync()\n \n             CBlock block;\n             interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex);\n+            block_info.chain_tip = false;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 75,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "de311f9f9ecb64dc83c070e3824c086b918cb09a",
      "in_reply_to_id": 929193830,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r929193830\r\n\r\n> I don't understand what this change does - it isn't obvious to me from the surrounding code that `pindex` isn't the tip.\r\n\r\nThanks, removed this. Nothing is actually looking at this variable so it doesn't do anything. This code is just reading old blocks which are mostly not from the tip of the chain, so this was setting the variable to avoid seeming like they were.",
      "created_at": "2022-08-03T17:48:36Z",
      "updated_at": "2022-08-04T20:11:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r936974376",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936974376"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 170,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937025233",
      "pull_request_review_id": 1060774316,
      "id": 937025233,
      "node_id": "PRRC_kwDOABII58432d7R",
      "diff_hunk": "@@ -251,8 +252,28 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     assert(current_tip == m_best_block_index);\n     assert(current_tip->GetAncestor(new_tip->nHeight) == new_tip);\n \n-    if (!CustomRewind({current_tip->GetBlockHash(), current_tip->nHeight}, {new_tip->GetBlockHash(), new_tip->nHeight})) {\n-        return false;\n+    const Consensus::Params& consensus_params = Params().GetConsensus();\n+    CBlock block;\n+    CBlockUndo block_undo;\n+\n+    for (const CBlockIndex* iter_tip = current_tip; iter_tip != new_tip; iter_tip = iter_tip->pprev) {\n+        interfaces::BlockInfo block_info = node::MakeBlockInfo(iter_tip);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "00b2300f919060a89bca74f0a908602a6a716f6d",
      "in_reply_to_id": 930306784,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r930306784\r\n\r\n> This commit fails to compile because `MakeBlockInfo()` is in the `kernel` namespace. I guess this code is moved later on, which resolves the compilation failure.\r\n\r\nThanks! Updated to fix",
      "created_at": "2022-08-03T18:50:56Z",
      "updated_at": "2022-08-04T20:11:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r937025233",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937025233"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 260,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937037678",
      "pull_request_review_id": 1060774316,
      "id": 937037678,
      "node_id": "PRRC_kwDOABII58432g9u",
      "diff_hunk": "@@ -158,6 +174,7 @@ void BaseIndex::ThreadSync()\n     const CBlockIndex* pindex = m_best_block_index.load();\n     if (!m_synced) {\n         auto& consensus_params = Params().GetConsensus();\n+        auto notifications = WITH_LOCK(m_mutex, return m_notifications);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "5605e4e1310d244892447755c1194195c2e866da",
      "in_reply_to_id": 930311965,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r930311965\r\n\r\n> Just making sure this should actually be a copy and not a reference.\r\n\r\nYes a reference to the shared_ptr wouldn't work here because the shared_ptr could be reset at any time from another thread. A copy of the pointer is actually needed",
      "created_at": "2022-08-03T19:06:21Z",
      "updated_at": "2022-08-04T20:11:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r937037678",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937037678"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 177,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937044459",
      "pull_request_review_id": 1060774316,
      "id": 937044459,
      "node_id": "PRRC_kwDOABII58432inr",
      "diff_hunk": "@@ -756,6 +756,9 @@ class ChainImpl : public Chain\n         const CBlockIndex* start_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);\n         interfaces::BlockInfo block_info = kernel::MakeBlockInfo(start_block);\n         block_info.chain_tip = start_block == active.m_chain.Tip();\n+        // Need to register the ValidationInterface and call blockConnected\n+        // both while holding cs_main, so that callbacks are not missed if\n+        // blockConnected sets m_synced to true.",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "43e03ec21fc2da2bd76912e3aa6981899030c8c2",
      "in_reply_to_id": 929243005,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r929243005\r\n\r\n> Is this comment related to the changes in this commit? It seems like this corresponds to the previous commit.\r\n\r\nThanks, just dropped this. I was looking for someplace to move [this comment](https://github.com/bitcoin/bitcoin/commit/43e03ec21fc2da2bd76912e3aa6981899030c8c2#diff-5251d93616c116c364d2d502ad2a59e901a3512194462fabacc9756f96fd8dddL351-L352) so I moved it here, but it doesn't really work here and is better to prune",
      "created_at": "2022-08-03T19:15:31Z",
      "updated_at": "2022-08-04T20:11:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r937044459",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937044459"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 761,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937044955",
      "pull_request_review_id": 1060774316,
      "id": 937044955,
      "node_id": "PRRC_kwDOABII58432ivb",
      "diff_hunk": "@@ -69,6 +71,37 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n             m_index.m_synced = true;\n         }\n     }\n+\n+    if (!block.data || m_index.IgnoreBlockConnected(block)) return;\n+\n+    const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n+    if (block.chain_tip && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {\n+        FatalError(\"%s: Failed to rewind index %s to a previous chain tip\",\n+                   __func__, m_index.GetName());\n+        return;\n+    }\n+\n+    if (!m_index.CustomAppend(block)) {",
      "path": "src/index/base.cpp",
      "position": 126,
      "original_position": 23,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "43e03ec21fc2da2bd76912e3aa6981899030c8c2",
      "in_reply_to_id": 930258487,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r930258487\r\n\r\n> FWIW, inverting the conditional here makes it harder to verify the diff because now this block of logic isn't move-only.\r\n\r\nGood catch, now avoided this",
      "created_at": "2022-08-03T19:16:05Z",
      "updated_at": "2022-08-04T20:11:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r937044955",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937044955"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 140,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937045771",
      "pull_request_review_id": 1060774316,
      "id": 937045771,
      "node_id": "PRRC_kwDOABII58432i8L",
      "diff_hunk": "@@ -134,6 +148,25 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n \n void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block)\n {\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_synced && block.chain_tip) return;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ac1369650de26f325076340017745c67bdb34900",
      "in_reply_to_id": 930369320,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r930369320\r\n\r\n> Is this new behavior or inherited?\r\n\r\nIt's all inherited behavior. The indexes ignored \"blockDisconnected\" notifications entirely before, so the \"During initial sync, ignore validation interface notifications\" part of this comment happened implicitly. The \"process notifications from sync thread\" part of this comment is referring to new blockDisconnected code below, but that code is just moving from the ThreadSync to here (so ThreadSync can move out of the src/index/ to src/node/ later)",
      "created_at": "2022-08-03T19:17:03Z",
      "updated_at": "2022-08-04T20:11:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r937045771",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937045771"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 153,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033933984",
      "pull_request_review_id": 1196377214,
      "id": 1033933984,
      "node_id": "PRRC_kwDOABII5849oJSg",
      "diff_hunk": "@@ -271,14 +272,24 @@ class Chain\n         virtual ~Notifications() {}\n         virtual void transactionAddedToMempool(const CTransactionRef& tx, uint64_t mempool_sequence) {}\n         virtual void transactionRemovedFromMempool(const CTransactionRef& tx, MemPoolRemovalReason reason, uint64_t mempool_sequence) {}\n+        //! Notification sent when new blocks are connected, and also called on\n+        //! startup from attachChain() with the last connected block. The\n+        //! block.data pointer is null for the last connected block and non-null\n+        //! for newly connected blocks after that.\n         virtual void blockConnected(const BlockInfo& block) {}\n         virtual void blockDisconnected(const BlockInfo& block) {}\n         virtual void updatedBlockTip() {}\n         virtual void chainStateFlushed(const CBlockLocator& locator) {}\n     };\n \n-    //! Check if all blocks needed to sync start block to current tip are present.\n-    virtual bool hasDataFromTipDown(const CBlockIndex* start_block) = 0;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 32,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2f71f52b9b37b94a03aa203d16eecdca467361ac",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/2f71f52b9b37b94a03aa203d16eecdca467361ac\r\n\r\nNot a big deal, but curious why this was removed since it was introduced in the previous commit.",
      "created_at": "2022-11-28T18:53:20Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1033933984",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033933984"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 281,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033943433",
      "pull_request_review_id": 1196377214,
      "id": 1033943433,
      "node_id": "PRRC_kwDOABII5849oLmJ",
      "diff_hunk": "@@ -759,6 +758,18 @@ class ChainImpl : public Chain\n         }\n         return !prune_violation;\n     }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override\n+    {\n+        LOCK(cs_main);\n+        const Chainstate& active = Assert(m_node.chainman)->ActiveChainstate();\n+        const CBlockIndex* start_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);\n+        interfaces::BlockInfo block_info = kernel::MakeBlockInfo(start_block);\n+        block_info.chain_tip = start_block == active.m_chain.Tip();\n+        notifications->blockConnected(block_info);\n+        if (!block_info.chain_tip && !hasDataFromTipDown(start_block)) return nullptr;",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2f71f52b9b37b94a03aa203d16eecdca467361ac",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/2f71f52b9b37b94a03aa203d16eecdca467361ac\r\n\r\nWouldn't we want to do this check/return before we issue a `blockConnected()` event, or does it not matter because we know that we at least have data for the current tip?",
      "created_at": "2022-11-28T19:03:37Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1033943433",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033943433"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 769,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033955263",
      "pull_request_review_id": 1196377214,
      "id": 1033955263,
      "node_id": "PRRC_kwDOABII5849oOe_",
      "diff_hunk": "@@ -759,6 +758,18 @@ class ChainImpl : public Chain\n         }\n         return !prune_violation;\n     }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2f71f52b9b37b94a03aa203d16eecdca467361ac",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/2f71f52b9b37b94a03aa203d16eecdca467361ac\r\n\r\nThe contents of this function are pretty specific to indexes (e.g. we have logic in here that refuses to set up the notifications handler if there isn't data beneath the given tip) and I think the name `attachChain` a little bit generic, so might consider renaming this `attachIndexer()` or something more descriptive.",
      "created_at": "2022-11-28T19:15:40Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1033955263",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033955263"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 820,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034011918",
      "pull_request_review_id": 1196377214,
      "id": 1034011918,
      "node_id": "PRRC_kwDOABII5849ocUO",
      "diff_hunk": "@@ -58,6 +58,7 @@ class BaseIndexNotifications : public interfaces::Chain::Notifications\n     void chainStateFlushed(const CBlockLocator& locator) override;\n \n     BaseIndex& m_index;\n+    interfaces::Chain::NotifyOptions m_options = m_index.CustomOptions();",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "a6d1c22dc1254cbfedda7add573f0d537aefd36c",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/a6d1c22dc1254cbfedda7add573f0d537aefd36c\r\n\r\nMaybe I'm just dense today, but I don't recognize this cpp pattern. Is this some kind of initialization shorthand that's executed once on construction, when we get a valid reference for `m_index`?",
      "created_at": "2022-11-28T20:21:29Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034011918",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034011918"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 61,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034775306",
      "pull_request_review_id": 1196377214,
      "id": 1034775306,
      "node_id": "PRRC_kwDOABII5849rWsK",
      "diff_hunk": "@@ -94,16 +96,21 @@ class BaseIndex : public CValidationInterface\n \n     virtual bool AllowPrune() const = 0;\n \n+    Mutex m_mutex;",
      "path": "src/index/base.h",
      "position": null,
      "original_position": 34,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ecedecac38f231d855e3f663671301d6e1ea7f6b",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/ecedecac38f231d855e3f663671301d6e1ea7f6b\r\n\r\nIt would be nice to document what this mutex is for and why it's needed. I gather from below that it's guarding m_notifications and m_handler, but it's not clear to me why that's necessary - my guess is that because the guarded state is accessed by both the sync thread and validationinterface callbacks via `Chain`. ",
      "created_at": "2022-11-29T13:48:07Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034775306",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034775306"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 99,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034827606",
      "pull_request_review_id": 1196377214,
      "id": 1034827606,
      "node_id": "PRRC_kwDOABII5849rjdW",
      "diff_hunk": "@@ -84,16 +85,31 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         return;\n     }\n \n-    if (m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n+        FatalError(\"%s: Failed to write block %s to index\",\n+                   __func__, pindex->GetBlockHash().ToString());\n+        return m_index.Interrupt();\n+    }\n+    // Only update m_best_block_index between flushes if synced. Unclear why\n+    // best block is not updated here before sync, but this has been\n+    // longstanding behavior since syncing was introduced in #13033 so care\n+    // should be taken if changing m_best_block_index semantics.",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 31,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "a6d1c22dc1254cbfedda7add573f0d537aefd36c",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/a6d1c22dc1254cbfedda7add573f0d537aefd36c\r\n\r\nTo add some color here, reviewers can verify that in the pre-PR code \r\n- BlockConnected events are ignored while not `m_synced`, and\r\n- ThreadSync() calls Commit() which confusingly updates the best block in the index db (GetDB().WriteBestBlock(...)) but doesn't change m_best_block_index.",
      "created_at": "2022-11-29T14:29:15Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034827606",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034827606"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 106,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034937153",
      "pull_request_review_id": 1196377214,
      "id": 1034937153,
      "node_id": "PRRC_kwDOABII5849r-NB",
      "diff_hunk": "@@ -136,6 +150,23 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n \n void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block)\n {\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_synced && block.chain_tip) return;\n+\n+    const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_index.m_chainstate->m_blockman.LookupBlockIndex(block.hash));\n+    if (!m_rewind_start) m_rewind_start = pindex;\n+    if (m_rewind_error) return;\n+\n+    CBlockUndo block_undo;\n+    interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex, block.data);\n+    if (m_options.disconnect_undo_data && block.height > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            m_rewind_error = true;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "15f83492713abefea3f6ffc7e4c100a6177cc462",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/15f83492713abefea3f6ffc7e4c100a6177cc462\r\n\r\nWould it be worth `FatalError()`/`return` from here? I think that is needed to maintain strict behavioral compatibility with the way that ThreadSync() currently behaves, since [`!Rewind()` can be tripped](https://github.com/bitcoin/bitcoin/pull/24230/commits/15f83492713abefea3f6ffc7e4c100a6177cc462#diff-5251d93616c116c364d2d502ad2a59e901a3512194462fabacc9756f96fd8dddL221) for either a failure to retrieve block data OR failure to retrieve undo data.",
      "created_at": "2022-11-29T15:52:14Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034937153",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034937153"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 165,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034952930",
      "pull_request_review_id": 1196377214,
      "id": 1034952930,
      "node_id": "PRRC_kwDOABII5849sCDi",
      "diff_hunk": "@@ -80,6 +85,15 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         m_index.SetBestBlockIndex(pindex);\n         if (block.chain_tip) {\n             m_index.m_synced = true;\n+            if (pindex) {\n+                LogPrintf(\"%s is enabled at height %d\\n\", m_index.GetName(), pindex->nHeight);\n+            } else {\n+                LogPrintf(\"%s is enabled\\n\", m_index.GetName());\n+            }",
      "path": "src/index/base.cpp",
      "position": 87,
      "original_position": 27,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ed79c47c1385dc2e1b25d3958fa83a231770353d",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/ed79c47c1385dc2e1b25d3958fa83a231770353d\r\n\r\nShould the equivalent old code in ThreadSync() be removed here in this commit as well?",
      "created_at": "2022-11-29T16:04:34Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034952930",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034952930"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 101,
      "original_line": 101,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034972038",
      "pull_request_review_id": 1196377214,
      "id": 1034972038,
      "node_id": "PRRC_kwDOABII5849sGuG",
      "diff_hunk": "@@ -266,13 +284,13 @@ void BaseIndex::ThreadSync()\n                         interfaces::BlockInfo block_info = kernel::MakeBlockInfo(iter_tip);\n                         block_info.chain_tip = false;\n                         if (!ReadBlockFromDisk(block, iter_tip, consensus_params)) {\n-                            FatalError(\"%s: Failed to read block %s from disk\",\n+                            block_info.error = strprintf(\"%s: Failed to read block %s from disk\",",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ed79c47c1385dc2e1b25d3958fa83a231770353d",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/ed79c47c1385dc2e1b25d3958fa83a231770353d\r\n\r\nMay be worth a comment that `blockDisconnected` will interrupt below in this case, triggering the related return?",
      "created_at": "2022-11-29T16:20:21Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034972038",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034972038"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034973794",
      "pull_request_review_id": 1196377214,
      "id": 1034973794,
      "node_id": "PRRC_kwDOABII5849sHJi",
      "diff_hunk": "@@ -89,6 +89,7 @@ struct BlockInfo {\n     const CBlockUndo* undo_data = nullptr;\n     //! Block is from the tip of the chain (always true except when first calling attachChain and reading old blocks).\n     bool chain_tip = true;\n+    std::string error;",
      "path": "src/interfaces/chain.h",
      "position": 15,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ed79c47c1385dc2e1b25d3958fa83a231770353d",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/24230/commits/ed79c47c1385dc2e1b25d3958fa83a231770353d#diff-8e9fef4d0718d085f31da382899d97e3bbefc8d6a72ede95916a0e2fbd1a532fR92\r\n\r\nIt might help to add some documentation for how this is used and under what conditions it is set.",
      "created_at": "2022-11-29T16:21:53Z",
      "updated_at": "2022-11-29T18:43:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034973794",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1034973794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 99,
      "original_line": 99,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083267771",
      "pull_request_review_id": 1264607249,
      "id": 1083267771,
      "node_id": "PRRC_kwDOABII585AkVq7",
      "diff_hunk": "@@ -146,6 +135,7 @@ bool CoinStatsIndex::CustomAppend(const interfaces::BlockInfo& block)\n \n         // Add the new utxos created from the block\n         assert(block.data);\n+        assert(block.undo_data);\n         for (size_t i = 0; i < block.data->vtx.size(); ++i) {\n             const auto& tx{block.data->vtx.at(i)};\n ",
      "path": "src/index/coinstatsindex.cpp",
      "position": 27,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "137bbe1478833ccc63f39f794816d35de14025b8",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```\r\nindex/coinstatsindex.cpp:143:37: error: use of undeclared identifier 'pindex'",
      "created_at": "2023-01-21T09:28:50Z",
      "updated_at": "2023-01-21T09:28:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1083267771",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083267771"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 144,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1188776917",
      "pull_request_review_id": 1418909211,
      "id": 1188776917,
      "node_id": "PRRC_kwDOABII585G20vV",
      "diff_hunk": "@@ -725,6 +725,39 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    bool hasDataFromTipDown(const CBlockIndex* start_block) override {\n+        LOCK(::cs_main);\n+        const CChain& active_chain = Assert(m_node.chainman)->ActiveChain();",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d7eef9f49a827e96337febcf20a22b392dc7b51e",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit in d7eef9f49a827e96337febcf20a22b392dc7b51e: Can use `chaiman()`?",
      "created_at": "2023-05-09T15:24:13Z",
      "updated_at": "2023-05-09T15:24:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1188776917",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1188776917"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 730,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282008318",
      "pull_request_review_id": 1559173712,
      "id": 1282008318,
      "node_id": "PRRC_kwDOABII585MaeT-",
      "diff_hunk": "@@ -269,6 +295,38 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n         // m_synced. Consider the case where there is a reorg and the blocks on the stale branch are\n         // in the ValidationInterface queue backlog even after the sync thread has caught up to the\n         // new chain tip. In this unlikely event, log a warning and let the queue clear.\n+        //\n+        // To allow handling reorgs, this only checks that the new block\n+        // connects to ancestor of the current best block, instead of checking\n+        // that it connects to directly to the current block. If there is a\n+        // reorg, Rewind call below will remove existing blocks from the index\n+        // before adding the new one.\n+        //\n+        // The other case where the new block will connect to an ancestor of the\n+        // current block rather than the current block is when the m_synced flag\n+        // is set to true too early. For example if the index is synced to\n+        // height 100, and -reindex-chainstate option is used, there may be\n+        // BlockConnected notifications for blocks 97, 98, 99, and 100 sitting\n+        // in the notifications queue when m_synced gets set to true. When this",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c0d1110d2a066f8e97ae33e769e761a10f0f0620",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In c0d1110d:\r\n\r\nGuess that you wrote this because you saw it in a unit test?\r\n\r\nI'm not seeing how this could be possible during the regular node initialization process. We aren't signaling any block prior to initializing the indexes.",
      "created_at": "2023-08-02T14:41:10Z",
      "updated_at": "2023-08-02T14:45:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282008318",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282008318"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 305,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282048353",
      "pull_request_review_id": 1559236426,
      "id": 1282048353,
      "node_id": "PRRC_kwDOABII585MaoFh",
      "diff_hunk": "@@ -140,7 +140,21 @@ bool BaseIndex::Init()\n     // Note: this will latch to true immediately if the user starts up with an empty\n     // datadir and an index enabled. If this is the case, indexation will happen solely\n     // via `BlockConnected` signals until, possibly, the next restart.\n-    m_synced = start_block == active_chain.Tip();\n+    if (start_block == active_chain.Tip()) {\n+        // To prevent race conditions, m_synced = true needs to be set from the\n+        // validationinterface thread and the m_synced = true callback needs to\n+        // be queued while cs_main is held.\n+        //\n+        // To prevent older, stale notifications currently in the validation\n+        // queue from being processed, it is important setting m_synced = true\n+        // in queue after they processed.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be queued after the m_synced = true callback.\n+        CallFunctionInValidationInterfaceQueue([this] { m_synced = true; });\n+    }",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ba30b60bcfb8ab5660064acd27ecde40bd3045a3",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In ba30b60b:\r\n\r\nIsn't this conflicting with the `StartBackgroundSync()` call?\r\n\r\nLet's say that there are new blocks on the notifications queue at this point. By not setting the `m_synced` flag, we allow `ThreadSync()` to start.\r\nThis former one might have some work to do if some of the queued blocks notifications were processed in-between `Init()` and `StartBackgroundSync()`. Then, while this is being done, the validation queue thread might end up setting `m_synced=true`. Which would enable the index new block connection signals reception at the same time that `ThreadSync()` is being executed.",
      "created_at": "2023-08-02T15:10:15Z",
      "updated_at": "2023-08-02T15:10:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282048353",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282048353"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 143,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 157,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282083953",
      "pull_request_review_id": 1559291719,
      "id": 1282083953,
      "node_id": "PRRC_kwDOABII585Mawxx",
      "diff_hunk": "@@ -269,6 +295,38 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n         // m_synced. Consider the case where there is a reorg and the blocks on the stale branch are\n         // in the ValidationInterface queue backlog even after the sync thread has caught up to the\n         // new chain tip. In this unlikely event, log a warning and let the queue clear.\n+        //\n+        // To allow handling reorgs, this only checks that the new block\n+        // connects to ancestor of the current best block, instead of checking\n+        // that it connects to directly to the current block. If there is a\n+        // reorg, Rewind call below will remove existing blocks from the index\n+        // before adding the new one.\n+        //\n+        // The other case where the new block will connect to an ancestor of the\n+        // current block rather than the current block is when the m_synced flag\n+        // is set to true too early. For example if the index is synced to\n+        // height 100, and -reindex-chainstate option is used, there may be\n+        // BlockConnected notifications for blocks 97, 98, 99, and 100 sitting\n+        // in the notifications queue when m_synced gets set to true. When this",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c0d1110d2a066f8e97ae33e769e761a10f0f0620",
      "in_reply_to_id": 1282008318,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282008318\r\n\r\n> Guess that you wrote this because you saw it in a unit test?\r\n\r\nNo, it I believe it happens pretty reliably when you use `-reindex-chainstate`. I saw it reliably when I ran the `test/functional/feature_coinstatsindex.py` \"[Test that the index works with -reindex-chainstate](https://github.com/bitcoin/bitcoin/blob/2fa60f0b683cefd7956273986dafe3bde00c98fd/test/functional/feature_coinstatsindex.py#L238-L240)\" test and had a bug in the code that disabled this check. It caused the index to be corrupted because the same blocks would be added to the index twice.",
      "created_at": "2023-08-02T15:36:23Z",
      "updated_at": "2023-08-02T16:00:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282083953",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282083953"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 305,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282110542",
      "pull_request_review_id": 1559291719,
      "id": 1282110542,
      "node_id": "PRRC_kwDOABII585Ma3RO",
      "diff_hunk": "@@ -140,7 +140,21 @@ bool BaseIndex::Init()\n     // Note: this will latch to true immediately if the user starts up with an empty\n     // datadir and an index enabled. If this is the case, indexation will happen solely\n     // via `BlockConnected` signals until, possibly, the next restart.\n-    m_synced = start_block == active_chain.Tip();\n+    if (start_block == active_chain.Tip()) {\n+        // To prevent race conditions, m_synced = true needs to be set from the\n+        // validationinterface thread and the m_synced = true callback needs to\n+        // be queued while cs_main is held.\n+        //\n+        // To prevent older, stale notifications currently in the validation\n+        // queue from being processed, it is important setting m_synced = true\n+        // in queue after they processed.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be queued after the m_synced = true callback.\n+        CallFunctionInValidationInterfaceQueue([this] { m_synced = true; });\n+    }",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ba30b60bcfb8ab5660064acd27ecde40bd3045a3",
      "in_reply_to_id": 1282048353,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282048353\r\n\r\n> Isn't this conflicting with the `StartBackgroundSync()` call?\r\n> \r\n> Let's say that there are new blocks on the notifications queue at this point. By not setting the `m_synced` flag, we allow `ThreadSync()` to start.\r\n\r\nYes, that's a good point. I forgot that the m_synced flag is not just used to process notifications, but also to determine whether to start the sync thread.\r\n\r\nIt's hard to imagine this being a problem in pracice, but I think I should tweak the logic to distinguish between \"synced\" and \"ready\" states, where \"synced\" state means index is in sync with the chainstate and \"ready\" state means index is ready to start processing blockconnected notifications.\r\n\r\nEDIT: Later commit \"Move sync thread from index to node\" 0048fd1cbc00205c191dae1a96c44d02f4a7aae0 actually already does this so there is not a race condition in the end, but I it would be good to do it earlier.",
      "created_at": "2023-08-02T15:57:23Z",
      "updated_at": "2023-08-02T16:11:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282110542",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282110542"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 143,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 157,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282405497",
      "pull_request_review_id": 1559821533,
      "id": 1282405497,
      "node_id": "PRRC_kwDOABII585Mb_R5",
      "diff_hunk": "@@ -269,6 +295,38 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n         // m_synced. Consider the case where there is a reorg and the blocks on the stale branch are\n         // in the ValidationInterface queue backlog even after the sync thread has caught up to the\n         // new chain tip. In this unlikely event, log a warning and let the queue clear.\n+        //\n+        // To allow handling reorgs, this only checks that the new block\n+        // connects to ancestor of the current best block, instead of checking\n+        // that it connects to directly to the current block. If there is a\n+        // reorg, Rewind call below will remove existing blocks from the index\n+        // before adding the new one.\n+        //\n+        // The other case where the new block will connect to an ancestor of the\n+        // current block rather than the current block is when the m_synced flag\n+        // is set to true too early. For example if the index is synced to\n+        // height 100, and -reindex-chainstate option is used, there may be\n+        // BlockConnected notifications for blocks 97, 98, 99, and 100 sitting\n+        // in the notifications queue when m_synced gets set to true. When this",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c0d1110d2a066f8e97ae33e769e761a10f0f0620",
      "in_reply_to_id": 1282008318,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ok, I think that know how that could happen. It is not related to the `Init()` call.\r\n\r\nThe background sync process reads blocks directly from the chain index (calling `NextSyncBlock()`). So, what if a block gets connected while `ThreadSync()` is being executed but the event is not dispatched on time.. (before the background sync process finishes)\r\n\r\n1) The block connection event is added to the validation queue.\r\n2) The index background sync process reads the block from the chain and processes it.\r\n3) The validation queue dispatches the block connection event added in (1) to the index. Then... boom: the index received an already processed block.",
      "created_at": "2023-08-02T20:49:42Z",
      "updated_at": "2023-08-02T20:49:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282405497",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282405497"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 305,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282421606",
      "pull_request_review_id": 1559846738,
      "id": 1282421606,
      "node_id": "PRRC_kwDOABII585McDNm",
      "diff_hunk": "@@ -269,6 +295,38 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n         // m_synced. Consider the case where there is a reorg and the blocks on the stale branch are\n         // in the ValidationInterface queue backlog even after the sync thread has caught up to the\n         // new chain tip. In this unlikely event, log a warning and let the queue clear.\n+        //\n+        // To allow handling reorgs, this only checks that the new block\n+        // connects to ancestor of the current best block, instead of checking\n+        // that it connects to directly to the current block. If there is a\n+        // reorg, Rewind call below will remove existing blocks from the index\n+        // before adding the new one.\n+        //\n+        // The other case where the new block will connect to an ancestor of the\n+        // current block rather than the current block is when the m_synced flag\n+        // is set to true too early. For example if the index is synced to\n+        // height 100, and -reindex-chainstate option is used, there may be\n+        // BlockConnected notifications for blocks 97, 98, 99, and 100 sitting\n+        // in the notifications queue when m_synced gets set to true. When this",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c0d1110d2a066f8e97ae33e769e761a10f0f0620",
      "in_reply_to_id": 1282008318,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That's accurate, but I don't think ThreadSync needs to even do anything for this to happen, and no new blocks need to be connected after ThreadSync starts.\r\n\r\nIf `-reindex-chainstate` indexing completes, and `ThreadSync` immediately starts and exits because it detects that the index best block is equal to the chain tip, and no new blocks are connected, there could still be stale block connected notifications in the queue which will cause the index to rewind and add the blocks again. The commit \r\n\"Avoid race, make -reindex-chainstate more efficient\" e5f2641137413da5970007a9b932b5993067b550 changes index startup behavior to just ignore the stale block connected notifications while `m_ready` is `false`, instead of processing them and pointlessly rewinding and reconnecting blocks.",
      "created_at": "2023-08-02T21:09:31Z",
      "updated_at": "2023-08-02T21:09:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1282421606",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1282421606"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 305,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284517464",
      "pull_request_review_id": 1563030091,
      "id": 1284517464,
      "node_id": "PRRC_kwDOABII585MkC5Y",
      "diff_hunk": "@@ -269,6 +295,38 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n         // m_synced. Consider the case where there is a reorg and the blocks on the stale branch are\n         // in the ValidationInterface queue backlog even after the sync thread has caught up to the\n         // new chain tip. In this unlikely event, log a warning and let the queue clear.\n+        //\n+        // To allow handling reorgs, this only checks that the new block\n+        // connects to ancestor of the current best block, instead of checking\n+        // that it connects to directly to the current block. If there is a\n+        // reorg, Rewind call below will remove existing blocks from the index\n+        // before adding the new one.\n+        //\n+        // The other case where the new block will connect to an ancestor of the\n+        // current block rather than the current block is when the m_synced flag\n+        // is set to true too early. For example if the index is synced to\n+        // height 100, and -reindex-chainstate option is used, there may be\n+        // BlockConnected notifications for blocks 97, 98, 99, and 100 sitting\n+        // in the notifications queue when m_synced gets set to true. When this",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c0d1110d2a066f8e97ae33e769e761a10f0f0620",
      "in_reply_to_id": 1282008318,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah ok, that is also a possibility. Great.\r\n\r\nCould the fix be decoupled into a standalone PR? Sounds like something that we could rapidly merge independently of this PR. It fixes a bug and also makes this work smaller.",
      "created_at": "2023-08-04T14:44:32Z",
      "updated_at": "2023-08-04T14:45:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1284517464",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284517464"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 305,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284581060",
      "pull_request_review_id": 1563131487,
      "id": 1284581060,
      "node_id": "PRRC_kwDOABII585MkSbE",
      "diff_hunk": "@@ -269,6 +295,38 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n         // m_synced. Consider the case where there is a reorg and the blocks on the stale branch are\n         // in the ValidationInterface queue backlog even after the sync thread has caught up to the\n         // new chain tip. In this unlikely event, log a warning and let the queue clear.\n+        //\n+        // To allow handling reorgs, this only checks that the new block\n+        // connects to ancestor of the current best block, instead of checking\n+        // that it connects to directly to the current block. If there is a\n+        // reorg, Rewind call below will remove existing blocks from the index\n+        // before adding the new one.\n+        //\n+        // The other case where the new block will connect to an ancestor of the\n+        // current block rather than the current block is when the m_synced flag\n+        // is set to true too early. For example if the index is synced to\n+        // height 100, and -reindex-chainstate option is used, there may be\n+        // BlockConnected notifications for blocks 97, 98, 99, and 100 sitting\n+        // in the notifications queue when m_synced gets set to true. When this",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c0d1110d2a066f8e97ae33e769e761a10f0f0620",
      "in_reply_to_id": 1282008318,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Yeah ok, that is also a possibility. Great.\r\n> \r\n> Could the fix be decoupled into a standalone PR? Sounds like something that we could rapidly merge independently of this PR. It fixes a bug and also makes this work smaller.\r\n\r\nYes, I am definitely looking for suggestions on how many of the first commits it would make sense to split off into a separate PR.\r\n\r\nBut just to be clear, there isn't a bug here, just suboptimal behavior. If -reindex-chainstate is used and there are still block-connected notifications waiting in the queue when the index is started, it doesn't cause any index corruption. It just causes the last few blocks in the index to be rewound, and then appended again, as if there were a reorg",
      "created_at": "2023-08-04T15:43:56Z",
      "updated_at": "2023-08-04T15:43:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1284581060",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284581060"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 305,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284902580",
      "pull_request_review_id": 1563650229,
      "id": 1284902580,
      "node_id": "PRRC_kwDOABII585Mlg60",
      "diff_hunk": "@@ -269,6 +295,38 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n         // m_synced. Consider the case where there is a reorg and the blocks on the stale branch are\n         // in the ValidationInterface queue backlog even after the sync thread has caught up to the\n         // new chain tip. In this unlikely event, log a warning and let the queue clear.\n+        //\n+        // To allow handling reorgs, this only checks that the new block\n+        // connects to ancestor of the current best block, instead of checking\n+        // that it connects to directly to the current block. If there is a\n+        // reorg, Rewind call below will remove existing blocks from the index\n+        // before adding the new one.\n+        //\n+        // The other case where the new block will connect to an ancestor of the\n+        // current block rather than the current block is when the m_synced flag\n+        // is set to true too early. For example if the index is synced to\n+        // height 100, and -reindex-chainstate option is used, there may be\n+        // BlockConnected notifications for blocks 97, 98, 99, and 100 sitting\n+        // in the notifications queue when m_synced gets set to true. When this",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c0d1110d2a066f8e97ae33e769e761a10f0f0620",
      "in_reply_to_id": 1282008318,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Yes, I am definitely looking for suggestions on how many of the first commits it would make sense to split off into a separate PR.\r\n\r\nOk cool. I suggested to decouple this commit only because I'm going commit by commit and it seemed like an easy step forward, but will keep moving forward.\r\n\r\n> But just to be clear, there isn't a bug here, just suboptimal behavior. If -reindex-chainstate is used and there are still block-connected notifications waiting in the queue when the index is started, it doesn't cause any index corruption. It just causes the last few blocks in the index to be rewound, and then appended again, as if there were a reorg\r\n\r\nYeah, we are sync. I said \"bug\" because of the unexpected behavior. I don't think that it was programmed to do that.",
      "created_at": "2023-08-04T23:16:11Z",
      "updated_at": "2023-08-04T23:16:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1284902580",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284902580"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 305,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 310,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1304365188",
      "pull_request_review_id": 1593654901,
      "id": 1304365188,
      "node_id": "PRRC_kwDOABII585NvwiE",
      "diff_hunk": "@@ -356,7 +335,7 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n \n void BaseIndex::ChainStateFlushed(const CBlockLocator& locator)\n {\n-    if (!m_synced) {\n+    if (!m_ready) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 97,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b96598d93895e6c6be10e13cabf04935098f8b14",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In b96598d9:\r\n\r\nSame as you did for `BlockConnected()`, what about doing the same cleanup on this method?. Check few lines below, we have the same:\r\n\r\n```\r\n// This checks that ChainStateFlushed callbacks are received after BlockConnected. The check may fail\r\n// immediately after the sync thread catches up and sets m_synced. Consider the case where\r\n// there is a reorg and the blocks on the stale branch are in the ValidationInterface queue\r\n// backlog even after the sync thread has caught up to the new chain tip. In this unlikely\r\n// event, log a warning and let the queue clear\r\n```\r\n\r\nwhich is no longer possible, thanks to `m_ready` set in the validation queue thread.\r\n",
      "created_at": "2023-08-24T13:50:39Z",
      "updated_at": "2023-08-24T14:40:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1304365188",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1304365188"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 336,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 338,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1304376602",
      "pull_request_review_id": 1593654901,
      "id": 1304376602,
      "node_id": "PRRC_kwDOABII585NvzUa",
      "diff_hunk": "@@ -141,6 +141,21 @@ bool BaseIndex::Init()\n     // datadir and an index enabled. If this is the case, indexation will happen solely\n     // via `BlockConnected` signals until, possibly, the next restart.\n     m_synced = start_block == active_chain.Tip();\n+    if (m_synced) {\n+        // To prevent race conditions, m_ready = true needs to be set from the\n+        // validationinterface thread and the m_ready = true callback needs to\n+        // be queued while cs_main is held.\n+        //\n+        // To prevent older, stale notifications currently in the validation\n+        // queue from being processed, it is important setting m_ready = true\n+        // in queue after they processed.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be queued after the m_ready = true callback.\n+        CallFunctionInValidationInterfaceQueue([this] { m_ready = true; });",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 17,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b96598d93895e6c6be10e13cabf04935098f8b14",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In b96598d9:\r\n\r\nSmall note, the comment that is above the `RegisterValidationInterface()` call is not so accurate anymore.",
      "created_at": "2023-08-24T13:56:47Z",
      "updated_at": "2023-08-24T14:40:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1304376602",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1304376602"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 157,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1305674280",
      "pull_request_review_id": 1595753171,
      "id": 1305674280,
      "node_id": "PRRC_kwDOABII585N0wIo",
      "diff_hunk": "@@ -731,6 +731,16 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options, const StartSyncFn& start_sync) override\n+    {\n+        LOCK(cs_main);\n+        const Chainstate& active{chainman().ActiveChainstate()};\n+        const CBlockIndex* start_block_index{locator.IsNull() ? nullptr : active.m_blockman.LookupBlockIndex(locator.vHave.at(0))};",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1a6a2a3fe5a19d706b9df60836b783bb3099deab",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 1a6a2a3f:\r\n\r\nAs we always use the top locator item. What about providing the start block uint256 directly to `attachChain`?.\r\n\r\nAlso, what do you think about working on an index upgrade mechanism to only store the tip's uint256 instead of the locator?.\r\n\r\nIt seems that with it, we will be able to simplify 432febc3.\r\n\r\nUpdate:\r\nMade a quick version of it here: https://github.com/furszy/bitcoin-core/commit/7f2b2eb6c313d64e323edc11931d2786e181c0d8.",
      "created_at": "2023-08-25T13:38:13Z",
      "updated_at": "2023-08-25T14:36:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1305674280",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1305674280"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 734,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 855,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307940708",
      "pull_request_review_id": 1599095636,
      "id": 1307940708,
      "node_id": "PRRC_kwDOABII585N9Zdk",
      "diff_hunk": "@@ -123,8 +123,11 @@ BaseIndex::BaseIndex(std::unique_ptr<interfaces::Chain> chain, std::string name)\n \n BaseIndex::~BaseIndex()\n {\n-    Interrupt();\n-    Stop();\n+    //! Assert Stop() was called before this base destructor. Notification\n+    //! handlers call pure virtual methods like GetName(), so if they are still\n+    //! being called at this point, they would segfault.\n+    LOCK(m_mutex);\n+    assert(!m_handler);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "cf491ea020f8b749f61731c7e705b0360a1d75fc",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In cf491ea0:\r\n\r\nProbably, we should fix the tests that could be depending on this here too. For instance, the `blockfilter_index_init_destroy` unit test isn't interrupting nor stopping the index. \r\nThen, `coinstatsindex_unclean_shutdown` and `txindex_initial_sync` only call `Stop()` without calling `Interrupt()` first.",
      "created_at": "2023-08-28T20:53:40Z",
      "updated_at": "2023-08-28T20:55:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307940708",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307940708"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 124,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 238,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307966484",
      "pull_request_review_id": 1599149979,
      "id": 1307966484,
      "node_id": "PRRC_kwDOABII585N9fwU",
      "diff_hunk": "@@ -326,8 +327,27 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     assert(current_tip == m_best_block_index);\n     assert(current_tip->GetAncestor(new_tip->nHeight) == new_tip);\n \n-    if (!CustomRewind({current_tip->GetBlockHash(), current_tip->nHeight}, {new_tip->GetBlockHash(), new_tip->nHeight})) {\n-        return false;\n+    CBlock block;\n+    CBlockUndo block_undo;\n+\n+    for (const CBlockIndex* iter_tip = current_tip; iter_tip != new_tip; iter_tip = iter_tip->pprev) {\n+        interfaces::BlockInfo block_info = kernel::MakeBlockInfo(iter_tip);\n+        if (CustomOptions().disconnect_data) {\n+            if (!m_chainstate->m_blockman.ReadBlockFromDisk(block, *iter_tip)) {\n+                return error(\"%s: Failed to read block %s from disk\",\n+                             __func__, iter_tip->GetBlockHash().ToString());\n+            }\n+            block_info.data = &block;\n+\t}",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 25,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d260abb89101a2a206ab3b86990a3c4518ae1508",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In d260abb8:\r\n\r\nMissing indentation.",
      "created_at": "2023-08-28T21:22:19Z",
      "updated_at": "2023-08-28T21:34:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307966484",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307966484"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307972744",
      "pull_request_review_id": 1599149979,
      "id": 1307972744,
      "node_id": "PRRC_kwDOABII585N9hSI",
      "diff_hunk": "@@ -285,15 +285,15 @@ static bool CopyHeightIndexToHashIndex(CDBIterator& db_it, CDBBatch& batch,\n     return true;\n }\n \n-bool BlockFilterIndex::CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip)\n+bool BlockFilterIndex::CustomRemove(const interfaces::BlockInfo& block)\n {\n     CDBBatch batch(*m_db);\n     std::unique_ptr<CDBIterator> db_it(m_db->NewIterator());\n \n     // During a reorg, we need to copy all filters for blocks that are getting disconnected from the\n     // height index to the hash index so we can still find them when the height index entries are\n     // overwritten.\n-    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, new_tip.height, current_tip.height)) {\n+    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, block.height - 1, block.height)) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": 81,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d260abb89101a2a206ab3b86990a3c4518ae1508",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In d260abb8:\r\n\r\nNote: now that only one block per `CustomRemove` call is rewinded, we could simplify the loop inside `CopyHeightIndexToHashIndex()`.",
      "created_at": "2023-08-28T21:27:11Z",
      "updated_at": "2023-08-28T21:34:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307972744",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307972744"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 313,
      "original_line": 313,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307976654",
      "pull_request_review_id": 1599149979,
      "id": 1307976654,
      "node_id": "PRRC_kwDOABII585N9iPO",
      "diff_hunk": "@@ -33,6 +33,7 @@ constexpr auto SYNC_LOCATOR_WRITE_INTERVAL{30s};\n template <typename... Args>\n void BaseIndex::FatalErrorf(const char* fmt, const Args&... args)\n {\n+    Interrupt(); // Cancel the sync thread",
      "path": "src/index/base.cpp",
      "position": 29,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "5e2b1ea14823bcc43429a130d8820f7be0f45b4b",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 5e2b1ea1:\r\n\r\nThe description says that this commit does not change behavior but this `Interrupt()` call here seems like a behavior change.",
      "created_at": "2023-08-28T21:30:11Z",
      "updated_at": "2023-08-28T21:34:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307976654",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307976654"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 37,
      "original_line": 37,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307995721",
      "pull_request_review_id": 1599180216,
      "id": 1307995721,
      "node_id": "PRRC_kwDOABII585N9m5J",
      "diff_hunk": "@@ -61,12 +61,37 @@ class BaseIndexNotifications : public interfaces::Chain::Notifications\n \n void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n {\n-    m_index.BlockConnected(block);\n+    if (m_index.IgnoreBlockConnected(block)) return;\n+\n+    const CBlockIndex* pindex = &m_index.BlockIndex(block.hash);\n+    const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n+    if (block.chain_tip && best_block_index && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "a2e87d9d66902e8f7029ba235c2e2d6aa971c695",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In a2e87d9d6:\r\n\r\nI asked myself why this `chain_tip` check was placed here few times until saw 5e2b1ea1, which makes `ThreadSync()` re-use this code.\r\n\r\nProbably, it would be helpful for other reviewers to have a comment saying: \"`chain_tip` is used here to let `ThreadSync()` handle reorgs\".",
      "created_at": "2023-08-28T21:51:26Z",
      "updated_at": "2023-08-28T21:51:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307995721",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307995721"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308964995",
      "pull_request_review_id": 1600647210,
      "id": 1308964995,
      "node_id": "PRRC_kwDOABII585OBTiD",
      "diff_hunk": "@@ -141,6 +141,21 @@ bool BaseIndex::Init()\n     // datadir and an index enabled. If this is the case, indexation will happen solely\n     // via `BlockConnected` signals until, possibly, the next restart.\n     m_synced = start_block == active_chain.Tip();\n+    if (m_synced) {\n+        // To prevent race conditions, m_ready = true needs to be set from the\n+        // validationinterface thread and the m_ready = true callback needs to\n+        // be queued while cs_main is held.\n+        //\n+        // To prevent older, stale notifications currently in the validation\n+        // queue from being processed, it is important setting m_ready = true\n+        // in queue after they processed.\n+        //\n+        // To prevent new notifications that may be happening in the background\n+        // from being lost, it is important to keep cs_main locked while calling\n+        // CallFunctionInValidationInterfaceQueue, so the new notifications will\n+        // be queued after the m_ready = true callback.\n+        CallFunctionInValidationInterfaceQueue([this] { m_ready = true; });",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 17,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b96598d93895e6c6be10e13cabf04935098f8b14",
      "in_reply_to_id": 1304376602,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1304376602\r\n\r\n> In [b96598d](https://github.com/bitcoin/bitcoin/commit/b96598d93895e6c6be10e13cabf04935098f8b14):\r\n> \r\n> Small note, the comment that is above the `RegisterValidationInterface()` call is not so accurate anymore.\r\n\r\nRewrote the comment. (Comment was also incomplete before, because even before this it was important to register for notifications before releasing cs_main.) ",
      "created_at": "2023-08-29T14:56:03Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308964995",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308964995"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 157,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308965256",
      "pull_request_review_id": 1600647210,
      "id": 1308965256,
      "node_id": "PRRC_kwDOABII585OBTmI",
      "diff_hunk": "@@ -356,7 +335,7 @@ void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const\n \n void BaseIndex::ChainStateFlushed(const CBlockLocator& locator)\n {\n-    if (!m_synced) {\n+    if (!m_ready) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 97,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b96598d93895e6c6be10e13cabf04935098f8b14",
      "in_reply_to_id": 1304365188,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1304365188\r\n\r\n> In [b96598d](https://github.com/bitcoin/bitcoin/commit/b96598d93895e6c6be10e13cabf04935098f8b14):\r\n> \r\n> Same as you did for `BlockConnected()`, what about doing the same cleanup on this method?\r\n\r\nGreat idea, done.",
      "created_at": "2023-08-29T14:56:14Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308965256",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308965256"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 336,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 338,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308965913",
      "pull_request_review_id": 1600647210,
      "id": 1308965913,
      "node_id": "PRRC_kwDOABII585OBTwZ",
      "diff_hunk": "@@ -731,6 +731,16 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options, const StartSyncFn& start_sync) override\n+    {\n+        LOCK(cs_main);\n+        const Chainstate& active{chainman().ActiveChainstate()};\n+        const CBlockIndex* start_block_index{locator.IsNull() ? nullptr : active.m_blockman.LookupBlockIndex(locator.vHave.at(0))};",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1a6a2a3fe5a19d706b9df60836b783bb3099deab",
      "in_reply_to_id": 1305674280,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1305674280\r\n\r\n> In [1a6a2a3](https://github.com/bitcoin/bitcoin/commit/1a6a2a3fe5a19d706b9df60836b783bb3099deab):\r\n> \r\n> As we always use the top locator item. What about providing the start block uint256 directly to `attachChain`?.\r\n> \r\n> Also, what do you think about working on an index upgrade mechanism to only store the tip's uint256 instead of the locator?.\r\n> \r\n> It seems that with it, we will be able to simplify [432febc](https://github.com/bitcoin/bitcoin/commit/432febc33111a49a91ac196a8374605efa14975d).\r\n> \r\n> Update: Made a quick version of it here: [furszy@7f2b2eb](https://github.com/furszy/bitcoin-core/commit/7f2b2eb6c313d64e323edc11931d2786e181c0d8).\r\n\r\nThanks. I'm not sure I see the benefits here for code simplification. I think just because existing index types may require the best block to be present to sync, it doesn't mean that other index types (or wallets) will have the same limitation. Since the locator is a generalization of the best block hash, it seems like we don't get much advantage from switching to the best block hash, and switching also has disadvantage of changing the index format and affecting backwards compatibility or requiring backwards compatibility code.\r\n\r\nI also would like wallets to eventually call attachChain so wallets reuse same sync code and potentially sync more efficiently, and wallets should support syncing from a locator.",
      "created_at": "2023-08-29T14:56:42Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308965913",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308965913"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 734,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 855,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308966426",
      "pull_request_review_id": 1600647210,
      "id": 1308966426,
      "node_id": "PRRC_kwDOABII585OBT4a",
      "diff_hunk": "@@ -61,12 +61,37 @@ class BaseIndexNotifications : public interfaces::Chain::Notifications\n \n void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n {\n-    m_index.BlockConnected(block);\n+    if (m_index.IgnoreBlockConnected(block)) return;\n+\n+    const CBlockIndex* pindex = &m_index.BlockIndex(block.hash);\n+    const CBlockIndex* best_block_index = m_index.m_best_block_index.load();\n+    if (block.chain_tip && best_block_index && best_block_index != pindex->pprev && !m_index.Rewind(best_block_index, pindex->pprev)) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "a2e87d9d66902e8f7029ba235c2e2d6aa971c695",
      "in_reply_to_id": 1307995721,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307995721\r\n\r\n> In [a2e87d9](https://github.com/bitcoin/bitcoin/commit/a2e87d9d66902e8f7029ba235c2e2d6aa971c695):\r\n> \r\n> I asked myself why this `chain_tip` check was placed here few times until saw [5e2b1ea](https://github.com/bitcoin/bitcoin/commit/5e2b1ea14823bcc43429a130d8820f7be0f45b4b), which makes `ThreadSync()` re-use this code.\r\n> \r\n> Probably, it would be helpful for other reviewers to have a comment saying: \"`chain_tip` is used here to let `ThreadSync()` handle reorgs\".\r\n\r\nGood point, that is unnecessarily confusing. Removed chain_tip reference here and added back later when it is actually used.",
      "created_at": "2023-08-29T14:57:05Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308966426",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308966426"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308966730",
      "pull_request_review_id": 1600647210,
      "id": 1308966730,
      "node_id": "PRRC_kwDOABII585OBT9K",
      "diff_hunk": "@@ -123,8 +123,11 @@ BaseIndex::BaseIndex(std::unique_ptr<interfaces::Chain> chain, std::string name)\n \n BaseIndex::~BaseIndex()\n {\n-    Interrupt();\n-    Stop();\n+    //! Assert Stop() was called before this base destructor. Notification\n+    //! handlers call pure virtual methods like GetName(), so if they are still\n+    //! being called at this point, they would segfault.\n+    LOCK(m_mutex);\n+    assert(!m_handler);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "cf491ea020f8b749f61731c7e705b0360a1d75fc",
      "in_reply_to_id": 1307940708,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307940708\r\n\r\n> In [cf491ea](https://github.com/bitcoin/bitcoin/commit/cf491ea020f8b749f61731c7e705b0360a1d75fc):\r\n> \r\n> Probably, we should fix the tests that could be depending on this here too. For instance, the `blockfilter_index_init_destroy` unit test isn't interrupting nor stopping the index. Then, `coinstatsindex_unclean_shutdown` and `txindex_initial_sync` only call `Stop()` without calling `Interrupt()` first.\r\n\r\nNice catch on the `blockfilter_index_init_destroy` test. I do think it safe, though because it is just creating and destroying index objects without actually starting them, so there no need to stop them first (otherwise would trigger the assert).\r\n\r\nIt's also a good observation about Stop() being called without Interrupt() in some places. I think this is actually ok, because it just causes the test to wait for the index to sync.",
      "created_at": "2023-08-29T14:57:19Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308966730",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308966730"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 124,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 238,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308967496",
      "pull_request_review_id": 1600647210,
      "id": 1308967496,
      "node_id": "PRRC_kwDOABII585OBUJI",
      "diff_hunk": "@@ -326,8 +327,27 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     assert(current_tip == m_best_block_index);\n     assert(current_tip->GetAncestor(new_tip->nHeight) == new_tip);\n \n-    if (!CustomRewind({current_tip->GetBlockHash(), current_tip->nHeight}, {new_tip->GetBlockHash(), new_tip->nHeight})) {\n-        return false;\n+    CBlock block;\n+    CBlockUndo block_undo;\n+\n+    for (const CBlockIndex* iter_tip = current_tip; iter_tip != new_tip; iter_tip = iter_tip->pprev) {\n+        interfaces::BlockInfo block_info = kernel::MakeBlockInfo(iter_tip);\n+        if (CustomOptions().disconnect_data) {\n+            if (!m_chainstate->m_blockman.ReadBlockFromDisk(block, *iter_tip)) {\n+                return error(\"%s: Failed to read block %s from disk\",\n+                             __func__, iter_tip->GetBlockHash().ToString());\n+            }\n+            block_info.data = &block;\n+\t}",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 25,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d260abb89101a2a206ab3b86990a3c4518ae1508",
      "in_reply_to_id": 1307966484,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307966484\r\n\r\nThanks, fixed",
      "created_at": "2023-08-29T14:57:53Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308967496",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308967496"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308968194",
      "pull_request_review_id": 1600647210,
      "id": 1308968194,
      "node_id": "PRRC_kwDOABII585OBUUC",
      "diff_hunk": "@@ -146,6 +135,7 @@ bool CoinStatsIndex::CustomAppend(const interfaces::BlockInfo& block)\n \n         // Add the new utxos created from the block\n         assert(block.data);\n+        assert(block.undo_data);\n         for (size_t i = 0; i < block.data->vtx.size(); ++i) {\n             const auto& tx{block.data->vtx.at(i)};\n ",
      "path": "src/index/coinstatsindex.cpp",
      "position": 27,
      "original_position": 37,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "137bbe1478833ccc63f39f794816d35de14025b8",
      "in_reply_to_id": 1083267771,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1083267771\r\n\r\n> ```\r\n> index/coinstatsindex.cpp:143:37: error: use of undeclared identifier 'pindex'\r\n> ```\r\n\r\nThis was probably a rebase conflict. I think this error must have been fixed, or at least I can't reproduce it the commit this line was added (5e2b1ea14823bcc43429a130d8820f7be0f45b4b)",
      "created_at": "2023-08-29T14:58:22Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308968194",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308968194"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 144,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308968669",
      "pull_request_review_id": 1600647210,
      "id": 1308968669,
      "node_id": "PRRC_kwDOABII585OBUbd",
      "diff_hunk": "@@ -33,6 +33,7 @@ constexpr auto SYNC_LOCATOR_WRITE_INTERVAL{30s};\n template <typename... Args>\n void BaseIndex::FatalErrorf(const char* fmt, const Args&... args)\n {\n+    Interrupt(); // Cancel the sync thread",
      "path": "src/index/base.cpp",
      "position": 29,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "5e2b1ea14823bcc43429a130d8820f7be0f45b4b",
      "in_reply_to_id": 1307976654,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307976654\r\n\r\n> In [5e2b1ea](https://github.com/bitcoin/bitcoin/commit/5e2b1ea14823bcc43429a130d8820f7be0f45b4b):\r\n> \r\n> The description says that this commit does not change behavior but this `Interrupt()` call here seems like a behavior change.\r\n\r\nIt shouldn't be a behavior change (unless I am missing something) because Interrupt() just stops the sync thread, and the sync thread never calls FatalErrorf unless it is already stopping.",
      "created_at": "2023-08-29T14:58:41Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308968669",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308968669"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 37,
      "original_line": 37,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308968872",
      "pull_request_review_id": 1600647210,
      "id": 1308968872,
      "node_id": "PRRC_kwDOABII585OBUeo",
      "diff_hunk": "@@ -58,6 +58,7 @@ class BaseIndexNotifications : public interfaces::Chain::Notifications\n     void chainStateFlushed(const CBlockLocator& locator) override;\n \n     BaseIndex& m_index;\n+    interfaces::Chain::NotifyOptions m_options = m_index.CustomOptions();",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "a6d1c22dc1254cbfedda7add573f0d537aefd36c",
      "in_reply_to_id": 1034011918,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034011918\r\n\r\n> [a6d1c22](https://github.com/bitcoin/bitcoin/commit/a6d1c22dc1254cbfedda7add573f0d537aefd36c)\r\n> \r\n> Maybe I'm just dense today, but I don't recognize this cpp pattern. Is this some kind of initialization shorthand that's executed once on construction, when we get a valid reference for `m_index`?\r\n\r\nIt's more simple than that, it's just declaring `NotifyOptions m_options` member, where `NotifyOptions` is an options struct with bool and string fields. The struct is initialized by calling the CustomOptions method whenever the class is constructed.",
      "created_at": "2023-08-29T14:58:49Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308968872",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308968872"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 61,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308970304",
      "pull_request_review_id": 1600647210,
      "id": 1308970304,
      "node_id": "PRRC_kwDOABII585OBU1A",
      "diff_hunk": "@@ -136,6 +150,23 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n \n void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block)\n {\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_synced && block.chain_tip) return;\n+\n+    const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_index.m_chainstate->m_blockman.LookupBlockIndex(block.hash));\n+    if (!m_rewind_start) m_rewind_start = pindex;\n+    if (m_rewind_error) return;\n+\n+    CBlockUndo block_undo;\n+    interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex, block.data);\n+    if (m_options.disconnect_undo_data && block.height > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            m_rewind_error = true;",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "15f83492713abefea3f6ffc7e4c100a6177cc462",
      "in_reply_to_id": 1034937153,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034937153\r\n\r\n> [15f8349](https://github.com/bitcoin/bitcoin/commit/15f83492713abefea3f6ffc7e4c100a6177cc462)\r\n> \r\n> Would it be worth `FatalError()`/`return` from here? I think that is needed to maintain strict behavioral compatibility with the way that ThreadSync() currently behaves, since [`!Rewind()` can be tripped](https://github.com/bitcoin/bitcoin/pull/24230/commits/15f83492713abefea3f6ffc7e4c100a6177cc462#diff-5251d93616c116c364d2d502ad2a59e901a3512194462fabacc9756f96fd8dddL221) for either a failure to retrieve block data OR failure to retrieve undo data.\r\n\r\nThe error still happens on line 99 (\"%s: Failed to rewind index %s to a previous chain tip\") because rewind_ok will be false. The idea is to keep behavior unchanged, and trigger the error when there is actually an attempt to connect another block.\r\n\r\nMaybe though the complexity of having m_rewind_error and m_rewind_start variables is not worth it, and there should be an immediate fatal error.\r\n\r\nFor now just added a comment about `m_rewind_error` here",
      "created_at": "2023-08-29T14:59:49Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308970304",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308970304"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 165,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308970603",
      "pull_request_review_id": 1600647210,
      "id": 1308970603,
      "node_id": "PRRC_kwDOABII585OBU5r",
      "diff_hunk": "@@ -80,6 +85,15 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         m_index.SetBestBlockIndex(pindex);\n         if (block.chain_tip) {\n             m_index.m_synced = true;\n+            if (pindex) {\n+                LogPrintf(\"%s is enabled at height %d\\n\", m_index.GetName(), pindex->nHeight);\n+            } else {\n+                LogPrintf(\"%s is enabled\\n\", m_index.GetName());\n+            }",
      "path": "src/index/base.cpp",
      "position": 87,
      "original_position": 27,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ed79c47c1385dc2e1b25d3958fa83a231770353d",
      "in_reply_to_id": 1034952930,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034952930\r\n\r\n> [ed79c47](https://github.com/bitcoin/bitcoin/commit/ed79c47c1385dc2e1b25d3958fa83a231770353d)\r\n> \r\n> Should the equivalent old code in ThreadSync() be removed here in this commit as well?\r\n\r\nGood catch, added that change to this commit!",
      "created_at": "2023-08-29T15:00:03Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308970603",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308970603"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 101,
      "original_line": 101,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308970839",
      "pull_request_review_id": 1600647210,
      "id": 1308970839,
      "node_id": "PRRC_kwDOABII585OBU9X",
      "diff_hunk": "@@ -89,6 +89,7 @@ struct BlockInfo {\n     const CBlockUndo* undo_data = nullptr;\n     //! Block is from the tip of the chain (always true except when first calling attachChain and reading old blocks).\n     bool chain_tip = true;\n+    std::string error;",
      "path": "src/interfaces/chain.h",
      "position": 15,
      "original_position": 4,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ed79c47c1385dc2e1b25d3958fa83a231770353d",
      "in_reply_to_id": 1034973794,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034973794\r\n\r\n> [ed79c47#diff-8e9fef4d0718d085f31da382899d97e3bbefc8d6a72ede95916a0e2fbd1a532fR92](https://github.com/bitcoin/bitcoin/commit/ed79c47c1385dc2e1b25d3958fa83a231770353d#diff-8e9fef4d0718d085f31da382899d97e3bbefc8d6a72ede95916a0e2fbd1a532fR92)\r\n> \r\n> It might help to add some documentation for how this is used and under what conditions it is set.\r\n\r\nGood idea, added.",
      "created_at": "2023-08-29T15:00:13Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1308970839",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308970839"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 99,
      "original_line": 99,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1310863359",
      "pull_request_review_id": 1603545676,
      "id": 1310863359,
      "node_id": "PRRC_kwDOABII585OIi__",
      "diff_hunk": "@@ -261,38 +261,21 @@ static bool CopyHeightIndexToHashIndex(CDBIterator& db_it, CDBBatch& batch,\n     return true;\n }\n \n-bool CoinStatsIndex::CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip)\n+bool CoinStatsIndex::CustomRemove(const interfaces::BlockInfo& block)\n {\n     CDBBatch batch(*m_db);\n     std::unique_ptr<CDBIterator> db_it(m_db->NewIterator());\n \n     // During a reorg, we need to copy all hash digests for blocks that are\n     // getting disconnected from the height index to the hash index so we can\n     // still find them when the height index entries are overwritten.\n-    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, new_tip.height, current_tip.height)) {\n+    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, block.height - 1, block.height)) {\n         return false;\n     }\n \n     if (!m_db->WriteBatch(batch)) return false;\n \n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* iter_tip{m_chainstate->m_blockman.LookupBlockIndex(current_tip.hash)};\n-        const CBlockIndex* new_tip_index{m_chainstate->m_blockman.LookupBlockIndex(new_tip.hash)};\n-\n-        do {\n-            CBlock block;\n-\n-            if (!m_chainstate->m_blockman.ReadBlockFromDisk(block, *iter_tip)) {\n-                return error(\"%s: Failed to read block %s from disk\",\n-                             __func__, iter_tip->GetBlockHash().ToString());\n-            }\n-\n-            ReverseBlock(block, iter_tip);\n-\n-            iter_tip = iter_tip->GetAncestor(iter_tip->nHeight - 1);\n-        } while (new_tip_index != iter_tip);\n-    }\n+    ReverseBlock(block);",
      "path": "src/index/coinstatsindex.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d260abb89101a2a206ab3b86990a3c4518ae1508",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Seems that we are swallowing `ReverseBlock()` return value. When it could mean that there is something wrong with the index.\r\n\r\nDo you want to fix it here or should I go with another PR?",
      "created_at": "2023-08-30T21:45:52Z",
      "updated_at": "2023-08-31T14:49:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1310863359",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1310863359"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 271,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1310867812",
      "pull_request_review_id": 1603550524,
      "id": 1310867812,
      "node_id": "PRRC_kwDOABII585OIkFk",
      "diff_hunk": "@@ -72,12 +78,30 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         return;\n     }\n \n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && !block.undo_data && pindex->nHeight > 0) {\n+        if (!m_index.m_chainstate->m_blockman.UndoReadFromDisk(block_undo, *pindex)) {\n+            m_index.FatalErrorf(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return;\n+        }\n+        block.undo_data = &block_undo;\n+    }\n+\n     if (!m_index.CustomAppend(block)) {\n         m_index.FatalErrorf(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n         return;\n     }\n \n+    if (!m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 45,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "5e2b1ea14823bcc43429a130d8820f7be0f45b4b",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 5e2b1ea1:\r\n\r\nI'm wondering what would change if we use `if (!block.chain_tip)` instead. Guess that nothing right?",
      "created_at": "2023-08-30T21:50:58Z",
      "updated_at": "2023-08-30T21:58:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1310867812",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1310867812"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 97,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1311649499",
      "pull_request_review_id": 1604787730,
      "id": 1311649499,
      "node_id": "PRRC_kwDOABII585OLi7b",
      "diff_hunk": "@@ -279,9 +292,44 @@ class Chain\n         virtual void chainStateFlushed(const CBlockLocator& locator) {}\n     };\n \n+    //! Options specifying which chain notifications are required.\n+    struct NotifyOptions\n+    {\n+        //! Include undo data with block connected notifications.\n+        bool connect_undo_data = false;\n+        //! Include block data with block disconnected notifications.\n+        bool disconnect_data = false;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 54,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This field is only set by the coinstats index but never used.\r\n\r\nGuessing that it is because the notifications now go through the `NotificationsProxy` class, who automatically fill-up the block data during disconnection.\r\n\r\nWhile this is ok for the coinstats index, it is not that good for the other indexes. As they do not use the block data during disconnection, all these disk reads mean a resources waste for them.",
      "created_at": "2023-08-31T13:39:28Z",
      "updated_at": "2023-08-31T13:40:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1311649499",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1311649499"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 300,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 301,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1311789787",
      "pull_request_review_id": 1605000586,
      "id": 1311789787,
      "node_id": "PRRC_kwDOABII585OMFLb",
      "diff_hunk": "@@ -40,11 +40,6 @@ void BaseIndex::FatalErrorf(const char* fmt, const Args&... args)\n     node::AbortNode(m_chain->context()->exit_status, message);\n }\n \n-const CBlockIndex& BaseIndex::BlockIndex(const uint256& hash)\n-{\n-   return WITH_LOCK(cs_main, return *Assert(m_chainstate->m_blockman.LookupBlockIndex(hash)));\n-}\n-",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In f74b34f2:\r\n\r\n`BaseIndex::BlockIndex` definition was removed but not its declaration in the header.\r\n\r\n",
      "created_at": "2023-08-31T15:12:29Z",
      "updated_at": "2023-08-31T15:12:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1311789787",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1311789787"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 43,
      "start_side": "LEFT",
      "line": null,
      "original_line": 36,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1311794521",
      "pull_request_review_id": 1605007986,
      "id": 1311794521,
      "node_id": "PRRC_kwDOABII585OMGVZ",
      "diff_hunk": "@@ -354,49 +421,6 @@ bool BaseIndex::Commit(const CBlockLocator& locator)\n     return true;\n }\n \n-bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_tip)",
      "path": "src/index/base.cpp",
      "position": 421,
      "original_position": 125,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "0550d1749b0b82d0eb99e0870555a049b8e6c998",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 0550d174:\r\n\r\n`BaseIndex::Rewind` definition was removed but not its declaration in the header.\r\nAlso, there is a comment in `IgnoreBlockConnected()` referring to this method that should be updated.",
      "created_at": "2023-08-31T15:15:46Z",
      "updated_at": "2023-08-31T15:15:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1311794521",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1311794521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 238,
      "original_line": 238,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315931615",
      "pull_request_review_id": 1600647210,
      "id": 1315931615,
      "node_id": "PRRC_kwDOABII585Ob4Xf",
      "diff_hunk": "@@ -261,38 +261,21 @@ static bool CopyHeightIndexToHashIndex(CDBIterator& db_it, CDBBatch& batch,\n     return true;\n }\n \n-bool CoinStatsIndex::CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip)\n+bool CoinStatsIndex::CustomRemove(const interfaces::BlockInfo& block)\n {\n     CDBBatch batch(*m_db);\n     std::unique_ptr<CDBIterator> db_it(m_db->NewIterator());\n \n     // During a reorg, we need to copy all hash digests for blocks that are\n     // getting disconnected from the height index to the hash index so we can\n     // still find them when the height index entries are overwritten.\n-    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, new_tip.height, current_tip.height)) {\n+    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, block.height - 1, block.height)) {\n         return false;\n     }\n \n     if (!m_db->WriteBatch(batch)) return false;\n \n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* iter_tip{m_chainstate->m_blockman.LookupBlockIndex(current_tip.hash)};\n-        const CBlockIndex* new_tip_index{m_chainstate->m_blockman.LookupBlockIndex(new_tip.hash)};\n-\n-        do {\n-            CBlock block;\n-\n-            if (!m_chainstate->m_blockman.ReadBlockFromDisk(block, *iter_tip)) {\n-                return error(\"%s: Failed to read block %s from disk\",\n-                             __func__, iter_tip->GetBlockHash().ToString());\n-            }\n-\n-            ReverseBlock(block, iter_tip);\n-\n-            iter_tip = iter_tip->GetAncestor(iter_tip->nHeight - 1);\n-        } while (new_tip_index != iter_tip);\n-    }\n+    ReverseBlock(block);",
      "path": "src/index/coinstatsindex.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d260abb89101a2a206ab3b86990a3c4518ae1508",
      "in_reply_to_id": 1310863359,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1310863359\r\n\r\n> Seems that we are swallowing `ReverseBlock()` return value. When it could mean that there is something wrong with the index.\r\n> \r\n> Do you want to fix it here or should I go with another PR?\r\n\r\nGood catch. It would be great if you want to follow up in different PR to reduce complexity here.\r\n\r\n",
      "created_at": "2023-09-05T13:50:56Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1315931615",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315931615"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 271,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315932376",
      "pull_request_review_id": 1600647210,
      "id": 1315932376,
      "node_id": "PRRC_kwDOABII585Ob4jY",
      "diff_hunk": "@@ -72,12 +78,30 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         return;\n     }\n \n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && !block.undo_data && pindex->nHeight > 0) {\n+        if (!m_index.m_chainstate->m_blockman.UndoReadFromDisk(block_undo, *pindex)) {\n+            m_index.FatalErrorf(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return;\n+        }\n+        block.undo_data = &block_undo;\n+    }\n+\n     if (!m_index.CustomAppend(block)) {\n         m_index.FatalErrorf(\"%s: Failed to write block %s to index\",\n                    __func__, pindex->GetBlockHash().ToString());\n         return;\n     }\n \n+    if (!m_index.m_synced) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 45,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "5e2b1ea14823bcc43429a130d8820f7be0f45b4b",
      "in_reply_to_id": 1310867812,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1310867812\r\n\r\n> In [5e2b1ea](https://github.com/bitcoin/bitcoin/commit/5e2b1ea14823bcc43429a130d8820f7be0f45b4b):\r\n> \r\n> I'm wondering what would change if we use `if (!block.chain_tip)` instead. Guess that nothing right?\r\n\r\nRight, that's a good point that the `block.chain_tip` has same information as `m_synced`.\r\n\r\nI like the idea of replacing all `m_synced` uses in this function with `block.chain_tip`, so I made that change. It should be better because it makes the code act directly on block information rather than going through an intermediate variable. After this, `m_synced` is only used to implement `BaseIndex::GetSummary()` and `BaseIndex::BlockUntilSyncedToCurrentChain()` and doesn't affect indexing behavior anymore.\r\n",
      "created_at": "2023-09-05T13:51:29Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1315932376",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315932376"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 97,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315933024",
      "pull_request_review_id": 1600647210,
      "id": 1315933024,
      "node_id": "PRRC_kwDOABII585Ob4tg",
      "diff_hunk": "@@ -279,9 +292,44 @@ class Chain\n         virtual void chainStateFlushed(const CBlockLocator& locator) {}\n     };\n \n+    //! Options specifying which chain notifications are required.\n+    struct NotifyOptions\n+    {\n+        //! Include undo data with block connected notifications.\n+        bool connect_undo_data = false;\n+        //! Include block data with block disconnected notifications.\n+        bool disconnect_data = false;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 54,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "in_reply_to_id": 1311649499,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1311649499\r\n\r\n> This field is only set by the coinstats index but never used.\r\n> \r\n> Guessing that it is because the notifications now go through the `NotificationsProxy` class, who automatically fill-up the block data during disconnection.\r\n> \r\n> While this is ok for the coinstats index, it is not that good for the other indexes. As they do not use the block data during disconnection, all these disk reads mean a resources waste for them.\r\n\r\nGood point. Removed this variable. Potentially the SyncChain method could use it to avoid reading data but this would be a minor optimization and in any case I never implemented it.\r\n",
      "created_at": "2023-09-05T13:51:59Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1315933024",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315933024"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 300,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 301,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315933476",
      "pull_request_review_id": 1600647210,
      "id": 1315933476,
      "node_id": "PRRC_kwDOABII585Ob40k",
      "diff_hunk": "@@ -40,11 +40,6 @@ void BaseIndex::FatalErrorf(const char* fmt, const Args&... args)\n     node::AbortNode(m_chain->context()->exit_status, message);\n }\n \n-const CBlockIndex& BaseIndex::BlockIndex(const uint256& hash)\n-{\n-   return WITH_LOCK(cs_main, return *Assert(m_chainstate->m_blockman.LookupBlockIndex(hash)));\n-}\n-",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f74b34f2d4d30f6895cfbeed2ec655a60290e990",
      "in_reply_to_id": 1311789787,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1311789787\r\n\r\n> In [f74b34f](https://github.com/bitcoin/bitcoin/commit/f74b34f2d4d30f6895cfbeed2ec655a60290e990):\r\n> \r\n> `BaseIndex::BlockIndex` definition was removed but not its declaration in the header.\r\n\r\nGood catch. Removed\r\n",
      "created_at": "2023-09-05T13:52:13Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1315933476",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315933476"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": 43,
      "start_side": "LEFT",
      "line": null,
      "original_line": 36,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315934186",
      "pull_request_review_id": 1600647210,
      "id": 1315934186,
      "node_id": "PRRC_kwDOABII585Ob4_q",
      "diff_hunk": "@@ -354,49 +421,6 @@ bool BaseIndex::Commit(const CBlockLocator& locator)\n     return true;\n }\n \n-bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_tip)",
      "path": "src/index/base.cpp",
      "position": 421,
      "original_position": 125,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "0550d1749b0b82d0eb99e0870555a049b8e6c998",
      "in_reply_to_id": 1311794521,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1311794521\r\n\r\n> In [0550d17](https://github.com/bitcoin/bitcoin/commit/0550d1749b0b82d0eb99e0870555a049b8e6c998):\r\n> \r\n> `BaseIndex::Rewind` definition was removed but not its declaration in the header. Also, there is a comment in `IgnoreBlockConnected()` referring to this method that should be updated.\r\n\r\nThanks, fixed both of these things",
      "created_at": "2023-09-05T13:52:41Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1315934186",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315934186"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 238,
      "original_line": 238,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316017771",
      "pull_request_review_id": 1600647210,
      "id": 1316017771,
      "node_id": "PRRC_kwDOABII585OcNZr",
      "diff_hunk": "@@ -271,14 +272,24 @@ class Chain\n         virtual ~Notifications() {}\n         virtual void transactionAddedToMempool(const CTransactionRef& tx, uint64_t mempool_sequence) {}\n         virtual void transactionRemovedFromMempool(const CTransactionRef& tx, MemPoolRemovalReason reason, uint64_t mempool_sequence) {}\n+        //! Notification sent when new blocks are connected, and also called on\n+        //! startup from attachChain() with the last connected block. The\n+        //! block.data pointer is null for the last connected block and non-null\n+        //! for newly connected blocks after that.\n         virtual void blockConnected(const BlockInfo& block) {}\n         virtual void blockDisconnected(const BlockInfo& block) {}\n         virtual void updatedBlockTip() {}\n         virtual void chainStateFlushed(const CBlockLocator& locator) {}\n     };\n \n-    //! Check if all blocks needed to sync start block to current tip are present.\n-    virtual bool hasDataFromTipDown(const CBlockIndex* start_block) = 0;",
      "path": "src/interfaces/chain.h",
      "position": null,
      "original_position": 32,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2f71f52b9b37b94a03aa203d16eecdca467361ac",
      "in_reply_to_id": 1033933984,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1033933984\r\n\r\n> [2f71f52](https://github.com/bitcoin/bitcoin/commit/2f71f52b9b37b94a03aa203d16eecdca467361ac)\r\n> \r\n> Not a big deal, but curious why this was removed since it was introduced in the previous commit.\r\n\r\nIt's not really removed, just made a internal method instead of a public one so removed from the public interface now that it no longer needs to be called by outside code.",
      "created_at": "2023-09-05T14:52:03Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1316017771",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316017771"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 281,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316022725",
      "pull_request_review_id": 1600647210,
      "id": 1316022725,
      "node_id": "PRRC_kwDOABII585OcOnF",
      "diff_hunk": "@@ -759,6 +758,18 @@ class ChainImpl : public Chain\n         }\n         return !prune_violation;\n     }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override\n+    {\n+        LOCK(cs_main);\n+        const Chainstate& active = Assert(m_node.chainman)->ActiveChainstate();\n+        const CBlockIndex* start_block = locator.IsNull() ? nullptr : active.FindForkInGlobalIndex(locator);\n+        interfaces::BlockInfo block_info = kernel::MakeBlockInfo(start_block);\n+        block_info.chain_tip = start_block == active.m_chain.Tip();\n+        notifications->blockConnected(block_info);\n+        if (!block_info.chain_tip && !hasDataFromTipDown(start_block)) return nullptr;",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2f71f52b9b37b94a03aa203d16eecdca467361ac",
      "in_reply_to_id": 1033943433,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1033943433\r\n\r\n> [2f71f52](https://github.com/bitcoin/bitcoin/commit/2f71f52b9b37b94a03aa203d16eecdca467361ac)\r\n> \r\n> Wouldn't we want to do this check/return before we issue a `blockConnected()` event, or does it not matter because we know that we at least have data for the current tip?\r\n\r\nThe code is a little different now, and the blockConnected call is replaced by a `std::function` callback but I think the idea in either case is that it might be useful for the index to know what the chain tip is even if data has been pruned and it might not be possible to sync.",
      "created_at": "2023-09-05T14:55:29Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1316022725",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316022725"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 769,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316032857",
      "pull_request_review_id": 1600647210,
      "id": 1316032857,
      "node_id": "PRRC_kwDOABII585OcRFZ",
      "diff_hunk": "@@ -759,6 +758,18 @@ class ChainImpl : public Chain\n         }\n         return !prune_violation;\n     }\n+    std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options) override",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "2f71f52b9b37b94a03aa203d16eecdca467361ac",
      "in_reply_to_id": 1033955263,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1033955263\r\n\r\n> [2f71f52](https://github.com/bitcoin/bitcoin/commit/2f71f52b9b37b94a03aa203d16eecdca467361ac)\r\n> \r\n> The contents of this function are pretty specific to indexes (e.g. we have logic in here that refuses to set up the notifications handler if there isn't data beneath the given tip) and I think the name `attachChain` a little bit generic, so might consider renaming this `attachIndexer()` or something more descriptive.\r\n\r\nThis is intentional because the attachChain method is meant to be usable by the wallet too, and it was actually written originally for the wallet in #15719. I think the behaviors you mentioned which are specific to indexes are things which could be controlled by options or just removed later. But idea is for indexes and wallets to just be passive clients that receive notifications, and do not have to implement their own sync logic.",
      "created_at": "2023-09-05T15:02:57Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1316032857",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316032857"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 820,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316047305",
      "pull_request_review_id": 1600647210,
      "id": 1316047305,
      "node_id": "PRRC_kwDOABII585OcUnJ",
      "diff_hunk": "@@ -94,16 +96,21 @@ class BaseIndex : public CValidationInterface\n \n     virtual bool AllowPrune() const = 0;\n \n+    Mutex m_mutex;",
      "path": "src/index/base.h",
      "position": null,
      "original_position": 34,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ecedecac38f231d855e3f663671301d6e1ea7f6b",
      "in_reply_to_id": 1034775306,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034775306\r\n\r\n> [ecedeca](https://github.com/bitcoin/bitcoin/commit/ecedecac38f231d855e3f663671301d6e1ea7f6b)\r\n> \r\n> It would be nice to document what this mutex is for and why it's needed. I gather from below that it's guarding m_notifications and m_handler, but it's not clear to me why that's necessary - my guess is that because the guarded state is accessed by both the sync thread and validationinterface callbacks via `Chain`.\r\n\r\nThis is basically right, it's to allow those variables to be accessed from both the sync thread and the init thread (not the validationinterface thread). Added a comment.\r\n",
      "created_at": "2023-09-05T15:13:21Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1316047305",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316047305"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 99,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316049653",
      "pull_request_review_id": 1600647210,
      "id": 1316049653,
      "node_id": "PRRC_kwDOABII585OcVL1",
      "diff_hunk": "@@ -84,16 +85,31 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block)\n         return;\n     }\n \n-    if (m_index.CustomAppend(block)) {\n+    interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex, block.data);\n+    CBlockUndo block_undo;\n+    if (m_options.connect_undo_data && pindex->nHeight > 0) {\n+        if (!node::UndoReadFromDisk(block_undo, pindex)) {\n+            FatalError(\"%s: Failed to read block %s undo data from disk\",\n+                       __func__, pindex->GetBlockHash().ToString());\n+            return m_index.Interrupt();\n+        }\n+        block_info.undo_data = &block_undo;\n+    }\n+    if (!m_index.CustomAppend(block_info)) {\n+        FatalError(\"%s: Failed to write block %s to index\",\n+                   __func__, pindex->GetBlockHash().ToString());\n+        return m_index.Interrupt();\n+    }\n+    // Only update m_best_block_index between flushes if synced. Unclear why\n+    // best block is not updated here before sync, but this has been\n+    // longstanding behavior since syncing was introduced in #13033 so care\n+    // should be taken if changing m_best_block_index semantics.",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 31,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "a6d1c22dc1254cbfedda7add573f0d537aefd36c",
      "in_reply_to_id": 1034827606,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034827606\r\n\r\n> [a6d1c22](https://github.com/bitcoin/bitcoin/commit/a6d1c22dc1254cbfedda7add573f0d537aefd36c)\r\n> \r\n> To add some color here, reviewers can verify that in the pre-PR code\r\n> \r\n>* BlockConnected events are ignored while not `m_synced`, and\r\n> \r\n>* ThreadSync() calls Commit() which confusingly updates the best block in the index db (GetDB().WriteBestBlock(...)) but doesn't change m_best_block_index.\r\n\r\nThis is right. If it helps I added a separate commit (f552c32de4359cd7dce38ce8c9a340039d5a29c6) to try to document m_best_block_index behavior",
      "created_at": "2023-09-05T15:15:16Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1316049653",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316049653"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 106,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316098046",
      "pull_request_review_id": 1600647210,
      "id": 1316098046,
      "node_id": "PRRC_kwDOABII585Ocg_-",
      "diff_hunk": "@@ -266,13 +284,13 @@ void BaseIndex::ThreadSync()\n                         interfaces::BlockInfo block_info = kernel::MakeBlockInfo(iter_tip);\n                         block_info.chain_tip = false;\n                         if (!ReadBlockFromDisk(block, iter_tip, consensus_params)) {\n-                            FatalError(\"%s: Failed to read block %s from disk\",\n+                            block_info.error = strprintf(\"%s: Failed to read block %s from disk\",",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "ed79c47c1385dc2e1b25d3958fa83a231770353d",
      "in_reply_to_id": 1034972038,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1034972038\r\n\r\n> [ed79c47](https://github.com/bitcoin/bitcoin/commit/ed79c47c1385dc2e1b25d3958fa83a231770353d)\r\n> \r\n> May be worth a comment that `blockDisconnected` will interrupt below in this case, triggering the related return?\r\n\r\nThis change is implemented a little differently now. The ReadBlockFrom disk call is moved into blockDisconnected so hopefully more straightforward.",
      "created_at": "2023-09-05T15:52:09Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1316098046",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316098046"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316106925",
      "pull_request_review_id": 1600647210,
      "id": 1316106925,
      "node_id": "PRRC_kwDOABII585OcjKt",
      "diff_hunk": "@@ -725,6 +725,39 @@ class ChainImpl : public Chain\n     {\n         ::uiInterface.ShowProgress(title, progress, resume_possible);\n     }\n+    bool hasDataFromTipDown(const CBlockIndex* start_block) override {\n+        LOCK(::cs_main);\n+        const CChain& active_chain = Assert(m_node.chainman)->ActiveChain();",
      "path": "src/node/interfaces.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d7eef9f49a827e96337febcf20a22b392dc7b51e",
      "in_reply_to_id": 1188776917,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1188776917\r\n\r\n> nit in [d7eef9f](https://github.com/bitcoin/bitcoin/commit/d7eef9f49a827e96337febcf20a22b392dc7b51e): Can use `chaiman()`?\r\n\r\nThanks, this was done in the meantime, switched to chainman() throughout",
      "created_at": "2023-09-05T15:58:20Z",
      "updated_at": "2023-09-05T19:00:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1316106925",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316106925"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 730,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430067474",
      "pull_request_review_id": 1786770579,
      "id": 1430067474,
      "node_id": "PRRC_kwDOABII585VPRkS",
      "diff_hunk": "@@ -77,6 +77,32 @@ BaseIndex::~BaseIndex()\n     Stop();\n }\n \n+// Read index best block, register for block connected and disconnected\n+// notifications, and determine where best block is relative to chain tip.\n+//\n+// If the chain tip and index best block are the same, block connected and\n+// disconnected notifications will be enabled after this call and the index will\n+// update as the ImportBlocks() function connects blocks and sends\n+// notifications. Otherwise, when the chain tip and index best block not the",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b4328dc89cc4e287965587be0f02c72a511c2a63",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: `s/best block not the same/best block are not the same/`",
      "created_at": "2023-12-18T12:14:15Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1430067474",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430067474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 86,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1435025414",
      "pull_request_review_id": 1786770579,
      "id": 1435025414,
      "node_id": "PRRC_kwDOABII585ViMAG",
      "diff_hunk": "@@ -338,30 +363,14 @@ void BaseIndex::BlockConnected(const interfaces::BlockInfo& block_info)\n         // reorg, Rewind call below will remove existing blocks from the index\n         // before adding the new one.\n         assert(best_block_index->GetAncestor(pindex->nHeight - 1) == pindex->pprev);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 67,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "8d0cc07587d4acfab3a8b4f636b631467c8e5f19",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: In commit 8d0cc07587d4acfab3a8b4f636b631467c8e5f19 why is this assertion not moved as well to `blockConnected`? Similarly the assertion in [here](https://github.com/bitcoin/bitcoin/pull/24230/commits/8d0cc07587d4acfab3a8b4f636b631467c8e5f19#diff-5251d93616c116c364d2d502ad2a59e901a3512194462fabacc9756f96fd8dddR394) in `IgnoreChainstateFlushed`.",
      "created_at": "2023-12-22T12:43:29Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1435025414",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1435025414"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 365,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1435719406",
      "pull_request_review_id": 1786770579,
      "id": 1435719406,
      "node_id": "PRRC_kwDOABII585Vk1bu",
      "diff_hunk": "@@ -217,17 +224,9 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n \n bool BlockFilterIndex::CustomAppend(const interfaces::BlockInfo& block)\n {\n-    CBlockUndo block_undo;\n     uint256 prev_header;\n \n     if (block.height > 0) {\n-        // pindex variable gives indexing code access to node internals. It\n-        // will be removed in upcoming commit\n-        const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_chainstate->m_blockman.LookupBlockIndex(block.hash));\n-        if (!m_chainstate->m_blockman.UndoReadFromDisk(block_undo, *pindex)) {\n-            return false;\n-        }\n-",
      "path": "src/index/blockfilterindex.cpp",
      "position": 48,
      "original_position": 28,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f2a0551eb8ec8e115778dde5b833a616461da9a4",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "NIt: In commit f2a0551eb8ec8e115778dde5b833a616461da9a4: Would it make sense to add an `assert(block.undo_data)` here? I think that could make the code here a bit clearer.",
      "created_at": "2023-12-23T22:06:25Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1435719406",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1435719406"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 237,
      "original_line": 237,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437507055",
      "pull_request_review_id": 1786770579,
      "id": 1437507055,
      "node_id": "PRRC_kwDOABII585Vrp3v",
      "diff_hunk": "@@ -195,10 +197,10 @@ void BaseIndex::ThreadSync()\n                 LOCK(cs_main);\n                 const CBlockIndex* pindex_next = NextSyncBlock(pindex, m_chainstate->m_chain);\n                 if (!pindex_next) {\n-                    m_best_block_index = pindex;\n-                    m_synced = true;\n-                    // No need to handle errors in Commit. See rationale above.\n-                    Commit(GetLocator(*m_chain, pindex->GetBlockHash()));\n+                    assert(pindex);\n+                    notifications->blockConnected(node::MakeBlockInfo(pindex));\n+                    assert(m_synced);\n+                    notifications->chainStateFlushed(GetLocator(*m_chain, pindex->GetBlockHash()));",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "e359c2666cfd205c2ea84c241bccf565670365c0",
      "in_reply_to_id": 803700112,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit 94fa723893a5acd2bdb69e859b76675f2d615b61: This still feels a bit convoluted. The way I read this, this now adds a call to `IgnoreChainstateFlushed`. Why not move the commit call to the new `blockConnected` code block as well?",
      "created_at": "2023-12-28T09:26:32Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1437507055",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437507055"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1438864128",
      "pull_request_review_id": 1786770579,
      "id": 1438864128,
      "node_id": "PRRC_kwDOABII585Vw1MA",
      "diff_hunk": "@@ -139,14 +155,64 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block_i\n     m_index.SetBestBlockIndex(pindex);\n }\n \n+void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block_info)\n+{\n+    // Make a mutable copy of the BlockInfo argument so block data can be\n+    // attached below. This is temporary and removed in upcoming commits.\n+    interfaces::BlockInfo block{block_info};\n+\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_ready && block.chain_tip) return;\n+\n+    const CBlockIndex* pindex = &m_index.BlockIndex(block.hash);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "8a164cf087c480e68e9ec87a97f759b97015efea",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: In commit 8a164cf087c480e68e9ec87a97f759b97015efea: I feel like this would be a bit more readable as a `CBlockIndex&`.",
      "created_at": "2023-12-31T10:56:27Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1438864128",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1438864128"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 168,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439019275",
      "pull_request_review_id": 1786770579,
      "id": 1439019275,
      "node_id": "PRRC_kwDOABII585VxbEL",
      "diff_hunk": "@@ -73,150 +226,86 @@ BaseIndex::BaseIndex(std::unique_ptr<interfaces::Chain> chain, std::string name)\n \n BaseIndex::~BaseIndex()\n {\n-    Interrupt();\n-    Stop();\n+    //! Assert Stop() was called before this base destructor. Notification\n+    //! handlers call pure virtual methods like GetName(), so if they are still\n+    //! being called at this point, they would segfault.\n+    LOCK(m_mutex);\n+    assert(!m_notifications);\n+    assert(!m_handler);\n }\n \n+// Read index best block, register for block connected and disconnected\n+// notifications, and determine where best block is relative to chain tip.\n+//\n+// If the chain tip and index best block are the same, block connected and\n+// disconnected notifications will be enabled after this call and the index will\n+// update as the ImportBlocks() function connects blocks and sends\n+// notifications. Otherwise, when the chain tip and index best block not the\n+// same, the index will stay idle until ImportBlocks() finishes and\n+// BaseIndex::StartBackgroundSync() is called after.\n+//\n+// If the node is being started for the first time, or if -reindex or\n+// -reindex-chainstate are used, the chain tip will be null at this point,\n+// meaning that no blocks are attached, even a genesis block. The best block\n+// locator will also be null if -reindex is used or if the index is new, but\n+// will be non-null if -reindex-chainstate is used. So -reindex will cause the\n+// index to be considered synced and rebuild right away as the chain is\n+// rebuilt, while -reindex-chainstate will cause the index to be idle until the\n+// chain is rebuilt and BaseIndex::StartBackgroundSync is called after.\n+//\n+// All of this just ensures that -reindex and -reindex-chainstate options both\n+// function efficiently. If -reindex is used, both the chainstate and index are\n+// wiped, and the index is considered synced right away and gets rebuilt at the\n+// same time as the chainstate. If -reindex-chainstate is used, only the\n+// chainstate is wiped, not the index, so the index will be considered not\n+// synced, and the chainstate will update first, and the index will start\n+// syncing after. So the most efficient thing should happen in both cases.\n bool BaseIndex::Init()\n {\n-    // m_chainstate member gives indexing code access to node internals. It is\n-    // removed in followup https://github.com/bitcoin/bitcoin/pull/24230\n-    m_chainstate = &m_chain->context()->chainman->ActiveChainstate();\n-    // Register to validation interface before setting the 'm_synced' flag, so that\n-    // callbacks are not missed once m_synced is true.\n-    RegisterValidationInterface(this);\n-\n     CBlockLocator locator;\n     if (!GetDB().ReadBestBlock(locator)) {\n         locator.SetNull();\n     }\n \n-    LOCK(cs_main);\n-    CChain& active_chain = m_chainstate->m_chain;\n-    if (locator.IsNull()) {\n-        SetBestBlockIndex(nullptr);\n-    } else {\n-        // Setting the best block to the locator's top block. If it is not part of the\n-        // best chain, we will rewind to the fork point during index sync\n-        const CBlockIndex* locator_index{m_chainstate->m_blockman.LookupBlockIndex(locator.vHave.at(0))};\n-        if (!locator_index) {\n-            return InitError(strprintf(Untranslated(\"%s: best block of the index not found. Please rebuild the index.\"), GetName()));\n+    auto options = CustomOptions();\n+    options.thread_name = GetName();\n+    auto notifications = std::make_shared<BaseIndexNotifications>(*this);\n+    auto start_sync = [&](const interfaces::BlockInfo& block) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 262,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "e09e18601db94107992dfb086c77081ffc5e01ec",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: Might `prepare_sync` (or something similar) be a better name for this lambda? The way it is named I would expect this to be the function that triggers the syncing to start, but that only happens once `StartBackgroundSync` is called.",
      "created_at": "2024-01-01T12:29:09Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439019275",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439019275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 273,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439029163",
      "pull_request_review_id": 1786770579,
      "id": 1439029163,
      "node_id": "PRRC_kwDOABII585Vxder",
      "diff_hunk": "@@ -184,17 +184,6 @@ void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& bloc\n     if (!m_rewind_start) m_rewind_start = pindex;\n     if (m_rewind_error) return;\n \n-    CBlock block_data;\n-    if (!block.data) {\n-        if (!m_index.m_chainstate->m_blockman.ReadBlockFromDisk(block_data, *pindex)) {\n-            m_index.FatalErrorf(\"%s: Failed to read block %s from disk\",\n-                        __func__, pindex->GetBlockHash().ToString());\n-            return;\n-        } else {\n-            block.data = &block_data;\n-        }\n-    }",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c60c735320694d124212a41e7e7a9d204ff35a6f",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: In commit c60c735320694d124212a41e7e7a9d204ff35a6f: Could add a `block.data` assertion at the top of the method?",
      "created_at": "2024-01-01T13:34:02Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439029163",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439029163"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 196,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439030135",
      "pull_request_review_id": 1786770579,
      "id": 1439030135,
      "node_id": "PRRC_kwDOABII585Vxdt3",
      "diff_hunk": "@@ -143,7 +143,7 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block_i\n         return;\n     }\n \n-    if (!block.chain_tip && (m_last_locator_write_time + SYNC_LOCATOR_WRITE_INTERVAL < current_time || m_index.m_interrupt)) {\n+    if (!block.chain_tip && (m_last_locator_write_time + SYNC_LOCATOR_WRITE_INTERVAL < current_time || WITH_LOCK(m_index.m_mutex, return !m_index.m_notifications.get()))) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c60c735320694d124212a41e7e7a9d204ff35a6f",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Just a question: Why call `get()` here? Is there a difference to `return !m_index.m_notifications`?",
      "created_at": "2024-01-01T13:41:05Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439030135",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439030135"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 146,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439064265",
      "pull_request_review_id": 1786770579,
      "id": 1439064265,
      "node_id": "PRRC_kwDOABII585VxmDJ",
      "diff_hunk": "@@ -24,4 +28,56 @@ interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* index, const CBlock* data\n     info.data = data;\n     return info;\n }\n+\n+bool SyncChain(node::BlockManager& blockman, const CChain& chain, const CBlockIndex* block, std::shared_ptr<interfaces::Chain::Notifications> notifications, const CThreadInterrupt& interrupt, std::function<void()> on_sync)",
      "path": "src/kernel/chain.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1664a63578941bafaa36d42f438e2e5cdac96583",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit 1664a63578941bafaa36d42f438e2e5cdac96583: Looking at this function, I am not sure why it is in the kernel namespace. More generally, I am confused by the responsibilities of this file in the first place. Seems like it could just be split up into `chain.cpp` and `node/interfaces.cpp`? Is it weird that a kernel file includes `interfaces/chain.h`? That seems like a higher order include to me that the kernel should not need to know of.",
      "created_at": "2024-01-01T17:44:40Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439064265",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439064265"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 54,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439361568",
      "pull_request_review_id": 1786770579,
      "id": 1439361568,
      "node_id": "PRRC_kwDOABII585Vyuog",
      "diff_hunk": "@@ -5,15 +5,38 @@\n #ifndef BITCOIN_KERNEL_CHAIN_H\n #define BITCOIN_KERNEL_CHAIN_H\n \n+#include <interfaces/chain.h>\n+\n+#include <functional>\n+\n class CBlock;\n class CBlockIndex;\n-namespace interfaces {\n-struct BlockInfo;\n-} // namespace interfaces\n+class CChain;\n+class CThreadInterrupt;\n+namespace node {\n+class BlockManager;\n+} // namespace node\n \n namespace kernel {\n //! Return data from block index.\n interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* block_index, const CBlock* data = nullptr);\n+\n+//! Send blockConnected and blockDisconnected notifications needed to sync from\n+//! a specified block to the chain tip. This sync function locks the ::cs_main\n+//! mutex intermittently, releasing it while sending notifications and reading\n+//! block data, so it follows the tip if the tip changes, and follows any\n+//! reorgs.\n+//!\n+//! @param chain - chain to sync to\n+//! @param block - starting block to sync from\n+//! @param notifications - object to send notifications to\n+//! @param interrupt - flag to interrupt the sync\n+//! @param on_sync - optional callback invoked when reaching the chain tip\n+//!                  while cs_main is still held, before sending a final\n+//!                  blockConnected notification. This can be used to\n+//!                  synchronously register for new notifications.\n+//! @return true if synced, false if interrupted\n+bool SyncChain(node::BlockManager& blockman, const CChain& chain, const CBlockIndex* block, std::shared_ptr<interfaces::Chain::Notifications> notifications, const CThreadInterrupt& interrupt, std::function<void()> on_sync);",
      "path": "src/kernel/chain.h",
      "position": null,
      "original_position": 38,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1664a63578941bafaa36d42f438e2e5cdac96583",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit 1664a63578941bafaa36d42f438e2e5cdac96583: The return type of `SyncChain` is unused. Are there future plans to use it, or could it be made `void`?",
      "created_at": "2024-01-02T11:24:34Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439361568",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439361568"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 43,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439392454",
      "pull_request_review_id": 1786770579,
      "id": 1439392454,
      "node_id": "PRRC_kwDOABII585Vy2LG",
      "diff_hunk": "@@ -786,6 +781,12 @@ class ChainImpl : public Chain\n     }\n     std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options, const StartSyncFn& start_sync) override\n     {\n+        std::unique_ptr<NotificationsHandlerImpl> handler;\n+        std::optional<interfaces::BlockInfo> start_block;",
      "path": "src/node/interfaces.cpp",
      "position": 184,
      "original_position": 45,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c8fde60faad36d454cdd1300184a5169499f9e90",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why is `start_block` moved here?",
      "created_at": "2024-01-02T12:08:49Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439392454",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439392454"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 833,
      "original_line": 833,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439486956",
      "pull_request_review_id": 1786770579,
      "id": 1439486956,
      "node_id": "PRRC_kwDOABII585VzNPs",
      "diff_hunk": "@@ -805,19 +806,41 @@ class ChainImpl : public Chain\n         LOCK(cs_main);\n         const Chainstate& active{chainman().ActiveChainstate()};\n         const CBlockIndex* start_block_index{locator.IsNull() ? nullptr : active.m_blockman.LookupBlockIndex(locator.vHave.at(0))};\n-        interfaces::BlockInfo start_block{kernel::MakeBlockInfo(start_block_index)};\n-        start_block.chain_tip = start_block_index == active.m_chain.Tip();\n-        if (!start_sync(start_block)) return nullptr;\n-        auto handler = std::make_unique<NotificationsHandlerImpl>(notifications, options);\n-        if (start_block.chain_tip) {\n-            CallFunctionInValidationInterfaceQueue([proxy = handler->m_proxy] { NotificationsProxy::connect(proxy); });\n-        } else {\n-            handler->m_sync_fn = [this, &active, start_block_index, notifications] (std::shared_ptr<NotificationsProxy> proxy, const CThreadInterrupt& interrupt) {\n-                kernel::SyncChain(chainman().m_blockman, active.m_chain, start_block_index, notifications, interrupt,\n-                                  /*on_sync=*/[proxy] { CallFunctionInValidationInterfaceQueue([proxy] { NotificationsProxy::connect(proxy); }); });\n-            };\n+        start_block.emplace(kernel::MakeBlockInfo(start_block_index));\n+        start_block->chain_tip = start_block_index == active.m_chain.Tip();\n+        handler = std::make_unique<NotificationsHandlerImpl>(notifications, options);\n+        // Start a separate thread to avoid holding cs_main while start_sync is called,\n+        // and to read previous blocks if start_block is not the chain tip.\n+        assert(!handler->m_sync_thread.joinable());\n+        handler->m_sync_thread = std::thread(&util::TraceThread, handler->m_proxy->m_options.thread_name,\n+            [this, &start_sync, &start_block, &promise, &active, start_block_index, notifications, handler = handler.get()] {\n+            if (!start_sync(*start_block)) {\n+                promise.set_value(false);\n+                return;\n+            }\n+            const bool synced{start_block->chain_tip};\n+            promise.set_value(true);\n+            if (!synced) {\n+                // If not synced, sleep until Handler start() method is called\n+                // to start reading blocks. The sleep is necessary to support\n+                // -reindex and -reindex-chainstate cases efficiently. In the\n+                // -reindex case, it is most efficient for indexes to receive\n+                // block connected notification as blocks are connected, so the\n+                // attachChain method needs to be called before the ImportBlocks\n+                // function runs. But in the reindex-chainstate case, since\n+                // chainstate data is wiped but indexes are not wiped, it is\n+                // most efficient for indexes to begin syncing after the\n+                // ImportBlocks function finishes, so the following sleep waits\n+                // for that to happen.\n+                while (handler->m_start.sleep_for(std::chrono::hours(1)));",
      "path": "src/node/interfaces.cpp",
      "position": 234,
      "original_position": 94,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c8fde60faad36d454cdd1300184a5169499f9e90",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit c8fde60faad36d454cdd1300184a5169499f9e90: Why is this sleep limited to one hour? I get that `ImportBlocks` should finish within reasonable time, but what if it doesn't?",
      "created_at": "2024-01-02T14:14:40Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439486956",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439486956"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 883,
      "original_line": 883,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440204199",
      "pull_request_review_id": 1786770579,
      "id": 1440204199,
      "node_id": "PRRC_kwDOABII585V18Wn",
      "diff_hunk": "@@ -361,31 +381,31 @@ IndexSummary BaseIndex::GetSummary() const\n     IndexSummary summary{};\n     summary.name = GetName();\n     summary.synced = m_synced;\n-    if (const auto& pindex = m_best_block_index.load()) {\n-        summary.best_block_height = pindex->nHeight;\n-        summary.best_block_hash = pindex->GetBlockHash();\n+    if (const auto best_block = WITH_LOCK(m_mutex, return m_best_block)) {\n+        summary.best_block_height = best_block->height;\n+        summary.best_block_hash = best_block->hash;\n     } else {\n         summary.best_block_height = 0;\n         summary.best_block_hash = m_chain->getBlockHash(0);\n     }\n     return summary;\n }\n \n-void BaseIndex::SetBestBlockIndex(const CBlockIndex* block)\n+void BaseIndex::SetBestBlock(const std::optional<interfaces::BlockKey>& block)\n {\n     assert(!m_chainstate->m_blockman.IsPruneMode() || AllowPrune());\n \n-    if (AllowPrune() && block) {\n+    if (block && AllowPrune()) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 180,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "53a96c1ce706e5375aab6765dbcf2754baa6adf1",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: In commit 53a96c1ce706e5375aab6765dbcf2754baa6adf1:  Change not needed?",
      "created_at": "2024-01-03T08:54:23Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1440204199",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440204199"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 398,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440233448",
      "pull_request_review_id": 1786770579,
      "id": 1440233448,
      "node_id": "PRRC_kwDOABII585V2Dfo",
      "diff_hunk": "@@ -312,14 +332,14 @@ bool BaseIndex::BlockUntilSyncedToCurrentChain() const\n         return false;\n     }\n \n-    if (const CBlockIndex* index = m_best_block_index.load()) {\n-        interfaces::BlockKey best_block{index->GetBlockHash(), index->nHeight};\n+    const auto best_block = WITH_LOCK(m_mutex, return m_best_block);\n+    if (best_block) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 146,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "53a96c1ce706e5375aab6765dbcf2754baa6adf1",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: In commit 53a96c1ce706e5375aab6765dbcf2754baa6adf1: Could just assign in the `if` block as done below.",
      "created_at": "2024-01-03T09:27:03Z",
      "updated_at": "2024-01-03T10:45:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1440233448",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440233448"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 336,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523566547",
      "pull_request_review_id": 1934647017,
      "id": 1523566547,
      "node_id": "PRRC_kwDOABII585az8fT",
      "diff_hunk": "@@ -77,6 +77,32 @@ BaseIndex::~BaseIndex()\n     Stop();\n }\n \n+// Read index best block, register for block connected and disconnected\n+// notifications, and determine where best block is relative to chain tip.\n+//\n+// If the chain tip and index best block are the same, block connected and\n+// disconnected notifications will be enabled after this call and the index will\n+// update as the ImportBlocks() function connects blocks and sends\n+// notifications. Otherwise, when the chain tip and index best block not the",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "b4328dc89cc4e287965587be0f02c72a511c2a63",
      "in_reply_to_id": 1430067474,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1430067474\r\n\r\n> Nit: `s/best block not the same/best block are not the same/`\r\n\r\nThanks, fixed",
      "created_at": "2024-03-13T16:20:14Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523566547",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523566547"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 86,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523566862",
      "pull_request_review_id": 1934647017,
      "id": 1523566862,
      "node_id": "PRRC_kwDOABII585az8kO",
      "diff_hunk": "@@ -73,150 +226,86 @@ BaseIndex::BaseIndex(std::unique_ptr<interfaces::Chain> chain, std::string name)\n \n BaseIndex::~BaseIndex()\n {\n-    Interrupt();\n-    Stop();\n+    //! Assert Stop() was called before this base destructor. Notification\n+    //! handlers call pure virtual methods like GetName(), so if they are still\n+    //! being called at this point, they would segfault.\n+    LOCK(m_mutex);\n+    assert(!m_notifications);\n+    assert(!m_handler);\n }\n \n+// Read index best block, register for block connected and disconnected\n+// notifications, and determine where best block is relative to chain tip.\n+//\n+// If the chain tip and index best block are the same, block connected and\n+// disconnected notifications will be enabled after this call and the index will\n+// update as the ImportBlocks() function connects blocks and sends\n+// notifications. Otherwise, when the chain tip and index best block not the\n+// same, the index will stay idle until ImportBlocks() finishes and\n+// BaseIndex::StartBackgroundSync() is called after.\n+//\n+// If the node is being started for the first time, or if -reindex or\n+// -reindex-chainstate are used, the chain tip will be null at this point,\n+// meaning that no blocks are attached, even a genesis block. The best block\n+// locator will also be null if -reindex is used or if the index is new, but\n+// will be non-null if -reindex-chainstate is used. So -reindex will cause the\n+// index to be considered synced and rebuild right away as the chain is\n+// rebuilt, while -reindex-chainstate will cause the index to be idle until the\n+// chain is rebuilt and BaseIndex::StartBackgroundSync is called after.\n+//\n+// All of this just ensures that -reindex and -reindex-chainstate options both\n+// function efficiently. If -reindex is used, both the chainstate and index are\n+// wiped, and the index is considered synced right away and gets rebuilt at the\n+// same time as the chainstate. If -reindex-chainstate is used, only the\n+// chainstate is wiped, not the index, so the index will be considered not\n+// synced, and the chainstate will update first, and the index will start\n+// syncing after. So the most efficient thing should happen in both cases.\n bool BaseIndex::Init()\n {\n-    // m_chainstate member gives indexing code access to node internals. It is\n-    // removed in followup https://github.com/bitcoin/bitcoin/pull/24230\n-    m_chainstate = &m_chain->context()->chainman->ActiveChainstate();\n-    // Register to validation interface before setting the 'm_synced' flag, so that\n-    // callbacks are not missed once m_synced is true.\n-    RegisterValidationInterface(this);\n-\n     CBlockLocator locator;\n     if (!GetDB().ReadBestBlock(locator)) {\n         locator.SetNull();\n     }\n \n-    LOCK(cs_main);\n-    CChain& active_chain = m_chainstate->m_chain;\n-    if (locator.IsNull()) {\n-        SetBestBlockIndex(nullptr);\n-    } else {\n-        // Setting the best block to the locator's top block. If it is not part of the\n-        // best chain, we will rewind to the fork point during index sync\n-        const CBlockIndex* locator_index{m_chainstate->m_blockman.LookupBlockIndex(locator.vHave.at(0))};\n-        if (!locator_index) {\n-            return InitError(strprintf(Untranslated(\"%s: best block of the index not found. Please rebuild the index.\"), GetName()));\n+    auto options = CustomOptions();\n+    options.thread_name = GetName();\n+    auto notifications = std::make_shared<BaseIndexNotifications>(*this);\n+    auto start_sync = [&](const interfaces::BlockInfo& block) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 262,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "e09e18601db94107992dfb086c77081ffc5e01ec",
      "in_reply_to_id": 1439019275,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439019275\r\n\r\n> Nit: Might `prepare_sync` (or something similar) be a better name for this lambda? The way it is named I would expect this to be the function that triggers the syncing to start, but that only happens once `StartBackgroundSync` is called.\r\n\r\nNice suggestion, renamed this everywhere. \"Start\" functions are often used to start threads or other asynchronous tasks, but this callback is completely synchronous so \"prepare\" is a better name.",
      "created_at": "2024-03-13T16:20:28Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523566862",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523566862"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 273,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523567456",
      "pull_request_review_id": 1934647017,
      "id": 1523567456,
      "node_id": "PRRC_kwDOABII585az8tg",
      "diff_hunk": "@@ -312,14 +332,14 @@ bool BaseIndex::BlockUntilSyncedToCurrentChain() const\n         return false;\n     }\n \n-    if (const CBlockIndex* index = m_best_block_index.load()) {\n-        interfaces::BlockKey best_block{index->GetBlockHash(), index->nHeight};\n+    const auto best_block = WITH_LOCK(m_mutex, return m_best_block);\n+    if (best_block) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 146,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "53a96c1ce706e5375aab6765dbcf2754baa6adf1",
      "in_reply_to_id": 1440233448,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1440233448\r\n\r\n> Nit: In commit [53a96c1](https://github.com/bitcoin/bitcoin/commit/53a96c1ce706e5375aab6765dbcf2754baa6adf1): Could just assign in the `if` block as done below.\r\n\r\nThanks, implemented this.",
      "created_at": "2024-03-13T16:20:54Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523567456",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523567456"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 336,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523567785",
      "pull_request_review_id": 1934647017,
      "id": 1523567785,
      "node_id": "PRRC_kwDOABII585az8yp",
      "diff_hunk": "@@ -361,31 +381,31 @@ IndexSummary BaseIndex::GetSummary() const\n     IndexSummary summary{};\n     summary.name = GetName();\n     summary.synced = m_synced;\n-    if (const auto& pindex = m_best_block_index.load()) {\n-        summary.best_block_height = pindex->nHeight;\n-        summary.best_block_hash = pindex->GetBlockHash();\n+    if (const auto best_block = WITH_LOCK(m_mutex, return m_best_block)) {\n+        summary.best_block_height = best_block->height;\n+        summary.best_block_hash = best_block->hash;\n     } else {\n         summary.best_block_height = 0;\n         summary.best_block_hash = m_chain->getBlockHash(0);\n     }\n     return summary;\n }\n \n-void BaseIndex::SetBestBlockIndex(const CBlockIndex* block)\n+void BaseIndex::SetBestBlock(const std::optional<interfaces::BlockKey>& block)\n {\n     assert(!m_chainstate->m_blockman.IsPruneMode() || AllowPrune());\n \n-    if (AllowPrune() && block) {\n+    if (block && AllowPrune()) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 180,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "53a96c1ce706e5375aab6765dbcf2754baa6adf1",
      "in_reply_to_id": 1440204199,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1440204199\r\n\r\n> Nit: In commit [53a96c1](https://github.com/bitcoin/bitcoin/commit/53a96c1ce706e5375aab6765dbcf2754baa6adf1): Change not needed?\r\n\r\nReverted, not sure where this came from.",
      "created_at": "2024-03-13T16:21:08Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523567785",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523567785"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 398,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523568169",
      "pull_request_review_id": 1934647017,
      "id": 1523568169,
      "node_id": "PRRC_kwDOABII585az84p",
      "diff_hunk": "@@ -217,17 +224,9 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n \n bool BlockFilterIndex::CustomAppend(const interfaces::BlockInfo& block)\n {\n-    CBlockUndo block_undo;\n     uint256 prev_header;\n \n     if (block.height > 0) {\n-        // pindex variable gives indexing code access to node internals. It\n-        // will be removed in upcoming commit\n-        const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_chainstate->m_blockman.LookupBlockIndex(block.hash));\n-        if (!m_chainstate->m_blockman.UndoReadFromDisk(block_undo, *pindex)) {\n-            return false;\n-        }\n-",
      "path": "src/index/blockfilterindex.cpp",
      "position": 48,
      "original_position": 28,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "f2a0551eb8ec8e115778dde5b833a616461da9a4",
      "in_reply_to_id": 1435719406,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1435719406\r\n\r\n> NIt: In commit [f2a0551](https://github.com/bitcoin/bitcoin/commit/f2a0551eb8ec8e115778dde5b833a616461da9a4): Would it make sense to add an `assert(block.undo_data)` here? I think that could make the code here a bit clearer.\r\n\r\nGood suggestion, added",
      "created_at": "2024-03-13T16:21:25Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523568169",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523568169"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 237,
      "original_line": 237,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523568402",
      "pull_request_review_id": 1934647017,
      "id": 1523568402,
      "node_id": "PRRC_kwDOABII585az88S",
      "diff_hunk": "@@ -285,15 +285,15 @@ static bool CopyHeightIndexToHashIndex(CDBIterator& db_it, CDBBatch& batch,\n     return true;\n }\n \n-bool BlockFilterIndex::CustomRewind(const interfaces::BlockKey& current_tip, const interfaces::BlockKey& new_tip)\n+bool BlockFilterIndex::CustomRemove(const interfaces::BlockInfo& block)\n {\n     CDBBatch batch(*m_db);\n     std::unique_ptr<CDBIterator> db_it(m_db->NewIterator());\n \n     // During a reorg, we need to copy all filters for blocks that are getting disconnected from the\n     // height index to the hash index so we can still find them when the height index entries are\n     // overwritten.\n-    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, new_tip.height, current_tip.height)) {\n+    if (!CopyHeightIndexToHashIndex(*db_it, batch, m_name, block.height - 1, block.height)) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": 81,
      "original_position": 14,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "d260abb89101a2a206ab3b86990a3c4518ae1508",
      "in_reply_to_id": 1307972744,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1307972744\r\n\r\n> In [d260abb](https://github.com/bitcoin/bitcoin/commit/d260abb89101a2a206ab3b86990a3c4518ae1508):\r\n> \r\n> Note: now that only one block per `CustomRemove` call is rewinded, we could simplify the loop inside `CopyHeightIndexToHashIndex()`.\r\n\r\nThis is true, I think I would leave it for a possible followup though since it seems like a bigger diff for a smaller simplification.",
      "created_at": "2024-03-13T16:21:35Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523568402",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523568402"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 313,
      "original_line": 313,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523569630",
      "pull_request_review_id": 1934647017,
      "id": 1523569630,
      "node_id": "PRRC_kwDOABII585az9Pe",
      "diff_hunk": "@@ -24,4 +28,56 @@ interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* index, const CBlock* data\n     info.data = data;\n     return info;\n }\n+\n+bool SyncChain(node::BlockManager& blockman, const CChain& chain, const CBlockIndex* block, std::shared_ptr<interfaces::Chain::Notifications> notifications, const CThreadInterrupt& interrupt, std::function<void()> on_sync)",
      "path": "src/kernel/chain.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1664a63578941bafaa36d42f438e2e5cdac96583",
      "in_reply_to_id": 1439064265,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439064265\r\n\r\n> In commit [1664a63](https://github.com/bitcoin/bitcoin/commit/1664a63578941bafaa36d42f438e2e5cdac96583): Looking at this function, I am not sure why it is in the kernel namespace. More generally, I am confused by the responsibilities of this file in the first place. Seems like it could just be split up into `chain.cpp` and `node/interfaces.cpp`? Is it weird that a kernel file includes `interfaces/chain.h`? That seems like a higher order include to me that the kernel should not need to know of.\r\n\r\nYes, this should be cleaned up, but I might wait for #29015 to do it. #29015 adds src/common/types.h and src/node/types.h files, and I think it would make sense to move the BlockInfo to src/node/types.h and move MakeBlockInfo() and SyncChain() functions to src/node/chain.cpp.\r\n\r\nWhen I was first implementing this PR, the SyncChain() method seemed like a general purpose method that would be useful to include in libbitcoinkernel for syncing external state starting at an old block to the current chain tip. This could be useful for wallets, indexes, or anything else storing data related to the chain. But in retrospect it drags in a few dependencies to the kernel which are probably not worth having. It might make sense to add to the kernel later if we saw applications that could benefit from this functionality. But there isn't much reason to add it preemptively.",
      "created_at": "2024-03-13T16:22:24Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523569630",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523569630"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 54,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523570118",
      "pull_request_review_id": 1934647017,
      "id": 1523570118,
      "node_id": "PRRC_kwDOABII585az9XG",
      "diff_hunk": "@@ -5,15 +5,38 @@\n #ifndef BITCOIN_KERNEL_CHAIN_H\n #define BITCOIN_KERNEL_CHAIN_H\n \n+#include <interfaces/chain.h>\n+\n+#include <functional>\n+\n class CBlock;\n class CBlockIndex;\n-namespace interfaces {\n-struct BlockInfo;\n-} // namespace interfaces\n+class CChain;\n+class CThreadInterrupt;\n+namespace node {\n+class BlockManager;\n+} // namespace node\n \n namespace kernel {\n //! Return data from block index.\n interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* block_index, const CBlock* data = nullptr);\n+\n+//! Send blockConnected and blockDisconnected notifications needed to sync from\n+//! a specified block to the chain tip. This sync function locks the ::cs_main\n+//! mutex intermittently, releasing it while sending notifications and reading\n+//! block data, so it follows the tip if the tip changes, and follows any\n+//! reorgs.\n+//!\n+//! @param chain - chain to sync to\n+//! @param block - starting block to sync from\n+//! @param notifications - object to send notifications to\n+//! @param interrupt - flag to interrupt the sync\n+//! @param on_sync - optional callback invoked when reaching the chain tip\n+//!                  while cs_main is still held, before sending a final\n+//!                  blockConnected notification. This can be used to\n+//!                  synchronously register for new notifications.\n+//! @return true if synced, false if interrupted\n+bool SyncChain(node::BlockManager& blockman, const CChain& chain, const CBlockIndex* block, std::shared_ptr<interfaces::Chain::Notifications> notifications, const CThreadInterrupt& interrupt, std::function<void()> on_sync);",
      "path": "src/kernel/chain.h",
      "position": null,
      "original_position": 38,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "1664a63578941bafaa36d42f438e2e5cdac96583",
      "in_reply_to_id": 1439361568,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439361568\r\n\r\n> In commit [1664a63](https://github.com/bitcoin/bitcoin/commit/1664a63578941bafaa36d42f438e2e5cdac96583): The return type of `SyncChain` is unused. Are there future plans to use it, or could it be made `void`?\r\n\r\nIt could be made void, but I would be uncomfortable doing this because I think callers should be able to determine if a call was interrupted without having to check a separate interrupt variable. In general I think it's good if functions return information about interrupt status when they can, so we don't wind up with the kind of bad error handling #29642 tries to solve.\r\n\r\nIt is true that attachChain wrapper around SyncChain is not using the return value and not returning an interrupt status itself, but that is because attachChain is starting a thread, and can't return the interrupt status in all cases, so it doesn't try to return it in any case. But SyncChain is synchronous and can return the interrupt status in all cases, so I think it should.",
      "created_at": "2024-03-13T16:22:44Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523570118",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523570118"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 43,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523570374",
      "pull_request_review_id": 1934647017,
      "id": 1523570374,
      "node_id": "PRRC_kwDOABII585az9bG",
      "diff_hunk": "@@ -786,6 +781,12 @@ class ChainImpl : public Chain\n     }\n     std::unique_ptr<Handler> attachChain(std::shared_ptr<Notifications> notifications, const CBlockLocator& locator, const NotifyOptions& options, const StartSyncFn& start_sync) override\n     {\n+        std::unique_ptr<NotificationsHandlerImpl> handler;\n+        std::optional<interfaces::BlockInfo> start_block;",
      "path": "src/node/interfaces.cpp",
      "position": 184,
      "original_position": 45,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c8fde60faad36d454cdd1300184a5169499f9e90",
      "in_reply_to_id": 1439392454,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439392454\r\n\r\n> Why is `start_block` moved here?\r\n\r\nstart_block variable needs to live until the promise.set_value call below, but after that it can be destroyed, so it is declared right above the promise.",
      "created_at": "2024-03-13T16:22:54Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523570374",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523570374"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 833,
      "original_line": 833,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523570619",
      "pull_request_review_id": 1934647017,
      "id": 1523570619,
      "node_id": "PRRC_kwDOABII585az9e7",
      "diff_hunk": "@@ -805,19 +806,41 @@ class ChainImpl : public Chain\n         LOCK(cs_main);\n         const Chainstate& active{chainman().ActiveChainstate()};\n         const CBlockIndex* start_block_index{locator.IsNull() ? nullptr : active.m_blockman.LookupBlockIndex(locator.vHave.at(0))};\n-        interfaces::BlockInfo start_block{kernel::MakeBlockInfo(start_block_index)};\n-        start_block.chain_tip = start_block_index == active.m_chain.Tip();\n-        if (!start_sync(start_block)) return nullptr;\n-        auto handler = std::make_unique<NotificationsHandlerImpl>(notifications, options);\n-        if (start_block.chain_tip) {\n-            CallFunctionInValidationInterfaceQueue([proxy = handler->m_proxy] { NotificationsProxy::connect(proxy); });\n-        } else {\n-            handler->m_sync_fn = [this, &active, start_block_index, notifications] (std::shared_ptr<NotificationsProxy> proxy, const CThreadInterrupt& interrupt) {\n-                kernel::SyncChain(chainman().m_blockman, active.m_chain, start_block_index, notifications, interrupt,\n-                                  /*on_sync=*/[proxy] { CallFunctionInValidationInterfaceQueue([proxy] { NotificationsProxy::connect(proxy); }); });\n-            };\n+        start_block.emplace(kernel::MakeBlockInfo(start_block_index));\n+        start_block->chain_tip = start_block_index == active.m_chain.Tip();\n+        handler = std::make_unique<NotificationsHandlerImpl>(notifications, options);\n+        // Start a separate thread to avoid holding cs_main while start_sync is called,\n+        // and to read previous blocks if start_block is not the chain tip.\n+        assert(!handler->m_sync_thread.joinable());\n+        handler->m_sync_thread = std::thread(&util::TraceThread, handler->m_proxy->m_options.thread_name,\n+            [this, &start_sync, &start_block, &promise, &active, start_block_index, notifications, handler = handler.get()] {\n+            if (!start_sync(*start_block)) {\n+                promise.set_value(false);\n+                return;\n+            }\n+            const bool synced{start_block->chain_tip};\n+            promise.set_value(true);\n+            if (!synced) {\n+                // If not synced, sleep until Handler start() method is called\n+                // to start reading blocks. The sleep is necessary to support\n+                // -reindex and -reindex-chainstate cases efficiently. In the\n+                // -reindex case, it is most efficient for indexes to receive\n+                // block connected notification as blocks are connected, so the\n+                // attachChain method needs to be called before the ImportBlocks\n+                // function runs. But in the reindex-chainstate case, since\n+                // chainstate data is wiped but indexes are not wiped, it is\n+                // most efficient for indexes to begin syncing after the\n+                // ImportBlocks function finishes, so the following sleep waits\n+                // for that to happen.\n+                while (handler->m_start.sleep_for(std::chrono::hours(1)));",
      "path": "src/node/interfaces.cpp",
      "position": 234,
      "original_position": 94,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c8fde60faad36d454cdd1300184a5169499f9e90",
      "in_reply_to_id": 1439486956,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439486956\r\n\r\n> In commit [c8fde60](https://github.com/bitcoin/bitcoin/commit/c8fde60faad36d454cdd1300184a5169499f9e90): Why is this sleep limited to one hour? I get that `ImportBlocks` should finish within reasonable time, but what if it doesn't?\r\n\r\nThis is just meant to wait forever, and the thread interrupt class, unlike the signal interrupt class doesn't have a `wait()` method that doesn't require a timeout value. I think this just needs to wait however long ImportBlocks takes, and there is not something better to be done here other than waiting for it.",
      "created_at": "2024-03-13T16:23:05Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523570619",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523570619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 883,
      "original_line": 883,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523573876",
      "pull_request_review_id": 1934647017,
      "id": 1523573876,
      "node_id": "PRRC_kwDOABII585az-R0",
      "diff_hunk": "@@ -338,30 +363,14 @@ void BaseIndex::BlockConnected(const interfaces::BlockInfo& block_info)\n         // reorg, Rewind call below will remove existing blocks from the index\n         // before adding the new one.\n         assert(best_block_index->GetAncestor(pindex->nHeight - 1) == pindex->pprev);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 67,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "8d0cc07587d4acfab3a8b4f636b631467c8e5f19",
      "in_reply_to_id": 1435025414,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1435025414\r\n\r\n> Nit: In commit [8d0cc07](https://github.com/bitcoin/bitcoin/commit/8d0cc07587d4acfab3a8b4f636b631467c8e5f19) why is this assertion not moved as well to `blockConnected`? Similarly the assertion in [here](https://github.com/bitcoin/bitcoin/pull/24230/commits/8d0cc07587d4acfab3a8b4f636b631467c8e5f19#diff-5251d93616c116c364d2d502ad2a59e901a3512194462fabacc9756f96fd8dddR394) in `IgnoreChainstateFlushed`.\r\n\r\nThis commit is moving code from BaseIndex::BlockConnected to BaseIndexNotifications::blockConnected and from BaseIndex::ChainStateFlushed to BaseIndexNotifications::blockConnected.\r\n\r\nThe code that is being moved is the code that will be kept in the new methods and deals with updating the index state.\r\n\r\nThe code that is not being moved is code that will be deleted later (in commit \"Rewrite chain sync logic, remove racy init\") and deals with ignoring spurious notification.\r\n\r\nThe asserts could be moved here but it would make the diff bigger for no reason.\r\n\r\nIn general, the PR is removing all code from src/index that deals with CBlockIndex pointers, and changing the code as little as possible before removing it.",
      "created_at": "2024-03-13T16:25:19Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523573876",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523573876"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 365,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523574541",
      "pull_request_review_id": 1934647017,
      "id": 1523574541,
      "node_id": "PRRC_kwDOABII585az-cN",
      "diff_hunk": "@@ -195,10 +197,10 @@ void BaseIndex::ThreadSync()\n                 LOCK(cs_main);\n                 const CBlockIndex* pindex_next = NextSyncBlock(pindex, m_chainstate->m_chain);\n                 if (!pindex_next) {\n-                    m_best_block_index = pindex;\n-                    m_synced = true;\n-                    // No need to handle errors in Commit. See rationale above.\n-                    Commit(GetLocator(*m_chain, pindex->GetBlockHash()));\n+                    assert(pindex);\n+                    notifications->blockConnected(node::MakeBlockInfo(pindex));\n+                    assert(m_synced);\n+                    notifications->chainStateFlushed(GetLocator(*m_chain, pindex->GetBlockHash()));",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "e359c2666cfd205c2ea84c241bccf565670365c0",
      "in_reply_to_id": 803700112,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1437507055\r\n\r\n> In commit [94fa723](https://github.com/bitcoin/bitcoin/commit/94fa723893a5acd2bdb69e859b76675f2d615b61): This still feels a bit convoluted. The way I read this, this now adds a call to `IgnoreChainstateFlushed`. Why not move the commit call to the new `blockConnected` code block as well?\r\n\r\nThe point of index blockConnected method is to add new data from blocks to the index, and the point of the chainStateFlushed method is to commit updated state to the database. In this one specific place, blockConnected and chainStateFlushed method are both called together, but normally they are called separately, so committing index data in blockConnected would be change in behavior and bad for performance. \r\n\r\nIt is true that adding a call to chainStateFlushed here goes through IgnoreChainstateFlushed logic instead of committing unconditionally, and this adds some temporary complexity. But the ignore method is dropped later, and ultimately indexing code becomes simpler because it no longer has to have special case code dealing with syncing. It can handle block connected and flush events the same whether it is in the sync phase or not.",
      "created_at": "2024-03-13T16:25:46Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523574541",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523574541"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523574809",
      "pull_request_review_id": 1934647017,
      "id": 1523574809,
      "node_id": "PRRC_kwDOABII585az-gZ",
      "diff_hunk": "@@ -139,14 +155,64 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block_i\n     m_index.SetBestBlockIndex(pindex);\n }\n \n+void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& block_info)\n+{\n+    // Make a mutable copy of the BlockInfo argument so block data can be\n+    // attached below. This is temporary and removed in upcoming commits.\n+    interfaces::BlockInfo block{block_info};\n+\n+    // During initial sync, ignore validation interface notifications, only\n+    // process notifications from sync thread.\n+    if (!m_index.m_ready && block.chain_tip) return;\n+\n+    const CBlockIndex* pindex = &m_index.BlockIndex(block.hash);",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "8a164cf087c480e68e9ec87a97f759b97015efea",
      "in_reply_to_id": 1438864128,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1438864128\r\n\r\n> Nit: In commit [8a164cf](https://github.com/bitcoin/bitcoin/commit/8a164cf087c480e68e9ec87a97f759b97015efea): I feel like this would be a bit more readable as a `CBlockIndex&`.\r\n\r\nA thing to keep in mind is that this PR removes all CBlockIndex references from indexing code, so this code is temporary and won't last for long.\r\n\r\nThe old \"pindex\" variables are being replaced with new \"block\" variable, so it's actually convenient that old code and new code are written in different styles and their names don't clash. If I would try to write old code in a newer style, I think it would just be more name clashes.",
      "created_at": "2024-03-13T16:25:58Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523574809",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523574809"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 168,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523575439",
      "pull_request_review_id": 1934647017,
      "id": 1523575439,
      "node_id": "PRRC_kwDOABII585az-qP",
      "diff_hunk": "@@ -184,17 +184,6 @@ void BaseIndexNotifications::blockDisconnected(const interfaces::BlockInfo& bloc\n     if (!m_rewind_start) m_rewind_start = pindex;\n     if (m_rewind_error) return;\n \n-    CBlock block_data;\n-    if (!block.data) {\n-        if (!m_index.m_chainstate->m_blockman.ReadBlockFromDisk(block_data, *pindex)) {\n-            m_index.FatalErrorf(\"%s: Failed to read block %s from disk\",\n-                        __func__, pindex->GetBlockHash().ToString());\n-            return;\n-        } else {\n-            block.data = &block_data;\n-        }\n-    }",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c60c735320694d124212a41e7e7a9d204ff35a6f",
      "in_reply_to_id": 1439029163,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439029163\r\n\r\n> Nit: In commit [c60c735](https://github.com/bitcoin/bitcoin/commit/c60c735320694d124212a41e7e7a9d204ff35a6f): Could add a `block.data` assertion at the top of the method?\r\n\r\nGood idea, added.",
      "created_at": "2024-03-13T16:26:25Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523575439",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523575439"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 196,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523575703",
      "pull_request_review_id": 1934647017,
      "id": 1523575703,
      "node_id": "PRRC_kwDOABII585az-uX",
      "diff_hunk": "@@ -143,7 +143,7 @@ void BaseIndexNotifications::blockConnected(const interfaces::BlockInfo& block_i\n         return;\n     }\n \n-    if (!block.chain_tip && (m_last_locator_write_time + SYNC_LOCATOR_WRITE_INTERVAL < current_time || m_index.m_interrupt)) {\n+    if (!block.chain_tip && (m_last_locator_write_time + SYNC_LOCATOR_WRITE_INTERVAL < current_time || WITH_LOCK(m_index.m_mutex, return !m_index.m_notifications.get()))) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "38c93e6a8e573dbdf3fc4d14be7483961e18a576",
      "original_commit_id": "c60c735320694d124212a41e7e7a9d204ff35a6f",
      "in_reply_to_id": 1439030135,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1439030135\r\n\r\n> Just a question: Why call `get()` here? Is there a difference to `return !m_index.m_notifications`?\r\n\r\nNo that just seems like an oversight. Good catch, this should be simpler now.",
      "created_at": "2024-03-13T16:26:38Z",
      "updated_at": "2024-03-13T21:23:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r1523575703",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523575703"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 146,
      "side": "RIGHT"
    }
  ]
}