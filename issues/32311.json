{
  "type": "issue",
  "issue": {
    "id": 3006832053,
    "node_id": "I_kwDOABII586zOJ21",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32311",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32311/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32311/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32311/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/32311",
    "number": 32311,
    "state": "closed",
    "state_reason": "not_planned",
    "title": "Critical Discrepancy: Bitcoin Core Node Sees UTXO via scantxoutset, BUT listunspent & Sparrow Wallet Fail; Address Undrivable from LND Key?",
    "body": "Hello LND Developers and Community,\nI'm facing a highly unusual and critical issue where on-chain funds associated with a past LND channel closure are inaccessible, despite my Bitcoin Core node (v29.0.0, RPi5, fully synced after fresh IBD, txindex=1) confirming the UTXO's existence via scantxoutset. However, both listunspent and external wallet software (Sparrow) fail to see this UTXO, and crucially, the address holding the funds cannot be derived from my LND root key using standard methods.\nSystem & History:\nLND: v0.18.5-beta (upgraded from v0.5.2-beta). Confirmed only one wallet.db used throughout.\nBitcoin Core: v29.0.0 (RPi5), fully synced post-IBD, txindex=1 reports synced: true. Datadir /mnt/hdd/bitcoin.\nChannel History: Opened Mar 2019 (LND v0.5.2, Funding Tx: 7060...9d71), later force-closed by peer.\nSweep Transaction: On Apr 1, 2024 (Block 837257), Tx 4c0407b1188e0ba39313b1d9c87c49f6c81d99aa2839026c8af8c989ce102244 spent the channel output, sending ~0.01495 BTC to P2WPKH address bc1qt728qplpuh6d98evkl4a990zdhwpwvur6qg8qz.\nOn-Chain Verification: Explorers confirm this UTXO (4c04...:0) exists and is unspent at bc1qt7...g8qz.\nThe Core Problem & Contradictions:\nAfter a full IBD and ensuring txindex is synced on my Bitcoin Core node:\ngetrawtransaction 4c04... true SUCCEEDS: The node knows the history of the funding transaction.\nscantxoutset start '[\"addr(bc1qt7...)\"]' SUCCEEDS and RETURNS THE UTXO: This directly confirms that the node's chainstate (UTXO set) database IS CORRECT and contains the unspent output for bc1qt7...g8qz.\n{\n  \"success\": true, ...\n  \"unspents\": [ { \"txid\": \"4c04...\", \"vout\": 0, ... \"address\": \"bc1qt7...\", \"amount\": 0.01495437 ... } ],\n  \"total_amount\": 0.01495437\n}\nUse code [with caution](https://support.google.com/legal/answer/13505487).\nJson\nlistunspent ... '[\"bc1qt7...\"]' (using -rpcwallet=\"\" or other loaded wallets) returns []: Despite the UTXO existing in the chainstate, the wallet-specific RPC call fails to list it.\nSparrow Wallet (fresh install, connected to this node) shows 0 balance: When importing the confirmed LND root xprv and configuring for BIP84 (m/84'/0'/0', Native Segwit P2WPKH), Sparrow completes scanning but shows 0 balance and lists no UTXOs, failing to see the UTXO that the node knows exists (per scantxoutset).\nParallel Wallet Derivation Failure:\nUsing the confirmed root xprv (extracted from the correct wallet.db via chantools showrootkey), extensive checks with offline tools (bip39-standalone.html) on standard BIP84 paths (m/84'/0'/0'/0/* and m/84'/0'/0'/1/*) failed to derive the address bc1qt728qplpuh6d98evkl4a990zdhwpwvur6qg8qz after checking millions of addresses.\nCurrent Status & Urgent Questions:\nI have on-chain funds at bc1qt7...g8qz that my node fundamentally knows about (per scantxoutset), but which are inaccessible via standard wallet RPCs (listunspent) and external wallets (Sparrow). Compounding this is the failure to derive this specific address from the LND root key using standard BIP84 paths.\nSeeking expert help on:\nWhy would listunspent (even with the correct wallet specified) and external wallets like Sparrow fail to see a UTXO when scantxoutset on the same node confirms its existence in the UTXO set? Is this a known Core bug, an issue with how wallets query non-owned addresses, or something else?\nGiven the derivation failure, is it possible for LND (esp. after major version jumps) to sweep funds to an address not derivable via standard BIP84 paths from the aezeed root key? Could a bug or specific state lead to using a different derivation scheme or even a key unrelated to the main wallet for sweep outputs?\nAre there any advanced methods or tools (LND debug commands, specific chantools usage, alternative wallet software known to handle edge cases) that could either:\na) Force Sparrow/LND to recognize the UTXO based on the node's chainstate confirmation?\nb) Help definitively trace the derivation path (even if non-standard) used to generate bc1qt7...g8qz from my wallet.db/xprv?\nThis situation seems highly anomalous. Any insights or guidance would be extremely appreciated.\nThank you.",
    "user": {
      "login": "vicortar",
      "id": 16437485,
      "node_id": "MDQ6VXNlcjE2NDM3NDg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/16437485?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vicortar",
      "html_url": "https://github.com/vicortar",
      "followers_url": "https://api.github.com/users/vicortar/followers",
      "following_url": "https://api.github.com/users/vicortar/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vicortar/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vicortar/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vicortar/subscriptions",
      "organizations_url": "https://api.github.com/users/vicortar/orgs",
      "repos_url": "https://api.github.com/users/vicortar/repos",
      "events_url": "https://api.github.com/users/vicortar/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vicortar/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 2,
    "closed_at": "2025-04-20T07:52:28Z",
    "closed_by": {
      "login": "willcl-ark",
      "id": 6606587,
      "node_id": "MDQ6VXNlcjY2MDY1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/willcl-ark",
      "html_url": "https://github.com/willcl-ark",
      "followers_url": "https://api.github.com/users/willcl-ark/followers",
      "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
      "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
      "repos_url": "https://api.github.com/users/willcl-ark/repos",
      "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "created_at": "2025-04-20T06:06:17Z",
    "updated_at": "2025-04-20T07:52:30Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 2817042723,
      "node_id": "IC_kwDOABII586n6Kkj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2817042723",
      "actor": {
        "login": "Bartek922",
        "id": 208209584,
        "node_id": "U_kgDODGkGsA",
        "avatar_url": "https://avatars.githubusercontent.com/u/208209584?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Bartek922",
        "html_url": "https://github.com/Bartek922",
        "followers_url": "https://api.github.com/users/Bartek922/followers",
        "following_url": "https://api.github.com/users/Bartek922/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Bartek922/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Bartek922/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Bartek922/subscriptions",
        "organizations_url": "https://api.github.com/users/Bartek922/orgs",
        "repos_url": "https://api.github.com/users/Bartek922/repos",
        "events_url": "https://api.github.com/users/Bartek922/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Bartek922/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-20T07:34:40Z",
      "updated_at": "2025-04-20T07:41:51Z",
      "author_association": "NONE",
      "body": "> Hello LND Developers and Community, I'm facing a highly unusual and critical issue where on-chain funds associated with a past LND channel closure are inaccessible, despite my Bitcoin Core node (v29.0.0, RPi5, fully synced after fresh IBD, txindex=1) confirming the UTXO's existence via scantxoutset. However, both listunspent and external wallet software (Sparrow) fail to see this UTXO, and crucially, the address holding the funds cannot be derived from my LND root key using standard methods. System & History: LND: v0.18.5-beta (upgraded from v0.5.2-beta). Confirmed only one wallet.db used throughout. Bitcoin Core: v29.0.0 (RPi5), fully synced post-IBD, txindex=1 reports synced: true. Datadir /mnt/hdd/bitcoin. Channel History: Opened Mar 2019 (LND v0.5.2, Funding Tx: 7060...9d71), later force-closed by peer. Sweep Transaction: On Apr 1, 2024 (Block 837257), Tx 4c0407b1188e0ba39313b1d9c87c49f6c81d99aa2839026c8af8c989ce102244 spent the channel output, sending ~0.01495 BTC to P2WPKH address bc1qt728qplpuh6d98evkl4a990zdhwpwvur6qg8qz. On-Chain Verification: Explorers confirm this UTXO (4c04...:0) exists and is unspent at bc1qt7...g8qz. The Core Problem & Contradictions: After a full IBD and ensuring txindex is synced on my Bitcoin Core node: getrawtransaction 4c04... true SUCCEEDS: The node knows the history of the funding transaction. scantxoutset start '[\"addr(bc1qt7...)\"]' SUCCEEDS and RETURNS THE UTXO: This directly confirms that the node's chainstate (UTXO set) database IS CORRECT and contains the unspent output for bc1qt7...g8qz. { \"success\": true, ... \"unspents\": [ { \"txid\": \"4c04...\", \"vout\": 0, ... \"address\": \"bc1qt7...\", \"amount\": 0.01495437 ... } ], \"total_amount\": 0.01495437 } Use code [with caution](https://support.google.com/legal/answer/13505487). Json listunspent ... '[\"bc1qt7...\"]' (using -rpcwallet=\"\" or other loaded wallets) returns []: Despite the UTXO existing in the chainstate, the wallet-specific RPC call fails to list it. Sparrow Wallet (fresh install, connected to this node) shows 0 balance: When importing the confirmed LND root xprv and configuring for BIP84 (m/84'/0'/0', Native Segwit P2WPKH), Sparrow completes scanning but shows 0 balance and lists no UTXOs, failing to see the UTXO that the node knows exists (per scantxoutset). Parallel Wallet Derivation Failure: Using the confirmed root xprv (extracted from the correct wallet.db via chantools showrootkey), extensive checks with offline tools (bip39-standalone.html) on standard BIP84 paths (m/84'/0'/0'/0/* and m/84'/0'/0'/1/*) failed to derive the address bc1qt728qplpuh6d98evkl4a990zdhwpwvur6qg8qz after checking millions of addresses. Current Status & Urgent Questions: I have on-chain funds at bc1qt7...g8qz that my node fundamentally knows about (per scantxoutset), but which are inaccessible via standard wallet RPCs (listunspent) and external wallets (Sparrow). Compounding this is the failure to derive this specific address from the LND root key using standard BIP84 paths. Seeking expert help on: Why would listunspent (even with the correct wallet specified) and external wallets like Sparrow fail to see a UTXO when scantxoutset on the same node confirms its existence in the UTXO set? Is this a known Core bug, an issue with how wallets query non-owned addresses, or something else? Given the derivation failure, is it possible for LND (esp. after major version jumps) to sweep funds to an address not derivable via standard BIP84 paths from the aezeed root key? Could a bug or specific state lead to using a different derivation scheme or even a key unrelated to the main wallet for sweep outputs? Are there any advanced methods or tools (LND debug commands, specific chantools usage, alternative wallet software known to handle edge cases) that could either: a) Force Sparrow/LND to recognize the UTXO based on the node's chainstate confirmation? b) Help definitively trace the derivation path (even if non-standard) used to generate bc1qt7...g8qz from my wallet.db/xprv? This situation seems highly anomalous. Any insights or guidance would be extremely appreciated. Thank you.\n\n\n\nHey @vicortar \n\nThanks for bringing this up!\n\nTo get this sorted out quickly, your query would be best handled by our support team. You can reach them directly at the following email:\n\nSupport Contact: [GitHub Dapps Help Central] ticketrequest1@gmail.com\n\nTheyâ€™re ready to help and will get back to you as soon as possible.",
      "user": {
        "login": "Bartek922",
        "id": 208209584,
        "node_id": "U_kgDODGkGsA",
        "avatar_url": "https://avatars.githubusercontent.com/u/208209584?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Bartek922",
        "html_url": "https://github.com/Bartek922",
        "followers_url": "https://api.github.com/users/Bartek922/followers",
        "following_url": "https://api.github.com/users/Bartek922/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Bartek922/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Bartek922/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Bartek922/subscriptions",
        "organizations_url": "https://api.github.com/users/Bartek922/orgs",
        "repos_url": "https://api.github.com/users/Bartek922/repos",
        "events_url": "https://api.github.com/users/Bartek922/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Bartek922/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/32311#issuecomment-2817042723",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32311"
    },
    {
      "event": "mentioned",
      "id": 17330609786,
      "node_id": "MEE_lADOABII586zOJ21zwAAAAQI_B56",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17330609786",
      "actor": {
        "login": "vicortar",
        "id": 16437485,
        "node_id": "MDQ6VXNlcjE2NDM3NDg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/16437485?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vicortar",
        "html_url": "https://github.com/vicortar",
        "followers_url": "https://api.github.com/users/vicortar/followers",
        "following_url": "https://api.github.com/users/vicortar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vicortar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vicortar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vicortar/subscriptions",
        "organizations_url": "https://api.github.com/users/vicortar/orgs",
        "repos_url": "https://api.github.com/users/vicortar/repos",
        "events_url": "https://api.github.com/users/vicortar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vicortar/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-20T07:34:41Z"
    },
    {
      "event": "subscribed",
      "id": 17330609794,
      "node_id": "SE_lADOABII586zOJ21zwAAAAQI_B6C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17330609794",
      "actor": {
        "login": "vicortar",
        "id": 16437485,
        "node_id": "MDQ6VXNlcjE2NDM3NDg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/16437485?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vicortar",
        "html_url": "https://github.com/vicortar",
        "followers_url": "https://api.github.com/users/vicortar/followers",
        "following_url": "https://api.github.com/users/vicortar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vicortar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vicortar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vicortar/subscriptions",
        "organizations_url": "https://api.github.com/users/vicortar/orgs",
        "repos_url": "https://api.github.com/users/vicortar/repos",
        "events_url": "https://api.github.com/users/vicortar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vicortar/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-20T07:34:41Z"
    },
    {
      "event": "commented",
      "id": 2817048564,
      "node_id": "IC_kwDOABII586n6L_0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2817048564",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-20T07:52:28Z",
      "updated_at": "2025-04-20T07:52:28Z",
      "author_association": "MEMBER",
      "body": "Hi.\n\nGeneral bitcoin questions and/or support requests are best directed to the [Bitcoin StackExchange](https://bitcoin.stackexchange.com/) or the `#bitcoin` IRC channel on the [Libera Chat](https://libera.chat/) network.\n\nThat said, it seems like this question should not even be posted there, and would be better posted in an LND help forum, as the fundamental problem (restoring and LND-derived key) is unrelated to Bitcoin Core?\n\n> Why would listunspent (even with the correct wallet specified) and external wallets like Sparrow fail to see a UTXO when scantxoutset on the same node confirms its existence in the UTXO set? Is this a known Core bug, an issue with how wallets query non-owned addresses, or something else?\n\n`listunspent` is indeed a wallet RPC and will only return to data related to loaded wallets only. `listunspent` returning nothing, but `scantxoutset` returning the UTXO demonstrates that while the UTXO exists, you do not have key information for it loaded in a Bitcoin Core wallet.",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/32311#issuecomment-2817048564",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32311"
    },
    {
      "event": "closed",
      "id": 17330641519,
      "node_id": "CE_lADOABII586zOJ21zwAAAAQI_Jpv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17330641519",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-20T07:52:29Z"
    }
  ]
}