{
  "type": "issue",
  "issue": {
    "id": 2175520442,
    "node_id": "I_kwDOABII586Bq866",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29594",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29594/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29594/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29594/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/29594",
    "number": 29594,
    "state": "closed",
    "state_reason": "completed",
    "title": "Distinguish between bad-txns-inputs-missingorspent",
    "body": "### Please describe the feature you'd like to see added.\r\n\r\nI would like to fine grain error which informs whether the input is actually spent or if it is an orphan tx.  I have logic that wants to do different things whether the parent is confirmed or not.\r\n\r\n### Is your feature related to a problem, if so please describe it.\r\n\r\nRight now, the error code returned combines two scenarios where input is either missing or spent. In one scenario, I want to abandon the transaction because the input is already spent. In the other scenario, I want to resend the parent tx. \r\n\r\n### Describe the solution you'd like\r\n\r\nTwo different error code for the separate scenarios. \r\n\r\n### Describe any alternatives you've considered\r\n\r\nQuery bitcoin again for the parent tx state to check the state of transaction. But unfortunately, this is not applicable in my scenario because we are using bitcoind behind a Load balancer and I cannot guarantee that same bitcoind gets the request again. It would be great to have bitcoind itself return more detailed error code. \r\n\r\nI understand that my setup might not ideal and running stateful bitcoind with different mempools is probably not a good idea. But I feel that this finer error code is still valuable.  \r\n",
    "user": {
      "login": "sanket1729",
      "id": 6881849,
      "node_id": "MDQ6VXNlcjY4ODE4NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6881849?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sanket1729",
      "html_url": "https://github.com/sanket1729",
      "followers_url": "https://api.github.com/users/sanket1729/followers",
      "following_url": "https://api.github.com/users/sanket1729/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/sanket1729/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/sanket1729/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/sanket1729/subscriptions",
      "organizations_url": "https://api.github.com/users/sanket1729/orgs",
      "repos_url": "https://api.github.com/users/sanket1729/repos",
      "events_url": "https://api.github.com/users/sanket1729/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/sanket1729/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64583,
        "node_id": "MDU6TGFiZWw2NDU4Mw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
        "name": "Feature",
        "color": "7cf575",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 2,
    "closed_at": "2024-03-08T09:29:05Z",
    "created_at": "2024-03-08T08:18:01Z",
    "updated_at": "2024-03-08T09:29:05Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 12052591773,
      "node_id": "LE_lADOABII586Bq866zwAAAALOY_Sd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12052591773",
      "actor": {
        "login": "sanket1729",
        "id": 6881849,
        "node_id": "MDQ6VXNlcjY4ODE4NDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6881849?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sanket1729",
        "html_url": "https://github.com/sanket1729",
        "followers_url": "https://api.github.com/users/sanket1729/followers",
        "following_url": "https://api.github.com/users/sanket1729/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sanket1729/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sanket1729/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sanket1729/subscriptions",
        "organizations_url": "https://api.github.com/users/sanket1729/orgs",
        "repos_url": "https://api.github.com/users/sanket1729/repos",
        "events_url": "https://api.github.com/users/sanket1729/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sanket1729/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-08T08:18:01Z",
      "label": {
        "name": "Feature",
        "color": "7cf575"
      }
    },
    {
      "event": "commented",
      "id": 1985343214,
      "node_id": "IC_kwDOABII5852Ve7u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1985343214",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-08T09:24:27Z",
      "updated_at": "2024-03-08T09:25:08Z",
      "author_association": "MEMBER",
      "body": "An issue is that we don't actually know if it's missing or spent, we just don't see the UTXO available. Knowing \"spent\" for certain would require querying whether the UTXO existed at some point in the past...\r\n\r\n> I would like to fine grain error which informs whether the input is actually spent or if it is an orphan tx. I have logic that wants to do different things whether the parent is confirmed or not.\r\n\r\nNot sure if I'm misunderstanding the situation, but a few ideas\r\n\r\n- `gettxspendingprevout` tells you if something has a mempool conflict\r\n- If something is confirmed and bitcoind sees one of its outputs in the UTXO set (\"txn-already-known\" means \"this tx already confirmed\" if you want to try looking for that error).\r\n- The wallet has logic to see if its transactions have been conflicted by a block (see \"confirmations\" in rpc results).\r\n- Consider just resending the parent always? If it's missing, problem solved. If it's in mempool already, no harm done. If it's confirmed and has an output available, \"txn-already-known\". If it conflicts with something, \"bad-txns-inputs-missingorspent\".",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29594#issuecomment-1985343214",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29594"
    },
    {
      "event": "commented",
      "id": 1985350392,
      "node_id": "IC_kwDOABII5852Vgr4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1985350392",
      "actor": {
        "login": "sanket1729",
        "id": 6881849,
        "node_id": "MDQ6VXNlcjY4ODE4NDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6881849?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sanket1729",
        "html_url": "https://github.com/sanket1729",
        "followers_url": "https://api.github.com/users/sanket1729/followers",
        "following_url": "https://api.github.com/users/sanket1729/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sanket1729/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sanket1729/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sanket1729/subscriptions",
        "organizations_url": "https://api.github.com/users/sanket1729/orgs",
        "repos_url": "https://api.github.com/users/sanket1729/repos",
        "events_url": "https://api.github.com/users/sanket1729/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sanket1729/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-08T09:29:05Z",
      "updated_at": "2024-03-08T09:29:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the response. This resolves my issue",
      "user": {
        "login": "sanket1729",
        "id": 6881849,
        "node_id": "MDQ6VXNlcjY4ODE4NDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6881849?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sanket1729",
        "html_url": "https://github.com/sanket1729",
        "followers_url": "https://api.github.com/users/sanket1729/followers",
        "following_url": "https://api.github.com/users/sanket1729/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sanket1729/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sanket1729/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sanket1729/subscriptions",
        "organizations_url": "https://api.github.com/users/sanket1729/orgs",
        "repos_url": "https://api.github.com/users/sanket1729/repos",
        "events_url": "https://api.github.com/users/sanket1729/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sanket1729/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29594#issuecomment-1985350392",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29594"
    },
    {
      "event": "closed",
      "id": 12053296485,
      "node_id": "CE_lADOABII586Bq866zwAAAALObrVl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12053296485",
      "actor": {
        "login": "sanket1729",
        "id": 6881849,
        "node_id": "MDQ6VXNlcjY4ODE4NDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6881849?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sanket1729",
        "html_url": "https://github.com/sanket1729",
        "followers_url": "https://api.github.com/users/sanket1729/followers",
        "following_url": "https://api.github.com/users/sanket1729/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sanket1729/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sanket1729/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sanket1729/subscriptions",
        "organizations_url": "https://api.github.com/users/sanket1729/orgs",
        "repos_url": "https://api.github.com/users/sanket1729/repos",
        "events_url": "https://api.github.com/users/sanket1729/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sanket1729/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-08T09:29:05Z"
    }
  ]
}