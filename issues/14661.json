{
  "type": "issue",
  "issue": {
    "id": 377472225,
    "node_id": "MDU6SXNzdWUzNzc0NzIyMjU=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14661",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14661/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14661/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14661/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/14661",
    "number": 14661,
    "state": "closed",
    "state_reason": "completed",
    "title": "p2p_invalid_block occasionally fails \"bad-txns-inputs-duplicate\"",
    "body": "Short log:\r\n\r\n```\r\np2p_invalid_block.py failed, Duration: 1 s\r\nstdout:\r\n2018-11-05T15:27:36.459000Z TestFramework (INFO): Initializing test directory /tmp/test_runner_â‚¿_ðŸƒ_20181105_152228/p2p_invalid_block_46\r\n2018-11-05T15:27:36.778000Z TestFramework (INFO): Create a new block with an anyone-can-spend coinbase\r\n2018-11-05T15:27:36.890000Z TestFramework (INFO): Mature the block.\r\n2018-11-05T15:27:37.238000Z TestFramework (INFO): Test merkle root malleability.\r\n2018-11-05T15:27:37.301000Z TestFramework (INFO): Test duplicate input block.\r\n2018-11-05T15:27:37.354000Z TestFramework (ERROR): Assertion failed\r\nTraceback (most recent call last):\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-unknown-linux-gnu/test/functional/test_framework/test_framework.py\", line 171, in main\r\n    self.run_test()\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-unknown-linux-gnu/test/functional/p2p_invalid_block.py\", line 92, in run_test\r\n    node.p2p.send_blocks_and_test([block2_orig], node, success=False, request_block=False, reject_reason='bad-txns-inputs-duplicate')\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-unknown-linux-gnu/test/functional/test_framework/mininode.py\", line 543, in send_blocks_and_test\r\n    assert node.getbestblockhash() != blocks[-1].hash\r\n  File \"/usr/lib/python3.5/contextlib.py\", line 66, in __exit__\r\n    next(self.gen)\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-unknown-linux-gnu/test/functional/test_framework/test_node.py\", line 272, in assert_debug_log\r\n    self._raise_assertion_error('Expected message \"{}\" does not partially match log:\\n\\n{}\\n\\n'.format(expected_msg, print_log))\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-unknown-linux-gnu/test/functional/test_framework/test_node.py\", line 124, in _raise_assertion_error\r\n    raise AssertionError(self._node_msg(msg))\r\nAssertionError: [node 0] Expected message \"bad-txns-inputs-duplicate\" does not partially match log:\r\n - 2018-11-05T15:27:37.312967Z received: headers (82 bytes) peer=0\r\n - 2018-11-05T15:27:37.313141Z Requesting block 0b1e6087126df7c86349cec8019ee7134f485c79ad89e9ed180325c5b73cd878 from  peer=0\r\n - 2018-11-05T15:27:37.313156Z sending getdata (37 bytes) peer=0\r\n - 2018-11-05T15:27:37.316649Z received: ping (8 bytes) peer=0\r\n - 2018-11-05T15:27:37.316675Z sending pong (8 bytes) peer=0\r\n - 2018-11-05T15:27:37.318279Z received: block (327 bytes) peer=0\r\n - 2018-11-05T15:27:37.318321Z received block 0b4699cec0641f2d47013551446930cf165dfbcde6ff4440695e0678dd417068 peer=0\r\n - 2018-11-05T15:27:37.318358Z Misbehaving: 127.0.0.1:51816 peer=0 (3100 -> 3200)\r\n - 2018-11-05T15:27:37.318372Z ERROR: ProcessNewBlock: AcceptBlock FAILED (bad-txns-duplicate, duplicate transaction (code 16))\r\n - 2018-11-05T15:27:37.353006Z Received a POST request for / from 127.0.0.1:34964\r\n - 2018-11-05T15:27:37.353084Z ThreadRPCServer method=getbestblockhash user=__cookie__\r\n```\r\n\r\nFull log: https://travis-ci.org/bitcoin/bitcoin/jobs/450901528",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "milestone": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/39",
      "html_url": "https://github.com/bitcoin/bitcoin/milestone/39",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/39/labels",
      "id": 3563443,
      "node_id": "MDk6TWlsZXN0b25lMzU2MzQ0Mw==",
      "number": 39,
      "state": "closed",
      "title": "0.17.1",
      "description": "",
      "creator": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "open_issues": 0,
      "closed_issues": 38,
      "created_at": "2018-08-12T23:47:01Z",
      "updated_at": "2018-12-23T02:48:05Z",
      "closed_at": "2018-12-23T02:48:05Z"
    },
    "locked": true,
    "active_lock_reason": "resolved",
    "comments": 0,
    "closed_at": "2018-11-13T15:27:56Z",
    "created_at": "2018-11-05T16:15:24Z",
    "updated_at": "2021-09-08T12:39:57Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 1946668228,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDE5NDY2NjgyMjg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1946668228",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-05T16:17:26Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "milestoned",
      "id": 1957855939,
      "node_id": "MDE1Ok1pbGVzdG9uZWRFdmVudDE5NTc4NTU5Mzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1957855939",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-09T21:08:28Z",
      "milestone": {
        "title": "0.17.1"
      }
    },
    {
      "event": "closed",
      "id": 1963343563,
      "node_id": "MDExOkNsb3NlZEV2ZW50MTk2MzM0MzU2Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1963343563",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-13T15:27:56Z"
    },
    {
      "event": "referenced",
      "id": 1963343738,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDE5NjMzNDM3Mzg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1963343738",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "5d605b27457dd307e31ac320c83f3b01a41e1ae1",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5d605b27457dd307e31ac320c83f3b01a41e1ae1",
      "created_at": "2018-11-13T15:28:00Z"
    },
    {
      "event": "referenced",
      "id": 5136362407,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMzYzNjI0MDc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5136362407",
      "actor": {
        "login": "knst",
        "id": 545784,
        "node_id": "MDQ6VXNlcjU0NTc4NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/545784?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/knst",
        "html_url": "https://github.com/knst",
        "followers_url": "https://api.github.com/users/knst/followers",
        "following_url": "https://api.github.com/users/knst/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/knst/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/knst/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/knst/subscriptions",
        "organizations_url": "https://api.github.com/users/knst/orgs",
        "repos_url": "https://api.github.com/users/knst/repos",
        "events_url": "https://api.github.com/users/knst/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/knst/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "d2cf77542dd8fbb3c721e7dc2035dbd4adafe152",
      "commit_url": "https://api.github.com/repos/knst/dash/commits/d2cf77542dd8fbb3c721e7dc2035dbd4adafe152",
      "created_at": "2021-08-10T16:19:56Z"
    },
    {
      "event": "referenced",
      "id": 5136749940,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMzY3NDk5NDA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5136749940",
      "actor": {
        "login": "knst",
        "id": 545784,
        "node_id": "MDQ6VXNlcjU0NTc4NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/545784?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/knst",
        "html_url": "https://github.com/knst",
        "followers_url": "https://api.github.com/users/knst/followers",
        "following_url": "https://api.github.com/users/knst/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/knst/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/knst/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/knst/subscriptions",
        "organizations_url": "https://api.github.com/users/knst/orgs",
        "repos_url": "https://api.github.com/users/knst/repos",
        "events_url": "https://api.github.com/users/knst/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/knst/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "f0b99c3a879c7edf17231ce643c6ca84c7950f20",
      "commit_url": "https://api.github.com/repos/knst/dash/commits/f0b99c3a879c7edf17231ce643c6ca84c7950f20",
      "created_at": "2021-08-10T17:32:08Z"
    },
    {
      "event": "referenced",
      "id": 5165189903,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxNjUxODk5MDM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5165189903",
      "actor": {
        "login": "knst",
        "id": 545784,
        "node_id": "MDQ6VXNlcjU0NTc4NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/545784?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/knst",
        "html_url": "https://github.com/knst",
        "followers_url": "https://api.github.com/users/knst/followers",
        "following_url": "https://api.github.com/users/knst/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/knst/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/knst/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/knst/subscriptions",
        "organizations_url": "https://api.github.com/users/knst/orgs",
        "repos_url": "https://api.github.com/users/knst/repos",
        "events_url": "https://api.github.com/users/knst/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/knst/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "abd05eb8d8a257f81e81de434e636fd56f7acf03",
      "commit_url": "https://api.github.com/repos/knst/dash/commits/abd05eb8d8a257f81e81de434e636fd56f7acf03",
      "created_at": "2021-08-16T20:11:00Z"
    },
    {
      "event": "referenced",
      "id": 5191715613,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxOTE3MTU2MTM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5191715613",
      "actor": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "5bda9afcf6b148af684386bbd5bb66aa82c5157d",
      "commit_url": "https://api.github.com/repos/PastaPastaPasta/dash/commits/5bda9afcf6b148af684386bbd5bb66aa82c5157d",
      "created_at": "2021-08-23T02:39:09Z"
    },
    {
      "event": "locked",
      "id": 5272043080,
      "node_id": "LOE_lADOABII584Wf8ThzwAAAAE6PP5I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5272043080",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T12:39:57Z",
      "lock_reason": "resolved"
    }
  ]
}