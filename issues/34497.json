{
  "type": "issue",
  "issue": {
    "id": 3893710679,
    "node_id": "I_kwDOABII587oFU9X",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34497",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34497/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34497/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34497/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/34497",
    "number": 34497,
    "state": "open",
    "state_reason": null,
    "title": "[rfc] Disallow loading and creating wallets by paths",
    "body": "A discussion that has come up several times at the Localhost office over the past several weeks has been whether it makes sense to load wallets by paths. In particular, supporting wallets by path has been the source of a couple issues, and has also had some involvement in the recent wallet deletion issue.\n\nFor some background, the name of a wallet can always be interpreted as a path. If it is not an absolute path, then it is a path relative to the wallets directory, e.g. a wallet named `mywallet` is always located at `<walletsdir>/mywallet`. But when referring to wallets named by relative path, I mean wallets which actually include `/` in their name which turns the name into a path specifier, rather than a logical name that happens to map to a path relative to the walletsdir. Otherwise, the path is an absolute path. An important note is that with the exception of BDB files stored directly in the walletsdir, the file actually opened is always `<path>/wallet.dat`.\n\nFor absolute paths, this seems mostly ok, if just a bit odd. This has the potential to be problematic when mixing wallet names with filenames and paths. However, I don't recall any specific issues with absolute paths off the top of my head.\n\nOn the other hand, relative paths that include additional directories (e.g.` <walletdir>/<subdir>/mywallet` or `../<more path>/mywallet`) have been a major source of headaches in wallet filesystem code:\n- #32273 pointed out a flaw in how wallet names and paths were being combined in relative paths to produce nonsensical paths\n- The root issue in #31409 is searching subdirectories for additional wallets to have their name by relative path\n\nFurthermore, from a user perspective, relative path wallets are really weird in that the path is relative to the walletsdir, which itself is not always consistent relative to the datadir (excluding when set explicitly). Given that the actual location of the walletsdir is basically never surfaced to the user, I don't really see any situation where a user would want to name a wallet `../<path>`. I can see `<sub>/mywallet`, ~but that really doesn't need to be a path, and the wallet could actually be in a directory named `<sub>/mywallet` where the `/` is escaped so it doesn't become a path.~ Edit: `/` can't be escaped.\n\nI propose that we should remove support for wallets with by relative path, but retain support for wallets by absolute path.\n\nBut I'd like to get some feedback from contributors and users before moving forward with this.\n\n***\n\nThere has also been the suggestion that we should go all the way and just remove support for both relative and absolute paths. I push back on this a bit as I think absolute paths can still be useful, e.g. if a user has wallets both in the walletsdir and on external media, they could want to load wallets from both locations at the same time without needing to change the walletsdir by specifying wallets by absolute path. However, I am open to being convinced that remove absolute path support could be a good idea.",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      },
      {
        "id": 1392286103,
        "node_id": "MDU6TGFiZWwxMzkyMjg2MTAz",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20Conceptual%20Review",
        "name": "Needs Conceptual Review",
        "description": "",
        "color": "fef2c0",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 4,
    "created_at": "2026-02-03T23:20:47Z",
    "updated_at": "2026-02-09T23:46:37Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 22512307644,
      "node_id": "LE_lADOABII587oFU9XzwAAAAU91o28",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22512307644",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T23:20:48Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "labeled",
      "id": 22512307705,
      "node_id": "LE_lADOABII587oFU9XzwAAAAU91o35",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22512307705",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T23:20:48Z",
      "label": {
        "name": "Needs Conceptual Review",
        "color": "fef2c0"
      }
    },
    {
      "event": "commented",
      "id": 3846345031,
      "node_id": "IC_kwDOABII587lQpFH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3846345031",
      "actor": {
        "login": "sobitkarki1",
        "id": 87702816,
        "node_id": "MDQ6VXNlcjg3NzAyODE2",
        "avatar_url": "https://avatars.githubusercontent.com/u/87702816?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sobitkarki1",
        "html_url": "https://github.com/sobitkarki1",
        "followers_url": "https://api.github.com/users/sobitkarki1/followers",
        "following_url": "https://api.github.com/users/sobitkarki1/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sobitkarki1/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sobitkarki1/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sobitkarki1/subscriptions",
        "organizations_url": "https://api.github.com/users/sobitkarki1/orgs",
        "repos_url": "https://api.github.com/users/sobitkarki1/repos",
        "events_url": "https://api.github.com/users/sobitkarki1/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sobitkarki1/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T09:34:56Z",
      "updated_at": "2026-02-04T09:34:56Z",
      "author_association": "NONE",
      "body": "We should remove support for wallets by relative path, but retain support for wallets by absolute path. That's the way to go.",
      "user": {
        "login": "sobitkarki1",
        "id": 87702816,
        "node_id": "MDQ6VXNlcjg3NzAyODE2",
        "avatar_url": "https://avatars.githubusercontent.com/u/87702816?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sobitkarki1",
        "html_url": "https://github.com/sobitkarki1",
        "followers_url": "https://api.github.com/users/sobitkarki1/followers",
        "following_url": "https://api.github.com/users/sobitkarki1/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sobitkarki1/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sobitkarki1/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sobitkarki1/subscriptions",
        "organizations_url": "https://api.github.com/users/sobitkarki1/orgs",
        "repos_url": "https://api.github.com/users/sobitkarki1/repos",
        "events_url": "https://api.github.com/users/sobitkarki1/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sobitkarki1/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34497#issuecomment-3846345031",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34497"
    },
    {
      "event": "commented",
      "id": 3873921700,
      "node_id": "IC_kwDOABII587m51qk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3873921700",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-09T21:19:17Z",
      "updated_at": "2026-02-09T21:19:17Z",
      "author_association": "MEMBER",
      "body": "> I don't recall any specific issues with absolute paths off the top of my head.\n\n> I push back on this a bit as I think absolute paths can still be useful\n\nAbsolute paths are also particularly useful for applications leveraging the Bitcoin Core wallet to more robustly be internally consistent. For instance a wallet like [Liana](https://github.com/wizardsardine/liana/) using a watchonly wallet at an absolute path under its own data dir to track its coins, can run against any `bitcoind` the user may have set up, and may be using for other applications or reinstall or otherwise tamper with its (`bitcoind`'s) datadir. Using a wallet under Bitcoin Core's `wallet/` subdirectory bakes into the wallet this brittle assumption that Bitcoin Core's datadir will not change.\n\nSuch applications can nowadays probably be rewritten to use BDK instead (although in this case pruning support becomes complicated), and i don't mean to imply that wallet contributors should bear the burden of supporting this project if they think absolute path support ought to be deprecated. But i hope this reflects that absolute paths support is useful to downstream projects and that dropping support for them is not a free lunch.\n\nI have a harder time thinking of a reasonable use case for supporting wallet paths relative to Core's `wallet` sub-directory. Another brittleness of using relative wallet paths is that such use would not be portable across networks nor installations. Networks because for test networks the `wallet/` sub-directory would be one level deeper, which may lead to code that works during testing breaking subtly in production. And across installations, because for existing Bitcoin Core datadirs with no `wallet/` sub-directory, the root datadir (for this network) will be used.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34497#issuecomment-3873921700",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34497"
    },
    {
      "event": "commented",
      "id": 3873970445,
      "node_id": "IC_kwDOABII587m6BkN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3873970445",
      "actor": {
        "login": "gmart7t2",
        "id": 49558347,
        "node_id": "MDQ6VXNlcjQ5NTU4MzQ3",
        "avatar_url": "https://avatars.githubusercontent.com/u/49558347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmart7t2",
        "html_url": "https://github.com/gmart7t2",
        "followers_url": "https://api.github.com/users/gmart7t2/followers",
        "following_url": "https://api.github.com/users/gmart7t2/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmart7t2/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmart7t2/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmart7t2/subscriptions",
        "organizations_url": "https://api.github.com/users/gmart7t2/orgs",
        "repos_url": "https://api.github.com/users/gmart7t2/repos",
        "events_url": "https://api.github.com/users/gmart7t2/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmart7t2/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-09T21:31:02Z",
      "updated_at": "2026-02-09T21:31:02Z",
      "author_association": "NONE",
      "body": "I have my wallets organized into nested subdirectories under ~/.bitcoin/wallets/ to keep groups of wallets separate from each other.\n\nFor example, when I am finished using a wallet, rather than deleting it I \"bitcoin unloadeallet name\" then move it into a subdirectory of wallets called \"empty/\". Then I \"bitcoin-cli loadwallet empty/name\". It shows up as \"empty/name\" in the wallet list and I can easily check all my \"empty\" wallets to see if they are still empty\n\n```\n$ bitcoin-cli listwallets | jq -r .[] | grep '^empty/' | while read x; do bitcoin-cli -rpcwallet=$x getbalance; done | uniq -c\n389 0.00000000\n```\n\nI guess I could stop using subdirectories and just rename wallets/empty/name/ to wallets/empty-name/ or something but that's not as clean",
      "user": {
        "login": "gmart7t2",
        "id": 49558347,
        "node_id": "MDQ6VXNlcjQ5NTU4MzQ3",
        "avatar_url": "https://avatars.githubusercontent.com/u/49558347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmart7t2",
        "html_url": "https://github.com/gmart7t2",
        "followers_url": "https://api.github.com/users/gmart7t2/followers",
        "following_url": "https://api.github.com/users/gmart7t2/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmart7t2/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmart7t2/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmart7t2/subscriptions",
        "organizations_url": "https://api.github.com/users/gmart7t2/orgs",
        "repos_url": "https://api.github.com/users/gmart7t2/repos",
        "events_url": "https://api.github.com/users/gmart7t2/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmart7t2/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34497#issuecomment-3873970445",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34497"
    },
    {
      "event": "commented",
      "id": 3874481401,
      "node_id": "IC_kwDOABII587m7-T5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3874481401",
      "actor": {
        "login": "davidgumberg",
        "id": 2257631,
        "node_id": "MDQ6VXNlcjIyNTc2MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2257631?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidgumberg",
        "html_url": "https://github.com/davidgumberg",
        "followers_url": "https://api.github.com/users/davidgumberg/followers",
        "following_url": "https://api.github.com/users/davidgumberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/davidgumberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/davidgumberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/davidgumberg/subscriptions",
        "organizations_url": "https://api.github.com/users/davidgumberg/orgs",
        "repos_url": "https://api.github.com/users/davidgumberg/repos",
        "events_url": "https://api.github.com/users/davidgumberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/davidgumberg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-09T23:46:05Z",
      "updated_at": "2026-02-09T23:46:37Z",
      "author_association": "CONTRIBUTOR",
      "body": " I think that there is lurking danger in a string that is at times a name, and at other times a path with path specifiers and symlinks being resolved by the filesystem. I wonder if a reasonable solution would just be to separate these two, allowing a user to load a wallet with a name, and optionally provide a path, e.g.:\n\n```bash\nbitcoin-cli -named loadwallet name=\"mywallet\" path=\"/path/to/my/wallet\"\n```",
      "user": {
        "login": "davidgumberg",
        "id": 2257631,
        "node_id": "MDQ6VXNlcjIyNTc2MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2257631?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidgumberg",
        "html_url": "https://github.com/davidgumberg",
        "followers_url": "https://api.github.com/users/davidgumberg/followers",
        "following_url": "https://api.github.com/users/davidgumberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/davidgumberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/davidgumberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/davidgumberg/subscriptions",
        "organizations_url": "https://api.github.com/users/davidgumberg/orgs",
        "repos_url": "https://api.github.com/users/davidgumberg/repos",
        "events_url": "https://api.github.com/users/davidgumberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/davidgumberg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34497#issuecomment-3874481401",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34497"
    }
  ]
}