{
  "type": "issue",
  "issue": {
    "id": 3902136691,
    "node_id": "I_kwDOABII587oleFz",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34516",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34516/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34516/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34516/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/34516",
    "number": 34516,
    "state": "open",
    "state_reason": null,
    "title": "ci: intermittent failure in `wallet_fundrawtransaction.py` `test_22670` subtest",
    "body": "```\n187/451 - wallet_fundrawtransaction.py failed, Duration: 13 s\n\nstdout:\n2026-02-05T12:35:01.704519Z TestFramework (INFO): PRNG seed is: 5016624252263921331\n\n2026-02-05T12:35:01.730571Z TestFramework (INFO): Initializing test directory D:\\a\\_temp\\test_runner_â‚¿_ðŸƒ_20260205_122957\\wallet_fundrawtransaction_262\n\n2026-02-05T12:35:02.537671Z TestFramework (INFO): Connect nodes, set fees, generate blocks, and sync\n\n2026-02-05T12:35:05.321861Z TestFramework (INFO): Test 'add_inputs' default value\n\n2026-02-05T12:35:05.452026Z TestFramework (INFO): Test wallet preset inputs are not double-counted or reused in coin selection\n\n2026-02-05T12:35:05.501867Z TestFramework (INFO): Test weight calculation with external inputs\n\n2026-02-05T12:35:05.548967Z TestFramework (INFO): Test weight limits\n\n2026-02-05T12:35:07.187533Z TestFramework (INFO): Test fundrawtxn changePosition option\n\n2026-02-05T12:35:07.281210Z TestFramework (INFO): Test fundrawtxn\n\n2026-02-05T12:35:07.284318Z TestFramework (INFO): Test fundrawtxn with 2 coins\n\n2026-02-05T12:35:07.287273Z TestFramework (INFO): Test fundrawtxn with 2 outputs\n\n2026-02-05T12:35:07.291047Z TestFramework (INFO): Test fundrawtxn with a vin > required amount\n\n2026-02-05T12:35:07.295357Z TestFramework (INFO): Test fundrawtxn not having a change output\n\n2026-02-05T12:35:07.300114Z TestFramework (INFO): Test fundrawtxn with an invalid option\n\n2026-02-05T12:35:07.303564Z TestFramework (INFO): Test fundrawtxn with an invalid change address\n\n2026-02-05T12:35:07.306663Z TestFramework (INFO): Test fundrawtxn with a provided change address\n\n2026-02-05T12:35:07.311817Z TestFramework (INFO): Test fundrawtxn with a provided change type\n\n2026-02-05T12:35:07.316656Z TestFramework (INFO): Test fundrawtxn with a vin < required amount\n\n2026-02-05T12:35:07.321806Z TestFramework (INFO): Test fundrawtxn with 2 vins\n\n2026-02-05T12:35:07.327892Z TestFramework (INFO): Test fundrawtxn with 2 vins and 2 vouts\n\n2026-02-05T12:35:07.334649Z TestFramework (INFO): Test fundrawtxn with an invalid vin\n\n2026-02-05T12:35:07.336586Z TestFramework (INFO): Test fundrawtxn p2pkh fee\n\n2026-02-05T12:35:07.347693Z TestFramework (INFO): Test fundrawtxn p2pkh fee with multiple outputs\n\n2026-02-05T12:35:07.375364Z TestFramework (INFO): Test fundrawtxn fee with 4-of-5 addresses\n\n2026-02-05T12:35:07.392213Z TestFramework (INFO): Test fundpsbt spending 2-of-2 multisig\n\n2026-02-05T12:35:08.502881Z TestFramework (INFO): Test fundrawtxn with locked wallet and hardened derivation\n\n2026-02-05T12:35:10.397217Z TestFramework (INFO): Test fundrawtxn fee with many inputs\n\n2026-02-05T12:35:10.600278Z TestFramework (INFO): Test fundrawtxn sign+send with many inputs\n\n2026-02-05T12:35:10.852109Z TestFramework (INFO): Test fundrawtxn with OP_RETURN and no vin\n\n2026-02-05T12:35:10.854867Z TestFramework (INFO): Test fundrawtxn using only watchonly\n\n2026-02-05T12:35:10.875358Z TestFramework (INFO): Test fundrawtxn using entirety of watched funds\n\n2026-02-05T12:35:10.916338Z TestFramework (INFO): Test fundrawtxn with explicit fee rates (fee_rate sat/vB and feeRate BTC/kvB)\n\n2026-02-05T12:35:10.939633Z TestFramework (INFO): Test fundrawtxn with invalid estimate_mode settings\n\n2026-02-05T12:35:10.942656Z TestFramework (INFO): Test fundrawtxn with invalid conf_target settings\n\n2026-02-05T12:35:10.951856Z TestFramework (INFO): Test invalid fee rate settings\n\n2026-02-05T12:35:10.965554Z TestFramework (INFO): Test min fee rate checks are bypassed with fundrawtxn, e.g. a fee_rate under 1 sat/vB is allowed\n\n2026-02-05T12:35:10.967992Z TestFramework (INFO): - raises RPC error if both feeRate and fee_rate are passed\n\n2026-02-05T12:35:10.968656Z TestFramework (INFO): - raises RPC error if both feeRate and estimate_mode passed\n\n2026-02-05T12:35:10.969305Z TestFramework (INFO): - raises RPC error if both feeRate and conf_target are passed\n\n2026-02-05T12:35:10.969943Z TestFramework (INFO): - raises RPC error if both fee_rate and conf_target are passed\n\n2026-02-05T12:35:10.970583Z TestFramework (INFO): - raises RPC error if both fee_rate and estimate_mode are passed\n\n2026-02-05T12:35:10.971225Z TestFramework (INFO): Test fundrawtxn does not reuse addresses\n\n2026-02-05T12:35:10.975198Z TestFramework (INFO): Test fundrawtxn subtractFeeFromOutputs option\n\n2026-02-05T12:35:11.001886Z TestFramework (INFO): Test fundrawtxn subtract fee from outputs with preset inputs that are sufficient\n\n2026-02-05T12:35:11.023993Z TestFramework (INFO): Test fundrawtx where BnB solution would result in a too large transaction, but Knapsack would not\n\n2026-02-05T12:35:13.553431Z TestFramework (INFO): Test fundrawtxn with unsafe inputs\n\n2026-02-05T12:35:14.665974Z TestFramework (INFO): Test funding with external inputs\n\n2026-02-05T12:35:14.875797Z TestFramework (INFO): Test issue 22670 ApproximateBestSubset bug\n\n2026-02-05T12:35:15.310940Z TestFramework (ERROR): Unexpected exception\n\nTraceback (most recent call last):\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_framework.py\", line 142, in main\n\n    self.run_test()\n\n    ~~~~~~~~~~~~~^^\n\n  File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_fundrawtransaction.py\", line 153, in run_test\n\n    self.test_22670()\n\n    ~~~~~~~~~~~~~~~^^\n\n  File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_fundrawtransaction.py\", line 1431, in test_22670\n\n    do_fund_send(lower_bound)\n\n    ~~~~~~~~~~~~^^^^^^^^^^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin/test/functional/wallet_fundrawtransaction.py\", line 1416, in do_fund_send\n\n    funded_tx = tester.fundrawtransaction(create_tx)\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\coverage.py\", line 50, in __call__\n\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\authproxy.py\", line 156, in __call__\n\n    raise JSONRPCException(response['error'], status)\n\ntest_framework.authproxy.JSONRPCException: Insufficient funds (-4)\n\n2026-02-05T12:35:15.363540Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n\n2026-02-05T12:35:15.363675Z TestFramework (WARNING): Not cleaning up dir D:\\a\\_temp\\test_runner_â‚¿_ðŸƒ_20260205_122957\\wallet_fundrawtransaction_262\n\n2026-02-05T12:35:15.363771Z TestFramework (ERROR): Test failed. Test logging available at D:\\a\\_temp\\test_runner_â‚¿_ðŸƒ_20260205_122957\\wallet_fundrawtransaction_262/test_framework.log\n\n2026-02-05T12:35:15.363938Z TestFramework (ERROR): \n\n2026-02-05T12:35:15.364264Z TestFramework (ERROR): Hint: Call D:\\a\\bitcoin\\bitcoin\\test\\functional\\combine_logs.py 'D:\\a\\_temp\\test_runner_â‚¿_ðŸƒ_20260205_122957\\wallet_fundrawtransaction_262' to consolidate all logs\n\n2026-02-05T12:35:15.364370Z TestFramework (ERROR): \n\n2026-02-05T12:35:15.364439Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n\n2026-02-05T12:35:15.364528Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n\n2026-02-05T12:35:15.364593Z TestFramework (ERROR): \n\n\n\nstderr:\n[node 3] Cleaning up leftover process\n\n[node 2] Cleaning up leftover process\n\n[node 1] Cleaning up leftover process\n\n[node 0] Cleaning up leftover process\n\n\n\nCombine the logs and print the last 99999999 lines ...\n\n```\n\nI've seen this twice, recently in https://github.com/bitcoin/bitcoin/actions/runs/21711098285/job/62615544269?pr=29278 and first in https://github.com/bitcoin/bitcoin/actions/runs/19305407337/job/55211418389. It seems unrelated to PR #29278. I am opening this as a separate tracker, as it's worth investigating the root cause.",
    "user": {
      "login": "ismaelsadeeq",
      "id": 48946461,
      "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ismaelsadeeq",
      "html_url": "https://github.com/ismaelsadeeq",
      "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
      "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
      "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
      "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
      "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 0,
    "created_at": "2026-02-05T15:22:24Z",
    "updated_at": "2026-02-05T15:58:03Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 22563168052,
      "node_id": "LE_lADOABII587oleFzzwAAAAVA3p80",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22563168052",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T15:57:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 22563170974,
      "node_id": "LE_lADOABII587oleFzzwAAAAVA3qqe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22563170974",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T15:58:03Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    }
  ]
}