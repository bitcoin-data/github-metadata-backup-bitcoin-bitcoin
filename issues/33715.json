{
  "type": "issue",
  "issue": {
    "id": 3557806027,
    "node_id": "I_kwDOABII587UD8_L",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33715",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33715/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33715/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33715/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/33715",
    "number": 33715,
    "state": "open",
    "state_reason": null,
    "title": "Failure to bind to ZMQ addresses is swallowed in debug logs",
    "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nWhen failing to bind to specified ZMQ addresses due to them already being in use, the error is completely swallowed up when not running with debug logs. \n\n### Expected behaviour\n\nI'd expect one of two things to happen:\n\n1. Bitcoin Core exiting with a non-zero status code and a clear message saying what happened (I'd prefer this)\n2. An error message in the logs, that is visible without having to enable debug logs. \n\n### Steps to reproduce\n\n1. Spawn a node with one of the ZMQ arguments provided: `bitcoind -regtest -noconf -datadir=(mktemp -d) -rpcuser=user -rpcpassword=password -rpcport=18888 -port=17777 -zmqpubrawblock=tcp://localhost:10000`\n2. Spawn a second node with the same ZMQ argument(s): `bitcoind -regtest -noconf -datadir=(mktemp -d) -rpcuser=user -rpcpassword=password -rpcport=18889 -port=17778 -zmqpubrawblock=tcp://localhost:10000`\n3. Observe that both nodes run just fine, but that just the first one is able to bind to the ZMQ address:\n   ```\n   ❯ bitcoin-cli -rpcport=18888 -rpcuser=user -rpcpassword=password getzmqnotifications\n   [\n      {\n        \"type\": \"pubrawblock\",\n        \"address\": \"tcp://localhost:10000\",\n        \"hwm\": 1000\n      }\n    ]\n\n    ❯ bitcoin-cli -rpcport=18889 -rpcuser=user -rpcpassword=password getzmqnotifications\n    [\n    ]\n    ```\n4. Observe that no clear warnings/errors are produced from the second node. \n\n### Relevant log output\n\n<details>\n❯ bitcoind -regtest -noconf -datadir=(mktemp -d) -rpcuser=user -rpcpassword=password -rpcport=18889 -port=17778 -zmqpubrawblock=tcp://localhost:10000\n2025-10-27T17:10:29Z Bitcoin Core version v29.0.0 (release build)\n2025-10-27T17:10:29Z Using the 'arm_shani(1way,2way)' SHA256 implementation\n2025-10-27T17:10:29Z Default data directory /Users/torkel/Library/Application Support/Bitcoin\n2025-10-27T17:10:29Z Using data directory /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest\n2025-10-27T17:10:29Z Config file: <disabled>\n2025-10-27T17:10:29Z Command-line arg: conf=false\n2025-10-27T17:10:29Z Command-line arg: datadir=\"/var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy\"\n2025-10-27T17:10:29Z Command-line arg: port=\"17778\"\n2025-10-27T17:10:29Z Command-line arg: regtest=\"\"\n2025-10-27T17:10:29Z Command-line arg: rpcpassword=****\n2025-10-27T17:10:29Z Command-line arg: rpcport=\"18889\"\n2025-10-27T17:10:29Z Command-line arg: rpcuser=****\n2025-10-27T17:10:29Z Command-line arg: zmqpubrawblock=\"tcp://localhost:10000\"\n2025-10-27T17:10:29Z Using at most 125 automatic connections (285 file descriptors available)\n2025-10-27T17:10:29Z scheduler thread start\n2025-10-27T17:10:29Z Binding RPC on address ::1 port 18889\n2025-10-27T17:10:29Z Binding RPC on address 127.0.0.1 port 18889\n2025-10-27T17:10:29Z Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\n2025-10-27T17:10:29Z Starting HTTP server with 16 worker threads\n2025-10-27T17:10:29Z Using wallet directory /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/wallets\n2025-10-27T17:10:29Z init message: Verifying wallet(s)…\n2025-10-27T17:10:29Z Using /16 prefix for IP bucketing\n2025-10-27T17:10:29Z init message: Loading P2P addresses…\n2025-10-27T17:10:29Z Creating peers.dat because the file was not found (\"/var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/peers.dat\")\n2025-10-27T17:10:29Z init message: Loading banlist…\n2025-10-27T17:10:29Z Recreating the banlist database\n2025-10-27T17:10:29Z SetNetworkActive: true\n2025-10-27T17:10:29Z /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/fee_estimates.dat is not found. Continue anyway.\n2025-10-27T17:10:29Z Cache configuration:\n2025-10-27T17:10:29Z * Using 2.0 MiB for block index database\n2025-10-27T17:10:29Z * Using 8.0 MiB for chain state database\n2025-10-27T17:10:29Z * Using 440.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\n2025-10-27T17:10:29Z Script verification uses 11 additional threads\n2025-10-27T17:10:29Z Using obfuscation key for blocksdir *.dat files (/var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/blocks): 'e386ebca6b3ba7e8'\n2025-10-27T17:10:29Z Opening LevelDB in /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/blocks/index\n2025-10-27T17:10:29Z Opened LevelDB successfully\n2025-10-27T17:10:29Z Using obfuscation key for /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/blocks/index: 0000000000000000\n2025-10-27T17:10:29Z Using 16 MiB out of 16 MiB requested for signature cache, able to store 524288 elements\n2025-10-27T17:10:29Z Using 16 MiB out of 16 MiB requested for script execution cache, able to store 524288 elements\n2025-10-27T17:10:29Z init message: Loading block index…\n2025-10-27T17:10:29Z Validating signatures for all blocks.\n2025-10-27T17:10:29Z Setting nMinimumChainWork=0000000000000000000000000000000000000000000000000000000000000000\n2025-10-27T17:10:29Z LoadBlockIndexDB: last block file = 0\n2025-10-27T17:10:29Z LoadBlockIndexDB: last block file info: CBlockFileInfo(blocks=0, size=0, heights=0...0, time=1970-01-01...1970-01-01)\n2025-10-27T17:10:29Z Checking all blk files are present...\n2025-10-27T17:10:29Z Initializing chainstate Chainstate [ibd] @ height -1 (null)\n2025-10-27T17:10:29Z Opening LevelDB in /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/chainstate\n2025-10-27T17:10:29Z Opened LevelDB successfully\n2025-10-27T17:10:29Z Wrote new obfuscate key for /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/chainstate: 224e6c7c34b6b019\n2025-10-27T17:10:29Z Using obfuscation key for /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.0w5H0uf0Uy/regtest/chainstate: 224e6c7c34b6b019\n2025-10-27T17:10:29Z init message: Verifying blocks…\n2025-10-27T17:10:29Z Block index and chainstate loaded\n2025-10-27T17:10:29Z Setting NODE_NETWORK on non-prune mode\n2025-10-27T17:10:29Z initload thread start\n2025-10-27T17:10:29Z UpdateTip: new best=0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206 height=0 version=0x00000001 log2_work=1.000000 tx=1 date='2011-02-02T23:16:42Z' progress=1.000000 cache=0.3MiB(0txo)\n2025-10-27T17:10:29Z block tree size = 1\n2025-10-27T17:10:29Z nBestHeight = 0\n2025-10-27T17:10:29Z Failed to open mempool file. Continuing anyway.\n2025-10-27T17:10:29Z initload thread exit\n2025-10-27T17:10:29Z torcontrol thread start\n2025-10-27T17:10:29Z Bound to 127.0.0.1:17779\n2025-10-27T17:10:29Z Bound to [::]:17778\n2025-10-27T17:10:29Z Bound to 0.0.0.0:17778\n2025-10-27T17:10:29Z 0 block-relay-only anchors will be tried for connections.\n2025-10-27T17:10:29Z init message: Starting network threads…\n2025-10-27T17:10:29Z net thread start\n2025-10-27T17:10:29Z dnsseed thread start\n2025-10-27T17:10:29Z addcon thread start\n2025-10-27T17:10:29Z msghand thread start\n2025-10-27T17:10:29Z Loading addresses from DNS seed dummySeed.invalid.\n2025-10-27T17:10:29Z init message: Done loading\n2025-10-27T17:10:29Z opencon thread start\n2025-10-27T17:10:29Z 0 addresses found from DNS seeds\n2025-10-27T17:10:29Z dnsseed thread exit\n\n❯ bitcoind -regtest -noconf -datadir=(mktemp -d) -rpcuser=user -rpcpassword=password -rpcport=18889 -port=17778 -zmqpubrawblock=tcp://localhost:10000 -debug\n2025-10-27T17:12:31Z Bitcoin Core version v29.0.0 (release build)\n2025-10-27T17:12:31Z Using the 'arm_shani(1way,2way)' SHA256 implementation\n2025-10-27T17:12:31Z [rand] Feeding 22886 bytes of environment data into RNG\n2025-10-27T17:12:31Z Default data directory /Users/torkel/Library/Application Support/Bitcoin\n2025-10-27T17:12:31Z Using data directory /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.DuVJxjyfXp/regtest\n2025-10-27T17:12:31Z Config file: <disabled>\n2025-10-27T17:12:31Z Command-line arg: conf=false\n2025-10-27T17:12:31Z Command-line arg: datadir=\"/var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.DuVJxjyfXp\"\n2025-10-27T17:12:31Z Command-line arg: debug=\"\"\n2025-10-27T17:12:31Z Command-line arg: port=\"17778\"\n2025-10-27T17:12:31Z Command-line arg: regtest=\"\"\n2025-10-27T17:12:31Z Command-line arg: rpcpassword=****\n2025-10-27T17:12:31Z Command-line arg: rpcport=\"18889\"\n2025-10-27T17:12:31Z Command-line arg: rpcuser=****\n2025-10-27T17:12:31Z Command-line arg: zmqpubrawblock=\"tcp://localhost:10000\"\n2025-10-27T17:12:31Z Using at most 125 automatic connections (285 file descriptors available)\n2025-10-27T17:12:31Z scheduler thread start\n2025-10-27T17:12:31Z [http] Allowing HTTP connections from: 127.0.0.0/8 ::1/128\n2025-10-27T17:12:31Z Binding RPC on address ::1 port 18889\n2025-10-27T17:12:31Z [libevent] event_add: event: 0x6000025c8038 (fd 10), EV_READ    call 0x100dee7b0\n2025-10-27T17:12:31Z [libevent] Bound to port 18889 - Awaiting connections ...\n2025-10-27T17:12:31Z Binding RPC on address 127.0.0.1 port 18889\n2025-10-27T17:12:31Z [libevent] event_add: event: 0x6000025c80f8 (fd 11), EV_READ    call 0x100dee7b0\n2025-10-27T17:12:31Z [libevent] Bound to port 18889 - Awaiting connections ...\n2025-10-27T17:12:31Z [http] Initialized HTTP server\n2025-10-27T17:12:31Z [http] creating work queue of depth 64\n2025-10-27T17:12:31Z [rpc] Starting RPC\n2025-10-27T17:12:31Z [rpc] Starting HTTP RPC server\n2025-10-27T17:12:31Z Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\n2025-10-27T17:12:31Z [http] Registering HTTP handler for / (exactmatch 1)\n2025-10-27T17:12:31Z [http] Registering HTTP handler for /wallet/ (exactmatch 0)\n2025-10-27T17:12:31Z Starting HTTP server with 16 worker threads\n2025-10-27T17:12:31Z [http] Entering http event loop\n2025-10-27T17:12:31Z Using wallet directory /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.DuVJxjyfXp/regtest/wallets\n2025-10-27T17:12:31Z init message: Verifying wallet(s)…\n2025-10-27T17:12:31Z Using /16 prefix for IP bucketing\n2025-10-27T17:12:31Z init message: Loading P2P addresses…\n2025-10-27T17:12:31Z Creating peers.dat because the file was not found (\"/var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.DuVJxjyfXp/regtest/peers.dat\")\n2025-10-27T17:12:31Z init message: Loading banlist…\n2025-10-27T17:12:31Z Recreating the banlist database\n2025-10-27T17:12:31Z [net] Flushed 0 banned node addresses/subnets to disk  0ms\n2025-10-27T17:12:31Z [net] setting try another outbound peer=false\n2025-10-27T17:12:31Z SetNetworkActive: true\n2025-10-27T17:12:31Z /var/folders/91/w34lrpx12hl46htkt8l7ntph0000gn/T/tmp.DuVJxjyfXp/regtest/fee_estimates.dat is not found. Continue anyway.\n2025-10-27T17:12:31Z [zmq] version 4.3.5\n2025-10-27T17:12:31Z [zmq] Initialize notification interface\n2025-10-27T17:12:31Z [zmq] Outbound message high water mark for pubrawblock at tcp://localhost:10000 is 1000\n2025-10-27T17:12:31Z [zmq] Error: Failed to bind address, msg: Address already in use\n2025-10-27T17:12:31Z [zmq] Notifier pubrawblock failed (address = tcp://localhost:10000)\n2025-10-27T17:12:31Z [zmq] Shutdown notification interface\n2025-10-27T17:12:31Z [zmq] Shutdown notifier pubrawblock at tcp://localhost:10000\n</details>\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nv29.0.0\n\n### Operating system and version\n\nMacOS 15.6\n\n### Machine specifications\n\n_No response_\n",
    "user": {
      "login": "torkelrogstad",
      "id": 16610775,
      "node_id": "MDQ6VXNlcjE2NjEwNzc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/16610775?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/torkelrogstad",
      "html_url": "https://github.com/torkelrogstad",
      "followers_url": "https://api.github.com/users/torkelrogstad/followers",
      "following_url": "https://api.github.com/users/torkelrogstad/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/torkelrogstad/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/torkelrogstad/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/torkelrogstad/subscriptions",
      "organizations_url": "https://api.github.com/users/torkelrogstad/orgs",
      "repos_url": "https://api.github.com/users/torkelrogstad/repos",
      "events_url": "https://api.github.com/users/torkelrogstad/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/torkelrogstad/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 0,
    "created_at": "2025-10-27T17:16:37Z",
    "updated_at": "2025-10-27T17:18:24Z"
  },
  "events": []
}