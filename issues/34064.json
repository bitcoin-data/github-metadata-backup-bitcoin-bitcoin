{
  "type": "issue",
  "issue": {
    "id": 3724650829,
    "node_id": "I_kwDOABII587eAalN",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34064",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34064/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34064/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34064/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/34064",
    "number": 34064,
    "state": "open",
    "state_reason": null,
    "title": "Wallet: gettransaction(txid).details changes after confirmation of RBF replacement",
    "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nFor a replaced transaction (txA), the output of gettransaction(txA, true).details\nchanges after the replacement transaction (txB) is confirmed.\n\nSpecifically, a 'receive' entry present after bumpfee disappears once txB is\nconfirmed, even though the queried txid remains txA.\n\nAfter confirmation, repeated calls are stable.\n\n\n### Expected behaviour\n\nFor a given txid, gettransaction(txid).details should be stable once the\nreplacement transaction has been confirmed, or at minimum should not\nretroactively add or remove details entries in a way that changes accounting\ninterpretation for the same transaction id.\n\n\n### Steps to reproduce\n\n1. Create a transaction (txA) from a descriptor wallet.\n2. Replace txA using bumpfee, creating txB.\n3. Query gettransaction(txA, true) and record details.\n4. Mine blocks to confirm txB.\n5. Query gettransaction(txA, true) again and compare details.\n\nA minimal reproduction package and proof artifacts are attached below.\n\n[x3_mini_package.tar.gz](https://github.com/user-attachments/files/24134210/x3_mini_package.tar.gz)\n\nSHA-256 (x3_mini_package.tar.gz):\n47413632eab190a2c2477b0d2f8128bc956326ae3765d8fbf6b2a9da5046a617\n\n### Relevant log output\n\nNo debug.log output is required; the issue is observable via wallet RPC output.\n\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\n27.0\n\n### Operating system and version\n\nUbuntu 22.04 LTS (regtest environment)\n\n### Machine specifications\n\nStandard x86_64 Linux host, SSD storage, regtest environment.",
    "user": {
      "login": "husstege-e",
      "id": 247751831,
      "node_id": "U_kgDODsRklw",
      "avatar_url": "https://avatars.githubusercontent.com/u/247751831?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/husstege-e",
      "html_url": "https://github.com/husstege-e",
      "followers_url": "https://api.github.com/users/husstege-e/followers",
      "following_url": "https://api.github.com/users/husstege-e/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/husstege-e/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/husstege-e/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/husstege-e/subscriptions",
      "organizations_url": "https://api.github.com/users/husstege-e/orgs",
      "repos_url": "https://api.github.com/users/husstege-e/repos",
      "events_url": "https://api.github.com/users/husstege-e/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/husstege-e/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      },
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 1,
    "created_at": "2025-12-12T19:53:39Z",
    "updated_at": "2025-12-22T21:43:37Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 21542229141,
      "node_id": "LE_lADOABII587eAalNzwAAAAUEBFSV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21542229141",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-13T12:55:20Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "labeled",
      "id": 21542229144,
      "node_id": "LE_lADOABII587eAalNzwAAAAUEBFSY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21542229144",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-13T12:55:20Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "commented",
      "id": 3684281115,
      "node_id": "IC_kwDOABII587bmasb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3684281115",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-22T21:43:37Z",
      "updated_at": "2025-12-22T21:43:37Z",
      "author_association": "MEMBER",
      "body": "This is expected behavior. When a transaction becomes conflicted (i.e. a conflict is confirmed in the main chain), we don't want to show any details that might make the user think they have more or less money than they actually do.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34064#issuecomment-3684281115",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34064"
    }
  ]
}