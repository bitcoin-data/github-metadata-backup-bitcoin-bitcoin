{
  "type": "issue",
  "issue": {
    "id": 3764874848,
    "node_id": "I_kwDOABII587gZ25g",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/34159",
    "number": 34159,
    "state": "open",
    "state_reason": null,
    "title": "ci: failure in p2p_addr_selfannouncement.py",
    "body": "https://github.com/bitcoin/bitcoin/actions/runs/20445863729/job/58749036885#step:9:3498:\n```bash\n test  2025-12-22T23:47:48.293698Z TestFramework.p2p (DEBUG): Received message from 127.0.0.1:12164: msg_pong(nonce=00000000) \n test  2025-12-22T23:47:48.293794Z TestFramework.p2p (DEBUG): Received message from 127.0.0.1:12164: msg_pong(nonce=00000006) \n test  2025-12-22T23:47:48.344658Z TestFramework (ERROR): Unexpected exception \n                                   Traceback (most recent call last):\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/test_framework.py\", line 142, in main\n                                       self.run_test()\n                                       ~~~~~~~~~~~~~^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/build-aarch64-apple-darwin24.6.0/test/functional/p2p_addr_selfannouncement.py\", line 67, in run_test\n                                       self.self_announcement_test(outbound=False, addrv2=True)\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/build-aarch64-apple-darwin24.6.0/test/functional/p2p_addr_selfannouncement.py\", line 135, in self_announcement_test\n                                       assert_equal(addr_receiver.self_announcements_received, last_self_announcements_received + 1)\n                                       ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                     File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/util.py\", line 80, in assert_equal\n                                       raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\n                                   AssertionError: not(4 == 5)\n test  2025-12-22T23:47:48.347601Z TestFramework (DEBUG): Closing down network thread \n```",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 12,
    "created_at": "2025-12-27T15:55:09Z",
    "updated_at": "2026-01-02T12:36:11Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 3694307035,
      "node_id": "IC_kwDOABII587cMqbb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694307035",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T23:58:31Z",
      "updated_at": "2025-12-27T23:58:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "Will try to reproduce it. I suspect this is a addr message timestamp issue. Previously, I had something like this:\n\n```python\n  # The tricky part of this test is the timestamp of the self-announcement.\n  # The following helped me to debug timestamp mismatches, so I'm leaving it in for the next one.\n  elif addr.ip == self.expected.ip and addr.port == self.expected.port and addr.nServices == self.expected.nServices:\n      print(f\"Self-announcement timestamp mismatch: got={addr.time} expected={self.expected.time}\")\n```\nto catch them, but dropped it in https://github.com/bitcoin/bitcoin/pull/34039#discussion_r2628081222 ",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3694307035",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "referenced",
      "id": 21767579559,
      "node_id": "REFE_lADOABII587gZ25gzwAAAAURcuen",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21767579559",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b3fef39e025e72d90684b6e2997fcd984b306508",
      "commit_url": "https://api.github.com/repos/0xB10C/bitcoin/commits/b3fef39e025e72d90684b6e2997fcd984b306508",
      "created_at": "2025-12-28T00:07:25Z"
    },
    {
      "event": "commented",
      "id": 3694594420,
      "node_id": "IC_kwDOABII587cNwl0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694594420",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T09:16:06Z",
      "updated_at": "2025-12-28T09:16:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "can reproduce with b3fef39: `Self-announcement timestamp mismatch: got=2656803201 expected=2655075201`\n\n```\n2025-12-28T00:54:24.0578490Z 2025-12-28T00:53:21.268810Z TestFramework (INFO): Test that the node does an address self-announcement to inbound connections (addrv1)\n2025-12-28T00:54:24.0682490Z 2025-12-28T00:53:21.269773Z TestFramework (INFO): Check that we get an initial self-announcement when connecting to a node and sending a GETADDR (inbound, addrv1)\n2025-12-28T00:54:24.0783520Z 2025-12-28T00:53:21.733615Z TestFramework (INFO): Check that we get more self-announcements sometime later (inbound, addrv1)\n2025-12-28T00:54:24.0884810Z Self-announcement timestamp mismatch: got=2656803201 expected=2655075201\n2025-12-28T00:54:24.0985270Z 2025-12-28T00:54:23.651301Z TestFramework (ERROR): Unexpected exception\n2025-12-28T00:54:24.1004690Z Traceback (most recent call last):\n2025-12-28T00:54:24.1005350Z   File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/test_framework.py\", line 142, in main\n2025-12-28T00:54:24.1006280Z     self.run_test()\n2025-12-28T00:54:24.1006580Z     ~~~~~~~~~~~~~^^\n2025-12-28T00:54:24.1008060Z   File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/build-aarch64-apple-darwin24.6.0/test/functional/p2p_addr_selfannouncement.py\", line 70, in run_test\n2025-12-28T00:54:24.1008940Z     self.self_announcement_test(outbound=False, addrv2=False)\n2025-12-28T00:54:24.1010810Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n2025-12-28T00:54:24.1011690Z   File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/build-aarch64-apple-darwin24.6.0/test/functional/p2p_addr_selfannouncement.py\", line 139, in self_announcement_test\n2025-12-28T00:54:24.1012630Z     assert_equal(addr_receiver.self_announcements_received, last_self_announcements_received + 1)\n2025-12-28T00:54:24.1013240Z     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n2025-12-28T00:54:24.1014500Z   File \"/Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/test_framework/util.py\", line 80, in assert_equal\n2025-12-28T00:54:24.1015240Z     raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\n2025-12-28T00:54:24.1017350Z AssertionError: not(515 == 516)\n2025-12-28T00:54:24.1019860Z 2025-12-28T00:54:23.840132Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2025-12-28T00:54:24.1021170Z 2025-12-28T00:54:23.840292Z TestFramework (WARNING): Not cleaning up dir /Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/test_runner/test_runner_â‚¿_ðŸƒ_20251228_003917/p2p_addr_selfannouncement_97\n2025-12-28T00:54:24.1025000Z 2025-12-28T00:54:23.840351Z TestFramework (ERROR): Test failed. Test logging available at /Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/test_runner/test_runner_â‚¿_ðŸƒ_20251228_003917/p2p_addr_selfannouncement_97/test_framework.log\n2025-12-28T00:54:24.1026100Z 2025-12-28T00:54:23.841833Z TestFramework (ERROR): \n2025-12-28T00:54:24.1027130Z 2025-12-28T00:54:23.842117Z TestFramework (ERROR): Hint: Call /Users/runner/work/bitcoin/bitcoin/repo_archive/test/functional/combine_logs.py '/Users/runner/work/bitcoin/bitcoin/repo_archive/ci/scratch/test_runner/test_runner_â‚¿_ðŸƒ_20251228_003917/p2p_addr_selfannouncement_97' to consolidate all logs\n2025-12-28T00:54:24.1028120Z 2025-12-28T00:54:23.842206Z TestFramework (ERROR): \n2025-12-28T00:54:24.1028740Z 2025-12-28T00:54:23.842385Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2025-12-28T00:54:24.1029540Z 2025-12-28T00:54:23.843333Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2025-12-28T00:54:24.1030030Z 2025-12-28T00:54:23.844562Z TestFramework (ERROR): \n```",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3694594420",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3699588015,
      "node_id": "IC_kwDOABII587cgzuv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3699588015",
      "actor": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-30T14:51:39Z",
      "updated_at": "2025-12-30T14:51:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "> can reproduce with [b3fef39](https://github.com/bitcoin/bitcoin/commit/b3fef39e025e72d90684b6e2997fcd984b306508): `Self-announcement timestamp mismatch: got=2656803201 expected=2655075201`\n\nI havenâ€™t been able to reproduce this, Is the time difference btwn `got `and` expected,` consistently 20 day ? \n",
      "user": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3699588015",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3699856593,
      "node_id": "IC_kwDOABII587ch1TR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3699856593",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-30T16:20:19Z",
      "updated_at": "2025-12-30T16:20:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > can reproduce with [b3fef39](https://github.com/bitcoin/bitcoin/commit/b3fef39e025e72d90684b6e2997fcd984b306508): `Self-announcement timestamp mismatch: got=2656803201 expected=2655075201`\n> \n> I havenâ€™t been able to reproduce this, Is the time difference btwn `got `and` expected,` consistently 20 day ?\n\nSorry, I didn't link to https://github.com/0xB10C/bitcoin/actions/runs/20546158233 - I'm not seeing the failure locally, just in CI.\n\nI was playing around with it in https://github.com/0xB10C/bitcoin/pull/15, and I think one options is to be less strict about the timestamp similar to:\n\n```patch\n        self.addr_messages_received += 1\n        for addr in message.addrs:\n            self.addresses_received += 1\n-           if addr == self.expected:\n+           if addr.time >= self.expected.time and addr.ip == self.expected.ip and addr.port == self.expected.port and addr.nServices == self.expected.nServices:\n                self.self_announcements_received += 1\n```",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3699856593",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3701994621,
      "node_id": "IC_kwDOABII587cp_R9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3701994621",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T11:09:03Z",
      "updated_at": "2025-12-31T11:09:03Z",
      "author_association": "MEMBER",
      "body": "On OmniOS, https://github.com/hebasto/bitcoin-core-nightly/actions/runs/20611492118/job/59196832666:\n```\n181/282 - p2p_addr_selfannouncement.py failed, Duration: 1 s\n\nstdout:\n2025-12-31T04:29:42.401827Z TestFramework (INFO): PRNG seed is: 12631707991788085\n2025-12-31T04:29:42.403417Z TestFramework (INFO): Initializing test directory /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_â‚¿_ðŸƒ_20251231_042118/p2p_addr_selfannouncement_96\n2025-12-31T04:29:43.082640Z TestFramework (INFO): Test that the node does an address self-announcement to inbound connections (addrv1)\n2025-12-31T04:29:43.087917Z TestFramework (INFO): Check that we get an initial self-announcement when connecting to a node and sending a GETADDR (inbound, addrv1)\n2025-12-31T04:29:43.285933Z TestFramework (INFO): Check that we get more self-announcements sometime later (inbound, addrv1)\n2025-12-31T04:29:43.380398Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 142, in main\n    self.run_test()\n    ~~~~~~~~~~~~~^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/build/test/functional/p2p_addr_selfannouncement.py\", line 66, in run_test\n    self.self_announcement_test(outbound=False, addrv2=False)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/build/test/functional/p2p_addr_selfannouncement.py\", line 135, in self_announcement_test\n    assert_equal(addr_receiver.self_announcements_received, last_self_announcements_received + 1)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/util.py\", line 80, in assert_equal\n    raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\nAssertionError: not(1 == 2)\n2025-12-31T04:29:43.445243Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2025-12-31T04:29:43.445591Z TestFramework (WARNING): Not cleaning up dir /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_â‚¿_ðŸƒ_20251231_042118/p2p_addr_selfannouncement_96\n2025-12-31T04:29:43.445763Z TestFramework (ERROR): Test failed. Test logging available at /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_â‚¿_ðŸƒ_20251231_042118/p2p_addr_selfannouncement_96/test_framework.log\n2025-12-31T04:29:43.446523Z TestFramework (ERROR): \n2025-12-31T04:29:43.446782Z TestFramework (ERROR): Hint: Call /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/combine_logs.py '/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_â‚¿_ðŸƒ_20251231_042118/p2p_addr_selfannouncement_96' to consolidate all logs\n2025-12-31T04:29:43.446907Z TestFramework (ERROR): \n2025-12-31T04:29:43.447013Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2025-12-31T04:29:43.447489Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2025-12-31T04:29:43.447623Z TestFramework (ERROR): \n\n\nstderr:\n[node 0] Cleaning up leftover process\n\n```",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3701994621",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3702130446,
      "node_id": "IC_kwDOABII587cqgcO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3702130446",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T12:37:58Z",
      "updated_at": "2025-12-31T12:37:58Z",
      "author_association": "MEMBER",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/20546486544/job/59017686783?pr=34156#step:11:3758",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3702130446",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3702132551,
      "node_id": "IC_kwDOABII587cqg9H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3702132551",
      "actor": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T12:39:27Z",
      "updated_at": "2025-12-31T12:39:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Sorry, I didn't link to https://github.com/0xB10C/bitcoin/actions/runs/20546158233 - I'm not seeing the failure locally, just I\n\nI think this happens when there's a delay between calling `bumpmocktime() `and updating `expected.time`.\n\ntried this locally:\n\n```diff\n+++ b/test/functional/p2p_addr_selfannouncement.py\n@@ -37,11 +37,14 @@ class SelfAnnouncementReceiver(P2PInterface):\n         self.addrv2_test = addrv2\n \n     def handle_addr_message(self, message):\n+        print(f\">>> HANDLE_ADDR_MESSAGE called, expected.time={self.expected.time}\")\n         self.addr_messages_received += 1\n         for addr in message.addrs:\n             self.addresses_received += 1\n             if addr == self.expected:\n                 self.self_announcements_received += 1\n+            elif addr.ip == self.expected.ip and addr.port == self.expected.port and addr.nServices == self.expected.nServices:\n+                print(f\"Self-announcement timestamp mismatch: got={addr.time} expected={self.expected.time}\")\n \n     def on_addrv2(self, message):\n         assert (self.addrv2_test)\n@@ -119,7 +122,7 @@ class AddrSelfAnnouncementTest(BitcoinTestFramework):\n             addr_receiver.send_and_ping(msg_headers([tip_header]))\n \n         self.log.info(f\"Check that we get more self-announcements sometime later ({connection_type}, {addr_version})\")\n-        for _ in range(5):\n+        for _ in range(500):\n             last_self_announcements_received = addr_receiver.self_announcements_received\n             last_addr_messages_received = addr_receiver.addr_messages_received\n             last_addresses_received = addr_receiver.addresses_received\n@@ -128,7 +131,10 @@ class AddrSelfAnnouncementTest(BitcoinTestFramework):\n                 # self-announcements are sent on an exponential distribution with mean interval of 24h.\n                 # Setting the mocktime 20d forward gives a probability of (1 - e^-(480/24)) that\n                 # the event will occur (i.e. this fails once in ~500 million repeats).\n+                print(f\"BEFORE bumpmocktime()\")\n                 self.nodes[0].bumpmocktime(20 * ONE_DAY)\n+                time.sleep(0.1)\n+                print(f\"AFTER bumpmocktime(), before setting expected.time\")\n                 addr_receiver.expected.time = self.nodes[0].mocktime\n\n```\n\n",
      "user": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3702132551",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3702144151,
      "node_id": "IC_kwDOABII587cqjyX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3702144151",
      "actor": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T12:47:00Z",
      "updated_at": "2025-12-31T12:47:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "got this with the diff above \n\n```\n2025-12-31T12:39:50.147708Z TestFramework (INFO): Check that we get an initial self-announcement when connecting to a node and sending a GETADDR (inbound, addrv1)\n>>> HANDLE_ADDR_MESSAGE called, expected.time=1767184790\n2025-12-31T12:39:50.304489Z TestFramework (INFO): Check that we get more self-announcements sometime later (inbound, addrv1)\nBEFORE bumpmocktime()\n>>> HANDLE_ADDR_MESSAGE called, expected.time=1767184790\nSelf-announcement timestamp mismatch: got=1768912790 expected=1767184790\nAFTER bumpmocktime(), before setting expected.time\n2025-12-31T12:39:50.459889Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/ubuntu/Projects/bitcoin/test/functional/test_framework/test_framework.py\", line 142, in main\n    self.run_test()\n  File \"/home/ubuntu/Projects/bitcoin/./build/test/functional/p2p_addr_selfannouncement.py\", line 69, in run_test\n    self.self_announcement_test(outbound=False, addrv2=False)\n  File \"/home/ubuntu/Projects/bitcoin/./build/test/functional/p2p_addr_selfannouncement.py\", line 141, in self_announcement_test\n    assert_equal(addr_receiver.self_announcements_received, last_self_announcements_received + 1)\n  File \"/home/ubuntu/Projects/bitcoin/test/functional/test_framework/util.py\", line 80, in assert_equal\n    raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\nAssertionError: not(1 == 2)\n```\n",
      "user": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3702144151",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3702211869,
      "node_id": "IC_kwDOABII587cq0Ud",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3702211869",
      "actor": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T13:27:28Z",
      "updated_at": "2025-12-31T13:27:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I was playing around with it in [0xB10C#15](https://github.com/0xB10C/bitcoin/pull/15), and I think one options is to be less strict about the timestamp similar to:\n\n>           if addr.time >= self.expected.time and addr.ip == self.expected.ip and addr.port == self.expected.port and addr.nServices == self.expected.nServices:\n\n\nI'm not sure this is always the case. Is it possible that `addr.time <= self.expected.time` could occur ? i think checking ip,port,service is sufficient.",
      "user": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3702211869",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3702328175,
      "node_id": "IC_kwDOABII587crQtv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3702328175",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T14:46:18Z",
      "updated_at": "2025-12-31T14:46:18Z",
      "author_association": "MEMBER",
      "body": "On NetBSD 9.4, https://github.com/hebasto/bitcoin-core-nightly/actions/runs/20619499569/job/59218560248:\n```\n182/282 - p2p_addr_selfannouncement.py failed, Duration: 6 s\n\nstdout:\n2025-12-31T14:10:01.054524Z TestFramework (INFO): PRNG seed is: 279208991052383101\n2025-12-31T14:10:01.060063Z TestFramework (INFO): Initializing test directory /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_â‚¿_ðŸƒ_20251231_135038/p2p_addr_selfannouncement_96\n2025-12-31T14:10:03.459488Z TestFramework (INFO): Test that the node does an address self-announcement to inbound connections (addrv1)\n2025-12-31T14:10:03.472186Z TestFramework (INFO): Check that we get an initial self-announcement when connecting to a node and sending a GETADDR (inbound, addrv1)\n2025-12-31T14:10:04.247264Z TestFramework (INFO): Check that we get more self-announcements sometime later (inbound, addrv1)\n2025-12-31T14:10:04.961413Z TestFramework (INFO): Test that the node does an address self-announcement to inbound connections (addrv2)\n2025-12-31T14:10:04.963778Z TestFramework (INFO): Check that we get an initial self-announcement when connecting to a node and sending a GETADDR (inbound, addrv2)\n2025-12-31T14:10:05.115558Z TestFramework (INFO): Check that we get more self-announcements sometime later (inbound, addrv2)\n2025-12-31T14:10:05.739087Z TestFramework (ERROR): Unexpected exception\nTraceback (most recent call last):\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/test_framework.py\", line 142, in main\n    self.run_test()\n    ~~~~~~~~~~~~~^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/build/test/functional/p2p_addr_selfannouncement.py\", line 67, in run_test\n    self.self_announcement_test(outbound=False, addrv2=True)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/build/test/functional/p2p_addr_selfannouncement.py\", line 135, in self_announcement_test\n    assert_equal(addr_receiver.self_announcements_received, last_self_announcements_received + 1)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/test_framework/util.py\", line 80, in assert_equal\n    raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\nAssertionError: not(5 == 6)\n2025-12-31T14:10:05.745570Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n2025-12-31T14:10:05.745741Z TestFramework (WARNING): Not cleaning up dir /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_â‚¿_ðŸƒ_20251231_135038/p2p_addr_selfannouncement_96\n2025-12-31T14:10:05.745854Z TestFramework (ERROR): Test failed. Test logging available at /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_â‚¿_ðŸƒ_20251231_135038/p2p_addr_selfannouncement_96/test_framework.log\n2025-12-31T14:10:05.746147Z TestFramework (ERROR): \n2025-12-31T14:10:05.746352Z TestFramework (ERROR): Hint: Call /home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test/functional/combine_logs.py '/home/runner/work/bitcoin-core-nightly/bitcoin-core-nightly/test_runner_â‚¿_ðŸƒ_20251231_135038/p2p_addr_selfannouncement_96' to consolidate all logs\n2025-12-31T14:10:05.746466Z TestFramework (ERROR): \n2025-12-31T14:10:05.746574Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n2025-12-31T14:10:05.746787Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n2025-12-31T14:10:05.746885Z TestFramework (ERROR): \n\n\nstderr:\n[node 0] Cleaning up leftover process\n\n```",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3702328175",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3702389244,
      "node_id": "IC_kwDOABII587crfn8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3702389244",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T15:26:50Z",
      "updated_at": "2025-12-31T15:26:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I'm not sure this is always the case. Is it possible that `addr.time <= self.expected.time` could occur ? i think checking ip,port,service is sufficient.\n\nthat would work around the issue, but I think we should have coverage for the self-announcement timestamp being correct(ish). \n\n> I think this happens when there's a delay between calling bumpmocktime() and updating expected.time.\n\nAn earlier version of #34039 didn't use `bumpmocktime()`. We could revert to doing:\n\n```python\nself.mocktime += 20 * ONE_DAY\naddr_receiver.expected.time = self.mocktime\nself.nodes[0].setmocktime(self.mocktime)\naddr_receiver.sync_with_ping()\n```\n\nto make sure the expected timestamp is set before bumping the mocktime.",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3702389244",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    },
    {
      "event": "commented",
      "id": 3705241246,
      "node_id": "IC_kwDOABII587c2X6e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3705241246",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-02T12:36:11Z",
      "updated_at": "2026-01-02T12:36:11Z",
      "author_association": "MEMBER",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/20656499701/job/59310311647#step:9:3863",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34159#issuecomment-3705241246",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34159"
    }
  ]
}