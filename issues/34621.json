{
  "type": "issue",
  "issue": {
    "id": 3963109090,
    "node_id": "I_kwDOABII587sOD7i",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34621",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34621/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34621/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34621/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/34621",
    "number": 34621,
    "state": "open",
    "state_reason": null,
    "title": "qa: Intermittent failure in `p2p_invalid_tx.py`",
    "body": "https://github.com/bitcoin/bitcoin/actions/runs/22181787708/job/64145682186:\n```\n316/455 - p2p_invalid_tx.py --v2transport failed, Duration: 3 s\n\nstdout:\n2026-02-19T12:56:47.242316Z TestFramework (INFO): PRNG seed is: 6348560005473754043\n\n2026-02-19T12:56:47.276714Z TestFramework (INFO): Initializing test directory D:\\a\\bitcoin\\bitcoin\\test_runner_‚Çø_üèÉ_20260219_124134\\p2p_invalid_tx_138\n\n2026-02-19T12:56:47.695785Z TestFramework (INFO): Create a new block with an anyone-can-spend coinbase.\n\n2026-02-19T12:56:47.799348Z TestFramework (INFO): Mature the block.\n\n2026-02-19T12:56:47.976687Z TestFramework (INFO): Testing invalid transaction: OutputMissing\n\n2026-02-19T12:56:48.033913Z TestFramework (INFO): Testing invalid transaction: InputMissing\n\n2026-02-19T12:56:48.086804Z TestFramework (INFO): Testing invalid transaction: SizeTooSmall\n\n2026-02-19T12:56:48.144583Z TestFramework (INFO): Testing invalid transaction: ExtraWitness\n\n2026-02-19T12:56:48.197926Z TestFramework (INFO): Testing invalid transaction: BadInputOutpointIndex\n\n2026-02-19T12:56:48.251347Z TestFramework (INFO): Testing invalid transaction: DuplicateInput\n\n2026-02-19T12:56:48.304591Z TestFramework (INFO): Testing invalid transaction: PrevoutNullInput\n\n2026-02-19T12:56:48.357833Z TestFramework (INFO): Testing invalid transaction: NonexistentInput\n\n2026-02-19T12:56:48.410814Z TestFramework (INFO): Testing invalid transaction: SpendTooMuch\n\n2026-02-19T12:56:48.463890Z TestFramework (INFO): Testing invalid transaction: CreateNegative\n\n2026-02-19T12:56:48.516884Z TestFramework (INFO): Testing invalid transaction: CreateTooLarge\n\n2026-02-19T12:56:48.570317Z TestFramework (INFO): Testing invalid transaction: CreateSumTooLarge\n\n2026-02-19T12:56:48.623911Z TestFramework (INFO): Testing invalid transaction: InvalidOPIFConstruction\n\n2026-02-19T12:56:48.677788Z TestFramework (INFO): Testing invalid transaction: TooManySigopsPerBlock\n\n2026-02-19T12:56:48.787518Z TestFramework (INFO): Testing invalid transaction: TooManySigopsPerTransaction\n\n2026-02-19T12:56:48.851114Z TestFramework (INFO): Testing invalid transaction: NonStandardAndInvalid\n\n2026-02-19T12:56:48.904906Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_CAT\n\n2026-02-19T12:56:48.958373Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_SUBSTR\n\n2026-02-19T12:56:49.011903Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_LEFT\n\n2026-02-19T12:56:49.064977Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_RIGHT\n\n2026-02-19T12:56:49.118325Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_INVERT\n\n2026-02-19T12:56:49.171756Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_AND\n\n2026-02-19T12:56:49.224993Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_OR\n\n2026-02-19T12:56:49.277882Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_XOR\n\n2026-02-19T12:56:49.331221Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_2MUL\n\n2026-02-19T12:56:49.384629Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_2DIV\n\n2026-02-19T12:56:49.437805Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_MUL\n\n2026-02-19T12:56:49.491221Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_DIV\n\n2026-02-19T12:56:49.544034Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_MOD\n\n2026-02-19T12:56:49.596877Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_LSHIFT\n\n2026-02-19T12:56:49.649868Z TestFramework (INFO): Testing invalid transaction: DisabledOpcode_OP_RSHIFT\n\n2026-02-19T12:56:49.960918Z TestFramework (INFO): Test orphan transaction handling ... \n\n2026-02-19T12:56:49.961101Z TestFramework (INFO): Send the orphans ... \n\n2026-02-19T12:56:50.070383Z TestFramework (INFO): Send the withhold tx ... \n\n2026-02-19T12:56:50.124751Z TestFramework (INFO): Test orphanage can store more than 100 transactions\n\n2026-02-19T12:56:50.268148Z TestFramework (INFO): Test orphan with rejected parents\n\n2026-02-19T12:56:50.322356Z TestFramework (INFO): Test that a peer disconnection causes erase its transactions from the orphan pool\n\n2026-02-19T12:56:50.479576Z TestFramework (INFO): Test that a transaction in the orphan pool is included in a new tip block causes erase this transaction from the orphan pool\n\n2026-02-19T12:56:50.479848Z TestFramework (INFO): Send the orphan ... \n\n2026-02-19T12:56:50.486753Z TestFramework (INFO): Send the block that includes the previous orphan ... \n\n2026-02-19T12:56:50.498315Z TestFramework (ERROR): Unexpected exception:\n\nTraceback (most recent call last):\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_framework.py\", line 142, in main\n\n    self.run_test()\n\n    ~~~~~~~~~~~~~^^\n\n  File \"D:\\a\\bitcoin\\bitcoin/test/functional/p2p_invalid_tx.py\", line 180, in run_test\n\n    with node.assert_debug_log([\"Erased 1 orphan transaction(s) included or conflicted by block\"]):\n\n         ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n  File \"C:\\hostedtoolcache\\windows\\Python\\3.14.3\\x64\\Lib\\contextlib.py\", line 148, in __exit__\n\n    next(self.gen)\n\n    ~~~~^^^^^^^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_node.py\", line 584, in assert_debug_log\n\n    self._raise_assertion_error(f'Expected message(s) {remaining_expected!s} '\n\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n                                f'not found in log:\\n\\n{join_log(log)}\\n\\n')\n\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n  File \"D:\\a\\bitcoin\\bitcoin\\test\\functional\\test_framework\\test_node.py\", line 229, in _raise_assertion_error\n\n    raise AssertionError(self._node_msg(msg))\n\nAssertionError: [node 0] Expected message(s) ['Erased 1 orphan transaction(s) included or conflicted by block'] not found in log:\n\n\n\n - 2026-02-19T12:56:50.488541Z [msghand] [net_processing.cpp:3555] [ProcessMessage] [net] received: headers (82 bytes) peer=3\n\n - 2026-02-19T12:56:50.488619Z [msghand] [net_processing.cpp:3526] [LogBlockHeader] Saw new header hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d height=102 peer=3\n\n - 2026-02-19T12:56:50.488674Z [msghand] [net_processing.cpp:2854] [HeadersDirectFetchBlocks] [net] Requesting block 4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d from  peer=3\n\n - 2026-02-19T12:56:50.488691Z [msghand] [net.cpp:4074] [PushMessage] [net] sending getdata (37 bytes) peer=3\n\n - 2026-02-19T12:56:50.489460Z [msghand] [net.cpp:4074] [PushMessage] [net] sending sendheaders (0 bytes) peer=3\n\n - 2026-02-19T12:56:50.492975Z [msghand] [net_processing.cpp:3555] [ProcessMessage] [net] received: block (497 bytes) peer=3\n\n - 2026-02-19T12:56:50.492999Z [msghand] [net_processing.cpp:4841] [ProcessMessage] [net] received block 4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d peer=3\n\n - 2026-02-19T12:56:50.493050Z [msghand] [validationinterface.cpp:261] [NewPoWValidBlock] [validation] NewPoWValidBlock: block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d\n\n - 2026-02-19T12:56:50.493284Z [msghand] [validation.cpp:3062] [ConnectTip] [bench]   - Using cached block\n\n - 2026-02-19T12:56:50.493305Z [msghand] [validation.cpp:3069] [ConnectTip] [bench]   - Load block from disk: 0.02ms\n\n - 2026-02-19T12:56:50.493405Z [msghand] [validation.cpp:2386] [ConnectBlock] [bench]     - Sanity checks: 0.00ms [0.00s (0.00ms/blk)]\n\n - 2026-02-19T12:56:50.493432Z [msghand] [validation.cpp:2488] [ConnectBlock] [bench]     - Fork checks: 0.03ms [0.00s (0.02ms/blk)]\n\n - 2026-02-19T12:56:50.493468Z [msghand] [validation.cpp:2603] [ConnectBlock] [bench]       - Connect 4 transactions: 0.03ms (0.008ms/tx, 0.011ms/txin) [0.00s (0.01ms/blk)]\n\n - 2026-02-19T12:56:50.493493Z [msghand] [validation.cpp:2626] [ConnectBlock] [bench]     - Verify 3 txins: 0.06ms (0.020ms/txin) [0.01s (0.03ms/blk)]\n\n - 2026-02-19T12:56:50.493639Z [msghand] [validation.cpp:2642] [ConnectBlock] [bench]     - Write undo data: 0.14ms [0.01s (0.05ms/blk)]\n\n - 2026-02-19T12:56:50.493657Z [msghand] [validation.cpp:2657] [ConnectBlock] [bench]     - Index writing: 0.02ms [0.00s (0.01ms/blk)]\n\n - 2026-02-19T12:56:50.493671Z [msghand] [validationinterface.cpp:255] [BlockChecked] [validation] BlockChecked: block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d state=Valid\n\n - 2026-02-19T12:56:50.493688Z [msghand] [validation.cpp:3087] [ConnectTip] [bench]   - Connect total: 0.38ms [0.02s (0.11ms/blk)]\n\n - 2026-02-19T12:56:50.493704Z [msghand] [validation.cpp:3095] [ConnectTip] [bench]   - Flush: 0.02ms [0.00s (0.01ms/blk)]\n\n - 2026-02-19T12:56:50.493720Z [msghand] [validation.cpp:3105] [ConnectTip] [bench]   - Writing chainstate: 0.02ms [0.00s (0.01ms/blk)]\n\n - 2026-02-19T12:56:50.493740Z [msghand] [validationinterface.cpp:229] [MempoolTransactionsRemovedForBlock] [validation] Enqueuing MempoolTransactionsRemovedForBlock: block height=102 txs removed=1\n\n - 2026-02-19T12:56:50.493790Z [msghand] [validation.cpp:2873] [UpdateTipLog] UpdateTip: new best=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d height=102 version=0x00000004 log2_work=7.686501 tx=106 date='2026-02-19T13:06:50Z' progress=1.000000 cache=0.3MiB(105txo)\n\n - 2026-02-19T12:56:50.493810Z [msghand] [validation.cpp:3122] [ConnectTip] [bench]   - Connect postprocess: 0.09ms [0.01s (0.05ms/blk)]\n\n - 2026-02-19T12:56:50.493825Z [msghand] [validation.cpp:3126] [ConnectTip] [bench] - Connect block: 0.52ms [0.04s (0.17ms/blk)]\n\n - 2026-02-19T12:56:50.493836Z [msghand] [txmempool.cpp:435] [check] [mempool] Checking mempool with 2 transactions and 2 inputs\n\n - 2026-02-19T12:56:50.493867Z [msghand] [validationinterface.cpp:219] [BlockConnected] [validation] Enqueuing BlockConnected: block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d block height=102\n\n - 2026-02-19T12:56:50.493888Z [msghand] [validationinterface.cpp:182] [UpdatedBlockTip] [validation] Enqueuing UpdatedBlockTip: new block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d fork block hash=1a5c3bc8b1c4b797b167f2cf9fbfd872094daedbd96c5f8d2b5094618970c2b5 (in IBD=false)\n\n - 2026-02-19T12:56:50.493904Z [msghand] [validationinterface.cpp:190] [ActiveTipChange] [validation] ActiveTipChange: new block hash=4b6a4a2986406d7f3eb90dd04a1282d8dcc60340e231b329c4f1ebddaf89253d block height=102\n\n - 2026-02-19T12:56:50.494957Z [msghand] [net_processing.cpp:3555] [ProcessMessage] [net] received: ping (8 bytes) peer=3\n\n - 2026-02-19T12:56:50.494981Z [msghand] [net.cpp:4074] [PushMessage] [net] sending pong (8 bytes) peer=3\n\n - 2026-02-19T12:56:50.496498Z [msghand] [net_processing.cpp:3555] [ProcessMessage] [net] received: ping (8 bytes) peer=3\n\n - 2026-02-19T12:56:50.496522Z [msghand] [net.cpp:4074] [PushMessage] [net] sending pong (8 bytes) peer=3\n\n - 2026-02-19T12:56:50.497570Z [http] [httpserver.cpp:232] [http_request_cb] [http] Received a POST request for / from 127.0.0.1:59760\n\n - 2026-02-19T12:56:50.497615Z [http_pool_0] [rpc/request.cpp:243] [parse] [rpc] ThreadRPCServer method=getbestblockhash user=__cookie__\n\n\n\n\n\n2026-02-19T12:56:50.558119Z TestFramework (INFO): Not stopping nodes as test failed. The dangling processes will be cleaned up later.\n\n2026-02-19T12:56:50.558309Z TestFramework (WARNING): Not cleaning up dir D:\\a\\bitcoin\\bitcoin\\test_runner_‚Çø_üèÉ_20260219_124134\\p2p_invalid_tx_138\n\n2026-02-19T12:56:50.558437Z TestFramework (ERROR): Test failed. Test logging available at D:\\a\\bitcoin\\bitcoin\\test_runner_‚Çø_üèÉ_20260219_124134\\p2p_invalid_tx_138/test_framework.log\n\n2026-02-19T12:56:50.558563Z TestFramework (ERROR): \n\n2026-02-19T12:56:50.558923Z TestFramework (ERROR): Hint: Call D:\\a\\bitcoin\\bitcoin\\test\\functional\\combine_logs.py 'D:\\a\\bitcoin\\bitcoin\\test_runner_‚Çø_üèÉ_20260219_124134\\p2p_invalid_tx_138' to consolidate all logs\n\n2026-02-19T12:56:50.559050Z TestFramework (ERROR): \n\n2026-02-19T12:56:50.559148Z TestFramework (ERROR): If this failure happened unexpectedly or intermittently, please file a bug and provide a link or upload of the combined log.\n\n2026-02-19T12:56:50.559269Z TestFramework (ERROR): https://github.com/bitcoin/bitcoin/issues\n\n2026-02-19T12:56:50.559367Z TestFramework (ERROR): \n\n\n\nstderr:\n[node 0] Cleaning up leftover process\n\n\n\n```",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 1,
    "created_at": "2026-02-19T13:52:12Z",
    "updated_at": "2026-02-19T13:58:52Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 22916920404,
      "node_id": "LE_lADOABII587sOD7izwAAAAVV9HRU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22916920404",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T13:52:30Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "commented",
      "id": 3927483465,
      "node_id": "IC_kwDOABII587qGKRJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3927483465",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T13:58:52Z",
      "updated_at": "2026-02-19T13:58:52Z",
      "author_association": "MEMBER",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/22163591188/job/64086436515#step:10:5786",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/34621#issuecomment-3927483465",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34621"
    }
  ]
}