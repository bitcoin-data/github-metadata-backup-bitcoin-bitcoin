{
  "type": "issue",
  "issue": {
    "id": 3578343370,
    "node_id": "I_kwDOABII587VSS_K",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33761",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33761/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33761/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33761/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/33761",
    "number": 33761,
    "state": "open",
    "state_reason": null,
    "title": "Is not demanding low-R grinding still relevant for external signers?",
    "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nIt seems that largest transaction coming from (my) external signer is not accepted in mempool. From what I understand, low-R grinding is not expected from external signers. That's what I understand <https://github.com/bitcoin/bitcoin/issues/26030>.\n\nIs this still true? (it is desirable) This is the result for me in 'regtest' environment on Bitcoin Core v29.2.\n\n### Expected behaviour\n\nAny transaction properly signed by external signer (because potentially low-capacity embedded device) is accepted.\n\n### Steps to reproduce\n\nConnect \"external signer\" via External Signer interface (command-line tool, directly, not through HWI)\n\nSign transaction until transaction with largest size is encountered.\n\n### Relevant log output\n\nThree transactions. Largest is not accepted for me on 'regtest', and to my knowledge signature is good.\n\n```\n020000000122d24e014ba0566c52dcedc316116fc6c0506d8d4506a59df48c086dafa944be010000006a47304402203d2e4ad14e4ffde063fab547d074d842060054827dd2db26b6b77ac40faa6aec022014de31cfda5fbe61a789112e106cc07a13a6187682908b22ec28f5b41256dd80012103158a5f4fd7588aa696a13d49889895b4b077aae721b52f9b72cda919ff926dfffeffffff02d2d4e405000000001600143e445eb2b84a73fec1851628a8f20998880af04d00c39dd0000000001976a914d2d44c8765409c6cecb3eb0861f7beb78f232c9e88ac00000000\n```\n\n```\n0200000001b0a283e1c1634f1eb748cb1a7ca0c6bda1d385037a6a626cdf3aa0b865a1be9e000000006b483045022100d412738cb2a54c530f62ba4f2458660dfab5239297df074bf5bb829f369c4c70022077f6cd209178e9aff43269c42c8df34c710096aa88c8a77d8f860db218603e050121031d633694c1ba15687ff4c1eb9ecb5ec730d44131008fa250d49e5f80dc516379feffffff0288dde405000000001600143e445eb2b84a73fec1851628a8f20998880af04d00a493d6000000001976a91418a4d1bec02c5489bebdd6fbb304e8e1b173733588ac00000000\n```\n\n```\n020000000122d24e014ba0566c52dcedc316116fc6c0506d8d4506a59df48c086dafa944be010000006c493046022100d21e82e9f292654f52bb3623f803b07e74c3b91f55aad40b6d0f5d767f2b66c9022100826102337dd415d4f9adcb4874da63f7981ffcaff18f0c2a94715d9ea3596c0d012103158a5f4fd7588aa696a13d49889895b4b077aae721b52f9b72cda919ff926dfffeffffff0288dde405000000001600143e445eb2b84a73fec1851628a8f20998880af04d00c39dd0000000001976a914d2d44c8765409c6cecb3eb0861f7beb78f232c9e88ac00000000\n```\n\n### How did you obtain Bitcoin Core\n\nPackage manager\n\n### What version of Bitcoin Core are you using?\n\nv29.2.0\n\n### Operating system and version\n\nFedora\n\n### Machine specifications\n\n_No response_",
    "user": {
      "login": "cobratbq",
      "id": 1936470,
      "node_id": "MDQ6VXNlcjE5MzY0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1936470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cobratbq",
      "html_url": "https://github.com/cobratbq",
      "followers_url": "https://api.github.com/users/cobratbq/followers",
      "following_url": "https://api.github.com/users/cobratbq/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/cobratbq/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/cobratbq/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/cobratbq/subscriptions",
      "organizations_url": "https://api.github.com/users/cobratbq/orgs",
      "repos_url": "https://api.github.com/users/cobratbq/repos",
      "events_url": "https://api.github.com/users/cobratbq/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/cobratbq/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 3,
    "created_at": "2025-11-01T19:18:21Z",
    "updated_at": "2025-11-02T18:30:21Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 3478152626,
      "node_id": "IC_kwDOABII587PUGWy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3478152626",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-02T18:05:11Z",
      "updated_at": "2025-11-02T18:05:45Z",
      "author_association": "MEMBER",
      "body": "What is the exact error that you are getting?\n\nThere is no \"demanding\", we cannot demand or request external signers do anything with low-R grinding. All we can do is make a guess about whether low-R grinding will be done, and account for that when selecting inputs so that the fee can be set appropriately. The current behavior is that if an input can be signed by the wallet itself, then we assume low-R grinding will occur. If it cannot be, i.e. the wallet does not have the private keys to sign the input, then we assume that low-R grinding will not occur. The only effect of this should be that sometimes a transaction will pay a slightly higher feerate than specified. It should not cause a transaction to not be accepted to the mempool.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33761#issuecomment-3478152626",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33761"
    },
    {
      "event": "commented",
      "id": 3478159502,
      "node_id": "IC_kwDOABII587PUICO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3478159502",
      "actor": {
        "login": "cobratbq",
        "id": 1936470,
        "node_id": "MDQ6VXNlcjE5MzY0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1936470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cobratbq",
        "html_url": "https://github.com/cobratbq",
        "followers_url": "https://api.github.com/users/cobratbq/followers",
        "following_url": "https://api.github.com/users/cobratbq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/cobratbq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/cobratbq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/cobratbq/subscriptions",
        "organizations_url": "https://api.github.com/users/cobratbq/orgs",
        "repos_url": "https://api.github.com/users/cobratbq/repos",
        "events_url": "https://api.github.com/users/cobratbq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/cobratbq/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-02T18:15:01Z",
      "updated_at": "2025-11-02T18:16:22Z",
      "author_association": "NONE",
      "body": "> What is the exact error that you are getting?\n\nNot error. Every time a transaction is signed and ready in the transaction list, when the transaction is of the largest flavor, it is completely greyed out and status tells me \"_unconfirmed, not in memory pool_\". I cannot find any other explanation why it is always the largest variant (maximum bytes) that is rejected by the memory pool.\n\nNote: this is on `regtest`, so might it be that memory pool rejects it by some average number that is badly determined because there is no (globally determined) average?\n\nMy intuitive guess is that the transaction is signed with a predetermined fee that assumes that either `R` or `s` is slightly smaller, hence not accepted by memory pool. To my knowledge, the signature is correct, as it is always processed in the same way regardless of size.\n \n> There is no \"demanding\", we cannot demand or request external signers do anything with low-R grinding. All we can do is make a guess about whether low-R grinding will be done, and account for that when selecting inputs so that the fee can be set appropriately.\n\nThe fee is guessed beforehand, right? So is it possible that the memory pool rejects the largest transaction because the guess is for a fee for 1 byte less? Or does that not matter for being accepted by the mempool, just that the transaction is slightly less attractive for slightly lesser over-all fee?\n\n> The current behavior is that if an input can be signed by the wallet itself, then we assume low-R grinding will occur. If it cannot be, i.e. the wallet does not have the private keys to sign the input, then we assume that low-R grinding will not occur. The only effect of this should be that sometimes a transaction will pay a slightly higher feerate than specified. It should not cause a transaction to not be accepted to the mempool.\n\nWhen you say \"wallet\", I presume you mean Bitcoin Core in possession of private key in own management? If so, the signer is configured and registered as external signer, and during creation the external signer checkbox is thus also set.",
      "user": {
        "login": "cobratbq",
        "id": 1936470,
        "node_id": "MDQ6VXNlcjE5MzY0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1936470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cobratbq",
        "html_url": "https://github.com/cobratbq",
        "followers_url": "https://api.github.com/users/cobratbq/followers",
        "following_url": "https://api.github.com/users/cobratbq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/cobratbq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/cobratbq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/cobratbq/subscriptions",
        "organizations_url": "https://api.github.com/users/cobratbq/orgs",
        "repos_url": "https://api.github.com/users/cobratbq/repos",
        "events_url": "https://api.github.com/users/cobratbq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/cobratbq/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33761#issuecomment-3478159502",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33761"
    },
    {
      "event": "commented",
      "id": 3478167704,
      "node_id": "IC_kwDOABII587PUKCY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3478167704",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-02T18:28:16Z",
      "updated_at": "2025-11-02T18:30:21Z",
      "author_association": "MEMBER",
      "body": "Can you try to broadcast the problematic transaction using `sendrawtransaction`? It should give you a more specific error.\n\n> The fee is guessed beforehand, right?\n\nThe fee is set beforehand, the size is guessed.\n\n> So is it possible that the memory pool rejects the largest transaction because the guess is for a fee for 1 byte less?\n\nYes. If you set the feerate to be minrelayfee, and the transaction is larger than was estimated, then the actual feerate will be lower than minrelayfee and the transaction won't be accepted.\n\n> When you say \"wallet\", I presume you mean Bitcoin Core in possession of private key in own management?\n\nYes.\n\n***\n\nIn the 3 transactions you posted, the first one is 222 bytes, the second 223, and the last 224. Of those 3 transactions, the 222 byte has a signature with low-R low-S, the 223 is high-R low-S, and the 224 is high-R high-S.\n\nFrom your description, the 224 bytes transaction is the one that isn't being accepted? In that case, it is because high-S has been non-standard for a very long time now. That itself is an issue. When the wallet does size estimation, it always assumes a low-S because high-S itself won't be accepted by the mempool.\n\nYou need to work with the creator of your external signing tool to have it make signatures with only low-S.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33761#issuecomment-3478167704",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33761"
    }
  ]
}