{
  "type": "issue",
  "issue": {
    "id": 579944104,
    "node_id": "MDU6SXNzdWU1Nzk5NDQxMDQ=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/18332",
    "number": 18332,
    "state": "closed",
    "state_reason": "completed",
    "title": "Confusing log order regarding DNS seeds",
    "body": "I just started a mainnet node (which had been dormant for a while) and saw the following:\r\n```\r\n2020-03-12T13:32:33Z Loading addresses from DNS seed seed.bitcoin.jonasschnelli.ch\r\n2020-03-12T13:32:34Z Loading addresses from DNS seed seed.btc.petertodd.org\r\n2020-03-12T13:32:34Z Loading addresses from DNS seed dnsseed.bitcoin.dashjr.org\r\n2020-03-12T13:32:46Z Loading addresses from DNS seed seed.bitcoin.sprovoost.nl\r\n2020-03-12T13:32:46Z Loading addresses from DNS seed dnsseed.emzy.de\r\n2020-03-12T13:32:46Z Loading addresses from DNS seed dnsseed.bluematt.me\r\n2020-03-12T13:32:51Z New outbound peer connected: version: 70015, blocks=621347, peer=0 (full-relay)\r\n2020-03-12T13:32:52Z New outbound peer connected: version: 70015, blocks=621347, peer=1 (full-relay)\r\n2020-03-12T13:32:52Z Synchronizing blockheaders, height: 618802 (~99.61%)\r\n2020-03-12T13:32:53Z Synchronizing blockheaders, height: 620802 (~99.91%)\r\n2020-03-12T13:32:53Z New outbound peer connected: version: 70015, blocks=621347, peer=2 (full-relay)\r\n2020-03-12T13:32:58Z P2P peers available. Skipped DNS seeding.\r\n```\r\nI'm not sure if this is actually a bug or not, but it looks a bit strange to me: First it queries *all* the DNS seeds, makes outgoing connections, then concludes \"P2P peers available. Skipped DNS seeding.\"\r\nIsn't it a bit late for that?\r\n",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64585,
        "node_id": "MDU6TGFiZWw2NDU4NQ==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
        "name": "Bug",
        "color": "FBBAAB",
        "default": false
      },
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 7,
    "closed_at": "2023-03-13T14:40:21Z",
    "created_at": "2020-03-12T13:36:32Z",
    "updated_at": "2023-03-13T14:41:01Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 3122859649,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDMxMjI4NTk2NDk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3122859649",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-03-12T13:36:32Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 598193012,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODE5MzAxMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/598193012",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-03-12T13:43:55Z",
      "updated_at": "2020-03-12T13:43:55Z",
      "author_association": "MEMBER",
      "body": "Ok, I see, this happens in the same loop in `CConnman::ThreadDNSAddressSeed()` . https://github.com/bitcoin/bitcoin/blob/master/src/net.cpp#L1605\r\n\r\nIt goes through the seeds in random order, querying them and adding their results, then stops when there are at least a few connections. It's just the message that is confusing, it would be better to say something like \"stopped DNS seeding\" instead of \"skipped DNS seeding\" *if* at least one seed was queried.\r\n",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/18332#issuecomment-598193012",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332"
    },
    {
      "event": "commented",
      "id": 598570765,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODU3MDc2NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/598570765",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-03-13T06:24:58Z",
      "updated_at": "2020-03-13T06:24:58Z",
      "author_association": "MEMBER",
      "body": "cc @ajtowns ",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/18332#issuecomment-598570765",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332"
    },
    {
      "event": "mentioned",
      "id": 3125539016,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzEyNTUzOTAxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3125539016",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-03-13T06:24:58Z"
    },
    {
      "event": "subscribed",
      "id": 3125539017,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMxMjU1MzkwMTc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3125539017",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-03-13T06:24:58Z"
    },
    {
      "event": "commented",
      "id": 598576630,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU5ODU3NjYzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/598576630",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-03-13T06:47:30Z",
      "updated_at": "2020-03-13T06:47:53Z",
      "author_association": "MEMBER",
      "body": "#16939 changes this to \"nnn addresses found from DNS seeds \\n P2P peers available. Finished DNS seeding.\" in the case where some addresses were found.",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/18332#issuecomment-598576630",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332"
    },
    {
      "event": "commented",
      "id": 674163736,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY3NDE2MzczNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/674163736",
      "actor": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-14T16:46:40Z",
      "updated_at": "2020-08-14T22:35:29Z",
      "author_association": "MEMBER",
      "body": "I can reproduce this post-16939 merge.\r\n\r\nSteps:\r\n- make sure you don't have a peers.dat\r\n- start node\r\n\r\n```\r\n2020-08-10T22:25:36Z dnsseed thread start\r\n2020-08-10T22:25:36Z Loading addresses from DNS seed seed.testnet.bitcoin.sprovoost.nl\r\n2020-08-10T22:25:36Z opencon thread start\r\n2020-08-10T22:25:36Z msghand thread start\r\n2020-08-10T22:25:36Z init message: Done loading\r\n2020-08-10T22:25:36Z Loading addresses from DNS seed seed.tbtc.petertodd.org\r\n2020-08-10T22:25:36Z Loading addresses from DNS seed testnet-seed.bitcoin.jonasschnelli.ch\r\n2020-08-10T22:25:38Z New outbound peer connected: version: 70015, blocks=1806673, peer=0 (full-relay)\r\n2020-08-10T22:25:38Z Synchronizing blockheaders, height: 69997 (~15.45%)\r\n2020-08-10T22:25:39Z Synchronizing blockheaders, height: 71997 (~15.87%)\r\n2020-08-10T22:25:39Z Synchronizing blockheaders, height: 73997 (~16.26%)\r\n2020-08-10T22:25:40Z Loading addresses from DNS seed testnet-seed.bluematt.me\r\n2020-08-10T22:25:40Z 70 addresses found from DNS seeds\r\n2020-08-10T22:25:40Z dnsseed thread exit\r\n...\r\n```\r\n- Shut down node, mid-sync\r\n- Restart node\r\n```\r\n2020-08-10T22:27:15Z Loaded 3621 addresses from peers.dat  27ms\r\n2020-08-10T22:27:15Z init message: Starting network threads...\r\n2020-08-10T22:27:15Z net thread start\r\n2020-08-10T22:27:15Z dnsseed thread start\r\n2020-08-10T22:27:15Z addcon thread start\r\n2020-08-10T22:27:15Z opencon thread start\r\n2020-08-10T22:27:15Z msghand thread start\r\n2020-08-10T22:27:15Z init message: Done loading\r\n2020-08-10T22:27:15Z Waiting 300 seconds before querying DNS seeds.\r\n2020-08-10T22:27:17Z New outbound peer connected: version: 70015, blocks=1806673, peer=0 (full-relay)\r\n2020-08-10T22:27:19Z Synchronizing blockheaders, height: 297996 (~49.20%)\r\n...\r\n2020-08-10T22:27:29Z New outbound peer connected: version: 70015, blocks=1806673, peer=1 (full-relay)\r\n2020-08-10T22:27:29Z New outbound peer connected: version: 70015, blocks=1806673, peer=2 (full-relay)\r\n...\r\n2020-08-10T22:27:37Z P2P peers available. Skipped DNS seeding.\r\n2020-08-10T22:27:37Z dnsseed thread exit\r\n```\r\n\r\nI added some more logging and here's my best guess at what's going on:\r\n\r\n1. start node and it goes out and checks for seeds and if successful `seeds_right_now` > 0 so [this code path is skipped](https://github.com/bitcoin/bitcoin/blob/30dd562fd2c58536fa026fff9853b8d825216b01/src/net.cpp#L1633).\r\n<details><summary>log</summary>\r\n\r\n```\r\n2020-08-14T16:30:39Z init message: Starting network threads...\r\n...\r\n2020-08-14T16:30:39Z dnsseed thread start\r\n...\r\n2020-08-14T16:30:39Z 4 seeds_right_now line 1631\r\n2020-08-14T16:30:39Z Loading addresses from DNS seed seed.tbtc.petertodd.org\r\n2020-08-14T16:30:39Z 0 incrementing DNS seeds on line 1695\r\n...\r\n2020-08-14T16:30:39Z 22 incrementing DNS seeds on line 1695\r\n2020-08-14T16:30:39Z 3 seeds_right_now line 1631\r\n2020-08-14T16:30:39Z Loading addresses from DNS seed testnet-seed.bitcoin.jonasschnelli.ch\r\n2020-08-14T16:30:39Z 23 incrementing DNS seeds on line 1695\r\n...\r\n2020-08-14T16:30:39Z 44 incrementing DNS seeds on line 1695\r\n2020-08-14T16:30:39Z 2 seeds_right_now line 1631\r\n2020-08-14T16:30:39Z Loading addresses from DNS seed testnet-seed.bluematt.me\r\n2020-08-14T16:30:39Z 45 incrementing DNS seeds on line 1695\r\n2020-08-14T16:30:39Z 46 incrementing DNS seeds on line 1695\r\n2020-08-14T16:30:39Z 47 incrementing DNS seeds on line 1695\r\n2020-08-14T16:30:39Z 1 seeds_right_now line 1631\r\n2020-08-14T16:30:39Z Loading addresses from DNS seed seed.testnet.bitcoin.sprovoost.nl\r\n2020-08-14T16:30:39Z 48 incrementing DNS seeds on line 1695\r\n...\r\n2020-08-14T16:30:39Z 69 incrementing DNS seeds on line 1695\r\n2020-08-14T16:30:39Z 70 addresses found from DNS seeds\r\n2020-08-14T16:30:39Z dnsseed thread exit\r\n```\r\n</details>\r\n\r\n2. shutdown and restart\r\n\r\n3. Now you have a bunch of addresses loaded from peers.dat, this time `seeds_right_now` == 0, new outbound connections start being made, [`nRelevant` == lots (6 for me)](https://github.com/bitcoin/bitcoin/blob/30dd562fd2c58536fa026fff9853b8d825216b01/src/net.cpp#L1654), but [found == 0](https://github.com/bitcoin/bitcoin/blob/30dd562fd2c58536fa026fff9853b8d825216b01/src/net.cpp#L1655). So you get the wrong message.\r\n<details><summary>log</summary>\r\nThe specific line numbers may vary, but this is the idea:\r\n\r\n```\r\n2020-08-14T16:30:58Z init message: Loading P2P addresses...\r\n2020-08-14T16:30:58Z Loaded 947 addresses from peers.dat  7ms\r\n2020-08-14T16:30:58Z init message: Starting network threads...\r\n2020-08-14T16:30:58Z dnsseed thread start\r\n...\r\n2020-08-14T16:30:58Z 0 seeds_right_now line 1631\r\n2020-08-14T16:30:58Z Waiting 11 seconds before querying DNS seeds.\r\n2020-08-14T16:30:59Z New outbound peer connected: version: 70015, blocks=1414448, peer=0 (full-relay)\r\n2020-08-14T16:30:59Z Synchronizing blockheaders, height: 13999 (~3.14%)\r\n...\r\n2020-08-14T16:31:09Z 6 nRelevant found line 1652\r\n2020-08-14T16:31:09Z 0 addresses found from DNS seeds on line 1653\r\n2020-08-14T16:31:09Z P2P peers available. Skipped DNS seeding.\r\n2020-08-14T16:31:09Z dnsseed thread exit\r\n```\r\n</details>",
      "user": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/18332#issuecomment-674163736",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332"
    },
    {
      "event": "labeled",
      "id": 4826392370,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ4MjYzOTIzNzA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4826392370",
      "actor": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-01T16:05:24Z",
      "label": {
        "name": "Bug",
        "color": "FBBAAB"
      }
    },
    {
      "event": "commented",
      "id": 1013981739,
      "node_id": "IC_kwDOABII5848cCIr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013981739",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-16T23:53:59Z",
      "updated_at": "2022-01-16T23:53:59Z",
      "author_association": "MEMBER",
      "body": "> So you get the wrong message.\r\n\r\nWhich message do you mean?\r\nIn the first run, DNS seeds were queried and the message \"70 addresses found from DNS seeds\" seems correct. \r\nThen, in the restart run, no DNS seeds were queried because connections were made to addrman peers - so the message \"P2P peers available. Skipped DNS seeding.\" - seems accurate too.\r\n\r\nOr is the issue that \"Skipped DNS seeding\" might more precisely be \"No DNS seeds were queried\" because the `dnsseed` thread still gets started and stopped, only the actual querying part was skipped?",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/18332#issuecomment-1013981739",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332"
    },
    {
      "event": "commented",
      "id": 1466253933,
      "node_id": "IC_kwDOABII585XZUJt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1466253933",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T14:32:01Z",
      "updated_at": "2023-03-13T14:32:01Z",
      "author_association": "MEMBER",
      "body": "I think this can be close now that the log messages are no longer returned in a confusing way since #16939:\r\n\r\n```log\r\n2023-03-13T14:30:03Z 0 block-relay-only anchors will be tried for connections.\r\n2023-03-13T14:30:03Z init message: Starting network threadsâ€¦\r\n2023-03-13T14:30:03Z dnsseed thread start\r\n2023-03-13T14:30:03Z init message: Done loading\r\n2023-03-13T14:30:03Z opencon thread start\r\n2023-03-13T14:30:03Z Loading addresses from DNS seed seed.bitcoin.sprovoost.nl.\r\n2023-03-13T14:30:03Z net thread start\r\n2023-03-13T14:30:03Z msghand thread start\r\n2023-03-13T14:30:03Z addcon thread start\r\n2023-03-13T14:30:03Z [tor] Got service ID 3kwltujshw3zphtzh24hdyl6gkodrrilsq4urqot5wxy6rg5bc3m5aqd, advertising service 3kwltujshw3zphtzh24hdyl6gkodrrilsq4urqot5wxy6rg5bc3m5aqd.onion:8333\r\n2023-03-13T14:30:03Z AddLocal(3kwltujshw3zphtzh24hdyl6gkodrrilsq4urqot5wxy6rg5bc3m5aqd.onion:8333,4)\r\n2023-03-13T14:30:04Z Loading addresses from DNS seed dnsseed.emzy.de.\r\n2023-03-13T14:30:04Z Loading addresses from DNS seed seed.bitcoin.jonasschnelli.ch.\r\n2023-03-13T14:30:04Z Loading addresses from DNS seed dnsseed.bluematt.me.\r\n2023-03-13T14:30:05Z New outbound peer connected: version: 70016, blocks=780638, peer=0 (outbound-full-relay)\r\n2023-03-13T14:30:05Z Loading addresses from DNS seed seed.btc.petertodd.org.\r\n2023-03-13T14:30:05Z New outbound peer connected: version: 70016, blocks=780638, peer=1 (outbound-full-relay)\r\n2023-03-13T14:30:05Z Loading addresses from DNS seed dnsseed.bitcoin.dashjr.org.\r\n2023-03-13T14:30:06Z Loading addresses from DNS seed seed.bitcoin.wiz.biz.\r\n2023-03-13T14:30:06Z Pre-synchronizing blockheaders, height: 2000 (~0.27%)\r\n2023-03-13T14:30:06Z Pre-synchronizing blockheaders, height: 4000 (~0.54%)\r\n2023-03-13T14:30:06Z New outbound peer connected: version: 70016, blocks=780638, peer=2 (outbound-full-relay)\r\n2023-03-13T14:30:07Z Pre-synchronizing blockheaders, height: 6000 (~0.81%)\r\n2023-03-13T14:30:07Z Pre-synchronizing blockheaders, height: 8000 (~1.08%)\r\n2023-03-13T14:30:07Z New outbound peer connected: version: 70016, blocks=780638, peer=3 (outbound-full-relay)\r\n2023-03-13T14:30:07Z Pre-synchronizing blockheaders, height: 10000 (~1.35%)\r\n2023-03-13T14:30:07Z Loading addresses from DNS seed seed.bitcoinstats.com.\r\n2023-03-13T14:30:07Z Pre-synchronizing blockheaders, height: 12000 (~1.62%)\r\n2023-03-13T14:30:07Z Loading addresses from DNS seed seed.bitcoin.sipa.be.\r\n2023-03-13T14:30:08Z Pre-synchronizing blockheaders, height: 14000 (~1.89%)\r\n2023-03-13T14:30:08Z 317 addresses found from DNS seeds\r\n2023-03-13T14:30:08Z dnsseed thread exit\r\n```",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/18332#issuecomment-1466253933",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332"
    },
    {
      "event": "closed",
      "id": 8732608240,
      "node_id": "CE_lADOABII584ikT6ozwAAAAIIgQbw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8732608240",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T14:40:21Z"
    },
    {
      "event": "commented",
      "id": 1466270405,
      "node_id": "IC_kwDOABII585XZYLF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1466270405",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-13T14:41:00Z",
      "updated_at": "2023-03-13T14:41:00Z",
      "author_association": "MEMBER",
      "body": "Closing as per the two previous comments that this is fixed.",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/18332#issuecomment-1466270405",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18332"
    }
  ]
}